/*! For license information please see main.d33d0321.js.LICENSE.txt */
(()=>{var __webpack_modules__={6611:(module,__unused_webpack_exports,__webpack_require__)=>{var e;self,e=function(__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__9__){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=190)}([function(t,e,n){"use strict";n.d(e,"T",(function(){return j.b})),n.d(e,"Fb",(function(){return It.a})),n.d(e,"Kb",(function(){return It.b})),n.d(e,"W",(function(){return Rt})),n.d(e,"Y",(function(){return Dt})),n.d(e,"Z",(function(){return V})),n.d(e,"ab",(function(){return H})),n.d(e,"bb",(function(){return Bt})),n.d(e,"cb",(function(){return Jt})),n.d(e,"db",(function(){return ce})),n.d(e,"eb",(function(){return le})),n.d(e,"hb",(function(){return he})),n.d(e,"mb",(function(){return de})),n.d(e,"nb",(function(){return pe})),n.d(e,"ob",(function(){return fe})),n.d(e,"pb",(function(){return me})),n.d(e,"rb",(function(){return ge})),n.d(e,"sb",(function(){return ve})),n.d(e,"tb",(function(){return be})),n.d(e,"ub",(function(){return Ee})),n.d(e,"xb",(function(){return Nt})),n.d(e,"yb",(function(){return Ce})),n.d(e,"zb",(function(){return ke})),n.d(e,"Bb",(function(){return Ae})),n.d(e,"Cb",(function(){return Oe})),n.d(e,"Db",(function(){return Re})),n.d(e,"Eb",(function(){return Ne})),n.d(e,"Gb",(function(){return Lt.a})),n.d(e,"Ib",(function(){return Me})),n.d(e,"Mb",(function(){return Be})),n.d(e,"Nb",(function(){return Te})),n.d(e,"Ob",(function(){return ze})),n.d(e,"Jb",(function(){return ae})),n.d(e,"ib",(function(){return En})),n.d(e,"Hb",(function(){return Cn})),n.d(e,"gb",(function(){return kn})),n.d(e,"vb",(function(){return An})),n.d(e,"wb",(function(){return Hn.e})),n.d(e,"jb",(function(){return l.b})),n.d(e,"qb",(function(){return Xn.a})),n.d(e,"kb",(function(){return i})),n.d(e,"Lb",(function(){return At})),n.d(e,"X",(function(){return o})),n.d(e,"Ab",(function(){return r})),n.d(e,"fb",(function(){return Bi})),n.d(e,"lb",(function(){return a})),n.d(e,"w",(function(){return Wi.b})),n.d(e,"k",(function(){return Wi.a})),n.d(e,"a",(function(){return W.a})),n.d(e,"b",(function(){return W.d})),n.d(e,"c",(function(){return W.m})),n.d(e,"d",(function(){return W.o})),n.d(e,"e",(function(){return W.r})),n.d(e,"f",(function(){return W.v})),n.d(e,"g",(function(){return W.w})),n.d(e,"h",(function(){return W.y})),n.d(e,"i",(function(){return W.z})),n.d(e,"j",(function(){return W.G})),n.d(e,"l",(function(){return W.R})),n.d(e,"m",(function(){return W.W})),n.d(e,"n",(function(){return W.X})),n.d(e,"o",(function(){return W.Y})),n.d(e,"p",(function(){return W.ab})),n.d(e,"q",(function(){return W.bb})),n.d(e,"s",(function(){return W.eb})),n.d(e,"u",(function(){return W.jb})),n.d(e,"t",(function(){return W.ib})),n.d(e,"v",(function(){return W.kb})),n.d(e,"x",(function(){return W.sb})),n.d(e,"y",(function(){return W.yb})),n.d(e,"z",(function(){return W.zb})),n.d(e,"A",(function(){return W.Cb})),n.d(e,"B",(function(){return W.Db})),n.d(e,"C",(function(){return W.Fb})),n.d(e,"D",(function(){return W.Ib})),n.d(e,"E",(function(){return W.Kb})),n.d(e,"I",(function(){return W.Pb})),n.d(e,"F",(function(){return W.Mb})),n.d(e,"G",(function(){return W.Nb})),n.d(e,"H",(function(){return W.Ob})),n.d(e,"J",(function(){return W.Xb})),n.d(e,"K",(function(){return W.bc})),n.d(e,"M",(function(){return W.jc})),n.d(e,"O",(function(){return W.qc})),n.d(e,"N",(function(){return W.oc})),n.d(e,"Q",(function(){return W.xc})),n.d(e,"P",(function(){return W.wc})),n.d(e,"R",(function(){return W.Ac})),n.d(e,"S",(function(){return W.Cc})),n.d(e,"U",(function(){return W.Gc})),n.d(e,"V",(function(){return W.Hc})),n.d(e,"r",(function(){return W.db})),n.d(e,"L",(function(){return W.hc}));var i={};n.r(i),n.d(i,"copyModel",(function(){return B})),n.d(i,"listModels",(function(){return F})),n.d(i,"moveModel",(function(){return z})),n.d(i,"removeModel",(function(){return L})),n.d(i,"browserFiles",(function(){return J})),n.d(i,"browserHTTPRequest",(function(){return ct})),n.d(i,"concatenateArrayBuffers",(function(){return u.d})),n.d(i,"decodeWeights",(function(){return u.e})),n.d(i,"encodeWeights",(function(){return u.f})),n.d(i,"fromMemory",(function(){return ht})),n.d(i,"getLoadHandlers",(function(){return m})),n.d(i,"getModelArtifactsInfoForJSON",(function(){return u.g})),n.d(i,"getSaveHandlers",(function(){return f})),n.d(i,"http",(function(){return at})),n.d(i,"isHTTPScheme",(function(){return st})),n.d(i,"loadWeights",(function(){return nt})),n.d(i,"registerLoadRouter",(function(){return p})),n.d(i,"registerSaveRouter",(function(){return d})),n.d(i,"weightsLoaderFactory",(function(){return it})),n.d(i,"withSaveHandler",(function(){return dt}));var r={};n.r(r),n.d(r,"assertParamsValid",(function(){return pt})),n.d(r,"maskToAxes",(function(){return ft})),n.d(r,"computeOutShape",(function(){return mt})),n.d(r,"stridesWithElidedDims",(function(){return gt})),n.d(r,"getNormalizedAxes",(function(){return xt})),n.d(r,"startIndicesWithElidedDims",(function(){return bt})),n.d(r,"stopIndicesWithElidedDims",(function(){return wt})),n.d(r,"stridesForAxis",(function(){return St})),n.d(r,"startForAxis",(function(){return _t})),n.d(r,"stopForAxis",(function(){return Tt})),n.d(r,"isSliceContinous",(function(){return Et})),n.d(r,"computeFlatOffset",(function(){return Ct})),n.d(r,"parseSliceParams",(function(){return kt}));var s={};n.r(s),n.d(s,"segOpComputeOptimalWindowSize",(function(){return Ni})),n.d(s,"computeOutShape",(function(){return Mi})),n.d(s,"collectGatherOpShapeInfo",(function(){return Di}));var o={};n.r(o),n.d(o,"axesAreInnerMostDims",(function(){return $t})),n.d(o,"combineLocations",(function(){return te})),n.d(o,"computeOutAndReduceShapes",(function(){return ee})),n.d(o,"expandShapeToKeepDim",(function(){return ne})),n.d(o,"assertAxesAreInnerMostDims",(function(){return ie})),n.d(o,"getAxesPermutation",(function(){return re})),n.d(o,"getUndoAxesPermutation",(function(){return se})),n.d(o,"getInnerMostAxes",(function(){return oe})),n.d(o,"getBroadcastDims",(function(){return Pe})),n.d(o,"getReductionAxes",(function(){return Fe})),n.d(o,"assertAndGetBroadcastShape",(function(){return Le})),n.d(o,"assertParamsConsistent",(function(){return Pt})),n.d(o,"computeOutShape",(function(){return Ft})),n.d(o,"computeDilation2DInfo",(function(){return zt})),n.d(o,"computePool2DInfo",(function(){return Ut})),n.d(o,"computePool3DInfo",(function(){return jt})),n.d(o,"computeConv2DInfo",(function(){return Vt})),n.d(o,"computeConv3DInfo",(function(){return Wt})),n.d(o,"computeDefaultPad",(function(){return Gt})),n.d(o,"tupleValuesAreOne",(function(){return Kt})),n.d(o,"eitherStridesOrDilationsAreOne",(function(){return Qt})),n.d(o,"convertConv2DDataFormat",(function(){return Zt})),n.d(o,"getFusedDyActivation",(function(){return Jn})),n.d(o,"getFusedBiasGradient",(function(){return $n})),n.d(o,"applyActivation",(function(){return ti})),n.d(o,"shouldFuse",(function(){return ei})),n.d(o,"PARALLELIZE_THRESHOLD",(function(){return ni})),n.d(o,"computeOptimalWindowSize",(function(){return ii})),n.d(o,"slice_util",(function(){return r})),n.d(o,"upcastType",(function(){return It.b})),n.d(o,"getImageCenter",(function(){return ri})),n.d(o,"getReshaped",(function(){return si})),n.d(o,"getPermuted",(function(){return oi})),n.d(o,"getReshapedPermuted",(function(){return ai})),n.d(o,"getSliceBeginCoords",(function(){return ci})),n.d(o,"getSliceSize",(function(){return li})),n.d(o,"prepareAndValidate",(function(){return ui})),n.d(o,"validateUpdateShape",(function(){return hi})),n.d(o,"validateInput",(function(){return di})),n.d(o,"calculateShapes",(function(){return pi})),n.d(o,"SELU_SCALEALPHA",(function(){return fi})),n.d(o,"SELU_SCALE",(function(){return mi})),n.d(o,"ERF_P",(function(){return gi})),n.d(o,"ERF_A1",(function(){return vi})),n.d(o,"ERF_A2",(function(){return yi})),n.d(o,"ERF_A3",(function(){return xi})),n.d(o,"ERF_A4",(function(){return bi})),n.d(o,"ERF_A5",(function(){return wi})),n.d(o,"warn",(function(){return Si})),n.d(o,"log",(function(){return _i})),n.d(o,"mergeRealAndImagArrays",(function(){return Ti})),n.d(o,"splitRealAndImagArrays",(function(){return Ei})),n.d(o,"complexWithEvenIndex",(function(){return Ci})),n.d(o,"complexWithOddIndex",(function(){return ki})),n.d(o,"getComplexWithIndex",(function(){return Ai})),n.d(o,"assignToTypedArray",(function(){return Ii})),n.d(o,"exponents",(function(){return Oi})),n.d(o,"exponent",(function(){return Ri})),n.d(o,"prepareSplitSize",(function(){return Ie})),n.d(o,"segment_util",(function(){return s})),n.d(o,"castTensor",(function(){return Pi})),n.d(o,"reshapeTensor",(function(){return Fi})),n.d(o,"linspaceImpl",(function(){return Li}));var a={};n.r(a),n.d(a,"nonMaxSuppressionV3Impl",(function(){return nn})),n.d(a,"nonMaxSuppressionV4Impl",(function(){return rn})),n.d(a,"nonMaxSuppressionV5Impl",(function(){return sn})),n.d(a,"split",(function(){return zi})),n.d(a,"tile",(function(){return Ui})),n.d(a,"topkImpl",(function(){return ji})),n.d(a,"whereImpl",(function(){return Vi}));var c=n(6),l=(n(38),n(11)),u=n(17);class h{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==h.instance&&(h.instance=new h),h.instance}static registerSaveRouter(t){h.getInstance().saveRouters.push(t)}static registerLoadRouter(t){h.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return h.getHandlers(t,"save")}static getLoadHandlers(t,e){return h.getHandlers(t,"load",e)}static getHandlers(t,e,n){const i=[];return("load"===e?h.getInstance().loadRouters:h.getInstance().saveRouters).forEach((e=>{const r=e(t,n);null!==r&&i.push(r)})),i}}const d=t=>h.registerSaveRouter(t),p=t=>h.registerLoadRouter(t),f=t=>h.getSaveHandlers(t),m=(t,e)=>h.getLoadHandlers(t,e);function g(){if(!Object(l.b)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function v(t){const e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}class y{constructor(t){if(this.indexedDB=g(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const i=this.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=()=>v(i),i.onsuccess=()=>{const r=i.result;if(null==e){const e=r.transaction("models_store","readonly"),i=e.objectStore("models_store").get(this.modelPath);i.onsuccess=()=>{if(null==i.result)return r.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' in IndexedDB.")));t(i.result.modelArtifacts)},i.onerror=t=>(r.close(),n(i.error)),e.oncomplete=()=>r.close()}else{const i=Object(u.g)(e),s=r.transaction("model_info_store","readwrite");let o=s.objectStore("model_info_store");const a=o.put({modelPath:this.modelPath,modelArtifactsInfo:i});let c;a.onsuccess=()=>{c=r.transaction("models_store","readwrite");const a=c.objectStore("models_store").put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:i});a.onsuccess=()=>t({modelArtifactsInfo:i}),a.onerror=t=>{o=s.objectStore("model_info_store");const e=o.delete(this.modelPath);e.onsuccess=()=>(r.close(),n(a.error)),e.onerror=t=>(r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==c?r.close():c.oncomplete=()=>r.close()}}},i.onerror=t=>n(i.error)}))}}y.URL_SCHEME="indexeddb://";const x=t=>{return Object(l.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(y.URL_SCHEME)?(e=t.slice(y.URL_SCHEME.length),new y(e)):null;var e};h.registerSaveRouter(x),h.registerLoadRouter(x);class b{constructor(){this.indexedDB=g()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open("tensorflowjs",1);n.onupgradeneeded=()=>v(n),n.onsuccess=()=>{const i=n.result,r=i.transaction("model_info_store","readonly"),s=r.objectStore("model_info_store").getAll();s.onsuccess=()=>{const e={};for(const t of s.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},s.onerror=t=>(i.close(),e(s.error)),r.oncomplete=()=>i.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(y.URL_SCHEME)?e.slice(y.URL_SCHEME.length):e,new Promise(((e,n)=>{const i=this.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=()=>v(i),i.onsuccess=()=>{const r=i.result,s=r.transaction("model_info_store","readwrite"),o=s.objectStore("model_info_store"),a=o.get(t);let c;a.onsuccess=()=>{if(null==a.result)return r.close(),n(new Error("Cannot find model with path '".concat(t,"' in IndexedDB.")));{const i=o.delete(t),s=()=>{c=r.transaction("models_store","readwrite");const i=c.objectStore("models_store").delete(t);i.onsuccess=()=>e(a.result.modelArtifactsInfo),i.onerror=t=>n(a.error)};i.onsuccess=s,i.onerror=t=>(s(),r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==c?r.close():c.oncomplete=()=>r.close()}},i.onerror=t=>n(i.error)}))}}var w=n(16);const S="tensorflowjs_models",_="info",T="model_topology",E="weight_specs",C="weight_data",k="model_metadata";function A(t){return{info:[S,t,_].join("/"),topology:[S,t,T].join("/"),weightSpecs:[S,t,E].join("/"),weightData:[S,t,C].join("/"),modelMetadata:[S,t,k].join("/")}}function I(t){const e=t.split("/");if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join("/")}class O{constructor(t){if(!Object(l.b)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=A(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),i=Object(u.g)(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Object(u.a)(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),{modelArtifactsInfo:i}}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=").concat(i.modelTopologyBytes,", weightSpecsBytes=").concat(i.weightSpecsBytes,", weightDataBytes=").concat(i.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' is missing."));e.modelTopology=n;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==i)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' are missing."));e.weightSpecs=i;const r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){const t=JSON.parse(r);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,e.userDefinedMetadata=t.userDefinedMetadata}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error("In local storage, the binary weight values of model '".concat(this.modelPath,"' are missing."));return e.weightData=Object(u.b)(s),e}}O.URL_SCHEME="localstorage://";const R=t=>{return Object(l.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(O.URL_SCHEME)?(e=t.slice(O.URL_SCHEME.length),new O(e)):null;var e};h.registerSaveRouter(R),h.registerLoadRouter(R);class N{constructor(){Object(w.b)(Object(l.b)().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),Object(w.b)("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=S+"/",n="/"+_;for(let i=0;i<this.LS.length;++i){const r=this.LS.key(i);r.startsWith(e)&&r.endsWith(n)&&(t[I(r)]=JSON.parse(this.LS.getItem(r)))}return t}async removeModel(t){var e;const n=A(t=(e=t).startsWith(O.URL_SCHEME)?e.slice(O.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const i=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),i}}class M{constructor(){this.managers={}}static getInstance(){return null==M.instance&&(M.instance=new M),M.instance}static registerManager(t,e){Object(w.b)(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Object(w.b)(t.length>0,(()=>"scheme must not be an empty string."));const n=M.getInstance();Object(w.b)(null==n.managers[t],(()=>"A model store manager is already registered for scheme '".concat(t,"'."))),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function D(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+M.getSchemes().join(","));return{scheme:t.split("://")[0],path:t.split("://")[1]}}async function P(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(w.b)(t!==e,(()=>"Old path and new path are the same: '".concat(t,"'")));const i=h.getLoadHandlers(t);Object(w.b)(i.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(t,"."))),Object(w.b)(i.length<2,(()=>"Copying failed because more than one (".concat(i.length,") load handlers for source URL ").concat(t,".")));const r=i[0],s=h.getSaveHandlers(e);Object(w.b)(s.length>0,(()=>"Copying failed because no save handler is found for destination URL ".concat(e,"."))),Object(w.b)(s.length<2,(()=>"Copying failed because more than one (".concat(i.length,") save handlers for destination URL ").concat(e,".")));const o=s[0],a=D(t).scheme,c=D(t).path,l=a===D(t).scheme,u=await r.load();n&&l&&await M.getManager(a).removeModel(c);const d=await o.save(u);return n&&!l&&await M.getManager(a).removeModel(c),d.modelArtifactsInfo}async function F(){const t=M.getSchemes(),e={};for(const n of t){const t=await M.getManager(n).listModels();for(const i in t)e[n+"://"+i]=t[i]}return e}async function L(t){const e=D(t);return M.getManager(e.scheme).removeModel(e.path)}async function B(t,e){return P(t,e,!1)}async function z(t,e){return P(t,e,!0)}class U{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}if(Object(l.b)().get("IS_BROWSER")){Object(l.b)().setPlatform("browser",new U);try{M.registerManager(O.URL_SCHEME,new N)}catch(t){}try{M.registerManager(y.URL_SCHEME,new b)}catch(t){}}n(159);var j=n(5);function V(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",w.c(t),new j.b(t,e,n)}var W=n(1),G=n(3),q=n(4);const H=Object(q.a)({cast_:function(t,e){const n=Object(G.a)(t,"x","cast");if(!w.B(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const i={x:n},r={dtype:e};return c.a.runKernelFunc((t=>t.cast(n,e)),i,null,W.v,r)}}),X=Object(q.a)({clone_:function(t){const e=Object(G.a)(t,"x","clone",null),n={x:e};return c.a.runKernelFunc((()=>c.a.makeTensorFromDataId(e.dataId,e.shape,e.dtype)),n,null,W.jb)}});Object(c.b)();const Y={buffer:V,cast:H,clone:X,print:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}};function K(t){return new Promise((t=>setTimeout(t))).then(t)}Object(j.e)(Y);class Q{constructor(t){if(!Object(l.b)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Q.URL_SCHEME)&&(t=t.slice(Q.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},r=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),s=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(s.download=this.modelTopologyFileName,s.href=r,await K((()=>s.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await K((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Object(u.g)(t)}}}}Q.URL_SCHEME="downloads://";class Z{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise(((n,i)=>{const r=new FileReader;r.onload=r=>{const s=JSON.parse(r.target.result),o=s.modelTopology;if(null==o)return void i(new Error("modelTopology field is missing from file "+t.name));0===e.length&&n({modelTopology:o});const a=s.weightsManifest;if(null==a)return void i(new Error("weightManifest field is missing from file "+t.name));let c;try{c=this.checkManifestAndWeightFiles(a,e)}catch(t){return void i(t)}const l=[],h=[],d=[];a.forEach((t=>{t.paths.forEach((t=>{h.push(t),d.push(null)})),l.push(...t.weights)})),a.forEach((t=>{t.paths.forEach((t=>{const e=new FileReader;e.onload=e=>{const i=e.target.result,r=h.indexOf(t);d[r]=i,-1===d.indexOf(null)&&n({modelTopology:o,weightSpecs:l,weightData:Object(u.d)(d),format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy,userDefinedMetadata:s.userDefinedMetadata})},e.onerror=e=>i("Failed to weights data from file of path '".concat(t,"'.")),e.readAsArrayBuffer(c[t])}))}))},r.onerror=e=>i("Failed to read model topology and weights manifest JSON from file '".concat(t.name,"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")),r.readAsText(t)}))}checkManifestAndWeightFiles(t,e){const n=[],i=e.map((t=>Object(u.c)(t.name))),r={};for(const s of t)s.paths.forEach((t=>{const s=Object(u.c)(t);if(-1!==n.indexOf(s))throw new Error("Duplicate file basename found in weights manifest: '".concat(s,"'"));if(n.push(s),-1===i.indexOf(s))throw new Error("Weight file with basename '".concat(s,"' is not provided."));r[t]=e[i.indexOf(s)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest (".concat(n.length,") and the number of weight files provided (").concat(e.length,")."));return r}}function J(t){return new Z(t)}function $(t,e,n,i){!function(t){Object(w.b)(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){Object(w.b)(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but got startFraction "+t)),Object(w.b)(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but got endFraction "+e)),Object(w.b)(e>=t,(()=>"startFraction must be no more than endFraction, but got startFraction ".concat(t," and endFraction ")+e))}(n=null==n?0:n,i=null==i?1:i);let r=0;return Promise.all(t.map((s=>(s.then((s=>{const o=n+ ++r/t.length*(i-n);return e(o),s})),s))))}h.registerSaveRouter((t=>Object(l.b)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Q.URL_SCHEME)?function(){return new Q(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model")}(t.slice(Q.URL_SCHEME.length)):null));var tt=n(41);async function et(t,e){null==e&&(e={});const n=null==e.fetchFunc?Object(l.b)().platform.fetch:e.fetchFunc,i=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),r=(null==e.onProgress?await Promise.all(i):await $(i,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(r):await $(r,e.onProgress,.5,1)}async function nt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return it((t=>et(t,{requestInit:i})))(t,e,n)}function it(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;const r=e.map((()=>!1)),s={},o=null!=i?i.map((()=>!1)):[],a=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const c="quantization"in t?t.quantization.dtype:t.dtype,l=tt.a[c]*w.N(t.shape),u=()=>{r[e]=!0,null==s[e]&&(s[e]=[]),s[e].push({manifestEntry:t,groupOffset:n,sizeBytes:l})};null!=i?i.forEach(((e,n)=>{e===t.name&&(u(),o[n]=!0)})):u(),a.push(t.name),n+=l}))})),!o.every((t=>t))){const t=i.filter(((t,e)=>!o[e]));throw new Error("Could not find weights in manifest with names: "+t.join(", ")+". \nManifest JSON has weights with names: "+a.join(", ")+".")}const c=r.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),l=[];c.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;l.push(e)}))}));const h=await t(l),d={};let p=0;return c.forEach((t=>{const n=e[t].paths.length;let i=0;for(let e=0;e<n;e++)i+=h[p+e].byteLength;const r=new ArrayBuffer(i),o=new Uint8Array(r);let a=0;for(let e=0;e<n;e++){const t=new Uint8Array(h[p+e]);o.set(t,a),a+=t.byteLength}s[t].forEach((t=>{const e=r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=Object(u.e)(e,[t.manifestEntry]);for(const i in n)d[i]=n[i]})),p+=n})),d}}class rt{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(Object(w.b)("function"==typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=Object(l.b)().platform.fetch,Object(w.b)(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&Object(w.b)(2===t.length,(()=>"URL paths for http must have a length of 2, (actual length is ".concat(t.length,")."))),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n};e.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:Object(u.g)(t),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+r.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(t){let e="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,i=e.weightsManifest,r=e.generatedBy,s=e.convertedBy,o=e.format,a=e.userDefinedMetadata;if(null==n&&null==i)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model topology or manifest for weights."));let c,l;if(null!=i){const t=await this.loadWeights(i);[c,l]=t}const u={modelTopology:n,weightSpecs:c,weightData:l,userDefinedMetadata:a,generatedBy:r,convertedBy:s,format:o},h=e.modelInitializer;return h&&(u.modelInitializer=h),u}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,i]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=this.weightPathPrefix||n,s=[];for(const l of t)s.push(...l.weights);const o=[],a=[];for(const l of t)for(const t of l.paths)null!=this.weightUrlConverter?a.push(this.weightUrlConverter(t)):o.push(r+t+i);this.weightUrlConverter&&o.push(...await Promise.all(a));const c=await et(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[s,Object(u.d)(c)]}}function st(t){return null!=t.match(rt.URL_SCHEME_REGEX)}rt.URL_SCHEME_REGEX=/^https?:\/\//;const ot=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>st(t))):st(t),n)return at(t,e)}return null};function at(t,e){return new rt(t,e)}function ct(t,e){return at(t,e)}h.registerSaveRouter(ot),h.registerLoadRouter(ot);class lt{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class ut{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function ht(t,e,n,i){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new lt(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lt({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lt({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:i}))}function dt(t){return new ut(t)}function pt(t,e,n){const i=t.shape.length;w.b(i===e.length,(()=>"Error in slice".concat(i,"D: Length of begin ").concat(e," must match the rank of the array (").concat(i,")."))),w.b(i===n.length,(()=>"Error in slice".concat(i,"D: Length of size ").concat(n," must match the rank of the array (").concat(i,").")));for(let r=0;r<i;++r)w.b(e[r]+n[r]<=t.shape[r],(()=>"Error in slice".concat(i,"D: begin[").concat(r,"] + size[").concat(r,"] (").concat(e[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(t.shape[r],")")))}function ft(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function mt(t,e,n){const i=[];for(let r=0;r<t.length;r++)i[r]=Math.ceil((e[r]-t[r])/n[r]);return i}function gt(t,e,n,i){const r=[...t];for(let s=r.length;s<i.length;s++)r.push(1);for(let s=0;s<n;s++)0===s?r[e]=1:(r.splice(e,0,1),r.pop());return r}function vt(t,e,n){return n<=t?n:n-(e-1)}function yt(t,e){const n=[];for(let i=0;i<t;i++)n.push(e+i);return n}function xt(t,e,n,i,r,s,o,a,c){const l=t.length;let u=new Array(l),h=new Array(l),d=new Array(l);if(e.length&&n>0){const c=e[0],l=n+1;u=bt(o,c,l,i,t),h=wt(a,c,l,r,t),d=gt(s,c,l,t)}else for(let p=0;p<l;p++)u[p]=_t(o,i,s,t,p,c),h[p]=Tt(a,r,s,t,p,c),d[p]=St(s,p,c);return{begin:u,end:h,strides:d}}function bt(t,e,n,i,r){const s=[...r],o=yt(n,e);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const r=vt(e,n,a);let o=i[r];t&1<<r&&(o=0),s[a]=o}return s}function wt(t,e,n,i,r){const s=[...r],o=yt(n,e);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const r=vt(e,n,a);let o=i[r];t&1<<r&&(o=Number.MAX_SAFE_INTEGER),s[a]=o}for(let a=0;a<s.length;a++){const t=r[a];s[a]<0&&(s[a]+=t),s[a]=w.i(0,s[a],r[a])}return s}function St(t,e,n){let i=t[e];return(n&1<<e||null==i)&&(i=1),i}function _t(t,e,n,i,r,s){let o=e[r];const a=n[r]||1;(t&1<<r||s&1<<r||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=i[r];return o<0&&(o+=c),o=w.i(0,o,c-1),o}function Tt(t,e,n,i,r,s){let o=e[r];const a=n[r]||1;(t&1<<r||s&1<<r||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=i[r];return o<0&&(o+=c),o=a>0?w.i(0,o,c):w.i(-1,o,c-1),o}function Et(t,e,n){let i=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){i=r;break}for(let r=i+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function Ct(t,e){let n=t.length>0?t[t.length-1]:1;for(let i=0;i<t.length-1;i++)n+=t[i]*e[i];return n}function kt(t,e,n){let i;const r=t.shape.length;let s;return i="number"==typeof e?[e,...new Array(r-1).fill(0)]:e.length<r?e.concat(new Array(r-e.length).fill(0)):e.slice(),i.forEach((t=>{w.b(-1!==t,(()=>"slice() does not support negative begin indexing."))})),s=null==n?new Array(r).fill(-1):"number"==typeof n?[n,...new Array(r-1).fill(-1)]:n.length<r?n.concat(new Array(r-n.length).fill(-1)):n,s=s.map(((e,n)=>e>=0?e:(w.b(-1===e,(()=>"Negative size values should be exactly -1 but got ".concat(e," for the slice() size at index ").concat(n,"."))),t.shape[n]-i[n]))),[i,s]}var At=n(7),It=n(27),Ot=n(14);const Rt=Object(q.a)({add_:function(t,e){let n=Object(G.a)(t,"a","add"),i=Object(G.a)(e,"b","add");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.add(n,i);return e([n,i]),r}),r,null,W.d)}}),Nt=Object(q.a)({reshape_:function(t,e){const n=Object(G.a)(t,"x","reshape",null),i={x:n},r={shape:e};return c.a.runKernelFunc(((t,i)=>(e=w.s(e,n.size),w.b(n.size===w.N(e),(()=>"new shape and old shape must have the same number of elements.")),i([n]),t.reshape(n,e))),i,null,W.bc,r)}});function Mt(t){return null==t?null:0===t.rank?Nt(t,[t.size]):1===t.rank?t:2===t.rank?Nt(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t}const Dt=Object(q.a)({batchNorm_:function(t,e,n,i,r,s){null==s&&(s=.001);const o=Object(G.a)(t,"x","batchNorm"),a=Object(G.a)(e,"mean","batchNorm"),l=Object(G.a)(n,"variance","batchNorm");let u,h;null!=r&&(u=Object(G.a)(r,"scale","batchNorm")),null!=i&&(h=Object(G.a)(i,"offset","batchNorm")),w.b(a.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),w.b(null==h||a.rank===h.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),w.b(null==u||a.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const d=function(t){let e;return e=0===t.rank||1===t.rank?Nt(t,[1,1,1,t.size]):2===t.rank?Nt(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(o),p={x:d,scale:u,offset:h,mean:a,variance:l},f={varianceEpsilon:s},m=c.a.runKernelFunc(((t,e)=>(e([d,a,l,u]),t.batchNorm(d,Mt(a),Mt(l),Mt(h),Mt(u),s))),p,null,W.eb,f);return Nt(m,o.shape)}});function Pt(t,e){const n=t[0].length;t.forEach(((t,e)=>{w.b(t.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same as the rank of the rest (").concat(n,")")))})),w.b(e>=0&&e<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const i=t[0];t.forEach(((t,r)=>{for(let s=0;s<n;s++)w.b(s===e||t[s]===i[s],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(r,"] (").concat(t,") does not match the shape of the rest (").concat(i,") along the non-concatenated axis ").concat(r,".")))}))}function Ft(t,e){const n=t[0].slice();for(let i=1;i<t.length;i++)n[e]+=t[i][e];return n}var Lt=n(24);const Bt=Object(q.a)({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(w.b)(t.length>=1,(()=>"Pass at least one tensor to concat"));let n=Object(G.b)(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))}));const i=n,r={axis:e};return c.a.runKernelFunc(((t,i)=>{const r=Object(w.I)(e,n[0].shape)[0],s=Ft(n.map((t=>t.shape)),r);if(0===Object(w.N)(s))return Object(Lt.a)([],s);if(n=n.filter((t=>t.size>0)),1===n.length)return n[0];Pt(n.map((t=>t.shape)),r);const o=t.concat(n,r);return i(n),o}),i,null,W.z,r)}});function zt(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5?arguments[5]:void 0;return Vt(t,[...e,t[3]],n,s,i,null,null,Zt(r))}function Ut(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[a,c]=qt(e);let l;if("channelsLast"===o)l=[a,c,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);l=[a,c,t[1],t[1]]}return Vt(t,l,n,i,r,s,!1,o)}function jt(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[a,c,l]=Ht(e);let u,h;if("NDHWC"===o)h="channelsLast",u=[a,c,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);h="channelsFirst",u=[a,c,l,t[1],t[1]]}return Wt(t,u,n,i,r,!1,h,s)}function Vt(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,l,u,h]=[-1,-1,-1,-1];if("channelsLast"===a)[c,l,u,h]=t;else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);[c,h,l,u]=t}const[d,p,,f]=e,[m,g]=qt(n),[v,y]=qt(i),x=Xt(d,v),b=Xt(p,y),{padInfo:S,outHeight:_,outWidth:T}=function(t,e,n,i,r,s,o,a,c){let l,u,h;if("number"==typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const r=function(t,e,n,i,r){null==i&&(i=Gt(t,e,n));const s=t[1],o=Yt((t[0]-e+2*i)/n+1,r);w.b(w.v(o),(()=>"The output # of rows (".concat(o,") must be an integer. Change the stride and/or zero pad parameters")));const a=Yt((s-e+2*i)/n+1,r);return w.b(w.v(a),(()=>"The output # of columns (".concat(a,") must be an integer. Change the stride and/or zero pad parameters"))),[o,a]}([e,n],s,i,t,a);u=r[0],h=r[1]}else if("same"===t){u=Math.ceil(e/i),h=Math.ceil(n/r);const t=Math.max(0,(u-1)*i+s-e),a=Math.max(0,(h-1)*r+o-n),c=Math.floor(t/2),d=t-c,p=Math.floor(a/2);l={top:c,bottom:d,left:p,right:a-p,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-s+1)/i),h=Math.ceil((n-o+1)/r);else{if("object"!=typeof t)throw Error("Unknown padding parameter: "+t);{const d="channelsLast"===c?t[1][0]:t[2][0],p="channelsLast"===c?t[1][1]:t[2][1],f="channelsLast"===c?t[2][0]:t[3][0],m="channelsLast"===c?t[2][1]:t[3][1];l={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=Yt((e-s+d+p)/i+1,a),h=Yt((n-o+f+m)/r+1,a)}}return{padInfo:l,outHeight:u,outWidth:h}}(r,l,u,m,g,x,b,s,a),E=o?f*h:f;let C;return"channelsFirst"===a?C=[c,E,_,T]:"channelsLast"===a&&(C=[c,_,T,E]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:u,inChannels:h,outHeight:_,outWidth:T,outChannels:E,padInfo:S,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:x,effectiveFilterWidth:b,dilationHeight:v,dilationWidth:y,inShape:t,outShape:C,filterShape:e}}function Wt(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",a=arguments.length>7?arguments[7]:void 0,[c,l,u,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,l,u,h,d]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);[c,d,l,u,h]=t}const[p,f,m,,g]=e,[v,y,x]=Ht(n),[b,S,_]=Ht(i),T=Xt(p,b),E=Xt(f,S),C=Xt(m,_),{padInfo:k,outDepth:A,outHeight:I,outWidth:O}=function(t,e,n,i,r,s,o,a,c,l,u){let h,d,p,f;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const s=function(t,e,n,i,r,s){null==r&&(r=Gt(t,e,i));const o=t[1],a=t[2],c=Yt((t[0]-e+2*r)/i+1,s);w.b(w.v(c),(()=>"The output # of depths (".concat(c,") must be an integer. Change the stride and/or zero pad parameters")));const l=Yt((o-e+2*r)/i+1,s);w.b(w.v(l),(()=>"The output # of rows (".concat(l,") must be an integer. Change the stride and/or zero pad parameters")));const u=Yt((a-e+2*r)/i+1,s);return w.b(w.v(u),(()=>"The output # of columns (".concat(u,") must be an integer. Change the stride and/or zero pad parameters"))),[c,l,u,1]}([e,n,i,1],a,0,r,t,u);d=s[0],p=s[1],f=s[2]}else if("same"===t){d=Math.ceil(e/r),p=Math.ceil(n/s),f=Math.ceil(i/o);const t=(d-1)*r+a-e,u=(p-1)*s+c-n,m=(f-1)*o+l-i,g=Math.floor(t/2),v=t-g,y=Math.floor(u/2),x=u-y,b=Math.floor(m/2);h={top:y,bottom:x,left:b,right:m-b,front:g,back:v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/r),p=Math.ceil((n-c+1)/s),f=Math.ceil((i-l+1)/o)}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(r,l,u,h,v,y,x,T,E,C,a),R=s?g*d:g;let N;return"channelsFirst"===o?N=[c,R,A,I,O]:"channelsLast"===o&&(N=[c,A,I,O,R]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:u,inWidth:h,inChannels:d,outDepth:A,outHeight:I,outWidth:O,outChannels:R,padInfo:k,strideDepth:v,strideHeight:y,strideWidth:x,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:T,effectiveFilterHeight:E,effectiveFilterWidth:C,dilationDepth:b,dilationHeight:S,dilationWidth:_,inShape:t,outShape:N,filterShape:e}}function Gt(t,e,n){const i=Xt(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+i)/2)}function qt(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function Ht(t){return"number"==typeof t?[t,t,t]:t}function Xt(t,e){return e<=1?t:t+(t-1)*(e-1)}function Yt(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function Kt(t){const[e,n,i]=qt(t);return 1===e&&1===n&&1===i}function Qt(t,e){return Kt(t)||Kt(e)}function Zt(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}const Jt=Object(q.a)({conv2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=Object(G.a)(t,"x","conv2d"),l=Object(G.a)(e,"filter","conv2d");let u=a,h=!1;3===a.rank&&(h=!0,u=Nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),w.b(4===u.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(u.rank,"."))),w.b(4===l.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+l.rank+".")),null!=o&&w.b(w.v(i),(()=>"Error in conv2d: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")));const d="NHWC"===r?u.shape[3]:u.shape[1];w.b(d===l.shape[2],(()=>"Error in conv2d: depth of input (".concat(d,") must match input depth for filter ").concat(l.shape[2],"."))),w.b(Qt(n,s),(()=>"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'")));const p={x:u,filter:l},f={strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o},m=c.a.runKernelFunc(((t,e)=>{const a=Zt(r),c=Vt(u.shape,l.shape,n,s,i,o,!1,a),h=t.conv2d(u,l,c);return e([u,l]),h}),p,null,W.A,f);return h?Nt(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});function $t(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function te(t,e,n){const i=t.length+e.length,r=[];let s=0,o=0;for(let a=0;a<i;a++)-1===n.indexOf(a)?r.push(t[s++]):r.push(e[o++]);return r}function ee(t,e){const n=[],i=t.length;for(let r=0;r<i;r++)-1===e.indexOf(r)&&n.push(t[r]);return[n,e.map((e=>t[e]))]}function ne(t,e){return te(t,e.map((t=>1)),e)}function ie(t,e,n){w.b($t(e,n),(()=>t+" supports only inner-most axes for now. "+"Got axes ".concat(e," and rank-").concat(n," input.")))}function re(t,e){if($t(t,e))return null;const n=[];for(let i=0;i<e;++i)-1===t.indexOf(i)&&n.push(i);return t.forEach((t=>n.push(t))),n}function se(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function oe(t,e){const n=[];for(let i=e-t;i<e;++i)n.push(i);return n}const ae=Object(q.a)({transpose_:function(t,e){const n=Object(G.a)(t,"x","transpose");if(null==e&&(e=n.shape.map(((t,e)=>e)).reverse()),w.b(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," must match length of perm ").concat(e,"."))),e.forEach((t=>{w.b(t>=0&&t<n.rank,(()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e))})),n.rank<=1)return n.clone();const i={x:n},r={perm:e};return c.a.runKernelFunc((t=>t.transpose(n,e)),i,null,W.Gc,r)}}),ce=Object(q.a)({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=Object(G.a)(t,"x","cumsum"),s={x:r},o={axis:e,exclusive:n,reverse:i};return c.a.runKernelFunc(((t,s)=>{const o=re([e],r.rank);let a=r;null!=o&&(a=ae(r,o));const c=oe(1,r.rank)[0];let l=t.cumsum(a,c,n,i);if(s([r]),null!=o){const t=se(o);l=ae(l,t)}return l}),s,null,W.J,o)}}),le=Object(q.a)({depthwiseConv2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=Object(G.a)(t,"x","depthwiseConv2d"),l=Object(G.a)(e,"filter","depthwiseConv2d");let u=a,h=!1;3===a.rank&&(h=!0,u=Nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),w.b(4===u.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got rank ".concat(u.rank,"."))),w.b(4===l.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+".")),w.b(u.shape[3]===l.shape[2],(()=>"Error in depthwiseConv2d: number of input channels (".concat(u.shape[3],") must match the inChannels dimension in filter ").concat(l.shape[2],"."))),null!=o&&w.b(w.v(i),(()=>"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")));const d={x:u,filter:l},p={strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o},f=c.a.runKernelFunc(((t,e)=>{null==s&&(s=[1,1]),w.b(Qt(n,s),(()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(s,"'")));const r=Vt(u.shape,l.shape,n,s,i,o,!0),a=t.depthwiseConv2D(u,l,r);return e([u,l]),a}),d,null,W.L,p);return h?Nt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),ue=Object(q.a)({floorDiv_:function(t,e){let n=Object(G.a)(t,"a","floorDiv"),i=Object(G.a)(e,"b","floorDiv");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.floorDiv(n,i);return e([n,i]),r}),r,null,W.cb)}}),he=Object(q.a)({div_:function(t,e){let n=Object(G.a)(t,"a","div"),i=Object(G.a)(e,"b","div");if([n,i]=Object(Ot.b)(n,i),"int32"===n.dtype&&"int32"===i.dtype)return ue(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.realDivide(n,i);return e([n,i]),r}),r,null,W.R,{})}}),de=Object(q.a)({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Object(G.a)(t,"a","matMul"),s=Object(G.a)(e,"b","matMul");[r,s]=Object(Ot.b)(r,s);const o={a:r,b:s},a={transposeA:n,transposeB:i};return c.a.runKernelFunc(((t,e)=>{e([r,s]);const o=n?r.shape[r.rank-2]:r.shape[r.rank-1],a=i?s.shape[s.rank-1]:s.shape[s.rank-2],c=n?r.shape[r.rank-1]:r.shape[r.rank-2],l=i?s.shape[s.rank-2]:s.shape[s.rank-1],u=r.shape.slice(0,-2),h=s.shape.slice(0,-2),d=w.N(u),p=w.N(h),f=d===p||1===d||1===p;w.b(r.rank>=2&&s.rank>=2&&f,(()=>"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (".concat(u,") and (").concat(h,")."))),w.b(o===a,(()=>"Error in matMul: inner shapes (".concat(o,") and (").concat(a,") of Tensors with shapes ").concat(r.shape," and ").concat(s.shape," and transposeA=").concat(n," and transposeB=").concat(i," must match.")));const m=(d>p?u:h).concat([c,l]),g=Nt(r,n?[d,o,c]:[d,c,o]),v=Nt(s,i?[p,l,a]:[p,a,l]),y=t.batchMatMul(g,v,n,i);return Nt(y,m)}),o,null,W.s,a)}}),pe=Object(q.a)({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"x","max"),r={x:i},s={reductionIndices:e,keepDims:n};return c.a.runKernelFunc(((t,r)=>{let s=w.I(e,i.shape);const o=re(s,i.rank);let a=i;null!=o&&(a=ae(i,o),s=oe(s.length,a.rank));const c=t.max(a,s);null!=o&&a.dispose();let l=c;if(n){const t=ne(l.shape,w.I(e,i.shape));l=Nt(l,t),c.dispose()}return r([i,l]),l}),r,null,W.yb,s)}}),fe=Object(q.a)({maxPool_:function(t,e,n,i,r){const s=Object(G.a)(t,"x","maxPool");let o=s,a=!1;3===s.rank&&(a=!0,o=Nt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),w.b(4===o.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,"."))),w.b(Qt(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '1'"))),null!=r&&w.b(w.v(i),(()=>"Error in maxPool: pad must be an integer when using, dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const l={x:o},u={filterSize:e,strides:n,pad:i,dimRoundingMode:r},h=c.a.runKernelFunc(((t,s)=>{const a=Ut(o.shape,e,n,1,i,r);let c;return c=1===a.filterWidth&&1===a.filterHeight&&w.a(a.inShape,a.outShape)?o.clone():t.maxPool(o,a),s([o,c]),c}),l,null,W.zb,u);return a?Nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),me=Object(q.a)({mul_:function(t,e){let n=Object(G.a)(t,"a","mul"),i=Object(G.a)(e,"b","mul");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.multiply(n,i);return e([n,i]),r}),r,null,W.Kb)}}),ge=Object(q.a)({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);const r=Object(G.a)(t,"indices","oneHot","int32"),s=[...r.shape,e],o={indices:r},a={depth:e,onValue:n,offValue:i};return c.a.runKernelFunc(((t,o)=>(o([r]),Nt(t.oneHot(Nt(r,[r.size]),e,n,i),s))),o,null,W.Qb,a)}}),ve=Object(q.a)({pow_:function(t,e){let n=Object(G.a)(t,"base","pow"),i=Object(G.a)(e,"exp","pow");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.pow(n,i);return e([n,i,r]),r}),r,null,W.Tb)}});var ye=n(47);class xe{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=ye.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const be=Object(q.a)({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>4?arguments[4]:void 0;const r=V(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),s=new xe(e,n,null,i);for(let o=0;o<r.values.length;o++)r.values[o]=s.nextValue();return r.toTensor()}});var we=n(28);function Se(t,e){Object(w.d)(t);const n=Object(G.c)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(we.a)(t,null,n,e)}var _e=n(19);function Te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=Te(t,"float32"),n=Te(t,"float32");return Object(_e.a)(e,n)}const n=Object(w.F)(Object(w.N)(t),e);return c.a.makeTensor(n,t,e)}function Ee(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:i};return c.a.runKernelFunc((()=>{if(t===e||t<e&&n<0||e<t&&n>1)return Te([0],i);const r=Math.abs(Math.ceil((e-t)/n)),s=Object(w.F)(r,i);e<t&&1===n&&(n=-1),s[0]=t;for(let t=1;t<s.length;t++)s[t]=s[t-1]+n;return Se(s,i)}),{},null,W.Wb,r)}function Ce(t,e){if((Object(w.A)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(w.A)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(we.a)(t,[],[],e)}const ke=Object(q.a)({separableConv2d_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const a=Object(G.a)(t,"x","separableConv2d"),c=Object(G.a)(e,"depthwiseFilter","separableConv2d"),l=Object(G.a)(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(3===a.rank&&(h=!0,u=Nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");w.b(4===u.rank,(()=>"Error in separableConv2d: input must be rank 4, but got rank ".concat(u.rank,"."))),w.b(4===c.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but got rank ".concat(c.rank,"."))),w.b(4===l.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but got rank ".concat(c.rank,"."))),w.b(1===l.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ".concat(l.shape[0],"."))),w.b(1===l.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ".concat(l.shape[1],".")));const d=c.shape[2],p=c.shape[3];w.b(l.shape[2]===d*p,(()=>"Error in separableConv2d: the third dimension of pointwise filter must be ".concat(d*p,", but got ").concat(l.shape[2],".")));const f=le(u,c,i,r,o,s),m=Jt(f,l,1,"valid",o);return h?Nt(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Ae=Object(q.a)({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Object(G.a)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and dim was ").concat(e));const i={logits:n},r={dim:e};return c.a.runKernelFunc(((t,i)=>{const r=t.softmax(n,e);return i([r]),r}),i,null,W.rc,r)}});function Ie(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if("number"==typeof e)Object(w.b)(t.shape[n]%e==0,(()=>"Number of splits must evenly divide the axis.")),i=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);Object(w.b)(r<=1,(()=>"There should be only one negative value in split array."));const s=e.indexOf(-1);if(-1!==s){const i=e.reduce(((t,e)=>e>0?t+e:t));e[s]=t.shape[n]-i}Object(w.b)(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),i=e}return i}const Oe=Object(q.a)({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Object(G.a)(t,"x","split"),r={x:i},s={numOrSizeSplits:e,axis:n};return c.a.runKernelFunc(((t,r)=>{const s=Object(w.I)(n,i.shape)[0],o=Ie(i,e,s);return t.split(i,o,s)}),r,null,W.uc,s)}}),Re=Object(q.a)({squeeze_:function(t,e){const n=Object(G.a)(t,"x","squeeze");return Nt(n,Object(w.P)(n.shape,e).newShape)}}),Ne=Object(q.a)({sub_:function(t,e){let n=Object(G.a)(t,"a","sub"),i=Object(G.a)(e,"b","sub");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.subtract(n,i);return e([n,i]),r}),r,null,W.Ac)}}),Me=Object(q.a)({tile_:function(t,e){const n=Object(G.a)(t,"x","tile",null);w.b(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," must match length of reps ").concat(e,".")));const i=[n],r={x:n},s={reps:e};return c.a.runKernelFunc(((t,i)=>{const r=t.tile(n,e);return i([n]),r}),r,null,W.Ec,s,i)}}),De=Object(q.a)({broadcastTo_:function(t,e){let n=Object(G.a)(t,"broadcastTo","x");const i=n.shape;if(e.some((t=>!(t>0)||t%1!=0)))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=Nt(n,t)}const r=n.shape,s=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])s[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(i,"] cannot be broadcast to [").concat(e,"]."));if(0===s.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0)).length)return X(n);const o={x:n},a={shape:e,inputShape:r};return c.a.runKernelFunc((t=>t.tile(n,s)),o,null,W.u,a)}});function Pe(t,e){const n=t.length,i=[];for(let r=0;r<n;r++){const s=n-1-r,o=t[s]||1;(e[e.length-1-r]||1)>1&&1===o&&i.unshift(s)}return i}function Fe(t,e){const n=[];for(let i=0;i<e.length;i++){const r=t[t.length-i-1],s=e.length-i-1,o=e[s];(null==r||1===r&&o>1)&&n.unshift(s)}return n}function Le(t,e){const n=[],i=Math.max(t.length,e.length);for(let r=0;r<i;r++){let i=t[t.length-r-1];null==i&&(i=1);let s=e[e.length-r-1];if(null==s&&(s=1),1===i)n.unshift(s);else if(1===s)n.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes ".concat(t," and ").concat(e,"."));n.unshift(i)}}return n}const Be=Object(q.a)({where_:function(t,e,n){const i=Object(G.a)(e,"a","where"),r=Object(G.a)(n,"b","where"),s=Object(G.a)(t,"condition","where","bool"),o=Le(i.shape,r.shape),a=De(i,o),l=De(r,o);1===s.rank&&Object(w.b)(s.shape[0]===i.shape[0],(()=>"The first dimension of `a` must match the size of `condition`.")),1!==s.rank&&Object(w.e)(s.shape,l.shape,"Error in where: ");const u={condition:s,t:a,e:l};return c.a.runKernelFunc(((t,e)=>{const n=t.select(s,a,l);return e([s]),n}),u,null,W.kc)}}),ze=Object(q.a)({zerosLike_:function(t){const e=Object(G.a)(t,"x","zerosLike"),n={x:e};return c.a.runKernelFunc((t=>t.zerosLike(e)),n,null,W.Kc)}}),Ue=Object(q.a)({imag_:function(t){const e=Object(G.a)(t,"input","imag"),n={input:e};return c.a.runKernelFunc((t=>t.imag(e)),n,null,W.kb)}}),je=Object(q.a)({real_:function(t){const e=Object(G.a)(t,"input","real"),n={input:e};return c.a.runKernelFunc((t=>t.real(e)),n,null,W.Xb)}}),Ve=Object(q.a)({slice_:function(t,e,n){const i=Object(G.a)(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");const r={x:i},s={begin:e,size:n};return c.a.runKernelFunc(((t,r)=>{const[s,o]=kt(i,e,n);return pt(i,s,o),r([i]),t.slice(i,s,o)}),r,null,W.qc,s)}}),We=Object(q.a)({fft_:function(t){Object(w.b)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 but got ".concat(t.dtype,".")));const e={input:t};return c.a.runKernelFunc((e=>{const n=t.shape[t.shape.length-1],i=t.size/n,r=t.as2D(i,n);return e.fft(r).reshape(t.shape)}),e,null,W.Y)}}),Ge=Object(q.a)({rfft_:function(t,e){Object(w.b)("float32"===t.dtype,(()=>"The dtype for rfft() must be real value but got "+t.dtype));let n=t.shape[t.shape.length-1];const i=t.size/n;let r;if(null!=e&&e<n){const i=t.shape.map((t=>0)),s=t.shape.map((t=>t));s[t.shape.length-1]=e,r=Ve(t,i,s),n=e}else if(null!=e&&e>n){const i=t.shape.map((t=>t));i[t.shape.length-1]=e-n,r=Bt([t,Te(i)],t.shape.length-1),n=e}else r=t;const s=ze(r),o=Nt(Object(_e.a)(r,s),[i,n]),a=We(o),c=Math.floor(n/2)+1,l=je(a),u=Ue(a),h=Oe(l,[c,n-c],l.shape.length-1),d=Oe(u,[c,n-c],u.shape.length-1),p=r.shape.slice();return p[r.shape.length-1]=c,Nt(Object(_e.a)(h[0],d[0]),p)}}),qe=Object(q.a)({ifft_:function(t){Object(w.b)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 but got ".concat(t.dtype,".")));const e={input:t};return c.a.runKernelFunc((e=>{const n=t.shape[t.shape.length-1],i=t.size/n,r=Nt(t,[i,n]),s=e.ifft(r);return Nt(s,t.shape)}),e,null,W.ib)}}),He=Object(q.a)({reverse_:function(t,e){const n=Object(G.a)(t,"x","reverse"),i={x:n},r={dims:e};return c.a.runKernelFunc((t=>{const i=Object(w.I)(e,n.shape);if(0===n.rank)return X(n);const r=t.reverse(n,i);return Nt(r,n.shape)}),i,null,W.gc,r)}}),Xe=Object(q.a)({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let i;if(e<=2){const r=Nt(t,[n,e]);i=qe(r)}else{const r=[n,2*(e-1)],s=Nt(je(t),[n,e]),o=Nt(Ue(t),[n,e]),a=He(Ve(s,[0,1],[n,e-2]),1),c=me(He(Ve(o,[0,1],[n,e-2]),1),Ce(-1)),l=Bt([s,a],1),u=Bt([o,c],1),h=Nt(Object(_e.a)(l,u),[r[0],r[1]]);i=qe(h)}if(i=je(i),3===t.rank&&0!==t.shape[0]){const e=i,n=t.shape[0];i=Nt(i,[n,i.shape[0]/n,i.shape[1]]),e.dispose()}return i}});function Ye(t,e,n){const i=1-t%2,r=new Float32Array(t);for(let s=0;s<t;++s){const o=2*Math.PI*s/(t+i-1);r[s]=e-n*Math.cos(o)}return Se(r,"float32")}Object(q.a)({hammingWindow_:function(t){return Ye(t,.54,.46)}});const Ke=Object(q.a)({hannWindow_:function(t){return Ye(t,.5,.5)}});function Qe(t,e,n){const i={shape:t,value:e,dtype:n};return c.a.runKernelFunc((i=>i.fill(t,e,n)),{},null,W.Z,i)}function Ze(t,e,n){if(Object(w.d)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const i=Object(G.c)(t,n);if(2!==i.length&&1!==i.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(we.a)(t,e,i,n)}const Je=Object(q.a)({frame_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=0;const o=[];for(;s+e<=t.size;)o.push(Ve(t,s,e)),s+=n;if(i)for(;s<t.size;){const i=s+e-t.size,a=Bt([Ve(t,s,e-i),Qe([i],r)]);o.push(a),s+=n}return 0===o.length?Ze([],[0,e]):Nt(Bt(o),[o.length,e])}});function $e(t,e,n,i,r,s){null==i&&(i=.5),null==r&&(r=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=t.shape[0];return n=Math.min(n,o),w.b(0<=i&&i<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(i,"'"))),w.b(2===t.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'"))),w.b(4===t.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1])),w.b(1===e.rank,(()=>"scores must be a 1D tensor")),w.b(e.shape[0]===o,(()=>"scores has incompatible shape with boxes. Expected ".concat(o,", but was ")+e.shape[0])),w.b(0<=s&&s<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(s,"'"))),{maxOutputSize:n,iouThreshold:i,scoreThreshold:r,softNmsSigma:s}}function tn(t,e,n){const i=function(t,e,n){return function(t,e,n){let i=0,r=t.length,s=0,o=!1;for(;i<r;){s=i+(r-i>>>1);const a=n(e,t[s]);a>0?i=s+1:(r=s,o=!a)}return o?i:-i-1}(t,e,n||en)}(t,e,n),r=i<0?-(i+1):i;t.splice(r,0,e)}function en(t,e){return t>e?1:t<e?-1:0}function nn(t,e,n,i,r){return on(t,e,n,i,r,0).selectedIndices}function rn(t,e,n,i,r,s){return on(t,e,n,i,r,0,!1,s,!0)}function sn(t,e,n,i,r,s){return on(t,e,n,i,r,s,!0)}function on(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=[];for(let g=0;g<e.length;g++)e[g]>r&&l.push({score:e[g],boxIndex:g,suppressBeginIndex:0});l.sort(ln);const u=s>0?-.5/s:0,h=[],d=[];for(;h.length<n&&l.length>0;){const e=l.pop(),{score:n,boxIndex:s,suppressBeginIndex:o}=e;if(n<r)break;let a=!1;for(let c=h.length-1;c>=o;--c){const n=an(t,s,h[c]);if(n>=i){a=!0;break}if(e.score=e.score*cn(i,u,n),e.score<=r)break}e.suppressBeginIndex=h.length,a||(e.score===n?(h.push(s),d.push(e.score)):e.score>r&&tn(l,e,ln))}const p=h.length,f=n-p;a&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:Se(h,"int32")};return o&&(m.selectedScores=Se(d,"float32")),c&&(m.validOutputs=Ce(p,"int32")),m}function an(t,e,n){const i=t.subarray(4*e,4*e+4),r=t.subarray(4*n,4*n+4),s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),c=Math.max(i[1],i[3]),l=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),p=(a-s)*(c-o),f=(h-l)*(d-u);if(p<=0||f<=0)return 0;const m=Math.max(s,l),g=Math.max(o,u),v=Math.min(a,h),y=Math.min(c,d),x=Math.max(v-m,0)*Math.max(y-g,0);return x/(p+f-x)}function cn(t,e,n){const i=Math.exp(e*n*n);return n<=t?i:0}function ln(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}Object(q.a)({stft_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ke;var s;null==i&&(s=e,i=Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))));const o=Je(t,e,n),a=me(o,r(e)),c=[];for(let l=0;l<o.shape[0];l++)c.push(Ge(Ve(a,[l,0],[1,e]),i));return Bt(c)}}),Object(q.a)({cropAndResize_:function(t,e,n,i,r,s){const o=Object(G.a)(t,"image","cropAndResize"),a=Object(G.a)(e,"boxes","cropAndResize","float32"),l=Object(G.a)(n,"boxInd","cropAndResize","int32");r=r||"bilinear",s=s||0;const u=a.shape[0];w.b(4===o.rank,(()=>"Error in cropAndResize: image must be rank 4,but got rank ".concat(o.rank,"."))),w.b(2===a.rank&&4===a.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(u,",4] but had shape ").concat(a.shape,"."))),w.b(1===l.rank&&l.shape[0]===u,(()=>"Error in cropAndResize: boxInd must be have size [".concat(u,"] but had shape ").concat(a.shape,"."))),w.b(2===i.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got length ".concat(i.length,"."))),w.b(i[0]>=1&&i[1]>=1,(()=>"cropSize must be atleast [1,1], but was "+i)),w.b("bilinear"===r||"nearest"===r,(()=>"method must be bilinear or nearest, but was "+r));const h={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:s,cropSize:i};return c.a.runKernelFunc((t=>t.cropAndResize(o,a,l,i,r,s)),h,null,W.I,d)}}),Object(q.a)({flipLeftRight_:function(t){const e=Object(G.a)(t,"image","flipLeftRight","float32");w.b(4===e.rank,(()=>"Error in flipLeftRight: image must be rank 4,but got rank ".concat(e.rank,".")));const n={image:e};return c.a.runKernel(W.ab,n,{})}}),Object(q.a)({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const r=Object(G.a)(t,"image","rotateWithOffset","float32");w.b(4===r.rank,(()=>"Error in rotateWithOffset: image must be rank 4,but got rank ".concat(r.rank,".")));const s={image:r},o={radians:e,fillValue:n,center:i};return c.a.runKernel(W.hc,s,o)}}),Object(q.a)({nonMaxSuppression_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const s=Object(G.a)(t,"boxes","nonMaxSuppression"),o=Object(G.a)(e,"scores","nonMaxSuppression"),a=$e(s,o,n,i,r);n=a.maxOutputSize,i=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:i,scoreThreshold:r};return c.a.runKernelFunc((t=>t.nonMaxSuppression(s,o,n,i,r)),{boxes:s,scores:o},null,W.Mb,l)}}),Object(q.a)({nonMaxSuppressionWithScore_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=Object(G.a)(t,"boxes","nonMaxSuppression"),a=Object(G.a)(e,"scores","nonMaxSuppression"),l=$e(o,a,n,i,r,s),u={boxes:o,scores:a},h={maxOutputSize:n=l.maxOutputSize,iouThreshold:i=l.iouThreshold,scoreThreshold:r=l.scoreThreshold,softNmsSigma:s=l.softNmsSigma},d=c.a.runKernel(W.Ob,u,h);return{selectedIndices:d[0],selectedScores:d[1]}}}),Object(q.a)({nonMaxSuppressionPadded_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=Object(G.a)(t,"boxes","nonMaxSuppression"),a=Object(G.a)(e,"scores","nonMaxSuppression"),l=$e(o,a,n,i,r,null),u={boxes:o,scores:a},h={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:s},d=c.a.runKernel(W.Nb,u,h);return{selectedIndices:d[0],validOutputs:d[1]}}});const un=Object(q.a)({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"images","resizeBilinear");w.b(3===i.rank||4===i.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got rank ".concat(i.rank,"."))),w.b(2===e.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."));let r=i,s=!1;3===i.rank&&(s=!0,r=Nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[o,a]=e,l={images:r},u={alignCorners:n,size:e},h=c.a.runKernelFunc(((t,e)=>(e([r]),t.resizeBilinear(r,o,a,n))),l,null,W.cc,u);return s?Nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),hn=Object(q.a)({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"images","resizeNearestNeighbor");w.b(3===i.rank||4===i.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ".concat(i.rank,"."))),w.b(2===e.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+".")),w.b("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype"));let r=i,s=!1;3===i.rank&&(s=!0,r=Nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[o,a]=e,l={images:r},u={alignCorners:n,size:e},h=c.a.runKernelFunc(((t,e)=>(e([r]),t.resizeNearestNeighbor(r,o,a,n))),l,null,W.ec,u);return s?Nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),dn=Object(q.a)({greaterEqual_:function(t,e){let n=Object(G.a)(t,"a","greaterEqual"),i=Object(G.a)(e,"b","greaterEqual");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.greaterEqual(n,i);return e([n,i]),r}),r,null,W.hb)}}),pn=Object(q.a)({lessEqual_:function(t,e){let n=Object(G.a)(t,"a","lessEqual"),i=Object(G.a)(e,"b","lessEqual");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.lessEqual(n,i);return e([n,i]),r}),r,null,W.rb)}}),fn=Object(q.a)({logicalAnd_:function(t,e){const n=Object(G.a)(t,"a","logicalAnd","bool"),i=Object(G.a)(e,"b","logicalAnd","bool");Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.logicalAnd(n,i)),r,null,W.vb)}}),mn=Object(q.a)({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object(G.a)(t,"x","expandDims",null);w.b(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const i=n.shape.slice();return e<0&&(w.b(-(n.rank+1)<=e,(()=>"Axis must be in the interval [".concat(-(n.rank+1),", ").concat(n.rank,"]"))),e=n.rank+e+1),i.splice(e,0,1),Nt(n,i)}}),gn=Object(q.a)({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object(G.b)(t,"tensors","stack");if(w.b(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),1===n.length)return mn(n[0],e);const i=n[0].rank,r=n[0].shape,s=n[0].dtype;w.b(e<=i,(()=>"Axis must be <= rank of the tensor")),n.forEach((t=>{w.e(r,t.shape,"All tensors passed to stack must have matching shapes"),w.b(s===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=n.map((t=>mn(t,e)));return Bt(o,e)}}),vn=Object(q.a)({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object(G.a)(t,"x","unstack");w.b(e>=-n.shape.length&&e<n.shape.length,(()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"))),e<0&&(e+=n.shape.length);const i={value:n},r={axis:e};return c.a.runKernelFunc((t=>t.unstack(n,e)),i,null,W.Ic,r)}});Object(q.a)({bandPart_:function(t,e,n){Object(w.b)(e%1==0,(()=>"bandPart(): numLower must be an integer, got ".concat(e,"."))),Object(w.b)(n%1==0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")));const i=Object(G.a)(t,"a","bandPart");Object(w.b)(i.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(i.rank,".")));const r=i.shape,[s,o]=i.shape.slice(-2);if(!(e<=s))throw new Error("bandPart(): numLower (".concat(e,") must not be greater than the number of rows (").concat(s,")."));if(!(n<=o))throw new Error("bandPart(): numUpper (".concat(n,") must not be greater than the number of columns (").concat(o,")."));e<0&&(e=s),n<0&&(n=o);const a=Nt(Ee(0,s,1,"int32"),[-1,1]),c=Ee(0,o,1,"int32"),l=Ne(a,c),u=fn(pn(l,Ce(+e,"int32")),dn(l,Ce(-n,"int32"))),h=Te([s,o],i.dtype);return Nt(gn(vn(Nt(i,[-1,s,o])).map((t=>Be(u,t,h)))),r)}});const yn=Object(q.a)({abs_:function(t){const e=Object(G.a)(t,"x","abs"),n={x:e};return c.a.runKernelFunc(((t,n)=>(n([e]),"complex64"===e.dtype?t.complexAbs(e):t.abs(e))),n,null,W.a)}}),xn=Object(q.a)({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"x","min"),r={x:i},s={axis:e,keepDims:n};return c.a.runKernelFunc(((t,r)=>{const s=Object(w.I)(e,i.shape);let o=s;const a=re(o,i.rank);let c=i;null!=a&&(c=ae(i,a),o=oe(o.length,i.rank));const l=t.min(c,o);null!=a&&c.dispose();let u=l;if(n){const t=ne(u.shape,s);u=Nt(l,t),l.dispose()}return r([i,u]),u}),r,null,W.Gb,s)}}),bn=Object(q.a)({sqrt_:function(t){const e=Object(G.a)(t,"x","sqrt"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.sqrt(e);return n([e]),i}),n,null,W.vc)}}),wn=Object(q.a)({square_:function(t){const e=Object(G.a)(t,"x","square"),n=[e];return c.a.runKernelFunc(((t,n)=>(n([e]),t.square(e))),{x:e},null,"Square",{},n,[])}}),Sn=Object(q.a)({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(G.a)(t,"x","sum");"bool"===i.dtype&&(i=H(i,"int32"));const r={x:i},s={axis:e,keepDims:n};return c.a.runKernelFunc(((t,r)=>{r([i]);const s=Object(w.I)(e,i.shape),o=re(s,i.rank);let a=s,c=i;null!=o&&(c=ae(i,o),a=oe(a.length,i.rank));let l=t.sum(c,a);if(n){const t=ne(l.shape,s);l=Nt(l,t)}return l}),r,null,W.Bc,s)}}),_n=Object(q.a)({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=function t(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return yn(e);if(1!==e.rank&&null===i)return t(Nt(e,[-1]),n,i);if(1===e.rank||"number"==typeof i||Array.isArray(i)&&1===i.length){if(1===n)return Sn(yn(e),i);if(n===1/0)return pe(yn(e),i);if(n===-1/0)return xn(yn(e),i);if("euclidean"===n||2===n)return bn(Sn(ve(yn(e),Ce(2,"int32")),i));throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(i)&&2===i.length){if(1===n)return pe(Sn(yn(e),i[0]),i[1]-1);if(n===1/0)return pe(Sn(yn(e),i[1]),i[0]);if(n===-1/0)return xn(Sn(yn(e),i[1]),i[0]);if("fro"===n||"euclidean"===n)return bn(Sn(wn(e),i));throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+i)}(t=Object(G.a)(t,"x","norm"),e,n);let s=r.shape;if(i){const e=Object(w.I)(n,t.shape);s=ne(r.shape,e)}return Nt(r,s)}});function Tn(t){Object(l.b)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function En(){return c.a}function Cn(t,e){return c.a.tidy(t,e)}function kn(t){Object(Ot.a)(t).forEach((t=>t.dispose()))}function An(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return c.a.registerBackend(t,e,n)}Object(q.a)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,Object(w.b)(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)Object(w.b)(t[e].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: (".concat(t[e].shape[0]," vs. ").concat(n,")")))}else e=!0,t=Oe(t,t.shape[0],0).map((t=>Re(t,[0])));Object(w.b)(t.length<=t[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds number of dimensions (").concat(t[0].shape[0],").")));const n=[],i=t;for(let r=0;r<t.length;++r)n.push(c.a.tidy((()=>{let t=i[r];if(r>0)for(let e=0;e<r;++e){const i=me(Sn(me(n[e],t)),n[e]);t=Ne(t,i)}return he(t,_n(t,"euclidean"))})));return e?gn(n,0):n}}),Object(j.d)(Tn);const In=Object(q.a)({eye_:function(t,e,n){null==e&&(e=t);const i=V([t,e],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),r=t<=e?t:e;for(let o=0;o<r;++o)i.set(1,o,o);const s=Nt(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return Me(mn(s,0),[n[0],1,1]);if(2===n.length)return Me(mn(mn(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Me(mn(mn(mn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received ".concat(n.length,"D."))}}),On=Object(q.a)({greater_:function(t,e){let n=Object(G.a)(t,"a","greater"),i=Object(G.a)(e,"b","greater");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.greater(n,i)),r,null,W.gb)}}),Rn=Object(q.a)({neg_:function(t){const e=Object(G.a)(t,"x","neg"),n={x:e};return c.a.runKernelFunc((t=>t.neg(e)),n,null,W.Lb)}});function Nn(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c.a.tidy((()=>{Object(w.b)(2===t.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")));const n=t.shape[0],i=t.shape[1];let r=In(n),s=X(t);const o=Ze([[1]],[1,1]);let a=X(o);const l=n>=i?i:n;for(let t=0;t<l;++t){const e=s,l=a,u=r;[a,s,r]=c.a.tidy((()=>{const e=Ve(s,[t,t],[n-t,1]),c=_n(e),l=Ve(s,[t,t],[1,1]),u=Be(On(l,0),Ze([[-1]]),Ze([[1]])),h=Ne(l,me(u,c)),d=he(e,h);a=1===d.shape[0]?X(o):Bt([o,Ve(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=Rn(he(de(u,h),c)),f=Ve(s,[t,0],[n-t,i]),m=me(p,a),g=ae(a);if(0===t)s=Ne(f,de(m,de(g,f)));else{const e=Ne(f,de(m,de(g,f)));s=Bt([Ve(s,[0,0],[t,i]),e],0)}const v=ae(m),y=Ve(r,[0,t],[n,r.shape[1]-t]);if(0===t)r=Ne(y,de(de(y,a),v));else{const e=Ne(y,de(de(y,a),v));r=Bt([Ve(r,[0,0],[n,t]),e],1)}return[a,s,r]})),kn([e,l,u])}return!e&&n>i&&(r=Ve(r,[0,0],[n,i]),s=Ve(s,[0,0],[i,i])),[r,s]}))}var Mn;function Dn(t){return c.a.customGrad(t)}function Pn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=Pn(t,"float32"),n=Te(t,"float32");return Object(_e.a)(e,n)}const n=Object(w.D)(Object(w.N)(t),e);return c.a.makeTensor(n,t,e)}Object(q.a)({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(w.b)(t.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank "+t.rank)),2===t.rank)return Nn(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),i=vn(Nt(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],s=[];return i.forEach((t=>{const[n,i]=Nn(t,e);r.push(n),s.push(i)})),[Nt(gn(r,0),t.shape),Nt(gn(s,0),t.shape)]}}}),function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Mn||(Mn={}));const Fn=Object(q.a)({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"x","mean"),r=Object(w.I)(e,i.shape),s=ee(i.shape,r)[1],o=Object(w.N)(s),a={x:i},l={axis:e,keepDims:n},u=()=>{const t=Ce(o),r=t.dtype===i.dtype?i:H(i,t.dtype),s=he(r,t);return Sn(s,e,n)};return Dn((t=>({value:c.a.runKernelFunc(u,a,null,W.Fb,l),gradFunc:e=>{const n=t.shape.slice();r.forEach((t=>{n[t]=1}));const i=Nt(e,n);return he(me(i,Pn(t.shape,"float32")),o)}})))(i)}}),Ln=Object(q.a)({notEqual_:function(t,e){let n=Object(G.a)(t,"a","notEqual"),i=Object(G.a)(e,"b","notEqual");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.notEqual(n,i)),r,null,W.Pb)}}),Bn=Object(q.a)({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mn.SUM_BY_NONZERO_WEIGHTS;const i=Object(G.a)(t,"losses","computeWeightedLoss");let r=null;null!=e&&(r=Object(G.a)(e,"weights","computeWeightedLoss"));const s=null==r?i:me(i,r);if(n===Mn.NONE)return s;if(n===Mn.SUM)return Sn(s);if(n===Mn.MEAN){if(null==r)return Fn(s);{const t=i.size/r.size,e=he(Sn(s),Sn(r));return t>1?he(e,Ce(t)):e}}if(n===Mn.SUM_BY_NONZERO_WEIGHTS){if(null==r)return he(Sn(s),Ce(i.size));{const t=me(r,Pn(i.shape)),e=H(Sn(Ln(t,Ce(0))),"float32");return he(Sn(s),e)}}throw Error("Unknown reduction: "+n)}});Object(q.a)({absoluteDifference_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mn.SUM_BY_NONZERO_WEIGHTS;const r=Object(G.a)(t,"labels","absoluteDifference"),s=Object(G.a)(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=Object(G.a)(n,"weights","absoluteDifference")),Object(w.e)(r.shape,s.shape,"Error in absoluteDifference: ");const a=yn(Ne(r,s));return Bn(a,o,i)}}),Object(q.a)({cosineDistance_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Mn.SUM_BY_NONZERO_WEIGHTS;const s=Object(G.a)(t,"labels","cosineDistance"),o=Object(G.a)(e,"predictions","cosineDistance");let a=null;null!=i&&(a=Object(G.a)(i,"weights","cosineDistance")),Object(w.e)(s.shape,o.shape,"Error in cosineDistance: ");const c=Ce(1),l=Ne(c,Sn(me(s,o),n,!0));return Bn(l,a,r)}});const zn=Object(q.a)({relu_:function(t){const e=Object(G.a)(t,"x","relu"),n={x:e};return c.a.runKernelFunc(((t,n)=>(n([e]),"bool"===e.dtype?H(e,"int32"):t.relu(e))),n,null,W.Zb)}});Object(q.a)({hingeLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mn.SUM_BY_NONZERO_WEIGHTS,r=Object(G.a)(t,"labels","hingeLoss");const s=Object(G.a)(e,"predictions","hingeLoss");let o=null;null!=n&&(o=Object(G.a)(n,"weights","hingeLoss")),Object(w.e)(r.shape,s.shape,"Error in hingeLoss: ");const a=Ce(1);r=Ne(me(Ce(2),r),a);const c=zn(Ne(a,me(r,s)));return Bn(c,o,i)}});const Un=Object(q.a)({minimum_:function(t,e){let n=Object(G.a)(t,"a","minimum"),i=Object(G.a)(e,"b","minimum");[n,i]=Object(Ot.b)(n,i),"bool"===n.dtype&&(n=H(n,"int32"),i=H(i,"int32")),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.minimum(n,i);return e([n,i]),r}),r,null,W.Hb)}});Object(q.a)({huberLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Mn.SUM_BY_NONZERO_WEIGHTS;const s=Object(G.a)(t,"labels","huberLoss"),o=Object(G.a)(e,"predictions","huberLoss");let a=null;null!=n&&(a=Object(G.a)(n,"weights","huberLoss")),Object(w.e)(s.shape,o.shape,"Error in huberLoss: ");const c=Ce(i),l=yn(Ne(o,s)),u=Un(l,c),h=Ne(l,u),d=Rt(me(Ce(.5),wn(u)),me(c,h));return Bn(d,a,r)}});const jn=Object(q.a)({log_:function(t){const e=Object(G.a)(t,"x","log"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.log(e);return n([e]),i}),n,null,W.sb)}});Object(q.a)({logLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Mn.SUM_BY_NONZERO_WEIGHTS;const s=Object(G.a)(t,"labels","logLoss"),o=Object(G.a)(e,"predictions","logLoss");let a=null;null!=n&&(a=Object(G.a)(n,"weights","logLoss")),Object(w.e)(s.shape,o.shape,"Error in logLoss: ");const c=Ce(1),l=Ce(i),u=Rn(me(s,jn(Rt(o,l)))),h=me(Ne(c,s),jn(Rt(Ne(c,o),l))),d=Ne(u,h);return Bn(d,a,r)}});const Vn=Object(q.a)({squaredDifference_:function(t,e){let n=Object(G.a)(t,"a","squaredDifference"),i=Object(G.a)(e,"b","squaredDifference");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.squaredDifference(n,i);return e([n,i]),r}),r,null,W.xc,{})}});Object(q.a)({meanSquaredError_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mn.SUM_BY_NONZERO_WEIGHTS;const r=Object(G.a)(t,"labels","meanSquaredError"),s=Object(G.a)(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=Object(G.a)(n,"weights","meanSquaredError")),Object(w.e)(r.shape,s.shape,"Error in meanSquaredError: ");const a=Vn(r,s);return Bn(a,o,i)}});const Wn=Object(q.a)({exp_:function(t){const e=Object(G.a)(t,"x","exp"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.exp(e);return n([i]),i}),n,null,W.W)}}),Gn=Object(q.a)({log1p_:function(t){const e=Object(G.a)(t,"x","log1p"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.log1p(e);return n([e]),i}),n,null,W.tb)}});Object(q.a)({sigmoidCrossEntropy_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Mn.SUM_BY_NONZERO_WEIGHTS,s=Object(G.a)(t,"multiClassLabels","sigmoidCrossEntropy");const o=Object(G.a)(e,"logits","sigmoidCrossEntropy");let a=null;if(null!=n&&(a=Object(G.a)(n,"weights","sigmoidCrossEntropy")),Object(w.e)(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),i>0){const t=Ce(i),e=Ce(1),n=Ce(.5);s=Rt(me(s,Ne(e,t)),me(n,t))}const c=function(t,e){const n=Object(G.a)(t,"labels","sigmoidCrossEntropyWithLogits"),i=Object(G.a)(e,"logits","sigmoidCrossEntropyWithLogits");Object(w.e)(n.shape,i.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=zn(i),s=me(i,n),o=Gn(Wn(Rn(yn(i))));return Rt(Ne(r,s),o)}(s,o);return Bn(c,a,r)}});const qn=Object(q.a)({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(G.a)(t,"x","logSumExp"),r=Object(w.I)(e,i.shape),s=pe(i,r,!0),o=Ne(i,s),a=Wn(o),c=Sn(a,r),l=jn(c),u=Rt(Nt(s,l.shape),l);if(n){const t=ne(u.shape,r);return Nt(u,t)}return u}});Object(q.a)({softmaxCrossEntropy_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Mn.SUM_BY_NONZERO_WEIGHTS,s=Object(G.a)(t,"onehotLabels","softmaxCrossEntropy");const o=Object(G.a)(e,"logits","softmaxCrossEntropy");let a=null;if(null!=n&&(a=Object(G.a)(n,"weights","softmaxCrossEntropy")),Object(w.e)(s.shape,o.shape,"Error in softmaxCrossEntropy: "),i>0){const t=Ce(i),e=Ce(1),n=Ce(s.shape[1]);s=Rt(me(s,Ne(e,t)),he(t,n))}const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ".concat(e.rank," and dim was ")+n);return Dn(((t,e,i)=>{const r=qn(e,[n],!0),s=Ne(H(e,"float32"),r);i([t,s]);const o=Rn(me(s,t));return{value:Sn(o,[n]),gradFunc:(t,e)=>{const[i,r]=e,s=ne(t.shape,[n]);return[me(Nt(t,s),Ne(H(i,"float32"),Wn(r))),me(Nt(t,s),Ne(Wn(r),H(i,"float32")))]}}}))(t,e)}(s,o);return Bn(c,a,r)}});var Hn=n(26),Xn=n(78);const Yn=Object(q.a)({elu_:function(t){const e=Object(G.a)(t,"x","elu"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.elu(e);return n([i]),i}),n,null,W.S)}}),Kn=Object(q.a)({prelu_:function(t,e){const n=Object(G.a)(t,"x","prelu"),i=Object(G.a)(e,"alpha","prelu"),r={x:n,alpha:i};return c.a.runKernelFunc(((t,e)=>{const r=t.prelu(n,i);return e([n,i]),r}),r,null,W.Ub)}}),Qn=Object(q.a)({relu6_:function(t){const e=Object(G.a)(t,"x","relu6"),n={x:e};return c.a.runKernelFunc(((t,n)=>(n([e]),"bool"===e.dtype?H(e,"int32"):t.relu6(e))),n,null,W.ac)}}),Zn=Object(q.a)({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object(G.a)(t,"x","step"),i={x:n},r={alpha:e};return c.a.runKernelFunc((t=>t.step(n,e)),i,null,W.yc,r)}});function Jn(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return me(t,Zn(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function $n(t,e){let n=e;const i=Fe(t.shape,e.shape);return i.length>0&&(n=Sn(n,i)),Nt(n,t.shape)}function ti(t,e,n){if("linear"===e)return t;if("relu"===e)return zn(t);if("elu"===e)return Yn(t);if("relu6"===e)return Qn(t);if("prelu"===e)return Kn(t,n);throw new Error("Unknown fused activation ".concat(e,"."))}const ei=(t,e)=>!(t>0)||"linear"===e,ni=30;function ii(t){return t<=ni?t:Object(w.G)(t,Math.floor(Math.sqrt(t)))}function ri(t,e,n){return[n*("number"==typeof t?t:t[0]),e*("number"==typeof t?t:t[1])]}function si(t,e,n){let i=[];if(arguments.length>3&&void 0!==arguments[3]&&!arguments[3]){i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}else i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));return i}function oi(t,e){const n=[];if(arguments.length>2&&void 0!==arguments[2]&&!arguments[2]){const i=[],r=[];for(let n=1;n<t;++n)n>=2*e+1||n%2==1?r.push(n):i.push(n);n.push(...i),n.push(0),n.push(...r)}else{n.push(e);for(let i=e+1;i<t;++i)i<=2*e?(n.push(i),n.push(i-(e+1))):n.push(i)}return n}function ai(t,e,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=[];i?r.push(t[0]/n):r.push(t[0]*n);for(let s=1;s<t.length;++s)s<=e.length?i?r.push(e[s-1]*t[s]):r.push(t[s]/e[s-1]):r.push(t[s]);return r}function ci(t,e){const n=[0];for(let i=0;i<e;++i)n.push(t[i][0]);return n}function li(t,e,n){const i=t.slice(0,1);for(let r=0;r<n;++r)i.push(t[r+1]-e[r][0]-e[r][1]);return i}function ui(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was ".concat(e.dtype,"."));if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: ".concat(e.shape[e.rank-1]," vs. ").concat(t.rank));if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: ".concat(t.shape,"."));const n=e.shape,i=n[n.length-1];let r=1;for(let l=0;l<n.length-1;++l)r*=n[l];const s=t.shape,o=n.slice();o.pop();let a=1;for(let l=i;l<t.rank;++l)a*=s[l],o.push(s[l]);const c=[...Object(w.j)(t.shape).map((t=>t/a)),1].slice(0,i);return[o,r,a,c]}function hi(t,e,n){const i=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(i,", and batchDim: ").concat(r,".");if(n.rank<r)throw new Error(s+" update.rank < ".concat(r,". "));if(t.length<i+(n.rank-r))throw new Error(s+" Output shape length < "+(i+(n.rank-r)));if(n.rank!==r+t.length-i)throw new Error(s+" update.rank != "+(r+t.length-i));for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(s+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+i])throw new Error(s+" updates.shape[".concat(o+r,"] (").concat(n.shape[o+r],") != shape[").concat(o+r,"] (").concat(t[o+r],")"))}function di(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}hi(n,e,t)}function pi(t,e,n){const i=e.shape.length,r=i>1?e.shape[i-1]:1,s=n.length;let o=1;for(let c=r;c<s;++c)o*=n[c];const a=r<1?1:r;return{sliceRank:r,numUpdates:Object(w.N)(e.shape)/a,sliceSize:o,strides:[...Object(w.j)(n.slice(0,r)),1],outputSize:Object(w.N)(n)}}const fi=1.7580993408473768,mi=1.0507009873554805,gi=.3275911,vi=.254829592,yi=-.284496736,xi=1.421413741,bi=-1.453152027,wi=1.061405429;function Si(){Object(l.b)().getBool("IS_TEST")||console.warn(...arguments)}function _i(){Object(l.b)().getBool("IS_TEST")||console.log(...arguments)}function Ti(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let i=0;i<n.length;i+=2)n[i]=t[i/2],n[i+1]=e[i/2];return n}function Ei(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let i=0;i<t.length;i+=2)e[i/2]=t[i],n[i/2]=t[i+1];return{real:e,imag:n}}function Ci(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function ki(t){const e=Math.floor(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function Ai(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Ii(t,e,n,i){t[2*i]=e,t[2*i+1]=n}function Oi(t,e){const n=new Float32Array(t/2),i=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const s=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(s),i[r]=Math.sin(s)}return{real:n,imag:i}}function Ri(t,e,n){const i=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(i),imag:Math.sin(i)}}function Ni(t,e){let n,i=!1;for(t<=ni?(n=t,i=!0):n=Object(w.G)(t,Math.floor(Math.sqrt(t)));!i;)n>e||n===t?i=!0:n=Object(w.G)(t,n+1);return n}function Mi(t,e,n){const i=[],r=t.length;for(let s=0;s<r;s++)s!==e?i.push(t[s]):i.push(n);return i}function Di(t,e,n){const i=t.shape[n],r=[];let s=1,o=1;for(let a=0;a<n;a++)r.push(t.shape[a]),s*=t.shape[a];for(let a=0;a<e.rank;a++)r.push(e.shape[a]);for(let a=n+1;a<t.rank;a++)r.push(t.shape[a]),o*=t.shape[a];return{batchSize:s,sliceSize:o,dimSize:i,outputShape:r}}function Pi(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=Te(t.shape),i=H(t,"float32"),r=n.complex(i,e);return e.dispose(),i.dispose(),r}if(!Object(w.p)(t.dtype,e))return c.a.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const i=n.real(t),r=H(i,e);return i.dispose(),r}if("int32"===e)return n.int(t);if("bool"===e){const e=Ce(0,t.dtype),i=n.notEqual(t,e);return e.dispose(),i}throw new Error("Error in Cast: failed to cast ".concat(t.dtype," to ").concat(e))}function Fi(t,e){return c.a.makeTensorFromDataId(t.dataId,e,t.dtype)}function Li(t,e,n){const i=(e-t)/(n-1),r=Object(w.F)(n,"float32");r[0]=t;for(let s=1;s<r.length;s++)r[s]=r[s-1]+i;return Se(r,"float32")}var Bi=n(46);function zi(t,e,n){const i=new Array(t.rank).fill(0),r=t.shape.slice();return e.map((e=>{const s=[...r];s[n]=e;const o=Ve(t,i,s);return i[n]+=e,o}))}function Ui(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const i=V(n,t.dtype);for(let r=0;r<i.values.length;++r){const e=i.indexToLoc(r),n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=e[i]%t.shape[i];const s=t.locToIndex(n);i.values[r]=t.values[s]}return i.toTensor()}function ji(t,e,n,i,r){const s=e[e.length-1],[o,a]=[t.length/s,s],c=Object(w.o)(n,o*i),l=Object(w.o)("int32",o*i);for(let h=0;h<o;h++){const e=h*a,n=t.subarray(e,e+a),r=[];for(let t=0;t<n.length;t++)r.push({value:n[t],index:t});r.sort(((t,e)=>e.value-t.value));const s=h*i,o=c.subarray(s,s+i),u=l.subarray(s,s+i);for(let t=0;t<i;t++)o[t]=r[t].value,u[t]=r[t].index}const u=e.slice();return u[u.length-1]=i,[Object(Lt.a)(c,u,n),Object(Lt.a)(l,u,"int32")]}function Vi(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const i=V(t,"int32"),r=V([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const e=i.indexToLoc(n[s]),o=s*t.length;r.values.set(e,o)}return r.toTensor()}var Wi=n(39);const Gi={kernelName:W.a,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,Zn(H(n,"float32"),-1))}}},qi={kernelName:W.b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=wn(H(n,"float32")),i=bn(Ne(Ce(1),e));return Rn(he(t,i))}}}},Hi={kernelName:W.c,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=bn(Ne(wn(H(n,"float32")),1));return he(t,e)}}}},Xi={kernelName:W.d,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{let e=t;const i=Fe(n.shape,r);return i.length>0&&(e=Sn(e,i)),Nt(e,n.shape)},b:()=>{let e=t;const n=Fe(i.shape,r);return n.length>0&&(e=Sn(e,n)),Nt(e,i.shape)}}}},Yi={kernelName:W.e,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,i)=>{n[i]=()=>t.clone()})),n}},Ki={kernelName:W.h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(n)}}},Qi={kernelName:W.i,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(n)}}},Zi={kernelName:W.j,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,bn(Ne(Ce(1),wn(H(n,"float32")))))}}},Ji={kernelName:W.k,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=bn(Rt(Ce(1),wn(H(n,"float32"))));return he(t,e)}}}},$i={kernelName:W.m,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{const e=Rt(wn(n),wn(i));let s=me(t,he(i,e));const o=Fe(n.shape,r);return o.length>0&&(s=Sn(s,o)),Nt(s,n.shape)},b:()=>{const e=Rt(wn(n),wn(i));let s=Rn(me(t,he(n,e)));const o=Fe(i.shape,r);return o.length>0&&(s=Sn(s,o)),Nt(s,i.shape)}}}},tr={kernelName:W.l,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,Rt(wn(H(n,"float32")),1))}}},er={kernelName:W.n,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,Ne(Ce(1),wn(H(n,"float32"))))}}},nr=Object(q.a)({avgPool3dBackprop_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;const a=Object(G.a)(t,"dy","avgPool3dBackprop"),l=Object(G.a)(e,"input","avgPool3dBackprop");let u=a,h=l,d=!1;4===l.rank&&(d=!0,u=Nt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=Nt(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),w.b(5===u.rank,(()=>"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+u.rank+".")),w.b(5===h.rank,(()=>"Error in avgPool3dBackprop: input must be rank 5 but got rank "+h.rank+".")),w.b(Qt(i,r),(()=>"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides ".concat(i," and dilations '").concat(r,"'"))),null!=o&&w.b(w.v(s),(()=>"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(s,".")));const p={dy:u,input:h},f={filterSize:n,strides:i,dilations:r,pad:s,dimRoundingMode:o},m=c.a.runKernelFunc((t=>{const e=jt(h.shape,n,i,r,s,o);return t.avgPool3dBackprop(u,h,e)}),p,null,W.q,f);return d?Nt(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),ir={kernelName:W.p,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,dilations:o,pad:a,dimRoundingMode:c}=n,l=null==o?[1,1,1]:o;return{x:()=>nr(t,i,r,s,l,a,c)}}},rr=Object(q.a)({avgPoolBackprop_:function(t,e,n,i,r){const s=Object(G.a)(t,"dy","avgPoolBackprop"),o=Object(G.a)(e,"input","avgPoolBackprop");w.b(o.rank===s.rank,(()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(s.rank,")")));let a=o,l=s,u=!1;3===o.rank&&(u=!0,a=Nt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=Nt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),w.b(4===l.rank,(()=>"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+".")),w.b(4===a.rank,(()=>"Error in avgPoolBackprop: input must be rank 4 but got rank "+a.rank+"."));const h={dy:l,input:a},d={filterSize:n,strides:i,pad:r},p=c.a.runKernelFunc((t=>{const e=Ut(a.shape,n,i,1,r);return t.avgPoolBackprop(l,a,e)}),h,null,W.r,d);return u?Nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),sr={kernelName:W.o,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,pad:o}=n;return{x:()=>rr(t,i,r,s,o)}}},or={kernelName:W.s,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[i,r]=e,{transposeA:s,transposeB:o}=n;return s||o?!s&&o?{a:()=>de(t,r,!1,!1),b:()=>de(t,i,!0,!1)}:s&&!o?{a:()=>de(r,t,!1,!0),b:()=>de(i,t,!1,!1)}:{a:()=>de(r,t,!0,!0),b:()=>de(t,i,!0,!0)}:{a:()=>de(t,r,!1,!0),b:()=>de(i,t,!0,!1)}}},ar=Object(q.a)({spaceToBatchND_:function(t,e,n){const i=Object(G.a)(t,"x","spaceToBatchND");w.b(i.rank>=1+e.length,(()=>"input rank ".concat(i.rank," should be > than [blockShape] ").concat(e.length))),w.b(n.length===e.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length))),w.b(i.shape.reduce(((t,i,r)=>r>0&&r<=e.length?t&&(i+n[r-1][0]+n[r-1][1])%e[r-1]==0:t),!0),(()=>"input spatial dimensions ".concat(i.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())));const r={x:i},s={blockShape:e,paddings:n};return c.a.runKernelFunc((t=>t.spaceToBatchND(i,e,n)),r,null,W.tc,s)}}),cr={kernelName:W.t,gradFunc:(t,e,n)=>{const{blockShape:i,crops:r}=n;return{x:()=>ar(t,i,r)}}},lr={kernelName:W.u,gradFunc:(t,e,n)=>{const i=n,r=i.inputShape,s=i.shape,o=Array.from(s);for(let c=r.length-1;c>=0;c--)if(r[c]===s[c])o[c]=1;else if(1!==r[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(s,"]."));const a=[];for(let c=0;c<o.length;c++)o[c]>1&&a.push(c);return{x:()=>Sn(t,a,!0)}}},ur={kernelName:W.v,gradFunc:t=>({x:()=>t.clone()})},hr={kernelName:W.w,gradFunc:t=>({x:()=>ze(t)})},dr={kernelName:W.x,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{clipValueMin:r,clipValueMax:s}=n;return{x:()=>Be(fn(dn(i,r),pn(i,s)),t,ze(t))}}},pr={kernelName:W.z,saveAllInputs:!0,gradFunc:(t,e,n)=>{const i=e.map((t=>t.shape)),{axis:r}=n,s=Object(w.I)(r,e[0].shape)[0],o=i.map((t=>t[s]));return Oe(t,o,s).map((t=>()=>t))}},fr=Object(q.a)({conv2DBackpropFilter_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,a=t;3===t.rank&&(a=Nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2]])),w.b(4===a.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+".")),w.b(4===l.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+".")),w.b(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."));const u="NHWC"===s?a.shape[3]:a.shape[1],h="NHWC"===s?l.shape[3]:l.shape[1];w.b(u===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(u,") must match input depth in filter (").concat(n[2],"."))),w.b(h===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(h,") must match output depth for filter (").concat(n[3],")."))),null!=o&&w.b(w.v(r),(()=>"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(r,".")));const d={x:a,dy:l},p={strides:i,pad:r,dataFormat:s,dimRoundingMode:o,filterShape:n};return c.a.runKernelFunc((t=>{const e=Zt(s),c=Vt(a.shape,n,i,1,r,o,!1,e);return t.conv2dDerFilter(a,l,c)}),d,null,W.B,p)}}),mr=Object(q.a)({conv2DBackpropInput_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;w.b(t.length===e.rank,(()=>"Length of inShape (".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let a=t,l=e,u=!1;3===e.rank&&(u=!0,l=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),w.b(4===a.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+".")),w.b(4===l.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank)),w.b(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank));const h="NHWC"===s?a[3]:a[1],d="NHWC"===s?l.shape[3]:l.shape[1];w.b(h===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(h,") must match input depth for filter ").concat(n.shape[2],"."))),w.b(d===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(d,") must match output depth for filter ").concat(n.shape[3],"."))),null!=o&&w.b(w.v(r),(()=>"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(r,".")));const p={dy:l,filter:n},f={strides:i,pad:r,dataFormat:s,dimRoundingMode:o,inputShape:a},m=c.a.runKernelFunc(((t,e)=>{const c=Zt(s),u=Vt(a,n.shape,i,1,r,o,!1,c),h=t.conv2dDerInput(l,n,u);return e([l,n]),h}),p,null,W.C,f);return u?Nt(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),gr={kernelName:W.A,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{dilations:s,strides:o,pad:a,dataFormat:c}=n;return w.b(Kt(s),(()=>"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(s,"'"))),{x:()=>mr(i.shape,t,r,o,a,c),filter:()=>fr(i,t,r.shape,o,a,c)}}},vr={kernelName:W.C,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{strides:s,pad:o,dataFormat:a,dimRoundingMode:c}=n;return{dy:()=>Jt(t,r,s,o,a,1,c),filter:()=>fr(t,i,r.shape,s,o,a,c)}}},yr=Object(q.a)({conv3DBackpropFilter_:function(t,e,n,i,r){let s=t;4===t.rank&&(s=Nt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),w.b(5===s.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+s.shape+".")),w.b(5===o.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+".")),w.b(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+".")),w.b(s.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(s.shape[4],") must match input depth in filter (").concat(n[3],"."))),w.b(o.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must match output depth for filter (").concat(n[4],").")));const a={x:s,dy:o},l={strides:i,pad:r,filterShape:n};return c.a.runKernelFunc((t=>{const e=Wt(s.shape,n,i,1,r);return t.conv3dDerFilter(s,o,e)}),a,null,W.E,l)}}),xr=Object(q.a)({conv3DBackpropInput_:function(t,e,n,i,r){w.b(t.length===e.rank,(()=>"Length of inShape (".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let s=t,o=e,a=!1;4===e.rank&&(a=!0,o=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const l=s[4],u=o.shape[4];w.b(5===s.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+s.length+".")),w.b(5===o.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank)),w.b(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank)),w.b(l===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(l,") must match input depth for filter ").concat(n.shape[3],"."))),w.b(u===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(u,") must match output depth for filter ").concat(n.shape[4],".")));const h={dy:o,filter:n},d={pad:r,strides:i,inputShape:s},p=c.a.runKernelFunc((t=>{const e=Wt(s,n.shape,i,1,r);return t.conv3dDerInput(o,n,e)}),h,null,W.F,d);return a?Nt(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),br={kernelName:W.D,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s}=n;w.b(Kt(i),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(i,"'")));const[o,a]=e;return{x:()=>xr(o.shape,t,a,r,s),filter:()=>yr(o,t,a.shape,r,s)}}},wr=Object(q.a)({sin_:function(t){const e=Object(G.a)(t,"x","sin"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.sin(e);return n([e]),i}),n,null,W.oc)}}),Sr={kernelName:W.G,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(Rn(wr(H(n,"float32"))),t)}}},_r=Object(q.a)({sinh_:function(t){const e=Object(G.a)(t,"x","sinh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.sinh(e);return n([e]),i}),n,null,W.pc)}}),Tr={kernelName:W.H,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(_r(H(n,"float32")),t)}}},Er={kernelName:W.J,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{axis:r,exclusive:s,reverse:o}=n;return{x:()=>{const e=re([r],i.rank);let n=ce(t,r,s,!o);return null!=e&&(n=ae(n,e)),n}}}},Cr=Object(q.a)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=t;3===t.rank&&(a=Nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},h={strides:i,pad:r,dimRoundingMode:o,dilations:s,filterShape:n};return c.a.runKernelFunc((e=>{const c=Vt(t.shape,n,i,s,r,o,!0);return e.depthwiseConv2DDerFilter(a,l,c)}),u,null,W.M,h)}}),kr=Object(q.a)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=e,l=!1;3===e.rank&&(l=!0,a=Nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},h={strides:i,pad:r,dimRoundingMode:o,dilations:s,inputShape:t},d=c.a.runKernelFunc((e=>{const c=Vt(t,n.shape,i,s,r,o,!0);return e.depthwiseConv2DDerInput(a,n,c)}),u,null,W.N,h);return l?Nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Ar={kernelName:W.L,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s,dimRoundingMode:o}=n,a=null==i?[1,1]:i;w.b(Kt(a),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '".concat(a,"'")));const[c,l]=e;return w.b(4===c.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ".concat(c.rank,"."))),w.b(4===l.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ".concat(l.rank,"."))),w.b(c.shape[3]===l.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input channels (".concat(c.shape[3],") must match the inChannels dimension in filter ").concat(l.shape[2],"."))),w.b(Qt(r,a),(()=>"Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ".concat(r," and dilations '").concat(a,"'."))),null!=o&&w.b(w.v(s),(()=>"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(s,"."))),{x:()=>kr(c.shape,t,l,r,s,i,o),filter:()=>Cr(c,t,l.shape,r,s,i,o)}}},Ir={kernelName:W.O,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,s={x:i,filter:r,dy:t},o={x:i,filter:r,dy:t};return{x:()=>c.a.runKernel(W.Q,s,n),filter:()=>c.a.runKernel(W.P,o,n)}}},Or={kernelName:W.R,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{const e=he(t,H(i,"float32")),s=Fe(n.shape,r);return s.length>0?Nt(Sn(e,s),n.shape):e},b:()=>{let e=me(t,H(n,"float32"));const s=Fe(i.shape,r);s.length>0&&(e=Nt(Sn(e,s),i.shape));const o=wn(i);return Rn(he(e,H(o,"float32")))}}}},Rr={kernelName:W.S,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,i=e=>e.eluDer(t,n),r={dy:t,y:n};return{x:()=>c.a.runKernelFunc(i,r,null,W.T)}}},Nr={kernelName:W.V,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,i=me(Wn(Rn(wn(n))),2/Math.sqrt(Math.PI));return{x:()=>me(t,i)}}},Mr={kernelName:W.W,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,n)}}},Dr={kernelName:W.X,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,Wn(n))}}},Pr={kernelName:W.bb,gradFunc:t=>({x:()=>ze(t)})},Fr={kernelName:W.cb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{const e=he(t,H(i,"float32")),s=Fe(n.shape,r);return s.length>0?Nt(Sn(e,s),n.shape):e},b:()=>{let e=me(t,H(n,"float32"));const s=Fe(i.shape,r);s.length>0&&(e=Nt(Sn(e,s),i.shape));const o=wn(i);return Rn(he(e,H(o,"float32")))}}}},Lr=Object(q.a)({rsqrt_:function(t){const e=Object(G.a)(t,"x","rsqrt"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.rsqrt(e);return n([e]),i}),n,null,W.jc)}}),Br={kernelName:W.eb,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:i}=n,[r,s,o,a]=e,c=null==a?Ce(1):a,l=Fe(s.shape,r.shape),u=[];if(1===s.rank){for(let t=0;t<r.shape.length-1;++t)u.push(r.shape[t]);u.push(1)}const h=Ne(r,s),d=me(t,c),p=Lr(Rt(o,Ce(i))),f=me(me(me(p,p),p),Ce(-.5));return{x:()=>1===s.rank?Nt(me(me(t,Me(Nt(p,[1,1,1,s.shape[0]]),u)),c),r.shape):Nt(me(me(t,p),c),r.shape),mean:()=>{let t=me(me(p,Ce(-1)),d);return 1===s.rank&&(t=Sn(t,l)),Nt(t,s.shape)},variance:()=>{let t=me(me(f,h),d);return 1===s.rank&&(t=Sn(t,l)),Nt(t,s.shape)},scale:()=>{const e=me(h,p);let n=me(t,e);return 1===s.rank&&(n=Sn(n,l)),Nt(n,s.shape)},offset:()=>{let e=t;return 1===s.rank&&(e=Sn(e,l)),Nt(e,s.shape)}}}},zr=Object(q.a)({unsortedSegmentSum_:function(t,e,n){const i=Object(G.a)(t,"x","unsortedSegmentSum"),r=Object(G.a)(e,"segmentIds","unsortedSegmentSum","int32");Object(w.b)(Object(w.v)(n),(()=>"numSegments must be of dtype int"));const s={x:i,segmentIds:r},o={numSegments:n};return c.a.runKernelFunc(((t,e)=>{const s=t.unsortedSegmentSum(i,r,n);return e([r]),s}),s,null,W.Jc,o)}}),Ur={kernelName:W.fb,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[i,r]=e,{axis:s}=n,o=Object(w.I)(s,i.shape)[0];return{x:()=>{const e=i.shape,n=r.size,a=e.slice(0,o),c=a.length,l=e.slice(s,e.length).slice(1),u=l.length,h=jr(0,c),d=jr(c+1,c+1+u),p=Vr([a,[n],l]),f=Nt(t,p),m=Nt(r,[n]),g=Vr([[c],h,d]),v=ae(f,g);let y=zr(v,m,i.shape[o]);const x=se(g);return y=ae(y,x),y},indices:()=>r}}};function jr(t,e){const n=[];for(let i=t;i<e;++i)n.push(i);return n}function Vr(t){const e=[];for(let n=0;n<t.length;++n)for(let i=0;i<t[n].length;++i)e.push(t[n][i]);return e}const Wr={kernelName:W.hb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>ze(n),b:()=>ze(i)}}},Gr={kernelName:W.jb,gradFunc:t=>({x:()=>H(t,"float32")})},qr={kernelName:W.lb,gradFunc:t=>({x:()=>ze(t)})},Hr={kernelName:W.mb,gradFunc:t=>({x:()=>ze(t)})},Xr={kernelName:W.nb,gradFunc:t=>({x:()=>ze(t)})},Yr={kernelName:W.tb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,Rt(n,1))}}},Kr={kernelName:W.sb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,H(n,"float32"))}}},Qr={kernelName:W.ub,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i]=e,{axis:r}=n;return{logits:()=>{const e=Wn(i);return Ne(t,me(Sn(t,r,!0),e))}}}},Zr=Object(q.a)({localResponseNormalizationBackprop_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;const a={x:t,y:e,dy:n},l={depthRadius:i,bias:r,alpha:s,beta:o};return c.a.runKernelFunc((a=>a.LRNGrad(n,t,e,i,r,s,o)),a,null,W.pb,l)}}),Jr={kernelName:W.ob,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{depthRadius:s,bias:o,alpha:a,beta:c}=n;return{x:()=>Zr(i,r,t,s,o,a,c)}}},$r=Object(q.a)({equal_:function(t,e){let n=Object(G.a)(t,"a","equal"),i=Object(G.a)(e,"b","equal");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.equal(n,i)),r,null,W.U)}});function ts(t,e,n,i){return e.rank<n.rank&&(e=Nt(e,ne(e.shape,i))),t.rank<n.rank&&(t=Nt(t,ne(t.shape,i))),{x:()=>me(t,H($r(n,e),t.dtype))}}const es={kernelName:W.yb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const i=n,{reductionIndices:r}=i,s=e[0],o=ts(t,e[1],s,w.I(r,s.shape));return{x:()=>o.x()}}},ns=Object(q.a)({less_:function(t,e){let n=Object(G.a)(t,"a","less"),i=Object(G.a)(e,"b","less");[n,i]=Object(Ot.b)(n,i),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.less(n,i)),r,null,W.qb)}}),is={kernelName:W.Eb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>me(t,H(dn(n,i),"float32")),b:()=>me(t,H(ns(n,i),"float32"))}}},rs=Object(q.a)({maxPool3dBackprop_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0;const l=Object(G.a)(t,"dy","maxPool3dBackprop"),u=Object(G.a)(e,"input","maxPool3dBackprop"),h=Object(G.a)(n,"output","maxPool3dBackprop");let d=l,p=u,f=h,m=!1;4===u.rank&&(m=!0,d=Nt(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=Nt(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=Nt(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),w.b(5===d.rank,(()=>"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+d.rank+".")),w.b(5===p.rank,(()=>"Error in maxPool3dBackprop: input must be rank 5 but got rank "+p.rank+".")),w.b(5===f.rank,(()=>"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+".")),w.b(Qt(r,s),(()=>"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides ".concat(r," and dilations '").concat(s,"'"))),null!=a&&w.b(w.v(o),(()=>"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode ".concat(a," but got pad ").concat(o,".")));const g={dy:d,input:p,output:f},v={filterSize:i,strides:r,dilations:s,pad:o,dimRoundingMode:a},y=c.a.runKernelFunc((t=>{const e=jt(p.shape,i,r,s,o,a);return t.maxPool3dBackprop(d,p,f,e)}),g,null,W.Bb,v);return m?Nt(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),ss={kernelName:W.Ab,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,dilations:a,pad:c,dimRoundingMode:l}=n,u=null==a?[1,1,1]:a;return{x:()=>rs(t,i,r,s,o,u,c,l)}}},os=Object(q.a)({maxPoolBackprop_:function(t,e,n,i,r,s,o){const a=Object(G.a)(t,"dy","maxPoolBackprop"),l=Object(G.a)(e,"input","maxPoolBackprop"),u=Object(G.a)(n,"output","maxPoolBackprop");w.b(l.rank===a.rank,(()=>"Rank of input (".concat(l.rank,") does not match rank of dy (").concat(a.rank,")"))),w.b(4===a.rank,(()=>"Error in maxPoolBackprop: dy must be rank 4 but got rank "+a.rank+".")),w.b(4===l.rank,(()=>"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+".")),null!=o&&w.b(w.v(s),(()=>"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(s,".")));const h={dy:a,input:l,output:u},d={filterSize:i,strides:r,pad:s,dimRoundingMode:o};return c.a.runKernelFunc((t=>{const e=Ut(l.shape,i,r,1,s,o);return t.maxPoolBackprop(a,l,u,e)}),h,null,W.Cb,d)}}),as={kernelName:W.zb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,pad:a}=n;return{x:()=>os(t,i,r,s,o,a)}}},cs={kernelName:W.Gb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const i=n,{axis:r}=i,[s,o]=e,a=ts(t,o,s,w.I(r,s.shape));return{x:()=>a.x()}}},ls={kernelName:W.Hb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>me(t,H(pn(n,i),"float32")),b:()=>me(t,H(On(n,i),"float32"))}}},us={kernelName:W.Ib,inputsToSave:["x"],gradFunc:(t,e,n)=>{const i=e[0],{paddings:r}=n,s=r.map((t=>t[0]));return{x:()=>Ve(t,s,i.shape)}}},hs=Object(q.a)({floor_:function(t){const e=Object(G.a)(t,"x","floor"),n={x:e};return c.a.runKernelFunc((t=>t.floor(e)),n,null,W.bb)}}),ds={kernelName:W.Jb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{const e=Fe(n.shape,r);return e.length>0?Nt(Sn(t,e),n.shape):t},b:()=>{const e=me(t,Rn(hs(he(n,i)))),s=Fe(i.shape,r);return s.length>0?Nt(Sn(e,s),i.shape):e}}}},ps={kernelName:W.Kb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{const e=me(t,H(i,"float32")),s=Fe(n.shape,r);return s.length>0?Nt(Sn(e,s),n.shape):e},b:()=>{const e=me(t,H(n,"float32")),s=Fe(i.shape,r);return s.length>0?Nt(Sn(e,s),i.shape):e}}}},fs={kernelName:W.Lb,gradFunc:t=>({x:()=>Rn(t)})},ms={kernelName:W.Qb,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Te(n.shape,"float32")}}},gs={kernelName:W.Rb,gradFunc:t=>({x:()=>ze(t)})},vs={kernelName:W.Sb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const i=e[0],{paddings:r}=n,s=r.map((t=>t[0]));return{x:()=>Ve(t,s,i.shape)}}},ys={kernelName:W.Tb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,i,r]=e,s=n,o=i,a=Le(s.shape,o.shape);return{a:()=>{const e=H(o,"float32");let n=me(t,me(e,ve(s,Ne(e,Ce(1)))));const i=Fe(s.shape,a);return i.length>0&&(n=Sn(n,i)),Nt(n,s.shape)},b:()=>{const e=On(s,0),n=Be(e,jn(s),ze(s));let i=me(t,me(r,n));const c=Fe(o.shape,a);return c.length>0&&(i=Sn(i,c)),Nt(i,o.shape)}}}},xs={kernelName:W.Ub,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,i]=e,r=On(n,0);return{x:()=>Be(r,t,me(t,i)),alpha:()=>{let e=Be(r,ze(t),me(t,n));const s=Fe(i.shape,t.shape);return s.length>0&&(e=Sn(e,s)),Nt(e,i.shape)}}}},bs={kernelName:W.Yb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,Rn(wn(n)))}}},ws={kernelName:W.ac,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,i=me(pn(n,6),Zn(n));return{x:()=>me(t,H(i,"float32"))}}},Ss={kernelName:W.Zb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,H(Zn(n),"float32"))}}},_s={kernelName:W.bc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Nt(t,n.shape)}}},Ts={kernelName:W.cc,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[i]=e,r=e=>{const{alignCorners:r}=n;return e.resizeBilinearBackprop(t,i,r)},s={images:i};return{images:()=>c.a.runKernelFunc(r,s,null,W.dc,n)}}},Es={kernelName:W.ec,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[i]=e,r=e=>{const{alignCorners:r}=n;return e.resizeNearestNeighborBackprop(t,i,r)},s={images:i};return{images:()=>c.a.runKernelFunc(r,s,null,W.fc,n)}}},Cs={kernelName:W.gc,gradFunc:(t,e,n)=>{const{dims:i}=n,r=Object(w.I)(i,t.shape);return{x:()=>He(t,r)}}},ks={kernelName:W.ic,gradFunc:t=>({x:()=>ze(t)})},As={kernelName:W.jc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Rn(he(t,me(ve(n,1.5),2)))}}},Is=Object(q.a)({logicalNot_:function(t){const e=Object(G.a)(t,"x","logicalNot","bool"),n={x:e};return c.a.runKernelFunc((t=>t.logicalNot(e)),n,null,W.wb)}}),Os={kernelName:W.kc,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>H(ze(n),"float32"),t:()=>me(t,H(n,t.dtype)),e:()=>me(t,H(Is(n),t.dtype))}}},Rs={kernelName:W.lc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=On(n,Ce(0)),i=Ce(fi),r=Ce(mi),s=me(t,r),o=me(me(t,i),Wn(H(n,"float32")));return Be(e,s,o)}}}},Ns={kernelName:W.mc,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,me(n,Ne(Ce(1),n)))}}},Ms={kernelName:W.nc,gradFunc:t=>({x:()=>ze(t)})},Ds=Object(q.a)({cos_:function(t){const e=Object(G.a)(t,"x","cos"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.cos(e);return n([e]),i}),n,null,W.G)}}),Ps={kernelName:W.oc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(Ds(H(n,"float32")),t)}}},Fs=Object(q.a)({cosh_:function(t){const e=Object(G.a)(t,"x","cosh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.cosh(e);return n([e]),i}),n,null,W.H)}}),Ls={kernelName:W.pc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(Fs(H(n,"float32")),t)}}},Bs=Object(q.a)({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Object(G.a)(t,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},s={x:i};return c.a.runKernelFunc(((t,r)=>(r([i]),t.pad(i,e,n))),s,null,W.Sb,r)}}),zs={kernelName:W.qc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{begin:r,size:s}=n,o=i.shape,[a,c]=kt(i,r,s),l=[];for(let u=0;u<t.rank;u++)l.push([a[u],o[u]-a[u]-c[u]]);return{x:()=>Bs(t,l)}}},Us={kernelName:W.rc,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i]=e,{dim:r}=n,s=me(t,i);return{logits:()=>Ne(s,me(Sn(s,[r],!0),i))}}},js=Object(q.a)({sigmoid_:function(t){const e=Object(G.a)(t,"x","sigmoid"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.sigmoid(e);return n([i]),i}),n,null,W.mc)}}),Vs={kernelName:W.sc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,js(n))}}},Ws=Object(q.a)({batchToSpaceND_:function(t,e,n){const i=Object(G.a)(t,"x","batchToSpaceND"),r=e.reduce(((t,e)=>t*e));w.b(i.rank>=1+e.length,(()=>"input rank is ".concat(i.rank," but should be > than blockShape.length ").concat(e.length))),w.b(n.length===e.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length))),w.b(i.shape[0]%r==0,(()=>"input tensor batch is ".concat(i.shape[0]," but is not divisible by the product of the elements of blockShape ").concat(e.join(" * ")," === ").concat(r)));const s={x:i},o={blockShape:e,crops:n};return c.a.runKernelFunc((t=>t.batchToSpaceND(i,e,n)),s,null,W.t,o)}}),Gs={kernelName:W.tc,gradFunc:(t,e,n)=>{const{blockShape:i,paddings:r}=n;return{x:()=>Ws(t,i,r)}}},qs={kernelName:W.uc,gradFunc:(t,e,n)=>{const{axis:i}=n;return{x:()=>Bt(t,i)}}},Hs={kernelName:W.vc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,me(bn(H(n,"float32")),2))}}},Xs={kernelName:W.wc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(t,me(H(n,"float32"),2))}}},Ys={kernelName:W.xc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Ce(2);return{a:()=>me(t,me(r,Ne(n,i))),b:()=>me(t,me(r,Ne(i,n)))}}},Ks={kernelName:W.yc,gradFunc:t=>({x:()=>ze(t)})},Qs={kernelName:W.Ac,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Le(n.shape,i.shape);return{a:()=>{let e=t;const i=Fe(n.shape,r);return i.length>0&&(e=Sn(e,i)),Nt(e,n.shape)},b:()=>{let e=t;const n=Fe(i.shape,r);return n.length>0&&(e=Sn(e,n)),Nt(Rn(e),i.shape)}}}},Zs={kernelName:W.Bc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,r=i.shape.slice(),{axis:s}=n;Object(w.I)(s,i.shape).forEach((t=>{r[t]=1}));const o=Nt(t,r),a=me(o,Pn(i.shape,"float32"));return{x:()=>a}}},Js={kernelName:W.Cc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>he(t,wn(Ds(n)))}}},$s={kernelName:W.Dc,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>me(Ne(Ce(1),wn(n)),t)}}},to={kernelName:W.Ec,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{reps:r}=n;return{x:()=>{let e=ze(i);if(1===i.rank)for(let n=0;n<r[0];++n)e=Rt(e,Ve(t,[n*i.shape[0]],[i.shape[0]]));else if(2===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)e=Rt(e,Ve(t,[n*i.shape[0],s*i.shape[1]],[i.shape[0],i.shape[1]]));else if(3===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)e=Rt(e,Ve(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(4!==i.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+i.rank+" tensors yet.");for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)for(let a=0;a<r[3];++a)e=Rt(e,Ve(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2],a*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return e}}}},eo={kernelName:W.Gc,gradFunc:(t,e,n)=>{const i=n,{perm:r}=i,s=se(r);return{x:()=>ae(t,s)}}},no={kernelName:W.Ic,gradFunc:(t,e,n)=>{const i=n,{axis:r}=i;return{value:()=>gn(t,r)}}},io=Object(q.a)({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Object(G.a)(t,"x","gather"),r=Object(G.a)(e,"indices","gather","int32"),s={x:i,indices:r},o={axis:n};return c.a.runKernelFunc(((t,e)=>{const s=Object(w.I)(n,i.shape)[0],o=Di(i,r,s),a=t.gather(i,Nt(r,[r.size]),s);return e([i,r]),Nt(a,o.outputShape)}),s,null,W.fb,o)}}),ro=Object(q.a)({maximum_:function(t,e){let n=Object(G.a)(t,"a","maximum"),i=Object(G.a)(e,"b","maximum");[n,i]=Object(Ot.b)(n,i),"bool"===n.dtype&&(n=H(n,"int32"),i=H(i,"int32")),Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.maximum(n,i);return e([n,i]),r}),r,null,W.Eb)}}),so=[Gi,qi,Hi,Xi,Yi,Ki,Qi,Zi,Ji,$i,tr,er,ir,sr,or,cr,lr,ur,hr,dr,pr,vr,gr,br,Sr,Tr,Er,Ar,Ir,Or,Rr,Nr,Mr,Dr,Fr,Pr,Br,Ur,Wr,Gr,qr,Hr,Xr,Yr,Kr,Qr,Jr,es,es,is,ss,as,cs,ls,us,ds,ps,fs,ms,gs,vs,vs,ys,xs,bs,ws,Ss,_s,Ts,Es,Cs,ks,As,Os,Rs,Ns,Ms,Ps,Ls,zs,Us,Vs,Gs,Gs,qs,qs,Hs,Ys,Xs,Ks,Qs,Zs,Js,$s,to,eo,no,{kernelName:W.Jc,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=ro(e,ze(e)),i=io(t,n);let r=dn(e,Ce(0,"int32"));const s=i.rank-r.rank;for(let a=0;a<s;++a)r=mn(r,a+1);r=fn(r,Pn(i.shape,"bool"));const o=ze(i);return Be(r,i,o)}(t,n)}}},{kernelName:W.Kc,gradFunc:t=>({x:()=>ze(t)})}];for(const fa of so)Object(Hn.d)(fa);j.a.prototype.abs=function(){return this.throwIfDisposed(),yn(this)};const oo=Object(q.a)({acos_:function(t){const e=Object(G.a)(t,"x","acos"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.acos(e);return n([e]),i}),n,null,W.b)}});j.a.prototype.acos=function(){return this.throwIfDisposed(),oo(this)};const ao=Object(q.a)({acosh_:function(t){const e=Object(G.a)(t,"x","acosh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.acosh(e);return n([e]),i}),n,null,W.c)}});j.a.prototype.acosh=function(){return this.throwIfDisposed(),ao(this)};const co=Object(q.a)({mod_:function(t,e){let n=Object(G.a)(t,"a","mod"),i=Object(G.a)(e,"b","mod");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.mod(n,i);return e([n,i]),r}),r,null,W.Jb)}}),lo=Object(q.a)({addStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","addStrict"),i=Object(G.a)(e,"b","addStrict");return w.e(n.shape,i.shape,"Error in addStrict: "),Rt(n,i)}}),uo=Object(q.a)({divStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","div"),i=Object(G.a)(e,"b","div");return w.e(n.shape,i.shape,"Error in divideStrict: "),he(n,i)}}),ho=Object(q.a)({maximumStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","maximumStrict"),i=Object(G.a)(e,"b","maximumStrict");return w.e(n.shape,i.shape,"Error in maximumStrict: "),ro(n,i)}}),po=Object(q.a)({minimumStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","minimumStrict"),i=Object(G.a)(e,"b","minimumStrict");return w.e(n.shape,i.shape,"Error in minimumStrict: "),Un(n,i)}}),fo=Object(q.a)({modStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","modStrict"),i=Object(G.a)(e,"b","modStrict");return w.e(n.shape,i.shape,"Error in modStrict: "),co(n,i)}}),mo=Object(q.a)({mulStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","mul"),i=Object(G.a)(e,"b","mul");return w.e(n.shape,i.shape,"Error in multiplyStrict: "),me(n,i)}}),go=Object(q.a)({powStrict_:function(t,e){return Tn("strict variants of ops have been deprecated and will be removed in future"),w.e(t.shape,e.shape,"Error in powStrict: "),ve(t,e)}}),vo=Object(q.a)({squaredDifferenceStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","squaredDifferenceStrict"),i=Object(G.a)(e,"b","squaredDifferenceStrict");return w.e(n.shape,i.shape,"Error in squaredDifferenceStrict: "),Vn(n,i)}}),yo=Object(q.a)({subStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","subStrict"),i=Object(G.a)(e,"b","subStrict");return w.e(n.shape,i.shape,"Error in subStrict: "),Ne(n,i)}});j.a.prototype.addStrict=function(t){return this.throwIfDisposed(),lo(this,t)},j.a.prototype.add=function(t){return this.throwIfDisposed(),Rt(this,t)};const xo=Object(q.a)({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(G.a)(t,"x","all","bool");const r={x:i},s={axis:e,keepDims:n};return c.a.runKernelFunc((t=>{const r=Object(w.I)(e,i.shape);let s=r;const o=re(s,i.rank);null!=o&&(i=ae(i,o),s=oe(s.length,i.rank));const a=t.all(i,s);if(n){const t=ne(a.shape,r);return Nt(a,t)}return a}),r,null,W.f,s)}});j.a.prototype.all=function(t,e){return this.throwIfDisposed(),xo(this,t,e)};const bo=Object(q.a)({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(G.a)(t,"x","any","bool");const r={x:i},s={axis:e,keepDims:n};return c.a.runKernelFunc((t=>{const r=Object(w.I)(e,i.shape);let s=r;const o=re(s,i.rank);null!=o&&(i=ae(i,o),s=oe(s.length,i.rank));const a=t.any(i,s);if(n){const t=ne(a.shape,r);return Nt(a,t)}return a}),r,null,W.g,s)}});j.a.prototype.any=function(t,e){return this.throwIfDisposed(),bo(this,t,e)};const wo=Object(q.a)({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(G.a)(t,"x","argMax");const i={x:n},r={axis:e};return c.a.runKernelFunc(((t,i)=>{i([n]);let r=w.I(e,n.shape);const s=re(r,n.rank);return null!=s&&(n=ae(n,s),r=oe(r.length,n.rank)),t.argMax(n,r[0])}),i,null,W.h,r)}});j.a.prototype.argMax=function(t){return this.throwIfDisposed(),wo(this,t)};const So=Object(q.a)({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(G.a)(t,"x","argMin");const i={x:n},r={axis:e};return c.a.runKernelFunc(((t,i)=>{i([n]),null==e&&(e=0);let r=w.I(e,n.shape);const s=re(r,n.rank);return null!=s&&(n=ae(n,s),r=oe(r.length,n.rank)),t.argMin(n,r[0])}),i,null,W.i,r)}});j.a.prototype.argMin=function(t){return this.throwIfDisposed(),So(this,t)},j.a.prototype.asScalar=function(){return this.throwIfDisposed(),Object(w.b)(1===this.size,(()=>"The array must have only 1 element.")),Nt(this,[])},j.a.prototype.asType=function(t){return this.throwIfDisposed(),H(this,t)},j.a.prototype.as1D=function(){return this.throwIfDisposed(),Nt(this,[this.size])},j.a.prototype.as2D=function(t,e){return this.throwIfDisposed(),Nt(this,[t,e])},j.a.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Nt(this,[t,e,n])},j.a.prototype.as4D=function(t,e,n,i){return this.throwIfDisposed(),Nt(this,[t,e,n,i])},j.a.prototype.as5D=function(t,e,n,i,r){return this.throwIfDisposed(),Nt(this,[t,e,n,i,r])};const _o=Object(q.a)({asin_:function(t){const e=Object(G.a)(t,"x","asin"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.asin(e);return n([e]),i}),n,null,W.j)}});j.a.prototype.asin=function(){return this.throwIfDisposed(),_o(this)};const To=Object(q.a)({asinh_:function(t){const e=Object(G.a)(t,"x","asinh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.asinh(e);return n([e]),i}),n,null,W.k)}});j.a.prototype.asinh=function(){return this.throwIfDisposed(),To(this)};const Eo=Object(q.a)({atan_:function(t){const e=Object(G.a)(t,"x","atan"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.atan(e);return n([e]),i}),n,null,W.l)}});j.a.prototype.atan=function(){return this.throwIfDisposed(),Eo(this)};const Co=Object(q.a)({atan2_:function(t,e){let n=Object(G.a)(t,"a","atan2"),i=Object(G.a)(e,"b","atan2");[n,i]=Object(Ot.b)(n,i);const r={a:n,b:i};return c.a.runKernelFunc(((t,e)=>{const r=t.atan2(n,i);return e([n,i]),r}),r,null,W.m)}});j.a.prototype.atan2=function(t){return this.throwIfDisposed(),Co(this,t)};const ko=Object(q.a)({atanh_:function(t){const e=Object(G.a)(t,"x","atanh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.atanh(e);return n([e]),i}),n,null,W.n)}});j.a.prototype.atanh=function(){return this.throwIfDisposed(),ko(this)};const Ao=Object(q.a)({avgPool_:function(t,e,n,i,r){const s=Object(G.a)(t,"x","avgPool","float32");w.b(Qt(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '1'")));let o=s,a=!1;3===s.rank&&(a=!0,o=Nt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),w.b(4===o.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,"."))),null!=r&&w.b(w.v(i),(()=>"Error in avgPool: pad must be an integer when using, dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const l={x:o},u={filterSize:e,strides:n,pad:i,dimRoundingMode:r};let h=c.a.runKernelFunc(((t,s)=>{const a=Ut(o.shape,e,n,1,i,r);return s([o]),1===a.filterWidth&&1===a.filterHeight&&w.a(a.inShape,a.outShape)?o.clone():t.avgPool(o,a)}),l,null,W.o,u);return h=H(h,s.dtype),a?Nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});j.a.prototype.avgPool=function(t,e,n,i){return this.throwIfDisposed(),Ao(this,t,e,n,i)},j.a.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Ws(this,t,e)},j.a.prototype.batchNorm=function(t,e,n,i,r){return this.throwIfDisposed(),Dt(this,t,e,n,i,r)},j.a.prototype.broadcastTo=function(t){return this.throwIfDisposed(),De(this,t)},j.a.prototype.cast=function(t){return this.throwIfDisposed(),H(this,t)};const Io=Object(q.a)({ceil_:function(t){const e=Object(G.a)(t,"x","ceil"),n={x:e};return c.a.runKernelFunc((t=>t.ceil(e)),n,null,W.w)}});j.a.prototype.ceil=function(){return this.throwIfDisposed(),Io(this)};const Oo=Object(q.a)({clipByValue_:function(t,e,n){const i=Object(G.a)(t,"x","clipByValue");w.b(e<=n,(()=>"Error in clip: min (".concat(e,") must be less than or equal to max (").concat(n,").")));const r={x:i},s={clipValueMin:e,clipValueMax:n};return c.a.runKernelFunc(((t,r)=>{const s=t.clip(i,e,n);return r([i]),s}),r,null,W.x,s)}});j.a.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Oo(this,t,e)},j.a.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof j.a&&(t=[t]),Bt([this,...t],e)};const Ro=Object(q.a)({conv1d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const a=Object(G.a)(t,"x","conv1d"),c=Object(G.a)(e,"filter","conv1d");let l=a,u=!1;2===a.rank&&(u=!0,l=Nt(a,[1,a.shape[0],a.shape[1]])),w.b(3===l.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,"."))),w.b(3===c.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+c.rank+".")),null!=o&&w.b(w.v(i),(()=>"Error in conv1d: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,"."))),w.b(l.shape[2]===c.shape[1],(()=>"Error in conv1d: depth of input (".concat(l.shape[2],") must match input depth for filter ").concat(c.shape[1],"."))),w.b(Qt(n,s),(()=>"Error in conv1D: Either stride or dilation must be 1. Got stride ".concat(n," and dilation '").concat(s,"'"))),w.b("NWC"===r,(()=>"Error in conv1d: got dataFormat of ".concat(r," but only NWC is currently supported.")));const h=Nt(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=Nt(l,[l.shape[0],1,l.shape[1],l.shape[2]]),p=Jt(d,h,[1,n],i,"NHWC",[1,s],o);return Nt(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});j.a.prototype.conv1d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Ro(this,t,e,n,i,r,s)};const No=Object(q.a)({conv2dTranspose_:function(t,e,n,i,r,s){const o=Object(G.a)(t,"x","conv2dTranspose"),a=Object(G.a)(e,"filter","conv2dTranspose");return mr(n,o,a,i,r,"NHWC",s)}});j.a.prototype.conv2dTranspose=function(t,e,n,i,r){return this.throwIfDisposed(),No(this,t,e,n,i,r)},j.a.prototype.conv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Jt(this,t,e,n,i,r,s)},j.a.prototype.cos=function(){return this.throwIfDisposed(),Ds(this)},j.a.prototype.cosh=function(){return this.throwIfDisposed(),Fs(this)},j.a.prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),ce(this,t,e,n)};const Mo=Object(q.a)({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const i=Object(G.a)(t,"x","depthToSpace"),r="NHWC"===n?i.shape[1]:i.shape[2],s="NHWC"===n?i.shape[2]:i.shape[3],o="NHWC"===n?i.shape[3]:i.shape[1];w.b(r*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(i.shape))),w.b(s*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(e," for depthToSpace with input shape\n        ").concat(i.shape))),w.b(o%(e*e)==0,(()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(i.shape)));const a={x:i},l={blockSize:e,dataFormat:n};return c.a.runKernelFunc((t=>t.depthToSpace(i,e,n)),a,null,W.K,l)}});j.a.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Mo(this,t,e)},j.a.prototype.depthwiseConv2D=function(t,e,n,i,r,s){return Tn("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),le(this,t,e,n,i,r,s)},j.a.prototype.depthwiseConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),le(this,t,e,n,i,r,s)};const Do=Object(q.a)({dilation2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=Object(G.a)(t,"x","dilation2d"),a=Object(G.a)(e,"filter","dilation2d");w.b(3===o.rank||4===o.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+o.rank+".")),w.b(3===a.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+a.rank+".")),w.b("NHWC"===s,(()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+s));let l=o,u=!1;3===o.rank&&(l=Nt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0);const h={x:l,filter:a},d={strides:n,pad:i,dilations:r},p=c.a.runKernel(W.O,h,d);return u?Nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});j.a.prototype.dilation2d=function(t,e,n,i,r){return this.throwIfDisposed(),Do(this,t,e,n,i,r)};const Po=Object(q.a)({divNoNan_:function(t,e){let n=Object(G.a)(t,"a","div"),i=Object(G.a)(e,"b","div");[n,i]=Object(Ot.b)(n,i);const r=he(n,i),s=ze(r),o=$r(i,s);return Be(o,s,r)}});j.a.prototype.divNoNan=function(t){return this.throwIfDisposed(),Po(this,t)},j.a.prototype.divStrict=function(t){return this.throwIfDisposed(),uo(this,t)},j.a.prototype.div=function(t){return this.throwIfDisposed(),he(this,t)};const Fo=Object(q.a)({dot_:function(t,e){const n=Object(G.a)(t,"t1","dot"),i=Object(G.a)(e,"t2","dot");w.b(!(1!==n.rank&&2!==n.rank||1!==i.rank&&2!==i.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks ".concat(n.rank," and ").concat(i.rank,".")));const r=1===n.rank?n.size:n.shape[1],s=1===i.rank?i.size:i.shape[0];if(w.b(r===s,(()=>"Error in dot: inner dimensions of inputs must match, but got ".concat(r," and ").concat(s,"."))),1===n.rank&&1===i.rank){const t=Nt(n,[1,-1]),e=Nt(i,[-1,1]),r=de(t,e);return Nt(r,[])}if(1===n.rank&&2===i.rank){const t=Nt(n,[1,-1]),e=Nt(i,[i.shape[0],i.shape[1]]),r=de(t,e);return Nt(r,[r.size])}if(2===n.rank&&1===i.rank){const t=Nt(i,[-1,1]),e=de(n,t);return Nt(e,[e.size])}{const t=Nt(i,[i.shape[0],i.shape[1]]);return de(n,t)}}});j.a.prototype.dot=function(t){return this.throwIfDisposed(),Fo(this,t)},j.a.prototype.elu=function(){return this.throwIfDisposed(),Yn(this)};const Lo=Object(q.a)({equalStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","equalStrict"),i=Object(G.a)(e,"b","equalStrict");return Object(w.e)(n.shape,i.shape,"Error in equalStrict: "),$r(n,i)}}),Bo=Object(q.a)({greaterEqualStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","greaterEqualStrict"),i=Object(G.a)(e,"b","greaterEqualStrict");return Object(w.e)(n.shape,i.shape,"Error in greaterEqualStrict: "),dn(n,i)}}),zo=Object(q.a)({greaterStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","greaterStrict"),i=Object(G.a)(e,"b","greaterStrict");return Object(w.e)(n.shape,i.shape,"Error in greaterStrict: "),On(n,i)}}),Uo=Object(q.a)({lessEqualStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","lessEqualStrict"),i=Object(G.a)(e,"b","lessEqualStrict");return Object(w.e)(n.shape,i.shape,"Error in lessEqualStrict: "),pn(n,i)}}),jo=Object(q.a)({lessStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","lessStrict"),i=Object(G.a)(e,"b","lessStrict");return Object(w.e)(n.shape,i.shape,"Error in lessStrict: "),ns(n,i)}}),Vo=Object(q.a)({notEqualStrict_:function(t,e){Tn("strict variants of ops have been deprecated and will be removed in future");const n=Object(G.a)(t,"a","notEqualStrict"),i=Object(G.a)(e,"b","notEqualStrict");return Object(w.e)(n.shape,i.shape,"Error in notEqualStrict: "),Ln(n,i)}});j.a.prototype.equalStrict=function(t){return this.throwIfDisposed(),Lo(this,t)},j.a.prototype.equal=function(t){return this.throwIfDisposed(),$r(this,t)};const Wo=Object(q.a)({erf_:function(t){let e=Object(G.a)(t,"x","erf");w.b("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=H(e,"float32"));const n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.erf(e);return n([e]),i}),n,null,W.V)}});j.a.prototype.erf=function(){return this.throwIfDisposed(),Wo(this)},j.a.prototype.exp=function(){return this.throwIfDisposed(),Wn(this)},j.a.prototype.expandDims=function(t){return this.throwIfDisposed(),mn(this,t)};const Go=Object(q.a)({expm1_:function(t){const e=Object(G.a)(t,"x","expm1"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.expm1(e);return n([e]),i}),n,null,W.X)}});j.a.prototype.expm1=function(){return this.throwIfDisposed(),Go(this)},j.a.prototype.fft=function(){return this.throwIfDisposed(),We(this)},j.a.prototype.flatten=function(){return this.throwIfDisposed(),Nt(this,[this.size])},j.a.prototype.floor=function(){return this.throwIfDisposed(),hs(this)},j.a.prototype.floorDiv=function(t){return this.throwIfDisposed(),ue(this,t)},j.a.prototype.gather=function(t,e){return this.throwIfDisposed(),io(this,t,e)},j.a.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Bo(this,t)},j.a.prototype.greaterEqual=function(t){return this.throwIfDisposed(),dn(this,t)},j.a.prototype.greaterStrict=function(t){return this.throwIfDisposed(),zo(this,t)},j.a.prototype.greater=function(t){return this.throwIfDisposed(),On(this,t)},j.a.prototype.ifft=function(){return this.throwIfDisposed(),qe(this)},j.a.prototype.irfft=function(){return this.throwIfDisposed(),Xe(this)};const qo=Object(q.a)({isFinite_:function(t){const e=Object(G.a)(t,"x","isFinite"),n={x:e};return c.a.runKernelFunc((t=>t.isFinite(e)),n,null,W.lb)}});j.a.prototype.isFinite=function(){return this.throwIfDisposed(),qo(this)};const Ho=Object(q.a)({isInf_:function(t){const e=Object(G.a)(t,"x","isInf"),n={x:e};return c.a.runKernelFunc((t=>t.isInf(e)),n,null,W.mb)}});j.a.prototype.isInf=function(){return this.throwIfDisposed(),Ho(this)};const Xo=Object(q.a)({isNaN_:function(t){const e=Object(G.a)(t,"x","isNaN"),n={x:e};return c.a.runKernelFunc((t=>t.isNaN(e)),n,null,W.nb)}});j.a.prototype.isNaN=function(){return this.throwIfDisposed(),Xo(this)};const Yo=Object(q.a)({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n=Object(G.a)(t,"x","leakyRelu");return ro(me(Ce(e),n),n)}});j.a.prototype.leakyRelu=function(t){return this.throwIfDisposed(),Yo(this,t)},j.a.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Uo(this,t)},j.a.prototype.lessEqual=function(t){return this.throwIfDisposed(),pn(this,t)},j.a.prototype.lessStrict=function(t){return this.throwIfDisposed(),jo(this,t)},j.a.prototype.less=function(t){return this.throwIfDisposed(),ns(this,t)};const Ko=Object(q.a)({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const s=Object(G.a)(t,"x","localResponseNormalization");w.b(4===s.rank||3===s.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(s.rank,"."))),w.b(w.v(e),(()=>"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ".concat(e,".")));let o=s,a=!1;3===s.rank&&(a=!0,o=Nt(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:i,beta:r},h=c.a.runKernelFunc(((t,s)=>{const a=t.localResponseNormalization4D(o,e,n,i,r);return s([o,a]),a}),l,null,W.ob,u);return a?Nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});j.a.prototype.localResponseNormalization=function(t,e,n,i){return this.throwIfDisposed(),Ko(this,t,e,n,i)};const Qo=Object(q.a)({softplus_:function(t){const e=Object(G.a)(t,"x","softplus"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.softplus(e);return n([e]),i}),n,null,W.sc)}}),Zo=Object(q.a)({logSigmoid_:function(t){const e=Object(G.a)(t,"x","logSigmoid");return Dn((t=>({value:Rn(Qo(Rn(t))),gradFunc:e=>me(e,js(Rn(t)))})))(e)}});j.a.prototype.logSigmoid=function(){return this.throwIfDisposed(),Zo(this)};const Jo=Object(q.a)({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Object(G.a)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and axis was ").concat(e));const i={logits:n},r={axis:e};return c.a.runKernelFunc(((n,i)=>{const r=pe(t,e,!0),s=Ne(t,r),o=Ne(H(s,"float32"),jn(Sn(Wn(s),e,!0)));return i([o]),o}),i,null,W.ub,r)}});j.a.prototype.logSoftmax=function(t){return this.throwIfDisposed(),Jo(this,t)},j.a.prototype.logSumExp=function(t,e){return this.throwIfDisposed(),qn(this,t,e)},j.a.prototype.log=function(){return this.throwIfDisposed(),jn(this)},j.a.prototype.log1p=function(){return this.throwIfDisposed(),Gn(this)},j.a.prototype.logicalAnd=function(t){return this.throwIfDisposed(),fn(this,t)},j.a.prototype.logicalNot=function(){return this.throwIfDisposed(),Is(this)};const $o=Object(q.a)({logicalOr_:function(t,e){const n=Object(G.a)(t,"a","logicalOr","bool"),i=Object(G.a)(e,"b","logicalOr","bool");Le(n.shape,i.shape);const r={a:n,b:i};return c.a.runKernelFunc((t=>t.logicalOr(n,i)),r,null,W.xb)}});j.a.prototype.logicalOr=function(t){return this.throwIfDisposed(),$o(this,t)};const ta=Object(q.a)({logicalXor_:function(t,e){const n=Object(G.a)(t,"a","logicalXor","bool"),i=Object(G.a)(e,"b","logicalXor","bool");return Le(n.shape,i.shape),fn($o(t,e),Is(fn(t,e)))}});j.a.prototype.logicalXor=function(t){return this.throwIfDisposed(),ta(this,t)},j.a.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),de(this,t,e,n)},j.a.prototype.maxPool=function(t,e,n,i){return this.throwIfDisposed(),fe(this,t,e,n,i)},j.a.prototype.max=function(t,e){return this.throwIfDisposed(),pe(this,t,e)},j.a.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ho(this,t)},j.a.prototype.maximum=function(t){return this.throwIfDisposed(),ro(this,t)},j.a.prototype.mean=function(t,e){return this.throwIfDisposed(),Fn(this,t,e)},j.a.prototype.min=function(t,e){return this.throwIfDisposed(),xn(this,t,e)},j.a.prototype.minimumStrict=function(t){return this.throwIfDisposed(),po(this,t)},j.a.prototype.minimum=function(t){return this.throwIfDisposed(),Un(this,t)};const ea=Object(q.a)({mirrorPad_:function(t,e,n){w.b("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. Got ".concat(n,".")));const i=Object(G.a)(t,"x","mirrorPad");if(0===i.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");w.b(e.length===i.rank,(()=>"Padding doesn't match input. Must be ".concat(i.rank,". Got ").concat(e.length,".")));const r="reflect"===n?1:0;for(let a=0;a<i.rank;a++)w.b(2===e[a].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),w.b(e[a][0]>=0&&e[a][0]<=i.shape[a]-r&&e[a][1]>=0&&e[a][1]<=i.shape[a]-r,(()=>"Padding in dimension ".concat(a," cannot be greater than or equal to ").concat(i.shape[a]-r," or less than 0 for input of shape ")+i.shape));const s={paddings:e,mode:n},o={x:i};return c.a.runKernel(W.Ib,o,s)}});j.a.prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),ea(this,t,e)},j.a.prototype.modStrict=function(t){return this.throwIfDisposed(),fo(this,t)},j.a.prototype.mod=function(t){return this.throwIfDisposed(),co(this,t)},j.a.prototype.mulStrict=function(t){return this.throwIfDisposed(),mo(this,t)},j.a.prototype.mul=function(t){return this.throwIfDisposed(),me(this,t)},j.a.prototype.neg=function(){return this.throwIfDisposed(),Rn(this)},j.a.prototype.norm=function(t,e,n){return this.throwIfDisposed(),_n(this,t,e,n)},j.a.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Vo(this,t)},j.a.prototype.notEqual=function(t){return this.throwIfDisposed(),Ln(this,t)},j.a.prototype.oneHot=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),ge(this,t,e,n)};const na=Object(q.a)({onesLike_:function(t){const e=Object(G.a)(t,"x","onesLike"),n={x:e};return c.a.runKernelFunc(((t,n)=>{if("complex64"===e.dtype){const t=na(je(e)),n=ze(Ue(e));return Object(_e.a)(t,n)}return t.onesLike(e)}),n,null,W.Rb)}});j.a.prototype.onesLike=function(){return this.throwIfDisposed(),na(this)},j.a.prototype.pad=function(t,e){return this.throwIfDisposed(),Bs(this,t,e)};const ia=Object(q.a)({pool_:function(t,e,n,i,r,s){null==r&&(r=[1,1]),null==s&&(s=1),0===i&&(i="valid");const o=Object(G.a)(t,"x","maxPool");let a=o,c=!1;3===o.rank&&(c=!0,a=Nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),w.b(Qt(s,r),(()=>"Error in pool: Either strides or dilations must be 1. Got strides ".concat(s," and dilations '").concat(r,"'")));const l=Ut(a.shape,e,s,r,i),u=[l.dilationHeight,l.dilationWidth];let h;h="same"===i?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))).map((t=>t-1)),i=n.map((t=>Math.floor(t/2))),r=n.map(((t,e)=>t-i[e]));return n.map(((t,e)=>[i[e],r[e]]))}([l.filterHeight,l.filterWidth],u):[[0,0],[0,0]];const d=1===u[0]&&1===u[1],[p,f]=function(t,e,n){const i=n.map((t=>t[0])),r=n.map((t=>t[1])),s=t.concat(i,r),o=e.map(((t,e)=>(t-s[e]%t)%t)),a=r.map(((t,e)=>t+o[e]));return[e.map(((t,e)=>[i[e],a[e]])),e.map(((t,e)=>[0,o[e]]))]}([l.inHeight,l.inWidth],u,h),m=d?i:"valid",g=d?a:ar(a,u,p),v=("avg"===n?()=>Ao(g,e,s,m):()=>fe(g,e,s,m))(),y=d?v:Ws(v,u,f);return c?Nt(y,[y.shape[1],y.shape[2],y.shape[3]]):y}});j.a.prototype.pool=function(t,e,n,i,r){return this.throwIfDisposed(),ia(this,t,e,n,i,r)},j.a.prototype.powStrict=function(t){return this.throwIfDisposed(),go(this,t)},j.a.prototype.pow=function(t){return this.throwIfDisposed(),ve(this,t)},j.a.prototype.prelu=function(t){return this.throwIfDisposed(),Kn(this,t)};const ra=Object(q.a)({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Object(G.a)(t,"x","prod");"bool"===i.dtype&&(i=H(i,"int32"));const r={x:i},s={axis:e,keepDims:n};return c.a.runKernelFunc((t=>{const r=Object(w.I)(e,i.shape),s=re(r,i.rank);let o=r,a=i;null!=s&&(a=ae(i,s),o=oe(o.length,i.rank));let c=t.prod(a,o);if(n){const t=ne(c.shape,r);c=Nt(c,t)}return c}),r,null,W.Vb,s)}});j.a.prototype.prod=function(t,e){return this.throwIfDisposed(),ra(this,t,e)};const sa=Object(q.a)({reciprocal_:function(t){const e=Object(G.a)(t,"x","reciprocal"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.reciprocal(e);return n([e]),i}),n,null,W.Yb)}});j.a.prototype.reciprocal=function(){return this.throwIfDisposed(),sa(this)},j.a.prototype.relu=function(){return this.throwIfDisposed(),zn(this)},j.a.prototype.relu6=function(){return this.throwIfDisposed(),Qn(this)},j.a.prototype.reshapeAs=function(t){return this.throwIfDisposed(),Nt(this,t.shape)},j.a.prototype.reshape=function(t){return this.throwIfDisposed(),Nt(this,t)},j.a.prototype.resizeBilinear=function(t,e){return this.throwIfDisposed(),un(this,t,e)},j.a.prototype.resizeNearestNeighbor=function(t,e){return this.throwIfDisposed(),hn(this,t,e)},j.a.prototype.reverse=function(t){return this.throwIfDisposed(),He(this,t)},j.a.prototype.rfft=function(){return this.throwIfDisposed(),Ge(this)};const oa=Object(q.a)({round_:function(t){const e=Object(G.a)(t,"x","round"),n={x:e};return c.a.runKernelFunc((t=>t.round(e)),n,null,W.ic)}});j.a.prototype.round=function(){return this.throwIfDisposed(),oa(this)},j.a.prototype.rsqrt=function(){return this.throwIfDisposed(),Lr(this)};const aa=Object(q.a)({selu_:function(t){const e=Object(G.a)(t,"x","selu"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.selu(e);return n([e]),i}),n,null,W.lc)}});j.a.prototype.selu=function(){return this.throwIfDisposed(),aa(this)},j.a.prototype.separableConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),ke(this,t,e,n,i,r,s)},j.a.prototype.sigmoid=function(){return this.throwIfDisposed(),js(this)};const ca=Object(q.a)({sign_:function(t){const e=Object(G.a)(t,"x","sign"),n={x:e};return c.a.runKernelFunc((t=>t.sign(e)),n,null,W.nc)}});j.a.prototype.sign=function(){return this.throwIfDisposed(),ca(this)},j.a.prototype.sin=function(){return this.throwIfDisposed(),wr(this)},j.a.prototype.sinh=function(){return this.throwIfDisposed(),_r(this)},j.a.prototype.slice=function(t,e){return this.throwIfDisposed(),Ve(this,t,e)},j.a.prototype.softmax=function(t){return this.throwIfDisposed(),Ae(this,t)},j.a.prototype.softplus=function(){return this.throwIfDisposed(),Qo(this)},j.a.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ar(this,t,e)},j.a.prototype.split=function(t,e){return this.throwIfDisposed(),Oe(this,t,e)},j.a.prototype.sqrt=function(){return this.throwIfDisposed(),bn(this)},j.a.prototype.square=function(){return this.throwIfDisposed(),wn(this)},j.a.prototype.squaredDifference=function(t){return this.throwIfDisposed(),Vn(this,t)},j.a.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),vo(this,t)},j.a.prototype.squeeze=function(t){return this.throwIfDisposed(),Re(this,t)},j.a.prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof j.a?[this,t]:[this,...t];return gn(n,e)},j.a.prototype.step=function(t){return this.throwIfDisposed(),Zn(this,t)};const la=Object(q.a)({stridedSlice_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=Object(G.a)(t,"x","stridedSlice");const h={x:u},d={begin:e,end:n,strides:i,beginMask:r,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return c.a.runKernelFunc((t=>{null==i&&(i=new Array(e.length));const c=ft(o);if(c.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==a)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==l)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const h=u.rank-e.length,d=ft(a),p=u.shape.slice();d.forEach((t=>{e[t]=0,n[t]=1,p.splice(t,0,1)})),u=Nt(u,p);const{begin:f,end:m,strides:g}=xt(u.shape,c,h,e,n,i,r,s,o);e=f,n=m,i=g;const v=ft(l);v.forEach((t=>{n[t]=e[t]+1,i[t]=1}));const y=mt(e,n,i),x=y.filter(((t,e)=>-1===v.indexOf(e)));if(i.every((t=>1===t)))return Nt(Ve(u,e,y),x);const b=t.stridedSlice(u,e,n,i);return Nt(b,x)}),h,null,W.zc,d)}});j.a.prototype.stridedSlice=function(t,e,n,i,r,s,o,a){return this.throwIfDisposed(),la(this,t,e,n,i,r,s,o,a)},j.a.prototype.subStrict=function(t){return this.throwIfDisposed(),yo(this,t)},j.a.prototype.sub=function(t){return this.throwIfDisposed(),Ne(this,t)},j.a.prototype.sum=function(t,e){return this.throwIfDisposed(),Sn(this,t,e)};const ua=Object(q.a)({tan_:function(t){const e=Object(G.a)(t,"x","tan"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.tan(e);return n([e]),i}),n,null,W.Cc)}});j.a.prototype.tan=function(){return this.throwIfDisposed(),ua(this)};const ha=Object(q.a)({tanh_:function(t){const e=Object(G.a)(t,"x","tanh"),n={x:e};return c.a.runKernelFunc(((t,n)=>{const i=t.tanh(e);return n([i]),i}),n,null,W.Dc)}});j.a.prototype.tanh=function(){return this.throwIfDisposed(),ha(this)},j.a.prototype.tile=function(t){return this.throwIfDisposed(),Me(this,t)},j.a.prototype.toBool=function(){return this.throwIfDisposed(),H(this,"bool")},j.a.prototype.toFloat=function(){return this.throwIfDisposed(),H(this,"float32")},j.a.prototype.toInt=function(){return this.throwIfDisposed(),H(this,"int32")};const da=Object(q.a)({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=Object(G.a)(t,"x","topk");if(0===i.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const r=i.shape[i.shape.length-1];if(e>r)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(r,") but got ")+e);const s={x:i},o={k:e,sorted:n},[a,l]=c.a.runKernelFunc((t=>t.topk(i,e,n)),s,null,W.Fc,o);return{values:a,indices:l}}});j.a.prototype.topk=function(t,e){return this.throwIfDisposed(),da(this,t,e)},j.a.prototype.transpose=function(t){return this.throwIfDisposed(),ae(this,t)};const pa=Object(q.a)({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Object(G.a)(t,"x","unique",null);Object(w.b)(n.rank>0,(()=>"The input tensor must be at least 1D"));const i={x:n},r={axis:e},[s,o]=c.a.runKernel(W.Hc,i,r);return{values:s,indices:o}}});j.a.prototype.unique=function(t){return this.throwIfDisposed(),pa(this,t)},j.a.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),zr(this,t,e)},j.a.prototype.unstack=function(t){return this.throwIfDisposed(),vn(this,t)},j.a.prototype.where=function(t,e){return this.throwIfDisposed(),Be(t,this,e)},j.a.prototype.zerosLike=function(){return this.throwIfDisposed(),ze(this)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return h})),n.d(e,"j",(function(){return d})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return f})),n.d(e,"n",(function(){return m})),n.d(e,"m",(function(){return g})),n.d(e,"o",(function(){return v})),n.d(e,"r",(function(){return y})),n.d(e,"p",(function(){return x})),n.d(e,"q",(function(){return b})),n.d(e,"s",(function(){return w})),n.d(e,"t",(function(){return S})),n.d(e,"u",(function(){return _})),n.d(e,"v",(function(){return T})),n.d(e,"w",(function(){return E})),n.d(e,"x",(function(){return C})),n.d(e,"y",(function(){return k})),n.d(e,"z",(function(){return A})),n.d(e,"A",(function(){return I})),n.d(e,"B",(function(){return O})),n.d(e,"C",(function(){return R})),n.d(e,"D",(function(){return N})),n.d(e,"E",(function(){return M})),n.d(e,"F",(function(){return D})),n.d(e,"G",(function(){return P})),n.d(e,"H",(function(){return F})),n.d(e,"J",(function(){return L})),n.d(e,"I",(function(){return B})),n.d(e,"K",(function(){return z})),n.d(e,"L",(function(){return U})),n.d(e,"M",(function(){return j})),n.d(e,"N",(function(){return V})),n.d(e,"O",(function(){return W})),n.d(e,"Q",(function(){return G})),n.d(e,"P",(function(){return q})),n.d(e,"R",(function(){return H})),n.d(e,"S",(function(){return X})),n.d(e,"T",(function(){return Y})),n.d(e,"V",(function(){return K})),n.d(e,"U",(function(){return Q})),n.d(e,"W",(function(){return Z})),n.d(e,"X",(function(){return J})),n.d(e,"Y",(function(){return $})),n.d(e,"Z",(function(){return tt})),n.d(e,"ab",(function(){return et})),n.d(e,"bb",(function(){return nt})),n.d(e,"cb",(function(){return it})),n.d(e,"eb",(function(){return rt})),n.d(e,"fb",(function(){return st})),n.d(e,"gb",(function(){return ot})),n.d(e,"hb",(function(){return at})),n.d(e,"jb",(function(){return ct})),n.d(e,"ib",(function(){return lt})),n.d(e,"kb",(function(){return ut})),n.d(e,"lb",(function(){return ht})),n.d(e,"mb",(function(){return dt})),n.d(e,"nb",(function(){return pt})),n.d(e,"qb",(function(){return ft})),n.d(e,"rb",(function(){return mt})),n.d(e,"sb",(function(){return gt})),n.d(e,"tb",(function(){return vt})),n.d(e,"vb",(function(){return yt})),n.d(e,"wb",(function(){return xt})),n.d(e,"xb",(function(){return bt})),n.d(e,"ub",(function(){return wt})),n.d(e,"ob",(function(){return St})),n.d(e,"pb",(function(){return _t})),n.d(e,"yb",(function(){return Tt})),n.d(e,"Eb",(function(){return Et})),n.d(e,"zb",(function(){return Ct})),n.d(e,"Cb",(function(){return kt})),n.d(e,"Ab",(function(){return At})),n.d(e,"Bb",(function(){return It})),n.d(e,"Db",(function(){return Ot})),n.d(e,"Fb",(function(){return Rt})),n.d(e,"Gb",(function(){return Nt})),n.d(e,"Hb",(function(){return Mt})),n.d(e,"Ib",(function(){return Dt})),n.d(e,"Jb",(function(){return Pt})),n.d(e,"Kb",(function(){return Ft})),n.d(e,"Lb",(function(){return Lt})),n.d(e,"Pb",(function(){return Bt})),n.d(e,"Mb",(function(){return zt})),n.d(e,"Nb",(function(){return Ut})),n.d(e,"Ob",(function(){return jt})),n.d(e,"Rb",(function(){return Vt})),n.d(e,"Qb",(function(){return Wt})),n.d(e,"Sb",(function(){return Gt})),n.d(e,"Tb",(function(){return qt})),n.d(e,"Ub",(function(){return Ht})),n.d(e,"Vb",(function(){return Xt})),n.d(e,"Wb",(function(){return Yt})),n.d(e,"Xb",(function(){return Kt})),n.d(e,"Yb",(function(){return Qt})),n.d(e,"Zb",(function(){return Zt})),n.d(e,"bc",(function(){return Jt})),n.d(e,"ec",(function(){return $t})),n.d(e,"fc",(function(){return te})),n.d(e,"cc",(function(){return ee})),n.d(e,"dc",(function(){return ne})),n.d(e,"ac",(function(){return ie})),n.d(e,"gc",(function(){return re})),n.d(e,"ic",(function(){return se})),n.d(e,"jc",(function(){return oe})),n.d(e,"kc",(function(){return ae})),n.d(e,"lc",(function(){return ce})),n.d(e,"qc",(function(){return le})),n.d(e,"oc",(function(){return ue})),n.d(e,"pc",(function(){return he})),n.d(e,"nc",(function(){return de})),n.d(e,"mc",(function(){return pe})),n.d(e,"sc",(function(){return fe})),n.d(e,"vc",(function(){return me})),n.d(e,"Bc",(function(){return ge})),n.d(e,"tc",(function(){return ve})),n.d(e,"uc",(function(){return ye})),n.d(e,"rc",(function(){return xe})),n.d(e,"xc",(function(){return be})),n.d(e,"wc",(function(){return we})),n.d(e,"Ac",(function(){return Se})),n.d(e,"zc",(function(){return _e})),n.d(e,"Cc",(function(){return Te})),n.d(e,"Dc",(function(){return Ee})),n.d(e,"Ec",(function(){return Ce})),n.d(e,"Fc",(function(){return ke})),n.d(e,"Gc",(function(){return Ae})),n.d(e,"Hc",(function(){return Ie})),n.d(e,"Ic",(function(){return Oe})),n.d(e,"Jc",(function(){return Re})),n.d(e,"Kc",(function(){return Ne})),n.d(e,"yc",(function(){return Me})),n.d(e,"db",(function(){return De})),n.d(e,"hc",(function(){return Pe}));const i="Abs",r="Acos",s="Acosh",o="Add",a="AddN",c="All",l="Any",u="ArgMax",h="ArgMin",d="Asin",p="Asinh",f="Atan",m="Atanh",g="Atan2",v="AvgPool",y="AvgPoolBackprop",x="AvgPool3D",b="AvgPool3DBackprop",w="BatchMatMul",S="BatchToSpaceND",_="BroadcastTo",T="Cast",E="Ceil",C="ClipByValue",k="Complex",A="Concat",I="Conv2D",O="Conv2DBackpropFilter",R="Conv2DBackpropInput",N="Conv3D",M="Conv3DBackpropFilterV2",D="Conv3DBackpropInputV2",P="Cos",F="Cosh",L="Cumsum",B="CropAndResize",z="DepthToSpace",U="DepthwiseConv2dNative",j="DepthwiseConv2dNativeBackpropFilter",V="DepthwiseConv2dNativeBackpropInput",W="Dilation2D",G="Dilation2DBackpropInput",q="Dilation2DBackpropFilter",H="Div",X="Elu",Y="EluGrad",K="Erf",Q="Equal",Z="Exp",J="Expm1",$="FFT",tt="Fill",et="FlipLeftRight",nt="Floor",it="FloorDiv",rt="FusedBatchNorm",st="GatherV2",ot="Greater",at="GreaterEqual",ct="Identity",lt="IFFT",ut="Imag",ht="IsFinite",dt="IsInf",pt="IsNan",ft="Less",mt="LessEqual",gt="Log",vt="Log1p",yt="LogicalAnd",xt="LogicalNot",bt="LogicalOr",wt="LogSoftmax",St="LRN",_t="LRNBackprop",Tt="Max",Et="Maximum",Ct="MaxPool",kt="MaxPoolBackprop",At="MaxPool3D",It="MaxPool3DBackprop",Ot="MaxPoolWithArgmax",Rt="Mean",Nt="Min",Mt="Minimum",Dt="MirrorPad",Pt="Mod",Ft="Multiply",Lt="Negate",Bt="NotEqual",zt="NonMaxSuppressionV3",Ut="NonMaxSuppressionV4",jt="NonMaxSuppressionV5",Vt="OnesLike",Wt="OneHot",Gt="PadV2",qt="Pow",Ht="Prelu",Xt="Prod",Yt="Range",Kt="Real",Qt="Reciprocal",Zt="Relu",Jt="Reshape",$t="ResizeNearestNeighbor",te="ResizeNearestNeighborGrad",ee="ResizeBilinear",ne="ResizeBilinearGrad",ie="Relu6",re="Reverse",se="Round",oe="Rsqrt",ae="SelectV2",ce="Selu",le="Slice",ue="Sin",he="Sinh",de="Sign",pe="Sigmoid",fe="Softplus",me="Sqrt",ge="Sum",ve="SpaceToBatchND",ye="SplitV",xe="Softmax",be="SquaredDifference",we="Square",Se="Sub",_e="StridedSlice",Te="Tan",Ee="Tanh",Ce="Tile",ke="TopK",Ae="Transpose",Ie="Unique",Oe="Unpack",Re="UnsortedSegmentSum",Ne="ZerosLike",Me="Step",De="FromPixels",Pe="RotateWithOffset"},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__2__},function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return h}));var i=n(6),r=n(11),s=n(5),o=n(16),a=n(7);function c(t,e){let n=t;if(Object(o.A)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const i=[];for(;Array.isArray(n)||Object(o.A)(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&Object(r.b)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,i){if(i=i||[],!Array.isArray(e)&&!Object(o.A)(e))return void Object(o.b)(0===n.length,(()=>"Element arr[".concat(i.join("]["),"] is a primitive, but should be an array/TypedArray of ").concat(n[0]," elements")));Object(o.b)(n.length>0,(()=>"Element arr[".concat(i.join("]["),"] should be a primitive, but is an array of ").concat(e.length," elements"))),Object(o.b)(e.length===n[0],(()=>"Element arr[".concat(i.join("]["),"] should have ").concat(n[0]," elements, but has ").concat(e.length," elements")));const r=n.slice(1);for(let s=0;s<e.length;++s)t(e[s],r,i.concat(s))}(t,i,[]),i}function l(t,e,n,i){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '".concat(n,"' passed to '").concat(i,"' must be ").concat(t," tensor, but got ").concat(e," tensor"))}function u(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof s.a)return l(r,t.dtype,e,n),t;let u=Object(o.r)(t);if("string"!==u&&["bool","int32","float32"].indexOf(r)>=0&&(u=r),l(r,u,e,n),null==t||!Object(o.A)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){const i=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a Tensor or TensorLike, but got '").concat(i,"'"))}const h=c(t,u);Object(o.A)(t)||Array.isArray(t)||(t=[t]);const d="string"!==u?Object(a.toTypedArray)(t,u):Object(o.m)(t,[],!0);return i.a.makeTensor(d,h,u)}function h(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a `Tensor[]` or `TensorLike[]`"));return t.map(((t,i)=>u(t,"".concat(e,"[").concat(i,"]"),n)),i)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(6),r=n(16);function s(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const o=function(){i.a.startScope(n);try{const t=s(...arguments);return Object(r.x)(t)&&console.error("Cannot return a Promise inside of tidy."),i.a.endScope(t),t}catch(t){throw i.a.endScope(null),t}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return g}));var i=n(16);function r(t,e,n){let r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":Object(i.z)(t)?"'".concat(t,"'"):"bool"===n?s(t):parseFloat(t.toFixed(7)).toString(),Object(i.L)(r,e)}function s(t){return 0===t?"false":"true"}function o(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var a=n(7);class c{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=i.N(t),null!=n){const t=n.length;i.b(t===this.size,(()=>"Length of values '".concat(t,"' does not match the size inferred by the shape '").concat(this.size,"'.")))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.n(e,this.size),this.strides=Object(i.j)(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),i.b(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must match the rank (").concat(this.rank,")")));const s=this.locToIndex(n);this.values[s]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let i=0;for(const s of e){if(s<0||s>=this.shape[i]){const t="Requested out of range element at ".concat(e,".   Buffer shape=")+this.shape;throw new Error(t)}i++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return l().makeTensor(this.values,this.shape,this.dtype)}}let l=null,u=null,h=null;function d(t){l=t}function p(t){u=t}function f(t){h=t}class m{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.N(t),this.strides=Object(i.j)(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return u.buffer(this.shape,this.dtype,t)}bufferSync(){return u.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Object(i.S)(this.shape,t)}arraySync(){return Object(i.S)(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=l().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map((t=>a.decodeString(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=l().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>a.decodeString(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await l().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(l().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return u.print(this,t)}clone(){return this.throwIfDisposed(),u.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e,n,a){const c=Object(i.j)(e),l=function(t,e,n,s){const a=Object(i.N)(e),c=s[s.length-1],l=new Array(c).fill(0),u=e.length,h="complex64"===n?o(t):t;if(u>1)for(let i=0;i<a/c;i++){const t=i*c;for(let e=0;e<c;e++)l[e]=Math.max(l[e],r(h[t+e],0,n).length)}return l}(t,e,n,c),u=e.length,h=function t(e,n,i,a,c){let l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const u="complex64"===i?2:1,h=n[0],d=n.length;if(0===d)return"complex64"===i?[r(o(e)[0],0,i)]:"bool"===i?[s(e[0])]:[e[0].toString()];if(1===d){if(h>20){const t=3*u;let n=Array.from(e.slice(0,t)),s=Array.from(e.slice((h-3)*u,h*u));return"complex64"===i&&(n=o(n),s=o(s)),["["+n.map(((t,e)=>r(t,c[e],i))).join(", ")+", ..., "+s.map(((t,e)=>r(t,c[h-3+e],i))).join(", ")+"]"]}return["["+("complex64"===i?o(e):Array.from(e)).map(((t,e)=>r(t,c[e],i))).join(", ")+"]"]}const p=n.slice(1),f=a.slice(1),m=a[0]*u,g=[];if(h>20){for(let n=0;n<3;n++){const r=n*m,s=r+m;g.push(...t(e.slice(r,s),p,i,f,c,!1))}g.push("...");for(let n=h-3;n<h;n++){const r=n*m,s=r+m;g.push(...t(e.slice(r,s),p,i,f,c,n===h-1))}}else for(let r=0;r<h;r++){const n=r*m,s=n+m;g.push(...t(e.slice(n,s),p,i,f,c,r===h-1))}const v=2===d?",":"";g[0]="["+g[0]+v;for(let r=1;r<g.length-1;r++)g[r]=" "+g[r]+v;let y=",\n";for(let r=2;r<d;r++)y+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(l?"":y),g}(t,e,n,c,l),d=["Tensor"];return a&&(d.push("  dtype: "+n),d.push("  rank: "+u),d.push("  shape: [".concat(e,"]")),d.push("  values:")),d.push(h.map((t=>"    "+t)).join("\n")),d.join("\n")}(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),u.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),l().makeVariable(this,t,e,n)}}Object.defineProperty(m,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed});class g extends m{constructor(t,e,n,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and previous value (").concat(this.dtype,") must match"));if(!i.a(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and previous value (").concat(this.shape,") must match"));l().disposeTensor(this),this.dataId=t.dataId,l().incRef(this,null)}dispose(){l().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(g,Symbol.hasInstance,{value:t=>t instanceof m&&null!=t.assign&&t.assign instanceof Function})},function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return y}));var i=n(39),r=n(11),s=n(40),o=n(1),a=n(26),c=n(16);class l{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new h)}profileKernel(t,e,n){let i;const r=this.backendTimer.time((()=>{i=n()}));for(let s=0;s<i.length;s++){const e=i[s];e.data().then((n=>{u(n,e.dtype,t)}))}return{kernelName:t,outputs:i,inputs:e,timeMs:r.then((t=>t.kernelMs)),extraInfo:r.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:i,inputs:r,extraInfo:s}=t;n.forEach((t=>{Promise.all([t.data(),i,s]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],r,n[2])}))}))}}function u(t,e,n){if("float32"!==e)return!1;for(let i=0;i<t.length;i++){const e=t[i];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class h{logKernelProfile(t,e,n,i,r,s){const o="number"==typeof i?c.L(i+"ms",9):i.error,a=c.L(t,25),l=e.rank,u=e.size,h=c.L(e.shape.toString(),14);let d="";for(const c in r){const t=r[c];if(null!=t){const n=t.shape||e.shape,i=n.length;d+="".concat(c,": ").concat(i,"D ").concat(i>0?n:""," ")}}console.log("%c".concat(a,"\t%c").concat(o,"\t%c").concat(l,"D ").concat(h,"\t%c").concat(u,"\t%c").concat(d,"\t%c").concat(s),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var d=n(5),p=n(14),f=n(7);class m{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class g{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new m}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new l(this.backendInstance),!0}setupRegisteredKernels(){Object(a.c)(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){Object(a.c)(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof i.b||"function"!=typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,i=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn("Initialization of backend ".concat(t," failed")),console.warn(n.stack||n.message)),!1)));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}}catch(e){return console.warn("Initialization of backend ".concat(t," failed")),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:i,asyncInit:r}=this.initializeBackend(n);if(r||i)return{name:n,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),i=n.backend,r=this.readSync(e);i.disposeData(e),n.backend=t,t.move(e,r,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((()=>this.startScope(i)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(t){throw e(),t}}nextTensorId(){return g.nextTensorId++}nextVariableId(){return g.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t};return y.runKernelFunc((e=>e.cast(t,"float32")),e,null,o.v,{dtype:"float32"})}})),[],{}),e}runKernel(t,e,n,i,r){return this.runKernelFunc(null,e,null,t,n,i,r)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const i=this.backend.numDataIds();let r=0;n.forEach((t=>{r+="complex64"===t.dtype?3:1}));const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-e-r-s;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak (").concat(o," data ids) after running '").concat(t,"'"))}runKernelFunc(t,e,n,i,r,s,o){let c,l=[];const u=this.isTapeOn();null==i&&(i=null!=this.state.activeScope?this.state.activeScope.name:"");const h=this.state.numBytes,d=this.state.numTensors;let p;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const f=Object(a.b)(i,this.backendName);let m,g;if(null!=f)p=()=>{const t=this.backend.numDataIds();m=f.kernelFunc({inputs:e,attrs:r,backend:this.backend});const n=Array.isArray(m)?m:[m];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,t,n);const a=n.map((t=>{let{dataId:e,shape:n,dtype:i}=t;return this.makeTensorFromDataId(e,n,i)}));if(u){let t=this.getTensorsForGradient(i,e,a);if(null==t){null==o&&(o=[]);const e=a.filter(((t,e)=>o[e]));t=(s||[]).slice().concat(e)}l=this.saveTensorsForBackwardMode(t)}return a};else{const e=t=>{u&&(l=t.map((t=>this.keep(this.clone(t)))))};p=()=>{const n=this.backend.numDataIds();m=this.tidy((()=>t(this.backend,e)));const r=Array.isArray(m)?m:[m];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,n,r),r}}return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(g=this.profiler.profileKernel(i,e,(()=>p())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),c=g.outputs):c=p()})),u&&this.addTapeNode(i,e,c,n,l,r),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((t=>null!=e[t]?e[t].shape:null)),outputShapes:c.map((t=>t.shape)),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(m)?c:c[0]}saveTensorsForBackwardMode(t){return t.map((t=>this.keep(this.clone(t))))}getTensorsForGradient(t,e,n){const i=Object(a.a)(t);if(null!=i){const t=i.inputsToSave||[],r=i.outputsToSave||[];let s;i.saveAllInputs?(c.b(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),s=Object.keys(e).map((t=>e[t]))):s=t.map((t=>e[t]));const o=n.filter(((t,e)=>r[e]));return s.concat(o)}return null}makeTensor(t,e,n,i){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",i=i||this.backend;let r=t;"string"===n&&c.z(t[0])&&(r=t.map((t=>f.encodeString(t))));const s=i.write(r,e,n),o=new d.a(e,n,s,this.nextTensorId());if(this.incRef(o,i),"string"===n){const t=this.state.tensorInfo.get(s),e=Object(c.f)(r);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,i){n=n||"float32";const r=new d.a(e,n,t,this.nextTensorId());return this.incRef(r,i),r}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=i&&i!==t.dtype&&(t=t.cast(i));const r=new d.c(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw new Error("Variable with name ".concat(r.name," was already registered"));return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*c.g(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof d.c||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,i,r,s){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:r},l=Object(a.a)(t);null!=l&&(i=l.gradFunc),null!=i&&(o.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],i=c.F(t.size,t.dtype);return this.makeTensor(i,t.shape,t.dtype)}return t})),i(t.length>1?t:t[0],r,s))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Object(p.a)(t),n=new Set(e.map((t=>t.id)));for(let r=0;r<this.state.activeScope.track.length;r++){const t=this.state.activeScope.track[r];t.kept||n.has(t.id)||t.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==i.id||this.track(t)}))}gradients(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(c.b(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const r=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));c.b(r instanceof d.a,(()=>"The result y returned by f() must be a tensor."));const s=function(t,e,n){const i={},r={};for(let c=0;c<e.length;c++)i[e[c].id]=!0;for(let c=0;c<t.length;c++){const n=t[c],s=n.inputs;for(const t in s){const o=s[t];let a=!1;for(let t=0;t<e.length;t++)if(i[o.id]){n.outputs.forEach((t=>i[t.id]=!0)),a=!0,r[n.id]=!0;break}if(a)break}}const s={};s[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const e=t[c],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(s[e.outputs[t].id]){for(const t in n)s[n[t].id]=!0,o[e.id]=!0;break}}const a=[];for(let c=0;c<t.length;c++){const e=t[c];if(r[e.id]&&o[e.id]){const t={};for(const r in e.inputs){const n=e.inputs[r];i[n.id]&&(t[r]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,a.push(n)}}return a}(this.state.activeTape,e,r);if(!i&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[r.id]=null==n?function(t){const e=Object(c.D)(Object(c.N)(t),"float32");return y.makeTensor(e,t,"float32")}(r.shape):n,function(t,e,n,i){for(let r=e.length-1;r>=0;r--){const s=e[r],o=[];if(s.outputs.forEach((e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)})),null==s.gradient)throw new Error("Cannot compute gradient: gradient function not found for ".concat(s.kernelName,"."));const a=s.gradient(o);for(const e in s.inputs){if(!(e in a))throw new Error("Cannot backprop through input ".concat(e,". Available gradients found: ").concat(Object.keys(a),"."));const r=n((()=>a[e]()));if("float32"!==r.dtype)throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input ").concat(e," must have 'float32' dtype, but has '").concat(r.dtype,"'"));const o=s.inputs[e];if(!c.a(r.shape,o.shape))throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input '").concat(e,"' has shape '").concat(r.shape,"', which does not match the shape of the input '").concat(o.shape,"'"));if(null==t[o.id])t[o.id]=r;else{const e=t[o.id];t[o.id]=i(e,r),e.dispose()}}}}(t,s,(t=>this.tidy(t)),x);const i=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:r,grads:i}}))}customGrad(t){var e=this;return c.b(c.u(t),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];let s;c.b(i.every((t=>t instanceof d.a)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};return i.forEach(((t,e)=>{o[e]=t})),e.runKernelFunc(((e,n)=>(s=t(...i,n),c.b(s.value instanceof d.a,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),c.b(c.u(s.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),s.value)),o,((t,e)=>{const n=s.gradFunc(t,e),r=Array.isArray(n)?n:[n];c.b(r.length===i.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),c.b(r.every((t=>t instanceof d.a)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return r.forEach(((t,e)=>{o[e]=()=>t})),o}))}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=Object(f.now)(),n=await this.backend.time(t);return n.wallMs=Object(f.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new m;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function v(){const t=Object(s.b)();if(null==t._tfengine){const e=new r.a(t);t._tfengine=new g(e)}return Object(r.c)(t._tfengine.ENV),Object(d.f)((()=>t._tfengine)),t._tfengine}g.nextTensorId=0,g.nextVariableId=0;const y=v();function x(t,e){const n={a:t,b:e};return y.runKernelFunc(((n,i)=>{const r=n.add(t,e);return i([t,e]),r}),n,null,o.d)}},function(t,e,n){"use strict";n.r(e),n.d(e,"createScalarValue",(function(){return s})),n.d(e,"toTypedArray",(function(){return o})),n.d(e,"now",(function(){return a})),n.d(e,"fetch",(function(){return c})),n.d(e,"encodeString",(function(){return l})),n.d(e,"decodeString",(function(){return u}));var i=n(11),r=n(16);function s(t,e){return"string"===e?l(t):o([t],e)}function o(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=r.m(t)),Object(i.b)().getBool("DEBUG")&&r.h(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function a(){return Object(i.b)().platform.now()}function c(t,e){return Object(i.b)().platform.fetch(t,e)}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Object(i.b)().platform.encode(t,e)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Object(i.b)().platform.decode(t,e)}n.d(e,"shuffle",(function(){return r.M})),n.d(e,"clamp",(function(){return r.i})),n.d(e,"nearestLargerEven",(function(){return r.H})),n.d(e,"sum",(function(){return r.Q})),n.d(e,"randUniform",(function(){return r.J})),n.d(e,"distSquared",(function(){return r.l})),n.d(e,"assert",(function(){return r.b})),n.d(e,"assertShapesMatch",(function(){return r.e})),n.d(e,"assertNonNull",(function(){return r.d})),n.d(e,"flatten",(function(){return r.m})),n.d(e,"sizeFromShape",(function(){return r.N})),n.d(e,"isScalarShape",(function(){return r.y})),n.d(e,"arraysEqual",(function(){return r.a})),n.d(e,"isInt",(function(){return r.v})),n.d(e,"tanh",(function(){return r.R})),n.d(e,"sizeToSquarishShape",(function(){return r.O})),n.d(e,"createShuffledIndices",(function(){return r.k})),n.d(e,"rightPad",(function(){return r.L})),n.d(e,"repeatedTry",(function(){return r.K})),n.d(e,"inferFromImplicitShape",(function(){return r.s})),n.d(e,"parseAxisParam",(function(){return r.I})),n.d(e,"squeezeShape",(function(){return r.P})),n.d(e,"getTypedArrayFromDType",(function(){return r.o})),n.d(e,"getArrayFromDType",(function(){return r.n})),n.d(e,"checkConversionForErrors",(function(){return r.h})),n.d(e,"isValidDtype",(function(){return r.B})),n.d(e,"hasEncodingLoss",(function(){return r.p})),n.d(e,"isTypedArray",(function(){return r.A})),n.d(e,"bytesPerElement",(function(){return r.g})),n.d(e,"bytesFromStringArray",(function(){return r.f})),n.d(e,"isString",(function(){return r.z})),n.d(e,"isBoolean",(function(){return r.t})),n.d(e,"isNumber",(function(){return r.w})),n.d(e,"inferDtype",(function(){return r.r})),n.d(e,"isFunction",(function(){return r.u})),n.d(e,"nearestDivisor",(function(){return r.G})),n.d(e,"computeStrides",(function(){return r.j})),n.d(e,"toNestedArray",(function(){return r.S})),n.d(e,"makeOnesTypedArray",(function(){return r.D})),n.d(e,"makeZerosTypedArray",(function(){return r.F})),n.d(e,"makeZerosNestedTypedArray",(function(){return r.E})),n.d(e,"assertNonNegativeIntegerDimensions",(function(){return r.c})),n.d(e,"locToIndex",(function(){return r.C})),n.d(e,"indexToLoc",(function(){return r.q})),n.d(e,"isPromise",(function(){return r.x}))},function(t,e,n){"use strict";n.r(e),n.d(e,"DEFAULT_QUARTERS_PER_MINUTE",(function(){return i})),n.d(e,"DEFAULT_STEPS_PER_BAR",(function(){return r})),n.d(e,"DEFAULT_STEPS_PER_QUARTER",(function(){return s})),n.d(e,"DEFAULT_STEPS_PER_SECOND",(function(){return o})),n.d(e,"DEFAULT_VELOCITY",(function(){return a})),n.d(e,"DEFAULT_PROGRAM",(function(){return c})),n.d(e,"DEFAULT_TICKS_PER_QUARTER",(function(){return l})),n.d(e,"DEFAULT_CHANNEL",(function(){return u})),n.d(e,"DRUM_CHANNEL",(function(){return h})),n.d(e,"NON_DRUM_CHANNELS",(function(){return d})),n.d(e,"DEFAULT_DRUM_PITCH_CLASSES",(function(){return p})),n.d(e,"MIN_MIDI_VELOCITY",(function(){return f})),n.d(e,"MAX_MIDI_VELOCITY",(function(){return m})),n.d(e,"MIDI_VELOCITIES",(function(){return g})),n.d(e,"NO_CHORD",(function(){return v})),n.d(e,"NUM_PITCH_CLASSES",(function(){return y})),n.d(e,"MIN_MIDI_PITCH",(function(){return x})),n.d(e,"MAX_MIDI_PITCH",(function(){return b})),n.d(e,"MIDI_PITCHES",(function(){return w})),n.d(e,"MIN_PIANO_PITCH",(function(){return S})),n.d(e,"MAX_PIANO_PITCH",(function(){return _})),n.d(e,"MIN_DRUM_PITCH",(function(){return T})),n.d(e,"MAX_DRUM_PITCH",(function(){return E})),n.d(e,"MIN_MIDI_PROGRAM",(function(){return C})),n.d(e,"MAX_MIDI_PROGRAM",(function(){return k})),n.d(e,"LO_CLICK_PITCH",(function(){return A})),n.d(e,"HI_CLICK_PITCH",(function(){return I})),n.d(e,"LO_CLICK_CLASS",(function(){return O})),n.d(e,"HI_CLICK_CLASS",(function(){return R}));const i=120,r=16,s=4,o=100,a=80,c=0,l=220,u=0,h=9,d=[0,1,2,3,4,5,6,7,8,10,11,12,13,14,15],p=[[36,35],[38,27,28,31,32,33,34,37,39,40,56,65,66,75,85],[42,44,54,68,69,70,71,73,78,80],[46,67,72,74,79,81],[45,29,41,61,64,84],[48,47,60,63,77,86,87],[50,30,43,62,76,83],[49,55,57,58],[51,52,53,59,82]],f=0,m=127,g=m-f+1,v="N.C.",y=12,x=0,b=127,w=b-x+1,S=21,_=108,T=35,E=81,C=0,k=127,A=89,I=90,O=9,R=10},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__9__},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=n(35).tensorflow.magenta.NoteSequence},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a}));var i=n(16);class r{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. Overwriting the platform with ").concat(e,".")),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Object(i.x)(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. Please use getAsync() instead."));return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,i[0],i[1]),i.join("=")})),e}(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(e,n)}))}}function s(){return o}let o=null;function a(t){o=t}},function(t,e,n){"use strict";n.r(e),n.d(e,"Level",(function(){return i})),n.d(e,"verbosity",(function(){return s})),n.d(e,"setVerbosity",(function(){return o})),n.d(e,"log",(function(){return a})),n.d(e,"logWithDuration",(function(){return c}));var i,r=n(15);!function(t){t[t.NONE=0]="NONE",t[t.WARN=5]="WARN",t[t.INFO=10]="INFO",t[t.DEBUG=20]="DEBUG"}(i||(i={}));let s=10;function o(t){}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Magenta.js",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(0===n)throw Error("Logging level cannot be NONE.");s>=n&&(5===n?console.warn:console.log)("%c ".concat(e," "),"background:magenta; color:white",t)}function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Magenta.js",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;a("".concat(t," in ").concat(((r.d.now()-e)/1e3).toPrecision(3),"s"),n,i)}},function(t,e,n){"use strict";n.r(e),n.d(e,"MultipleTimeSignatureException",(function(){return s})),n.d(e,"BadTimeSignatureException",(function(){return o})),n.d(e,"NegativeTimeException",(function(){return a})),n.d(e,"MultipleTempoException",(function(){return c})),n.d(e,"QuantizationStatusException",(function(){return l})),n.d(e,"clone",(function(){return u})),n.d(e,"stepsPerQuarterToStepsPerSecond",(function(){return h})),n.d(e,"quantizeToStep",(function(){return d})),n.d(e,"quantizeNoteSequence",(function(){return m})),n.d(e,"isQuantizedSequence",(function(){return g})),n.d(e,"assertIsQuantizedSequence",(function(){return v})),n.d(e,"isRelativeQuantizedSequence",(function(){return y})),n.d(e,"assertIsRelativeQuantizedSequence",(function(){return x})),n.d(e,"isAbsoluteQuantizedSequence",(function(){return b})),n.d(e,"assertIsAbsoluteQuantizedSequence",(function(){return w})),n.d(e,"unquantizeSequence",(function(){return S})),n.d(e,"createQuantizedNoteSequence",(function(){return _})),n.d(e,"mergeInstruments",(function(){return T})),n.d(e,"replaceInstruments",(function(){return E})),n.d(e,"mergeConsecutiveNotes",(function(){return C})),n.d(e,"applySustainControlChanges",(function(){return k})),n.d(e,"concatenate",(function(){return A})),n.d(e,"trim",(function(){return I})),n.d(e,"split",(function(){return N}));var i=n(10),r=n(8);class s extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class o extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class c extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class l extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}function u(t){return i.a.decode(i.a.encode(t).finish())}function h(t,e){return t*e/60}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;const i=t*e;return Math.floor(i+(1-n))}function p(t){return t.controlChanges.concat(t.textAnnotations)}function f(t){if(t.tempos&&0!==t.tempos.length){if(t.tempos.sort(((t,e)=>t.time-e.time)),0!==t.tempos[0].time&&t.tempos[0].qpm!==r.DEFAULT_QUARTERS_PER_MINUTE)throw new c("NoteSequence has an implicit tempo change from initial "+r.DEFAULT_QUARTERS_PER_MINUTE+" qpm to "+"".concat(t.tempos[0].qpm," qpm at ").concat(t.tempos[0].time," seconds."));for(let e=1;e<t.tempos.length;e++)if(t.tempos[e].qpm!==t.tempos[0].qpm)throw new c("NoteSequence has at least one tempo change from ".concat(t.tempos[0].qpm," qpm to ").concat(t.tempos[e].qpm,"qpm at ").concat(t.tempos[e].time," seconds."))}}function m(t,e){const n=u(t);if(n.quantizationInfo=i.a.QuantizationInfo.create({stepsPerQuarter:e}),n.timeSignatures.length>0){if(n.timeSignatures.sort(((t,e)=>t.time-e.time)),0!==n.timeSignatures[0].time&&(4!==n.timeSignatures[0].numerator||4!==n.timeSignatures[0].denominator))throw new s("NoteSequence has an implicit change from initial 4/4 time signature to ".concat(n.timeSignatures[0].numerator,"/")+n.timeSignatures[0].denominator+" at "+n.timeSignatures[0].time+" seconds.");for(let t=1;t<n.timeSignatures.length;t++){const e=n.timeSignatures[t];if(e.numerator!==n.timeSignatures[0].numerator||e.denominator!==n.timeSignatures[0].denominator)throw new s("NoteSequence has at least one time signature change from "+n.timeSignatures[0].numerator+"/"+n.timeSignatures[0].denominator+" to "+"".concat(e.numerator,"/").concat(e.denominator," ")+"at ".concat(e.time," seconds"))}n.timeSignatures[0].time=0,n.timeSignatures=[n.timeSignatures[0]]}else{const t=i.a.TimeSignature.create({numerator:4,denominator:4,time:0});n.timeSignatures.push(t)}const c=n.timeSignatures[0];if(!(l=c.denominator)||0!=(l&l-1))throw new o("Denominator is not a power of 2. Time signature: ".concat(c.numerator,"/").concat(c.denominator));var l;if(0===c.numerator)throw new o("Numerator is 0. Time signature: ".concat(c.numerator,"/").concat(c.denominator));if(n.tempos.length>0)f(n),n.tempos[0].time=0,n.tempos=[n.tempos[0]];else{const t=i.a.Tempo.create({qpm:r.DEFAULT_QUARTERS_PER_MINUTE,time:0});n.tempos.push(t)}const m=h(e,n.tempos[0].qpm);return n.totalQuantizedSteps=d(t.totalTime,m),function(t,e){for(const n of t.notes){if(n.quantizedStartStep=d(n.startTime,e),n.quantizedEndStep=d(n.endTime,e),n.quantizedEndStep===n.quantizedStartStep&&(n.quantizedEndStep+=1),n.quantizedStartStep<0||n.quantizedEndStep<0)throw new a("Got negative note time: start_step = "+n.quantizedStartStep+", end_step = "+n.quantizedEndStep);n.quantizedEndStep>t.totalQuantizedSteps&&(t.totalQuantizedSteps=n.quantizedEndStep)}p(t).forEach((t=>{if(t.quantizedStep=d(t.time,e),t.quantizedStep<0)throw new a("Got negative event time: step = "+t.quantizedStep)}))}(n,m),n}function g(t){return t.quantizationInfo&&(t.quantizationInfo.stepsPerQuarter>0||t.quantizationInfo.stepsPerSecond>0)}function v(t){if(!g(t))throw new l("NoteSequence ".concat(t.id," is not quantized (missing quantizationInfo)"))}function y(t){return t.quantizationInfo&&t.quantizationInfo.stepsPerQuarter>0}function x(t){if(!y(t))throw new l("NoteSequence ".concat(t.id," is not quantized or is quantized based on absolute timing"))}function b(t){return t.quantizationInfo&&t.quantizationInfo.stepsPerSecond>0}function w(t){if(!b(t))throw new l("NoteSequence ".concat(t.id," is not quantized or is quantized based on relative timing"))}function S(t,e){x(t),f(t);const n=u(t);e?n.tempos&&n.tempos.length>0?n.tempos[0].qpm=e:n.tempos.push(i.a.Tempo.create({time:0,qpm:e})):e=t.tempos&&t.tempos.length>0?n.tempos[0].qpm:r.DEFAULT_QUARTERS_PER_MINUTE;const s=t=>t/n.quantizationInfo.stepsPerQuarter*(60/e);return n.totalTime=s(n.totalQuantizedSteps),n.notes.forEach((t=>{t.startTime=s(t.quantizedStartStep),t.endTime=s(t.quantizedEndStep),n.totalTime=Math.max(n.totalTime,t.endTime),delete t.quantizedStartStep,delete t.quantizedEndStep})),p(n).forEach((t=>{t.time=s(t.time)})),delete n.totalQuantizedSteps,delete n.quantizationInfo,n}function _(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.DEFAULT_STEPS_PER_QUARTER,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.DEFAULT_QUARTERS_PER_MINUTE;return i.a.create({quantizationInfo:{stepsPerQuarter:t},tempos:[{qpm:e}]})}function T(t){const e=u(t),n=e.notes.concat(e.pitchBends).concat(e.controlChanges),i=Array.from(new Set(n.filter((t=>!t.isDrum)).map((t=>t.program))));return n.forEach((t=>{t.isDrum?(t.program=0,t.instrument=i.length):t.instrument=i.indexOf(t.program)})),e}function E(t,e){const n=new Set(t.notes.map((t=>t.instrument))),r=new Set(e.notes.map((t=>t.instrument))),s=[];t.notes.forEach((t=>{r.has(t.instrument)||s.push(i.a.Note.create(t))})),e.notes.forEach((t=>{n.has(t.instrument)&&s.push(i.a.Note.create(t))}));const o=u(t);return o.notes=s.sort(((t,e)=>t.instrument-e.instrument||t.quantizedStartStep-e.quantizedStartStep)),o}function C(t){v(t);const e=u(t);e.notes=[];const n=t.notes.sort(((t,e)=>t.instrument-e.instrument||t.quantizedStartStep-e.quantizedStartStep)),r=new i.a.Note;r.pitch=n[0].pitch,r.instrument=n[0].instrument,r.quantizedStartStep=n[0].quantizedStartStep,r.quantizedEndStep=n[0].quantizedEndStep,e.notes.push(r);let s=0;for(let o=1;o<n.length;o++){const t=n[o],r=e.notes[s];if(r.instrument===t.instrument&&r.pitch===t.pitch&&t.quantizedStartStep===r.quantizedEndStep&&t.quantizedStartStep%16!=0)e.notes[s].quantizedEndStep+=t.quantizedEndStep-t.quantizedStartStep;else{const t=new i.a.Note;t.pitch=n[o].pitch,t.instrument=n[o].instrument,t.quantizedStartStep=n[o].quantizedStartStep,t.quantizedEndStep=n[o].quantizedEndStep,e.notes.push(t),s++}}return e}function k(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;if(function(t){t[t.SUSTAIN_ON=0]="SUSTAIN_ON",t[t.SUSTAIN_OFF=1]="SUSTAIN_OFF",t[t.NOTE_ON=2]="NOTE_ON",t[t.NOTE_OFF=3]="NOTE_OFF"}(e||(e={})),g(t))throw new Error("Can only apply sustain to unquantized NoteSequence.");const i=u(t),r=[];for(const c of i.notes)!1===c.isDrum&&(null!==c.startTime&&r.push({time:c.startTime,type:e.NOTE_ON,event:c}),null!==c.endTime&&r.push({time:c.endTime,type:e.NOTE_OFF,event:c}));for(const c of i.controlChanges)if(c.controlNumber===n){const t=c.controlValue;t>=64?r.push({time:c.time,type:e.SUSTAIN_ON,event:c}):t<64&&r.push({time:c.time,type:e.SUSTAIN_OFF,event:c})}r.sort(((t,e)=>t.time-e.time));const s={},o={};let a=0;for(const c of r){a=c.time;const t=c.type,n=c.event;if(t===e.SUSTAIN_ON)o[n.instrument]=!0;else if(t===e.SUSTAIN_OFF){o[n.instrument]=!1;const t=[];n.instrument in s||(s[n.instrument]=[]);for(const e of s[n.instrument])e.endTime<a?(e.endTime=a,a>i.totalTime&&(i.totalTime=a)):t.push(e);s[n.instrument]=t}else if(t===e.NOTE_ON){if(!0===o[n.instrument]){const t=[];n.instrument in s||(s[n.instrument]=[]);for(const e of s[n.instrument])e.pitch===n.pitch?(e.endTime=a,e.startTime===e.endTime&&i.notes.push(e)):t.push(e);s[n.instrument]=t}n.instrument in s||(s[n.instrument]=[]),s[n.instrument].push(n)}else if(t===e.NOTE_OFF)if(!0===o[n.instrument]);else{const t=s[n.instrument].indexOf(n);t>-1&&s[n.instrument].splice(t,1)}}for(const c of Object.values(s))for(const t of c)t.endTime=a,i.totalTime=a;return i}function A(t,e){if(e&&e.length!==t.length)throw new Error("Number of sequences to concatenate and their individual\n durations does not match.");if(g(t[0])){for(let e=0;e<t.length;++e)if(v(t[e]),t[e].quantizationInfo.stepsPerQuarter!==t[0].quantizationInfo.stepsPerQuarter)throw new Error("Not all sequences have the same quantizationInfo");return O(t,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",e)}return O(t,"totalTime","startTime","endTime",e)}function I(t,e,n,i){return g(t)?R(t,e,n,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",i):R(t,e,n,"totalTime","startTime","endTime",i)}function O(t,e,n,r,s){let o,a=0;for(let c=0;c<t.length;++c){const l=s?s[c]:t[c][e];if(0===l)throw Error("Sequence ".concat(t[c].id," has no ").concat(e,", and no individual duration was provided."));0===c?o=u(t[0]):Array.prototype.push.apply(o.notes,t[c].notes.map((t=>{const e=i.a.Note.create(t);return e[n]+=a,e[r]+=a,e}))),a+=l}return o[e]=a,o}function R(t,e,n,i,r,s,o){const a=u(t);a[i]=n,a.notes=a.notes.filter((t=>t[r]>=e&&t[r]<=n&&(o||t[s]<=n))),a[i]-=e;for(let c=0;c<a.notes.length;c++)a.notes[c][r]-=e,a.notes[c][s]-=e,o&&(a.notes[c][s]=Math.min(a.notes[c][s],a[i]));return a}function N(t,e){v(t);const n=u(t),r=n.notes.sort(((t,e)=>t.quantizedStartStep-e.quantizedStartStep)),s=[];let o=0,a=[];for(let c=0;c<r.length;c++){const t=r[c],l=t.quantizedStartStep,h=t.quantizedEndStep;if(t.quantizedStartStep-=o,t.quantizedEndStep-=o,!(t.quantizedStartStep<0))if(t.quantizedEndStep<=e)a.push(t);else{if(t.quantizedStartStep<e){const n=i.a.Note.create(t);n.quantizedEndStep=e,n.startTime=n.endTime=void 0,a.push(n),t.quantizedStartStep=o+e,t.quantizedEndStep=h}else t.quantizedStartStep=l,t.quantizedEndStep=h;if((t.quantizedEndStep>e||t.quantizedStartStep>e)&&(c-=1),0!==a.length){const t=u(n);t.notes=a,t.totalQuantizedSteps=e,s.push(t)}a=[],o+=e}}if(0!==a.length){const t=u(n);t.notes=a,t.totalQuantizedSteps=e,s.push(t)}return s}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return o}));var i=n(5),r=n(27);function s(t,e){if(t.dtype===e.dtype)return[t,e];const n=Object(r.b)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function o(t){const e=[];return function t(e,n,r){if(null==e)return;if(e instanceof i.a)return void n.push(e);if(s=e,!Array.isArray(s)&&"object"!=typeof s)return;var s;const o=e;for(const i in o){const e=o[i];r.has(e)||(r.add(e),t(e,n,r))}}(t,e,new Set),e}n(16)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return c}));const i=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("cannot find the global object")}(),r=i.fetch.bind(i),s=i.performance,o=(i.navigator,!!i.webkitOfflineAudioContext),a=void 0!==i.WorkerGlobalScope;function c(t){if(t=o?44100:t,a)throw new Error("Cannot use offline audio context in a web worker.");const e=i.webkitOfflineAudioContext;return o?new e(1,t,t):new i.OfflineAudioContext(1,t,t)}}).call(this,n(21))},function(t,e,n){"use strict";function i(t){let e=t.length,n=0,i=0;for(;e>0;)i=Math.random()*e|0,e--,n=t[e],t[e]=t[i],t[i]=n}function r(t,e,n){return Math.max(t,Math.min(e,n))}function s(t){return t%2==0?t:t+1}function o(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function a(t,e){const n=Math.random();return e*n+(1-n)*t}function c(t,e){let n=0;for(let i=0;i<t.length;i++){const r=Number(t[i])-Number(e[i]);n+=r*r}return n}function l(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(m(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}function h(t){l(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||O(t)&&!n)for(let i=0;i<t.length;++i)d(t[i],e,n);else e.push(t);return e}function p(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function f(t){return 0===t.length}function m(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function g(t){return t%1==0}function v(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function y(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function x(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return i(e),e}function b(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function w(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0;return new Promise(((i,r)=>{let s=0;const o=()=>{if(t())return void i();s++;const a=e(s);null!=n&&s>=n?r():setTimeout(o,a)};o()}))}function S(t,e){let n=1,i=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(-1===t[s]){if(-1!==i)throw Error("Shapes can only have 1 implicit size. Found -1 at dim ".concat(i," and dim ").concat(s));i=s}else if(t[s]<0)throw Error("Shapes can not be < 0. Found ".concat(t[s]," at dim ").concat(s));if(-1===i){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when there are 0 elements"));if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got ".concat(e," / ").concat(n));const r=t.slice();return r[i]=e/n,r}function _(t,e){const n=e.length;return l((t=null==t?e.map(((t,e)=>e)):[].concat(t)).every((t=>t>=-n&&t<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ")+t)),l(t.every((t=>g(t))),(()=>"All values in axis param must be integers but got axis "+t)),t.map((t=>t<0?n+t:t))}function T(t,e){const n=[],i=[],r=null!=e&&Array.isArray(e)&&0===e.length,s=null==e||r?null:_(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(null!=s){if(s[o]===a&&1!==t[a])throw new Error("Can't squeeze axis ".concat(a," since its dim '").concat(t[a],"' is not 1"));(null==s[o]||s[o]>a)&&1===t[a]&&(n.push(t[a]),i.push(a)),s[o]<=a&&o++}1!==t[a]&&(n.push(t[a]),i.push(a))}return{newShape:n,keptDims:i}}function E(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function C(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function k(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(isNaN(i)||!isFinite(i))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(i,"."))}}function A(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function I(t,e){return"complex64"!==e&&("float32"!==e||"complex64"===t)&&("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)}function O(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function R(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function N(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function M(t){return"string"==typeof t||t instanceof String}function D(t){return"boolean"==typeof t}function P(t){return"number"==typeof t}function F(t){return Array.isArray(t)?F(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":P(t)?"float32":M(t)?"string":D(t)?"bool":"float32"}function L(t){return!!(t&&t.constructor&&t.call&&t.apply)}function B(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function z(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let i=e-3;i>=0;--i)n[i]=n[i+1]*t[i+1];return n}function U(t,e){if(0===t.length)return e[0];const n=t.reduce(((t,e)=>t*e));if(0===n)return[];if(n!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length,"."));return function t(e,n,i){const r=new Array;if(1===n.length){const t=n[0];for(let n=0;n<t;n++)r[n]=i[e+n]}else{const s=n[0],o=n.slice(1),a=o.reduce(((t,e)=>t*e));for(let n=0;n<s;n++)r[n]=t(e+n*a,o,i)}return r}(0,t,e)}function j(t,e){const n=V(t,e);for(let i=0;i<n.length;i++)n[i]=1;return n}function V(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function W(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return U(t,new Float32Array(n));if("int32"===e)return U(t,new Int32Array(n));if("bool"===e)return U(t,new Uint8Array(n));throw new Error("Unknown data type "+e)}function G(t){t.forEach((e=>{l(Number.isInteger(e)&&e>=0,(()=>"Tensor must have a shape comprised of positive integers but got shape [".concat(t,"].")))}))}function q(t,e,n){if(0===e)return 0;if(1===e)return t[0];let i=t[t.length-1];for(let r=0;r<t.length-1;++r)i+=n[r]*t[r];return i}function H(t,e,n){if(0===e)return[];if(1===e)return[t];const i=new Array(e);for(let r=0;r<i.length-1;++r)i[r]=Math.floor(t/n[r]),t-=i[r]*n[r];return i[i.length-1]=t,i}function X(t){return t&&t.then&&"function"==typeof t.then}n.d(e,"M",(function(){return i})),n.d(e,"i",(function(){return r})),n.d(e,"H",(function(){return s})),n.d(e,"Q",(function(){return o})),n.d(e,"J",(function(){return a})),n.d(e,"l",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return h})),n.d(e,"m",(function(){return d})),n.d(e,"N",(function(){return p})),n.d(e,"y",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"v",(function(){return g})),n.d(e,"R",(function(){return v})),n.d(e,"O",(function(){return y})),n.d(e,"k",(function(){return x})),n.d(e,"L",(function(){return b})),n.d(e,"K",(function(){return w})),n.d(e,"s",(function(){return S})),n.d(e,"I",(function(){return _})),n.d(e,"P",(function(){return T})),n.d(e,"o",(function(){return E})),n.d(e,"n",(function(){return C})),n.d(e,"h",(function(){return k})),n.d(e,"B",(function(){return A})),n.d(e,"p",(function(){return I})),n.d(e,"A",(function(){return O})),n.d(e,"g",(function(){return R})),n.d(e,"f",(function(){return N})),n.d(e,"z",(function(){return M})),n.d(e,"t",(function(){return D})),n.d(e,"w",(function(){return P})),n.d(e,"r",(function(){return F})),n.d(e,"u",(function(){return L})),n.d(e,"G",(function(){return B})),n.d(e,"j",(function(){return z})),n.d(e,"S",(function(){return U})),n.d(e,"D",(function(){return j})),n.d(e,"F",(function(){return V})),n.d(e,"E",(function(){return W})),n.d(e,"c",(function(){return G})),n.d(e,"C",(function(){return q})),n.d(e,"q",(function(){return H})),n.d(e,"x",(function(){return X}))},function(t,e,n){"use strict";(function(t){n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"d",(function(){return f})),n.d(e,"c",(function(){return m})),n.d(e,"g",(function(){return g}));var i=n(19),r=n(24),s=n(16),o=n(41);async function a(t,e){const n=[],i=[],r=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let s=0;s<r.length;++s){const o=r[s],a=Array.isArray(t)?t[s].tensor:t[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(a.dtype));const c={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const t=new Promise((async t=>{const e=await a.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+4*e.length,i=new Uint8Array(n);let r=0;for(let s=0;s<e.length;s++){const t=e[s],n=new Uint8Array(new Uint32Array([t.length]).buffer);i.set(n,r),r+=4,i.set(t,r),r+=t.length}t(i)}));i.push(t)}else i.push(a.data());null!=e&&(c.group=e),n.push(c)}return{data:l(await Promise.all(i)),specs:n}}function c(t,e){const n={};let a,c=0;for(const l of e){const e=l.name,u=l.dtype,h=l.shape,d=Object(s.N)(h);let p;if("quantization"in l){const n=l.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error("Weight ".concat(l.name," with quantization ").concat(n.dtype," doesn't have corresponding metadata min and scale."))}else{if("float16"!==n.dtype)throw new Error("Weight ".concat(l.name," has unknown quantization dtype ").concat(n.dtype,". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'."));if("float32"!==u)throw new Error("Weight ".concat(l.name," is quantized with ").concat(n.dtype," which only supports weights of type float32 not ").concat(u,"."))}const i=o.a[n.dtype],r=t.slice(c,c+d*i),s="uint8"===n.dtype?new Uint8Array(r):new Uint16Array(r);if("float32"===u)if("uint8"===n.dtype||"uint16"===n.dtype){p=new Float32Array(s.length);for(let t=0;t<s.length;t++){const e=s[t];p[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," for weight type float32."));void 0===a&&(a=v()),p=a(s)}else{if("int32"!==u)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(u));if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," for weight type int32."));p=new Int32Array(s.length);for(let t=0;t<s.length;t++){const e=s[t];p[t]=Math.round(e*n.scale+n.min)}}c+=d*i}else if("string"===u){const e=Object(s.N)(l.shape);p=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(c,c+4))[0];c+=4;const n=new Uint8Array(t.slice(c,c+e));p.push(n),c+=e}}else{const s=o.a[u],a=t.slice(c,c+d*s);if("float32"===u)p=new Float32Array(a);else if("int32"===u)p=new Int32Array(a);else if("bool"===u)p=new Uint8Array(a);else{if("complex64"!==u)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(u));{p=new Float32Array(a);const t=new Float32Array(p.length/2),s=new Float32Array(p.length/2);for(let e=0;e<t.length;e++)t[e]=p[2*e],s[e]=p[2*e+1];const o=Object(r.a)(t,h,"float32"),c=Object(r.a)(s,h,"float32");n[e]=Object(i.a)(o,c),o.dispose(),c.dispose()}}c+=d*s}"complex64"!==u&&(n[e]=Object(r.a)(p,h,u))}return n}function l(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));const i=new Uint8Array(e);let r=0;return n.forEach((t=>{i.set(new Uint8Array(t.buffer),r),r+=t.byteLength})),i.buffer}const u=void 0!==t&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function h(e){return u?t.byteLength(e):new Blob([e]).size}function d(e){if(u)return t.from(e).toString("base64");const n=new Uint8Array(e);let i="";for(let t=0,r=n.length;t<r;t++)i+=String.fromCharCode(n[t]);return btoa(i)}function p(e){if(u){const n=t.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const n=atob(e),i=new Uint8Array(n.length);for(let t=0;t<n.length;++t)i.set([n.charCodeAt(t)],t);return i.buffer}function f(t){if(1===t.length)return t[0];let e=0;t.forEach((t=>{e+=t.byteLength}));const n=new Uint8Array(e);let i=0;return t.forEach((t=>{n.set(new Uint8Array(t),i),i+=t.byteLength})),n.buffer}function m(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function g(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:h(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:h(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function v(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return i=>{const r=new ArrayBuffer(4*i.length),s=new Uint32Array(r);for(let o=0;o<i.length;o++){const r=i[o],a=t[n[r>>10]+(1023&r)]+e[r>>10];s[o]=a}return new Float32Array(r)}}}).call(this,n(68).Buffer)},function(t,e,n){"use strict";(function(t){var i=e;function r(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;++r)void 0!==t[i[r]]&&n||(t[i[r]]=e[i[r]]);return t}function s(t){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}i.asPromise=n(51),i.base64=n(52),i.EventEmitter=n(53),i.float=n(54),i.inquire=n(55),i.utf8=n(56),i.pool=n(57),i.LongBits=n(58),i.isNode=Boolean(void 0!==t&&t&&t.process&&t.process.versions&&t.process.versions.node),i.global=i.isNode&&t||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},i.isString=function(t){return"string"==typeof t||t instanceof String},i.isObject=function(t){return t&&"object"==typeof t},i.isset=i.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var t=i.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(t){return"number"==typeof t?i.Buffer?i._Buffer_allocUnsafe(t):new i.Array(t):i.Buffer?i._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(t){return t?i.LongBits.from(t).toHash():i.LongBits.zeroHash},i.longFromHash=function(t,e){var n=i.LongBits.fromHash(t);return i.Long?i.Long.fromBits(n.lo,n.hi,e):n.toNumber(Boolean(e))},i.merge=r,i.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},i.newError=s,i.ProtocolError=s("ProtocolError"),i.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;n>-1;--n)if(1===e[t[n]]&&void 0!==this[t[n]]&&null!==this[t[n]])return t[n]}},i.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var t=i.Buffer;t?(i._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,n){return new t(e,n)},i._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}).call(this,n(21))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(6),r=n(1),s=n(3),o=n(16),a=n(4);const c=Object(a.a)({complex_:function(t,e){const n=Object(s.a)(t,"real","complex"),a=Object(s.a)(e,"imag","complex");o.e(n.shape,a.shape,"real and imag shapes, ".concat(n.shape," and ").concat(a.shape,", must match in call to tf.complex()."));const c={real:n,imag:a};return i.a.runKernelFunc((t=>t.complex(n,a)),c,null,r.y)}})},function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return h})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return p})),n.d(e,"j",(function(){return m})),n.d(e,"a",(function(){return v})),n.d(e,"h",(function(){return y})),n.d(e,"b",(function(){return w})),n.d(e,"g",(function(){return _})),n.d(e,"c",(function(){return T}));var i=n(2),r=n(43),s=n(30),o=n(74),a=n(15),c=n(12);const l=Object(a.b)(16e3);async function u(t){return Object(a.a)(t).then((t=>t.arrayBuffer())).then((t=>l.decodeAudioData(t)))}async function h(t){const e=new FileReader;return new Promise(((n,i)=>{e.onerror=()=>{e.abort(),i(new DOMException("Something went wrong reading that file."))},e.onload=()=>{n(e.result)},e.readAsArrayBuffer(t)})).then((t=>l.decodeAudioData(t)))}function d(t,e){e.power||(e.power=2);const n=function(t,e){const n=e.nFft||2048,i=e.winLength||n,r=e.hopLength||Math.floor(i/4);let s=w(i);s=y(s,n);const o=function(t,e,n){const i=Math.floor((t.length-e)/n)+1,r=Array.from({length:i},((t,n)=>new Float32Array(e)));for(let s=0;s<i;s++){const i=s*n,o=t.slice(i,i+e);r[s].set(o),o.length}return r}(t=function(t,e){const n=x(t,e);for(let i=0;i<e;i++)n[i]=n[2*e-i],n[n.length-i-1]=n[n.length-2*e+i-1];return n}(t,Math.floor(n/2)),n,r),a=[],c=o.length,l=n+2;for(let u=0;u<c;u++){const t=new Float32Array(l);a[u]=t}for(let u=0;u<c;u++){const t=b(v(o[u],s));a[u].set(t.slice(0,l))}return a}(t,e),[i,r]=function(t,e){const n=t.map((t=>function(t,e){return t.map((t=>Math.pow(t,e)))}(function(t){const e=new Float32Array(t.length/2);for(let n=0;n<t.length/2;n++)e[n]=Math.sqrt(t[2*n]*t[2*n]+t[2*n+1]*t[2*n+1]);return e}(t),e)));return[n,t[0].length-1]}(n,e.power);return e.nFft=r,function(t,e){const n=[];for(let i=0;i<t.length;i++)n[i]=g(t[i],e);return n}(i,function(t){const e=t.fMin||0,n=t.fMax||t.sampleRate/2,i=t.nMels||128,r=t.nFft||2048,s=function(t,e){return S(0,t/2,Math.floor(1+e/2))}(t.sampleRate,r),o=function(t,e,n){return S(E(e),E(n),t).map((t=>function(t){return 700*(Math.exp(t/1125)-1)}(t)))}(i+2,e,n),a=function(t){const e=new Float32Array(t.length-1);for(let n=0;n<t.length;n++)e[n]=t[n+1]-t[n];return e}(o),c=function(t,e){const n=[];for(let i=0;i<t.length;i++)n[i]=new Float32Array(e.length);for(let i=0;i<t.length;i++)for(let r=0;r<e.length;r++)n[i][r]=t[i]-e[r];return n}(o,s),l=c[0].length,u=[];for(let h=0;h<i;h++){u[h]=new Float32Array(l);for(let t=0;t<c[h].length;t++){const e=-c[h][t]/a[h],n=c[h+2][t]/a[h+1],i=Math.max(0,Math.min(e,n));u[h][t]=i}}for(let h=0;h<u.length;h++){const t=2/(o[2+h]-o[h]);u[h]=u[h].map((e=>e*t))}return u}(e))}function p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80;const i=t.length,r=t[0].length,s=[];for(let o=0;o<i;o++)s[o]=new Float32Array(r);for(let o=0;o<i;o++)for(let n=0;n<r;n++){const i=t[o][n];s[o][n]=10*Math.log10(Math.max(e,i))}if(n){if(n<0)throw new Error("topDb must be non-negative.");for(let t=0;t<i;t++){const e=s[t].reduce(((t,e)=>Math.max(t,e)));for(let i=0;i<r;i++)s[t][i]=Math.max(s[t][i],e-n)}}return s}function f(t){if(1===t.numberOfChannels)return t.getChannelData(0);if(2!==t.numberOfChannels)throw Error(t.numberOfChannels+" channel audio is not supported.");const e=t.getChannelData(0),n=t.getChannelData(1),i=new Float32Array(t.length);for(let r=0;r<t.length;++r)i[r]=(e[r]+n[r])/2;return i}async function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16e3;if(t.sampleRate===e)return f(t);const n=t.sampleRate,i=t.length*e/n;if(a.c){c.log("Safari does not support WebAudio resampling, so this may be slow.","O&F",5);const e=f(t),n=new Float32Array(i);return o(s(n,[i]),s(e,[e.length])),n}{const n=new OfflineAudioContext(t.numberOfChannels,t.duration*e,e),i=n.createBufferSource();return i.buffer=t,i.connect(n.destination),i.start(),n.startRendering().then((t=>t.getChannelData(0)))}}function g(t,e){if(t.length!==e[0].length)throw new Error("Each entry in filterbank should have dimensions matching FFT. |mags| = ".concat(t.length,", |filterbank[0]| = ").concat(e[0].length,"."));const n=new Float32Array(e.length);for(let i=0;i<e.length;i++){const r=v(t,e[i]);n[i]=r.reduce(((t,e)=>t+e))}return n}function v(t,e){if(t.length!==e.length)return console.error("Buffer length ".concat(t.length," != window length ").concat(e.length,".")),null;const n=new Float32Array(t.length);for(let i=0;i<t.length;i++)n[i]=e[i]*t[i];return n}function y(t,e){if(t.length>e)throw new Error("Data is longer than length.");const n=Math.floor((e-t.length)/2);return x(t,[n,e-t.length-n])}function x(t,e){let n,i;"object"==typeof e?[n,i]=e:n=i=e;const r=new Float32Array(t.length+n+i);return r.set(t,n),r}function b(t){const e=new r(t.length),n=e.createComplexArray(),i=e.toComplexArray(t);return e.transform(n,i),n}function w(t){const e=new Float32Array(t);for(let n=0;n<t;n++)e[n]=.5*(1-Math.cos(2*Math.PI*n/(t-1)));return e}function S(t,e,n){const i=(e-t)/(n-1),r=new Float32Array(n);for(let s=0;s<n;s++)r[s]=t+i*s;return r}function _(t){let e=i.sub(t,69);return e=i.div(e,12),e=i.pow(2,e),e=i.mul(440,e),e}async function T(t){let e=i.sub(i.div(i.log(t),i.log(2)),i.div(i.log(440),i.log(2)));return e=i.mul(12,e),e=i.add(e,69),await e.array()}function E(t){return 1125*Math.log(1+t/700)}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";n.r(e),n.d(e,"NO_EVENT",(function(){return o})),n.d(e,"NOTE_OFF",(function(){return a})),n.d(e,"Melody",(function(){return c})),n.d(e,"MelodyRhythm",(function(){return l})),n.d(e,"MelodyShape",(function(){return u})),n.d(e,"MelodyRegister",(function(){return h}));var i=n(2),r=n(10),s=n(13);const o=0,a=1;class c{constructor(t,e,n){this.events=t,this.minPitch=e,this.maxPitch=n}static fromNoteSequence(t,e,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4?arguments[4]:void 0;s.assertIsQuantizedSequence(t);const o=t.notes.sort(((t,e)=>t.quantizedStartStep===e.quantizedStartStep?e.pitch-t.pitch:t.quantizedStartStep-e.quantizedStartStep)),l=new Int32Array(r||t.totalQuantizedSteps);let u=-1;return o.forEach((t=>{if(t.quantizedStartStep===u){if(i)return;throw new Error("`NoteSequence` is not monophonic.")}if(t.pitch<e||t.pitch>n)throw Error("`NoteSequence` has a pitch outside of the valid range: "+t.pitch);l[t.quantizedStartStep]=t.pitch-e+2,l[t.quantizedEndStep]=a,u=t.quantizedStartStep})),new c(l,e,n)}toNoteSequence(t,e){const n=s.createQuantizedNoteSequence(t,e);let i=null;for(let s=0;s<this.events.length;++s){const t=this.events[s];switch(t){case o:break;case a:i&&(i.quantizedEndStep=s,n.notes.push(i),i=null);break;default:i&&(i.quantizedEndStep=s,n.notes.push(i)),i=r.a.Note.create({pitch:t-2+this.minPitch,quantizedStartStep:s})}}return i&&(i.quantizedEndStep=this.events.length,n.notes.push(i)),n.totalQuantizedSteps=this.events.length,n}}class l{constructor(){this.depth=1}extract(t){const e=t.events.length,n=i.buffer([e,1]);for(let i=0;i<e;++i)n.set(t.events[i]>=2?1:0,i,0);return n.toTensor().as2D(e,1)}}class u{constructor(){this.depth=3}extract(t){const e=t.events.length,n=i.buffer([e,3]);let r=null,s=null;for(let i=0;i<e;++i)if(t.events[i]>=2){if(null!==r){let e;0===n.get(r,0)&&0===n.get(r,1)&&0===n.get(r,2)&&(r=-1),e=t.events[i]<s?0:t.events[i]>s?2:1;for(let t=i;t>r;--t)n.set(1,t,e)}r=i,s=t.events[i]}if(r!==e-1)if(null===r||0===n.get(r,0)&&0===n.get(r,1)&&0===n.get(r,2))for(let i=0;i<e;++i)n.set(1,i,1);else for(let i=e-1;i>r;--i)for(let t=0;t<3;t++)n.set(n.get(r,t),i,t);return n.toTensor().as2D(e,3)}}class h{constructor(t){this.boundaryPitches=t,this.depth=t.length+1}meanMelodyPitch(t){let e=0,n=0,i=null;for(let r=0;r<t.events.length;++r)t.events[r]===a?i=null:t.events[r]>=2&&(i=t.minPitch+t.events[r]-2),null!==i&&(e+=i,n+=1);return n?e/n:null}extract(t){const e=t.events.length,n=this.meanMelodyPitch(t);if(null===n)return i.zeros([e,this.depth]);let r=0;for(;r<this.boundaryPitches.length&&n>=this.boundaryPitches[r];)r++;const s=i.buffer([e,this.depth]);for(let i=0;i<e;++i)s.set(1,i,r);return s.toTensor().as2D(e,this.depth)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(3),r=n(28);function s(t,e,n){const s=Object(i.c)(t,n);return Object(r.a)(t,e,s,n)}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return h})),n.d(e,"h",(function(){return d})),n.d(e,"g",(function(){return p}));var i=n(2),r=n(20),s=n(42);const o=16e3,a=250,c=25.58,l=63.07,u=.002,h=.7;async function d(t){let e;return e=await i.loadGraphModel(t,{fromTFHub:!0}),e}async function p(t,e,n){if("webgl"!==i.getBackend())throw new Error("Device does not support webgl.");const c=await Object(r.j)(t,o),l=c.length,u=await async function(t){const e=Math.floor(o/a),n=i.tensor1d(t,"float32"),r=t.length;if(null===n)return[];const s=n.mul(n).reshape([r,1]),c=i.conv1d(s,i.ones([1024,1,1]).div(1024),e,"same").sqrt().squeeze(),l=i.mul(i.log(i.maximum(1e-20,c)).div(i.log(10)),20),u=l.sub(20.7),h=i.maximum(u,-120),d=await h.array();return n.dispose(),s.dispose(),c.dispose(),l.dispose(),u.dispose(),h.dispose(),d}(c),{pitches:h,confidences:d}=await Object(s.a)(e,c,n);return{f0_hz:h,loudness_db:u,confidences:d,originalRecordedBufferLength:l}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return h}));var i=n(11),r=n(40);const s=Object(r.a)("kernelRegistry",(()=>new Map)),o=Object(r.a)("gradRegistry",(()=>new Map));function a(t,e){const n=d(t,e);return s.get(n)}function c(t){return o.get(t)}function l(t){const e=s.entries(),n=[];for(;;){const{done:i,value:r}=e.next();if(i)break;const[s,o]=r,[a]=s.split("_");a===t&&n.push(o)}return n}function u(t){const{kernelName:e,backendName:n}=t,i=d(e,n);s.has(i)&&console.warn("The kernel '".concat(e,"' for backend '").concat(n,"' is already registered")),s.set(i,t)}function h(t){const{kernelName:e}=t;o.has(e)&&Object(i.b)().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(e,"'")),o.set(e,t)}function d(t,e){return"".concat(e,"_").concat(t)}},function(t,e,n){"use strict";var i,r,s,o,a;n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return u})),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(s||(s={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(a||(a={}));const c={float32:o,int32:r,bool:s,complex64:a};function l(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return c[t][e]}function u(t){return l(t,"int32")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(6),r=n(16),s=n(7);function o(t,e,n,o){if(null==o&&(o=Object(r.r)(t)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(r.A)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(r.c)(e);const t=Object(r.N)(e),i=Object(r.N)(n);Object(r.b)(t===i,(()=>"Based on the provided shape, [".concat(e,"], the tensor should have ").concat(t," values but has ").concat(i)));for(let s=0;s<n.length;++s){const t=n[s],i=s!==n.length-1||t!==Object(r.N)(e.slice(s));Object(r.b)(n[s]===e[s]||!i,(()=>"Error creating a new Tensor. Inferred shape (".concat(n,") does not match the provided shape (").concat(e,"). ")))}}return Object(r.A)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==o?Object(s.toTypedArray)(t,o):Object(r.m)(t,[],!0),i.a.makeTensor(t,e,o)}},function(t,e,n){"use strict";n.r(e),n.d(e,"Performance",(function(){return a}));var i=n(10),r=n(8),s=n(13),o=n(12);class a{constructor(t,e,n,i,r){this.events=t,this.maxShiftSteps=e,this.numVelocityBins=n,this.program=i,this.isDrum=r}static fromNoteSequence(t,e,n,i){s.assertIsQuantizedSequence(t);const o=t.notes.filter(((t,e)=>void 0===i||t.instrument===i)),c=o.sort(((t,e)=>t.startTime===e.startTime?t.pitch-e.pitch:t.startTime-e.startTime)),l=c.map(((t,e)=>({step:t.quantizedStartStep,index:e,isOffset:0}))),u=c.map(((t,e)=>({step:t.quantizedEndStep,index:e,isOffset:1}))),h=l.concat(u).sort(((t,e)=>t.step===e.step?t.index===e.index?t.isOffset-e.isOffset:t.index-e.index:t.step-e.step)),d=n?Math.ceil((r.MIDI_VELOCITIES-1)/n):void 0,p=[];let f=0,m=n;for(const s of h){if(s.step>f){for(;s.step>f+e;)p.push({type:"time-shift",steps:e}),f+=e;p.push({type:"time-shift",steps:s.step-f}),f=s.step}if(s.isOffset)p.push({type:"note-off",pitch:c[s.index].pitch});else{if(d){const t=Math.floor((c[s.index].velocity-r.MIN_MIDI_VELOCITY-1)/d)+1;t!==m&&(p.push({type:"velocity-change",velocityBin:t}),m=t)}p.push({type:"note-on",pitch:c[s.index].pitch})}}const g=!!o.some((t=>t.isDrum))&&(!o.some((t=>!t.isDrum))||void 0),v=Array.from(new Set(o.map((t=>t.program)))),y=g||1!==v.length?void 0:v[0],x=new a(p,e,n,y,g);return x.setNumSteps(t.totalQuantizedSteps),x}getNumSteps(){return this.events.filter((t=>"time-shift"===t.type)).map((t=>t.steps)).reduce(((t,e)=>t+e),0)}setNumSteps(t){let e=this.getNumSteps();if(e<t){if(this.events.length){const n=this.events[this.events.length-1];if("time-shift"===n.type){const i=Math.min(t-e,this.maxShiftSteps-n.steps);n.steps+=i,e+=i}}for(;e<t;)e+this.maxShiftSteps>t?(this.events.push({type:"time-shift",steps:t-e}),e=t):(this.events.push({type:"time-shift",steps:this.maxShiftSteps}),e+=this.maxShiftSteps)}else if(e>t)for(;this.events.length&&e>t;){const n=this.events[this.events.length-1];"time-shift"===n.type?e-n.steps<t?(n.steps-=e-t,e=t):(this.events.pop(),e-=n.steps):this.events.pop()}}toNoteSequence(t){const e=this.numVelocityBins?Math.ceil((r.MIDI_VELOCITIES-1)/this.numVelocityBins):void 0,n=i.a.create();let s,a=0;const c=new Map;for(let i=r.MIN_MIDI_PITCH;i<=r.MAX_MIDI_PITCH;++i)c.set(i,[]);for(const l of this.events)switch(l.type){case"note-on":c.get(l.pitch).push([a,s]);break;case"note-off":const u=c.get(l.pitch);if(u.length){const[e,r]=u.shift();a>e?n.notes.push(i.a.Note.create({pitch:l.pitch,velocity:r,instrument:t,quantizedStartStep:e,quantizedEndStep:a,program:this.program,isDrum:this.isDrum})):o.log("Ignoring zero-length note: (pitch = ".concat(l.pitch,", step = ").concat(a,")"),"Performance")}else o.log("Ignoring note-off with no previous note-on:(pitch = ".concat(l.pitch,", step = ").concat(a,")"),"Performance");break;case"time-shift":a+=l.steps;break;case"velocity-change":if(!e)throw new Error("Unexpected velocity change event: "+l);s=r.MIN_MIDI_VELOCITY+(l.velocityBin-1)*e+1;break;default:throw new Error("Unrecognized performance event: "+l)}return c.forEach(((e,r)=>{for(const[s,c]of e)a>s?n.notes.push(i.a.Note.create({pitch:r,velocity:c,instrument:t,quantizedStartStep:s,quantizedEndStep:a,program:this.program,isDrum:this.isDrum})):o.log("Ignoring zero-length note: (pitch = ".concat(r,", step = ").concat(a,")"),"Performance")})),n.totalQuantizedSteps=a,n}}},function(t,e,n){var i=n(84),r=n(85),s="undefined"!=typeof Float64Array;function o(t,e){return t[0]-e[0]}function a(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(o);var i=new Array(n.length);for(t=0;t<i.length;++t)i[t]=n[t][1];return i}function c(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var r="generic"===t;if(-1===e){var s="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(s)()}if(0===e)return s="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",new Function("TrivialArray",s)(l[t][0]);s=["'use strict'"];var o=i(e),c=o.map((function(t){return"i"+t})),u="this.offset+"+o.map((function(t){return"this.stride["+t+"]*i"+t})).join("+"),h=o.map((function(t){return"b"+t})).join(","),d=o.map((function(t){return"c"+t})).join(",");s.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),s.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+o.map((function(t){return"this.shape["+t+"]"})).join("*"),"}})"),1===e?s.push("proto.order=[0]"):(s.push("Object.defineProperty(proto,'order',{get:"),e<4?(s.push("function "+n+"_order(){"),2===e?s.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&s.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):s.push("ORDER})")),s.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),r?s.push("return this.data.set("+u+",v)}"):s.push("return this.data["+u+"]=v}"),s.push("proto.get=function "+n+"_get("+c.join(",")+"){"),r?s.push("return this.data.get("+u+")}"):s.push("return this.data["+u+"]}"),s.push("proto.index=function "+n+"_index(",c.join(),"){return "+u+"}"),s.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+o.map((function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")})).join(",")+","+o.map((function(t){return"this.stride["+t+"]"})).join(",")+",this.offset)}");var p=o.map((function(t){return"a"+t+"=this.shape["+t+"]"})),f=o.map((function(t){return"c"+t+"=this.stride["+t+"]"}));s.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+f.join(","));for(var m=0;m<e;++m)s.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");for(s.push("return new "+n+"(this.data,"+o.map((function(t){return"a"+t})).join(",")+","+o.map((function(t){return"c"+t})).join(",")+",b)}"),s.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+o.map((function(t){return"a"+t+"=this.shape["+t+"]"})).join(",")+","+o.map((function(t){return"b"+t+"=this.stride["+t+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),m=0;m<e;++m)s.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");s.push("return new "+n+"(this.data,"+o.map((function(t){return"a"+t})).join(",")+","+o.map((function(t){return"b"+t})).join(",")+",c)}");var g=new Array(e),v=new Array(e);for(m=0;m<e;++m)g[m]="a[i"+m+"]",v[m]="b[i"+m+"]";for(s.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map((function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+v.join(",")+",this.offset)}"),s.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset"),m=0;m<e;++m)s.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return s.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),s.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+o.map((function(t){return"shape["+t+"]"})).join(",")+","+o.map((function(t){return"stride["+t+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",s.join("\n"))(l[t],a)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};t.exports=function(t,e,n,i){if(void 0===t)return(0,l.array[0])([]);"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var o=e.length;if(void 0===n){n=new Array(o);for(var a=o-1,u=1;a>=0;--a)n[a]=u,u*=e[a]}if(void 0===i)for(i=0,a=0;a<o;++a)n[a]<0&&(i-=(e[a]-1)*n[a]);for(var h=function(t){if(r(t))return"buffer";if(s)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(t)?"array":"generic"}(t),d=l[h];d.length<=o+1;)d.push(c(h,d.length-1));return(0,d[o+1])(t,e,n,i)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";t.exports=h;var i,r=n(18),s=r.LongBits,o=r.base64,a=r.utf8;function c(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function l(){}function u(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return r.Buffer?function(){return(h.create=function(){return new i})()}:function(){return new h}};function p(t,e,n){e[n]=255&t}function f(t,e){this.len=t,this.next=void 0,this.val=e}function m(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function g(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}h.create=d(),h.alloc=function(t){return new r.Array(t)},r.Array!==Array&&(h.alloc=r.pool(h.alloc,r.Array.prototype.subarray)),h.prototype._push=function(t,e,n){return this.tail=this.tail.next=new c(t,e,n),this.len+=e,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(t,e,n){for(;t>127;)e[n++]=127&t|128,t>>>=7;e[n]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new f((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(m,10,s.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.uint64=function(t){var e=s.from(t);return this._push(m,e.length(),e)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(t){var e=s.from(t).zzEncode();return this._push(m,e.length(),e)},h.prototype.bool=function(t){return this._push(p,1,t?1:0)},h.prototype.fixed32=function(t){return this._push(g,4,t>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(t){var e=s.from(t);return this._push(g,4,e.lo)._push(g,4,e.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(t){return this._push(r.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(r.float.writeDoubleLE,8,t)};var v=r.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};h.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(p,1,0);if(r.isString(t)){var n=h.alloc(e=o.length(t));o.decode(t,n,0),t=n}return this.uint32(e)._push(v,e,t)},h.prototype.string=function(t){var e=a.length(t);return e?this.uint32(e)._push(a.write,e,t):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},h._configure=function(t){i=t,h.create=d(),i._configure()}},function(t,e,n){"use strict";t.exports=c;var i,r=n(18),s=r.LongBits,o=r.utf8;function a(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function c(t){this.buf=t,this.pos=0,this.len=t.length}var l,u="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new c(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new c(t);throw Error("illegal buffer")},h=function(){return r.Buffer?function(t){return(c.create=function(t){return r.Buffer.isBuffer(t)?new i(t):u(t)})(t)}:u};function d(){var t=new s(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw a(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw a(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function p(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new s(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=h(),c.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var t=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var t=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},c.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw a(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)},c.prototype.string=function(){var t=this.bytes();return o.read(t,0,t.length)},c.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw a(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},c._configure=function(t){i=t,c.create=h(),i._configure();var e=r.Long?"toLong":"toNumber";r.merge(c.prototype,{int64:function(){return d.call(this)[e](!1)},uint64:function(){return d.call(this)[e](!0)},sint64:function(){return d.call(this).zzDecode()[e](!1)},fixed64:function(){return f.call(this)[e](!0)},sfixed64:function(){return f.call(this)[e](!1)}})}},function(t,e,n){"use strict";var i,r,s=n(49),o=s.Reader,a=s.Writer,c=s.util,l=s.roots.default||(s.roots.default={});l.tensorflow=((r={}).magenta=((i={}).NoteSequence=function(){function t(t){if(this.timeSignatures=[],this.keySignatures=[],this.tempos=[],this.notes=[],this.pitchBends=[],this.controlChanges=[],this.partInfos=[],this.textAnnotations=[],this.sectionAnnotations=[],this.sectionGroups=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e,n;return t.prototype.id="",t.prototype.filename="",t.prototype.referenceNumber=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.collectionName="",t.prototype.ticksPerQuarter=0,t.prototype.timeSignatures=c.emptyArray,t.prototype.keySignatures=c.emptyArray,t.prototype.tempos=c.emptyArray,t.prototype.notes=c.emptyArray,t.prototype.totalTime=0,t.prototype.totalQuantizedSteps=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.pitchBends=c.emptyArray,t.prototype.controlChanges=c.emptyArray,t.prototype.partInfos=c.emptyArray,t.prototype.sourceInfo=null,t.prototype.textAnnotations=c.emptyArray,t.prototype.sectionAnnotations=c.emptyArray,t.prototype.sectionGroups=c.emptyArray,t.prototype.quantizationInfo=null,t.prototype.subsequenceInfo=null,t.prototype.sequenceMetadata=null,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.id&&t.hasOwnProperty("id")&&e.uint32(10).string(t.id),null!=t.filename&&t.hasOwnProperty("filename")&&e.uint32(18).string(t.filename),null!=t.collectionName&&t.hasOwnProperty("collectionName")&&e.uint32(26).string(t.collectionName),null!=t.ticksPerQuarter&&t.hasOwnProperty("ticksPerQuarter")&&e.uint32(32).int32(t.ticksPerQuarter),null!=t.timeSignatures&&t.timeSignatures.length)for(var n=0;n<t.timeSignatures.length;++n)l.tensorflow.magenta.NoteSequence.TimeSignature.encode(t.timeSignatures[n],e.uint32(42).fork()).ldelim();if(null!=t.keySignatures&&t.keySignatures.length)for(n=0;n<t.keySignatures.length;++n)l.tensorflow.magenta.NoteSequence.KeySignature.encode(t.keySignatures[n],e.uint32(50).fork()).ldelim();if(null!=t.tempos&&t.tempos.length)for(n=0;n<t.tempos.length;++n)l.tensorflow.magenta.NoteSequence.Tempo.encode(t.tempos[n],e.uint32(58).fork()).ldelim();if(null!=t.notes&&t.notes.length)for(n=0;n<t.notes.length;++n)l.tensorflow.magenta.NoteSequence.Note.encode(t.notes[n],e.uint32(66).fork()).ldelim();if(null!=t.totalTime&&t.hasOwnProperty("totalTime")&&e.uint32(73).double(t.totalTime),null!=t.pitchBends&&t.pitchBends.length)for(n=0;n<t.pitchBends.length;++n)l.tensorflow.magenta.NoteSequence.PitchBend.encode(t.pitchBends[n],e.uint32(82).fork()).ldelim();if(null!=t.controlChanges&&t.controlChanges.length)for(n=0;n<t.controlChanges.length;++n)l.tensorflow.magenta.NoteSequence.ControlChange.encode(t.controlChanges[n],e.uint32(90).fork()).ldelim();if(null!=t.partInfos&&t.partInfos.length)for(n=0;n<t.partInfos.length;++n)l.tensorflow.magenta.NoteSequence.PartInfo.encode(t.partInfos[n],e.uint32(98).fork()).ldelim();if(null!=t.sourceInfo&&t.hasOwnProperty("sourceInfo")&&l.tensorflow.magenta.NoteSequence.SourceInfo.encode(t.sourceInfo,e.uint32(106).fork()).ldelim(),null!=t.textAnnotations&&t.textAnnotations.length)for(n=0;n<t.textAnnotations.length;++n)l.tensorflow.magenta.NoteSequence.TextAnnotation.encode(t.textAnnotations[n],e.uint32(114).fork()).ldelim();if(null!=t.quantizationInfo&&t.hasOwnProperty("quantizationInfo")&&l.tensorflow.magenta.NoteSequence.QuantizationInfo.encode(t.quantizationInfo,e.uint32(122).fork()).ldelim(),null!=t.totalQuantizedSteps&&t.hasOwnProperty("totalQuantizedSteps")&&e.uint32(128).int64(t.totalQuantizedSteps),null!=t.subsequenceInfo&&t.hasOwnProperty("subsequenceInfo")&&l.tensorflow.magenta.NoteSequence.SubsequenceInfo.encode(t.subsequenceInfo,e.uint32(138).fork()).ldelim(),null!=t.referenceNumber&&t.hasOwnProperty("referenceNumber")&&e.uint32(144).int64(t.referenceNumber),null!=t.sequenceMetadata&&t.hasOwnProperty("sequenceMetadata")&&l.tensorflow.magenta.SequenceMetadata.encode(t.sequenceMetadata,e.uint32(154).fork()).ldelim(),null!=t.sectionAnnotations&&t.sectionAnnotations.length)for(n=0;n<t.sectionAnnotations.length;++n)l.tensorflow.magenta.NoteSequence.SectionAnnotation.encode(t.sectionAnnotations[n],e.uint32(162).fork()).ldelim();if(null!=t.sectionGroups&&t.sectionGroups.length)for(n=0;n<t.sectionGroups.length;++n)l.tensorflow.magenta.NoteSequence.SectionGroup.encode(t.sectionGroups[n],e.uint32(170).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.id=t.string();break;case 2:i.filename=t.string();break;case 18:i.referenceNumber=c.Long?t.int64().toNumber():t.int64();break;case 3:i.collectionName=t.string();break;case 4:i.ticksPerQuarter=t.int32();break;case 5:i.timeSignatures&&i.timeSignatures.length||(i.timeSignatures=[]),i.timeSignatures.push(l.tensorflow.magenta.NoteSequence.TimeSignature.decode(t,t.uint32()));break;case 6:i.keySignatures&&i.keySignatures.length||(i.keySignatures=[]),i.keySignatures.push(l.tensorflow.magenta.NoteSequence.KeySignature.decode(t,t.uint32()));break;case 7:i.tempos&&i.tempos.length||(i.tempos=[]),i.tempos.push(l.tensorflow.magenta.NoteSequence.Tempo.decode(t,t.uint32()));break;case 8:i.notes&&i.notes.length||(i.notes=[]),i.notes.push(l.tensorflow.magenta.NoteSequence.Note.decode(t,t.uint32()));break;case 9:i.totalTime=t.double();break;case 16:i.totalQuantizedSteps=c.Long?t.int64().toNumber():t.int64();break;case 10:i.pitchBends&&i.pitchBends.length||(i.pitchBends=[]),i.pitchBends.push(l.tensorflow.magenta.NoteSequence.PitchBend.decode(t,t.uint32()));break;case 11:i.controlChanges&&i.controlChanges.length||(i.controlChanges=[]),i.controlChanges.push(l.tensorflow.magenta.NoteSequence.ControlChange.decode(t,t.uint32()));break;case 12:i.partInfos&&i.partInfos.length||(i.partInfos=[]),i.partInfos.push(l.tensorflow.magenta.NoteSequence.PartInfo.decode(t,t.uint32()));break;case 13:i.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.decode(t,t.uint32());break;case 14:i.textAnnotations&&i.textAnnotations.length||(i.textAnnotations=[]),i.textAnnotations.push(l.tensorflow.magenta.NoteSequence.TextAnnotation.decode(t,t.uint32()));break;case 20:i.sectionAnnotations&&i.sectionAnnotations.length||(i.sectionAnnotations=[]),i.sectionAnnotations.push(l.tensorflow.magenta.NoteSequence.SectionAnnotation.decode(t,t.uint32()));break;case 21:i.sectionGroups&&i.sectionGroups.length||(i.sectionGroups=[]),i.sectionGroups.push(l.tensorflow.magenta.NoteSequence.SectionGroup.decode(t,t.uint32()));break;case 15:i.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.decode(t,t.uint32());break;case 17:i.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.decode(t,t.uint32());break;case 19:i.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.decode(t,t.uint32());break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.id&&t.hasOwnProperty("id")&&!c.isString(t.id))return"id: string expected";if(null!=t.filename&&t.hasOwnProperty("filename")&&!c.isString(t.filename))return"filename: string expected";if(null!=t.referenceNumber&&t.hasOwnProperty("referenceNumber")&&!(c.isInteger(t.referenceNumber)||t.referenceNumber&&c.isInteger(t.referenceNumber.low)&&c.isInteger(t.referenceNumber.high)))return"referenceNumber: integer|Long expected";if(null!=t.collectionName&&t.hasOwnProperty("collectionName")&&!c.isString(t.collectionName))return"collectionName: string expected";if(null!=t.ticksPerQuarter&&t.hasOwnProperty("ticksPerQuarter")&&!c.isInteger(t.ticksPerQuarter))return"ticksPerQuarter: integer expected";if(null!=t.timeSignatures&&t.hasOwnProperty("timeSignatures")){if(!Array.isArray(t.timeSignatures))return"timeSignatures: array expected";for(var e=0;e<t.timeSignatures.length;++e)if(n=l.tensorflow.magenta.NoteSequence.TimeSignature.verify(t.timeSignatures[e]))return"timeSignatures."+n}if(null!=t.keySignatures&&t.hasOwnProperty("keySignatures")){if(!Array.isArray(t.keySignatures))return"keySignatures: array expected";for(e=0;e<t.keySignatures.length;++e)if(n=l.tensorflow.magenta.NoteSequence.KeySignature.verify(t.keySignatures[e]))return"keySignatures."+n}if(null!=t.tempos&&t.hasOwnProperty("tempos")){if(!Array.isArray(t.tempos))return"tempos: array expected";for(e=0;e<t.tempos.length;++e)if(n=l.tensorflow.magenta.NoteSequence.Tempo.verify(t.tempos[e]))return"tempos."+n}if(null!=t.notes&&t.hasOwnProperty("notes")){if(!Array.isArray(t.notes))return"notes: array expected";for(e=0;e<t.notes.length;++e)if(n=l.tensorflow.magenta.NoteSequence.Note.verify(t.notes[e]))return"notes."+n}if(null!=t.totalTime&&t.hasOwnProperty("totalTime")&&"number"!=typeof t.totalTime)return"totalTime: number expected";if(null!=t.totalQuantizedSteps&&t.hasOwnProperty("totalQuantizedSteps")&&!(c.isInteger(t.totalQuantizedSteps)||t.totalQuantizedSteps&&c.isInteger(t.totalQuantizedSteps.low)&&c.isInteger(t.totalQuantizedSteps.high)))return"totalQuantizedSteps: integer|Long expected";if(null!=t.pitchBends&&t.hasOwnProperty("pitchBends")){if(!Array.isArray(t.pitchBends))return"pitchBends: array expected";for(e=0;e<t.pitchBends.length;++e)if(n=l.tensorflow.magenta.NoteSequence.PitchBend.verify(t.pitchBends[e]))return"pitchBends."+n}if(null!=t.controlChanges&&t.hasOwnProperty("controlChanges")){if(!Array.isArray(t.controlChanges))return"controlChanges: array expected";for(e=0;e<t.controlChanges.length;++e)if(n=l.tensorflow.magenta.NoteSequence.ControlChange.verify(t.controlChanges[e]))return"controlChanges."+n}if(null!=t.partInfos&&t.hasOwnProperty("partInfos")){if(!Array.isArray(t.partInfos))return"partInfos: array expected";for(e=0;e<t.partInfos.length;++e)if(n=l.tensorflow.magenta.NoteSequence.PartInfo.verify(t.partInfos[e]))return"partInfos."+n}if(null!=t.sourceInfo&&t.hasOwnProperty("sourceInfo")&&(n=l.tensorflow.magenta.NoteSequence.SourceInfo.verify(t.sourceInfo)))return"sourceInfo."+n;if(null!=t.textAnnotations&&t.hasOwnProperty("textAnnotations")){if(!Array.isArray(t.textAnnotations))return"textAnnotations: array expected";for(e=0;e<t.textAnnotations.length;++e)if(n=l.tensorflow.magenta.NoteSequence.TextAnnotation.verify(t.textAnnotations[e]))return"textAnnotations."+n}if(null!=t.sectionAnnotations&&t.hasOwnProperty("sectionAnnotations")){if(!Array.isArray(t.sectionAnnotations))return"sectionAnnotations: array expected";for(e=0;e<t.sectionAnnotations.length;++e)if(n=l.tensorflow.magenta.NoteSequence.SectionAnnotation.verify(t.sectionAnnotations[e]))return"sectionAnnotations."+n}if(null!=t.sectionGroups&&t.hasOwnProperty("sectionGroups")){if(!Array.isArray(t.sectionGroups))return"sectionGroups: array expected";for(e=0;e<t.sectionGroups.length;++e){var n;if(n=l.tensorflow.magenta.NoteSequence.SectionGroup.verify(t.sectionGroups[e]))return"sectionGroups."+n}}return null!=t.quantizationInfo&&t.hasOwnProperty("quantizationInfo")&&(n=l.tensorflow.magenta.NoteSequence.QuantizationInfo.verify(t.quantizationInfo))?"quantizationInfo."+n:null!=t.subsequenceInfo&&t.hasOwnProperty("subsequenceInfo")&&(n=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.verify(t.subsequenceInfo))?"subsequenceInfo."+n:null!=t.sequenceMetadata&&t.hasOwnProperty("sequenceMetadata")&&(n=l.tensorflow.magenta.SequenceMetadata.verify(t.sequenceMetadata))?"sequenceMetadata."+n:null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence)return t;var e=new l.tensorflow.magenta.NoteSequence;if(null!=t.id&&(e.id=String(t.id)),null!=t.filename&&(e.filename=String(t.filename)),null!=t.referenceNumber&&(c.Long?(e.referenceNumber=c.Long.fromValue(t.referenceNumber)).unsigned=!1:"string"==typeof t.referenceNumber?e.referenceNumber=parseInt(t.referenceNumber,10):"number"==typeof t.referenceNumber?e.referenceNumber=t.referenceNumber:"object"==typeof t.referenceNumber&&(e.referenceNumber=new c.LongBits(t.referenceNumber.low>>>0,t.referenceNumber.high>>>0).toNumber())),null!=t.collectionName&&(e.collectionName=String(t.collectionName)),null!=t.ticksPerQuarter&&(e.ticksPerQuarter=0|t.ticksPerQuarter),t.timeSignatures){if(!Array.isArray(t.timeSignatures))throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: array expected");e.timeSignatures=[];for(var n=0;n<t.timeSignatures.length;++n){if("object"!=typeof t.timeSignatures[n])throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: object expected");e.timeSignatures[n]=l.tensorflow.magenta.NoteSequence.TimeSignature.fromObject(t.timeSignatures[n])}}if(t.keySignatures){if(!Array.isArray(t.keySignatures))throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: array expected");for(e.keySignatures=[],n=0;n<t.keySignatures.length;++n){if("object"!=typeof t.keySignatures[n])throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: object expected");e.keySignatures[n]=l.tensorflow.magenta.NoteSequence.KeySignature.fromObject(t.keySignatures[n])}}if(t.tempos){if(!Array.isArray(t.tempos))throw TypeError(".tensorflow.magenta.NoteSequence.tempos: array expected");for(e.tempos=[],n=0;n<t.tempos.length;++n){if("object"!=typeof t.tempos[n])throw TypeError(".tensorflow.magenta.NoteSequence.tempos: object expected");e.tempos[n]=l.tensorflow.magenta.NoteSequence.Tempo.fromObject(t.tempos[n])}}if(t.notes){if(!Array.isArray(t.notes))throw TypeError(".tensorflow.magenta.NoteSequence.notes: array expected");for(e.notes=[],n=0;n<t.notes.length;++n){if("object"!=typeof t.notes[n])throw TypeError(".tensorflow.magenta.NoteSequence.notes: object expected");e.notes[n]=l.tensorflow.magenta.NoteSequence.Note.fromObject(t.notes[n])}}if(null!=t.totalTime&&(e.totalTime=Number(t.totalTime)),null!=t.totalQuantizedSteps&&(c.Long?(e.totalQuantizedSteps=c.Long.fromValue(t.totalQuantizedSteps)).unsigned=!1:"string"==typeof t.totalQuantizedSteps?e.totalQuantizedSteps=parseInt(t.totalQuantizedSteps,10):"number"==typeof t.totalQuantizedSteps?e.totalQuantizedSteps=t.totalQuantizedSteps:"object"==typeof t.totalQuantizedSteps&&(e.totalQuantizedSteps=new c.LongBits(t.totalQuantizedSteps.low>>>0,t.totalQuantizedSteps.high>>>0).toNumber())),t.pitchBends){if(!Array.isArray(t.pitchBends))throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: array expected");for(e.pitchBends=[],n=0;n<t.pitchBends.length;++n){if("object"!=typeof t.pitchBends[n])throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: object expected");e.pitchBends[n]=l.tensorflow.magenta.NoteSequence.PitchBend.fromObject(t.pitchBends[n])}}if(t.controlChanges){if(!Array.isArray(t.controlChanges))throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: array expected");for(e.controlChanges=[],n=0;n<t.controlChanges.length;++n){if("object"!=typeof t.controlChanges[n])throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: object expected");e.controlChanges[n]=l.tensorflow.magenta.NoteSequence.ControlChange.fromObject(t.controlChanges[n])}}if(t.partInfos){if(!Array.isArray(t.partInfos))throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: array expected");for(e.partInfos=[],n=0;n<t.partInfos.length;++n){if("object"!=typeof t.partInfos[n])throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: object expected");e.partInfos[n]=l.tensorflow.magenta.NoteSequence.PartInfo.fromObject(t.partInfos[n])}}if(null!=t.sourceInfo){if("object"!=typeof t.sourceInfo)throw TypeError(".tensorflow.magenta.NoteSequence.sourceInfo: object expected");e.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.fromObject(t.sourceInfo)}if(t.textAnnotations){if(!Array.isArray(t.textAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: array expected");for(e.textAnnotations=[],n=0;n<t.textAnnotations.length;++n){if("object"!=typeof t.textAnnotations[n])throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: object expected");e.textAnnotations[n]=l.tensorflow.magenta.NoteSequence.TextAnnotation.fromObject(t.textAnnotations[n])}}if(t.sectionAnnotations){if(!Array.isArray(t.sectionAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: array expected");for(e.sectionAnnotations=[],n=0;n<t.sectionAnnotations.length;++n){if("object"!=typeof t.sectionAnnotations[n])throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: object expected");e.sectionAnnotations[n]=l.tensorflow.magenta.NoteSequence.SectionAnnotation.fromObject(t.sectionAnnotations[n])}}if(t.sectionGroups){if(!Array.isArray(t.sectionGroups))throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: array expected");for(e.sectionGroups=[],n=0;n<t.sectionGroups.length;++n){if("object"!=typeof t.sectionGroups[n])throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: object expected");e.sectionGroups[n]=l.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(t.sectionGroups[n])}}if(null!=t.quantizationInfo){if("object"!=typeof t.quantizationInfo)throw TypeError(".tensorflow.magenta.NoteSequence.quantizationInfo: object expected");e.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.fromObject(t.quantizationInfo)}if(null!=t.subsequenceInfo){if("object"!=typeof t.subsequenceInfo)throw TypeError(".tensorflow.magenta.NoteSequence.subsequenceInfo: object expected");e.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.fromObject(t.subsequenceInfo)}if(null!=t.sequenceMetadata){if("object"!=typeof t.sequenceMetadata)throw TypeError(".tensorflow.magenta.NoteSequence.sequenceMetadata: object expected");e.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.fromObject(t.sequenceMetadata)}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.timeSignatures=[],n.keySignatures=[],n.tempos=[],n.notes=[],n.pitchBends=[],n.controlChanges=[],n.partInfos=[],n.textAnnotations=[],n.sectionAnnotations=[],n.sectionGroups=[]),e.defaults){if(n.id="",n.filename="",n.collectionName="",n.ticksPerQuarter=0,n.totalTime=0,n.sourceInfo=null,n.quantizationInfo=null,c.Long){var i=new c.Long(0,0,!1);n.totalQuantizedSteps=e.longs===String?i.toString():e.longs===Number?i.toNumber():i}else n.totalQuantizedSteps=e.longs===String?"0":0;n.subsequenceInfo=null,c.Long?(i=new c.Long(0,0,!1),n.referenceNumber=e.longs===String?i.toString():e.longs===Number?i.toNumber():i):n.referenceNumber=e.longs===String?"0":0,n.sequenceMetadata=null}if(null!=t.id&&t.hasOwnProperty("id")&&(n.id=t.id),null!=t.filename&&t.hasOwnProperty("filename")&&(n.filename=t.filename),null!=t.collectionName&&t.hasOwnProperty("collectionName")&&(n.collectionName=t.collectionName),null!=t.ticksPerQuarter&&t.hasOwnProperty("ticksPerQuarter")&&(n.ticksPerQuarter=t.ticksPerQuarter),t.timeSignatures&&t.timeSignatures.length){n.timeSignatures=[];for(var r=0;r<t.timeSignatures.length;++r)n.timeSignatures[r]=l.tensorflow.magenta.NoteSequence.TimeSignature.toObject(t.timeSignatures[r],e)}if(t.keySignatures&&t.keySignatures.length)for(n.keySignatures=[],r=0;r<t.keySignatures.length;++r)n.keySignatures[r]=l.tensorflow.magenta.NoteSequence.KeySignature.toObject(t.keySignatures[r],e);if(t.tempos&&t.tempos.length)for(n.tempos=[],r=0;r<t.tempos.length;++r)n.tempos[r]=l.tensorflow.magenta.NoteSequence.Tempo.toObject(t.tempos[r],e);if(t.notes&&t.notes.length)for(n.notes=[],r=0;r<t.notes.length;++r)n.notes[r]=l.tensorflow.magenta.NoteSequence.Note.toObject(t.notes[r],e);if(null!=t.totalTime&&t.hasOwnProperty("totalTime")&&(n.totalTime=e.json&&!isFinite(t.totalTime)?String(t.totalTime):t.totalTime),t.pitchBends&&t.pitchBends.length)for(n.pitchBends=[],r=0;r<t.pitchBends.length;++r)n.pitchBends[r]=l.tensorflow.magenta.NoteSequence.PitchBend.toObject(t.pitchBends[r],e);if(t.controlChanges&&t.controlChanges.length)for(n.controlChanges=[],r=0;r<t.controlChanges.length;++r)n.controlChanges[r]=l.tensorflow.magenta.NoteSequence.ControlChange.toObject(t.controlChanges[r],e);if(t.partInfos&&t.partInfos.length)for(n.partInfos=[],r=0;r<t.partInfos.length;++r)n.partInfos[r]=l.tensorflow.magenta.NoteSequence.PartInfo.toObject(t.partInfos[r],e);if(null!=t.sourceInfo&&t.hasOwnProperty("sourceInfo")&&(n.sourceInfo=l.tensorflow.magenta.NoteSequence.SourceInfo.toObject(t.sourceInfo,e)),t.textAnnotations&&t.textAnnotations.length)for(n.textAnnotations=[],r=0;r<t.textAnnotations.length;++r)n.textAnnotations[r]=l.tensorflow.magenta.NoteSequence.TextAnnotation.toObject(t.textAnnotations[r],e);if(null!=t.quantizationInfo&&t.hasOwnProperty("quantizationInfo")&&(n.quantizationInfo=l.tensorflow.magenta.NoteSequence.QuantizationInfo.toObject(t.quantizationInfo,e)),null!=t.totalQuantizedSteps&&t.hasOwnProperty("totalQuantizedSteps")&&("number"==typeof t.totalQuantizedSteps?n.totalQuantizedSteps=e.longs===String?String(t.totalQuantizedSteps):t.totalQuantizedSteps:n.totalQuantizedSteps=e.longs===String?c.Long.prototype.toString.call(t.totalQuantizedSteps):e.longs===Number?new c.LongBits(t.totalQuantizedSteps.low>>>0,t.totalQuantizedSteps.high>>>0).toNumber():t.totalQuantizedSteps),null!=t.subsequenceInfo&&t.hasOwnProperty("subsequenceInfo")&&(n.subsequenceInfo=l.tensorflow.magenta.NoteSequence.SubsequenceInfo.toObject(t.subsequenceInfo,e)),null!=t.referenceNumber&&t.hasOwnProperty("referenceNumber")&&("number"==typeof t.referenceNumber?n.referenceNumber=e.longs===String?String(t.referenceNumber):t.referenceNumber:n.referenceNumber=e.longs===String?c.Long.prototype.toString.call(t.referenceNumber):e.longs===Number?new c.LongBits(t.referenceNumber.low>>>0,t.referenceNumber.high>>>0).toNumber():t.referenceNumber),null!=t.sequenceMetadata&&t.hasOwnProperty("sequenceMetadata")&&(n.sequenceMetadata=l.tensorflow.magenta.SequenceMetadata.toObject(t.sequenceMetadata,e)),t.sectionAnnotations&&t.sectionAnnotations.length)for(n.sectionAnnotations=[],r=0;r<t.sectionAnnotations.length;++r)n.sectionAnnotations[r]=l.tensorflow.magenta.NoteSequence.SectionAnnotation.toObject(t.sectionAnnotations[r],e);if(t.sectionGroups&&t.sectionGroups.length)for(n.sectionGroups=[],r=0;r<t.sectionGroups.length;++r)n.sectionGroups[r]=l.tensorflow.magenta.NoteSequence.SectionGroup.toObject(t.sectionGroups[r],e);return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.Note=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.pitch=0,t.prototype.pitchName=0,t.prototype.velocity=0,t.prototype.startTime=0,t.prototype.quantizedStartStep=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.endTime=0,t.prototype.quantizedEndStep=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.numerator=0,t.prototype.denominator=0,t.prototype.instrument=0,t.prototype.program=0,t.prototype.isDrum=!1,t.prototype.part=0,t.prototype.voice=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.pitch&&t.hasOwnProperty("pitch")&&e.uint32(8).int32(t.pitch),null!=t.velocity&&t.hasOwnProperty("velocity")&&e.uint32(16).int32(t.velocity),null!=t.startTime&&t.hasOwnProperty("startTime")&&e.uint32(25).double(t.startTime),null!=t.endTime&&t.hasOwnProperty("endTime")&&e.uint32(33).double(t.endTime),null!=t.numerator&&t.hasOwnProperty("numerator")&&e.uint32(40).int32(t.numerator),null!=t.denominator&&t.hasOwnProperty("denominator")&&e.uint32(48).int32(t.denominator),null!=t.instrument&&t.hasOwnProperty("instrument")&&e.uint32(56).int32(t.instrument),null!=t.program&&t.hasOwnProperty("program")&&e.uint32(64).int32(t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&e.uint32(72).bool(t.isDrum),null!=t.part&&t.hasOwnProperty("part")&&e.uint32(80).int32(t.part),null!=t.pitchName&&t.hasOwnProperty("pitchName")&&e.uint32(88).int32(t.pitchName),null!=t.voice&&t.hasOwnProperty("voice")&&e.uint32(96).int32(t.voice),null!=t.quantizedStartStep&&t.hasOwnProperty("quantizedStartStep")&&e.uint32(104).int64(t.quantizedStartStep),null!=t.quantizedEndStep&&t.hasOwnProperty("quantizedEndStep")&&e.uint32(112).int64(t.quantizedEndStep),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.Note;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.pitch=t.int32();break;case 11:i.pitchName=t.int32();break;case 2:i.velocity=t.int32();break;case 3:i.startTime=t.double();break;case 13:i.quantizedStartStep=c.Long?t.int64().toNumber():t.int64();break;case 4:i.endTime=t.double();break;case 14:i.quantizedEndStep=c.Long?t.int64().toNumber():t.int64();break;case 5:i.numerator=t.int32();break;case 6:i.denominator=t.int32();break;case 7:i.instrument=t.int32();break;case 8:i.program=t.int32();break;case 9:i.isDrum=t.bool();break;case 10:i.part=t.int32();break;case 12:i.voice=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.pitch&&t.hasOwnProperty("pitch")&&!c.isInteger(t.pitch))return"pitch: integer expected";if(null!=t.pitchName&&t.hasOwnProperty("pitchName"))switch(t.pitchName){default:return"pitchName: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:}return null!=t.velocity&&t.hasOwnProperty("velocity")&&!c.isInteger(t.velocity)?"velocity: integer expected":null!=t.startTime&&t.hasOwnProperty("startTime")&&"number"!=typeof t.startTime?"startTime: number expected":null!=t.quantizedStartStep&&t.hasOwnProperty("quantizedStartStep")&&!(c.isInteger(t.quantizedStartStep)||t.quantizedStartStep&&c.isInteger(t.quantizedStartStep.low)&&c.isInteger(t.quantizedStartStep.high))?"quantizedStartStep: integer|Long expected":null!=t.endTime&&t.hasOwnProperty("endTime")&&"number"!=typeof t.endTime?"endTime: number expected":null!=t.quantizedEndStep&&t.hasOwnProperty("quantizedEndStep")&&!(c.isInteger(t.quantizedEndStep)||t.quantizedEndStep&&c.isInteger(t.quantizedEndStep.low)&&c.isInteger(t.quantizedEndStep.high))?"quantizedEndStep: integer|Long expected":null!=t.numerator&&t.hasOwnProperty("numerator")&&!c.isInteger(t.numerator)?"numerator: integer expected":null!=t.denominator&&t.hasOwnProperty("denominator")&&!c.isInteger(t.denominator)?"denominator: integer expected":null!=t.instrument&&t.hasOwnProperty("instrument")&&!c.isInteger(t.instrument)?"instrument: integer expected":null!=t.program&&t.hasOwnProperty("program")&&!c.isInteger(t.program)?"program: integer expected":null!=t.isDrum&&t.hasOwnProperty("isDrum")&&"boolean"!=typeof t.isDrum?"isDrum: boolean expected":null!=t.part&&t.hasOwnProperty("part")&&!c.isInteger(t.part)?"part: integer expected":null!=t.voice&&t.hasOwnProperty("voice")&&!c.isInteger(t.voice)?"voice: integer expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.Note)return t;var e=new l.tensorflow.magenta.NoteSequence.Note;switch(null!=t.pitch&&(e.pitch=0|t.pitch),t.pitchName){case"UNKNOWN_PITCH_NAME":case 0:e.pitchName=0;break;case"F_FLAT_FLAT":case 1:e.pitchName=1;break;case"C_FLAT_FLAT":case 2:e.pitchName=2;break;case"G_FLAT_FLAT":case 3:e.pitchName=3;break;case"D_FLAT_FLAT":case 4:e.pitchName=4;break;case"A_FLAT_FLAT":case 5:e.pitchName=5;break;case"E_FLAT_FLAT":case 6:e.pitchName=6;break;case"B_FLAT_FLAT":case 7:e.pitchName=7;break;case"F_FLAT":case 8:e.pitchName=8;break;case"C_FLAT":case 9:e.pitchName=9;break;case"G_FLAT":case 10:e.pitchName=10;break;case"D_FLAT":case 11:e.pitchName=11;break;case"A_FLAT":case 12:e.pitchName=12;break;case"E_FLAT":case 13:e.pitchName=13;break;case"B_FLAT":case 14:e.pitchName=14;break;case"F":case 15:e.pitchName=15;break;case"C":case 16:e.pitchName=16;break;case"G":case 17:e.pitchName=17;break;case"D":case 18:e.pitchName=18;break;case"A":case 19:e.pitchName=19;break;case"E":case 20:e.pitchName=20;break;case"B":case 21:e.pitchName=21;break;case"F_SHARP":case 22:e.pitchName=22;break;case"C_SHARP":case 23:e.pitchName=23;break;case"G_SHARP":case 24:e.pitchName=24;break;case"D_SHARP":case 25:e.pitchName=25;break;case"A_SHARP":case 26:e.pitchName=26;break;case"E_SHARP":case 27:e.pitchName=27;break;case"B_SHARP":case 28:e.pitchName=28;break;case"F_SHARP_SHARP":case 29:e.pitchName=29;break;case"C_SHARP_SHARP":case 30:e.pitchName=30;break;case"G_SHARP_SHARP":case 31:e.pitchName=31;break;case"D_SHARP_SHARP":case 32:e.pitchName=32;break;case"A_SHARP_SHARP":case 33:e.pitchName=33;break;case"E_SHARP_SHARP":case 34:e.pitchName=34;break;case"B_SHARP_SHARP":case 35:e.pitchName=35}return null!=t.velocity&&(e.velocity=0|t.velocity),null!=t.startTime&&(e.startTime=Number(t.startTime)),null!=t.quantizedStartStep&&(c.Long?(e.quantizedStartStep=c.Long.fromValue(t.quantizedStartStep)).unsigned=!1:"string"==typeof t.quantizedStartStep?e.quantizedStartStep=parseInt(t.quantizedStartStep,10):"number"==typeof t.quantizedStartStep?e.quantizedStartStep=t.quantizedStartStep:"object"==typeof t.quantizedStartStep&&(e.quantizedStartStep=new c.LongBits(t.quantizedStartStep.low>>>0,t.quantizedStartStep.high>>>0).toNumber())),null!=t.endTime&&(e.endTime=Number(t.endTime)),null!=t.quantizedEndStep&&(c.Long?(e.quantizedEndStep=c.Long.fromValue(t.quantizedEndStep)).unsigned=!1:"string"==typeof t.quantizedEndStep?e.quantizedEndStep=parseInt(t.quantizedEndStep,10):"number"==typeof t.quantizedEndStep?e.quantizedEndStep=t.quantizedEndStep:"object"==typeof t.quantizedEndStep&&(e.quantizedEndStep=new c.LongBits(t.quantizedEndStep.low>>>0,t.quantizedEndStep.high>>>0).toNumber())),null!=t.numerator&&(e.numerator=0|t.numerator),null!=t.denominator&&(e.denominator=0|t.denominator),null!=t.instrument&&(e.instrument=0|t.instrument),null!=t.program&&(e.program=0|t.program),null!=t.isDrum&&(e.isDrum=Boolean(t.isDrum)),null!=t.part&&(e.part=0|t.part),null!=t.voice&&(e.voice=0|t.voice),e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults){if(n.pitch=0,n.velocity=0,n.startTime=0,n.endTime=0,n.numerator=0,n.denominator=0,n.instrument=0,n.program=0,n.isDrum=!1,n.part=0,n.pitchName=e.enums===String?"UNKNOWN_PITCH_NAME":0,n.voice=0,c.Long){var i=new c.Long(0,0,!1);n.quantizedStartStep=e.longs===String?i.toString():e.longs===Number?i.toNumber():i}else n.quantizedStartStep=e.longs===String?"0":0;c.Long?(i=new c.Long(0,0,!1),n.quantizedEndStep=e.longs===String?i.toString():e.longs===Number?i.toNumber():i):n.quantizedEndStep=e.longs===String?"0":0}return null!=t.pitch&&t.hasOwnProperty("pitch")&&(n.pitch=t.pitch),null!=t.velocity&&t.hasOwnProperty("velocity")&&(n.velocity=t.velocity),null!=t.startTime&&t.hasOwnProperty("startTime")&&(n.startTime=e.json&&!isFinite(t.startTime)?String(t.startTime):t.startTime),null!=t.endTime&&t.hasOwnProperty("endTime")&&(n.endTime=e.json&&!isFinite(t.endTime)?String(t.endTime):t.endTime),null!=t.numerator&&t.hasOwnProperty("numerator")&&(n.numerator=t.numerator),null!=t.denominator&&t.hasOwnProperty("denominator")&&(n.denominator=t.denominator),null!=t.instrument&&t.hasOwnProperty("instrument")&&(n.instrument=t.instrument),null!=t.program&&t.hasOwnProperty("program")&&(n.program=t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&(n.isDrum=t.isDrum),null!=t.part&&t.hasOwnProperty("part")&&(n.part=t.part),null!=t.pitchName&&t.hasOwnProperty("pitchName")&&(n.pitchName=e.enums===String?l.tensorflow.magenta.NoteSequence.PitchName[t.pitchName]:t.pitchName),null!=t.voice&&t.hasOwnProperty("voice")&&(n.voice=t.voice),null!=t.quantizedStartStep&&t.hasOwnProperty("quantizedStartStep")&&("number"==typeof t.quantizedStartStep?n.quantizedStartStep=e.longs===String?String(t.quantizedStartStep):t.quantizedStartStep:n.quantizedStartStep=e.longs===String?c.Long.prototype.toString.call(t.quantizedStartStep):e.longs===Number?new c.LongBits(t.quantizedStartStep.low>>>0,t.quantizedStartStep.high>>>0).toNumber():t.quantizedStartStep),null!=t.quantizedEndStep&&t.hasOwnProperty("quantizedEndStep")&&("number"==typeof t.quantizedEndStep?n.quantizedEndStep=e.longs===String?String(t.quantizedEndStep):t.quantizedEndStep:n.quantizedEndStep=e.longs===String?c.Long.prototype.toString.call(t.quantizedEndStep):e.longs===Number?new c.LongBits(t.quantizedEndStep.low>>>0,t.quantizedEndStep.high>>>0).toNumber():t.quantizedEndStep),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.PitchName=(e={},(n=Object.create(e))[e[0]="UNKNOWN_PITCH_NAME"]=0,n[e[1]="F_FLAT_FLAT"]=1,n[e[2]="C_FLAT_FLAT"]=2,n[e[3]="G_FLAT_FLAT"]=3,n[e[4]="D_FLAT_FLAT"]=4,n[e[5]="A_FLAT_FLAT"]=5,n[e[6]="E_FLAT_FLAT"]=6,n[e[7]="B_FLAT_FLAT"]=7,n[e[8]="F_FLAT"]=8,n[e[9]="C_FLAT"]=9,n[e[10]="G_FLAT"]=10,n[e[11]="D_FLAT"]=11,n[e[12]="A_FLAT"]=12,n[e[13]="E_FLAT"]=13,n[e[14]="B_FLAT"]=14,n[e[15]="F"]=15,n[e[16]="C"]=16,n[e[17]="G"]=17,n[e[18]="D"]=18,n[e[19]="A"]=19,n[e[20]="E"]=20,n[e[21]="B"]=21,n[e[22]="F_SHARP"]=22,n[e[23]="C_SHARP"]=23,n[e[24]="G_SHARP"]=24,n[e[25]="D_SHARP"]=25,n[e[26]="A_SHARP"]=26,n[e[27]="E_SHARP"]=27,n[e[28]="B_SHARP"]=28,n[e[29]="F_SHARP_SHARP"]=29,n[e[30]="C_SHARP_SHARP"]=30,n[e[31]="G_SHARP_SHARP"]=31,n[e[32]="D_SHARP_SHARP"]=32,n[e[33]="A_SHARP_SHARP"]=33,n[e[34]="E_SHARP_SHARP"]=34,n[e[35]="B_SHARP_SHARP"]=35,n),t.TimeSignature=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.numerator=0,t.prototype.denominator=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.numerator&&t.hasOwnProperty("numerator")&&e.uint32(16).int32(t.numerator),null!=t.denominator&&t.hasOwnProperty("denominator")&&e.uint32(24).int32(t.denominator),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.TimeSignature;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 2:i.numerator=t.int32();break;case 3:i.denominator=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time?"time: number expected":null!=t.numerator&&t.hasOwnProperty("numerator")&&!c.isInteger(t.numerator)?"numerator: integer expected":null!=t.denominator&&t.hasOwnProperty("denominator")&&!c.isInteger(t.denominator)?"denominator: integer expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.TimeSignature)return t;var e=new l.tensorflow.magenta.NoteSequence.TimeSignature;return null!=t.time&&(e.time=Number(t.time)),null!=t.numerator&&(e.numerator=0|t.numerator),null!=t.denominator&&(e.denominator=0|t.denominator),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.time=0,n.numerator=0,n.denominator=0),null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.numerator&&t.hasOwnProperty("numerator")&&(n.numerator=t.numerator),null!=t.denominator&&t.hasOwnProperty("denominator")&&(n.denominator=t.denominator),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.KeySignature=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.key=0,t.prototype.mode=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.key&&t.hasOwnProperty("key")&&e.uint32(16).int32(t.key),null!=t.mode&&t.hasOwnProperty("mode")&&e.uint32(24).int32(t.mode),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.KeySignature;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 2:i.key=t.int32();break;case 3:i.mode=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time)return"time: number expected";if(null!=t.key&&t.hasOwnProperty("key"))switch(t.key){default:return"key: enum value expected";case 0:case 1:case 1:case 2:case 3:case 3:case 4:case 5:case 6:case 6:case 7:case 8:case 8:case 9:case 10:case 10:case 11:}if(null!=t.mode&&t.hasOwnProperty("mode"))switch(t.mode){default:return"mode: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.KeySignature)return t;var e=new l.tensorflow.magenta.NoteSequence.KeySignature;switch(null!=t.time&&(e.time=Number(t.time)),t.key){case"C":case 0:e.key=0;break;case"C_SHARP":case 1:case"D_FLAT":case 1:e.key=1;break;case"D":case 2:e.key=2;break;case"D_SHARP":case 3:case"E_FLAT":case 3:e.key=3;break;case"E":case 4:e.key=4;break;case"F":case 5:e.key=5;break;case"F_SHARP":case 6:case"G_FLAT":case 6:e.key=6;break;case"G":case 7:e.key=7;break;case"G_SHARP":case 8:case"A_FLAT":case 8:e.key=8;break;case"A":case 9:e.key=9;break;case"A_SHARP":case 10:case"B_FLAT":case 10:e.key=10;break;case"B":case 11:e.key=11}switch(t.mode){case"MAJOR":case 0:e.mode=0;break;case"MINOR":case 1:e.mode=1;break;case"NOT_SPECIFIED":case 2:e.mode=2;break;case"MIXOLYDIAN":case 3:e.mode=3;break;case"DORIAN":case 4:e.mode=4;break;case"PHRYGIAN":case 5:e.mode=5;break;case"LYDIAN":case 6:e.mode=6;break;case"LOCRIAN":case 7:e.mode=7}return e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.time=0,n.key=e.enums===String?"C":0,n.mode=e.enums===String?"MAJOR":0),null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.key&&t.hasOwnProperty("key")&&(n.key=e.enums===String?l.tensorflow.magenta.NoteSequence.KeySignature.Key[t.key]:t.key),null!=t.mode&&t.hasOwnProperty("mode")&&(n.mode=e.enums===String?l.tensorflow.magenta.NoteSequence.KeySignature.Mode[t.mode]:t.mode),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.Key=function(){var t={},e=Object.create(t);return e[t[0]="C"]=0,e[t[1]="C_SHARP"]=1,e.D_FLAT=1,e[t[2]="D"]=2,e[t[3]="D_SHARP"]=3,e.E_FLAT=3,e[t[4]="E"]=4,e[t[5]="F"]=5,e[t[6]="F_SHARP"]=6,e.G_FLAT=6,e[t[7]="G"]=7,e[t[8]="G_SHARP"]=8,e.A_FLAT=8,e[t[9]="A"]=9,e[t[10]="A_SHARP"]=10,e.B_FLAT=10,e[t[11]="B"]=11,e}(),t.Mode=function(){var t={},e=Object.create(t);return e[t[0]="MAJOR"]=0,e[t[1]="MINOR"]=1,e[t[2]="NOT_SPECIFIED"]=2,e[t[3]="MIXOLYDIAN"]=3,e[t[4]="DORIAN"]=4,e[t[5]="PHRYGIAN"]=5,e[t[6]="LYDIAN"]=6,e[t[7]="LOCRIAN"]=7,e}(),t}(),t.Tempo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.qpm=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.qpm&&t.hasOwnProperty("qpm")&&e.uint32(17).double(t.qpm),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.Tempo;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 2:i.qpm=t.double();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time?"time: number expected":null!=t.qpm&&t.hasOwnProperty("qpm")&&"number"!=typeof t.qpm?"qpm: number expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.Tempo)return t;var e=new l.tensorflow.magenta.NoteSequence.Tempo;return null!=t.time&&(e.time=Number(t.time)),null!=t.qpm&&(e.qpm=Number(t.qpm)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.time=0,n.qpm=0),null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.qpm&&t.hasOwnProperty("qpm")&&(n.qpm=e.json&&!isFinite(t.qpm)?String(t.qpm):t.qpm),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.PitchBend=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.bend=0,t.prototype.instrument=0,t.prototype.program=0,t.prototype.isDrum=!1,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.bend&&t.hasOwnProperty("bend")&&e.uint32(16).int32(t.bend),null!=t.instrument&&t.hasOwnProperty("instrument")&&e.uint32(24).int32(t.instrument),null!=t.program&&t.hasOwnProperty("program")&&e.uint32(32).int32(t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&e.uint32(40).bool(t.isDrum),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.PitchBend;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 2:i.bend=t.int32();break;case 3:i.instrument=t.int32();break;case 4:i.program=t.int32();break;case 5:i.isDrum=t.bool();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time?"time: number expected":null!=t.bend&&t.hasOwnProperty("bend")&&!c.isInteger(t.bend)?"bend: integer expected":null!=t.instrument&&t.hasOwnProperty("instrument")&&!c.isInteger(t.instrument)?"instrument: integer expected":null!=t.program&&t.hasOwnProperty("program")&&!c.isInteger(t.program)?"program: integer expected":null!=t.isDrum&&t.hasOwnProperty("isDrum")&&"boolean"!=typeof t.isDrum?"isDrum: boolean expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.PitchBend)return t;var e=new l.tensorflow.magenta.NoteSequence.PitchBend;return null!=t.time&&(e.time=Number(t.time)),null!=t.bend&&(e.bend=0|t.bend),null!=t.instrument&&(e.instrument=0|t.instrument),null!=t.program&&(e.program=0|t.program),null!=t.isDrum&&(e.isDrum=Boolean(t.isDrum)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.time=0,n.bend=0,n.instrument=0,n.program=0,n.isDrum=!1),null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.bend&&t.hasOwnProperty("bend")&&(n.bend=t.bend),null!=t.instrument&&t.hasOwnProperty("instrument")&&(n.instrument=t.instrument),null!=t.program&&t.hasOwnProperty("program")&&(n.program=t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&(n.isDrum=t.isDrum),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.ControlChange=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.quantizedStep=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.controlNumber=0,t.prototype.controlValue=0,t.prototype.instrument=0,t.prototype.program=0,t.prototype.isDrum=!1,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.controlNumber&&t.hasOwnProperty("controlNumber")&&e.uint32(16).int32(t.controlNumber),null!=t.controlValue&&t.hasOwnProperty("controlValue")&&e.uint32(24).int32(t.controlValue),null!=t.instrument&&t.hasOwnProperty("instrument")&&e.uint32(32).int32(t.instrument),null!=t.program&&t.hasOwnProperty("program")&&e.uint32(40).int32(t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&e.uint32(48).bool(t.isDrum),null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&e.uint32(56).int64(t.quantizedStep),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.ControlChange;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 7:i.quantizedStep=c.Long?t.int64().toNumber():t.int64();break;case 2:i.controlNumber=t.int32();break;case 3:i.controlValue=t.int32();break;case 4:i.instrument=t.int32();break;case 5:i.program=t.int32();break;case 6:i.isDrum=t.bool();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time?"time: number expected":null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&!(c.isInteger(t.quantizedStep)||t.quantizedStep&&c.isInteger(t.quantizedStep.low)&&c.isInteger(t.quantizedStep.high))?"quantizedStep: integer|Long expected":null!=t.controlNumber&&t.hasOwnProperty("controlNumber")&&!c.isInteger(t.controlNumber)?"controlNumber: integer expected":null!=t.controlValue&&t.hasOwnProperty("controlValue")&&!c.isInteger(t.controlValue)?"controlValue: integer expected":null!=t.instrument&&t.hasOwnProperty("instrument")&&!c.isInteger(t.instrument)?"instrument: integer expected":null!=t.program&&t.hasOwnProperty("program")&&!c.isInteger(t.program)?"program: integer expected":null!=t.isDrum&&t.hasOwnProperty("isDrum")&&"boolean"!=typeof t.isDrum?"isDrum: boolean expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.ControlChange)return t;var e=new l.tensorflow.magenta.NoteSequence.ControlChange;return null!=t.time&&(e.time=Number(t.time)),null!=t.quantizedStep&&(c.Long?(e.quantizedStep=c.Long.fromValue(t.quantizedStep)).unsigned=!1:"string"==typeof t.quantizedStep?e.quantizedStep=parseInt(t.quantizedStep,10):"number"==typeof t.quantizedStep?e.quantizedStep=t.quantizedStep:"object"==typeof t.quantizedStep&&(e.quantizedStep=new c.LongBits(t.quantizedStep.low>>>0,t.quantizedStep.high>>>0).toNumber())),null!=t.controlNumber&&(e.controlNumber=0|t.controlNumber),null!=t.controlValue&&(e.controlValue=0|t.controlValue),null!=t.instrument&&(e.instrument=0|t.instrument),null!=t.program&&(e.program=0|t.program),null!=t.isDrum&&(e.isDrum=Boolean(t.isDrum)),e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(n.time=0,n.controlNumber=0,n.controlValue=0,n.instrument=0,n.program=0,n.isDrum=!1,c.Long){var i=new c.Long(0,0,!1);n.quantizedStep=e.longs===String?i.toString():e.longs===Number?i.toNumber():i}else n.quantizedStep=e.longs===String?"0":0;return null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.controlNumber&&t.hasOwnProperty("controlNumber")&&(n.controlNumber=t.controlNumber),null!=t.controlValue&&t.hasOwnProperty("controlValue")&&(n.controlValue=t.controlValue),null!=t.instrument&&t.hasOwnProperty("instrument")&&(n.instrument=t.instrument),null!=t.program&&t.hasOwnProperty("program")&&(n.program=t.program),null!=t.isDrum&&t.hasOwnProperty("isDrum")&&(n.isDrum=t.isDrum),null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&("number"==typeof t.quantizedStep?n.quantizedStep=e.longs===String?String(t.quantizedStep):t.quantizedStep:n.quantizedStep=e.longs===String?c.Long.prototype.toString.call(t.quantizedStep):e.longs===Number?new c.LongBits(t.quantizedStep.low>>>0,t.quantizedStep.high>>>0).toNumber():t.quantizedStep),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.PartInfo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.part=0,t.prototype.name="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.part&&t.hasOwnProperty("part")&&e.uint32(8).int32(t.part),null!=t.name&&t.hasOwnProperty("name")&&e.uint32(18).string(t.name),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.PartInfo;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.part=t.int32();break;case 2:i.name=t.string();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.part&&t.hasOwnProperty("part")&&!c.isInteger(t.part)?"part: integer expected":null!=t.name&&t.hasOwnProperty("name")&&!c.isString(t.name)?"name: string expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.PartInfo)return t;var e=new l.tensorflow.magenta.NoteSequence.PartInfo;return null!=t.part&&(e.part=0|t.part),null!=t.name&&(e.name=String(t.name)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.part=0,n.name=""),null!=t.part&&t.hasOwnProperty("part")&&(n.part=t.part),null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.SourceInfo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.sourceType=0,t.prototype.encodingType=0,t.prototype.parser=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.sourceType&&t.hasOwnProperty("sourceType")&&e.uint32(8).int32(t.sourceType),null!=t.encodingType&&t.hasOwnProperty("encodingType")&&e.uint32(16).int32(t.encodingType),null!=t.parser&&t.hasOwnProperty("parser")&&e.uint32(24).int32(t.parser),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.SourceInfo;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.sourceType=t.int32();break;case 2:i.encodingType=t.int32();break;case 3:i.parser=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.sourceType&&t.hasOwnProperty("sourceType"))switch(t.sourceType){default:return"sourceType: enum value expected";case 0:case 1:case 2:}if(null!=t.encodingType&&t.hasOwnProperty("encodingType"))switch(t.encodingType){default:return"encodingType: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=t.parser&&t.hasOwnProperty("parser"))switch(t.parser){default:return"parser: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.SourceInfo)return t;var e=new l.tensorflow.magenta.NoteSequence.SourceInfo;switch(t.sourceType){case"UNKNOWN_SOURCE_TYPE":case 0:e.sourceType=0;break;case"SCORE_BASED":case 1:e.sourceType=1;break;case"PERFORMANCE_BASED":case 2:e.sourceType=2}switch(t.encodingType){case"UNKNOWN_ENCODING_TYPE":case 0:e.encodingType=0;break;case"MUSIC_XML":case 1:e.encodingType=1;break;case"ABC":case 2:e.encodingType=2;break;case"MIDI":case 3:e.encodingType=3;break;case"MUSICNET":case 4:e.encodingType=4}switch(t.parser){case"UNKNOWN_PARSER":case 0:e.parser=0;break;case"MUSIC21":case 1:e.parser=1;break;case"PRETTY_MIDI":case 2:e.parser=2;break;case"MAGENTA_MUSIC_XML":case 3:e.parser=3;break;case"MAGENTA_MUSICNET":case 4:e.parser=4;break;case"MAGENTA_ABC":case 5:e.parser=5;break;case"TONEJS_MIDI_CONVERT":case 6:e.parser=6}return e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.sourceType=e.enums===String?"UNKNOWN_SOURCE_TYPE":0,n.encodingType=e.enums===String?"UNKNOWN_ENCODING_TYPE":0,n.parser=e.enums===String?"UNKNOWN_PARSER":0),null!=t.sourceType&&t.hasOwnProperty("sourceType")&&(n.sourceType=e.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.SourceType[t.sourceType]:t.sourceType),null!=t.encodingType&&t.hasOwnProperty("encodingType")&&(n.encodingType=e.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.EncodingType[t.encodingType]:t.encodingType),null!=t.parser&&t.hasOwnProperty("parser")&&(n.parser=e.enums===String?l.tensorflow.magenta.NoteSequence.SourceInfo.Parser[t.parser]:t.parser),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.SourceType=function(){var t={},e=Object.create(t);return e[t[0]="UNKNOWN_SOURCE_TYPE"]=0,e[t[1]="SCORE_BASED"]=1,e[t[2]="PERFORMANCE_BASED"]=2,e}(),t.EncodingType=function(){var t={},e=Object.create(t);return e[t[0]="UNKNOWN_ENCODING_TYPE"]=0,e[t[1]="MUSIC_XML"]=1,e[t[2]="ABC"]=2,e[t[3]="MIDI"]=3,e[t[4]="MUSICNET"]=4,e}(),t.Parser=function(){var t={},e=Object.create(t);return e[t[0]="UNKNOWN_PARSER"]=0,e[t[1]="MUSIC21"]=1,e[t[2]="PRETTY_MIDI"]=2,e[t[3]="MAGENTA_MUSIC_XML"]=3,e[t[4]="MAGENTA_MUSICNET"]=4,e[t[5]="MAGENTA_ABC"]=5,e[t[6]="TONEJS_MIDI_CONVERT"]=6,e}(),t}(),t.TextAnnotation=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.quantizedStep=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.text="",t.prototype.annotationType=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.text&&t.hasOwnProperty("text")&&e.uint32(18).string(t.text),null!=t.annotationType&&t.hasOwnProperty("annotationType")&&e.uint32(24).int32(t.annotationType),null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&e.uint32(32).int64(t.quantizedStep),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.TextAnnotation;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 4:i.quantizedStep=c.Long?t.int64().toNumber():t.int64();break;case 2:i.text=t.string();break;case 3:i.annotationType=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time)return"time: number expected";if(null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&!(c.isInteger(t.quantizedStep)||t.quantizedStep&&c.isInteger(t.quantizedStep.low)&&c.isInteger(t.quantizedStep.high)))return"quantizedStep: integer|Long expected";if(null!=t.text&&t.hasOwnProperty("text")&&!c.isString(t.text))return"text: string expected";if(null!=t.annotationType&&t.hasOwnProperty("annotationType"))switch(t.annotationType){default:return"annotationType: enum value expected";case 0:case 1:case 2:}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.TextAnnotation)return t;var e=new l.tensorflow.magenta.NoteSequence.TextAnnotation;switch(null!=t.time&&(e.time=Number(t.time)),null!=t.quantizedStep&&(c.Long?(e.quantizedStep=c.Long.fromValue(t.quantizedStep)).unsigned=!1:"string"==typeof t.quantizedStep?e.quantizedStep=parseInt(t.quantizedStep,10):"number"==typeof t.quantizedStep?e.quantizedStep=t.quantizedStep:"object"==typeof t.quantizedStep&&(e.quantizedStep=new c.LongBits(t.quantizedStep.low>>>0,t.quantizedStep.high>>>0).toNumber())),null!=t.text&&(e.text=String(t.text)),t.annotationType){case"UNKNOWN":case 0:e.annotationType=0;break;case"CHORD_SYMBOL":case 1:e.annotationType=1;break;case"BEAT":case 2:e.annotationType=2}return e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(n.time=0,n.text="",n.annotationType=e.enums===String?"UNKNOWN":0,c.Long){var i=new c.Long(0,0,!1);n.quantizedStep=e.longs===String?i.toString():e.longs===Number?i.toNumber():i}else n.quantizedStep=e.longs===String?"0":0;return null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.text&&t.hasOwnProperty("text")&&(n.text=t.text),null!=t.annotationType&&t.hasOwnProperty("annotationType")&&(n.annotationType=e.enums===String?l.tensorflow.magenta.NoteSequence.TextAnnotation.TextAnnotationType[t.annotationType]:t.annotationType),null!=t.quantizedStep&&t.hasOwnProperty("quantizedStep")&&("number"==typeof t.quantizedStep?n.quantizedStep=e.longs===String?String(t.quantizedStep):t.quantizedStep:n.quantizedStep=e.longs===String?c.Long.prototype.toString.call(t.quantizedStep):e.longs===Number?new c.LongBits(t.quantizedStep.low>>>0,t.quantizedStep.high>>>0).toNumber():t.quantizedStep),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t.TextAnnotationType=function(){var t={},e=Object.create(t);return e[t[0]="UNKNOWN"]=0,e[t[1]="CHORD_SYMBOL"]=1,e[t[2]="BEAT"]=2,e}(),t}(),t.QuantizationInfo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.stepsPerQuarter=0,t.prototype.stepsPerSecond=0,Object.defineProperty(t.prototype,"resolution",{get:c.oneOfGetter(e=["stepsPerQuarter","stepsPerSecond"]),set:c.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.stepsPerQuarter&&t.hasOwnProperty("stepsPerQuarter")&&e.uint32(8).int32(t.stepsPerQuarter),null!=t.stepsPerSecond&&t.hasOwnProperty("stepsPerSecond")&&e.uint32(16).int32(t.stepsPerSecond),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.QuantizationInfo;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.stepsPerQuarter=t.int32();break;case 2:i.stepsPerSecond=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.stepsPerQuarter&&t.hasOwnProperty("stepsPerQuarter")&&(e.resolution=1,!c.isInteger(t.stepsPerQuarter)))return"stepsPerQuarter: integer expected";if(null!=t.stepsPerSecond&&t.hasOwnProperty("stepsPerSecond")){if(1===e.resolution)return"resolution: multiple values";if(e.resolution=1,!c.isInteger(t.stepsPerSecond))return"stepsPerSecond: integer expected"}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.QuantizationInfo)return t;var e=new l.tensorflow.magenta.NoteSequence.QuantizationInfo;return null!=t.stepsPerQuarter&&(e.stepsPerQuarter=0|t.stepsPerQuarter),null!=t.stepsPerSecond&&(e.stepsPerSecond=0|t.stepsPerSecond),e},t.toObject=function(t,e){e||(e={});var n={};return null!=t.stepsPerQuarter&&t.hasOwnProperty("stepsPerQuarter")&&(n.stepsPerQuarter=t.stepsPerQuarter,e.oneofs&&(n.resolution="stepsPerQuarter")),null!=t.stepsPerSecond&&t.hasOwnProperty("stepsPerSecond")&&(n.stepsPerSecond=t.stepsPerSecond,e.oneofs&&(n.resolution="stepsPerSecond")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.SubsequenceInfo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.startTimeOffset=0,t.prototype.endTimeOffset=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.startTimeOffset&&t.hasOwnProperty("startTimeOffset")&&e.uint32(9).double(t.startTimeOffset),null!=t.endTimeOffset&&t.hasOwnProperty("endTimeOffset")&&e.uint32(17).double(t.endTimeOffset),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.SubsequenceInfo;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.startTimeOffset=t.double();break;case 2:i.endTimeOffset=t.double();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.startTimeOffset&&t.hasOwnProperty("startTimeOffset")&&"number"!=typeof t.startTimeOffset?"startTimeOffset: number expected":null!=t.endTimeOffset&&t.hasOwnProperty("endTimeOffset")&&"number"!=typeof t.endTimeOffset?"endTimeOffset: number expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.SubsequenceInfo)return t;var e=new l.tensorflow.magenta.NoteSequence.SubsequenceInfo;return null!=t.startTimeOffset&&(e.startTimeOffset=Number(t.startTimeOffset)),null!=t.endTimeOffset&&(e.endTimeOffset=Number(t.endTimeOffset)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.startTimeOffset=0,n.endTimeOffset=0),null!=t.startTimeOffset&&t.hasOwnProperty("startTimeOffset")&&(n.startTimeOffset=e.json&&!isFinite(t.startTimeOffset)?String(t.startTimeOffset):t.startTimeOffset),null!=t.endTimeOffset&&t.hasOwnProperty("endTimeOffset")&&(n.endTimeOffset=e.json&&!isFinite(t.endTimeOffset)?String(t.endTimeOffset):t.endTimeOffset),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.SectionAnnotation=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.time=0,t.prototype.sectionId=c.Long?c.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.time&&t.hasOwnProperty("time")&&e.uint32(9).double(t.time),null!=t.sectionId&&t.hasOwnProperty("sectionId")&&e.uint32(32).int64(t.sectionId),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.SectionAnnotation;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.time=t.double();break;case 4:i.sectionId=c.Long?t.int64().toNumber():t.int64();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.time&&t.hasOwnProperty("time")&&"number"!=typeof t.time?"time: number expected":null!=t.sectionId&&t.hasOwnProperty("sectionId")&&!(c.isInteger(t.sectionId)||t.sectionId&&c.isInteger(t.sectionId.low)&&c.isInteger(t.sectionId.high))?"sectionId: integer|Long expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.SectionAnnotation)return t;var e=new l.tensorflow.magenta.NoteSequence.SectionAnnotation;return null!=t.time&&(e.time=Number(t.time)),null!=t.sectionId&&(c.Long?(e.sectionId=c.Long.fromValue(t.sectionId)).unsigned=!1:"string"==typeof t.sectionId?e.sectionId=parseInt(t.sectionId,10):"number"==typeof t.sectionId?e.sectionId=t.sectionId:"object"==typeof t.sectionId&&(e.sectionId=new c.LongBits(t.sectionId.low>>>0,t.sectionId.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(n.time=0,c.Long){var i=new c.Long(0,0,!1);n.sectionId=e.longs===String?i.toString():e.longs===Number?i.toNumber():i}else n.sectionId=e.longs===String?"0":0;return null!=t.time&&t.hasOwnProperty("time")&&(n.time=e.json&&!isFinite(t.time)?String(t.time):t.time),null!=t.sectionId&&t.hasOwnProperty("sectionId")&&("number"==typeof t.sectionId?n.sectionId=e.longs===String?String(t.sectionId):t.sectionId:n.sectionId=e.longs===String?c.Long.prototype.toString.call(t.sectionId):e.longs===Number?new c.LongBits(t.sectionId.low>>>0,t.sectionId.high>>>0).toNumber():t.sectionId),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.Section=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.sectionId=c.Long?c.Long.fromBits(0,0,!1):0,t.prototype.sectionGroup=null,Object.defineProperty(t.prototype,"sectionType",{get:c.oneOfGetter(e=["sectionId","sectionGroup"]),set:c.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.sectionId&&t.hasOwnProperty("sectionId")&&e.uint32(8).int64(t.sectionId),null!=t.sectionGroup&&t.hasOwnProperty("sectionGroup")&&l.tensorflow.magenta.NoteSequence.SectionGroup.encode(t.sectionGroup,e.uint32(18).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.Section;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.sectionId=c.Long?t.int64().toNumber():t.int64();break;case 2:i.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.decode(t,t.uint32());break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.sectionId&&t.hasOwnProperty("sectionId")&&(e.sectionType=1,!(c.isInteger(t.sectionId)||t.sectionId&&c.isInteger(t.sectionId.low)&&c.isInteger(t.sectionId.high))))return"sectionId: integer|Long expected";if(null!=t.sectionGroup&&t.hasOwnProperty("sectionGroup")){if(1===e.sectionType)return"sectionType: multiple values";e.sectionType=1;var n=l.tensorflow.magenta.NoteSequence.SectionGroup.verify(t.sectionGroup);if(n)return"sectionGroup."+n}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.Section)return t;var e=new l.tensorflow.magenta.NoteSequence.Section;if(null!=t.sectionId&&(c.Long?(e.sectionId=c.Long.fromValue(t.sectionId)).unsigned=!1:"string"==typeof t.sectionId?e.sectionId=parseInt(t.sectionId,10):"number"==typeof t.sectionId?e.sectionId=t.sectionId:"object"==typeof t.sectionId&&(e.sectionId=new c.LongBits(t.sectionId.low>>>0,t.sectionId.high>>>0).toNumber())),null!=t.sectionGroup){if("object"!=typeof t.sectionGroup)throw TypeError(".tensorflow.magenta.NoteSequence.Section.sectionGroup: object expected");e.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(t.sectionGroup)}return e},t.toObject=function(t,e){e||(e={});var n={};return null!=t.sectionId&&t.hasOwnProperty("sectionId")&&("number"==typeof t.sectionId?n.sectionId=e.longs===String?String(t.sectionId):t.sectionId:n.sectionId=e.longs===String?c.Long.prototype.toString.call(t.sectionId):e.longs===Number?new c.LongBits(t.sectionId.low>>>0,t.sectionId.high>>>0).toNumber():t.sectionId,e.oneofs&&(n.sectionType="sectionId")),null!=t.sectionGroup&&t.hasOwnProperty("sectionGroup")&&(n.sectionGroup=l.tensorflow.magenta.NoteSequence.SectionGroup.toObject(t.sectionGroup,e),e.oneofs&&(n.sectionType="sectionGroup")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t.SectionGroup=function(){function t(t){if(this.sections=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.sections=c.emptyArray,t.prototype.numTimes=0,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.sections&&t.sections.length)for(var n=0;n<t.sections.length;++n)l.tensorflow.magenta.NoteSequence.Section.encode(t.sections[n],e.uint32(10).fork()).ldelim();return null!=t.numTimes&&t.hasOwnProperty("numTimes")&&e.uint32(16).int32(t.numTimes),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.NoteSequence.SectionGroup;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.sections&&i.sections.length||(i.sections=[]),i.sections.push(l.tensorflow.magenta.NoteSequence.Section.decode(t,t.uint32()));break;case 2:i.numTimes=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.sections&&t.hasOwnProperty("sections")){if(!Array.isArray(t.sections))return"sections: array expected";for(var e=0;e<t.sections.length;++e){var n=l.tensorflow.magenta.NoteSequence.Section.verify(t.sections[e]);if(n)return"sections."+n}}return null!=t.numTimes&&t.hasOwnProperty("numTimes")&&!c.isInteger(t.numTimes)?"numTimes: integer expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.NoteSequence.SectionGroup)return t;var e=new l.tensorflow.magenta.NoteSequence.SectionGroup;if(t.sections){if(!Array.isArray(t.sections))throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: array expected");e.sections=[];for(var n=0;n<t.sections.length;++n){if("object"!=typeof t.sections[n])throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: object expected");e.sections[n]=l.tensorflow.magenta.NoteSequence.Section.fromObject(t.sections[n])}}return null!=t.numTimes&&(e.numTimes=0|t.numTimes),e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.sections=[]),e.defaults&&(n.numTimes=0),t.sections&&t.sections.length){n.sections=[];for(var i=0;i<t.sections.length;++i)n.sections[i]=l.tensorflow.magenta.NoteSequence.Section.toObject(t.sections[i],e)}return null!=t.numTimes&&t.hasOwnProperty("numTimes")&&(n.numTimes=t.numTimes),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),t}(),i.SequenceMetadata=function(){function t(t){if(this.genre=[],this.composers=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.title="",t.prototype.artist="",t.prototype.genre=c.emptyArray,t.prototype.composers=c.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=a.create()),null!=t.title&&t.hasOwnProperty("title")&&e.uint32(10).string(t.title),null!=t.artist&&t.hasOwnProperty("artist")&&e.uint32(18).string(t.artist),null!=t.genre&&t.genre.length)for(var n=0;n<t.genre.length;++n)e.uint32(26).string(t.genre[n]);if(null!=t.composers&&t.composers.length)for(n=0;n<t.composers.length;++n)e.uint32(34).string(t.composers[n]);return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.SequenceMetadata;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.title=t.string();break;case 2:i.artist=t.string();break;case 3:i.genre&&i.genre.length||(i.genre=[]),i.genre.push(t.string());break;case 4:i.composers&&i.composers.length||(i.composers=[]),i.composers.push(t.string());break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.title&&t.hasOwnProperty("title")&&!c.isString(t.title))return"title: string expected";if(null!=t.artist&&t.hasOwnProperty("artist")&&!c.isString(t.artist))return"artist: string expected";if(null!=t.genre&&t.hasOwnProperty("genre")){if(!Array.isArray(t.genre))return"genre: array expected";for(var e=0;e<t.genre.length;++e)if(!c.isString(t.genre[e]))return"genre: string[] expected"}if(null!=t.composers&&t.hasOwnProperty("composers")){if(!Array.isArray(t.composers))return"composers: array expected";for(e=0;e<t.composers.length;++e)if(!c.isString(t.composers[e]))return"composers: string[] expected"}return null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.SequenceMetadata)return t;var e=new l.tensorflow.magenta.SequenceMetadata;if(null!=t.title&&(e.title=String(t.title)),null!=t.artist&&(e.artist=String(t.artist)),t.genre){if(!Array.isArray(t.genre))throw TypeError(".tensorflow.magenta.SequenceMetadata.genre: array expected");e.genre=[];for(var n=0;n<t.genre.length;++n)e.genre[n]=String(t.genre[n])}if(t.composers){if(!Array.isArray(t.composers))throw TypeError(".tensorflow.magenta.SequenceMetadata.composers: array expected");for(e.composers=[],n=0;n<t.composers.length;++n)e.composers[n]=String(t.composers[n])}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.genre=[],n.composers=[]),e.defaults&&(n.title="",n.artist=""),null!=t.title&&t.hasOwnProperty("title")&&(n.title=t.title),null!=t.artist&&t.hasOwnProperty("artist")&&(n.artist=t.artist),t.genre&&t.genre.length){n.genre=[];for(var i=0;i<t.genre.length;++i)n.genre[i]=t.genre[i]}if(t.composers&&t.composers.length)for(n.composers=[],i=0;i<t.composers.length;++i)n.composers[i]=t.composers[i];return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),i.VelocityRange=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.min=0,t.prototype.max=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=a.create()),null!=t.min&&t.hasOwnProperty("min")&&e.uint32(8).int32(t.min),null!=t.max&&t.hasOwnProperty("max")&&e.uint32(16).int32(t.max),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof o||(t=o.create(t));for(var n=void 0===e?t.len:t.pos+e,i=new l.tensorflow.magenta.VelocityRange;t.pos<n;){var r=t.uint32();switch(r>>>3){case 1:i.min=t.int32();break;case 2:i.max=t.int32();break;default:t.skipType(7&r)}}return i},t.decodeDelimited=function(t){return t instanceof o||(t=new o(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.min&&t.hasOwnProperty("min")&&!c.isInteger(t.min)?"min: integer expected":null!=t.max&&t.hasOwnProperty("max")&&!c.isInteger(t.max)?"max: integer expected":null},t.fromObject=function(t){if(t instanceof l.tensorflow.magenta.VelocityRange)return t;var e=new l.tensorflow.magenta.VelocityRange;return null!=t.min&&(e.min=0|t.min),null!=t.max&&(e.max=0|t.max),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.min=0,n.max=0),null!=t.min&&t.hasOwnProperty("min")&&(n.min=t.min),null!=t.max&&t.hasOwnProperty("max")&&(n.max=t.max),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},t}(),i),r),t.exports=l},function(t,e,n){"use strict";n.r(e),n.d(e,"converterFromSpec",(function(){return u})),n.d(e,"DataConverter",(function(){return h})),n.d(e,"DrumsConverter",(function(){return d})),n.d(e,"DrumRollConverter",(function(){return p})),n.d(e,"DrumsOneHotConverter",(function(){return f})),n.d(e,"MelodyConverter",(function(){return m})),n.d(e,"MelodyRhythmConverter",(function(){return v})),n.d(e,"MelodyShapeConverter",(function(){return y})),n.d(e,"TrioConverter",(function(){return x})),n.d(e,"TrioRhythmConverter",(function(){return b})),n.d(e,"MultitrackConverter",(function(){return w})),n.d(e,"GrooveConverter",(function(){return S}));var i=n(2),r=n(10),s=n(8);n.d(e,"DEFAULT_DRUM_PITCH_CLASSES",(function(){return s.DEFAULT_DRUM_PITCH_CLASSES}));var o=n(12),a=n(23),c=n(29),l=n(13);function u(t){switch(t.type){case"MelodyConverter":return new m(t.args);case"MelodyRhythmConverter":return new v(t.args);case"MelodyShapeConverter":return new y(t.args);case"DrumsConverter":return new d(t.args);case"DrumRollConverter":return new p(t.args);case"TrioConverter":return new x(t.args);case"TrioRhythmConverter":return new b(t.args);case"DrumsOneHotConverter":return new f(t.args);case"MultitrackConverter":return new w(t.args);case"GrooveConverter":return new S(t.args);default:throw new Error("Unknown DataConverter type: "+t)}}class h{constructor(t){this.NUM_SPLITS=0,this.SEGMENTED_BY_TRACK=!1,this.numSteps=t.numSteps,this.numSegments=t.numSegments}tensorSteps(t){return i.scalar(t.shape[0],"int32")}}class d extends h{constructor(t){super(t),this.pitchClasses=t.pitchClasses||s.DEFAULT_DRUM_PITCH_CLASSES,this.pitchToClass=new Map;for(let e=0;e<this.pitchClasses.length;++e)this.pitchClasses[e].forEach((t=>{this.pitchToClass.set(t,e)}));this.depth=this.pitchClasses.length+1}toTensor(t){l.assertIsQuantizedSequence(t);const e=this.numSteps||t.totalQuantizedSteps,n=i.buffer([e,this.pitchClasses.length+1],"int32");for(let i=0;i<e;++i)n.set(1,i,-1);return t.notes.forEach((t=>{n.set(1,t.quantizedStartStep,this.pitchToClass.get(t.pitch)),n.set(0,t.quantizedStartStep,-1)})),n.toTensor()}async toNoteSequence(t,e,n){const i=l.createQuantizedNoteSequence(e,n),s=t.argMax(1),o=await s.data();s.dispose();for(let a=0;a<o.length;++a)for(let t=0;t<this.pitchClasses.length;t++)o[a]>>t&1&&i.notes.push(r.a.Note.create({pitch:this.pitchClasses[t][0],quantizedStartStep:a,quantizedEndStep:a+1,isDrum:!0}));return i.totalQuantizedSteps=o.length,i}}class p extends d{async toNoteSequence(t,e,n){const i=l.createQuantizedNoteSequence(e,n),s=await t.data();for(let o=0;o<t.shape[0];++o){const t=s.slice(o*this.pitchClasses.length,(o+1)*this.pitchClasses.length);for(let e=0;e<t.length;++e)t[e]&&i.notes.push(r.a.Note.create({pitch:this.pitchClasses[e][0],quantizedStartStep:o,quantizedEndStep:o+1,isDrum:!0}))}return i.totalQuantizedSteps=t.shape[0],i}}class f extends d{constructor(t){super(t),this.depth=Math.pow(2,this.pitchClasses.length)}toTensor(t){l.assertIsRelativeQuantizedSequence(t);const e=this.numSteps||t.totalQuantizedSteps,n=Array(e).fill(0);for(const{pitch:i,quantizedStartStep:r}of t.notes)n[r]+=Math.pow(2,this.pitchToClass.get(i));return i.tidy((()=>i.oneHot(i.tensor1d(n,"int32"),this.depth)))}}class m extends h{constructor(t){super(t),this.NOTE_OFF=1,this.FIRST_PITCH=2,this.minPitch=t.minPitch,this.maxPitch=t.maxPitch,this.ignorePolyphony=t.ignorePolyphony,this.depth=t.maxPitch-t.minPitch+1+this.FIRST_PITCH}toTensor(t){const e=a.Melody.fromNoteSequence(t,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return i.tidy((()=>i.oneHot(i.tensor(e.events,[e.events.length],"int32"),this.depth)))}async toNoteSequence(t,e,n){const i=t.argMax(1),r=await i.data();return i.dispose(),new a.Melody(r,this.minPitch,this.maxPitch).toNoteSequence(e,n)}}class g extends h{constructor(t,e){super(t),this.minPitch=t.minPitch,this.maxPitch=t.maxPitch,this.ignorePolyphony=t.ignorePolyphony,this.melodyControl=e,this.depth=e.depth}toTensor(t){const e=a.Melody.fromNoteSequence(t,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return this.melodyControl.extract(e)}}class v extends g{constructor(t){super(t,new a.MelodyRhythm)}async toNoteSequence(t,e,n){const i=l.createQuantizedNoteSequence(e,n),o=await t.data();for(let a=0;a<o.length;++a)o[a]&&i.notes.push(r.a.Note.create({pitch:s.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:a,quantizedEndStep:a+1,isDrum:!0}));return i.totalQuantizedSteps=o.length,i}}class y extends g{constructor(t){super(t,new a.MelodyShape)}async toNoteSequence(t,e,n){const i=l.createQuantizedNoteSequence(e,n),s=t.argMax(1),a=await s.data();s.dispose();let c=Math.round((this.maxPitch+this.minPitch)/2);for(let l=0;l<a.length;++l){switch(a[l]){case 0:c-=1,c<this.minPitch&&(c=this.minPitch,o.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter"));break;case 2:c+=1,c>this.maxPitch&&(c=this.maxPitch,o.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter"))}i.notes.push(r.a.Note.create({pitch:c,quantizedStartStep:l,quantizedEndStep:l+1}))}return i.totalQuantizedSteps=a.length,i}}class x extends h{constructor(t){super(t),this.NUM_SPLITS=3,this.MEL_PROG_RANGE=[0,31],this.BASS_PROG_RANGE=[32,39],t.melArgs.numSteps=t.numSteps,t.bassArgs.numSteps=t.numSteps,t.drumsArgs.numSteps=t.numSteps,this.melConverter=new m(t.melArgs),this.bassConverter=new m(t.bassArgs),this.drumsConverter=new f(t.drumsArgs),this.depth=this.melConverter.depth+this.bassConverter.depth+this.drumsConverter.depth}toTensor(t){l.assertIsQuantizedSequence(t);const e=l.clone(t),n=l.clone(t),r=l.clone(t);return e.notes=t.notes.filter((t=>!t.isDrum&&t.program>=this.MEL_PROG_RANGE[0]&&t.program<=this.MEL_PROG_RANGE[1])),n.notes=t.notes.filter((t=>!t.isDrum&&t.program>=this.BASS_PROG_RANGE[0]&&t.program<=this.BASS_PROG_RANGE[1])),r.notes=t.notes.filter((t=>t.isDrum)),i.tidy((()=>i.concat([this.melConverter.toTensor(e),this.bassConverter.toTensor(n),this.drumsConverter.toTensor(r)],-1)))}async toNoteSequence(t,e,n){const r=i.split(t,[this.melConverter.depth,this.bassConverter.depth,this.drumsConverter.depth],-1),s=await this.melConverter.toNoteSequence(r[0],e,n);s.notes.forEach((t=>{t.instrument=0,t.program=0}));const o=await this.bassConverter.toNoteSequence(r[1],e,n);s.notes.push(...o.notes.map((t=>(t.instrument=1,t.program=this.BASS_PROG_RANGE[0],t))));const a=await this.drumsConverter.toNoteSequence(r[2],e,n);return s.notes.push(...a.notes.map((t=>(t.instrument=2,t)))),r.forEach((t=>t.dispose())),s}}class b extends h{constructor(t){super(t),this.NUM_SPLITS=3,this.trioConverter=new x(t),this.depth=3}toTensor(t){return i.tidy((()=>{const e=this.trioConverter.toTensor(t),n=i.split(e,[this.trioConverter.melConverter.depth,this.trioConverter.bassConverter.depth,this.trioConverter.drumsConverter.depth],1),r=i.argMax(n[0],1),s=i.argMax(n[1],1),o=i.argMax(n[2],1),a=i.greater(r,1),c=i.greater(s,1),l=i.greater(o,0);return i.stack([a,c,l],1)}))}async toNoteSequence(t,e,n){const o=i.split(t,3,1),a=await Promise.all(o.map((t=>t.data()))),c=l.createQuantizedNoteSequence(e,n);for(let i=0;i<this.numSteps;++i)a[0][i]&&c.notes.push(r.a.Note.create({pitch:72,quantizedStartStep:i,quantizedEndStep:i+1,instrument:0,program:0})),a[1][i]&&c.notes.push(r.a.Note.create({pitch:36,quantizedStartStep:i,quantizedEndStep:i+1,instrument:1,program:32})),a[2][i]&&c.notes.push(r.a.Note.create({pitch:s.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:i,quantizedEndStep:i+1,instrument:2,isDrum:!0}));return c.totalQuantizedSteps=this.numSteps,c}}class w extends h{constructor(t){super(t),this.SEGMENTED_BY_TRACK=!0,this.stepsPerQuarter=t.stepsPerQuarter,this.totalSteps=t.totalSteps,this.numVelocityBins=t.numVelocityBins,this.minPitch=t.minPitch?t.minPitch:s.MIN_MIDI_PITCH,this.maxPitch=t.maxPitch?t.maxPitch:s.MAX_MIDI_PITCH,this.numPitches=this.maxPitch-this.minPitch+1,this.performanceEventDepth=2*this.numPitches+this.totalSteps+this.numVelocityBins,this.numPrograms=s.MAX_MIDI_PROGRAM-s.MIN_MIDI_PROGRAM+2,this.endToken=this.performanceEventDepth+this.numPrograms,this.depth=this.endToken+1,this.endTensor=i.tidy((()=>i.oneHot(i.tensor1d([this.endToken],"int32"),this.depth).as1D()))}trackToTensor(t){const e=this.numSteps/this.numSegments;let n;if(t){for(;t.events.length>e-2;)t.events.pop();n=i.buffer([t.events.length+2],"int32"),n.set(this.performanceEventDepth+(t.isDrum?this.numPrograms-1:t.program),0),t.events.forEach(((t,e)=>{switch(t.type){case"note-on":n.set(t.pitch-this.minPitch,e+1);break;case"note-off":n.set(this.numPitches+t.pitch-this.minPitch,e+1);break;case"time-shift":n.set(2*this.numPitches+t.steps-1,e+1);break;case"velocity-change":n.set(2*this.numPitches+this.totalSteps+t.velocityBin-1,e+1);break;default:throw new Error("Unrecognized performance event: "+t)}})),n.set(this.endToken,t.events.length+1)}else n=i.buffer([1],"int32",new Int32Array([this.endToken]));return i.tidy((()=>{const t=i.oneHot(n.toTensor(),this.depth);return t.pad([[0,e-t.shape[0]],[0,0]])}))}toTensor(t){if(l.assertIsRelativeQuantizedSequence(t),t.quantizationInfo.stepsPerQuarter!==this.stepsPerQuarter)throw new Error("Steps per quarter note mismatch: ".concat(t.quantizationInfo.stepsPerQuarter," != ").concat(this.stepsPerQuarter));const e=l.clone(t);e.notes=t.notes.filter((t=>t.pitch>=this.minPitch&&t.pitch<=this.maxPitch));const n=new Set(e.notes.map((t=>t.instrument))),r=Array.from(n).map((t=>c.Performance.fromNoteSequence(e,this.totalSteps,this.numVelocityBins,t))).sort(((t,e)=>e.isDrum?-1:t.isDrum?1:t.program-e.program));for(;r.length>this.numSegments;)r.pop();for(r.forEach((t=>t.setNumSteps(this.totalSteps)));r.length<this.numSegments;)r.push(void 0);return i.tidy((()=>i.concat(r.map((t=>this.trackToTensor(t))),0)))}tokensToTrack(t){const e=t.indexOf(this.endToken),n=e>=0?e:t.length,i=t.slice(0,n),r=i.filter((t=>t<this.performanceEventDepth)),s=i.filter((t=>t>=this.performanceEventDepth)),[o,a]=s.length?s[0]-this.performanceEventDepth<this.numPrograms-1?[s[0]-this.performanceEventDepth,!1]:[0,!0]:[0,!1],l=Array.from(r).map((t=>{if(t<this.numPitches)return{type:"note-on",pitch:this.minPitch+t};if(t<2*this.numPitches)return{type:"note-off",pitch:this.minPitch+t-this.numPitches};if(t<2*this.numPitches+this.totalSteps)return{type:"time-shift",steps:t-2*this.numPitches+1};if(t<2*this.numPitches+this.totalSteps+this.numVelocityBins)return{type:"velocity-change",velocityBin:t-2*this.numPitches-this.totalSteps+1};throw new Error("Invalid performance event token: "+t)}));return new c.Performance(l,this.totalSteps,this.numVelocityBins,o,a)}async toNoteSequence(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stepsPerQuarter,n=arguments.length>2?arguments[2]:void 0;const r=l.createQuantizedNoteSequence(e,n);r.totalQuantizedSteps=this.totalSteps;const s=i.tidy((()=>i.split(t.argMax(1),this.numSegments)));return(await Promise.all(s.map((async t=>{const e=await t.data(),n=this.tokensToTrack(e);return t.dispose(),n})))).forEach(((t,e)=>{t.setNumSteps(this.totalSteps),r.notes.push(...t.toNoteSequence(e).notes)})),r}}class S extends h{constructor(t){super(t),this.TAPIFY_CHANNEL=3,this.stepsPerQuarter=t.stepsPerQuarter||s.DEFAULT_STEPS_PER_QUARTER,this.pitchClasses=t.pitchClasses||s.DEFAULT_DRUM_PITCH_CLASSES,this.pitchToClass=new Map;for(let e=0;e<this.pitchClasses.length;++e)this.pitchClasses[e].forEach((t=>{this.pitchToClass.set(t,e)}));this.humanize=t.humanize||!1,this.tapify=t.tapify||!1,this.splitInstruments=t.splitInstruments||!1,this.depth=3}toTensor(t){const e=l.isRelativeQuantizedSequence(t)?t:l.quantizeNoteSequence(t,this.stepsPerQuarter),n=this.numSteps,r=e.tempos&&e.tempos.length?e.tempos[0].qpm:s.DEFAULT_QUARTERS_PER_MINUTE,o=60/r/this.stepsPerQuarter,a=[];for(let i=0;i<n;++i)a.push(new Map);e.notes.forEach((t=>{if(!this.tapify&&!this.pitchToClass.has(t.pitch))return;const e=t.quantizedStartStep;if(e>=a.length)throw Error("Model does not support sequences with more than ".concat(n," steps (").concat(n*o," seconds at qpm ").concat(r,")."));const i=this.tapify?this.TAPIFY_CHANNEL:this.pitchToClass.get(t.pitch);(!a[e].has(i)||a[e].get(i).velocity<t.velocity)&&a[e].set(i,t)}));const c=this.pitchClasses.length,u=i.buffer([n,c]),h=i.buffer([n,c]),d=i.buffer([n,c]);function p(t){if(void 0===t.startTime)return 0;const e=t.startTime;return 2*(t.quantizedStartStep*o-e)/o}for(let i=0;i<n;++i)for(let t=0;t<c;++t){const e=a[i].get(t);u.set(e?1:0,i,t),this.humanize||this.tapify||h.set(e?e.velocity/s.MAX_MIDI_VELOCITY:0,i,t),this.humanize||d.set(e?p(e):0,i,t)}return i.tidy((()=>{const t=u.toTensor(),e=h.toTensor(),r=d.toTensor(),s=this.splitInstruments?n*c:n;return i.concat([t.as2D(s,-1),e.as2D(s,-1),r.as2D(s,-1)],1)}))}async toNoteSequence(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.DEFAULT_QUARTERS_PER_MINUTE;if(e&&e!==this.stepsPerQuarter)throw Error("`stepsPerQuarter` is set by the model.");e=this.stepsPerQuarter;const i=this.splitInstruments?t.shape[0]/this.pitchClasses.length:t.shape[0],o=60/n/this.stepsPerQuarter,a=r.a.create({totalTime:i*o,tempos:[{qpm:n}]}),c=await t.data();function l(t,e,n){return Math.min(Math.max(t,e),n)}const u=this.pitchClasses.length;for(let h=0;h<i;++h){const t=c.slice(h*u*this.depth,(h+1)*u*this.depth);for(let e=0;e<u;++e){const n=t[this.splitInstruments?e*this.depth:e],i=t[this.splitInstruments?e*this.depth+1:u+e],c=t[this.splitInstruments?e*this.depth+2:2*u+e];if(n>.5){const t=l(Math.round(i*s.MAX_MIDI_VELOCITY),s.MIN_MIDI_VELOCITY,s.MAX_MIDI_VELOCITY),n=l(c/2,-.5,.5);a.notes.push(r.a.Note.create({pitch:this.pitchClasses[e][0],startTime:(h-n)*o,endTime:(h-n+1)*o,velocity:t,isDrum:!0}))}}}return a}}},function(t,e,n){"use strict";n.r(e),n.d(e,"ChordQuality",(function(){return gt})),n.d(e,"ChordSymbolException",(function(){return vt})),n.d(e,"ChordEncodingException",(function(){return yt})),n.d(e,"ChordSymbols",(function(){return xt})),n.d(e,"ChordEncoder",(function(){return bt})),n.d(e,"chordEncoderFromType",(function(){return wt})),n.d(e,"MajorMinorChordEncoder",(function(){return St})),n.d(e,"TriadChordEncoder",(function(){return _t})),n.d(e,"PitchChordEncoder",(function(){return Tt}));var i={};n.r(i),n.d(i,"names",(function(){return a})),n.d(i,"tokenize",(function(){return h})),n.d(i,"props",(function(){return f})),n.d(i,"name",(function(){return m})),n.d(i,"pc",(function(){return g})),n.d(i,"midi",(function(){return v})),n.d(i,"midiToFreq",(function(){return y})),n.d(i,"freq",(function(){return x})),n.d(i,"freqToMidi",(function(){return S})),n.d(i,"chroma",(function(){return _})),n.d(i,"oct",(function(){return T})),n.d(i,"stepToLetter",(function(){return E})),n.d(i,"altToAcc",(function(){return k})),n.d(i,"from",(function(){return A})),n.d(i,"build",(function(){return I})),n.d(i,"fromMidi",(function(){return O})),n.d(i,"simplify",(function(){return R})),n.d(i,"enharmonic",(function(){return N}));var r={};n.r(r),n.d(r,"names",(function(){return rt})),n.d(r,"props",(function(){return ot})),n.d(r,"intervals",(function(){return at})),n.d(r,"notes",(function(){return ct})),n.d(r,"exists",(function(){return lt})),n.d(r,"supersets",(function(){return ut})),n.d(r,"subsets",(function(){return ht})),n.d(r,"tokenize",(function(){return pt}));var s=n(2),o="C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B".split(" "),a=function(t){return"string"!=typeof t?o.slice():o.filter((function(e){var n=e[1]||" ";return-1!==t.indexOf(n)}))},c=a(" #"),l=a(" b"),u=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function h(t){"string"!=typeof t&&(t="");var e=u.exec(t);return[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]}var d=Object.freeze({pc:null,name:null,step:null,alt:null,oct:null,octStr:null,chroma:null,midi:null,freq:null}),p=[0,2,4,5,7,9,11],f=function(t,e){return void 0===e&&(e={}),function(t){return e[t]||(e[t]=function(t){var e=h(t);if(""===e[0]||""!==e[3])return d;var n=e[0],i=e[1],r=e[2],s={letter:n,acc:i,octStr:r,pc:n+i,name:n+i+r,step:(n.charCodeAt(0)+3)%7,alt:"b"===i[0]?-i.length:i.length,oct:r.length?+r:null,chroma:0,midi:null,freq:null};return s.chroma=(p[s.step]+s.alt+120)%12,s.midi=null!==s.oct?p[s.step]+s.alt+12*(s.oct+1):null,s.freq=y(s.midi),Object.freeze(s)}(t))}}(),m=function(t){return f(t).name},g=function(t){return f(t).pc},v=function(t){if("number"!=typeof t&&"string"!=typeof t)return null;var e,n=f(t).midi,i=n||0===n?n:+t;return(e=i)>=0&&e<=127?i:null},y=function(t,e){return void 0===e&&(e=440),"number"==typeof t?Math.pow(2,(t-69)/12)*e:null},x=function(t){return f(t).freq||y(t)},b=Math.log(2),w=Math.log(440),S=function(t){var e=12*(Math.log(t)-w)/b+69;return Math.round(100*e)/100},_=function(t){return f(t).chroma},T=function(t){return f(t).oct},E=function(t){return"CDEFGAB"[t]},C=function(t,e){return Array(e+1).join(t)},k=function(t){return function(t,e){return"number"!=typeof t?"":function(t){return t<0?C("b",-t):C("#",t)}(t)}(t)},A=function(t,e){void 0===t&&(t={}),void 0===e&&(e=null);var n=e?Object.assign({},f(e),t):t,i=n.step,r=n.alt,s=n.oct;if("number"!=typeof i)return null;var o=E(i);if(!o)return null;var a=o+k(r);return s||0===s?a+s:a},I=A;function O(t,e){return void 0===e&&(e=!1),t=Math.round(t),(!0===e?c:l)[t%12]+(Math.floor(t/12)-1)}var R=function(t,e){void 0===e&&(e=!0);var n=f(t),i=n.alt,r=n.chroma,s=n.midi;if(null===r)return null;var o=!1===e?i<0:i>0;return null===s?g(O(r,o)):O(s,o)},N=function(t){return R(t,!1)},M=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),D=[0,2,4,5,7,9,11],P=("1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P".split(" "),Object.freeze({name:null,num:null,q:null,step:null,alt:null,dir:null,type:null,simple:null,semitones:null,chroma:null,oct:null})),F=function(t){var e=function(t){var e=M.exec(""+t);return null===e?null:e[1]?[e[1],e[2]]:[e[4],e[3]]}(t);if(null===e)return P;var n,i,r={num:0,q:"d",name:"",type:"M",step:0,dir:-1,simple:1,alt:0,oct:0,semitones:0,chroma:0,ic:0};return r.num=+e[0],r.q=e[1],r.step=function(t){return(Math.abs(t)-1)%7}(r.num),r.type="PMMPPMM"[r.step],"M"===r.type&&"P"===r.q?P:(r.name=""+r.num+r.q,r.dir=r.num<0?-1:1,r.simple=8===r.num||-8===r.num?r.num:r.dir*(r.step+1),r.alt=(n=r.type,"M"===(i=r.q)&&"M"===n||"P"===i&&"P"===n?0:"m"===i&&"M"===n?-1:/^A+$/.test(i)?i.length:/^d+$/.test(i)?"P"===n?-i.length:-i.length-1:null),r.oct=Math.floor((Math.abs(r.num)-1)/7),r.semitones=r.dir*(D[r.step]+r.alt+12*r.oct),r.chroma=(r.dir*(D[r.step]+r.alt)%12+12)%12,Object.freeze(r))},L={};function B(t){return"string"!=typeof t?P:L[t]||(L[t]=F(t))}"P m M m M P d P m M m M".split(" ");var z=[0,2,4,-1,1,3,5],U=z.map((function(t){return Math.floor(7*t/12)})),j=[3,0,4,1,5,2,6],V=function(t,e,n){var i=j[function(t){var e=(t+1)%7;return e<0?7+e:e}(t)],r=Math.floor((t+1)/7);return void 0===e?{step:i,alt:r,dir:n}:{step:i,alt:r,oct:e+4*r+U[i],dir:n}},W=function(t){return function(t,e){return void 0===e&&(e={}),function(n){return e[n]||(e[n]=t(n))}}((function(e){var n=t(e);return null===n.name?null:function(t){var e=t.step,n=t.alt,i=t.oct,r=t.dir;void 0===r&&(r=1);var s=z[e]+7*n;return null===i?[r*s]:[r*s,r*(i-U[e]-4*n)]}(n)}))},G=W(f),q=W(B);function H(t,e){if(1===arguments.length)return function(e){return H(t,e)};var n=G(t),i=q(e);if(null===n||null===i)return null;var r=1===n.length?[n[0]+i[0]]:[n[0]+i[0],n[1]+i[1]];return I(V(r[0],r[1]))}var X=n(64),Y=n(65),K=function(t){return _(t)||function(t){return B(t).chroma}(t)||0},Q=function(t){return parseInt(Z(t),2)};function Z(t){if(function(t){return J.test(t)}(t))return t;if(!Array.isArray(t))return"";var e=[0,0,0,0,0,0,0,0,0,0,0,0];return t.map(K).forEach((function(t){e[t]=1})),e.join("")}var J=/^[01]{12}$/;function $(t,e){return arguments.length>1?$(t)(e):(t=Q(t),function(e){return(e=Q(e))!==t&&(e&t)===e})}function tt(t,e){return arguments.length>1?tt(t)(e):(t=Q(t),function(e){return(e=Q(e))!==t&&(e|t)===e})}"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M".split(" ");var et=function(t){var e=Object.keys(t).sort(),n=[],i=[],r=function(t,e,r){n[t]=e,i[r]=i[r]||[],i[r].push(t)};e.forEach((function(e){var n=t[e][0].split(" "),i=t[e][1],s=Z(n);r(e,n,s),i&&i.forEach((function(t){return r(t,n,s)}))}));var s=Object.keys(n).sort(),o=function(t){return n[t]};return o.names=function(t){return"string"==typeof t?(i[t]||[]).slice():(!0===t?s:e).slice()},o},nt=et(X),it=et(Y);Object.freeze({name:null,intervals:[],names:[],chroma:null,setnum:null}),nt.names;var rt=it.names,st=Object.freeze({name:null,names:[],intervals:[],chroma:null,setnum:null}),ot=function(t,e){return void 0===e&&(e={}),function(t){return e[t]||(e[t]=function(t){var e=it(t);if(!e)return st;var n={intervals:e,name:t};return n.chroma=Z(e),n.setnum=parseInt(n.chroma,2),n.names=it.names(n.chroma),n}(t))}}(),at=function(t){return ot(pt(t)[1]).intervals};function ct(t,e){if(e)return ot(e).intervals.map(H(t));var n=pt(t),i=n[0],r=n[1];return ot(r).intervals.map(H(i))}var lt=function(t){return void 0!==it(pt(t)[1])},ut=function(t){if(!at(t).length)return[];var e=tt(at(t));return it.names().filter((function(t){return e(it(t))}))},ht=function(t){var e=$(at(t));return it.names().filter((function(t){return e(it(t))}))},dt=/^(6|64|7|9|11|13)$/;function pt(t){var e=h(t);return""===e[0]?["",t]:"A"===e[0]&&"ug"===e[3]?["","aug"]:dt.test(e[2])?[e[0]+e[1],e[2]+e[3]]:[e[0]+e[1]+e[2],e[3]]}var ft=n(8);const mt=[["1P","3M","5P"],["1P","3m","5P"],["1P","3M","5A"],["1P","3m","5d"]];var gt;!function(t){t[t.Major=0]="Major",t[t.Minor=1]="Minor",t[t.Augmented=2]="Augmented",t[t.Diminished=3]="Diminished",t[t.Other=4]="Other"}(gt||(gt={}));class vt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class yt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}class xt{static pitches(t){if(!r.tokenize(t)[0]||!r.exists(t))throw new vt("Unrecognized chord symbol: "+t);return r.notes(t).map(i.chroma)}static root(t){const e=r.tokenize(t)[0];if(!e)throw new vt("Chord symbol has unknown root: "+t);return i.chroma(e)}static quality(t){if(!r.exists(t))throw new vt("Unrecognized chord symbol: "+t);const e=r.intervals(t),n=mt.map((t=>t.every((t=>e.includes(t))))),i=n.indexOf(!0),s=n.lastIndexOf(!0);return i>=0&&i===s?i:gt.Other}}class bt{encodeProgression(t,e){const n=t.map((t=>this.encode(t))),i=Array.from(Array(e).keys()).map((t=>Math.floor(t*n.length/e)));return s.stack(i.map((t=>n[t])))}}function wt(t){switch(t){case"MajorMinorChordEncoder":return new St;case"TriadChordEncoder":return new _t;case"PitchChordEncoder":return new Tt;default:throw new Error("Unknown chord encoder type: "+t)}}class St extends bt{constructor(){super(...arguments),this.depth=1+2*ft.NUM_PITCH_CLASSES}index(t){if(t===ft.NO_CHORD)return 0;const e=xt.root(t),n=1+xt.quality(t)*ft.NUM_PITCH_CLASSES+e;if(n>=this.depth)throw new yt("Chord is neither major nor minor: "+t);return n}encode(t){return s.tidy((()=>s.oneHot(s.tensor1d([this.index(t)],"int32"),this.depth).as1D()))}}class _t extends bt{constructor(){super(...arguments),this.depth=1+4*ft.NUM_PITCH_CLASSES}index(t){if(t===ft.NO_CHORD)return 0;const e=xt.root(t),n=1+xt.quality(t)*ft.NUM_PITCH_CLASSES+e;if(n>=this.depth)throw new yt("Chord is not a standard triad: "+t);return n}encode(t){return s.tidy((()=>s.oneHot(s.tensor1d([this.index(t)],"int32"),this.depth).as1D()))}}class Tt extends bt{constructor(){super(...arguments),this.depth=1+3*ft.NUM_PITCH_CLASSES}encode(t){return s.tidy((()=>{if(t===ft.NO_CHORD)return s.oneHot(s.tensor1d([0],"int32"),this.depth).as1D();const e=xt.root(t),n=s.oneHot(s.tensor1d([e],"int32"),ft.NUM_PITCH_CLASSES).as1D(),i=s.buffer([ft.NUM_PITCH_CLASSES]);xt.pitches(t).forEach((t=>i.set(1,t)));const r=i.toTensor().as1D(),o=n;return s.concat1d([s.tensor1d([0]),n,r,o])}))}}},function(t,e,n){"use strict";(function(t){var e=n(46),i=n(11);const r=Object(i.b)();r.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),r.registerFlag("IS_BROWSER",(()=>e.isBrowser())),r.registerFlag("IS_NODE",(()=>void 0!==t&&void 0!==t.versions&&void 0!==t.versions.node)),r.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),r.registerFlag("PROD",(()=>!1)),r.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>r.getBool("DEBUG"))),r.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),r.registerFlag("IS_TEST",(()=>!1))}).call(this,n(44))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));class i{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class r{time(t){return s("time")}read(t){return s("read")}readSync(t){return s("readSync")}numDataIds(){return s("numDataIds")}disposeData(t){return s("disposeData")}write(t,e,n){return s("write")}move(t,e,n,i){return s("move")}memory(){return s("memory")}floatPrecision(){return s("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,i){return s("batchMatMul")}fusedBatchMatMul(t){let{a:e,b:n,transposeA:i,transposeB:r,bias:o,activation:a,preluActivationWeights:c}=t;return s("fusedBatchMatMul")}slice(t,e,n){return s("slice")}stridedSlice(t,e,n,i){return s("stridedSlice")}unstack(t,e){return s("unstack")}reverse(t,e){return s("reverse")}concat(t,e){return s("concat")}neg(t){return s("neg")}add(t,e){return s("add")}addN(t){return s("addN")}subtract(t,e){return s("subtract")}multiply(t,e){return s("multiply")}realDivide(t,e){return s("realDivide")}floorDiv(t,e){return s("floorDiv")}sum(t,e){return s("sum")}prod(t,e){return s("prod")}unsortedSegmentSum(t,e,n){return s("unsortedSegmentSum")}argMin(t,e){return s("argMin")}argMax(t,e){return s("argMax")}equal(t,e){return s("equal")}notEqual(t,e){return s("notEqual")}less(t,e){return s("less")}lessEqual(t,e){return s("lessEqual")}greater(t,e){return s("greater")}greaterEqual(t,e){return s("greaterEqual")}logicalNot(t){return s("logicalNot")}logicalAnd(t,e){return s("logicalAnd")}logicalOr(t,e){return s("logicalOr")}where(t){return s("where")}select(t,e,n){return s("select")}topk(t,e,n){return s("topk")}min(t,e){return s("min")}minimum(t,e){return s("minimum")}mod(t,e){return s("mod")}max(t,e){return s("max")}maximum(t,e){return s("maximum")}all(t,e){return s("all")}any(t,e){return s("any")}squaredDifference(t,e){return s("squaredDifference")}ceil(t){return s("ceil")}floor(t){return s("floor")}round(t){return s("round")}sign(t){return s("sign")}isNaN(t){return s("isNaN")}isInf(t){return s("isInf")}isFinite(t){return s("isFinite")}pow(t,e){return s("pow")}exp(t){return s("exp")}expm1(t){return s("expm1")}softmax(t,e){return s("softmax")}log(t){return s("log")}log1p(t){return s("log1p")}sqrt(t){return s("sqrt")}rsqrt(t){return s("rsqrt")}square(t){return s("square")}reciprocal(t){return s("reciprocal")}relu(t){return s("relu")}relu6(t){return s("relu6")}prelu(t,e){return s("prelu")}elu(t){return s("elu")}eluDer(t,e){return s("eluDer")}selu(t){return s("selu")}int(t){return s("int")}clip(t,e,n){return s("clip")}abs(t){return s("abs")}complexAbs(t){return s("complexAbs")}sigmoid(t){return s("sigmoid")}softplus(t){return s("softplus")}sin(t){return s("sin")}cos(t){return s("cos")}tan(t){return s("tan")}asin(t){return s("asin")}acos(t){return s("acos")}atan(t){return s("atan")}atan2(t,e){return s("atan2")}sinh(t){return s("sinh")}cosh(t){return s("cosh")}tanh(t){return s("tanh")}asinh(t){return s("asinh")}acosh(t){return s("acosh")}atanh(t){return s("atanh")}erf(t){return s("erf")}step(t,e){return s("step")}fusedConv2d(t){let{input:e,filter:n,convInfo:i,bias:r,activation:o,preluActivationWeights:a}=t;return s("fusedConv2d")}conv2d(t,e,n){return s("conv2d")}conv2dDerInput(t,e,n){return s("conv2dDerInput")}conv2dDerFilter(t,e,n){return s("conv2dDerFilter")}fusedDepthwiseConv2D(t){let{input:e,filter:n,convInfo:i,bias:r,activation:o,preluActivationWeights:a}=t;return s("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return s("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return s("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return s("depthwiseConv2DDerFilter")}conv3d(t,e,n){return s("conv3d")}conv3dDerInput(t,e,n){return s("conv3dDerInput")}conv3dDerFilter(t,e,n){return s("conv3dDerFilter")}maxPool(t,e){return s("maxPool")}maxPoolBackprop(t,e,n,i){return s("maxPoolBackprop")}avgPool(t,e){return s("avgPool")}avgPoolBackprop(t,e,n){return s("avgPoolBackprop")}avgPool3d(t,e){return s("avgPool3d")}avgPool3dBackprop(t,e,n){return s("avgPool3dBackprop")}maxPool3d(t,e){return s("maxPool3d")}maxPool3dBackprop(t,e,n,i){return s("maxPool3dBackprop")}reshape(t,e){return s("reshape")}cast(t,e){return s("cast")}tile(t,e){return s("tile")}pad(t,e,n){return s("pad")}transpose(t,e){return s("transpose")}gather(t,e,n){return s("gather")}gatherND(t,e){return s("gatherND")}scatterND(t,e,n){return s("scatterND")}batchToSpaceND(t,e,n){return s("batchToSpaceND")}spaceToBatchND(t,e,n){return s("spaceToBatchND")}resizeBilinear(t,e,n,i){return s("resizeBilinear")}resizeBilinearBackprop(t,e,n){return s("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,i){return s("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return s("resizeNearestNeighborBackprop")}batchNorm(t,e,n,i,r,o){return s("batchNorm")}localResponseNormalization4D(t,e,n,i,r){return s("localResponseNormalization4D")}LRNGrad(t,e,n,i,r,o,a){return s("LRNGrad")}multinomial(t,e,n,i){return s("multinomial")}oneHot(t,e,n,i){return s("oneHot")}cumsum(t,e,n,i){return s("cumsum")}nonMaxSuppression(t,e,n,i,r){return s("nonMaxSuppression")}fft(t){return s("fft")}ifft(t){return s("ifft")}complex(t,e){return s("complex")}real(t){return s("real")}imag(t){return s("imag")}cropAndResize(t,e,n,i,r,o){return s("cropAndResize")}depthToSpace(t,e,n){return s("depthToSpace")}split(t,e,n){return s("split")}sparseToDense(t,e,n,i){return s("sparseToDense")}diag(t){return s("diag")}fill(t,e,n){return s("fill")}onesLike(t){return s("onesLike")}zerosLike(t){return s("zerosLike")}linspace(t,e,n){return s("linspace")}dispose(){return s("dispose")}}function s(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen"))}},function(t,e,n){"use strict";(function(t,i){let r;function s(){if(null==r){let e;if("undefined"!=typeof window)e=window;else if(void 0!==t)e=t;else if(void 0!==i)e=i;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function o(t,e){const n=function(){const t=s();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const i=e();return n.set(t,i),n.get(t)}}n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return o}))}).call(this,n(21),n(44))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a}));var i=n(2),r=n(20),s=n(25);function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i.tidy((()=>{let n=i.mul(t,i.pow(2,e));return n=n.clipByValue(0,Object(r.g)(110).dataSync()[0]),n}))}function a(t,e,n){return t.splice(n),function(t,e){const n=[],i=Math.floor(e/t.length),r=e%t.length;for(let o=0;o<t.length;o++){n.push(t[o]);for(let t=1;t<i;t++)n.push(-1);o<r&&n.push(-1)}let s=-1;for(let o=0;o<n.length;o++)if(-1!==n[o]){let t=n[o];const e=s>=0?n[s]:0;-1!==s&&(t-=n[s]);for(let i=s+1;i<o;i++)n[i]=e+t*(i-s)/(o-s);s=o}for(let o=s+1;o<n.length;o++)n[o]=s>=0?n[o-1]:0;return n}(t,e)}function c(t){const e=t*s.f+s.e;return 10*Math.pow(2,1*e/12)}async function l(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.a;const r=[],o=[],a=e.length,l=i.tensor(e),u=512*Math.ceil(a/512),h=l.pad([[0,u-a]]),d=h.size/16e3,p=await t.execute({input_audio_samples:h});let f=await p[0].data();const m=await p[1].data();if(32*(m.length-1)/1e3===d){let t=20;for(let e=0;e<m.length;++e){const n=1-f[e];if(o.push(n),n>=s.a)t=c(m[e]),r.push(t);else{const e=i.truncatedNormal([1],0,s.d),n=1-await e.array();r.push(t*n),e.dispose()}}}else{const e=u/512+1,a=new Float32Array(e);f=new Float32Array(e);for(let n=0;n<u;n+=u/4){const e=h.slice([n],[u/4]),i=await t.execute({input_audio_samples:e}),r=await i[0].data(),s=await i[1].data(),o=Math.floor(n/512);f.set(r,o),a.set(s,o),e.dispose(),i[0].dispose(),i[1].dispose()}let l=20;for(let t=0;t<a.length;++t){const e=1-f[t];if(o.push(e),e>=n)l=c(a[t]),r.push(l);else{const t=i.truncatedNormal([1],0,s.d),e=1-await t.array();r.push(l*e),t.dispose()}}}return p[0].dispose(),p[1].dispose(),l.dispose(),h.dispose(),{pitches:r,confidences:o}}},function(t,e,n){"use strict";function i(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),n=0;n<e.length;n+=2){const t=Math.PI*n/this.size;e[n]=Math.cos(t),e[n+1]=-Math.sin(t)}this.table=e;for(var i=0,r=1;this.size>r;r<<=1)i++;this._width=i%2==0?i-1:i,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=i,i.prototype.fromComplexArray=function(t,e){for(var n=e||new Array(t.length>>>1),i=0;i<t.length;i+=2)n[i>>>1]=t[i];return n},i.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},i.prototype.toComplexArray=function(t,e){for(var n=e||this.createComplexArray(),i=0;i<n.length;i+=2)n[i]=t[i>>>1],n[i+1]=0;return n},i.prototype.completeSpectrum=function(t){for(var e=this._csize,n=e>>>1,i=2;i<n;i+=2)t[e-i]=t[i],t[e-i+1]=-t[i+1]},i.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},i.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},i.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var n=0;n<t.length;n++)t[n]/=this.size;this._out=null,this._data=null},i.prototype._transform4=function(){var t,e,n=this._out,i=this._csize,r=1<<this._width,s=i/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleTransform2(t,n,r)}else for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleTransform4(t,n,r)}var a=this._inv?-1:1,c=this.table;for(r>>=2;r>=2;r>>=2){var l=(s=i/r<<1)>>>2;for(t=0;t<i;t+=s)for(var u=t+l,h=t,d=0;h<u;h+=2,d+=r){const t=h,e=t+l,i=e+l,r=i+l,s=n[t],o=n[t+1],u=n[e],p=n[e+1],f=n[i],m=n[i+1],g=n[r],v=n[r+1],y=s,x=o,b=c[d],w=a*c[d+1],S=u*b-p*w,_=u*w+p*b,T=c[2*d],E=a*c[2*d+1],C=f*T-m*E,k=f*E+m*T,A=c[3*d],I=a*c[3*d+1],O=g*A-v*I,R=g*I+v*A,N=y+C,M=x+k,D=y-C,P=x-k,F=S+O,L=_+R,B=a*(S-O),z=a*(_-R),U=N+F,j=M+L,V=N-F,W=M-L,G=D+z,q=P-B,H=D-z,X=P+B;n[t]=U,n[t+1]=j,n[e]=G,n[e+1]=q,n[i]=V,n[i+1]=W,n[r]=H,n[r+1]=X}}},i.prototype._singleTransform2=function(t,e,n){const i=this._out,r=this._data,s=r[e],o=r[e+1],a=r[e+n],c=r[e+n+1],l=s+a,u=o+c,h=s-a,d=o-c;i[t]=l,i[t+1]=u,i[t+2]=h,i[t+3]=d},i.prototype._singleTransform4=function(t,e,n){const i=this._out,r=this._data,s=this._inv?-1:1,o=2*n,a=3*n,c=r[e],l=r[e+1],u=r[e+n],h=r[e+n+1],d=r[e+o],p=r[e+o+1],f=r[e+a],m=r[e+a+1],g=c+d,v=l+p,y=c-d,x=l-p,b=u+f,w=h+m,S=s*(u-f),_=s*(h-m),T=g+b,E=v+w,C=y+_,k=x-S,A=g-b,I=v-w,O=y-_,R=x+S;i[t]=T,i[t+1]=E,i[t+2]=C,i[t+3]=k,i[t+4]=A,i[t+5]=I,i[t+6]=O,i[t+7]=R},i.prototype._realTransform4=function(){var t,e,n=this._out,i=this._csize,r=1<<this._width,s=i/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleRealTransform2(t,n>>>1,r>>>1)}else for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleRealTransform4(t,n>>>1,r>>>1)}var a=this._inv?-1:1,c=this.table;for(r>>=2;r>=2;r>>=2){var l=(s=i/r<<1)>>>1,u=l>>>1,h=u>>>1;for(t=0;t<i;t+=s)for(var d=0,p=0;d<=h;d+=2,p+=r){var f=t+d,m=f+u,g=m+u,v=g+u,y=n[f],x=n[f+1],b=n[m],w=n[m+1],S=n[g],_=n[g+1],T=n[v],E=n[v+1],C=y,k=x,A=c[p],I=a*c[p+1],O=b*A-w*I,R=b*I+w*A,N=c[2*p],M=a*c[2*p+1],D=S*N-_*M,P=S*M+_*N,F=c[3*p],L=a*c[3*p+1],B=T*F-E*L,z=T*L+E*F,U=C+D,j=k+P,V=C-D,W=k-P,G=O+B,q=R+z,H=a*(O-B),X=a*(R-z),Y=U+G,K=j+q,Q=V+X,Z=W-H;if(n[f]=Y,n[f+1]=K,n[m]=Q,n[m+1]=Z,0!==d){if(d!==h){var J=V+-a*X,$=-a*H-W,tt=U+-a*G,et=-j- -a*q,nt=t+u-d,it=t+l-d;n[nt]=J,n[nt+1]=$,n[it]=tt,n[it+1]=et}}else{var rt=U-G,st=j-q;n[g]=rt,n[g+1]=st}}}},i.prototype._singleRealTransform2=function(t,e,n){const i=this._out,r=this._data,s=r[e],o=r[e+n],a=s+o,c=s-o;i[t]=a,i[t+1]=0,i[t+2]=c,i[t+3]=0},i.prototype._singleRealTransform4=function(t,e,n){const i=this._out,r=this._data,s=this._inv?-1:1,o=2*n,a=3*n,c=r[e],l=r[e+n],u=r[e+o],h=r[e+a],d=c+u,p=c-u,f=l+h,m=s*(l-h),g=d+f,v=p,y=-m,x=d-f,b=p,w=m;i[t]=g,i[t+1]=0,i[t+2]=v,i[t+3]=y,i[t+4]=x,i[t+5]=0,i[t+6]=b,i[t+7]=w}},function(t,e){var n,i,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!u){var t=a(d);u=!0;for(var e=l.length;e;){for(c=l,l=[];++h<e;)c&&c[h].run();h=-1,e=l.length}c=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||u||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";var i=n(69),r={body:"",args:[],thisVars:[],localVars:[]};function s(t){if(!t)return r;for(var e=0;e<t.args.length;++e){var n=t.args[e];t.args[e]=0===e?{name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function o(t){for(var e=[],n=0;n<t.args.length;++n)e.push("a"+n);return new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""))(function(t){return i({args:t.args,pre:s(t.pre),body:s(t.body),post:s(t.proc),funcName:t.funcName})}(t))}var a={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in a){var n=a[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:t+"eq"}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:t+"seq"})}}();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in c){var n=c[t];e[t]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:t}),e[t+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in l){var n=l[t];e[t]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:t+"eq"}),e[t+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<u.length;++t){var n=u[t];e[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),e[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var t=0;t<h.length;++t){var n=h[t];e[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),e[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),e[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),e[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var t=0;t<d.length;++t){var n=d[t];e[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),e[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),e[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),e[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),e.any=i({args:["array"],pre:r,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),e.all=i({args:["array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),e.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),e.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),e.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),e.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),e.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),e.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),e.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),e.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),e.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),e.equals=i({args:["array","array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(t,e,n){"use strict";function i(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function r(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}n.r(e),n.d(e,"isMobile",(function(){return i})),n.d(e,"isBrowser",(function(){return r}))},function(t,e,n){var i=n(162),r=n(163),s=n(164),o=n(165),a=n(166),c=n(167),l=n(168);l.alea=i,l.xor128=r,l.xorwow=s,l.xorshift7=o,l.xor4096=a,l.tychei=c,t.exports=l},function(t,e,n){"use strict";n.r(e),n.d(e,"auxiliaryInputFromSpec",(function(){return r})),n.d(e,"AuxiliaryInput",(function(){return s})),n.d(e,"BinaryCounter",(function(){return o}));var i=n(2);function r(t){if("BinaryCounter"===t.type)return new o(t.args);throw new Error("Unknown auxiliary input: "+t)}class s{constructor(t){this.depth=t}}class o extends s{constructor(t){super(t.numBits)}getTensors(t){const e=i.buffer([t,this.depth]);for(let n=0;n<t;++n)for(let t=0;t<this.depth;++t)e.set(Math.floor((n+1)/Math.pow(2,t))%2?1:-1,n,t);return e.toTensor().as2D(t,this.depth)}}},function(t,e,n){"use strict";t.exports=n(50)},function(t,e,n){"use strict";var i=e;function r(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=n(33),i.BufferWriter=n(59),i.Reader=n(34),i.BufferReader=n(60),i.util=n(18),i.rpc=n(61),i.roots=n(63),i.configure=r,r()},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=new Array(arguments.length-1),i=0,r=2,s=!0;r<arguments.length;)n[i++]=arguments[r++];return new Promise((function(r,o){n[i]=function(t){if(s)if(s=!1,t)o(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];r.apply(null,e)}};try{t.apply(e||null,n)}catch(t){s&&(s=!1,o(t))}}))}},function(t,e,n){"use strict";var i=e;i.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var r=new Array(64),s=new Array(123),o=0;o<64;)s[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function(t,e,n){for(var i,s=null,o=[],a=0,c=0;e<n;){var l=t[e++];switch(c){case 0:o[a++]=r[l>>2],i=(3&l)<<4,c=1;break;case 1:o[a++]=r[i|l>>4],i=(15&l)<<2,c=2;break;case 2:o[a++]=r[i|l>>6],o[a++]=r[63&l],c=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=r[i],o[a++]=61,1===c&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))},i.decode=function(t,e,n){for(var i,r=n,o=0,a=0;a<t.length;){var c=t.charCodeAt(a++);if(61===c&&o>1)break;if(void 0===(c=s[c]))throw Error("invalid encoding");switch(o){case 0:i=c,o=1;break;case 1:e[n++]=i<<2|(48&c)>>4,i=c,o=2;break;case 2:e[n++]=(15&i)<<4|(60&c)>>2,i=c,o=3;break;case 3:e[n++]=(3&i)<<6|c,o=0}}if(1===o)throw Error("invalid encoding");return n-r},i.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},function(t,e,n){"use strict";function i(){this._listeners={}}t.exports=i,i.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this},i.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this},i.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}},function(t,e,n){"use strict";function i(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),i=128===n[3];function r(t,i,r){e[0]=t,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3]}function s(t,i,r){e[0]=t,i[r]=n[3],i[r+1]=n[2],i[r+2]=n[1],i[r+3]=n[0]}function o(t,i){return n[0]=t[i],n[1]=t[i+1],n[2]=t[i+2],n[3]=t[i+3],e[0]}function a(t,i){return n[3]=t[i],n[2]=t[i+1],n[1]=t[i+2],n[0]=t[i+3],e[0]}t.writeFloatLE=i?r:s,t.writeFloatBE=i?s:r,t.readFloatLE=i?o:a,t.readFloatBE=i?a:o}():function(){function e(t,e,n,i){var r=e<0?1:0;if(r&&(e=-e),0===e)t(1/e>0?0:2147483648,n,i);else if(isNaN(e))t(2143289344,n,i);else if(e>34028234663852886e22)t((r<<31|2139095040)>>>0,n,i);else if(e<11754943508222875e-54)t((r<<31|Math.round(e/1401298464324817e-60))>>>0,n,i);else{var s=Math.floor(Math.log(e)/Math.LN2);t((r<<31|s+127<<23|8388607&Math.round(e*Math.pow(2,-s)*8388608))>>>0,n,i)}}function n(t,e,n){var i=t(e,n),r=2*(i>>31)+1,s=i>>>23&255,o=8388607&i;return 255===s?o?NaN:r*(1/0):0===s?1401298464324817e-60*r*o:r*Math.pow(2,s-150)*(o+8388608)}t.writeFloatLE=e.bind(null,r),t.writeFloatBE=e.bind(null,s),t.readFloatLE=n.bind(null,o),t.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),i=128===n[7];function r(t,i,r){e[0]=t,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3],i[r+4]=n[4],i[r+5]=n[5],i[r+6]=n[6],i[r+7]=n[7]}function s(t,i,r){e[0]=t,i[r]=n[7],i[r+1]=n[6],i[r+2]=n[5],i[r+3]=n[4],i[r+4]=n[3],i[r+5]=n[2],i[r+6]=n[1],i[r+7]=n[0]}function o(t,i){return n[0]=t[i],n[1]=t[i+1],n[2]=t[i+2],n[3]=t[i+3],n[4]=t[i+4],n[5]=t[i+5],n[6]=t[i+6],n[7]=t[i+7],e[0]}function a(t,i){return n[7]=t[i],n[6]=t[i+1],n[5]=t[i+2],n[4]=t[i+3],n[3]=t[i+4],n[2]=t[i+5],n[1]=t[i+6],n[0]=t[i+7],e[0]}t.writeDoubleLE=i?r:s,t.writeDoubleBE=i?s:r,t.readDoubleLE=i?o:a,t.readDoubleBE=i?a:o}():function(){function e(t,e,n,i,r,s){var o=i<0?1:0;if(o&&(i=-i),0===i)t(0,r,s+e),t(1/i>0?0:2147483648,r,s+n);else if(isNaN(i))t(0,r,s+e),t(2146959360,r,s+n);else if(i>17976931348623157e292)t(0,r,s+e),t((o<<31|2146435072)>>>0,r,s+n);else{var a;if(i<22250738585072014e-324)t((a=i/5e-324)>>>0,r,s+e),t((o<<31|a/4294967296)>>>0,r,s+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),t(4503599627370496*(a=i*Math.pow(2,-c))>>>0,r,s+e),t((o<<31|c+1023<<20|1048576*a&1048575)>>>0,r,s+n)}}}function n(t,e,n,i,r){var s=t(i,r+e),o=t(i,r+n),a=2*(o>>31)+1,c=o>>>20&2047,l=4294967296*(1048575&o)+s;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}t.writeDoubleLE=e.bind(null,r,0,4),t.writeDoubleBE=e.bind(null,s,4,0),t.readDoubleLE=n.bind(null,o,0,4),t.readDoubleBE=n.bind(null,a,4,0)}(),t}function r(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function s(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function o(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function a(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=i(i)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},function(t,e,n){"use strict";var i=e;i.length=function(t){for(var e=0,n=0,i=0;i<t.length;++i)(n=t.charCodeAt(i))<128?e+=1:n<2048?e+=2:55296==(64512&n)&&56320==(64512&t.charCodeAt(i+1))?(++i,e+=4):e+=3;return e},i.read=function(t,e,n){if(n-e<1)return"";for(var i,r=null,s=[],o=0;e<n;)(i=t[e++])<128?s[o++]=i:i>191&&i<224?s[o++]=(31&i)<<6|63&t[e++]:i>239&&i<365?(i=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,s[o++]=55296+(i>>10),s[o++]=56320+(1023&i)):s[o++]=(15&i)<<12|(63&t[e++])<<6|63&t[e++],o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))},i.write=function(t,e,n){for(var i,r,s=n,o=0;o<t.length;++o)(i=t.charCodeAt(o))<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(r=t.charCodeAt(o+1)))?(i=65536+((1023&i)<<10)+(1023&r),++o,e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128);return n-s}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i=n||8192,r=i>>>1,s=null,o=i;return function(n){if(n<1||n>r)return t(n);o+n>i&&(s=t(i),o=0);var a=e.call(s,o,o+=n);return 7&o&&(o=1+(7|o)),a}}},function(t,e,n){"use strict";t.exports=r;var i=n(18);function r(t,e){this.lo=t>>>0,this.hi=e>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(t){if(0===t)return s;var e=t<0;e&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return e&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new r(n,i)},r.from=function(t){if("number"==typeof t)return r.fromNumber(t);if(i.isString(t)){if(!i.Long)return r.fromNumber(parseInt(t,10));t=i.Long.fromString(t)}return t.low||t.high?new r(t.low>>>0,t.high>>>0):s},r.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+4294967296*n)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(t){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var a=String.prototype.charCodeAt;r.fromHash=function(t){return t===o?s:new r((a.call(t,0)|a.call(t,1)<<8|a.call(t,2)<<16|a.call(t,3)<<24)>>>0,(a.call(t,4)|a.call(t,5)<<8|a.call(t,6)<<16|a.call(t,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},r.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},r.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},function(t,e,n){"use strict";t.exports=s;var i=n(33);(s.prototype=Object.create(i.prototype)).constructor=s;var r=n(18);function s(){i.call(this)}function o(t,e,n){t.length<40?r.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}s._configure=function(){s.alloc=r._Buffer_allocUnsafe,s.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}},s.prototype.bytes=function(t){r.isString(t)&&(t=r._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(s.writeBytesBuffer,e,t),this},s.prototype.string=function(t){var e=r.Buffer.byteLength(t);return this.uint32(e),e&&this._push(o,e,t),this},s._configure()},function(t,e,n){"use strict";t.exports=s;var i=n(34);(s.prototype=Object.create(i.prototype)).constructor=s;var r=n(18);function s(t){i.call(this,t)}s._configure=function(){r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice)},s.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},s._configure()},function(t,e,n){"use strict";e.Service=n(62)},function(t,e,n){"use strict";t.exports=r;var i=n(18);function r(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function t(e,n,r,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return i.asPromise(t,a,e,n,r,s);if(a.rpcImpl)try{return a.rpcImpl(e,n[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(t,n){if(t)return a.emit("error",t,e),o(t);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return a.emit("error",t,e),o(t)}return a.emit("data",n,e),o(null,n)}a.end(!0)}))}catch(t){return a.emit("error",t,e),void setTimeout((function(){o(t)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},r.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(t,e,n){"use strict";t.exports={}},function(t){t.exports=JSON.parse('{"chromatic":["1P 2m 2M 3m 3M 4P 4A 5P 6m 6M 7m 7M"],"lydian":["1P 2M 3M 4A 5P 6M 7M"],"major":["1P 2M 3M 4P 5P 6M 7M",["ionian"]],"mixolydian":["1P 2M 3M 4P 5P 6M 7m",["dominant"]],"dorian":["1P 2M 3m 4P 5P 6M 7m"],"aeolian":["1P 2M 3m 4P 5P 6m 7m",["minor"]],"phrygian":["1P 2m 3m 4P 5P 6m 7m"],"locrian":["1P 2m 3m 4P 5d 6m 7m"],"melodic minor":["1P 2M 3m 4P 5P 6M 7M"],"melodic minor second mode":["1P 2m 3m 4P 5P 6M 7m"],"lydian augmented":["1P 2M 3M 4A 5A 6M 7M"],"lydian dominant":["1P 2M 3M 4A 5P 6M 7m",["lydian b7"]],"melodic minor fifth mode":["1P 2M 3M 4P 5P 6m 7m",["hindu","mixolydian b6M"]],"locrian #2":["1P 2M 3m 4P 5d 6m 7m",["half-diminished"]],"altered":["1P 2m 3m 3M 5d 6m 7m",["super locrian","diminished whole tone","pomeroy"]],"harmonic minor":["1P 2M 3m 4P 5P 6m 7M"],"phrygian dominant":["1P 2m 3M 4P 5P 6m 7m",["spanish","phrygian major"]],"half-whole diminished":["1P 2m 3m 3M 4A 5P 6M 7m",["dominant diminished"]],"diminished":["1P 2M 3m 4P 5d 6m 6M 7M",["whole-half diminished"]],"major pentatonic":["1P 2M 3M 5P 6M",["pentatonic"]],"lydian pentatonic":["1P 3M 4A 5P 7M",["chinese"]],"mixolydian pentatonic":["1P 3M 4P 5P 7m",["indian"]],"locrian pentatonic":["1P 3m 4P 5d 7m",["minor seven flat five pentatonic"]],"minor pentatonic":["1P 3m 4P 5P 7m"],"minor six pentatonic":["1P 3m 4P 5P 6M"],"minor hexatonic":["1P 2M 3m 4P 5P 7M"],"flat three pentatonic":["1P 2M 3m 5P 6M",["kumoi"]],"flat six pentatonic":["1P 2M 3M 5P 6m"],"major flat two pentatonic":["1P 2m 3M 5P 6M"],"whole tone pentatonic":["1P 3M 5d 6m 7m"],"ionian pentatonic":["1P 3M 4P 5P 7M"],"lydian #5P pentatonic":["1P 3M 4A 5A 7M"],"lydian dominant pentatonic":["1P 3M 4A 5P 7m"],"minor #7M pentatonic":["1P 3m 4P 5P 7M"],"super locrian pentatonic":["1P 3m 4d 5d 7m"],"in-sen":["1P 2m 4P 5P 7m"],"iwato":["1P 2m 4P 5d 7m"],"hirajoshi":["1P 2M 3m 5P 6m"],"kumoijoshi":["1P 2m 4P 5P 6m"],"pelog":["1P 2m 3m 5P 6m"],"vietnamese 1":["1P 3m 4P 5P 6m"],"vietnamese 2":["1P 3m 4P 5P 7m"],"prometheus":["1P 2M 3M 4A 6M 7m"],"prometheus neopolitan":["1P 2m 3M 4A 6M 7m"],"ritusen":["1P 2M 4P 5P 6M"],"scriabin":["1P 2m 3M 5P 6M"],"piongio":["1P 2M 4P 5P 6M 7m"],"major blues":["1P 2M 3m 3M 5P 6M"],"minor blues":["1P 3m 4P 5d 5P 7m",["blues"]],"composite blues":["1P 2M 3m 3M 4P 5d 5P 6M 7m"],"augmented":["1P 2A 3M 5P 5A 7M"],"augmented heptatonic":["1P 2A 3M 4P 5P 5A 7M"],"dorian #4":["1P 2M 3m 4A 5P 6M 7m"],"lydian diminished":["1P 2M 3m 4A 5P 6M 7M"],"whole tone":["1P 2M 3M 4A 5A 7m"],"leading whole tone":["1P 2M 3M 4A 5A 7m 7M"],"lydian minor":["1P 2M 3M 4A 5P 6m 7m"],"locrian major":["1P 2M 3M 4P 5d 6m 7m",["arabian"]],"neopolitan":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan minor":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan major":["1P 2m 3m 4P 5P 6M 7M",["dorian b2"]],"neopolitan major pentatonic":["1P 3M 4P 5d 7m"],"romanian minor":["1P 2M 3m 5d 5P 6M 7m"],"double harmonic lydian":["1P 2m 3M 4A 5P 6m 7M"],"harmonic major":["1P 2M 3M 4P 5P 6m 7M"],"double harmonic major":["1P 2m 3M 4P 5P 6m 7M",["gypsy"]],"egyptian":["1P 2M 4P 5P 7m"],"hungarian minor":["1P 2M 3m 4A 5P 6m 7M"],"hungarian major":["1P 2A 3M 4A 5P 6M 7m"],"oriental":["1P 2m 3M 4P 5d 6M 7m"],"spanish heptatonic":["1P 2m 3m 3M 4P 5P 6m 7m"],"flamenco":["1P 2m 3m 3M 4A 5P 7m"],"balinese":["1P 2m 3m 4P 5P 6m 7M"],"todi raga":["1P 2m 3m 4A 5P 6m 7M"],"malkos raga":["1P 3m 4P 6m 7m"],"kafi raga":["1P 3m 3M 4P 5P 6M 7m 7M"],"purvi raga":["1P 2m 3M 4P 4A 5P 6m 7M"],"persian":["1P 2m 3M 4P 5d 6m 7M"],"bebop":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop dominant":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop minor":["1P 2M 3m 3M 4P 5P 6M 7m"],"bebop major":["1P 2M 3M 4P 5P 5A 6M 7M"],"bebop locrian":["1P 2m 3m 4P 5d 5P 6m 7m"],"minor bebop":["1P 2M 3m 4P 5P 6m 7m 7M"],"mystery #1":["1P 2m 3M 5d 6m 7m"],"enigmatic":["1P 2m 3M 5d 6m 7m 7M"],"minor six diminished":["1P 2M 3m 4P 5P 6m 6M 7M"],"ionian augmented":["1P 2M 3M 4P 5A 6M 7M"],"lydian #9":["1P 2m 3M 4A 5P 6M 7M"],"ichikosucho":["1P 2M 3M 4P 5d 5P 6M 7M"],"six tone symmetric":["1P 2m 3M 4P 5A 6M"]}')},function(t){t.exports=JSON.parse('{"4":["1P 4P 7m 10m",["quartal"]],"5":["1P 5P"],"7":["1P 3M 5P 7m",["Dominant","Dom"]],"9":["1P 3M 5P 7m 9M",["79"]],"11":["1P 5P 7m 9M 11P"],"13":["1P 3M 5P 7m 9M 13M",["13_"]],"64":["5P 8P 10M"],"M":["1P 3M 5P",["Major",""]],"M#5":["1P 3M 5A",["augmented","maj#5","Maj#5","+","aug"]],"M#5add9":["1P 3M 5A 9M",["+add9"]],"M13":["1P 3M 5P 7M 9M 13M",["maj13","Maj13"]],"M13#11":["1P 3M 5P 7M 9M 11A 13M",["maj13#11","Maj13#11","M13+4","M13#4"]],"M6":["1P 3M 5P 13M",["6"]],"M6#11":["1P 3M 5P 6M 11A",["M6b5","6#11","6b5"]],"M69":["1P 3M 5P 6M 9M",["69"]],"M69#11":["1P 3M 5P 6M 9M 11A"],"M7#11":["1P 3M 5P 7M 11A",["maj7#11","Maj7#11","M7+4","M7#4"]],"M7#5":["1P 3M 5A 7M",["maj7#5","Maj7#5","maj9#5","M7+"]],"M7#5sus4":["1P 4P 5A 7M"],"M7#9#11":["1P 3M 5P 7M 9A 11A"],"M7add13":["1P 3M 5P 6M 7M 9M"],"M7b5":["1P 3M 5d 7M"],"M7b6":["1P 3M 6m 7M"],"M7b9":["1P 3M 5P 7M 9m"],"M7sus4":["1P 4P 5P 7M"],"M9":["1P 3M 5P 7M 9M",["maj9","Maj9"]],"M9#11":["1P 3M 5P 7M 9M 11A",["maj9#11","Maj9#11","M9+4","M9#4"]],"M9#5":["1P 3M 5A 7M 9M",["Maj9#5"]],"M9#5sus4":["1P 4P 5A 7M 9M"],"M9b5":["1P 3M 5d 7M 9M"],"M9sus4":["1P 4P 5P 7M 9M"],"Madd9":["1P 3M 5P 9M",["2","add9","add2"]],"Maj7":["1P 3M 5P 7M",["maj7","M7"]],"Mb5":["1P 3M 5d"],"Mb6":["1P 3M 13m"],"Msus2":["1P 2M 5P",["add9no3","sus2"]],"Msus4":["1P 4P 5P",["sus","sus4"]],"Maddb9":["1P 3M 5P 9m"],"11b9":["1P 5P 7m 9m 11P"],"13#11":["1P 3M 5P 7m 9M 11A 13M",["13+4","13#4"]],"13#9":["1P 3M 5P 7m 9A 13M",["13#9_"]],"13#9#11":["1P 3M 5P 7m 9A 11A 13M"],"13b5":["1P 3M 5d 6M 7m 9M"],"13b9":["1P 3M 5P 7m 9m 13M"],"13b9#11":["1P 3M 5P 7m 9m 11A 13M"],"13no5":["1P 3M 7m 9M 13M"],"13sus4":["1P 4P 5P 7m 9M 13M",["13sus"]],"69#11":["1P 3M 5P 6M 9M 11A"],"7#11":["1P 3M 5P 7m 11A",["7+4","7#4","7#11_","7#4_"]],"7#11b13":["1P 3M 5P 7m 11A 13m",["7b5b13"]],"7#5":["1P 3M 5A 7m",["+7","7aug","aug7"]],"7#5#9":["1P 3M 5A 7m 9A",["7alt","7#5#9_","7#9b13_"]],"7#5b9":["1P 3M 5A 7m 9m"],"7#5b9#11":["1P 3M 5A 7m 9m 11A"],"7#5sus4":["1P 4P 5A 7m"],"7#9":["1P 3M 5P 7m 9A",["7#9_"]],"7#9#11":["1P 3M 5P 7m 9A 11A",["7b5#9"]],"7#9#11b13":["1P 3M 5P 7m 9A 11A 13m"],"7#9b13":["1P 3M 5P 7m 9A 13m"],"7add6":["1P 3M 5P 7m 13M",["67","7add13"]],"7b13":["1P 3M 7m 13m"],"7b5":["1P 3M 5d 7m"],"7b6":["1P 3M 5P 6m 7m"],"7b9":["1P 3M 5P 7m 9m"],"7b9#11":["1P 3M 5P 7m 9m 11A",["7b5b9"]],"7b9#9":["1P 3M 5P 7m 9m 9A"],"7b9b13":["1P 3M 5P 7m 9m 13m"],"7b9b13#11":["1P 3M 5P 7m 9m 11A 13m",["7b9#11b13","7b5b9b13"]],"7no5":["1P 3M 7m"],"7sus4":["1P 4P 5P 7m",["7sus"]],"7sus4b9":["1P 4P 5P 7m 9m",["susb9","7susb9","7b9sus","7b9sus4","phryg"]],"7sus4b9b13":["1P 4P 5P 7m 9m 13m",["7b9b13sus4"]],"9#11":["1P 3M 5P 7m 9M 11A",["9+4","9#4","9#11_","9#4_"]],"9#11b13":["1P 3M 5P 7m 9M 11A 13m",["9b5b13"]],"9#5":["1P 3M 5A 7m 9M",["9+"]],"9#5#11":["1P 3M 5A 7m 9M 11A"],"9b13":["1P 3M 7m 9M 13m"],"9b5":["1P 3M 5d 7m 9M"],"9no5":["1P 3M 7m 9M"],"9sus4":["1P 4P 5P 7m 9M",["9sus"]],"m":["1P 3m 5P"],"m#5":["1P 3m 5A",["m+","mb6"]],"m11":["1P 3m 5P 7m 9M 11P",["_11"]],"m11A 5":["1P 3m 6m 7m 9M 11P"],"m11b5":["1P 3m 7m 12d 2M 4P",["h11","_11b5"]],"m13":["1P 3m 5P 7m 9M 11P 13M",["_13"]],"m6":["1P 3m 4P 5P 13M",["_6"]],"m69":["1P 3m 5P 6M 9M",["_69"]],"m7":["1P 3m 5P 7m",["minor7","_","_7"]],"m7#5":["1P 3m 6m 7m"],"m7add11":["1P 3m 5P 7m 11P",["m7add4"]],"m7b5":["1P 3m 5d 7m",["half-diminished","h7","_7b5"]],"m9":["1P 3m 5P 7m 9M",["_9"]],"m9#5":["1P 3m 6m 7m 9M"],"m9b5":["1P 3m 7m 12d 2M",["h9","-9b5"]],"mMaj7":["1P 3m 5P 7M",["mM7","_M7"]],"mMaj7b6":["1P 3m 5P 6m 7M",["mM7b6"]],"mM9":["1P 3m 5P 7M 9M",["mMaj9","-M9"]],"mM9b6":["1P 3m 5P 6m 7M 9M",["mMaj9b6"]],"mb6M7":["1P 3m 6m 7M"],"mb6b9":["1P 3m 6m 9m"],"o":["1P 3m 5d",["mb5","dim"]],"o7":["1P 3m 5d 13M",["diminished","m6b5","dim7"]],"o7M7":["1P 3m 5d 6M 7M"],"oM7":["1P 3m 5d 7M"],"sus24":["1P 2M 4P 5P",["sus4add9"]],"+add#9":["1P 3M 5A 9A"],"madd4":["1P 3m 4P 5P"],"madd9":["1P 3m 5P 9M"]}')},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(80),r=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var s=function(){function t(t){var n=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),t&&(r.set(this,t.header.ticksPerBeat),t.tracks.forEach((function(t){return t.forEach((function(t){t.meta&&("timeSignature"===t.type?n.timeSignatures.push({ticks:t.absoluteTime,timeSignature:[t.numerator,t.denominator]}):"setTempo"===t.type?n.tempos.push({bpm:6e7/t.microsecondsPerBeat,ticks:t.absoluteTime}):"keySignature"===t.type&&n.keySignatures.push({key:e.keySignatureKeys[t.key+7],scale:0===t.scale?"major":"minor",ticks:t.absoluteTime}))}))})),t.tracks[0].forEach((function(t){t.meta&&("trackName"===t.type?n.name=t.text:"text"!==t.type&&"cuePoint"!==t.type&&"marker"!==t.type&&"lyrics"!==t.type||n.meta.push({text:t.text,ticks:t.absoluteTime,type:t.type}))})),this.update())}return t.prototype.update=function(){var t=this,e=0,n=0;this.tempos.sort((function(t,e){return t.ticks-e.ticks})),this.tempos.forEach((function(i,r){var s=r>0?t.tempos[r-1].bpm:t.tempos[0].bpm,o=i.ticks/t.ppq-n,a=60/s*o;i.time=a+e,e=i.time,n+=o})),this.timeSignatures.sort((function(t,e){return t.ticks-e.ticks})),this.timeSignatures.forEach((function(e,n){var i=n>0?t.timeSignatures[n-1]:t.timeSignatures[0],r=(e.ticks-i.ticks)/t.ppq/i.timeSignature[0]/(i.timeSignature[1]/4);i.measures=i.measures||0,e.measures=r+i.measures}))},t.prototype.ticksToSeconds=function(t){var e=i.search(this.tempos,t);if(-1!==e){var n=this.tempos[e],r=n.time,s=(t-n.ticks)/this.ppq;return r+60/n.bpm*s}return t/this.ppq*.5},t.prototype.ticksToMeasures=function(t){var e=i.search(this.timeSignatures,t);if(-1!==e){var n=this.timeSignatures[e],r=(t-n.ticks)/this.ppq;return n.measures+r/(n.timeSignature[0]/n.timeSignature[1])/4}return t/this.ppq/4},Object.defineProperty(t.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!0,configurable:!0}),t.prototype.secondsToTicks=function(t){var e=i.search(this.tempos,t,"time");if(-1!==e){var n=this.tempos[e],r=(t-n.time)/(60/n.bpm);return Math.round(n.ticks+r*this.ppq)}var s=t/.5;return Math.round(s*this.ppq)},t.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map((function(t){return{bpm:t.bpm,ticks:t.ticks}})),timeSignatures:this.timeSignatures}},t.prototype.fromJSON=function(t){this.name=t.name,this.tempos=t.tempos.map((function(t){return Object.assign({},t)})),this.timeSignatures=t.timeSignatures.map((function(t){return Object.assign({},t)})),this.keySignatures=t.keySignatures.map((function(t){return Object.assign({},t)})),this.meta=t.meta.map((function(t){return Object.assign({},t)})),r.set(this,t.ppq),this.update()},t.prototype.setTempo=function(t){this.tempos=[{bpm:t,ticks:0}],this.update()},t}();e.Header=s},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(79),o=n(174),a=n(66),c=n(81),l=function(){function t(t){var e=this,n=null;t&&(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(n=s.parseMidi(t)).tracks.forEach((function(t){var e=0;t.forEach((function(t){e+=t.deltaTime,t.absoluteTime=e}))})),n.tracks=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=e.length,r=new Map,s=Array(16).fill(0),o=0,a=t[n];o<a.length;o++){var c=a[o],l=i,u=c.channel;if(void 0!==u){"programChange"===c.type&&(s[u]=c.programNumber);var h=s[u]+" "+u;r.has(h)?l=r.get(h):(l=i+r.size,r.set(h,l))}e[l]||e.push([]),e[l].push(c)}return e}(n.tracks)),this.header=new a.Header(n),this.tracks=[],t&&(this.tracks=n.tracks.map((function(t){return new c.Track(t,e.header)})),1===n.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return t.fromUrl=function(e){return i(this,void 0,void 0,(function(){var n;return r(this,(function(i){switch(i.label){case 0:return[4,fetch(e)];case 1:return(n=i.sent()).ok?[4,n.arrayBuffer()]:[3,3];case 2:return[2,new t(i.sent())];case 3:throw new Error("could not load "+e)}}))}))},Object.defineProperty(t.prototype,"name",{get:function(){return this.header.name},set:function(t){this.header.name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=this.tracks.map((function(t){return t.duration}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){var t=this.tracks.map((function(t){return t.durationTicks}));return Math.max.apply(Math,t)},enumerable:!0,configurable:!0}),t.prototype.addTrack=function(){var t=new c.Track(void 0,this.header);return this.tracks.push(t),t},t.prototype.toArray=function(){return o.encode(this)},t.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map((function(t){return t.toJSON()}))}},t.prototype.fromJSON=function(t){var e=this;this.header=new a.Header,this.header.fromJSON(t.header),this.tracks=t.tracks.map((function(t){var n=new c.Track(void 0,e.header);return n.fromJSON(t),n}))},t.prototype.clone=function(){var e=new t;return e.fromJSON(this.toJSON()),e},t}();e.Midi=l;var u=n(81);e.Track=u.Track;var h=n(66);e.Header=h.Header},function(t,e,n){"use strict";(function(t){var i=n(75),r=n(76),s=n(77);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return l(this,t,e,n)}function l(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=d(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(e,n),r=(t=a(t,i)).write(e,n);return r!==i&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=a(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function p(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function f(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(i)return U(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function g(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function v(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=c.from(e,i)),c.isBuffer(e))return 0===e.length?-1:y(t,e,n,i,r);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,i,r){var s,o=1,a=t.length,c=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var u=-1;for(s=n;s<a;s++)if(l(t,s)===l(e,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===c)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var h=!0,d=0;d<c;d++)if(l(t,s+d)!==l(e,d)){h=!1;break}if(h)return s}return-1}function x(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function b(t,e,n,i){return V(U(e,t.length-n),t,n,i)}function w(t,e,n,i){return V(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function S(t,e,n,i){return w(t,e,n,i)}function _(t,e,n,i){return V(j(e),t,n,i)}function T(t,e,n,i){return V(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)i=(n=t.charCodeAt(o))>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function E(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,c,l=t[r],u=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(s=t[r+1]))&&(c=(31&l)<<6|63&s)>127&&(u=c);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(c=(15&l)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return n}(i)}function k(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function A(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function I(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=e;s<n;++s)r+=z(t[s]);return r}function O(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,i,r,s){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function M(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function D(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function P(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,i,s){return s||P(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function L(t,e,n,i,s){return s||P(t,0,n,8),r.write(t,e,n,i,52,8),n+8}e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return l(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,i){return u(e),e<=0?a(t,e):void 0!==n?"string"==typeof i?a(t,e).fill(n,i):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return h(null,t)},c.allocUnsafeSlow=function(t){return h(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=c.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var o=t[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):m.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,i,r){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),l=this.slice(i,r),u=t.slice(e,n),h=0;h<a;++h)if(l[h]!==u[h]){s=l[h],o=u[h];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},c.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return x(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},c.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var r=e-t;n=new c(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},c.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},c.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),r.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),r.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),r.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),r.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||N(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||N(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},c.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=c.isBuffer(t)?t:U(new c(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function j(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(21))},function(t,e,n){"use strict";var i=n(87);function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}t.exports=function(t){var e=new r;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var s=0;s<n.length;++s){var o=n[s];if("array"===o||"object"==typeof o&&o.blockIndices){if(e.argTypes[s]="array",e.arrayArgs.push(s),e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),e.shimArgs.push("array"+s),s<e.pre.args.length&&e.pre.args[s].count>0)throw new Error("cwise: pre() block may not reference array args");if(s<e.post.args.length&&e.post.args[s].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)e.scalarArgs.push(s),e.shimArgs.push("scalar"+s);else if("index"===o){if(e.indexArgs.push(s),s<e.pre.args.length&&e.pre.args[s].count>0)throw new Error("cwise: pre() block may not reference array index");if(s<e.body.args.length&&e.body.args[s].lvalue)throw new Error("cwise: body() block may not write to array index");if(s<e.post.args.length&&e.post.args[s].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(e.shapeArgs.push(s),s<e.pre.args.length&&e.pre.args[s].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(s<e.body.args.length&&e.body.args[s].lvalue)throw new Error("cwise: body() block may not write to array shape");if(s<e.post.args.length&&e.post.args[s].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+n[s]);e.argTypes[s]="offset",e.offsetArgs.push({array:o.array,offset:o.offset}),e.offsetArgIndex.push(s)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,i(e)}},function(t,e,n){"use strict";t.exports=function(t,e,n){return 0===t.length?t:e?(n||t.sort(e),function(t,e){for(var n=1,i=t.length,r=t[0],s=t[0],o=1;o<i;++o)if(s=r,e(r=t[o],s)){if(o===n){n++;continue}t[n++]=r}return t.length=n,t}(t,e)):(n||t.sort(),function(t){for(var e=1,n=t.length,i=t[0],r=t[0],s=1;s<n;++s,r=i)if(r=i,(i=t[s])!==r){if(s===e){e++;continue}t[e++]=i}return t.length=e,t}(t))}},function(t,e,n){"use strict";(function(t){var i=n(72),r=n(89),s=n(68).Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:r([32,0]),UINT16:r([32,0]),UINT32:r([32,0]),BIGUINT64:r([32,0]),INT8:r([32,0]),INT16:r([32,0]),INT32:r([32,0]),BIGINT64:r([32,0]),FLOAT:r([32,0]),DOUBLE:r([32,0]),DATA:r([32,0]),UINT8C:r([32,0]),BUFFER:r([32,0])});var o="undefined"!=typeof Uint8ClampedArray,a="undefined"!=typeof BigUint64Array,c="undefined"!=typeof BigInt64Array,l=t.__TYPEDARRAY_POOL;l.UINT8C||(l.UINT8C=r([32,0])),l.BIGUINT64||(l.BIGUINT64=r([32,0])),l.BIGINT64||(l.BIGINT64=r([32,0])),l.BUFFER||(l.BUFFER=r([32,0]));var u=l.DATA,h=l.BUFFER;function d(t){if(t){var e=t.length||t.byteLength,n=i.log2(e);u[n].push(t)}}function p(t){t=i.nextPow2(t);var e=i.log2(t),n=u[e];return n.length>0?n.pop():new ArrayBuffer(t)}function f(t){return new Uint8Array(p(t),0,t)}function m(t){return new Uint16Array(p(2*t),0,t)}function g(t){return new Uint32Array(p(4*t),0,t)}function v(t){return new Int8Array(p(t),0,t)}function y(t){return new Int16Array(p(2*t),0,t)}function x(t){return new Int32Array(p(4*t),0,t)}function b(t){return new Float32Array(p(4*t),0,t)}function w(t){return new Float64Array(p(8*t),0,t)}function S(t){return o?new Uint8ClampedArray(p(t),0,t):f(t)}function _(t){return a?new BigUint64Array(p(8*t),0,t):null}function T(t){return c?new BigInt64Array(p(8*t),0,t):null}function E(t){return new DataView(p(t),0,t)}function C(t){t=i.nextPow2(t);var e=i.log2(t),n=h[e];return n.length>0?n.pop():new s(t)}e.free=function(t){if(s.isBuffer(t))h[i.log2(t.length)].push(t);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(t)&&(t=t.buffer),!t)return;var e=t.length||t.byteLength,n=0|i.log2(e);u[n].push(t)}},e.freeUint8=e.freeUint16=e.freeUint32=e.freeBigUint64=e.freeInt8=e.freeInt16=e.freeInt32=e.freeBigInt64=e.freeFloat32=e.freeFloat=e.freeFloat64=e.freeDouble=e.freeUint8Clamped=e.freeDataView=function(t){d(t.buffer)},e.freeArrayBuffer=d,e.freeBuffer=function(t){h[i.log2(t.length)].push(t)},e.malloc=function(t,e){if(void 0===e||"arraybuffer"===e)return p(t);switch(e){case"uint8":return f(t);case"uint16":return m(t);case"uint32":return g(t);case"int8":return v(t);case"int16":return y(t);case"int32":return x(t);case"float":case"float32":return b(t);case"double":case"float64":return w(t);case"uint8_clamped":return S(t);case"bigint64":return T(t);case"biguint64":return _(t);case"buffer":return C(t);case"data":case"dataview":return E(t);default:return null}return null},e.mallocArrayBuffer=p,e.mallocUint8=f,e.mallocUint16=m,e.mallocUint32=g,e.mallocInt8=v,e.mallocInt16=y,e.mallocInt32=x,e.mallocFloat32=e.mallocFloat=b,e.mallocFloat64=e.mallocDouble=w,e.mallocUint8Clamped=S,e.mallocBigUint64=_,e.mallocBigInt64=T,e.mallocDataView=E,e.mallocBuffer=C,e.clearCache=function(){for(var t=0;t<32;++t)l.UINT8[t].length=0,l.UINT16[t].length=0,l.UINT32[t].length=0,l.INT8[t].length=0,l.INT16[t].length=0,l.INT32[t].length=0,l.FLOAT[t].length=0,l.DOUBLE[t].length=0,l.BIGUINT64[t].length=0,l.BIGINT64[t].length=0,l.UINT8C[t].length=0,u[t].length=0,h[t].length=0}}).call(this,n(21))},function(t,e,n){"use strict";function i(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=i,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>i(t)+1}},function(t,e,n){"use strict";n.r(e),n.d(e,"aux_inputs",(function(){return i})),n.d(e,"chords",(function(){return r})),n.d(e,"constants",(function(){return s})),n.d(e,"data",(function(){return o})),n.d(e,"logging",(function(){return a})),n.d(e,"melodies",(function(){return c})),n.d(e,"performance",(function(){return l})),n.d(e,"sequences",(function(){return u})),n.d(e,"MetronomeCallbackObject",(function(){return d})),n.d(e,"Metronome",(function(){return p})),n.d(e,"MidiConversionError",(function(){return v})),n.d(e,"midiToSequenceProto",(function(){return y})),n.d(e,"sequenceProtoToMidi",(function(){return x})),n.d(e,"urlToBlob",(function(){return b})),n.d(e,"blobToNoteSequence",(function(){return w})),n.d(e,"urlToNoteSequence",(function(){return S})),n.d(e,"BasePlayerCallback",(function(){return C})),n.d(e,"BasePlayer",(function(){return k})),n.d(e,"Player",(function(){return I})),n.d(e,"SoundFontPlayer",(function(){return O})),n.d(e,"PlayerWithClick",(function(){return R})),n.d(e,"MIDIPlayer",(function(){return N})),n.d(e,"BaseRecorderCallback",(function(){return M})),n.d(e,"Recorder",(function(){return D})),n.d(e,"BaseVisualizer",(function(){return L})),n.d(e,"PianoRollCanvasVisualizer",(function(){return B})),n.d(e,"Visualizer",(function(){return z})),n.d(e,"BaseSVGVisualizer",(function(){return U})),n.d(e,"PianoRollSVGVisualizer",(function(){return j})),n.d(e,"WaterfallSVGVisualizer",(function(){return V})),n.d(e,"ScrollType",(function(){return P})),n.d(e,"StaffSVGVisualizer",(function(){return W}));var i=n(48),r=n(37),s=n(8),o=n(36),a=n(12),c=n(23),l=n(29),u=n(13),h=n(9);class d{}class p{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.clicksPerQuarter=1,this.muted=!1,this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.loClickNote="c5",this.hiClickNote="g5",this.ticking=!1,this.startedAt=null,this.step=-1,this.reset(),this.callbackObject=t,this.clicksPerQuarter=e}isTicking(){return this.ticking}getStartedAt(){return this.startedAt}getOffsetTime(){return h.immediate()-this.startedAt}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120;this.reset(),this.ticking=!0,this.callbackObject.click||(this.callbackObject.click=()=>{}),this.callbackObject.quarter||(this.callbackObject.quarter=()=>{}),this.callbackObject.bar||(this.callbackObject.bar=()=>{});let e=0;const n=4*this.clicksPerQuarter;h.Transport.scheduleRepeat((t=>{this.startedAt||(this.startedAt=t);const i=t-this.startedAt;this.step++;const r=this.step%n,s=Math.floor(r/this.clicksPerQuarter),o=r%this.clicksPerQuarter;this.callbackObject.click(i,r),0===o&&this.callbackObject.quarter(i,s),this.muted||(0===r?this.hiClick.triggerAttack(this.hiClickNote,t,.1):this.loClick.triggerAttack(this.loClickNote,t,.1)),0===r&&(this.callbackObject.bar(i,e),e++)}),n+"n"),h.Transport.bpm.value=t,h.Transport.start()}stop(){this.ticking=!1,h.Transport.cancel(),h.Transport.stop()}reset(){this.muted=!1,this.ticking=!1,this.step=-1,this.startedAt=null}}var f=n(67),m=n(15),g=n(10);class v extends Error{constructor(t){super(t),Object.setPrototypeOf(this,new.target.prototype)}}function y(t){const e=new f.Midi(t),n=g.a.create();n.ticksPerQuarter=e.header.ppq,n.sourceInfo=g.a.SourceInfo.create({parser:g.a.SourceInfo.Parser.TONEJS_MIDI_CONVERT,encodingType:g.a.SourceInfo.EncodingType.MIDI});for(const r of e.header.timeSignatures)n.timeSignatures.push(g.a.TimeSignature.create({time:e.header.ticksToSeconds(r.ticks),numerator:r.timeSignature[0],denominator:r.timeSignature[1]}));n.timeSignatures.length||n.timeSignatures.push(g.a.TimeSignature.create({time:0,numerator:4,denominator:4}));for(const r of e.header.tempos)n.tempos.push(g.a.Tempo.create({time:r.time,qpm:r.bpm}));let i=-1;for(const r of e.tracks){r.notes.length>0&&(i+=1);for(const o of r.notes){const t=o.time,e=t+o.duration;n.notes.push(g.a.Note.create({instrument:i,program:r.instrument.number,startTime:t,endTime:e,pitch:o.midi,velocity:Math.floor(o.velocity*s.MIDI_VELOCITIES),isDrum:r.instrument.percussion})),e>n.totalTime&&(n.totalTime=e)}const t=Object.values(r.controlChanges),e=[].concat.apply([],t);for(const o of e)n.controlChanges.push(g.a.ControlChange.create({time:o.time,controlNumber:o.number,controlValue:Math.floor(o.value*(s.MIDI_VELOCITIES-1)),instrument:i,program:r.instrument.number,isDrum:r.instrument.percussion}))}return n}function x(t){u.isQuantizedSequence(t)&&(t=u.unquantizeSequence(t));const e=new f.Midi;e.fromJSON({header:{name:"",ppq:t.ticksPerQuarter||s.DEFAULT_TICKS_PER_QUARTER,tempos:[],timeSignatures:[],keySignatures:[],meta:[]},tracks:[]});const n=Array.from(t.tempos||[]);0===n.length&&n.push({time:0,qpm:s.DEFAULT_QUARTERS_PER_MINUTE}),n.sort(((t,e)=>t.time-e.time));for(const r of n)e.header.tempos.push({ticks:e.header.secondsToTicks(r.time),bpm:r.qpm}),e.header.update();if(t.timeSignatures&&0!==t.timeSignatures.length)for(const r of t.timeSignatures)e.header.timeSignatures.push({ticks:e.header.secondsToTicks(r.time),timeSignature:[r.numerator,r.denominator]});else e.header.timeSignatures.push({ticks:0,timeSignature:[4,4]});e.header.update();const i=new Map;for(const r of t.notes){const t=r.instrument?r.instrument:0,e=void 0===r.program?s.DEFAULT_PROGRAM:r.program,n=!!r.isDrum,o=JSON.stringify([t,e,n]);i.has(o)||i.set(o,{notes:[],controlChanges:[]}),i.get(o).notes.push(r)}for(const r of t.controlChanges){const t=r.instrument?r.instrument:0,e=void 0===r.program?s.DEFAULT_PROGRAM:r.program,n=!!r.isDrum,o=JSON.stringify([t,e,n]);i.has(o)||i.set(o,{notes:[],controlChanges:[]}),i.get(o).controlChanges.push(r)}return i.forEach(((t,n)=>{const[i,r]=JSON.parse(n).slice(1),o=e.addTrack();o.channel=r?s.DRUM_CHANNEL:s.NON_DRUM_CHANNELS[(e.tracks.length-1)%s.NON_DRUM_CHANNELS.length],o.instrument.number=i;for(const e of t.notes){const t=void 0===e.velocity?s.DEFAULT_VELOCITY:e.velocity;o.addNote({midi:e.pitch,time:e.startTime,duration:e.endTime-e.startTime,velocity:(t+1)/s.MIDI_VELOCITIES})}for(const e of t.controlChanges)o.addCC({number:e.controlNumber,value:e.controlValue,time:e.time})})),e.toArray()}function b(t){return new Promise(((e,n)=>{Object(m.a)(t).then((t=>t.blob())).then((t=>{e(t)})).catch((t=>n(t)))}))}function w(t){return new Promise(((e,n)=>{const i=new FileReader;i.onload=t=>{try{const t=y(i.result);e(t)}catch(t){n(t)}},i.onerror=t=>n(t),i.readAsArrayBuffer(t)}))}function S(t){return b(t).then(w)}class _{constructor(t){this.FADE_SECONDS=.1,this.baseURL=t,this.buffers=new h.ToneAudioBuffers,this.sourceMap=new Map,this.initialized=!1}async initialize(){await Object(m.a)(this.baseURL+"/instrument.json").then((t=>t.json())).then((t=>{this.name=t.name,this.minPitch=t.minPitch,this.maxPitch=t.maxPitch,this.durationSeconds=t.durationSeconds,this.releaseSeconds=t.releaseSeconds,this.percussive=t.percussive,this.velocities=t.velocities,this.initialized=!0}))}sampleInfoToName(t){return this.velocities?"p".concat(t.pitch,"_v").concat(t.velocity):"p"+t.pitch}sampleNameToURL(t){return"".concat(this.baseURL,"/").concat(t,".mp3")}nearestVelocity(t){if(!this.velocities)return t;t||(t=s.DEFAULT_VELOCITY);let e,n=s.MIDI_VELOCITIES;return this.velocities.forEach((i=>{const r=Math.abs(i-t);r<n&&(e=i,n=r)})),e}async loadSamples(t){this.initialized||await this.initialize();const e=t.filter((t=>!(t.pitch<this.minPitch||t.pitch>this.maxPitch)||(a.log("Pitch ".concat(t.pitch," is outside the valid range for ").concat(this.name,", ignoring."),"SoundFont"),!1))).map((t=>this.sampleInfoToName({pitch:t.pitch,velocity:this.nearestVelocity(t.velocity)}))),n=Array.from(new Set(e)).filter((t=>!this.buffers.has(t))).map((t=>({name:t,url:this.sampleNameToURL(t)})));n.length>0&&(n.forEach((t=>this.buffers.add(t.name,t.url))),await h.loaded(),a.log("Loaded samples for ".concat(this.name,"."),"SoundFont"))}playNote(t,e,n,i,r){const s=this.getBuffer(t,e);if(!s)return;i>this.durationSeconds&&a.log("Requested note duration longer than sample duration: ".concat(i," > ").concat(this.durationSeconds),"SoundFont");const o=new h.ToneBufferSource({url:s,fadeOut:this.FADE_SECONDS}).connect(r);if(o.start(n,0,void 0,1),!this.percussive&&i<this.durationSeconds){const t=new h.ToneBufferSource({url:s,fadeOut:this.FADE_SECONDS}).connect(r);o.stop(n+i+this.FADE_SECONDS),t.start(n+i,this.durationSeconds,void 0,1)}}playNoteDown(t,e,n){const i=this.getBuffer(t,e);if(!i)return;const r=new h.ToneBufferSource(i).connect(n);r.start(0,0,void 0,1),this.sourceMap.has(t)&&this.sourceMap.get(t).stop(h.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.set(t,r)}playNoteUp(t,e,n){if(!this.sourceMap.has(t))return;const i=this.getBuffer(t,e);i&&(new h.ToneBufferSource({url:i,fadeOut:this.FADE_SECONDS}).connect(n).start(0,this.durationSeconds,void 0,1),this.sourceMap.get(t).stop(h.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.delete(t))}getBuffer(t,e){if(!this.initialized)throw new Error("Instrument is not initialized.");if(t<this.minPitch||t>this.maxPitch)return void a.log("Pitch ".concat(t," is outside the valid range for ").concat(this.name," (").concat(this.minPitch,"-").concat(this.maxPitch,")"),"SoundFont");const n=this.sampleInfoToName({pitch:t,velocity:this.nearestVelocity(e)});if(!this.buffers.has(n))throw new Error("Buffer not found for ".concat(this.name,": ").concat(n));const i=this.buffers.get(n);if(!i.loaded)throw new Error("Buffer not loaded for ".concat(this.name,": ").concat(n));return i}}class T{constructor(t){this.baseURL=t,this.instruments=new Map,this.initialized=!1}async initialize(){await Object(m.a)(this.baseURL+"/soundfont.json").then((t=>t.json())).then((t=>{this.name=t.name;for(const e in t.instruments){const n="".concat(this.baseURL,"/").concat(t.instruments[e]);this.instruments.set("drums"===e?"drums":+e,new _(n))}this.initialized=!0}))}async loadSamples(t){this.initialized||await this.initialize();const e=new Map;t.forEach((t=>{t.isDrum=t.isDrum||!1,t.program=t.program||0;const n=t.isDrum?"drums":t.program,i={pitch:t.pitch,velocity:t.velocity};e.has(n)?e.get(n).push(i):this.instruments.has(n)?e.set(n,[i]):a.log("No instrument in ".concat(this.name," for: program=").concat(t.program,", isDrum=").concat(t.isDrum),"SoundFont")})),await Promise.all(Array.from(e.keys()).map((t=>this.instruments.get(t).loadSamples(e.get(t)))))}playNote(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0;const c=s?"drums":r;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(c)?this.instruments.get(c).playNote(t,e,n,i,o):a.log("No instrument in ".concat(this.name," for: program=").concat(r,", isDrum=").concat(s),"SoundFont")}playNoteDown(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;const s=i?"drums":n;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(s)?this.instruments.get(s).playNoteDown(t,e,r):a.log("No instrument in ".concat(this.name," for: program=").concat(n,", isDrum=").concat(i),"SoundFont")}playNoteUp(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;const s=i?"drums":n;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(s)?this.instruments.get(s).playNoteUp(t,e,r):a.log("No instrument in ".concat(this.name," for: program=").concat(n,", isDrum=").concat(i),"SoundFont")}}function E(t,e){return t.quantizedStartStep<e.quantizedStartStep?-1:t.quantizedStartStep>e.quantizedStartStep?1:t.pitch<e.pitch?-1:1}class C{}class k{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;this.playClick=t,this.callbackObject=e,this.desiredQPM=void 0}setTempo(t){this.desiredQPM=t,"started"===h.Transport.state&&(h.Transport.bpm.value=t)}makeClickSequence(t){const e=u.clone(t),n=e.notes.map((t=>t.quantizedEndStep)),i=Math.max(...n);for(let r=0;r<i;r+=4){const t={pitch:r%16==0?s.LO_CLICK_PITCH:s.HI_CLICK_PITCH,quantizedStartStep:r,isDrum:!0,quantizedEndStep:r+1};e.notes.push(t)}return e.notes.sort(E),e}resumeContext(){h.context.resume()}start(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("started"===this.getPlayState())throw new Error("Cannot start playback; player is already playing.");if("paused"===this.getPlayState())throw new Error("Cannot `start()` a paused player; use `resume()`.");if("stopped"!==h.Transport.state)throw new Error("Cannot start playback while `Tone.Transport` is in use.");this.resumeContext();const i=u.isQuantizedSequence(t);if(this.playClick&&i&&(t=this.makeClickSequence(t)),e?h.Transport.bpm.value=e:t.tempos&&t.tempos.length>0&&t.tempos[0].qpm>0?h.Transport.bpm.value=t.tempos[0].qpm:h.Transport.bpm.value=s.DEFAULT_QUARTERS_PER_MINUTE,i)t=u.unquantizeSequence(t,e);else if(e)throw new Error("Cannot specify a `qpm` for a non-quantized sequence.");const r=new h.Part(((t,e)=>{this.currentPart===r&&(this.playNote(t,e),this.callbackObject&&h.Draw.schedule((()=>{this.callbackObject.run(e,t)}),t))}),t.notes.map((t=>[t.startTime,t])));return this.currentPart=r,this.desiredQPM&&(h.Transport.bpm.value=this.desiredQPM),this.currentPart.start(void 0,n),"started"!==h.Transport.state&&h.Transport.start(),new Promise((e=>{this.scheduledStop=h.Transport.schedule((()=>{this.stop(),e(),this.callbackObject&&this.callbackObject.stop()}),"+"+t.totalTime)}))}stop(){this.isPlaying()&&(this.currentPart.stop(),h.Transport.stop(),this.currentPart=null),h.Transport.clear(this.scheduledStop),this.scheduledStop=void 0,this.desiredQPM=void 0}pause(){if(!this.isPlaying())throw new Error("Cannot pause playback while the player is stopped.");h.Transport.pause()}resume(){if("paused"!==this.getPlayState())throw new Error('Cannot resume playback while "'.concat(this.getPlayState(),'".'));h.Transport.start()}seekTo(t){if(!this.isPlaying())throw new Error("Cannot seek while the player is stopped.");h.Transport.seconds=t}isPlaying(){return!!this.currentPart}getPlayState(){return this.isPlaying()?h.Transport.state:"stopped"}}class A{constructor(){var t=this;this.DRUM_PITCH_TO_CLASS=new Map,this.kick=(new h.MembraneSynth).toDestination(),this.tomLow=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomMid=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomHigh=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.closedHihat=new h.MetalSynth({frequency:400,envelope:{attack:.001,decay:.1,release:.8},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.openHihat=new h.MetalSynth({frequency:400,envelope:{attack:.001,decay:.5,release:.8,sustain:1},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.ride=(new h.MetalSynth).toDestination(),this.crash=new h.MetalSynth({frequency:300,envelope:{attack:.001,decay:1,release:3},harmonicity:5.1,modulationIndex:64,resonance:4e3,octaves:1.5}).toDestination(),this.snare=new h.NoiseSynth({noise:{type:"white"},envelope:{attack:.005,decay:.05,sustain:.1,release:.4}}).toDestination(),this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.pitchPlayers=[function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.kick.triggerAttackRelease("C2","8n",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.snare.triggerAttackRelease("16n",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.closedHihat.triggerAttack(e,.3,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.openHihat.triggerAttack(e,.3,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomLow.triggerAttack("G3",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomMid.triggerAttack("C4",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomHigh.triggerAttack("F4",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.crash.triggerAttack(e,1,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.ride.triggerAttack(e,.5,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.loClick.triggerAttack("G5",e,n)},function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.hiClick.triggerAttack("C6",e,n)}];for(let e=0;e<s.DEFAULT_DRUM_PITCH_CLASSES.length;++e)s.DEFAULT_DRUM_PITCH_CLASSES[e].forEach((t=>{this.DRUM_PITCH_TO_CLASS.set(t,e)}));this.DRUM_PITCH_TO_CLASS.set(s.LO_CLICK_PITCH,s.LO_CLICK_CLASS),this.DRUM_PITCH_TO_CLASS.set(s.HI_CLICK_PITCH,s.HI_CLICK_CLASS)}static getInstance(){return A.instance||(A.instance=new A),A.instance}playNote(t,e,n){this.pitchPlayers[this.DRUM_PITCH_TO_CLASS.get(t)](e,n)}}class I extends k{constructor(){super(...arguments),this.drumKit=A.getInstance(),this.bassSynth=new h.Synth({volume:5,oscillator:{type:"triangle"}}).toDestination(),this.polySynth=(new h.PolySynth).toDestination()}playNote(t,e){const n=e.hasOwnProperty("velocity")?e.velocity/s.MAX_MIDI_VELOCITY:void 0;if(e.isDrum)this.drumKit.playNote(e.pitch,t,n);else{const i=h.Frequency(e.pitch,"midi").toFrequency(),r=e.endTime-e.startTime;this.getSynth(e.instrument,e.program).triggerAttackRelease(i,r,t,n)}}getSynth(t,e){return void 0!==e&&e>=32&&e<=39?this.bassSynth:this.polySynth}}I.tone=h;class O extends k{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.Master,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super(!1,arguments.length>4?arguments[4]:void 0),this.soundFont=new T(t),this.output=e,this.programOutputs=n,this.drumOutputs=i}async loadSamples(t){await this.soundFont.loadSamples(t.notes.map((t=>({pitch:t.pitch,velocity:t.velocity,program:t.program||0,isDrum:t.isDrum||!1}))))}async loadAllSamples(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=g.a.create(),i=e?s.MIN_DRUM_PITCH:s.MIN_PIANO_PITCH,r=e?s.MAX_DRUM_PITCH:s.MAX_PIANO_PITCH;for(let o=i;o<=r;o++)for(let i=s.MIN_MIDI_VELOCITY;i<s.MAX_MIDI_VELOCITY;i++)n.notes.push({pitch:o,velocity:i,program:t,isDrum:e});return this.loadSamples(n)}resumeContext(){h.context.resume()}start(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.resumeContext(),this.loadSamples(t).then((()=>super.start(t,e,n)))}playNote(t,e){this.soundFont.playNote(e.pitch,e.velocity,t,e.endTime-e.startTime,e.program,e.isDrum,this.getAudioNodeOutput(e))}playNoteDown(t){this.soundFont.playNoteDown(t.pitch,t.velocity,t.program,t.isDrum,this.getAudioNodeOutput(t))}playNoteUp(t){this.soundFont.playNoteUp(t.pitch,t.velocity,t.program,t.isDrum,this.getAudioNodeOutput(t))}getAudioNodeOutput(t){let e=this.output;return this.programOutputs&&!t.isDrum?this.programOutputs.has(t.program)&&(e=this.programOutputs.get(t.program)):this.drumOutputs&&t.isDrum&&this.drumOutputs.has(t.pitch)&&(e=this.drumOutputs.get(t.pitch)),e}}class R extends I{constructor(t){super(!0,t)}}class N extends k{constructor(t){super(!1,t),this.outputs=[],this.outputChannel=0,this.availableOutputs=[],this.NOTE_ON=144,this.NOTE_OFF=128}async requestMIDIAccess(){return navigator.requestMIDIAccess?new Promise(((t,e)=>{navigator.requestMIDIAccess().then((e=>{e.addEventListener("statechange",(t=>this.initOutputs(e))),t(this.initOutputs(e))}),(t=>console.log("Something went wrong",e(t))))})):null}initOutputs(t){const e=t.outputs.values();for(let n=e.next();n&&!n.done;n=e.next())this.availableOutputs.push(n.value);return this.availableOutputs}playNote(t,e){const n=e.velocity||100,i=1e3*(e.endTime-e.startTime),r=[this.NOTE_ON+this.outputChannel,e.pitch,n],s=[this.NOTE_OFF+this.outputChannel,e.pitch,n],o=this.outputs?this.outputs:this.availableOutputs;for(let a=0;a<o.length;a++)this.sendMessageToOutput(o[a],r),this.sendMessageToOutput(o[a],s,m.d.now()+i)}sendMessageToOutput(t,e,n){t&&t.send(e,n)}playNoteDown(t){const e=[this.NOTE_ON,t.pitch,t.velocity],n=this.outputs?this.outputs:this.availableOutputs;for(let i=0;i<n.length;i++)this.sendMessageToOutput(n[i],e)}playNoteUp(t){const e=[this.NOTE_OFF,t.pitch,t.velocity],n=this.outputs?this.outputs:this.availableOutputs;for(let i=0;i<n.length;i++)this.sendMessageToOutput(n[i],e,t.endTime-t.startTime)}}class M{}class D{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;this.notes=[],this.midiInputs=[],this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.config={playClick:t.playClick,qpm:t.qpm||s.DEFAULT_QUARTERS_PER_MINUTE,playCountIn:t.playCountIn,startRecordingAtFirstNote:t.startRecordingAtFirstNote||!1},this.callbackObject=e,this.recording=!1,this.onNotes=new Map}async initialize(){await navigator.requestMIDIAccess().then((t=>this.midiReady(t)),(t=>console.log("Something went wrong",t)))}midiReady(t){a.log("Initialized Recorder","Recorder");const e=t.inputs.values();for(let n=e.next();n&&!n.done;n=e.next())this.midiInputs.push(n.value)}isRecording(){return this.recording}setTempo(t){this.config.qpm=t,"started"===h.Transport.state&&(h.Transport.bpm.value=t)}enablePlayClick(t){this.config.playClick=t}enablePlayCountIn(t){this.config.playCountIn=t}initClickLoop(){let t=0;this.clickLoop=new h.Loop((e=>{t%4==0?this.loClick.triggerAttack("G5",e):this.hiClick.triggerAttack("C6",e),t++,this.config.playCountIn&&4===t&&(h.Transport.stop(),this.clickLoop.stop())}),"4n")}getMIDIInputs(){return this.midiInputs}start(t){const e=t||this.midiInputs;for(const n of e)n.onmidimessage=t=>{this.midiMessageReceived(t)};if(this.config.playClick||this.config.playCountIn?(this.initClickLoop(),h.Transport.bpm.value=this.config.qpm,h.Transport.start(),this.clickLoop.start()):this.clickLoop=null,this.recording=!0,this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,!this.startRecordingAtFirstNote){const t=Date.now();this.firstNoteTimestamp=t}}stop(){this.recording=!1;const t=Date.now();this.onNotes.forEach(((e,n)=>{this.noteOff(n,t)}));for(const e of this.midiInputs)e.onmidimessage=null;return this.clickLoop&&(h.Transport.stop(),this.clickLoop.stop()),0===this.notes.length?null:this.getNoteSequence()}getNoteSequence(){return 0===this.notes.length?null:g.a.create({notes:this.notes,totalTime:this.notes[this.notes.length-1].endTime})}reset(){const t=this.stop();return this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,t}midiMessageReceived(t){if(!this.recording)return;let e;e=void 0!==t.timeStamp&&0!==t.timeStamp?t.timeStamp:m.d.now();const n=e+m.d.timing.navigationStart;void 0===this.firstNoteTimestamp&&(this.firstNoteTimestamp=n);const i=t.data[0]>>4,r=t.data[1],s=t.data.length>2?t.data[2]:1,o=t.srcElement;8===i||9===i&&0===s?(this.callbackObject&&this.callbackObject.noteOff&&this.callbackObject.noteOff(r,s,o),this.noteOff(r,n),this.callbackObject&&this.callbackObject.run&&this.callbackObject.run(this.getNoteSequence())):9===i&&(this.callbackObject&&this.callbackObject.noteOn&&this.callbackObject.noteOn(r,s,o),this.noteOn(r,s,n))}noteOn(t,e,n){const i=new g.a.Note;i.pitch=t,i.startTime=(n-this.firstNoteTimestamp)/1e3,i.velocity=e,this.onNotes.set(t,i)}noteOff(t,e){const n=this.onNotes.get(t);n&&(n.endTime=(e-this.firstNoteTimestamp)/1e3,this.notes.push(n)),this.onNotes.delete(t)}}var P,F=n(83);class L{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=u.isQuantizedSequence(t),i=t.tempos&&t.tempos.length>0?t.tempos[0].qpm:void 0;this.noteSequence=n?u.unquantizeSequence(t,i):t,this.config={noteHeight:e.noteHeight||6,noteSpacing:e.noteSpacing||1,pixelsPerTimeStep:e.pixelsPerTimeStep||30,noteRGB:e.noteRGB||"8, 41, 64",activeNoteRGB:e.activeNoteRGB||"240, 84, 119",minPitch:e.minPitch,maxPitch:e.maxPitch};const r=this.getSize();this.width=r.width,this.height=r.height}updateMinMaxPitches(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.config.minPitch||!this.config.maxPitch){void 0===this.config.minPitch&&(this.config.minPitch=s.MAX_MIDI_PITCH),void 0===this.config.maxPitch&&(this.config.maxPitch=s.MIN_MIDI_PITCH);for(const t of this.noteSequence.notes)this.config.minPitch=Math.min(t.pitch,this.config.minPitch),this.config.maxPitch=Math.max(t.pitch,this.config.maxPitch);t||(this.config.minPitch-=2,this.config.maxPitch+=2)}}getSize(){this.updateMinMaxPitches();const t=(this.config.maxPitch-this.config.minPitch)*this.config.noteHeight,e=this.noteSequence.totalTime;if(!e)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:e*this.config.pixelsPerTimeStep,height:t}}getNotePosition(t,e){const n=this.getNoteEndTime(t)-this.getNoteStartTime(t),i=this.getNoteStartTime(t)*this.config.pixelsPerTimeStep,r=Math.max(this.config.pixelsPerTimeStep*n-this.config.noteSpacing,1);return{x:i,y:this.height-(t.pitch-this.config.minPitch)*this.config.noteHeight,w:r,h:this.config.noteHeight}}scrollIntoViewIfNeeded(t,e){if(t&&this.parentElement){const t=this.parentElement.getBoundingClientRect().width;e>this.parentElement.scrollLeft+t&&(this.parentElement.scrollLeft=e-20)}}getNoteStartTime(t){return Math.round(1e8*t.startTime)/1e8}getNoteEndTime(t){return Math.round(1e8*t.endTime)/1e8}isPaintingActiveNote(t,e){const n=this.getNoteStartTime(t)===this.getNoteStartTime(e),i=this.getNoteStartTime(t)<=this.getNoteStartTime(e)&&this.getNoteEndTime(t)>=this.getNoteEndTime(e);return n||i}}class B extends L{constructor(t,e){super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.ctx=e.getContext("2d"),this.parentElement=e.parentElement;const n=window.devicePixelRatio||1;this.ctx&&(this.ctx.canvas.width=n*this.width,this.ctx.canvas.height=n*this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.ctx.scale(n,n)),this.redraw()}redraw(t,e){let n;this.clear();for(let i=0;i<this.noteSequence.notes.length;i++){const e=this.noteSequence.notes[i],r=this.getNotePosition(e,i),s=.2,o=e.velocity?e.velocity/100+s:1,a=t&&this.isPaintingActiveNote(e,t),c="rgba(".concat(a?this.config.activeNoteRGB:this.config.noteRGB,",\n  ").concat(o,")");this.redrawNote(r.x,r.y,r.w,r.h,c),a&&e===t&&(n=r.x)}return this.scrollIntoViewIfNeeded(e,n),n}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}clearActiveNotes(){this.redraw()}redrawNote(t,e,n,i,r){this.ctx.fillStyle=r,this.ctx.fillRect(Math.round(t),Math.round(e),Math.round(n),Math.round(i))}}class z extends B{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),a.log("mm.Visualizer is deprecated, and will be removed in a future          version. Please use mm.PianoRollCanvasVisualizer instead","mm.Visualizer",5)}}class U extends L{constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.drawn=!1}redraw(t,e){if(this.drawn||this.draw(),!t)return null;let n;this.unfillActiveRect(this.svg);for(let i=0;i<this.noteSequence.notes.length;i++){const e=this.noteSequence.notes[i];if(!t||!this.isPaintingActiveNote(e,t))continue;const r=this.svg.querySelector('rect[data-index="'.concat(i,'"]'));this.fillActiveRect(r,e),e===t&&(n=parseFloat(r.getAttribute("x")))}return this.scrollIntoViewIfNeeded(e,n),n}fillActiveRect(t,e){t.setAttribute("fill",this.getNoteFillColor(e,!0)),t.classList.add("active")}unfillActiveRect(t){const e=t.querySelectorAll("rect.active");for(let n=0;n<e.length;++n){const t=e[n],i=this.getNoteFillColor(this.noteSequence.notes[parseInt(t.getAttribute("data-index"),10)],!1);t.setAttribute("fill",i),t.classList.remove("active")}}draw(){for(let t=0;t<this.noteSequence.notes.length;t++){const e=this.noteSequence.notes[t],n=this.getNotePosition(e,t),i=this.getNoteFillColor(e,!1),r=[["index",t],["instrument",e.instrument],["program",e.program],["isDrum",!0===e.isDrum],["pitch",e.pitch]],s=[["--midi-velocity",String(void 0!==e.velocity?e.velocity:127)]];this.drawNote(n.x,n.y,n.w,n.h,i,r,s)}this.drawn=!0}getNoteFillColor(t,e){const n=t.velocity?t.velocity/100+.2:1;return"rgba(".concat(e?this.config.activeNoteRGB:this.config.noteRGB,",\n  ").concat(n,")")}drawNote(t,e,n,i,r,s,o){if(!this.svg)return;const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.classList.add("note"),a.setAttribute("fill",r),a.setAttribute("x",""+Math.round(t)),a.setAttribute("y",""+Math.round(e)),a.setAttribute("width",""+Math.round(n)),a.setAttribute("height",""+Math.round(i)),s.forEach((t=>{let[e,n]=t;void 0!==n&&(a.dataset[e]=""+n)})),o.forEach((t=>{let[e,n]=t;a.style.setProperty(e,n)})),this.svg.appendChild(a)}clear(){this.svg.innerHTML="",this.drawn=!1}clearActiveNotes(){this.unfillActiveRect(this.svg)}}class j extends U{constructor(t,e){if(super(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),!(e instanceof SVGSVGElement))throw new Error("This visualizer requires an <svg> element to display the visualization");this.svg=e,this.parentElement=e.parentElement;const n=this.getSize();this.width=n.width,this.height=n.height,this.svg.style.width=this.width+"px",this.svg.style.height=this.height+"px",this.clear(),this.draw()}}class V extends U{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(super(t,n),this.NOTES_PER_OCTAVE=12,this.WHITE_NOTES_PER_OCTAVE=7,this.LOW_C=24,this.firstDrawnOctave=0,this.lastDrawnOctave=6,!(e instanceof HTMLDivElement))throw new Error("This visualizer requires a <div> element to display the visualization");this.config.whiteNoteWidth=n.whiteNoteWidth||20,this.config.blackNoteWidth=n.blackNoteWidth||2*this.config.whiteNoteWidth/3,this.config.whiteNoteHeight=n.whiteNoteHeight||70,this.config.blackNoteHeight=n.blackNoteHeight||140/3,this.config.showOnlyOctavesUsed=n.showOnlyOctavesUsed,this.setupDOM(e);const i=this.getSize();this.width=i.width,this.height=i.height,this.svg.style.width=this.width+"px",this.svg.style.height=this.height+"px",this.svgPiano.style.width=this.width+"px",this.svgPiano.style.height=this.config.whiteNoteHeight+"px",this.parentElement.style.width=this.width+this.config.whiteNoteWidth+"px",this.parentElement.scrollTop=this.parentElement.scrollHeight,this.clear(),this.drawPiano(),this.draw()}setupDOM(t){this.parentElement=document.createElement("div"),this.parentElement.classList.add("waterfall-notes-container");const e=Math.max(t.getBoundingClientRect().height,200);this.parentElement.style.paddingTop=e-this.config.whiteNoteHeight+"px",this.parentElement.style.height=e-this.config.whiteNoteHeight+"px",this.parentElement.style.boxSizing="border-box",this.parentElement.style.overflowX="hidden",this.parentElement.style.overflowY="auto",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgPiano=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.classList.add("waterfall-notes"),this.svgPiano.classList.add("waterfall-piano"),this.parentElement.appendChild(this.svg),t.innerHTML="",t.appendChild(this.parentElement),t.appendChild(this.svgPiano)}redraw(t,e){if(this.drawn||this.draw(),!t)return null;this.clearActiveNotes(),this.parentElement.style.paddingTop=this.parentElement.style.height;for(let n=0;n<this.noteSequence.notes.length;n++){const e=this.noteSequence.notes[n];if(!t||!this.isPaintingActiveNote(e,t))continue;const i=this.svg.querySelector('rect[data-index="'.concat(n,'"]'));this.fillActiveRect(i,e);const r=this.svgPiano.querySelector('rect[data-pitch="'.concat(e.pitch,'"]'));if(this.fillActiveRect(r,e),e===t){const t=parseFloat(i.getAttribute("y")),e=parseFloat(i.getAttribute("height"));return t<this.parentElement.scrollTop-e&&(this.parentElement.scrollTop=t+e),t}}return null}getSize(){this.updateMinMaxPitches(!0);let t=52;if(this.config.showOnlyOctavesUsed){let e=!1,n=!1;for(let t=1;t<7;t++){const i=this.LOW_C+this.NOTES_PER_OCTAVE*t;!e&&i>this.config.minPitch&&(this.firstDrawnOctave=t-1,e=!0),!n&&i>this.config.maxPitch&&(this.lastDrawnOctave=t-1,n=!0)}t=(this.lastDrawnOctave-this.firstDrawnOctave+1)*this.WHITE_NOTES_PER_OCTAVE}const e=t*this.config.whiteNoteWidth,n=this.noteSequence.totalTime;if(!n)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:e,height:Math.max(n*this.config.pixelsPerTimeStep,1)}}getNotePosition(t,e){const n=this.svgPiano.querySelector('rect[data-pitch="'.concat(t.pitch,'"]'));if(!n)return null;const i=this.getNoteEndTime(t)-this.getNoteStartTime(t),r=Number(n.getAttribute("x")),s=Number(n.getAttribute("width")),o=Math.max(this.config.pixelsPerTimeStep*i-this.config.noteSpacing,1);return{x:r,y:this.height-this.getNoteStartTime(t)*this.config.pixelsPerTimeStep-o,w:s,h:o}}drawPiano(){this.svgPiano.innerHTML="";const t=this.config.whiteNoteWidth-this.config.blackNoteWidth/2,e=[1,3,6,8,10];let n=0,i=0;this.config.showOnlyOctavesUsed?i=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C:(i=this.LOW_C-3,this.drawWhiteKey(i,n),this.drawWhiteKey(i+2,this.config.whiteNoteWidth),i+=3,n=2*this.config.whiteNoteWidth);for(let r=this.firstDrawnOctave;r<=this.lastDrawnOctave;r++)for(let t=0;t<this.NOTES_PER_OCTAVE;t++)-1===e.indexOf(t)&&(this.drawWhiteKey(i,n),n+=this.config.whiteNoteWidth),i++;this.config.showOnlyOctavesUsed?(i=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C,n=-this.config.whiteNoteWidth):(this.drawWhiteKey(i,n),i=this.LOW_C-3,this.drawBlackKey(i+1,t),i+=3,n=this.config.whiteNoteWidth);for(let r=this.firstDrawnOctave;r<=this.lastDrawnOctave;r++)for(let s=0;s<this.NOTES_PER_OCTAVE;s++)-1!==e.indexOf(s)?this.drawBlackKey(i,n+t):n+=this.config.whiteNoteWidth,i++}drawWhiteKey(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg","rect");return n.dataset.pitch=String(t),n.setAttribute("x",String(e)),n.setAttribute("y","0"),n.setAttribute("width",String(this.config.whiteNoteWidth)),n.setAttribute("height",String(this.config.whiteNoteHeight)),n.setAttribute("fill","white"),n.setAttribute("original-fill","white"),n.setAttribute("stroke","black"),n.setAttribute("stroke-width","3px"),n.classList.add("white"),this.svgPiano.appendChild(n),n}drawBlackKey(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg","rect");return n.dataset.pitch=String(t),n.setAttribute("x",String(e)),n.setAttribute("y","0"),n.setAttribute("width",String(this.config.blackNoteWidth)),n.setAttribute("height",String(this.config.blackNoteHeight)),n.setAttribute("fill","black"),n.setAttribute("original-fill","black"),n.setAttribute("stroke","black"),n.setAttribute("stroke-width","3px"),n.classList.add("black"),this.svgPiano.appendChild(n),n}clearActiveNotes(){super.unfillActiveRect(this.svg);const t=this.svgPiano.querySelectorAll("rect.active");for(let e=0;e<t.length;++e){const n=t[e];n.setAttribute("fill",n.getAttribute("original-fill")),n.classList.remove("active")}}}!function(t){t[t.PAGE=0]="PAGE",t[t.NOTE=1]="NOTE",t[t.BAR=2]="BAR"}(P||(P={}));class W extends L{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(t,n),(void 0===n.pixelsPerTimeStep||n.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0),this.instruments=n.instruments||[],this.render=new F.StaffSVGRender(this.getScoreInfo(t),{noteHeight:this.config.noteHeight,noteSpacing:this.config.noteSpacing,pixelsPerTimeStep:this.config.pixelsPerTimeStep,noteRGB:this.config.noteRGB,activeNoteRGB:this.config.activeNoteRGB,defaultKey:n.defaultKey||0,scrollType:n.scrollType||P.PAGE},e),this.drawnNotes=t.notes.length,this.clear(),this.redraw()}clear(){this.render.clear()}redraw(t,e){this.drawnNotes!==this.noteSequence.notes.length&&(this.render.scoreInfo=this.getScoreInfo(this.noteSequence));const n=t?this.getNoteInfo(t):void 0;return this.render.redraw(n,e)}isNoteInInstruments(t){return void 0===t.instrument||0===this.instruments.length||this.instruments.indexOf(t.instrument)>=0}timeToQuarters(t){const e=t*this.noteSequence.tempos[0].qpm/60;return Math.round(16*e)/16}getNoteInfo(t){const e=this.timeToQuarters(t.startTime);return{start:e,length:this.timeToQuarters(t.endTime)-e,pitch:t.pitch,intensity:t.velocity}}getScoreInfo(t){const e=[];return t.notes.forEach((t=>{this.isNoteInInstruments(t)&&e.push(this.getNoteInfo(t))})),{notes:e,tempos:t.tempos?t.tempos.map((t=>({start:this.timeToQuarters(t.time),qpm:t.qpm}))):[],keySignatures:t.keySignatures?t.keySignatures.map((t=>({start:this.timeToQuarters(t.time),key:t.key}))):[],timeSignatures:t.timeSignatures?t.timeSignatures.map((t=>({start:this.timeToQuarters(t.time),numerator:t.numerator,denominator:t.denominator}))):[]}}clearActiveNotes(){this.redraw()}}},function(t,e,n){"use strict";var i=n(86),r=n(91),s=n(45),o=n(92)({args:["array","array","scalar","scalar","scalar"],body:function(t,e,n,i,r){var s=e*n;s<i&&(s=i),s>r&&(s=r)}});t.exports=function(t,e,n,a){void 0===n&&(n=-1/0),void 0===a&&(a=1/0);var c=e.shape,l=t.shape;if(e.shape.length!==t.shape.length)throw new Error("ndarray-resample: input and output arrays should have the same dimensions");var u,h=c.map((function(){return 0}));if(1===t.size)return(u=s.sum(e)/e.size)<n&&(u=n),u>a&&(u=a),void t.set.apply(t,h.concat(u));if(1===e.size)return(u=e.get.apply(e,h))<n&&(u=n),u>a&&(u=a),void s.assigns(t,u);for(var d=c.length,p=new Array(d),f=!1,m=0;m<d;m++)p[m]=Math.min(l[m],c[m]),l[m]>c[m]&&(f=!0);var g=r.malloc(c),v=r.malloc(c);s.assign(g,e),s.assigns(v,0),i(1,g,v);var y=g.lo,x=g.hi,b=r.malloc(l),w=r.malloc(l);f&&(s.assigns(b,0),s.assigns(w,0));var S=new Array(d),_=new Array(d),T=new Array(d),E=new Array(d);for(m=0;m<1<<d;++m){for(var C=0;C<d;++C)if(m&1<<C){if(S[C]=p[C]-(p[C]+1>>>1),0===S[C])continue;_[C]=l[C]-S[C],T[C]=c[C]-S[C],E[C]=1&p[C]?0:1}else S[C]=p[C]+1>>>1,_[C]=0,T[C]=0,E[C]=0;s.assign(x.apply(y.apply(b,_),S),x.apply(y.apply(g,T),S)),s.assign(y.apply(x.apply(y.apply(w,_),S),E),y.apply(x.apply(y.apply(v,T),S),E)),s.assigns(x.apply(x.apply(y.apply(w,_),S),E),0)}i(-1,b,w),o(t,b,t.size/e.size,n,a),r.free(g),r.free(v),r.free(b),r.free(w)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){var e,n,i=c(t),o=i[0],a=i[1],l=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),u=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;return 2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,l[u++]=255&e),1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e),l},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,s=[],o=0,a=n-r;o<a;o+=16383)s.push(l(t,o,o+16383>a?a:o+16383));return 1===r?(e=t[n-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var r,s,o=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=t[e+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+t[e+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=l}return(p?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,c,l=8*s-r-1,u=(1<<l)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*c-1)*Math.pow(2,r),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,l+=r;l>0;t[n+p]=255&o,p+=f,o/=256,l-=8);t[n+p-f]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));const i="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:void 0!==t?t:t=>t();function r(){return new Promise((t=>i((()=>t()))))}}).call(this,n(170).setImmediate)},function(t,e,n){e.parseMidi=n(172),e.writeMidi=n(173)},function(t,e,n){"use strict";function i(t,e,n){void 0===n&&(n="ticks");var i=0,r=t.length,s=r;if(r>0&&t[r-1][n]<=e)return r-1;for(;i<s;){var o=Math.floor(i+(s-i)/2),a=t[o],c=t[o+1];if(a[n]===e){for(var l=o;l<t.length;l++)t[l][n]===e&&(o=l);return o}if(a[n]<e&&c[n]>e)return o;a[n]>e?s=o:a[n]<e&&(i=o+1)}return-1}Object.defineProperty(e,"__esModule",{value:!0}),e.search=i,e.insert=function(t,e,n){if(void 0===n&&(n="ticks"),t.length){var r=i(t,e[n],n);t.splice(r+1,0,e)}else t.push(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(80),r=n(82),s=n(176),o=n(177),a=n(178),c=n(180),l=new WeakMap,u=function(){function t(t,e){var n=this;if(this.name="",this.notes=[],this.controlChanges=s.createControlChanges(),this.pitchBends=[],l.set(this,e),t){var i=t.find((function(t){return"trackName"===t.type}));this.name=i?i.text:""}if(this.instrument=new a.Instrument(t,this),this.channel=0,t){for(var r=t.filter((function(t){return"noteOn"===t.type})),o=t.filter((function(t){return"noteOff"===t.type})),c=function(){var t=r.shift();u.channel=t.channel;var e=o.findIndex((function(e){return e.noteNumber===t.noteNumber&&e.absoluteTime>=t.absoluteTime}));if(-1!==e){var n=o.splice(e,1)[0];u.addNote({durationTicks:n.absoluteTime-t.absoluteTime,midi:t.noteNumber,noteOffVelocity:n.velocity/127,ticks:t.absoluteTime,velocity:t.velocity/127})}},u=this;r.length;)c();t.filter((function(t){return"controller"===t.type})).forEach((function(t){n.addCC({number:t.controllerType,ticks:t.absoluteTime,value:t.value/127})})),t.filter((function(t){return"pitchBend"===t.type})).forEach((function(t){n.addPitchBend({ticks:t.absoluteTime,value:t.value/Math.pow(2,13)})}))}}return t.prototype.addNote=function(t){var e=l.get(this),n=new c.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},e);return Object.assign(n,t),i.insert(this.notes,n,"ticks"),this},t.prototype.addCC=function(t){var e=l.get(this),n=new r.ControlChange({controllerType:t.number},e);return delete t.number,Object.assign(n,t),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),i.insert(this.controlChanges[n.number],n,"ticks"),this},t.prototype.addPitchBend=function(t){var e=l.get(this),n=new o.PitchBend({},e);return Object.assign(n,t),i.insert(this.pitchBends,n,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,e=0;e<this.notes.length-1;e++){var n=this.notes[e].time+this.notes[e].duration;t<n&&(t=n)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,e=0;e<this.notes.length-1;e++){var n=this.notes[e].ticks+this.notes[e].durationTicks;t<n&&(t=n)}return t},enumerable:!0,configurable:!0}),t.prototype.fromJSON=function(t){var e=this;for(var n in this.name=t.name,this.channel=t.channel,this.instrument=new a.Instrument(void 0,this),this.instrument.fromJSON(t.instrument),t.controlChanges)t.controlChanges[n]&&t.controlChanges[n].forEach((function(t){e.addCC({number:t.number,ticks:t.ticks,value:t.value})}));t.notes.forEach((function(t){e.addNote({durationTicks:t.durationTicks,midi:t.midi,ticks:t.ticks,velocity:t.velocity})}))},t.prototype.toJSON=function(){for(var t={},e=0;e<127;e++)this.controlChanges.hasOwnProperty(e)&&(t[e]=this.controlChanges[e].map((function(t){return t.toJSON()})));return{channel:this.channel,controlChanges:t,pitchBends:this.pitchBends.map((function(t){return t.toJSON()})),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map((function(t){return t.toJSON()}))}},t}();e.Track=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce((function(t,n){return t[e.controlChangeNames[n]]=n,t}),{});var i=new WeakMap,r=new WeakMap,s=function(){function t(t,e){i.set(this,e),r.set(this,t.controllerType),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"number",{get:function(){return r.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return i.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=i.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},t}();e.ControlChange=s},function(t,e,n){self,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";n.r(e),n.d(e,"SVGNS",(function(){return i})),n.d(e,"drawSVGPath",(function(){return r})),n.d(e,"drawSVGText",(function(){return s})),n.d(e,"createSVGGroupChild",(function(){return o})),n.d(e,"setFade",(function(){return a}));const i="http://www.w3.org/2000/svg";function r(t,e,n,r,s,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;const c=document.createElementNS(i,"path");return c.setAttributeNS(null,"d",e),c.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(r,") scale(").concat(s,", ").concat(o,")")),c.setAttributeNS(null,"opacity",""+a),t.appendChild(c),c}function s(t,e,n,r,s){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;const l=document.createElementNS(i,"text");l.setAttributeNS(null,"font-family","Times"),l.setAttributeNS(null,"font-size",s),o&&l.setAttributeNS(null,"font-weight","bold"),l.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(r,") scale(").concat(a,", ").concat(c,")"));const u=document.createTextNode(e);return l.appendChild(u),t.appendChild(l),l}function o(t,e){const n=document.createElementNS(i,"g");return n.setAttribute("data-id",e),t.appendChild(n),n}function a(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=t.querySelector("animate");if(!s){(s=document.createElementNS(i,"animate")).setAttributeNS(null,"attributeName","opacity"),s.setAttributeNS(null,"dur","4s"),s.setAttributeNS(null,"fill","freeze"),s.setAttributeNS(null,"keyTimes","0; 0.25; 0.5; 0.75; 1");const t=(n+3*r)/4;s.setAttributeNS(null,"values","".concat(n,"; ").concat(t,"; ").concat(r,"; ").concat(t,"; ").concat(n))}return e?s.setAttributeNS(null,"repeatCount","indefinite"):s.setAttributeNS(null,"repeatCount","1"),t.appendChild(s),t}},function(t,e,n){"use strict";n.r(e),n.d(e,"PATH_SCALE",(function(){return i})),n.d(e,"staffLinePath",(function(){return s})),n.d(e,"extraLinePath",(function(){return o})),n.d(e,"barPath",(function(){return a})),n.d(e,"stemPath",(function(){return c})),n.d(e,"singleFlagPath",(function(){return l})),n.d(e,"multiFlagPath",(function(){return u})),n.d(e,"tiePath",(function(){return h})),n.d(e,"dotPath",(function(){return d})),n.d(e,"NOTE_PATHS",(function(){return p})),n.d(e,"REST_PATHS",(function(){return f})),n.d(e,"CLEF_PATHS",(function(){return m})),n.d(e,"ACCIDENTAL_PATHS",(function(){return g}));const i=100,r="M 0,10 C 0,-15 35,-50 80,-50 110,-50 125,-35 125,-10 \n125,15 90,50 45,50 15,50 0,35 0,10 Z",s="m 0,0 h 100",o="m -25,0 h 175",a="m 0,-200 v 400",c="m 0,0 v 100 h 15 v -100 z",l="M0,0 h 12 c 7,100 175,156 62,314 79,-177 -49,\n-193 -61,-200 l -13,-5 z",u="m 0,0 h 10 c 6,72 173,64 84,227 44,-120 -44,\n-123 -94,-167 z",h="M 0,25 C 10,46 30,67 50,67 69,67 90,47 100,25 94,\n65 73,89 50,89 26,89 5,63 0,25 Z",d="M 5 -20 a 20 20 0 1 0 0.00001 0 z",p={4:{path:"m 0,0 c 0,-37 49,-51 79,-51 31,0 83,13 83,51 0,39 \n-55,51 -84,51 C 49,51 0,37 0,0 Z m 111,31 c 13,-19 0,-58 -22,-68 -33,-15 \n-53,10 -39,49 9,27 48,39 61,19 z",width:150,stemVSteps:0,stemAnchor:0,flags:0},2:{path:"m 0,10 c 0,-25 35,-60 80,-60 15,0 45,4 45,40 C 125,16 \n89,50 45,50 17,50 0,36 0,10 Z m 71,7 c 17,-11 45,-34 38,-45 -7,-10 -39,1 \n-57,12 -19,11 -42,31 -36,42 6,10 37,2 55,-9 z",width:125,stemVSteps:7,stemAnchor:-10,flags:0},1:{path:r,width:125,stemVSteps:7,stemAnchor:-10,flags:0},.5:{path:r,width:125,stemVSteps:7,stemAnchor:-10,flags:1},.25:{path:r,width:125,stemVSteps:9,stemAnchor:-10,flags:2},.125:{path:r,width:125,stemVSteps:11,stemAnchor:-10,flags:3},.0625:{path:r,width:125,stemVSteps:13,stemAnchor:-10,flags:4}},f={4:"m 0,-50 h 125 v -50 H 0 Z",2:"M 0,0 H 125 V -50 H 0 Z",1:"m 0,-25 c 39,-39 37,-75 8,-120 l 6,-5 61,103 C \n40,-13 31,4 73,71 l -5,5 C 14,52 16,125 67,144 l -4,6 C -37,102 -1,22 59,60 Z",.5:"m 52,-47 c 26,-2 42,-21 48,-42 l 12,4 L 64,83 52,79 \n88,-49 c 0,0 -17,22 -57,22 -16,0 -31,-13 -31,-27 0,-18 10,-31 27,-31 17,0 \n33,15 25,38 z",.25:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 l -36,128 12,4 77,-270 z",.125:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 L 68,20 C 61,37 46,51 24,52 32,29 16,14 -1,14 c \n-17,0 -27,13 -27,31 0,14 15,27 31,27 38,0 55,-20 57,-22 l -36,128 12,4 \n105,-369 z",.0625:"m 158,-292 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -17,61 \nv 0 c -6,21 -22,40 -48,42 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 \n15,27 31,27 40,0 57,-22 57,-22 l -20,69 c -7,18 -22,33 -45,35 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 L 68,20 C \n61,37 46,51 24,52 32,29 16,14 -1,14 c -17,0 -27,13 -27,31 0,14 15,27 31,27 \n38,0 55,-20 57,-22 l -36,128 12,4 134,-469 z"},m={50:{path:"m 101,-199 c -49,0 -100,28 -100,83 0,39 58,57 82,26 15,-20 \n-4,-47 -32,-47 -23,1 -25,0 -25,-8 0,-22 40,-46 71,-41 91,16 67,208 -105,302 \n75,-27 198,-94 211,-201 6,-66 -42,-114 -102,-114 z m 143,33 c -13,0 -23,11 \n-23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 z m 2,83 c \n-13,0 -23,11 -23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 \nz",upper:-4,lower:3},71:{path:"M 139,48 C 102,57 76,120 131,151 41,128 64,24 129,2 L \n117,-57 C -32,47 26,217 166,182 Z m 12,-1 27,131 C 242,153 216,46 151,47 \nZ m -35,-177 c 34,-23 82,-117 50,-140 -23,-17 -71,33 -50,140 z m -10,10 c \n-23,-77 -20,-200 48,-213 19,-4 89,171 -26,266 l 13,66 c 120,-6 137,155 \n39,191 l 12,58 c 30,131 -137,145 -138,47 0,-29 37,-59 63,-37 21,18 25,71 \n-25,70 32,42 103,0 91,-65 L 167,193 C 56,232 -112,63 106,-120 Z",upper:-7,lower:8}},g=[null,"m -49,-121 v 52 l -29,9 v -48 h -8 v 51 l -20,6 v 29 l \n20,-6 v 70 l -20,6 v 30 l 20,-6 v 51 h 8 V 69 l 30,-8 v 50 h 8 V 58 l 20,-6 \nV 23 l -20,6 v -71 l 20,-6 v -29 l -20,6 v -50 z m 1,82 v 71 l -29,9 v -71 z","M -106,-166 V 67 c 52,-42 85,-56 85,-94 0,-47 -46,-51 \n-73,-22 v -117 z m 31,120 c 20,0 42,46 -20,91 V -7 c 0,-28 10,-39 20,-39 z","m -81,-58 v -48 H -92 V 73 l 60,-13 v 50 h 11 V -72 Z m \n50,24 v 58 l -50,11 v -58 z"]},function(t,e,n){"use strict";n.r(e),n.d(e,"MIN_RESOLUTION",(function(){return i})),n.d(e,"STEM_WIDTH",(function(){return r})),n.d(e,"LINE_STROKE",(function(){return s})),n.d(e,"COMPACT_SPACING",(function(){return o}));const i=.0625,r=15,s=1,o=150},function(t,e,n){"use strict";n.r(e),n.d(e,"MAX_QUARTER_DIVISION",(function(){return c})),n.d(e,"ScrollType",(function(){return l})),n.d(e,"StaffSVGRender",(function(){return u}));var i=n(2),r=n(0),s=n(1);const o=[{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,0,1,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,0,3,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,2,0,0,2,0,2,0,0,3]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-7],accidental:[3,0,3,0,3,0,0,3,0,3,0,0]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,2,0,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,3,0,0]}],a=[{accidental:1,pitches:[]},{accidental:2,pitches:[70,75,68,73,66]},{accidental:1,pitches:[78,73]},{accidental:2,pitches:[70,75,68]},{accidental:1,pitches:[78,73,80,75]},{accidental:2,pitches:[70]},{accidental:2,pitches:[70,75,68,73,66,71]},{accidental:1,pitches:[78]},{accidental:2,pitches:[70,75,68,73]},{accidental:1,pitches:[78,73,80]},{accidental:2,pitches:[70,75]},{accidental:1,pitches:[78,73,80,75,70]}],c=16;var l;!function(t){t[t.PAGE=0]="PAGE",t[t.NOTE=1]="NOTE",t[t.BAR=2]="BAR"}(l||(l={}));class u{constructor(t,e,n){this.handleScrollEvent=t=>{this.lastKnownScrollLeft=this.parentElement.scrollLeft,this.ticking||window.requestAnimationFrame((()=>{this.changeAndDrawSignaturesIfNeeded(this.lastKnownScrollLeft),this.ticking=!1})),this.ticking=!0},this.scoreInfo=t,this.config={noteHeight:e.noteHeight||6,noteSpacing:e.noteSpacing||1,pixelsPerTimeStep:e.pixelsPerTimeStep||30,noteRGB:e.noteRGB||"8, 41, 64",activeNoteRGB:e.activeNoteRGB||"240, 84, 119"},this.div=n,this.timeSignatureNumerator=4,this.timeSignatureDenominator=4,this.key=e.defaultKey||0,this.scrollType=e.scrollType||l.PAGE,this.scale=this.config.noteHeight/s.PATH_SCALE,(void 0===e.pixelsPerTimeStep||e.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0,this.config.noteSpacing=i.COMPACT_SPACING*this.scale),this.clear(),this.redraw()}clear(){for(;this.div.lastChild;)this.div.removeChild(this.div.lastChild);this.div.style.overflow="visible",this.div.style.position="relative",this.overlaySVG=document.createElementNS(r.SVGNS,"svg"),this.overlaySVG.style.position="absolute",this.div.appendChild(this.overlaySVG),this.overlayG=Object(r.createSVGGroupChild)(this.overlaySVG,"overlay"),this.signaturesBlinking=!1,this.signaturesQuarters=0,this.parentElement=document.createElement("div"),this.parentElement.style.overflow="auto",this.div.appendChild(this.parentElement),this.ticking=!1,this.lastKnownScrollLeft=0,this.parentElement.addEventListener("scroll",this.handleScrollEvent),this.staffSVG=document.createElementNS(r.SVGNS,"svg"),this.parentElement.appendChild(this.staffSVG),this.staffG=Object(r.createSVGGroupChild)(this.staffSVG,"staff"),this.linesG=Object(r.createSVGGroupChild)(this.staffSVG,"lines"),this.setStroke(this.linesG),this.staffG.appendChild(this.linesG),this.musicG=Object(r.createSVGGroupChild)(this.staffSVG,"music"),this.setFill(this.musicG),this.setStroke(this.musicG,0),this.staffG.appendChild(this.musicG),this.signaturesG=Object(r.createSVGGroupChild)(this.staffSVG,"signatures"),this.staffG.appendChild(this.signaturesG);let t=0,e=0;this.scoreInfo.notes.forEach((n=>{t+=n.pitch,++e}));const n=t/e;this.clef=n<60?50:71,this.signaturesList=[{x:0,q:0}],this.signatureCurrent=0,this.signatureNext=0,this.changeKeySignatureIfNeeded(0),this.changeTimeSignatureIfNeeded(0),this.vStepSize=this.config.noteHeight/2,this.hStepSize=this.config.pixelsPerTimeStep,this.staffOffset=0,this.height=0,this.width=0,this.musicBlockMap=new Map,this.playingNotes=[],this.lastBar=0,this.barAccidentals={},this.lastQ=-1}isPaintingActiveNote(t,e){const n=t.start===e.start,i=t.start<=e.start&&t.start+t.length>=e.start+e.length;return n||i}redraw(t,e){let n=-1;const i=0===this.config.pixelsPerTimeStep;if(t){const s=[];this.playingNotes.forEach((e=>{this.isPaintingActiveNote(e,t)?s.push(e):this.highlightElement(this.getGroup(e),!1)})),this.playingNotes=s;const o=this.getGroup(t);if(o){this.playingNotes.push(t),this.highlightElement(o,!0),n=o.getBoundingClientRect().left-this.staffSVG.getBoundingClientRect().left;const s=t.start,a=o.getAttribute("data-is-bar-beginning");(this.scrollType!==l.BAR||a)&&this.scrollIntoViewIfNeeded(e,n),!i&&this.signaturesBlinking&&s>=this.signaturesQuarters&&(this.signaturesBlinking=!1,Object(r.setFade)(this.overlayG,this.signaturesBlinking))}}else{this.setDetails();const t=-1===this.lastQ;let e=0,n=0;t?(n=this.drawSignatures(this.overlayG,e,!0,!0,!0),i&&(this.width=0,n+=this.config.noteSpacing),n+=this.drawRests(this.initialRest,e+n)):e=this.width,this.musicBlockMap.forEach(((t,r)=>{i||(e=this.quartersToTime(r)*this.hStepSize),r>this.lastQ?(n+=this.drawMusicBlock(t,e+n),this.lastQ=r):r===this.lastQ&&(n+=this.drawRests(t,e+n))}));const r=this.staffSVG.getBoundingClientRect(),s=this.musicG.getBoundingClientRect();if(this.updateVerticalBoundaries(s.top-r.top,s.bottom-r.top),i)this.width+=n;else{const t=this.musicBlockMap.get(this.lastQ),e=this.quartersToTime(this.lastQ+t.notes[0].length);this.width=e*this.config.pixelsPerTimeStep}this.staffSVG.setAttributeNS(null,"width",""+this.width),this.redrawStaff(this.linesG,0,this.width)}return n}drawMusicBlock(t,e){const n=t.notes[0].start;let o=this.drawBarIfNeeded(n,e);o+=this.drawSignaturesIfNeeded(n,e+o);let a=0;for(let r=4;r>=i.MIN_RESOLUTION&&!a;r/=2)r<=t.notes[0].length&&(a=r);if(0===a){const e=0===t.notes[0].length?"[infinite]":""+4/t.notes[0].length;console.warn(" StaffRender ","background:orange; color:white","StaffRender does not handle notes shorther than 1/".concat(4/i.MIN_RESOLUTION,"th, and this score tries to draw a 1/").concat(e,"th. Shortest possible note will be drawn instead.")),a=i.MIN_RESOLUTION}const c=s.NOTE_PATHS[a];let l;if(c.stemAnchor&&(l=Object(r.createSVGGroupChild)(this.musicG,"stem")),t.notes.forEach((n=>{const i=n.vSteps*this.vStepSize,l=2*(n.vSteps>0?Math.floor(n.vSteps/2):Math.ceil(n.vSteps/2)),u=n.vSteps>0?-2:2;for(let t=l;Math.abs(t)>4;t+=u)Object(r.drawSVGPath)(this.linesG,s.extraLinePath,e+o,t*this.vStepSize,this.scale,1);if(n.g=n.tiedFrom?n.tiedFrom.g:Object(r.createSVGGroupChild)(this.musicG,"".concat(n.start,"-").concat(n.pitch)),t.isBarBeginning&&n.g.setAttribute("data-is-bar-beginning","true"),n.tiedFrom){const t=e+o-n.tiedFrom.xHeadRight;Object(r.drawSVGPath)(n.g,s.tiePath,n.tiedFrom.xHeadRight,i,t/s.PATH_SCALE,this.scale*(n.vSteps<0?-1:1),n.opacity)}Object(r.drawSVGPath)(n.g,c.path,e+o,i,this.scale,this.scale,n.opacity),n.xHeadRight=e+o+c.width*this.scale,1.5*a<=n.length&&Object(r.drawSVGPath)(n.g,s.dotPath,e+o+c.width*this.scale+this.vStepSize/2,i-this.vStepSize/2,this.scale,this.scale,n.opacity),0!==n.accidental&&Object(r.drawSVGPath)(n.g,s.ACCIDENTAL_PATHS[n.accidental],e+o,i,this.scale,this.scale,n.opacity)})),c.stemAnchor){let n,a,u=e+o;const h=c.stemAnchor*this.scale,d=t.minVStep+t.maxVStep<0,p=c.flags>2?2*(c.flags-2):0;if(d?(n=t.maxVStep*this.vStepSize-h,a=(t.minVStep+7+p)*this.vStepSize):(u+=(c.width-i.STEM_WIDTH)*this.scale,n=t.minVStep*this.vStepSize+h,a=(t.maxVStep-7-p)*this.vStepSize),Object(r.drawSVGPath)(l,s.stemPath,u,n,this.scale,(a-n)/s.PATH_SCALE),1===c.flags)Object(r.drawSVGPath)(l,s.singleFlagPath,u,a,this.scale,this.scale*(d?-1:1),1);else if(c.flags>1)for(let t=0;t<c.flags;++t)Object(r.drawSVGPath)(l,s.multiFlagPath,u,a,this.scale,this.scale*(d?-1:1),1),a+=(d?-2:2)*this.vStepSize}return 0===this.config.pixelsPerTimeStep&&(o+=c.width*this.scale,l&&(o+=l.getBoundingClientRect().width),o+=this.config.noteSpacing),o+=this.drawRests(t,e+o)}drawBarIfNeeded(t,e){let n=0;const i=this.lastBar+this.getBarLength();return 0!==t&&t>=i&&(this.config.pixelsPerTimeStep>0?e-=this.config.noteSpacing:n=this.config.noteSpacing,Object(r.drawSVGPath)(this.linesG,s.barPath,e,0,1,this.scale),this.lastBar=i),n}drawRests(t,e){let n=0,o=t.restToNextLength;if(o){this.config.pixelsPerTimeStep>0&&(e+=this.quartersToTime(t.notes[0].length)*this.hStepSize);let a=t.notes[0].start+t.notes[0].length,c=0;const l=this.lastBar+this.getBarLength()-a;let u;for(o>l&&(c=o-l,o=l),u=4;u>this.getBarLength()&&u>=i.MIN_RESOLUTION;u/=2);let h=u;for(;(o||c)&&h>=i.MIN_RESOLUTION;){if(h<=o){n+=this.drawBarIfNeeded(a,e+n),n+=this.drawSignaturesIfNeeded(a,e+n);const t=Object(r.drawSVGPath)(this.musicG,s.REST_PATHS[h],e+n,0,this.scale,this.scale);this.config.pixelsPerTimeStep>0?e+=this.quartersToTime(h)*this.hStepSize:(n+=t.getBoundingClientRect().width,n+=this.config.noteSpacing),a+=h,o-=h}if(c&&o<=0){const t=this.getBarLength();for(c>t?(o=t,c-=t):(o=c,c=0),u=4;u>this.getBarLength()&&u>=i.MIN_RESOLUTION;u/=2);h=u}o<h&&(h/=2)}}return n}redrawStaff(t,e,n){let i=t.querySelector('g[data-id="staff-five-lines"]');if(i)i.setAttributeNS(null,"transform","scale(".concat(n/s.PATH_SCALE,", 1)"));else{i=Object(r.createSVGGroupChild)(t,"staff-five-lines");const o=0;for(let t=-4;t<=4;t+=2)Object(r.drawSVGPath)(i,s.staffLinePath,e,o+t*this.vStepSize,n/s.PATH_SCALE,1)}return i}clearSignatureOverlay(){for(;this.overlayG.lastChild;)this.overlayG.removeChild(this.overlayG.lastChild)}drawSignaturesIfNeeded(t,e){let n=0;const s=this.changeKeySignatureIfNeeded(t),o=this.changeTimeSignatureIfNeeded(t);if(s||o){const a=i.COMPACT_SPACING*this.scale*(this.config.pixelsPerTimeStep>0?3:2);this.signaturesList.push({x:e-a,q:t}),null===this.signatureNext&&(this.signatureNext=e);const c=t>0?Object(r.createSVGGroupChild)(this.signaturesG,"signatures"):this.overlayG;n+=this.drawSignatures(c,e+n,!1,s,o)}return 0===this.config.pixelsPerTimeStep?n:0}drawSignatures(t,e,n,o,c){const l=i.COMPACT_SPACING*this.scale;let u,h=l;const d=t===this.overlayG||this.config.pixelsPerTimeStep>0;if(d){(u=document.createElementNS(r.SVGNS,"rect")).setAttributeNS(null,"x",""+e),u.setAttributeNS(null,"y","0"),u.setAttributeNS(null,"width","1"),u.setAttributeNS(null,"height","1"),u.setAttribute("data-id","background"),t.appendChild(u);const n=document.defaultView.getComputedStyle(this.div.parentElement);u.setAttributeNS(null,"fill",n.getPropertyValue("background-color"))}if(n){const n=Object(r.drawSVGPath)(t,s.CLEF_PATHS[this.clef].path,e+h,0,this.scale,this.scale);this.setFill(n),h+=3*l}if(o){const n=a[this.key].accidental,i=71===this.clef?0:14;a[this.key].pitches.forEach((o=>{const a=this.getPitchDetails(o).vSteps,c=Object(r.drawSVGPath)(t,s.ACCIDENTAL_PATHS[n],e+h,(i+a)*this.vStepSize,this.scale,this.scale);this.setFill(c),h+=c.getBoundingClientRect().width}))}if(c){const n=Object(r.createSVGGroupChild)(t,"time-key"),i=2.85*this.config.noteHeight+"px";Object(r.drawSVGText)(n,""+this.timeSignatureNumerator,e+h,-.5,i,!0),Object(r.drawSVGText)(n,""+this.timeSignatureDenominator,e+h,4*this.vStepSize-.5,i,!0),this.setFill(n),h+=n.getBoundingClientRect().width+l}const p=this.redrawStaff(t,e,h);this.setStroke(p);const f=this.div.getBoundingClientRect(),m=t.getBoundingClientRect();if(this.updateVerticalBoundaries(m.top-f.top,m.bottom-f.top),d&&(u.setAttributeNS(null,"y",""+-this.staffOffset),u.setAttributeNS(null,"height",""+this.height),u.setAttributeNS(null,"width",""+h)),t===this.overlayG){this.overlaySVG.setAttributeNS(null,"width",""+(h+5));for(let e=0;e<5;++e){const n=Object(r.drawSVGPath)(t,s.stemPath,h+e,e*e-this.staffOffset,1/i.STEM_WIDTH,(this.height-2*e*e)/s.PATH_SCALE,(e-5)*(e-5)*2/s.PATH_SCALE);this.setFill(n)}}if(this.config.pixelsPerTimeStep>0){const n=0===this.signaturesQuarters;return n&&(this.signaturesQuarters=this.timeToQuarters(h/this.hStepSize)),(n||e>0)&&(this.signaturesBlinking=!0,Object(r.setFade)(t,this.signaturesBlinking)),0}return h}changeKeySignatureIfNeeded(t){if(this.scoreInfo.keySignatures){let e=this.key;for(let n=0;n<this.scoreInfo.keySignatures.length&&this.scoreInfo.keySignatures[n].start<=t;++n)e=this.scoreInfo.keySignatures[n].key;if(e!==this.key)return this.key=e,!0}return!1}changeTimeSignatureIfNeeded(t){if(this.scoreInfo.timeSignatures){let e=this.timeSignatureNumerator,n=this.timeSignatureDenominator;for(let i=0;i<this.scoreInfo.timeSignatures.length&&this.scoreInfo.timeSignatures[i].start<=t;++i)e=this.scoreInfo.timeSignatures[i].numerator,n=this.scoreInfo.timeSignatures[i].denominator;if(e!==this.timeSignatureNumerator||n!==this.timeSignatureDenominator)return this.timeSignatureNumerator=e,this.timeSignatureDenominator=n,!0}return!1}changeAndDrawSignaturesIfNeeded(t){let e;if(t<this.signatureCurrent||null!==this.signatureNext&&this.signatureNext<=t){e=this.signaturesList[0].q,this.signatureNext=null;for(let n=0;n<this.signaturesList.length;++n){if(t<this.signaturesList[n].x){this.signatureNext=this.signaturesList[n].x;break}this.signatureCurrent=this.signaturesList[n].x,e=this.signaturesList[n].q}}if(void 0!==e){const t=this.key,n=this.timeSignatureNumerator,i=this.timeSignatureDenominator;this.changeKeySignatureIfNeeded(e),this.changeTimeSignatureIfNeeded(e),this.clearSignatureOverlay(),this.drawSignatures(this.overlayG,0,!0,!0,!0),this.key=t,this.timeSignatureNumerator=n,this.timeSignatureDenominator=i}this.config.pixelsPerTimeStep>0&&0===t&&(this.signatureNext=0,this.signaturesBlinking=!0,Object(r.setFade)(this.overlayG,this.signaturesBlinking))}getBarLength(){return 4*this.timeSignatureNumerator/this.timeSignatureDenominator}scrollIntoViewIfNeeded(t,e){if(t)if(this.scrollType===l.PAGE){const t=this.parentElement.getBoundingClientRect().width;e>this.parentElement.scrollLeft+t&&(this.parentElement.scrollLeft=e-20)}else{const t=this.parentElement.getBoundingClientRect().width;this.parentElement.scrollLeft=e-.5*t}}updateVerticalBoundaries(t,e){let n=0;if(t<0){this.staffOffset-=t;const e="translate(0, ".concat(this.staffOffset,")");this.overlayG.setAttributeNS(null,"transform",e),this.staffG.setAttributeNS(null,"transform",e),n=this.height-t}if((n=Math.max(n,e-t))>this.height){this.height=n,this.overlaySVG.setAttributeNS(null,"height",""+this.height),this.staffSVG.setAttributeNS(null,"height",""+this.height);const t=this.div.querySelectorAll('rect[data-id="background"]');for(let e=0;e<t.length;++e){const n=t[e];n.setAttributeNS(null,"y",""+-this.staffOffset),n.setAttributeNS(null,"height",""+this.height)}}}setFill(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.setAttributeNS(null,"fill",this.getColor(e))}setStroke(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.LINE_STROKE,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.setAttributeNS(null,"stroke",this.getColor(n)),t.setAttributeNS(null,"stroke-width",""+e)}getColor(t){return"rgb(".concat(t?this.config.activeNoteRGB:this.config.noteRGB,")")}getOpacity(t){return t?t/127*.8+.2:1}getGroup(t){const e=t.start,n=t.pitch;return this.staffSVG.querySelector('g[data-id="'.concat(e,"-").concat(n,'"]'))}highlightElement(t,e){t.setAttribute("fill",this.getColor(e)),t.setAttribute("stroke",this.getColor(e))}getBarBeginnings(){const t=new Set;let e=0;this.scoreInfo.notes.forEach((t=>{t.start+t.length>e&&(e=t.start+t.length)}));const n=this.scoreInfo.timeSignatures?this.scoreInfo.timeSignatures.slice(0):[{start:0,numerator:4,denominator:4}];n.sort(((t,e)=>t.start-e.start));let i=0;for(let r=0;r<n.length;++r){const s=r===n.length-1?e:n[r].start,o=4*n[r].numerator/n[r].denominator;for(;i<s;i+=o)t.add(i)}return t}quartersToTime(t){return t/this.scoreInfo.tempos[0].qpm*60}timeToQuarters(t){return t*this.scoreInfo.tempos[0].qpm/60}setDetails(){let t=new Map;const e=this.getBarBeginnings(),n=new Set(e);this.scoreInfo.notes.slice().sort(((t,e)=>t.start-e.start)).forEach((e=>{const i=this.getQNote(e);n.add(i.start),n.add(i.start+i.length),t.has(i.start)?t.get(i.start).push(i):t.set(i.start,[i])})),Array.from(n).sort(((t,e)=>t-e)).forEach((e=>{const n=[];t.forEach((t=>{t.forEach((t=>{const i=this.splitQNote(t,e);i&&n.push(i)}))})),n.forEach((e=>{t.has(e.start)?t.get(e.start).push(e):t.set(e.start,[e])}))})),t=new Map(Array.from(t).sort(((t,e)=>t[0]-e[0])));const i=this.key;let r=null,s=0;const o=e[Symbol.iterator]();let a=o.next();t.forEach(((t,e)=>{const n={maxVStep:Number.MAX_SAFE_INTEGER,minVStep:Number.MIN_SAFE_INTEGER,restToNextLength:0,isBarBeginning:!1,notes:[]};this.changeKeySignatureIfNeeded(e);const i=a.value+this.getBarLength();!a.done&&e>=i&&(a=o.next(),this.barAccidentals={},n.isBarBeginning=!0),t.forEach((t=>{this.analyzePitch(t,e),n.minVStep=Math.max(t.vSteps,n.minVStep),n.maxVStep=Math.min(t.vSteps,n.maxVStep),n.notes.push(t)})),r&&(r.restToNextLength=e-s),this.musicBlockMap.set(e,n),r=n,s=e+n.notes[0].length})),this.initialRest={maxVStep:0,minVStep:0,restToNextLength:this.musicBlockMap.values().next().value.notes[0].start,isBarBeginning:!0,notes:[{start:0,length:0,vSteps:0,accidental:0,opacity:0,pitch:0,xHeadRight:0}]},this.key=i}getQNote(t){return{start:t.start,length:t.length,vSteps:0,accidental:0,opacity:this.getOpacity(t.intensity),pitch:t.pitch,xHeadRight:0}}splitQNote(t,e){const n=t.start+t.length-e;return e>t.start&&n>0?(t.length-=n,{start:e,length:n,vSteps:t.vSteps,accidental:t.accidental,opacity:t.opacity,pitch:t.pitch,xHeadRight:0,tiedFrom:t}):null}analyzePitch(t,e){const n=this.getPitchDetails(t.pitch);n.vSteps in this.barAccidentals?n.accidental===this.barAccidentals[n.vSteps]?n.accidental=0:(3===this.barAccidentals[n.vSteps]?n.accidental=n.keyAccidental:0===n.accidental&&(n.accidental=3),this.barAccidentals[n.vSteps]=n.accidental):(t.tiedFrom&&(n.accidental=0),this.barAccidentals[n.vSteps]=n.accidental),t.vSteps=n.vSteps,t.accidental=n.accidental}getPitchDetails(t){const e=t-60,n=Math.floor(e/12),i=e-12*n,r=o[this.key].steps[i],s=71===this.clef?6:-6,c=1===a[this.key].accidental?69+(i+3)%12:64+(i+8)%12;return{vSteps:s-7*n+r,accidental:o[this.key].accidental[i],keyAccidental:a[this.key].pitches.indexOf(c)>-1?a[this.key].accidental:0}}}},function(t,e,n){"use strict";n.r(e);var i=n(3);n.d(e,"MAX_QUARTER_DIVISION",(function(){return i.MAX_QUARTER_DIVISION})),n.d(e,"ScrollType",(function(){return i.ScrollType})),n.d(e,"StaffSVGRender",(function(){return i.StaffSVGRender}))}])},function(t,e,n){"use strict";t.exports=function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return e}},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){"use strict";var i=n(45),r=n(30),s=n(71),o=n(90);t.exports=function(t,e,n){var a,c,l=e.shape,u=l.length,h=1,d=new Array(u),p=0;for(a=u-1;a>=0;--a)if(d[a]=h,h*=l[a],p=Math.max(p,o.scratchMemory(l[a])),e.shape[a]!==n.shape[a])throw new Error("Shape mismatch, real and imaginary arrays must have same size");var f,m=4*h+p;f="array"===e.dtype||"float64"===e.dtype||"custom"===e.dtype?s.mallocDouble(m):s.mallocFloat(m);var g,v,y,x,b=r(f,l.slice(0),d,0),w=r(f,l.slice(0),d.slice(0),h),S=r(f,l.slice(0),d.slice(0),2*h),_=r(f,l.slice(0),d.slice(0),3*h),T=4*h;for(i.assign(b,e),i.assign(w,n),a=u-1;a>=0&&(o(t,h/l[a],l[a],f,b.offset,w.offset,T),0!==a);--a){for(v=1,y=S.stride,x=_.stride,c=a-1;c<u;++c)x[c]=y[c]=v,v*=l[c];for(c=a-2;c>=0;--c)x[c]=y[c]=v,v*=l[c];i.assign(S,b),i.assign(_,w),g=b,b=S,S=g,g=w,w=_,_=g}i.assign(e,b),i.assign(n,w),s.free(f)}},function(t,e,n){"use strict";var i=n(88);t.exports=function(t){var e=["'use strict'","var CACHED={}"],n=[],r=t.funcName+"_cwise_thunk";e.push(["return function ",r,"(",t.shimArgs.join(","),"){"].join(""));for(var s=[],o=[],a=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],c=[],l=[],u=0;u<t.arrayArgs.length;++u){var h=t.arrayArgs[u];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),s.push("t"+h),s.push("r"+h),o.push("t"+h),o.push("r"+h+".join()"),a.push("array"+h+".data"),a.push("array"+h+".stride"),a.push("array"+h+".offset|0"),u>0&&(c.push("array"+t.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[u]))),l.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[u])+"]"))}for(t.arrayArgs.length>1&&(e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}")),u=0;u<t.scalarArgs.length;++u)a.push("scalar"+t.scalarArgs[u]);return n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",s.join(","),"])}","return proc(",a.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------"),new Function("compile",e.join("\n"))(i.bind(void 0,t))}},function(t,e,n){"use strict";var i=n(70);function r(t,e,n){var i,r,s=t.length,o=e.arrayArgs.length,a=e.indexArgs.length>0,c=[],l=[],u=0,h=0;for(i=0;i<s;++i)l.push(["i",i,"=0"].join(""));for(r=0;r<o;++r)for(i=0;i<s;++i)h=u,u=t[i],0===i?l.push(["d",r,"s",i,"=t",r,"p",u].join("")):l.push(["d",r,"s",i,"=(t",r,"p",u,"-s",h,"*t",r,"p",h,")"].join(""));for(l.length>0&&c.push("var "+l.join(",")),i=s-1;i>=0;--i)u=t[i],c.push(["for(i",i,"=0;i",i,"<s",u,";++i",i,"){"].join(""));for(c.push(n),i=0;i<s;++i){for(h=u,u=t[i],r=0;r<o;++r)c.push(["p",r,"+=d",r,"s",i].join(""));a&&(i>0&&c.push(["index[",h,"]-=s",h].join("")),c.push(["++index[",u,"]"].join(""))),c.push("}")}return c.join("\n")}function s(t,e,n){for(var i=t.body,r=[],s=[],o=0;o<t.args.length;++o){var a=t.args[o];if(!(a.count<=0)){var c=new RegExp(a.name,"g"),l="",u=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var h=e.offsetArgIndex.indexOf(o);u=e.offsetArgs[h].array,l="+q"+h;case"array":l="p"+u+l;var d="l"+o,p="a"+u;if(0===e.arrayBlockIndices[u])1===a.count?"generic"===n[u]?a.lvalue?(r.push(["var ",d,"=",p,".get(",l,")"].join("")),i=i.replace(c,d),s.push([p,".set(",l,",",d,")"].join(""))):i=i.replace(c,[p,".get(",l,")"].join("")):i=i.replace(c,[p,"[",l,"]"].join("")):"generic"===n[u]?(r.push(["var ",d,"=",p,".get(",l,")"].join("")),i=i.replace(c,d),a.lvalue&&s.push([p,".set(",l,",",d,")"].join(""))):(r.push(["var ",d,"=",p,"[",l,"]"].join("")),i=i.replace(c,d),a.lvalue&&s.push([p,"[",l,"]=",d].join("")));else{for(var f=[a.name],m=[l],g=0;g<Math.abs(e.arrayBlockIndices[u]);g++)f.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(g+1)+"*t"+u+"b"+g);if(c=new RegExp(f.join(""),"g"),l=m.join("+"),"generic"===n[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");i=i.replace(c,[p,"[",l,"]"].join(""))}break;case"scalar":i=i.replace(c,"Y"+e.scalarArgs.indexOf(o));break;case"index":i=i.replace(c,"index");break;case"shape":i=i.replace(c,"shape")}}}return[r.join("\n"),i,s.join("\n")].join("\n").trim()}function o(t){for(var e=new Array(t.length),n=!0,i=0;i<t.length;++i){var r=t[i],s=r.match(/\d+/);s=s?s[0]:"",0===r.charAt(0)?e[i]="u"+r.charAt(1)+s:e[i]=r.charAt(0)+s,i>0&&(n=n&&e[i]===e[i-1])}return n?e[0]:e.join("")}t.exports=function(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,a=new Array(t.arrayArgs.length),c=new Array(t.arrayArgs.length),l=0;l<t.arrayArgs.length;++l)c[l]=e[2*l],a[l]=e[2*l+1];var u=[],h=[],d=[],p=[],f=[];for(l=0;l<t.arrayArgs.length;++l){t.arrayBlockIndices[l]<0?(d.push(0),p.push(n),u.push(n),h.push(n+t.arrayBlockIndices[l])):(d.push(t.arrayBlockIndices[l]),p.push(t.arrayBlockIndices[l]+n),u.push(0),h.push(t.arrayBlockIndices[l]));for(var m=[],g=0;g<a[l].length;g++)d[l]<=a[l][g]&&a[l][g]<p[l]&&m.push(a[l][g]-d[l]);f.push(m)}var v=["SS"],y=["'use strict'"],x=[];for(g=0;g<n;++g)x.push(["s",g,"=SS[",g,"]"].join(""));for(l=0;l<t.arrayArgs.length;++l){for(v.push("a"+l),v.push("t"+l),v.push("p"+l),g=0;g<n;++g)x.push(["t",l,"p",g,"=t",l,"[",d[l]+g,"]"].join(""));for(g=0;g<Math.abs(t.arrayBlockIndices[l]);++g)x.push(["t",l,"b",g,"=t",l,"[",u[l]+g,"]"].join(""))}for(l=0;l<t.scalarArgs.length;++l)v.push("Y"+l);if(t.shapeArgs.length>0&&x.push("shape=SS.slice(0)"),t.indexArgs.length>0){var b=new Array(n);for(l=0;l<n;++l)b[l]="0";x.push(["index=[",b.join(","),"]"].join(""))}for(l=0;l<t.offsetArgs.length;++l){var w=t.offsetArgs[l],S=[];for(g=0;g<w.offset.length;++g)0!==w.offset[g]&&(1===w.offset[g]?S.push(["t",w.array,"p",g].join("")):S.push([w.offset[g],"*t",w.array,"p",g].join("")));0===S.length?x.push("q"+l+"=0"):x.push(["q",l,"=",S.join("+")].join(""))}var _=i([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));for((x=x.concat(_)).length>0&&y.push("var "+x.join(",")),l=0;l<t.arrayArgs.length;++l)y.push("p"+l+"|=0");t.pre.body.length>3&&y.push(s(t.pre,t,c));var T=s(t.body,t,c),E=function(t){for(var e=0,n=t[0].length;e<n;){for(var i=1;i<t.length;++i)if(t[i][e]!==t[0][e])return e;++e}return e}(f);E<n?y.push(function(t,e,n,i){for(var s=e.length,o=n.arrayArgs.length,a=n.blockSize,c=n.indexArgs.length>0,l=[],u=0;u<o;++u)l.push(["var offset",u,"=p",u].join(""));for(u=t;u<s;++u)l.push(["for(var j"+u+"=SS[",e[u],"]|0;j",u,">0;){"].join("")),l.push(["if(j",u,"<",a,"){"].join("")),l.push(["s",e[u],"=j",u].join("")),l.push(["j",u,"=0"].join("")),l.push(["}else{s",e[u],"=",a].join("")),l.push(["j",u,"-=",a,"}"].join("")),c&&l.push(["index[",e[u],"]=j",u].join(""));for(u=0;u<o;++u){for(var h=["offset"+u],d=t;d<s;++d)h.push(["j",d,"*t",u,"p",e[d]].join(""));l.push(["p",u,"=(",h.join("+"),")"].join(""))}for(l.push(r(e,n,i)),u=t;u<s;++u)l.push("}");return l.join("\n")}(E,f[0],t,T)):y.push(r(f[0],t,T)),t.post.body.length>3&&y.push(s(t.post,t,c)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+y.join("\n")+"\n----------");var C=[t.funcName||"unnamed","_cwise_loop_",a[0].join("s"),"m",E,o(c)].join("");return new Function(["function ",C,"(",v.join(","),"){",y.join("\n"),"} return ",C].join(""))()}},function(t,e,n){"use strict";t.exports=function(t,e){switch(void 0===e&&(e=0),typeof t){case"number":if(t>0)return function(t,e){var n,i;for(n=new Array(t),i=0;i<t;++i)n[i]=e;return n}(0|t,e);break;case"object":if("number"==typeof t.length)return function t(e,n,i){var r=0|e[i];if(r<=0)return[];var s,o=new Array(r);if(i===e.length-1)for(s=0;s<r;++s)o[s]=n;else for(s=0;s<r;++s)o[s]=t(e,n,i+1);return o}(t,e,0)}return[]}},function(t,e,n){var i=n(72);function r(t,e,n,r,s,o){var a,c,l,u,h,d,p,f,m,g,v,y,x,b,w,S,_,T,E,C,k,A,I,O;for(t|=0,e|=0,s|=0,o|=0,a=n|=0,c=i.log2(a),T=0;T<e;++T){for(p=a>>1,h=0,l=0;l<a-1;l++){for(l<h&&(x=r[s+l],r[s+l]=r[s+h],r[s+h]=x,x=r[o+l],r[o+l]=r[o+h],r[o+h]=x),d=p;d<=h;)h-=d,d>>=1;h+=d}for(v=-1,y=0,g=1,f=0;f<c;f++){for(m=g,g<<=1,S=1,_=0,h=0;h<m;h++){for(l=h;l<a;l+=g)E=r[s+(u=l+m)],C=r[o+u],k=r[s+l],A=r[o+l],b=(I=S*(E+C))-C*(S+_),w=I+(O=E*(_-S)),r[s+u]=k-b,r[o+u]=A-w,r[s+l]+=b,r[o+l]+=w;O=S*(y-v),S=(I=v*(S+_))-_*(v+y),_=I+O}y=Math.sqrt((1-v)/2),t<0&&(y=-y),v=Math.sqrt((1+v)/2)}if(t<0){var R=1/a;for(l=0;l<a;l++)r[s+l]*=R,r[o+l]*=R}s+=n,o+=n}}t.exports=function(t,e,n,s,o,a,c){t|=0,e|=0,n|=0,o|=0,a|=0,i.isPow2(n)?r(t,e,n,s,o,a):function(t,e,n,s,o,a,c){t|=0,e|=0,n|=0,o|=0,a|=0,c|=0;var l,u,h,d,p,f,m,g,v,y=i.nextPow2(2*n+1),x=c,b=x+n,w=b+n,S=w+y,_=S+y,T=_+y,E=-t*Math.PI/n;for(v=0;v<n;++v)u=E*(v*v%(2*n)),d=Math.cos(u),p=Math.sin(u),s[_+(y-v)]=s[_+v]=s[x+v]=d,s[T+(y-v)]=s[T+v]=s[b+v]=p;for(v=n;v<=y-n;++v)s[_+v]=0;for(v=n;v<=y-n;++v)s[T+v]=0;for(r(1,1,y,s,_,T),E=t<0?1/n:1,l=0;l<e;++l){for(v=0;v<n;++v)u=s[o+v],h=s[a+v],f=(d=s[x+v])*(u+h),m=u*((p=-s[b+v])-d),g=h*(d+p),s[w+v]=f-g,s[S+v]=f+m;for(v=n;v<y;++v)s[w+v]=0;for(v=n;v<y;++v)s[S+v]=0;for(r(1,1,y,s,w,S),v=0;v<y;++v)u=s[w+v],h=s[S+v],f=(d=s[_+v])*(u+h),m=u*((p=s[T+v])-d),g=h*(d+p),s[w+v]=f-g,s[S+v]=f+m;for(r(-1,1,y,s,w,S),v=0;v<n;++v)u=s[w+v],h=s[S+v],f=(d=s[x+v])*(u+h),m=u*((p=-s[b+v])-d),g=h*(d+p),s[o+v]=E*(f-g),s[a+v]=E*(f+m);o+=n,a+=n}}(t,e,n,s,o,a,c)},t.exports.scratchMemory=function(t){return i.isPow2(t)?0:2*t+4*i.nextPow2(2*t+1)}},function(t,e,n){"use strict";var i=n(30),r=n(45),s=n(71);e.clone=function(t){var e=t.dtype;"generic"!==e&&"array"!==e||(e="double");var n=s.malloc(t.size,e),o=i(n,t.shape);return r.assign(o,t),o},e.malloc=function(t,e){e||(e="double");for(var n=1,r=new Array(t.length),o=t.length-1;o>=0;--o)r[o]=n,n*=t[o];return i(s.malloc(n,e),t,r,0)},e.free=function(t){"generic"!==t.dtype&&"array"!==t.dtype&&s.free(t.data)},e.zeros=function(t,e){e||(e="double");for(var n=1,r=new Array(t.length),o=t.length-1;o>=0;--o)r[o]=n,n*=t[o];var a=s.malloc(n,e);for(o=0;o<n;++o)a[o]=0;return i(a,t,r,0)},e.ones=function(t,e){e||(e="double");for(var n=1,r=new Array(t.length),o=t.length-1;o>=0;--o)r[o]=n,n*=t[o];var a=s.malloc(n,e);for(o=0;o<n;++o)a[o]=1;return i(a,t,r,0)},e.eye=function(t,e){var n,r;e||(e="double");var o=1,a=new Array(t.length);for(n=t.length-1;n>=0;--n)a[n]=o,o*=t[n];var c=s.malloc(o,e);for(n=0;n<o;++n)c[n]=0;var l=1/0,u=0;for(n=t.length-1;n>=0;n--)u+=a[n],l=Math.min(l,t[n]);for(n=0,r=0;n<l;n++,r+=u)c[r]=1;return i(c,t,a,0)}},function(t,e,n){"use strict";var i=n(93),r=n(69),s=["args","body"],o=["pre","post","printCode","funcName","blockSize"];t.exports=function(t){for(var e in t)s.indexOf(e)<0&&o.indexOf(e)<0&&console.warn("cwise: Unknown argument '"+e+"' passed to expression compiler");for(var n=0;n<s.length;++n)if(!t[s[n]])throw new Error("cwise: Missing argument: "+s[n]);return r({args:t.args,pre:i(t.pre||function(){}),body:i(t.body),post:i(t.post||function(){}),debug:!!t.printCode,funcName:t.funcName||t.body.name||"cwise",blockSize:t.blockSize||64})}},function(t,e,n){"use strict";(function(e){var i=n(94),r=n(70),s=0;function o(t,e,n){this.name=t,this.lvalue=e,this.rvalue=n,this.count=0}function a(t,e,n,i){this.body=t,this.args=e,this.thisVars=n,this.localVars=i}t.exports=function(t){for(var n=["(",t,")()"].join(""),c=i.parse(n,{range:!0}),l="_inline_"+s+++"_",u=function(t){for(var e=t.body[0].expression.callee.params,n=new Array(e.length),i=0;i<e.length;++i)n[i]=e[i].name;return n}(c),h=new Array(u.length),d=0;d<u.length;++d)h[d]=new o([l,"arg",d,"_"].join(""),!1,!1);for(var p=new Array(n.length),f=(d=0,n.length);d<f;++d)p[d]=n.charAt(d);var m,g=[],v=[];function y(t,e){for(var n=t.range[0],i=t.range[1],r=n+1;r<i;++r)p[r]="";p[n]=e}return function t(n,i){if(n.parent=i,"MemberExpression"===n.type)n.computed?(t(n.object,n),t(n.property,n)):"ThisExpression"===n.object.type?y(n,(x="this_"+n.property.name.replace(/\_/g,"__"),v.push(x),x)):t(n.object,n);else{if("ThisExpression"===n.type)throw new Error("cwise-parser: Computed this is not allowed");if("Identifier"===n.type){var r=n.name,s=u.indexOf(r);if(s>=0){var o=h[s],a=function(t){return"AssignmentExpression"===t.parent.type&&t.parent.left===t?"="===t.parent.operator?1:3:"UpdateExpression"===t.parent.type?3:2}(n);1&a&&(o.lvalue=!0),2&a&&(o.rvalue=!0),++o.count,y(n,o.name)}else(function(t){if("eval"===t)throw new Error("cwise-parser: eval() not allowed");return"undefined"!=typeof window?t in window:void 0!==e?t in e:"undefined"!=typeof self&&t in self})(r)||y(n,function(t){var e=l+t.replace(/\_/g,"__");return g.push(e),e}(r))}else if("Literal"===n.type)"string"==typeof n.value&&y(n,"'"+n.value.replace(/\_/g,"\\_").replace(/\'/g,"'")+"'");else{if("WithStatement"===n.type)throw new Error("cwise-parser: with() statements not allowed");for(var c=Object.keys(n),d=0,p=c.length;d<p;++d)if("parent"!==c[d]){var f=n[c[d]];if(f)if(f instanceof Array)for(var m=0;m<f.length;++m)f[m]&&"string"==typeof f[m].type&&t(f[m],n);else"string"==typeof f.type&&t(f,n)}}}var x}(c.body[0].expression.callee.body,void 0),r(g),r(v),new a((m=c.body[0].expression.callee.body,p.slice(m.range[0],m.range[1]).join("")),h,v,g)}}).call(this,n(21))},function(t,e,n){var i,r,s;!function(n,o){"use strict";r=[e],void 0===(s="function"==typeof(i=function(t){var e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y;function x(t,e){if(!t)throw new Error("ASSERT: "+e)}function b(t){return t>=48&&t<=57}function w(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function S(t){return"01234567".indexOf(t)>=0}function _(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function T(t){return 10===t||13===t||8232===t||8233===t}function E(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&a.NonAsciiIdentifierStart.test(String.fromCharCode(t))}function C(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&a.NonAsciiIdentifierPart.test(String.fromCharCode(t))}function k(t){switch(t){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function A(t){return"eval"===t||"arguments"===t}function I(t,e,n,i,r){var s;x("number"==typeof n,"Comment must have valid position"),v.lastCommentStart>=n||(v.lastCommentStart=n,s={type:t,value:e},y.range&&(s.range=[n,i]),y.loc&&(s.loc=r),y.comments.push(s),y.attachComment&&(y.leadingComments.push(s),y.trailingComments.push(s)))}function O(t){var e,n,i,r;for(e=h-t,n={start:{line:d,column:h-p-t}};h<f;)if(i=l.charCodeAt(h),++h,T(i))return y.comments&&(r=l.slice(e+t,h-1),n.end={line:d,column:h-p-1},I("Line",r,e,h-1,n)),13===i&&10===l.charCodeAt(h)&&++h,++d,void(p=h);y.comments&&(r=l.slice(e+t,h),n.end={line:d,column:h-p},I("Line",r,e,h,n))}function R(){var t,e,n,i;for(y.comments&&(t=h-2,e={start:{line:d,column:h-p-2}});h<f;)if(T(n=l.charCodeAt(h)))13===n&&10===l.charCodeAt(h+1)&&++h,++d,++h,p=h,h>=f&&H({},o.UnexpectedToken,"ILLEGAL");else if(42===n){if(47===l.charCodeAt(h+1))return++h,++h,void(y.comments&&(i=l.slice(t+2,h-2),e.end={line:d,column:h-p},I("Block",i,t,h,e)));++h}else++h;H({},o.UnexpectedToken,"ILLEGAL")}function N(){var t,e;for(e=0===h;h<f;)if(_(t=l.charCodeAt(h)))++h;else if(T(t))++h,13===t&&10===l.charCodeAt(h)&&++h,++d,p=h,e=!0;else if(47===t)if(47===(t=l.charCodeAt(h+1)))++h,++h,O(2),e=!0;else{if(42!==t)break;++h,++h,R()}else if(e&&45===t){if(45!==l.charCodeAt(h+1)||62!==l.charCodeAt(h+2))break;h+=3,O(3)}else{if(60!==t)break;if("!--"!==l.slice(h+1,h+4))break;++h,++h,++h,++h,O(4)}}function M(t){var e,n,i,r=0;for(n="u"===t?4:2,e=0;e<n;++e){if(!(h<f&&w(l[h])))return"";i=l[h++],r=16*r+"0123456789abcdef".indexOf(i.toLowerCase())}return String.fromCharCode(r)}function D(){var t,e;for(t=l.charCodeAt(h++),e=String.fromCharCode(t),92===t&&(117!==l.charCodeAt(h)&&H({},o.UnexpectedToken,"ILLEGAL"),++h,(t=M("u"))&&"\\"!==t&&E(t.charCodeAt(0))||H({},o.UnexpectedToken,"ILLEGAL"),e=t);h<f&&C(t=l.charCodeAt(h));)++h,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==l.charCodeAt(h)&&H({},o.UnexpectedToken,"ILLEGAL"),++h,(t=M("u"))&&"\\"!==t&&C(t.charCodeAt(0))||H({},o.UnexpectedToken,"ILLEGAL"),e+=t);return e}function P(){var t,n,i,r,s=h,a=l.charCodeAt(h),c=l[h];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++h,y.tokenize&&(40===a?y.openParenToken=y.tokens.length:123===a&&(y.openCurlyToken=y.tokens.length)),{type:e.Punctuator,value:String.fromCharCode(a),lineNumber:d,lineStart:p,start:s,end:h};default:if(61===(t=l.charCodeAt(h+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return h+=2,{type:e.Punctuator,value:String.fromCharCode(a)+String.fromCharCode(t),lineNumber:d,lineStart:p,start:s,end:h};case 33:case 61:return h+=2,61===l.charCodeAt(h)&&++h,{type:e.Punctuator,value:l.slice(s,h),lineNumber:d,lineStart:p,start:s,end:h}}}return">>>="===(r=l.substr(h,4))?{type:e.Punctuator,value:r,lineNumber:d,lineStart:p,start:s,end:h+=4}:">>>"===(i=r.substr(0,3))||"<<="===i||">>="===i?{type:e.Punctuator,value:i,lineNumber:d,lineStart:p,start:s,end:h+=3}:c===(n=i.substr(0,2))[1]&&"+-<>&|".indexOf(c)>=0||"=>"===n?{type:e.Punctuator,value:n,lineNumber:d,lineStart:p,start:s,end:h+=2}:"<>=!+-*%&|^/".indexOf(c)>=0?(++h,{type:e.Punctuator,value:c,lineNumber:d,lineStart:p,start:s,end:h}):void H({},o.UnexpectedToken,"ILLEGAL")}function F(){var t,n,i;if(x(b((i=l[h]).charCodeAt(0))||"."===i,"Numeric literal must start with a decimal digit or a decimal point"),n=h,t="","."!==i){if(t=l[h++],i=l[h],"0"===t){if("x"===i||"X"===i)return++h,function(t){for(var n="";h<f&&w(l[h]);)n+=l[h++];return 0===n.length&&H({},o.UnexpectedToken,"ILLEGAL"),E(l.charCodeAt(h))&&H({},o.UnexpectedToken,"ILLEGAL"),{type:e.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:d,lineStart:p,start:t,end:h}}(n);if(S(i)&&function(){var t,e;for(t=h+1;t<f;++t){if("8"===(e=l[t])||"9"===e)return!1;if(!S(e))return!0}return!0}())return function(t){for(var n="0"+l[h++];h<f&&S(l[h]);)n+=l[h++];return(E(l.charCodeAt(h))||b(l.charCodeAt(h)))&&H({},o.UnexpectedToken,"ILLEGAL"),{type:e.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:d,lineStart:p,start:t,end:h}}(n)}for(;b(l.charCodeAt(h));)t+=l[h++];i=l[h]}if("."===i){for(t+=l[h++];b(l.charCodeAt(h));)t+=l[h++];i=l[h]}if("e"===i||"E"===i)if(t+=l[h++],"+"!==(i=l[h])&&"-"!==i||(t+=l[h++]),b(l.charCodeAt(h)))for(;b(l.charCodeAt(h));)t+=l[h++];else H({},o.UnexpectedToken,"ILLEGAL");return E(l.charCodeAt(h))&&H({},o.UnexpectedToken,"ILLEGAL"),{type:e.NumericLiteral,value:parseFloat(t),lineNumber:d,lineStart:p,start:n,end:h}}function L(){var t,n,i,r;return g=null,N(),t=h,n=function(){var t,e,n,i;for(x("/"===(t=l[h]),"Regular expression literal must start with a slash"),e=l[h++],n=!1,i=!1;h<f;)if(e+=t=l[h++],"\\"===t)T((t=l[h++]).charCodeAt(0))&&H({},o.UnterminatedRegExp),e+=t;else if(T(t.charCodeAt(0)))H({},o.UnterminatedRegExp);else if(n)"]"===t&&(n=!1);else{if("/"===t){i=!0;break}"["===t&&(n=!0)}return i||H({},o.UnterminatedRegExp),{value:e.substr(1,e.length-2),literal:e}}(),i=function(){var t,e,n,i;for(e="",n="";h<f&&C((t=l[h]).charCodeAt(0));)if(++h,"\\"===t&&h<f)if("u"===(t=l[h])){if(i=++h,t=M("u"))for(n+=t,e+="\\u";i<h;++i)e+=l[i];else h=i,n+="u",e+="\\u";X({},o.UnexpectedToken,"ILLEGAL")}else e+="\\",X({},o.UnexpectedToken,"ILLEGAL");else n+=t,e+=t;return{value:n,literal:e}}(),r=function(t,e){var n;try{n=new RegExp(t,e)}catch(t){H({},o.InvalidRegExp)}return n}(n.value,i.value),y.tokenize?{type:e.RegularExpression,value:r,lineNumber:d,lineStart:p,start:t,end:h}:{literal:n.literal+i.literal,value:r,start:t,end:h}}function B(){var t,e,n,i;return N(),t=h,e={start:{line:d,column:h-p}},n=L(),e.end={line:d,column:h-p},y.tokenize||(y.tokens.length>0&&(i=y.tokens[y.tokens.length-1]).range[0]===t&&"Punctuator"===i.type&&("/"!==i.value&&"/="!==i.value||y.tokens.pop()),y.tokens.push({type:"RegularExpression",value:n.literal,range:[t,h],loc:e})),n}function z(){var t;return N(),h>=f?{type:e.EOF,lineNumber:d,lineStart:p,start:h,end:h}:E(t=l.charCodeAt(h))?function(){var t,n;return t=h,{type:1===(n=92===l.charCodeAt(h)?D():function(){var t,e;for(t=h++;h<f;){if(92===(e=l.charCodeAt(h)))return h=t,D();if(!C(e))break;++h}return l.slice(t,h)}()).length?e.Identifier:function(t){if(u&&k(t))return!0;switch(t.length){case 2:return"if"===t||"in"===t||"do"===t;case 3:return"var"===t||"for"===t||"new"===t||"try"===t||"let"===t;case 4:return"this"===t||"else"===t||"case"===t||"void"===t||"with"===t||"enum"===t;case 5:return"while"===t||"break"===t||"catch"===t||"throw"===t||"const"===t||"yield"===t||"class"===t||"super"===t;case 6:return"return"===t||"typeof"===t||"delete"===t||"switch"===t||"export"===t||"import"===t;case 7:return"default"===t||"finally"===t||"extends"===t;case 8:return"function"===t||"continue"===t||"debugger"===t;case 10:return"instanceof"===t;default:return!1}}(n)?e.Keyword:"null"===n?e.NullLiteral:"true"===n||"false"===n?e.BooleanLiteral:e.Identifier,value:n,lineNumber:d,lineStart:p,start:t,end:h}}():40===t||41===t||59===t?P():39===t||34===t?function(){var t,n,i,r,s,a,c,u,m="",g=!1;for(c=d,u=p,x("'"===(t=l[h])||'"'===t,"String literal must starts with a quote"),n=h,++h;h<f;){if((i=l[h++])===t){t="";break}if("\\"===i)if((i=l[h++])&&T(i.charCodeAt(0)))++d,"\r"===i&&"\n"===l[h]&&++h,p=h;else switch(i){case"u":case"x":a=h,(s=M(i))?m+=s:(h=a,m+=i);break;case"n":m+="\n";break;case"r":m+="\r";break;case"t":m+="\t";break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:S(i)?(0!==(r="01234567".indexOf(i))&&(g=!0),h<f&&S(l[h])&&(g=!0,r=8*r+"01234567".indexOf(l[h++]),"0123".indexOf(i)>=0&&h<f&&S(l[h])&&(r=8*r+"01234567".indexOf(l[h++]))),m+=String.fromCharCode(r)):m+=i}else{if(T(i.charCodeAt(0)))break;m+=i}}return""!==t&&H({},o.UnexpectedToken,"ILLEGAL"),{type:e.StringLiteral,value:m,octal:g,startLineNumber:c,startLineStart:u,lineNumber:d,lineStart:p,start:n,end:h}}():46===t?b(l.charCodeAt(h+1))?F():P():b(t)?F():y.tokenize&&47===t?function(){var t,e;if(!(t=y.tokens[y.tokens.length-1]))return B();if("Punctuator"===t.type){if("]"===t.value)return P();if(")"===t.value)return!(e=y.tokens[y.openParenToken-1])||"Keyword"!==e.type||"if"!==e.value&&"while"!==e.value&&"for"!==e.value&&"with"!==e.value?P():B();if("}"===t.value){if(y.tokens[y.openCurlyToken-3]&&"Keyword"===y.tokens[y.openCurlyToken-3].type){if(!(e=y.tokens[y.openCurlyToken-4]))return P()}else{if(!y.tokens[y.openCurlyToken-4]||"Keyword"!==y.tokens[y.openCurlyToken-4].type)return P();if(!(e=y.tokens[y.openCurlyToken-5]))return B()}return i.indexOf(e.value)>=0?P():B()}return B()}return"Keyword"===t.type&&"this"!==t.value?B():P()}():P()}function U(){var t,i,r;return N(),t={start:{line:d,column:h-p}},i=z(),t.end={line:d,column:h-p},i.type!==e.EOF&&(r=l.slice(i.start,i.end),y.tokens.push({type:n[i.type],value:r,range:[i.start,i.end],loc:t})),i}function j(){var t;return h=(t=g).end,d=t.lineNumber,p=t.lineStart,g=void 0!==y.tokens?U():z(),h=t.end,d=t.lineNumber,p=t.lineStart,t}function V(){var t,e,n;t=h,e=d,n=p,g=void 0!==y.tokens?U():z(),h=t,d=e,p=n}function W(t,e){this.line=t,this.column=e}function G(t,e,n,i){this.start=new W(t,e),this.end=new W(n,i)}function q(){var t,e,n,i;return t=h,e=d,n=p,N(),i=d!==e,h=t,d=e,p=n,i}function H(t,e){var n,i=Array.prototype.slice.call(arguments,2),r=e.replace(/%(\d)/g,(function(t,e){return x(e<i.length,"Message reference must be in range"),i[e]}));throw"number"==typeof t.lineNumber?((n=new Error("Line "+t.lineNumber+": "+r)).index=t.start,n.lineNumber=t.lineNumber,n.column=t.start-p+1):((n=new Error("Line "+d+": "+r)).index=h,n.lineNumber=d,n.column=h-p+1),n.description=r,n}function X(){try{H.apply(null,arguments)}catch(t){if(!y.errors)throw t;y.errors.push(t)}}function Y(t){if(t.type===e.EOF&&H(t,o.UnexpectedEOS),t.type===e.NumericLiteral&&H(t,o.UnexpectedNumber),t.type===e.StringLiteral&&H(t,o.UnexpectedString),t.type===e.Identifier&&H(t,o.UnexpectedIdentifier),t.type===e.Keyword){if(function(t){switch(t){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(t.value))H(t,o.UnexpectedReserved);else if(u&&k(t.value))return void X(t,o.StrictReservedWord);H(t,o.UnexpectedToken,t.value)}H(t,o.UnexpectedToken,t.value)}function K(t){var n=j();n.type===e.Punctuator&&n.value===t||Y(n)}function Q(t){var n=j();n.type===e.Keyword&&n.value===t||Y(n)}function Z(t){return g.type===e.Punctuator&&g.value===t}function J(t){return g.type===e.Keyword&&g.value===t}function $(){var t,n=h,i=d,r=p,s=g;if(59===l.charCodeAt(h)||Z(";"))j();else{if(t=d,N(),d!==t)return h=n,d=i,p=r,void(g=s);g.type===e.EOF||Z("}")||Y(g)}}function tt(t){return t.type===r.Identifier||t.type===r.MemberExpression}function et(t,e){var n,i,r;return n=u,r=g,i=bt(),e&&u&&A(t[0].name)&&X(e,o.StrictParamName),u=n,m.markEnd(m.createFunctionExpression(null,t,[],i),r)}function nt(){var t,n;return n=g,(t=j()).type===e.StringLiteral||t.type===e.NumericLiteral?(u&&t.octal&&X(t,o.StrictOctalLiteral),m.markEnd(m.createLiteral(t),n)):m.markEnd(m.createIdentifier(t.value),n)}function it(){var t,n,i,r,s,a;return a=g,(t=g).type===e.Identifier?(i=nt(),"get"!==t.value||Z(":")?"set"!==t.value||Z(":")?(K(":"),r=dt(),m.markEnd(m.createProperty("init",i,r),a)):(n=nt(),K("("),(t=g).type!==e.Identifier?(K(")"),X(t,o.UnexpectedToken,t.value),r=et([])):(s=[mt()],K(")"),r=et(s,t)),m.markEnd(m.createProperty("set",n,r),a)):(n=nt(),K("("),K(")"),r=et([]),m.markEnd(m.createProperty("get",n,r),a))):t.type!==e.EOF&&t.type!==e.Punctuator?(n=nt(),K(":"),r=dt(),m.markEnd(m.createProperty("init",n,r),a)):void Y(t)}function rt(){var t,n,i,a;if(Z("("))return function(){var t;return K("("),t=pt(),K(")"),t}();if(Z("["))return function(){var t,e=[];for(t=g,K("[");!Z("]");)Z(",")?(j(),e.push(null)):(e.push(dt()),Z("]")||K(","));return j(),m.markEnd(m.createArrayExpression(e),t)}();if(Z("{"))return function(){var t,e,n,i,a,c=[],l={},h=String;for(a=g,K("{");!Z("}");)e=(t=it()).key.type===r.Identifier?t.key.name:h(t.key.value),i="init"===t.kind?s.Data:"get"===t.kind?s.Get:s.Set,n="$"+e,Object.prototype.hasOwnProperty.call(l,n)?(l[n]===s.Data?u&&i===s.Data?X({},o.StrictDuplicateProperty):i!==s.Data&&X({},o.AccessorDataProperty):i===s.Data?X({},o.AccessorDataProperty):l[n]&i&&X({},o.AccessorGetSet),l[n]|=i):l[n]=i,c.push(t),Z("}")||K(",");return K("}"),m.markEnd(m.createObjectExpression(c),a)}();if(t=g.type,a=g,t===e.Identifier)i=m.createIdentifier(j().value);else if(t===e.StringLiteral||t===e.NumericLiteral)u&&g.octal&&X(g,o.StrictOctalLiteral),i=m.createLiteral(j());else if(t===e.Keyword){if(J("function"))return function(){var t,e,n,i,r,s,a,c,l,h=null;return l=g,Q("function"),Z("(")||(t=g,h=mt(),u?A(t.value)&&X(t,o.StrictFunctionName):A(t.value)?(n=t,i=o.StrictFunctionName):k(t.value)&&(n=t,i=o.StrictReservedWord)),s=(r=wt(n)).params,e=r.stricted,n=r.firstRestricted,r.message&&(i=r.message),c=u,a=bt(),u&&n&&H(n,i),u&&e&&X(e,i),u=c,m.markEnd(m.createFunctionExpression(h,s,[],a),l)}();J("this")?(j(),i=m.createThisExpression()):Y(j())}else t===e.BooleanLiteral?((n=j()).value="true"===n.value,i=m.createLiteral(n)):t===e.NullLiteral?((n=j()).value=null,i=m.createLiteral(n)):Z("/")||Z("/=")?(i=void 0!==y.tokens?m.createLiteral(B()):m.createLiteral(L()),V()):Y(j());return m.markEnd(i,a)}function st(){var t=[];if(K("("),!Z(")"))for(;h<f&&(t.push(dt()),!Z(")"));)K(",");return K(")"),t}function ot(){return K("."),function(){var t,n;return n=g,function(t){return t.type===e.Identifier||t.type===e.Keyword||t.type===e.BooleanLiteral||t.type===e.NullLiteral}(t=j())||Y(t),m.markEnd(m.createIdentifier(t.value),n)}()}function at(){var t;return K("["),t=pt(),K("]"),t}function ct(){var t,e,n;return n=g,Q("new"),t=function(){var t,e,n;for(x(v.allowIn,"callee of new expression always allow in keyword."),n=g,t=J("new")?ct():rt();Z(".")||Z("[");)Z("[")?(e=at(),t=m.createMemberExpression("[",t,e)):(e=ot(),t=m.createMemberExpression(".",t,e)),m.markEnd(t,n);return t}(),e=Z("(")?st():[],m.markEnd(m.createNewExpression(t,e),n)}function lt(){var t,n,i=g;return t=function(){var t,e,n,i,r=v.allowIn;for(i=g,v.allowIn=!0,t=J("new")?ct():rt();;){if(Z("."))n=ot(),t=m.createMemberExpression(".",t,n);else if(Z("("))e=st(),t=m.createCallExpression(t,e);else{if(!Z("["))break;n=at(),t=m.createMemberExpression("[",t,n)}m.markEnd(t,i)}return v.allowIn=r,t}(),g.type===e.Punctuator&&(!Z("++")&&!Z("--")||q()||(u&&t.type===r.Identifier&&A(t.name)&&X({},o.StrictLHSPostfix),tt(t)||X({},o.InvalidLHSInAssignment),n=j(),t=m.markEnd(m.createPostfixExpression(n.value,t),i))),t}function ut(){var t,n,i;return g.type!==e.Punctuator&&g.type!==e.Keyword?n=lt():Z("++")||Z("--")?(i=g,t=j(),n=ut(),u&&n.type===r.Identifier&&A(n.name)&&X({},o.StrictLHSPrefix),tt(n)||X({},o.InvalidLHSInAssignment),n=m.createUnaryExpression(t.value,n),n=m.markEnd(n,i)):Z("+")||Z("-")||Z("~")||Z("!")?(i=g,t=j(),n=ut(),n=m.createUnaryExpression(t.value,n),n=m.markEnd(n,i)):J("delete")||J("void")||J("typeof")?(i=g,t=j(),n=ut(),n=m.createUnaryExpression(t.value,n),n=m.markEnd(n,i),u&&"delete"===n.operator&&n.argument.type===r.Identifier&&X({},o.StrictDelete)):n=lt(),n}function ht(t,n){var i=0;if(t.type!==e.Punctuator&&t.type!==e.Keyword)return 0;switch(t.value){case"||":i=1;break;case"&&":i=2;break;case"|":i=3;break;case"^":i=4;break;case"&":i=5;break;case"==":case"!=":case"===":case"!==":i=6;break;case"<":case">":case"<=":case">=":case"instanceof":i=7;break;case"in":i=n?7:0;break;case"<<":case">>":case">>>":i=8;break;case"+":case"-":i=9;break;case"*":case"/":case"%":i=11}return i}function dt(){var t,n,i,s,a,c;return t=g,a=g,s=n=function(){var t,e,n,i,r;return r=g,t=function(){var t,e,n,i,r,s,o,a,c,l;if(t=g,c=ut(),0===(r=ht(i=g,v.allowIn)))return c;for(i.prec=r,j(),e=[t,g],s=[c,i,o=ut()];(r=ht(g,v.allowIn))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,c=s.pop(),n=m.createBinaryExpression(a,c,o),e.pop(),t=e[e.length-1],m.markEnd(n,t),s.push(n);(i=j()).prec=r,s.push(i),e.push(g),n=ut(),s.push(n)}for(n=s[l=s.length-1],e.pop();l>1;)n=m.createBinaryExpression(s[l-1].value,s[l-2],n),l-=2,t=e.pop(),m.markEnd(n,t);return n}(),Z("?")&&(j(),e=v.allowIn,v.allowIn=!0,n=dt(),v.allowIn=e,K(":"),i=dt(),t=m.createConditionalExpression(t,n,i),m.markEnd(t,r)),t}(),g.type!==e.Punctuator||"="!==(c=g.value)&&"*="!==c&&"/="!==c&&"%="!==c&&"+="!==c&&"-="!==c&&"<<="!==c&&">>="!==c&&">>>="!==c&&"&="!==c&&"^="!==c&&"|="!==c||(tt(n)||X({},o.InvalidLHSInAssignment),u&&n.type===r.Identifier&&A(n.name)&&X(t,o.StrictLHSAssignment),t=j(),i=dt(),s=m.markEnd(m.createAssignmentExpression(t.value,n,i),a)),s}function pt(){var t,e=g;if(t=dt(),Z(",")){for(t=m.createSequenceExpression([t]);h<f&&Z(",");)j(),t.expressions.push(dt());m.markEnd(t,e)}return t}function ft(){var t,e;return e=g,K("{"),t=function(){for(var t,e=[];h<f&&!Z("}")&&void 0!==(t=_t());)e.push(t);return e}(),K("}"),m.markEnd(m.createBlockStatement(t),e)}function mt(){var t,n;return n=g,(t=j()).type!==e.Identifier&&Y(t),m.markEnd(m.createIdentifier(t.value),n)}function gt(t){var e,n,i=null;return n=g,e=mt(),u&&A(e.name)&&X({},o.StrictVarName),"const"===t?(K("="),i=dt()):Z("=")&&(j(),i=dt()),m.markEnd(m.createVariableDeclarator(e,i),n)}function vt(t){var e=[];do{if(e.push(gt(t)),!Z(","))break;j()}while(h<f);return e}function yt(){var t,e,n,i=[];for(n=g,J("default")?(j(),t=null):(Q("case"),t=pt()),K(":");h<f&&!(Z("}")||J("default")||J("case"));)e=xt(),i.push(e);return m.markEnd(m.createSwitchCase(t,i),n)}function xt(){var t,n,i,s,a,c,d,p,y,x=g.type;if(x===e.EOF&&Y(g),x===e.Punctuator&&"{"===g.value)return ft();if(s=g,x===e.Punctuator)switch(g.value){case";":return m.markEnd((K(";"),m.createEmptyStatement()),s);case"(":return m.markEnd(function(){var t=pt();return $(),m.createExpressionStatement(t)}(),s)}if(x===e.Keyword)switch(g.value){case"break":return m.markEnd(function(){var t,n=null;return Q("break"),59===l.charCodeAt(h)?(j(),v.inIteration||v.inSwitch||H({},o.IllegalBreak),m.createBreakStatement(null)):q()?(v.inIteration||v.inSwitch||H({},o.IllegalBreak),m.createBreakStatement(null)):(g.type===e.Identifier&&(t="$"+(n=mt()).name,Object.prototype.hasOwnProperty.call(v.labelSet,t)||H({},o.UnknownLabel,n.name)),$(),null!==n||v.inIteration||v.inSwitch||H({},o.IllegalBreak),m.createBreakStatement(n))}(),s);case"continue":return m.markEnd(function(){var t,n=null;return Q("continue"),59===l.charCodeAt(h)?(j(),v.inIteration||H({},o.IllegalContinue),m.createContinueStatement(null)):q()?(v.inIteration||H({},o.IllegalContinue),m.createContinueStatement(null)):(g.type===e.Identifier&&(t="$"+(n=mt()).name,Object.prototype.hasOwnProperty.call(v.labelSet,t)||H({},o.UnknownLabel,n.name)),$(),null!==n||v.inIteration||H({},o.IllegalContinue),m.createContinueStatement(n))}(),s);case"debugger":return m.markEnd((Q("debugger"),$(),m.createDebuggerStatement()),s);case"do":return m.markEnd((Q("do"),y=v.inIteration,v.inIteration=!0,d=xt(),v.inIteration=y,Q("while"),K("("),p=pt(),K(")"),Z(";")&&j(),m.createDoWhileStatement(d,p)),s);case"for":return m.markEnd(function(){var t,e,n,i,r,s,a,c,l,u,h=v.allowIn;return t=e=n=null,Q("for"),K("("),Z(";")?j():(J("var")||J("let")?(v.allowIn=!1,u=g,c=j(),l=vt(),t=m.markEnd(m.createVariableDeclaration(l,c.value),u),v.allowIn=h,1===t.declarations.length&&J("in")&&(j(),i=t,r=pt(),t=null)):(v.allowIn=!1,t=pt(),v.allowIn=h,J("in")&&(tt(t)||X({},o.InvalidLHSInForIn),j(),i=t,r=pt(),t=null)),void 0===i&&K(";")),void 0===i&&(Z(";")||(e=pt()),K(";"),Z(")")||(n=pt())),K(")"),a=v.inIteration,v.inIteration=!0,s=xt(),v.inIteration=a,void 0===i?m.createForStatement(t,e,n,s):m.createForInStatement(i,r,s)}(),s);case"function":return m.markEnd(St(),s);case"if":return m.markEnd(function(){var t,e,n;return Q("if"),K("("),t=pt(),K(")"),e=xt(),J("else")?(j(),n=xt()):n=null,m.createIfStatement(t,e,n)}(),s);case"return":return m.markEnd((c=null,Q("return"),v.inFunctionBody||X({},o.IllegalReturn),32===l.charCodeAt(h)&&E(l.charCodeAt(h+1))?(c=pt(),$(),m.createReturnStatement(c)):q()?m.createReturnStatement(null):(Z(";")||Z("}")||g.type===e.EOF||(c=pt()),$(),m.createReturnStatement(c))),s);case"switch":return m.markEnd(function(){var t,e,n,i,r;if(Q("switch"),K("("),t=pt(),K(")"),K("{"),e=[],Z("}"))return j(),m.createSwitchStatement(t,e);for(i=v.inSwitch,v.inSwitch=!0,r=!1;h<f&&!Z("}");)null===(n=yt()).test&&(r&&H({},o.MultipleDefaultsInSwitch),r=!0),e.push(n);return v.inSwitch=i,K("}"),m.createSwitchStatement(t,e)}(),s);case"throw":return m.markEnd(function(){var t;return Q("throw"),q()&&H({},o.NewlineAfterThrow),t=pt(),$(),m.createThrowStatement(t)}(),s);case"try":return m.markEnd(function(){var t,e,n,i,r=[],s=null;return Q("try"),t=ft(),J("catch")&&r.push((i=g,Q("catch"),K("("),Z(")")&&Y(g),e=mt(),u&&A(e.name)&&X({},o.StrictCatchVariable),K(")"),n=ft(),m.markEnd(m.createCatchClause(e,n),i))),J("finally")&&(j(),s=ft()),0!==r.length||s||H({},o.NoCatchOrFinally),m.createTryStatement(t,[],r,s)}(),s);case"var":return m.markEnd((Q("var"),a=vt(),$(),m.createVariableDeclaration(a,"var")),s);case"while":return m.markEnd(function(){var t,e,n;return Q("while"),K("("),t=pt(),K(")"),n=v.inIteration,v.inIteration=!0,e=xt(),v.inIteration=n,m.createWhileStatement(t,e)}(),s);case"with":return m.markEnd(function(){var t,e;return u&&(N(),X({},o.StrictModeWith)),Q("with"),K("("),t=pt(),K(")"),e=xt(),m.createWithStatement(t,e)}(),s)}return(t=pt()).type===r.Identifier&&Z(":")?(j(),i="$"+t.name,Object.prototype.hasOwnProperty.call(v.labelSet,i)&&H({},o.Redeclaration,"Label",t.name),v.labelSet[i]=!0,n=xt(),delete v.labelSet[i],m.markEnd(m.createLabeledStatement(t,n),s)):($(),m.markEnd(m.createExpressionStatement(t),s))}function bt(){var t,n,i,s,a,c,d,p,y=[];for(p=g,K("{");h<f&&g.type===e.StringLiteral&&(n=g,t=_t(),y.push(t),t.expression.type===r.Literal);)"use strict"===l.slice(n.start+1,n.end-1)?(u=!0,i&&X(i,o.StrictOctalLiteral)):!i&&n.octal&&(i=n);for(s=v.labelSet,a=v.inIteration,c=v.inSwitch,d=v.inFunctionBody,v.labelSet={},v.inIteration=!1,v.inSwitch=!1,v.inFunctionBody=!0;h<f&&!Z("}")&&void 0!==(t=_t());)y.push(t);return K("}"),v.labelSet=s,v.inIteration=a,v.inSwitch=c,v.inFunctionBody=d,m.markEnd(m.createBlockStatement(y),p)}function wt(t){var e,n,i,r,s,a,c=[];if(K("("),!Z(")"))for(r={};h<f&&(n=g,e=mt(),s="$"+n.value,u?(A(n.value)&&(i=n,a=o.StrictParamName),Object.prototype.hasOwnProperty.call(r,s)&&(i=n,a=o.StrictParamDupe)):t||(A(n.value)?(t=n,a=o.StrictParamName):k(n.value)?(t=n,a=o.StrictReservedWord):Object.prototype.hasOwnProperty.call(r,s)&&(t=n,a=o.StrictParamDupe)),c.push(e),r[s]=!0,!Z(")"));)K(",");return K(")"),{params:c,stricted:i,firstRestricted:t,message:a}}function St(){var t,e,n,i,r,s,a,c,l,h;return h=g,Q("function"),i=g,t=mt(),u?A(i.value)&&X(i,o.StrictFunctionName):A(i.value)?(a=i,c=o.StrictFunctionName):k(i.value)&&(a=i,c=o.StrictReservedWord),e=(s=wt(a)).params,r=s.stricted,a=s.firstRestricted,s.message&&(c=s.message),l=u,n=bt(),u&&a&&H(a,c),u&&r&&X(r,c),u=l,m.markEnd(m.createFunctionDeclaration(t,e,[],n),h)}function _t(){if(g.type===e.Keyword)switch(g.value){case"const":case"let":return t=g.value,i=g,Q(t),n=vt(t),$(),m.markEnd(m.createVariableDeclaration(n,t),i);case"function":return St();default:return xt()}var t,n,i;if(g.type!==e.EOF)return xt()}function Tt(){var t,n;return N(),V(),n=g,u=!1,t=function(){for(var t,n,i,s=[];h<f&&(n=g).type===e.StringLiteral&&(t=_t(),s.push(t),t.expression.type===r.Literal);)"use strict"===l.slice(n.start+1,n.end-1)?(u=!0,i&&X(i,o.StrictOctalLiteral)):!i&&n.octal&&(i=n);for(;h<f&&void 0!==(t=_t());)s.push(t);return s}(),m.markEnd(m.createProgram(t),n)}function Et(){var t,e,n,i=[];for(t=0;t<y.tokens.length;++t)n={type:(e=y.tokens[t]).type,value:e.value},y.range&&(n.range=e.range),y.loc&&(n.loc=e.loc),i.push(n);y.tokens=i}(n={})[(e={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",n[e.EOF]="<end>",n[e.Identifier]="Identifier",n[e.Keyword]="Keyword",n[e.NullLiteral]="Null",n[e.NumericLiteral]="Numeric",n[e.Punctuator]="Punctuator",n[e.StringLiteral]="String",n[e.RegularExpression]="RegularExpression",i=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],r={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},s={Data:1,Get:2,Set:4},o={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},a={NonAsciiIdentifierStart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),NonAsciiIdentifierPart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0\u08a2-\u08ac\u08e4-\u08fe\u0900-\u0963\u0966-\u096f\u0971-\u0977\u0979-\u097f\u0981-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d02\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191c\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1d00-\u1de6\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua697\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a\uaa7b\uaa80-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")},c={name:"SyntaxTree",processComment:function(t){var e,n;if(!(t.type===r.Program&&t.body.length>0)){for(y.trailingComments.length>0?y.trailingComments[0].range[0]>=t.range[1]?(n=y.trailingComments,y.trailingComments=[]):y.trailingComments.length=0:y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments[0].range[0]>=t.range[1]&&(n=y.bottomRightStack[y.bottomRightStack.length-1].trailingComments,delete y.bottomRightStack[y.bottomRightStack.length-1].trailingComments);y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].range[0]>=t.range[0];)e=y.bottomRightStack.pop();e?e.leadingComments&&e.leadingComments[e.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=e.leadingComments,delete e.leadingComments):y.leadingComments.length>0&&y.leadingComments[y.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=y.leadingComments,y.leadingComments=[]),n&&(t.trailingComments=n),y.bottomRightStack.push(t)}},markEnd:function(t,e){return y.range&&(t.range=[e.start,h]),y.loc&&(t.loc=new G(void 0===e.startLineNumber?e.lineNumber:e.startLineNumber,e.start-(void 0===e.startLineStart?e.lineStart:e.startLineStart),d,h-p),this.postProcess(t)),y.attachComment&&this.processComment(t),t},postProcess:function(t){return y.source&&(t.loc.source=y.source),t},createArrayExpression:function(t){return{type:r.ArrayExpression,elements:t}},createAssignmentExpression:function(t,e,n){return{type:r.AssignmentExpression,operator:t,left:e,right:n}},createBinaryExpression:function(t,e,n){return{type:"||"===t||"&&"===t?r.LogicalExpression:r.BinaryExpression,operator:t,left:e,right:n}},createBlockStatement:function(t){return{type:r.BlockStatement,body:t}},createBreakStatement:function(t){return{type:r.BreakStatement,label:t}},createCallExpression:function(t,e){return{type:r.CallExpression,callee:t,arguments:e}},createCatchClause:function(t,e){return{type:r.CatchClause,param:t,body:e}},createConditionalExpression:function(t,e,n){return{type:r.ConditionalExpression,test:t,consequent:e,alternate:n}},createContinueStatement:function(t){return{type:r.ContinueStatement,label:t}},createDebuggerStatement:function(){return{type:r.DebuggerStatement}},createDoWhileStatement:function(t,e){return{type:r.DoWhileStatement,body:t,test:e}},createEmptyStatement:function(){return{type:r.EmptyStatement}},createExpressionStatement:function(t){return{type:r.ExpressionStatement,expression:t}},createForStatement:function(t,e,n,i){return{type:r.ForStatement,init:t,test:e,update:n,body:i}},createForInStatement:function(t,e,n){return{type:r.ForInStatement,left:t,right:e,body:n,each:!1}},createFunctionDeclaration:function(t,e,n,i){return{type:r.FunctionDeclaration,id:t,params:e,defaults:n,body:i,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(t,e,n,i){return{type:r.FunctionExpression,id:t,params:e,defaults:n,body:i,rest:null,generator:!1,expression:!1}},createIdentifier:function(t){return{type:r.Identifier,name:t}},createIfStatement:function(t,e,n){return{type:r.IfStatement,test:t,consequent:e,alternate:n}},createLabeledStatement:function(t,e){return{type:r.LabeledStatement,label:t,body:e}},createLiteral:function(t){return{type:r.Literal,value:t.value,raw:l.slice(t.start,t.end)}},createMemberExpression:function(t,e,n){return{type:r.MemberExpression,computed:"["===t,object:e,property:n}},createNewExpression:function(t,e){return{type:r.NewExpression,callee:t,arguments:e}},createObjectExpression:function(t){return{type:r.ObjectExpression,properties:t}},createPostfixExpression:function(t,e){return{type:r.UpdateExpression,operator:t,argument:e,prefix:!1}},createProgram:function(t){return{type:r.Program,body:t}},createProperty:function(t,e,n){return{type:r.Property,key:e,value:n,kind:t}},createReturnStatement:function(t){return{type:r.ReturnStatement,argument:t}},createSequenceExpression:function(t){return{type:r.SequenceExpression,expressions:t}},createSwitchCase:function(t,e){return{type:r.SwitchCase,test:t,consequent:e}},createSwitchStatement:function(t,e){return{type:r.SwitchStatement,discriminant:t,cases:e}},createThisExpression:function(){return{type:r.ThisExpression}},createThrowStatement:function(t){return{type:r.ThrowStatement,argument:t}},createTryStatement:function(t,e,n,i){return{type:r.TryStatement,block:t,guardedHandlers:e,handlers:n,finalizer:i}},createUnaryExpression:function(t,e){return"++"===t||"--"===t?{type:r.UpdateExpression,operator:t,argument:e,prefix:!0}:{type:r.UnaryExpression,operator:t,argument:e,prefix:!0}},createVariableDeclaration:function(t,e){return{type:r.VariableDeclaration,declarations:t,kind:e}},createVariableDeclarator:function(t,e){return{type:r.VariableDeclarator,id:t,init:e}},createWhileStatement:function(t,e){return{type:r.WhileStatement,test:t,body:e}},createWithStatement:function(t,e){return{type:r.WithStatement,object:t,body:e}}},t.version="1.2.5",t.tokenize=function(t,n){var i;"string"==typeof t||t instanceof String||(t=String(t)),m=c,h=0,d=(l=t).length>0?1:0,p=0,f=l.length,g=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},(n=n||{}).tokens=!0,y.tokens=[],y.tokenize=!0,y.openParenToken=-1,y.openCurlyToken=-1,y.range="boolean"==typeof n.range&&n.range,y.loc="boolean"==typeof n.loc&&n.loc,"boolean"==typeof n.comment&&n.comment&&(y.comments=[]),"boolean"==typeof n.tolerant&&n.tolerant&&(y.errors=[]);try{if(V(),g.type===e.EOF)return y.tokens;for(j();g.type!==e.EOF;)try{j()}catch(t){if(y.errors){y.errors.push(t);break}throw t}Et(),i=y.tokens,void 0!==y.comments&&(i.comments=y.comments),void 0!==y.errors&&(i.errors=y.errors)}catch(t){throw t}finally{y={}}return i},t.parse=function(t,e){var n,i;i=String,"string"==typeof t||t instanceof String||(t=i(t)),m=c,h=0,d=(l=t).length>0?1:0,p=0,f=l.length,g=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},void 0!==e&&(y.range="boolean"==typeof e.range&&e.range,y.loc="boolean"==typeof e.loc&&e.loc,y.attachComment="boolean"==typeof e.attachComment&&e.attachComment,y.loc&&null!==e.source&&void 0!==e.source&&(y.source=i(e.source)),"boolean"==typeof e.tokens&&e.tokens&&(y.tokens=[]),"boolean"==typeof e.comment&&e.comment&&(y.comments=[]),"boolean"==typeof e.tolerant&&e.tolerant&&(y.errors=[]),y.attachComment&&(y.range=!0,y.comments=[],y.bottomRightStack=[],y.trailingComments=[],y.leadingComments=[]));try{n=Tt(),void 0!==y.comments&&(n.comments=y.comments),void 0!==y.tokens&&(Et(),n.tokens=y.tokens),void 0!==y.errors&&(n.errors=y.errors)}catch(t){throw t}finally{y={}}return n},t.Syntax=function(){var t,e={};for(t in"function"==typeof Object.create&&(e=Object.create(null)),r)r.hasOwnProperty(t)&&(e[t]=r[t]);return"function"==typeof Object.freeze&&Object.freeze(e),e}()})?i.apply(e,r):i)||(t.exports=s)}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";(function(t){var e=n(11);const i=()=>n(160);let r;Object(e.b)().get("IS_NODE")&&Object(e.b)().setPlatform("node",new class{constructor(){this.util=n(161),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return null!=Object(e.b)().global.fetch?Object(e.b)().global.fetch(t,n):(null==r&&(r=i()),r(t,n))}now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}})}).call(this,n(44))},function(t,e){},function(t,e){},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e,n=this,i=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],c=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,c=Math.max(c,e.length)),r=0,s=-32;s<c;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n(22)&&n(32)?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t,n(22))}).call(this,n(31)(t))},function(t,e,n){var i;!function(r,s){var o,a=this,c=s.pow(256,6),l=s.pow(2,52),u=2*l;function h(t,e,n){var i=[],h=f(function t(e,n){var i,r=[],s=typeof e;if(n&&"object"==s)for(i in e)try{r.push(t(e[i],n-1))}catch(t){}return r.length?r:"string"==s?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,m(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(256):(t=new Uint8Array(256),(a.crypto||a.msCrypto).getRandomValues(t)),m(t)}catch(t){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,m(r)]}}():t,3),i),g=new d(i),v=function(){for(var t=g.g(6),e=c,n=0;t<l;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=u;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,f(m(g.S),r),(e.pass||n||function(t,e,n,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),n?(s.random=t,e):t})(v,h,"global"in e?e.global:this==s,e.state)}function d(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<256;)o[r]=r++;for(r=0;r<256;r++)o[r]=o[s=255&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=255&r+1],n=256*n+o[255&(o[r]=o[s=255&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(256)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,i=t+"",r=0;r<i.length;)e[255&r]=255&(n^=19*e[255&r])+i.charCodeAt(r++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(s.seedrandom=h,f(s.random(),r),t.exports){t.exports=h;try{o=n(169)}catch(t){}}else void 0===(i=function(){return h}.call(e,n,e,t))||(t.exports=i)}([],Math)},function(t,e){},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new s(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(171),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(21))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,s,o,a,c=1,l={},u=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){f(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&f(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),i=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){f(t.data)},i=function(t){s.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(f,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return l[c]=r,i(c),c++},d.clearImmediate=p}function p(t){delete l[t]}function f(t){if(u)setTimeout(f,0,t);else{var e=l[t];if(e){u=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{p(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(21),n(44))},function(t,e){function n(t){for(var e,n=new i(t),r=[];!n.eof();){var s=o();r.push(s)}return r;function o(){var t={};t.deltaTime=n.readVarInt();var i=n.readUInt8();if(240==(240&i)){if(255!==i){if(240==i)return t.type="sysEx",s=n.readVarInt(),t.data=n.readBytes(s),t;if(247==i)return t.type="endSysEx",s=n.readVarInt(),t.data=n.readBytes(s),t;throw"Unrecognised MIDI event type byte: "+i}t.meta=!0;var r=n.readUInt8(),s=n.readVarInt();switch(r){case 0:if(t.type="sequenceNumber",2!==s)throw"Expected length for sequenceNumber event is 2, got "+s;return t.number=n.readUInt16(),t;case 1:return t.type="text",t.text=n.readString(s),t;case 2:return t.type="copyrightNotice",t.text=n.readString(s),t;case 3:return t.type="trackName",t.text=n.readString(s),t;case 4:return t.type="instrumentName",t.text=n.readString(s),t;case 5:return t.type="lyrics",t.text=n.readString(s),t;case 6:return t.type="marker",t.text=n.readString(s),t;case 7:return t.type="cuePoint",t.text=n.readString(s),t;case 32:if(t.type="channelPrefix",1!=s)throw"Expected length for channelPrefix event is 1, got "+s;return t.channel=n.readUInt8(),t;case 33:if(t.type="portPrefix",1!=s)throw"Expected length for portPrefix event is 1, got "+s;return t.port=n.readUInt8(),t;case 47:if(t.type="endOfTrack",0!=s)throw"Expected length for endOfTrack event is 0, got "+s;return t;case 81:if(t.type="setTempo",3!=s)throw"Expected length for setTempo event is 3, got "+s;return t.microsecondsPerBeat=n.readUInt24(),t;case 84:if(t.type="smpteOffset",5!=s)throw"Expected length for smpteOffset event is 5, got "+s;var o=n.readUInt8();return t.frameRate={0:24,32:25,64:29,96:30}[96&o],t.hour=31&o,t.min=n.readUInt8(),t.sec=n.readUInt8(),t.frame=n.readUInt8(),t.subFrame=n.readUInt8(),t;case 88:if(t.type="timeSignature",4!=s)throw"Expected length for timeSignature event is 4, got "+s;return t.numerator=n.readUInt8(),t.denominator=1<<n.readUInt8(),t.metronome=n.readUInt8(),t.thirtyseconds=n.readUInt8(),t;case 89:if(t.type="keySignature",2!=s)throw"Expected length for keySignature event is 2, got "+s;return t.key=n.readInt8(),t.scale=n.readUInt8(),t;case 127:return t.type="sequencerSpecific",t.data=n.readBytes(s),t;default:return t.type="unknownMeta",t.data=n.readBytes(s),t.metatypeByte=r,t}}else{var a;if(0==(128&i)){if(null===e)throw"Running status byte encountered before status byte";a=i,i=e,t.running=!0}else a=n.readUInt8(),e=i;var c=i>>4;switch(t.channel=15&i,c){case 8:return t.type="noteOff",t.noteNumber=a,t.velocity=n.readUInt8(),t;case 9:var l=n.readUInt8();return t.type=0===l?"noteOff":"noteOn",t.noteNumber=a,t.velocity=l,0===l&&(t.byte9=!0),t;case 10:return t.type="noteAftertouch",t.noteNumber=a,t.amount=n.readUInt8(),t;case 11:return t.type="controller",t.controllerType=a,t.value=n.readUInt8(),t;case 12:return t.type="programChange",t.programNumber=a,t;case 13:return t.type="channelAftertouch",t.amount=a,t;case 14:return t.type="pitchBend",t.value=a+(n.readUInt8()<<7)-8192,t;default:throw"Unrecognised MIDI event type: "+c}}}}function i(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}i.prototype.eof=function(){return this.pos>=this.bufferLen},i.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t},i.prototype.readInt8=function(){var t=this.readUInt8();return 128&t?t-256:t},i.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},i.prototype.readInt16=function(){var t=this.readUInt16();return 32768&t?t-65536:t},i.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},i.prototype.readInt24=function(){var t=this.readUInt24();return 8388608&t?t-16777216:t},i.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},i.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e},i.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)},i.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(!(128&e))return t+e;t+=127&e,t<<=7}return t},i.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32();return{id:t,length:e,data:this.readBytes(e)}},t.exports=function(t){var e=new i(t),r=e.readChunk();if("MThd"!=r.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+r.id+"'";for(var s=function(t){var e=new i(t),n={format:e.readUInt16(),numTracks:e.readUInt16()},r=e.readUInt16();return 32768&r?(n.framesPerSecond=256-(r>>8),n.ticksPerFrame=255&r):n.ticksPerBeat=r,n}(r.data),o=[],a=0;!e.eof()&&a<s.numTracks;a++){var c=e.readChunk();if("MTrk"!=c.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+c.id+"'";var l=n(c.data);o.push(l)}return{header:s,tracks:o}}},function(t,e){function n(t,e,n){var s,o=new r,a=e.length,c=null;for(s=0;s<a;s++)!1!==n.running&&(n.running||e[s].running)||(c=null),c=i(o,e[s],c,n.useByte9ForNoteOff);t.writeChunk("MTrk",o.buffer)}function i(t,e,n,i){var r=e.type,s=e.deltaTime,o=e.text||"",a=e.data||[],c=null;switch(t.writeVarInt(s),r){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(o.length),t.writeString(o);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(o.length),t.writeString(o);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(o.length),t.writeString(o);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(o.length),t.writeString(o);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(o.length),t.writeString(o);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(o.length),t.writeString(o);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(o.length),t.writeString(o);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var l=31&e.hour|{24:0,25:32,29:64,30:96}[e.frameRate];t.writeUInt8(l),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var u=255&Math.floor(Math.log(e.denominator)/Math.LN2);t.writeUInt8(u),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(a.length),t.writeBytes(a);break;case"unknownMeta":null!=e.metatypeByte&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(a.length),t.writeBytes(a));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(a.length),t.writeBytes(a);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(a.length),t.writeBytes(a);break;case"noteOff":(c=(!1!==i&&e.byte9||i&&0==e.velocity?144:128)|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":(c=144|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":(c=160|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":(c=176|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":(c=192|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.programNumber);break;case"channelAftertouch":(c=208|e.channel)!==n&&t.writeUInt8(c),t.writeUInt8(e.amount);break;case"pitchBend":(c=224|e.channel)!==n&&t.writeUInt8(c);var h=8192+e.value,d=127&h,p=h>>7&127;t.writeUInt8(d),t.writeUInt8(p);break;default:throw"Unrecognized event type: "+r}return c}function r(){this.buffer=[]}r.prototype.writeUInt8=function(t){this.buffer.push(255&t)},r.prototype.writeInt8=r.prototype.writeUInt8,r.prototype.writeUInt16=function(t){var e=t>>8&255,n=255&t;this.writeUInt8(e),this.writeUInt8(n)},r.prototype.writeInt16=r.prototype.writeUInt16,r.prototype.writeUInt24=function(t){var e=t>>16&255,n=t>>8&255,i=255&t;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i)},r.prototype.writeInt24=r.prototype.writeUInt24,r.prototype.writeUInt32=function(t){var e=t>>24&255,n=t>>16&255,i=t>>8&255,r=255&t;this.writeUInt8(e),this.writeUInt8(n),this.writeUInt8(i),this.writeUInt8(r)},r.prototype.writeInt32=r.prototype.writeUInt32,r.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))},r.prototype.writeString=function(t){var e,n=t.length,i=[];for(e=0;e<n;e++)i.push(t.codePointAt(e));this.writeBytes(i)},r.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,n=[];for(n.push(127&e),e>>=7;e;){var i=127&e|128;n.push(i),e>>=7}this.writeBytes(n.reverse())}},r.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)},t.exports=function(t,e){if("object"!=typeof t)throw"Invalid MIDI data";e=e||{};var i,s=t.header||{},o=t.tracks||[],a=o.length,c=new r;for(function(t,e,n){var i=null==e.format?1:e.format,s=128;e.timeDivision?s=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?s=-(255&e.framesPerSecond)<<8|255&e.ticksPerFrame:e.ticksPerBeat&&(s=32767&e.ticksPerBeat);var o=new r;o.writeUInt16(i),o.writeUInt16(n),o.writeUInt16(s),t.writeChunk("MThd",o.buffer)}(c,s,a),i=0;i<a;i++)n(c,o[i],e);return c.buffer}},function(t,e,n){"use strict";var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(79),o=n(66),a=r(n(175));function c(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:t.value}}function l(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}e.encode=function(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:i([i([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map((function(t){return function(t){var e=o.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:"major"===t.scale?0:1,type:"keySignature"}}(t)})),t.header.meta.map((function(t){return{absoluteTime:(e=t).ticks,deltaTime:0,meta:!0,text:e.text,type:e.type};var e})),t.header.tempos.map((function(t){return function(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}(t)})),t.header.timeSignatures.map((function(t){return function(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}(t)})))],t.tracks.map((function(t){return i([(e=t.name,{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}),l(t)],function(t){return a.default(t.notes.map((function(e){return function(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(127*t.velocity)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(127*t.noteOffVelocity)}]}(e,t.channel)})))}(t),function(t){for(var e=[],n=0;n<127;n++)t.controlChanges.hasOwnProperty(n)&&t.controlChanges[n].forEach((function(n){e.push(c(n,t.channel))}));return e}(t),function(t){var e=[];return t.pitchBends.forEach((function(n){e.push(function(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}(n,t.channel))})),e}(t));var e})))};return e.tracks=e.tracks.map((function(t){t=t.sort((function(t,e){return t.absoluteTime-e.absoluteTime}));var e=0;return t.forEach((function(t){t.deltaTime=t.absoluteTime-e,e=t.absoluteTime,delete t.absoluteTime})),t.push({deltaTime:0,meta:!0,type:"endOfTrack"}),t})),new Uint8Array(s.writeMidi(e))}},function(t,e,n){"use strict";function i(t){return function t(e,n){for(var i=0;i<e.length;i++){var r=e[i];Array.isArray(r)?t(r,n):n.push(r)}return n}(t,[])}function r(t,e){if("number"!=typeof e)throw new TypeError("Expected the depth to be a number");return function t(e,n,i){i--;for(var r=0;r<e.length;r++){var s=e[r];i>-1&&Array.isArray(s)?t(s,n,i):n.push(s)}return n}(t,[],e)}t.exports=function(t){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return i(t)},t.exports.from=i,t.exports.depth=function(t,e){if(!Array.isArray(t))throw new TypeError("Expected value to be an array");return r(t,e)},t.exports.fromDepth=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(82);e.createControlChanges=function(){return new Proxy({},{get:function(t,e){return t[e]?t[e]:i.controlChangeIds.hasOwnProperty(e)?t[i.controlChangeIds[e]]:void 0},set:function(t,e,n){return i.controlChangeIds.hasOwnProperty(e)?t[i.controlChangeIds[e]]=n:t[e]=n,!0}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new WeakMap,r=function(){function t(t,e){i.set(this,e),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(t.prototype,"time",{get:function(){return i.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=i.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();e.PitchBend=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(179),r=new WeakMap,s=function(){function t(t,e){if(this.number=0,r.set(this,e),this.number=0,t){var n=t.find((function(t){return"programChange"===t.type}));n&&(this.number=n.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?i.DrumKitByPatchID[this.number]:i.instrumentByPatchID[this.number]},set:function(t){var e=i.instrumentByPatchID.indexOf(t);-1!==e&&(this.number=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":i.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){return 9===r.get(this).channel},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},t.prototype.fromJSON=function(t){this.number=t.number},t}();e.Instrument=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},function(t,e,n){"use strict";function i(t){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]}Object.defineProperty(e,"__esModule",{value:!0});var r,s,o=(r=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,s={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},function(t){var e=r.exec(t),n=e[1],i=e[2];return s[n.toLowerCase()]+12*(parseInt(i,10)+1)}),a=new WeakMap,c=function(){function t(t,e,n){a.set(this,n),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=e.velocity,this.ticks=t.ticks,this.durationTicks=e.ticks-t.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return t=this.midi,e=Math.floor(t/12)-1,i(t)+e.toString();var t,e},set:function(t){this.midi=o(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var e=t-this.octave;this.midi+=12*e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return i(this.midi)},set:function(t){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var t=a.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var e=a.get(this).secondsToTicks(this.time+t);this.durationTicks=e-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return a.get(this).ticksToSeconds(this.ticks)},set:function(t){var e=a.get(this);this.ticks=e.secondsToTicks(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){return a.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();e.Note=c},function(t,e,n){"use strict";n.r(e);var i=n(10);n.d(e,"NoteSequence",(function(){return i.a}))},function(t,e,n){"use strict";n.r(e),n.d(e,"DDSP",(function(){return Tr}));var i={};n.r(i),n.d(i,"simpleAbsImpl",(function(){return z})),n.d(i,"addImpl",(function(){return X})),n.d(i,"ceilImpl",(function(){return Z})),n.d(i,"expImpl",(function(){return J})),n.d(i,"expm1Impl",(function(){return $})),n.d(i,"floorImpl",(function(){return tt})),n.d(i,"logImpl",(function(){return et})),n.d(i,"maxImpl",(function(){return nt})),n.d(i,"multiplyImpl",(function(){return it})),n.d(i,"notEqualImpl",(function(){return st})),n.d(i,"rsqrtImpl",(function(){return ot})),n.d(i,"sliceImpl",(function(){return at})),n.d(i,"squaredDifferenceImpl",(function(){return ct})),n.d(i,"subImpl",(function(){return lt})),n.d(i,"transposeImpl",(function(){return ht})),n.d(i,"uniqueImpl",(function(){return dt}));var r=n(0);const s={},o={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function a(t){if(!(t in s)){const e=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete s[t]}),!1),1===t?e.getContext("webgl",o)||e.getContext("experimental-webgl",o):e.getContext("webgl2",o)}(t);if(null===e)return console.log("Could not get context for WebGL version",t),null;s[t]=e}const e=s[t];return e.isContextLost()?(delete s[t],a(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),s[t])}var c,l,u;function h(t,e){return[e,t]}function d(t){const e=r.Lb.sizeFromShape(t),n=Math.ceil(e/4);return r.Lb.sizeToSquarishShape(n)}function p(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function f(t,e){const n=t;let i,s,o,a,c,l,u,h,d,p;return 2===Object(r.jb)().getNumber("WEBGL_VERSION")?(i=n.R32F,s=n.R16F,o=n.RGBA16F,a=n.RGBA32F,c=n.RED,u=4,h=1,d=n.HALF_FLOAT,p=n.FLOAT):(i=t.RGBA,s=t.RGBA,o=t.RGBA,a=n.RGBA,c=t.RGBA,u=4,h=4,d=null!=e?e.HALF_FLOAT_OES:null,p=t.FLOAT),l=t.RGBA,{internalFormatFloat:i,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:c,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:p}}function m(t,e){const n=e();return Object(r.jb)().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}(t,e))}(t),n}function g(t){return!!(Object(r.jb)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function v(t,e){return C(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}function y(t,e){const n=C(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(m(t,(()=>t.shaderSource(n,e))),m(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){const n=x.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);const i=+n[1],s=t.split("\n"),o=s.length.toString().length+2,a=s.map(((t,e)=>r.Lb.rightPad((e+1).toString(),o)+t));let c=0;for(let r=0;r<a.length;r++)c=Math.max(a[r].length,c);const l=a.slice(0,i-1),u=a.slice(i-1,i),h=a.slice(i);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+r.Lb.rightPad(u[0],c),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(c||(c={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(l||(l={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(u||(u={}));const x=/ERROR: [0-9]+:([0-9]+):/g;function b(t,e){if(m(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function w(t,e,n,i,r,s,o){const a=t.getAttribLocation(e,n);return-1!==a&&(m(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,i))),m(t,(()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,s,o))),m(t,(()=>t.enableVertexAttribArray(a))),!0)}function S(t,e,n,i){m(t,(()=>function(t,e,n){(function(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,i=e+t.TEXTURE0;if(i<t.TEXTURE0||i>n)throw new Error("textureUnit must be in ".concat("[gl.TEXTURE0, gl.TEXTURE".concat(n,"]"),"."))})(t,n),m(t,(()=>t.activeTexture(t.TEXTURE0+n))),m(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}(t,e,i))),m(t,(()=>t.uniform1i(n,i)))}function _(t,e,n){m(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),m(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function T(t,e){m(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),m(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function E(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}(t,e))}function C(t,e,n){const i=m(t,(()=>e()));if(null==i)throw new Error(n);return i}function k(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return r.Lb.sizeFromShape(t.slice(0,t.length-e))}function A(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function I(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[k(t),...A(t)]),e}function O(t){return t%2==0}function R(t,e){if(t=t.slice(-2),e=e.slice(-2),r.Lb.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],i=e.slice(-1)[0];if(n===i)return!0;if(O(n)&&O(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&O(t[0])&&O(e[0])}let N,M;function D(t,e){return null!=t.getExtension(e)}function P(t){try{if(null!=a(t))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function F(t){const e=f(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const r=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),r}function L(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&r.Lb.assert("complex64"!==t.dtype,(()=>e+" does not support complex64 tensors in the WebGL backend."))}))}const B=Object(r.jb)();function z(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}function U(t){return(e,n,i,s,o)=>{const a=r.X.assertAndGetBroadcastShape(e,n),c=a.length,l=r.Lb.computeStrides(a),u=r.Lb.sizeFromShape(a),h=r.Lb.getTypedArrayFromDType(o,u),d=e.length,p=n.length,f=r.Lb.computeStrides(e),m=r.Lb.computeStrides(n),g=r.X.getBroadcastDims(e,a),v=r.X.getBroadcastDims(n,a);if(g.length+v.length===0)for(let r=0;r<h.length;++r)h[r]=t(i[r%i.length],s[r%s.length]);else for(let y=0;y<h.length;++y){const e=r.Lb.indexToLoc(y,c,l),n=e.slice(-d);g.forEach((t=>n[t]=0));const o=r.Lb.locToIndex(n,d,f),a=e.slice(-p);v.forEach((t=>a[t]=0));const u=r.Lb.locToIndex(a,p,m);h[y]=t(i[o],s[u])}return[h,a]}}function j(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&r.Lb.assert("complex64"!==t.dtype,(()=>e+" does not support complex64 tensors in the CPU backend."))}))}function V(t){const{inputs:e,backend:n}=t,{real:i,imag:r}=e,s=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(i.shape,"complex64");return n.data.get(a.dataId).complexTensorInfos={real:n.makeTensorInfo(i.shape,"float32",s),imag:n.makeTensorInfo(r.shape,"float32",o)},a}function W(t){const{inputs:e,backend:n}=t,{x:i}=e;return n.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}function G(t){const{inputs:e,backend:n,attrs:i}=t,{x:s}=e,{dtype:o}=i;if("complex64"===o){if("complex64"===s.dtype)return W({inputs:{x:s},backend:n});const t=r.Nb(s.shape),e=G({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),i=V({inputs:{real:e,imag:t},backend:n});return t.dispose(),n.disposeIntermediateTensorInfo(e),i}if("complex64"===s.dtype){const t=function(t){const{inputs:e,backend:n}=t,{input:i}=e,r=n.data.get(i.dataId).complexTensorInfos.real,s=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,s)}({inputs:{input:s},backend:n}),e=G({inputs:{x:t},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(t),e}if(!r.Lb.hasEncodingLoss(s.dtype,o)){const t=W({inputs:{x:s},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:o}}if("int32"===o){const t=n.data.get(s.dataId).values,e=Int32Array.from(t);return n.makeTensorInfo(s.shape,"int32",e)}if("bool"===o){const t=n.data.get(s.dataId).values,e=r.Lb.toTypedArray([0],s.dtype),[i,o]=U(((t,e)=>t!==e?1:0))(s.shape,[],t,e,"bool");return n.makeTensorInfo(o,"bool",i)}throw new Error("Error in Cast: failed to cast ".concat(s.dtype," to ").concat(o))}function q(t,e,n,i){return null==n?n=>{let{inputs:r,backend:s}=n;const{a:o,b:a}=r,c=s;j([o,a],t);const l=c.data.get(o.dataId).values,u=c.data.get(a.dataId).values,h=i||o.dtype,[d,p]=e(o.shape,a.shape,l,u,h);return c.makeTensorInfo(p,h,d)}:t=>{let{inputs:r,backend:s}=t;const{a:o,b:a}=r,c=s;if("complex64"===o.dtype||"complex64"===a.dtype){const t=G({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),e=c.data.get(t.dataId),i=e.complexTensorInfos.real,r=e.complexTensorInfos.imag,s=c.data.get(i.dataId).values,l=c.data.get(r.dataId).values,u=G({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),h=c.data.get(u.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=c.data.get(d.dataId).values,m=c.data.get(p.dataId).values,[g,v,y]=n(o.shape,a.shape,s,l,f,m),x=c.makeTensorInfo(y,"float32",g),b=c.makeTensorInfo(y,"float32",v),w=V({inputs:{real:x,imag:b},backend:c});return c.disposeIntermediateTensorInfo(t),c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(b),w}{const t=c.data.get(o.dataId).values,n=c.data.get(a.dataId).values,r=i||o.dtype,[s,l]=e(o.shape,a.shape,t,n,r);return c.makeTensorInfo(l,r,s)}}}function H(t){return(e,n,i,s,o,a)=>{const c=r.X.assertAndGetBroadcastShape(e,n),l=r.Lb.sizeFromShape(c),u=c.length,h=r.Lb.computeStrides(c),d=r.Lb.getTypedArrayFromDType("float32",l),p=r.Lb.getTypedArrayFromDType("float32",l),f=r.X.getBroadcastDims(e,c),m=r.X.getBroadcastDims(n,c),g=r.X.mergeRealAndImagArrays(i,s),v=r.X.mergeRealAndImagArrays(o,a),y=e.length,x=r.Lb.computeStrides(e),b=n.length,w=r.Lb.computeStrides(n);if(f.length+m.length===0)for(let r=0;r<d.length;r++){const e=r%g.length,n=r%v.length,i=t(g[2*e],g[2*e+1],v[2*n],v[2*n+1]);d[r]=i.real,p[r]=i.imag}else for(let S=0;S<d.length;S++){const e=r.Lb.indexToLoc(S,u,h),n=e.slice(-y);f.forEach((t=>n[t]=0));const i=r.Lb.locToIndex(n,y,x),s=e.slice(-b);m.forEach((t=>s[t]=0));const o=r.Lb.locToIndex(s,b,w),a=t(g[2*i],g[2*i+1],v[2*o],v[2*o+1]);d[S]=a.real,p[S]=a.imag}return[d,p,c]}}B.registerFlag("HAS_WEBGL",(()=>B.getNumber("WEBGL_VERSION")>0)),B.registerFlag("WEBGL_VERSION",(()=>P(2)?2:P(1)?1:0)),B.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),B.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===B.get("WEBGL_VERSION"))),B.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),B.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),B.registerFlag("WEBGL_PACK",(()=>B.getBool("HAS_WEBGL"))),B.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_CLIP",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>!1)),B.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_PACK_REDUCE",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_LAZILY_UNPACK",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_CONV_IM2COL",(()=>B.getBool("WEBGL_PACK"))),B.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(t){if(null==N){const e=a(t);N=e.getParameter(e.MAX_TEXTURE_SIZE)}return N}(B.getNumber("WEBGL_VERSION")))),B.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(t){if(null==M){const e=a(t);M=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,M)}(B.getNumber("WEBGL_VERSION")))),B.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=B.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=a(t);return e=D(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:D(n,"EXT_disjoint_timer_query")?1:0,e}(t)})),B.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>B.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r.fb.isMobile())),B.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(t){if(0===t)return!1;const e=a(t);if(1===t){if(!D(e,"OES_texture_float"))return!1}else if(!D(e,"EXT_color_buffer_float"))return!1;return F(e)}(B.getNumber("WEBGL_VERSION")))),B.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!B.getBool("WEBGL_FORCE_F16_TEXTURES")&&B.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),B.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>function(t){if(0===t)return!1;const e=a(t);if(1!==t){if(D(e,"EXT_color_buffer_float"))return F(e);const t="EXT_color_buffer_half_float";if(D(e,t)){const n=e.getExtension(t);return function(t,e){const n=f(t,e),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(i),t.deleteFramebuffer(r),s}(e,n)}return!1}return!!D(e,"OES_texture_float")&&!!D(e,"WEBGL_color_buffer_float")&&F(e)}(B.getNumber("WEBGL_VERSION")))),B.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(t=B.getNumber("WEBGL_VERSION"))&&null!=a(t).fenceSync;var t})),B.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>B.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),B.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ".concat(t,"."))})),r.a,r.h,r.u,r.J,r.f;const X=U(((t,e)=>t+e)),Y=H(((t,e,n,i)=>({real:t+n,imag:e+i})));function K(t){return(e,n,i)=>{const s=r.Lb.getTypedArrayFromDType(n,e.length);for(let r=0;r<e.length;++r)s[r]=t(e[r],i);return s}}function Q(t,e,n){return i=>{let{inputs:r,attrs:s,backend:o}=i;const{x:a}=r;if(j(a,t),"string"===a.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=o,l=c.data.get(a.dataId).values,u=n||a.dtype,h=e(l,u,s);return c.makeTensorInfo(a.shape,u,h)}}q(r.b,X,Y),r.b;const Z=K((t=>Math.ceil(t))),J=(Q(r.g,Z),r.g,K((t=>Math.exp(t)))),$=(Q(r.m,J),r.m,K((t=>Math.expm1(t)))),tt=(Q(r.n,$),r.n,K((t=>Math.floor(t)))),et=(Q(r.q,tt),r.q,K((t=>Math.log(t))));function nt(t,e,n,i){const s=r.Lb.getTypedArrayFromDType(i,r.Lb.sizeFromShape(n));for(let r=0;r<s.length;++r){const n=r*e;let i=t[n];for(let r=0;r<e;++r){const e=t[n+r];e>i&&(i=e)}s[r]=i}return s}Q(r.x,et),r.x;const it=U(((t,e)=>t*e)),rt=H(((t,e,n,i)=>({real:t*n-e*i,imag:t*i+e*n}))),st=(q(r.E,it,rt),r.E,U(((t,e)=>t!==e?1:0))),ot=(q(r.I,st,null,"bool"),r.I,K((t=>1/Math.sqrt(t))));function at(t,e,n,i,s){const o=r.Ab.isSliceContinous(i,e,n),a=r.Lb.sizeFromShape(n),c=r.Lb.computeStrides(i);if(o){const n=r.Ab.computeFlatOffset(e,c);return t.subarray(n,n+a)}const l=r.Lb.getTypedArrayFromDType(s,a);for(let u=0;u<a;++u){const s=n.length,o=r.Lb.computeStrides(n),a=r.Lb.indexToLoc(u,s,o).map(((t,n)=>t+e[n])),h=r.Lb.locToIndex(a,i.length,c);l[u]=t[h]}return l}Q(r.M,ot),r.M,r.O;const ct=U(((t,e)=>{const n=t-e;return n*n})),lt=(q(r.Q,ct),r.Q,U(((t,e)=>t-e))),ut=H(((t,e,n,i)=>({real:t-n,imag:e-i})));function ht(t,e,n,i,s){const o=e.length,a=r.Lb.sizeFromShape(e),c=r.Lb.computeStrides(e),l=r.Lb.computeStrides(s),u=r.Lb.getTypedArrayFromDType(n,r.Lb.sizeFromShape(s));for(let h=0;h<a;++h){const e=r.Lb.indexToLoc(h,o,c),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[i[t]];u[r.Lb.locToIndex(n,o,l)]=t[h]}return u}function dt(t,e,n,i){const s=r.Lb.parseAxisParam(e,n)[0],o=[1,n[0],1];for(let r=0;r<s;r++)o[0]*=n[r];o[1]=n[s];for(let r=s+1;r<n.length;r++)o[2]*=n[r];const a={},c=new Int32Array(n[s]),l=new r.T(o,i,t),u=[],h=1===o[0]&&1===o[2];for(let r=0;r<n[s];r++){let e;if(h)e=t[r].toString();else{const t=[];for(let e=0;e<o[0];e++)for(let n=0;n<o[2];n++)t.push(l.get(e,r,n));e=t.join(",")}if(void 0!==a[e])c[r]=a[e];else{const t=Object.keys(a).length;a[e]=t,c[r]=t,u.push(r)}}const d=o.slice();d[1]=Object.keys(a).length;const p=new r.T(d,i);u.forEach(((t,e)=>{for(let n=0;n<o[0];n++)for(let i=0;i<o[2];i++)p.set(l.get(n,t,i),n,e,i)}));const f=n.slice();return f[s]=d[1],{outputValues:p.values,outputShape:f,indices:c}}q(r.R,lt,ut),r.R;const{simpleAbsImpl:pt,addImpl:ft,ceilImpl:mt,expImpl:gt,expm1Impl:vt,floorImpl:yt,logImpl:xt,maxImpl:bt,multiplyImpl:wt,rsqrtImpl:St,sliceImpl:_t,subImpl:Tt,transposeImpl:Et,uniqueImpl:Ct}=i;class kt{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>"T"+e));const n=[];this.variableNames.forEach((t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));const i=this.variableNames.map((t=>"v"+t)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(i,";\n        setOutput(result);\n      }\n    ")}}class At{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>"T"+e));const n=[];this.variableNames.forEach((t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));const i=this.variableNames.map((t=>"v"+t)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(i,";\n        setOutput(result);\n      }\n    ")}}class It{constructor(t,e,n){this.variableNames=["A"];const{windowSize:i,batchSize:r,outSize:s}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s];const o="max"===e?">":"<",a=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(i,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          int inIdx = ").concat(a,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}function Ot(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>"".concat(t,".").concat(e)))}function Rt(t,e){return 1===e?[t]:Ot(t,e)}function Nt(){let t,e,n,i,s,o,a,c,l,u;return 2===Object(r.jb)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",i="in",s="texture",o="outputColor",a="out vec4 outputColor;",c="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",i="varying",s="texture2D",o="gl_FragColor",a="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:i,texture2D:s,output:o,defineOutput:a,defineSpecialNaN:c,defineSpecialInf:l,defineRound:u}}function Mt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const i=r.Lb.computeStrides(e);return i.map(((e,r)=>"".concat("int ".concat(t[r]," = ").concat(n," / ").concat(e),"; ",r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(e):"index -= ".concat(t[r]," * ").concat(e),";"))).join("")}function Dt(t){const e=r.Lb.computeStrides(t).map((t=>t.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}const Pt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:Ft}=r.X;function Lt(t,e,n,i){const s=[];t.forEach((t=>{const e=r.Lb.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?s.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(s.push("uniform sampler2D ".concat(t.name,";")),s.push("uniform int offset".concat(t.name,";")))}));const o=s.join("\n"),a=t.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="";i+=n?zt(t):Bt(t);const s=t.shapeInfo.logicalShape,o=e.logicalShape;return s.length<=o.length&&(i+=n?function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),s="get"+i+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length,c=Ft(t.shapeInfo.logicalShape,e.logicalShape),l=Ht(a),u=a-o;let h;const d=["x","y","z","w","u","v"];h=0===o?"":a<2&&c.length>=1?"coords = 0;":c.map((t=>"coords.".concat(d[t+u]," = 0;"))).join("\n");let p="";p=a<2&&o>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords."+d[e+u])).join(", ");let f="return outputValue;";const m=1===r.Lb.sizeFromShape(t.shapeInfo.logicalShape),g=1===r.Lb.sizeFromShape(e.logicalShape);if(1!==o||m||g){if(m&&!g)f=1===a?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){const t=o-2,e=o-1;c.indexOf(t)>-1&&c.indexOf(e)>-1?f="return vec4(outputValue.x);":c.indexOf(t)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(e)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(s,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(h,"\n      vec4 outputValue = get").concat(i,"(").concat(p,");\n      ").concat(f,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),s="get"+i+"AtOutCoords",o=e.texShape,a=t.shapeInfo.texShape,c=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&c===l&&null==t.shapeInfo.flatOffset&&r.Lb.arraysEqual(a,o))return"\n      float ".concat(s,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const u=Ht(l),h=Ft(t.shapeInfo.logicalShape,e.logicalShape),d=l-c;let p;const f=["x","y","z","w","u","v"];p=0===c?"":l<2&&h.length>=1?"coords = 0;":h.map((t=>"coords.".concat(f[t+d]," = 0;"))).join("\n");let m="";return m=l<2&&c>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords."+f[e+d])).join(", "),"\n    float ".concat(s,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(p,"\n      return get").concat(i,"(").concat(m,");\n    }\n  ")}(t,e)),i}(t,e,i))).join("\n"),c=e.texShape,l=Nt(),u=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l);let h,d,p=function(t){return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Ut,"\n    ").concat(jt,"\n    ").concat(Vt,"\n  ")}(l);return e.isPacked?(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.Lb.arraysEqual(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");const i=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),r=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),r=i*Math.ceil(t[t.length-2]/2);let s=r,o="",a="b, r, c";for(let c=2;c<t.length-1;c++)s*=t[t.length-c-1],o="\n      int b".concat(c," = index / ").concat(s,";\n      index -= b").concat(c," * ").concat(s,";\n    ")+o,a="b".concat(c,", ")+a;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(a,");\n    }\n  ")}(t,e)}}(e.logicalShape,c),d=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(l)):(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    "):1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e);case 2:return function(t,e){return r.Lb.arraysEqual(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    "):1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=Mt(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e);case 4:return function(t,e){const n=Mt(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e);case 5:return function(t,e){const n=Mt(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=Mt(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}}(e.logicalShape,c),d=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),i&&(p+=Wt),[p,u,d,o,h,a,n].join("\n")}function Bt(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(e,";}");const[i,r]=t.shapeInfo.texShape;if(1===i&&1===r)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");const[s,o]=t.shapeInfo.texShape,a=Gt(e);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(o,", ").concat(a,");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(qt(t),"\n      }\n    ");const i=t.shapeInfo.texShape,r=i[0],s=i[1];if(1===s&&1===r)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");const o=Gt(e);return 1===s?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(r,".0);\n        return sampleTexture(").concat(e,", uv);\n      }\n    "):1===r?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(s,".0, 0.5);\n        return sampleTexture(").concat(e,", uv);\n      }\n    "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(r,", ").concat(s,", index + ").concat(o,");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape;if(null!=s&&r.Lb.arraysEqual(e,s)){const t=s[0],e=s[1];return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(e,".0, ").concat(t,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}const{newShape:o,keptDims:a}=r.Lb.squeezeShape(e),c=o;if(c.length<e.length){const e=Xt(t,c),n=["row","col"];return"\n      ".concat(Bt(e),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(Yt(n,a),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(e[1],", 1)));\n        ").concat(qt(t),"\n      }\n    ");const l=s[0],u=s[1],h=Gt(n);return 1===u?"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(e[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):1===l?"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(e[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(e[1]," + col + ").concat(h,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(u,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[1]*e[2],o=e[2],{newShape:a,keptDims:c}=r.Lb.squeezeShape(e),l=a;if(l.length<e.length){const e=Xt(t,l),n=["row","col","depth"];return"\n        ".concat(Bt(e),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(Yt(n,c),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(s,", ").concat(o,", 1)));\n        ").concat(qt(t),"\n      }\n    ");const u=t.shapeInfo.texShape,h=u[0],d=u[1],p=t.shapeInfo.flatOffset;if(d===s&&null==p)return"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(h,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(d===o&&null==p)return"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(e[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(h,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const f=Gt(n);return"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(s," + col * ").concat(o," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[3],o=e[2]*s,a=e[1]*o,{newShape:c,keptDims:l}=r.Lb.squeezeShape(e);if(c.length<e.length){const e=Xt(t,c),n=["row","col","depth","depth2"];return"\n      ".concat(Bt(e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(Yt(n,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(a,", ").concat(o,", ").concat(s,", 1)));\n        ").concat(qt(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];if(p===a&&null==u)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(s,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===s&&null==u)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(e[1]*e[2],", ").concat(e[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=Gt(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(a," + col * ").concat(o," +\n          depth * ").concat(s," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index + ").concat(f,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,a=e[2]*o,c=e[1]*a,{newShape:l,keptDims:u}=r.Lb.squeezeShape(e);if(l.length<e.length){const e=Xt(t,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(Bt(e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(i,"(").concat(Yt(n,u),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(a,", ").concat(o,", ").concat(s,")) +\n          depth3;\n        ").concat(qt(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===c&&null==h)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(a,", ").concat(o,", ").concat(s,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===s&&null==h)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=Gt(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(a," + depth * ").concat(o," +\n          depth2 * ").concat(s," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=r.Lb.squeezeShape(e);if(s.length<e.length){const e=Xt(t,s),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Bt(e),"\n      float ").concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(i,"(").concat(Yt(n,o),");\n      }\n    ")}const a=e[5],c=e[4]*a,l=e[3]*c,u=e[2]*l,h=e[1]*u;if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(h,", ").concat(u,", ").concat(l,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(a,", 1)));\n        ").concat(qt(t),"\n      }\n    ");const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];if(m===h&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(u,", ").concat(l,", ").concat(c,", ").concat(a,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const g=Gt(n);return"\n    float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(h," + col * ").concat(u," + depth * ").concat(l," +\n          depth2 * ").concat(c," + depth3 * ").concat(a," + depth4 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function zt(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),i=Nt();return"\n    vec4 ".concat(n,"() {\n      return ").concat(i.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t.shapeInfo.texShape,r=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=Nt();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(r[0],", ").concat(r[1],", index);\n      return ").concat(s.texture2D,"(").concat(e,", uv);\n    }\n  ")}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=s[0],a=s[1],c=Nt();if(null!=s&&r.Lb.arraysEqual(e,s))return"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,".0, ").concat(o,".0);\n\n        return ").concat(c.texture2D,"(").concat(n,", uv);\n      }\n    ");const l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(e[1]/2);return"\n    vec4 ".concat(i,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(1===e[0]){const n=[1,2],r=Xt(t,e.slice(1)),s=["b","row","col"];return"\n        ".concat(zt(r),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(Yt(s,n),");\n        }\n      ")}const o=s[0],a=s[1],c=Math.ceil(e[2]/2),l=c*Math.ceil(e[1]/2),u=Nt();return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(o,", ").concat(a,", ").concat(l,", ").concat(c,", b, row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,i=t.name,r="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],a=o[0],c=o[1],l=Math.ceil(e[n-1]/2);let u=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",d="b * ".concat(u," + (row / 2) * ").concat(l," + (col / 2)");for(let f=2;f<n-1;f++)h="int b".concat(f,", ")+h,u*=e[n-f-1],d="b".concat(f," * ").concat(u," + ")+d;const p=Nt();return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(a,");\n      return ").concat(p.texture2D,"(").concat(i,", uv);\n    }\n  ")}(t)}}const Ut="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",jt="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Vt="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Wt="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Gt(t){return"offset"+t}function qt(t){const e=t.name,n=r.Lb.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function Ht(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function Xt(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Yt(t,e){return e.map((e=>t[e])).join(", ")}class Kt{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.Lb.assert(t.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const s=t[t.length-1],o=Math.ceil(s/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const a=this.outputShape,c=a.length,l=Ht(c),u=Rt("coords",c);let h,d;if(1===o){d=c+1;const t=Ht(d);h="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(u.join(),", 0);\n        ++").concat(u[c-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(u.join(),", 0);\n        ++").concat(u[c-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(u.join(),", 0);\n        --").concat(u[c-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(u.join(),", 0);\n        --").concat(u[c-2],";")}else d=c,h="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(u[c-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(u[c-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(u[c-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(u[c-2],";");const p=["x","y","z","w","u","v"].slice(0,d),f="."+p[d-1],m=p.map((t=>"int "+t)),g=Rt("sourceLocR",d-1).concat("inIdx.r"),v=Rt("sourceLocG",d-1).concat("inIdx.g"),y=Rt("sourceLocB",d-1).concat("inIdx.b"),x=Rt("sourceLocA",d-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=i?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),S="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),_=i?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(_,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(u[c-1]," < ").concat(a[c-1]-1,";\n        bool hasNextRow = ").concat(u[c-2]," < ").concat(a[c-2]-1,";\n        ").concat(h,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(f,", sourceLocG").concat(f,",\n          sourceLocB").concat(f,", sourceLocA").concat(f,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(S,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(S,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}class Qt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=a-1-t.padInfo.top,u=c-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(u,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n            wR += ").concat(s,") {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Zt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,i=t.filterWidth,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=u-1-t.padInfo.front,f=h-1-t.padInfo.top,m=d-1-t.padInfo.left,g=1/(e*n*i);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(r,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const Jt="return (a < 0.) ? b * a : a;";class $t{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=r.X.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const te="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";class ee{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.X.assertAndGetBroadcastShape(e,n);const s=this.outputShape.length;let o="";if(i)if(0===s||1===r.Lb.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          ".concat(Ht(s)," coords = getOutputCoords();\n        "),1===s)o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=Rt("coords",s);o+="\n            bool nextRowOutOfBounds =\n              (".concat(t[s-2]," + 1) >= ").concat(this.outputShape[s-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[s-1]," + 1) >= ").concat(this.outputShape[s-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}}class ne{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class ie{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class re{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}class se{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,i=t.padInfo.top,r=t.padInfo.left,s="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(i,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(s,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class oe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,a=n-1-t.padInfo.left,c=s?1:2,l=s?2:3,u=s?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(s,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class ae{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,i=t.strideWidth,r=t.padInfo.front,s=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(r,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(s,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(i," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class ce{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,i=t.filterWidth,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.front,c=n-1-t.padInfo.top,l=i-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(a,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(r,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(i,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(i," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class le{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,i=t.padInfo.top,r=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(s," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(i,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class ue{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s=e-1-t.padInfo.top,o=n-1-t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(a,"; dm++) {\n              int d2 = d1 * ").concat(a," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class he{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.outputShape=t.outShape;const r=t.padInfo.top,s=t.padInfo.left,o=t.strideHeight,a=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,u=t.filterHeight,h=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4,f="channelsLast"===t.dataFormat,m=f?1:2,g=f?2:3,v=f?3:1;let y="",x="";n&&(y=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(y,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(r,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(g,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(f,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(f,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(b,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class de{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,i=t.padInfo.left,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(r,", ").concat(s,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(i,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(a,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class pe{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.outputShape=t.outShape;const r=t.inHeight,s=t.inWidth,o=t.padInfo.top,a=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,u=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,f=t.outChannels/t.inChannels;let m="",g="";n&&(m=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),g="result = activation(result);");const v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(m,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(f,";\n        int q = d2 - d1 * ").concat(f,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(u,";\n\n          if (xR < 0 || xR >= ").concat(r,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(s,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(v,"\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")}}class fe{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const s=t.inHeight,o=t.inWidth,a=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,m=f;let g="int xR; int xC; int xCOffset;";for(let r=0;r<p;r++)for(let t=0;t<f;t++)g+="\n          vec4 xTexelR".concat(r,"C").concat(2*t," = vec4(0.);\n          vec4 wR").concat(r,"C").concat(t," = vec4(0.);\n          vec4 xR").concat(r,"C").concat(t," = vec4(0.);");for(let b=0;b<p;b++)for(let t=0;t<m;t++){const e=2*t;if(g+="\n          xR = xRCorner + ".concat(b*h,";\n          xC = xCCorner + ").concat(e*d,";\n        "),1===u){if(e<f&&(g+=c%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(s," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(s," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(b,"C").concat(e," = vec4(previous.zw, xTexelR").concat(b,"C").concat(e,".xy);\n                } else {\n                  xR").concat(b,"C").concat(e," = vec4(0, 0, xTexelR").concat(b,"C").concat(e,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(s," && xC >= 0 && xC < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = xTexelR").concat(b,"C").concat(e,";\n              "),e+1<f)){const t=c%2==0?r.Lb.nearestLargerEven(d):d;d%2==0&&c%2==1||d%2!=0&&c%2!=1?(g+="\n                  xCOffset = xC + ".concat(c%2," + ").concat(t,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),d>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(s," &&\n                      xCOffset >= 0 && xCOffset < ").concat(o,") {\n                      xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                    }\n                  ")),g+="\n                  xR".concat(b,"C").concat(e+1," = vec4(\n                    xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".xy);\n                ")):g+="\n                  xCOffset = xC + ".concat(t,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(b,"C").concat(e+1," = xTexelR").concat(b,"C").concat(e+2,";\n                ")}}else e<f&&(g+="\n              if(xR >= 0 && xR < ".concat(s,") {\n            "),c%2==1?(g+="\n                xCOffset = xC + 1 - ".concat(u,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e+2," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = vec4(\n                  xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".zw);\n              "),e+1<f&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(u,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(b,"C").concat(e+1," = vec4(xTexelR").concat(b,"C").concat(e+2,".xy, final.xy);\n                "))):(g+="\n                if(xC >= 0 && xC < ".concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(u,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e+2," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = vec4(\n                  xTexelR").concat(b,"C").concat(e,".xy, xTexelR").concat(b,"C").concat(e+2,".xy);\n              "),e+1<f&&(g+="\n                  xR".concat(b,"C").concat(e+1," = vec4(\n                    xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".zw);\n                "))),g+="}");e<f&&(g+="\n            vec4 wTexelR".concat(b,"C").concat(e," = getW(").concat(b,", ").concat(e,", d1, q);\n            wR").concat(b,"C").concat(e," = vec4(wTexelR").concat(b,"C").concat(e,".xz, wTexelR").concat(b,"C").concat(e,".xz);\n          "),e+1<f&&(g+="\n              vec4 wTexelR".concat(b,"C").concat(e+1," = getW(").concat(b,", ").concat(e+1,", d1, q);\n              wR").concat(b,"C").concat(e+1," =\n                vec4(wTexelR").concat(b,"C").concat(e+1,".xz, wTexelR").concat(b,"C").concat(e+1,".xz);")))}for(let r=0;r<p;r++)for(let t=0;t<f;t++)g+="dotProd += xR".concat(r,"C").concat(t," * wR").concat(r,"C").concat(t,";");let v="",y="";n&&(v=i?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),y="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(c,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(g,"\n\n        vec4 result = dotProd;\n        ").concat(x,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")}}class me{constructor(t,e,n,i,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,a,c]=t,[l]=e,[u,h]=n;this.outputShape=[l,u,h,c];const d="bilinear"===i?1:0,[p,f]=[o-1+".0",a-1+".0"],[m,g,v]=u>1?[""+(o-1)/(u-1),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * "+p],[y,x,b]=h>1?[""+(a-1)/(h-1),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * "+f];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(y,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(x,";\n\n        float in_y = ").concat(v,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n        float in_x = ").concat(b,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}class ge{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const i=t.length,r=e?"0.0":"getX(".concat(ve(i,"coords"),")"),s=t[t.length-1];let o="",a="";e?(o=n?"end != "+(s-1):"end != 0",a=n?"end + 1":"end - 1"):(o=n?"end + pow2 < "+s:"end >= pow2",a=n?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(Ht(i)," coords = getOutputCoords();\n        int end = ").concat(ye(i,"coords"),";\n        float val = ").concat(r,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(o,") {\n          int idx = ").concat(a,";\n          ").concat(ye(i,"coords")," = idx;\n          val += getX(").concat(ve(i,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}getCustomSetupFunc(t){return(e,n)=>{null==this.index&&(this.index=e.getUniformLocation(n,"index")),e.gl.uniform1f(this.index,t)}}}function ve(t,e){if(1===t)return""+e;if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}function ye(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}class xe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=c.DENSE;const e=d(t),n=Nt();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Mt(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(e[0],", ").concat(e[1],"));\n        int index = 4 * (resTexRC.x * ").concat(e[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")}}class be{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=c.DENSE;const e=d(t),n=Nt();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Mt(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(e[0],", ").concat(e[1],"));\n        int index = 4 * (resTexRC.x * ").concat(e[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")}}class we{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}class Se{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}class _e{constructor(t){this.variableNames=["A"],this.outTexUsage=l.DOWNLOAD;const e=Nt();this.outputShape=t,this.userCode="\n      ".concat(Pt,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class Te{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=l.DOWNLOAD;const e=Nt();this.outputShape=t,this.userCode="\n      ".concat(Pt,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class Ee{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.variableNames=["A"];const i=Nt(),[r,s]=e;this.outputShape=t;let o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(Dt(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(r,".0);\n        vec4 values = ").concat(i.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(i.output," = vec4(").concat(o,", 0., 0., 0.);\n      }\n    ")}}class Ce{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const i=Nt(),[r,s]=e;this.outputShape=t;let o="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let c=0;c<=1;c++)for(let e=0;e<=1;e++){const n=2*c+e;o+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(t[2],") {\n            localCoords[2] += ").concat(e,";\n            if(localCoords[1] + ").concat(c," < ").concat(t[1],") {\n              localCoords[1] += ").concat(c,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(r,".0);\n              values = ").concat(i.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(n,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(n,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(n,"] = values[2];\n              } else {\n                result[").concat(n,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(Dt(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(o,"\n\n        ").concat(i.output," = ").concat(a,";\n      }\n    ")}}class ke{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}class Ae{constructor(t,e,n){this.variableNames=["A","indices"];const i=t.slice();i[n]=e,this.outputShape=i,this.rank=i.length;const r=Ht(this.rank),s=function(t,e){const n=t.length;if(n>4)throw Error("Gather for rank ".concat(n," is not yet supported"));if(1===n)return"int(getIndices(resRC))";const i=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===e?r.push("int(getIndices(".concat(i[s],"))")):r.push(""+i[s]);return r.join()}(t,n);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(s,"));\n      }\n    ")}}class Ie{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const i=Ht(e.length),r=Ht(n.length),s=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(i," strides = ").concat(i,"(").concat(this.strides,");\n         void main() {\n          ").concat(r," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(s,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")}}function Oe(t,e,n,i,s,o){!function(t,e){const n=Object(r.jb)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0)throw new Error("Requested texture size "+"[".concat(t,"x").concat(e,"]")+" is invalid.");if(t>n||e>n)throw new Error("Requested texture size "+"[".concat(t,"x").concat(e,"]")+" greater than WebGL maximum on this browser / GPU "+"[".concat(n,"x").concat(n,"]")+".")}(e,n);const a=function(t){return C(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}(t),c=t.TEXTURE_2D;return m(t,(()=>t.bindTexture(c,a))),m(t,(()=>t.texParameteri(c,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),m(t,(()=>t.texParameteri(c,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),m(t,(()=>t.texParameteri(c,t.TEXTURE_MIN_FILTER,t.NEAREST))),m(t,(()=>t.texParameteri(c,t.TEXTURE_MAG_FILTER,t.NEAREST))),m(t,(()=>t.texImage2D(c,0,i,e,n,0,s,o,null))),m(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),a}function Re(t){return t.internalFormatFloat}function Ne(t){return t.internalFormatHalfFloat}function Me(t){return t.downloadTextureFormat}function De(t){return t.internalFormatPackedFloat}function Pe(t){return t.internalFormatPackedHalfFloat}class Fe{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Object(r.jb)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){s[t]=e}(e,t)):this.gl=a(e);let n="WEBGL_color_buffer_float";if(1===Object(r.jb)().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=v(this.gl,t),D(this.gl,e))this.textureHalfFloatExtension=v(this.gl,e);else if(Object(r.jb)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),D(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=v(this.gl,"EXT_color_buffer_half_float");else if(Object(r.jb)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",D(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!D(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=function(t){return function(t,e){const n=C(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return m(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),m(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function(t){return function(t,e){const n=C(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return m(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),m(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function(t){return C(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=f(this.gl,this.textureHalfFloatExtension)}get debug(){return Object(r.jb)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;m(t,(()=>t.finish())),m(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),m(t,(()=>t.deleteFramebuffer(this.framebuffer))),m(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),m(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),m(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=h(e,n);return Oe(t,r,s,Re(i),i.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=h(e,n);return Oe(t,r,s,Ne(i),i.textureFormatFloat,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=h(e,n);return Oe(t,r,s,Me(i),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){m(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?m(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):m(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),m(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,i){this.throwIfDisposed(),function(t,e,n,i,r,s){let o,a,c;m(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),r instanceof Uint8Array?(o=new Uint8Array(n*i*4),a=t.UNSIGNED_BYTE,c=t.RGBA):(o=new Float32Array(n*i*4),a=t.FLOAT,c=s.internalFormatPackedFloat),o.set(r),m(t,(()=>t.texImage2D(t.TEXTURE_2D,0,c,n,i,0,t.RGBA,a,o))),m(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e,n,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=p(e,n);return Oe(t,r,s,Pe(i),t.RGBA,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=p(e,n);return Oe(t,r,s,De(i),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(T(this.gl,this.framebuffer),this.outputTexture=null),m(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n,i){const[r,s]=h(e,n),o=new Uint8Array(e*n*4);return m(t,(()=>t.readPixels(0,0,r,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,o))),new Float32Array(o.buffer)}(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,i,r,s){return function(t,e,n,i,r,s,o,a){const c=t,l=new Float32Array(function(t,e){const[n,i]=p(t,e);return n*i*4}(s,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}(this.gl,t,0,0,0,r,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const i=t,r=new Float32Array(n);return i.bindBuffer(i.PIXEL_PACK_BUFFER,e),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,r),i.bindBuffer(i.PIXEL_PACK_BUFFER,null),r}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const i=function(t,e,n,i){const r=t.createBuffer();m(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r)));const s=16*e*n;return m(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ))),m(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),m(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),r}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Object(r.jb)().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,r=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=i.clientWaitSync(r,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=r}else Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n){const i=new Float32Array(e*n*4);return m(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,i))),i}(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=y(e,t),i=function(t){const e=Nt();return function(t,e){const n=C(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(m(t,(()=>t.shaderSource(n,e))),m(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}(e),r=function(t){return C(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}(e);return m(e,(()=>e.attachShader(r,i))),m(e,(()=>e.attachShader(r,n))),function(t,e){if(m(t,(()=>t.linkProgram(e))),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,r),this.debug&&b(e,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=function(t,e,n){return m(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),w(t,e,"clipSpacePos",n,3,20,0)&&w(t,e,"uv",n,2,20,12)}(e,this.program,this.vertexBuffer)),r}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&m(this.gl,(()=>this.gl.deleteProgram(t)))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&b(this.gl,this.program),m(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n){return C(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),m(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),S(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[i,r]=p(e,n);this.setOutputMatrixTextureDriver(t,i,r)}setOutputMatrixWriteRegion(t,e,n,i){this.setOutputMatrixWriteRegionDriver(n,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,n,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&b(this.gl,this.program),E(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),m(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),m(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=v(this.gl,2===Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await r.Lb.repeatedTry((()=>this.disposed||this.isQueryAvailable(t,Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),i=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),i&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=function(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||r.Lb.repeatedTry((()=>(this.pollItems(),0===this.itemsToPoll.length)))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),_(this.gl,t,this.framebuffer),this.debug&&E(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(_(this.gl,this.outputTexture,this.framebuffer),this.debug&&E(this.gl)):T(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const i=this.gl;_(i,t,this.framebuffer),this.debug&&E(i),this.outputTexture=t,m(i,(()=>i.viewport(0,0,e,n))),m(i,(()=>i.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,i){this.throwIfDisposed(),m(this.gl,(()=>this.gl.scissor(t,e,n,i)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function Le(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but was executed with ").concat(e.length," inputs"));t.forEach(((t,n)=>{const i=t.logicalShape,s=e[n],o=s.shape;if(!r.Lb.arraysEqual(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes ".concat(i," and ").concat(o," must match"));if(t.isUniform&&s.isUniform)return;const a=t.texShape,c=s.isUniform?null:s.texData.texShape;if(!r.Lb.arraysEqual(a,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape ".concat(a," and ").concat(c," must match"))}))}class Be{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:i,inChannels:r,strideWidth:s,strideHeight:o,padInfo:a,outWidth:c,dilationWidth:l,dilationHeight:u,dataFormat:h}=n,{left:d,top:p}=a,f=r*i,m=Nt(),g="channelsLast"===h,v=g?0:1,y=g?1:2;let x="";for(let b=0;b<=1;b++)for(let n=0;n<=1;n++)x+="\n          blockIndex = rc.y + ".concat(n,";\n          pos = rc.x + ").concat(b,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(o," - ").concat(p,";\n            d0 = offsetY + ").concat(u," * (pos / ").concat(f,");\n\n            if(d0 < ").concat(e[v]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(s,". - ").concat(d,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(f,".) / ").concat(r,".));\n\n              if(d1 < ").concat(e[y]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(r,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*b+n,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*b+n,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(x,"\n\n        ").concat(m.output," = result;\n      }\n    ")}}class ze{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[];const s=e,o=t[3]-1;let a;this.outputShape=t;const c="float(".concat(n,") + float(").concat(i,") * sum");a=.5===r?"inversesqrt(".concat(c,")"):1===r?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(a,";\n        setOutput(val);\n      }\n    ")}}class Ue{constructor(t,e,n,i,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=i,this.beta=r,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(i,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(i,")\n                * float(").concat(r,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(r,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}class je{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=e,o=t[3]-1;let a;this.outputShape=t;const c="float(".concat(n,") + float(").concat(i,") * sum");a=.5===r?"inversesqrt(".concat(c,")"):1===r?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(a,";\n        setOutput(result);\n      }\n    ")}}class Ve{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,i=t.dilationHeight,r=t.effectiveFilterHeight,s=t.effectiveFilterWidth,o=r-1-t.padInfo.top,a=s-1-t.padInfo.left,c=r*s-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(r,";\n          wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(s," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class We{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,i=t.strideWidth,r=t.dilationDepth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,u=a-1-t.padInfo.front,h=c-1-t.padInfo.top,d=l-1-t.padInfo.left,p=a*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(a,";\n           wD += ").concat(r,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(s,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Ge{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;const c=i?t[1]:t[2],l=Math.ceil(c/2),u=i?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",d=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let f="",m="";o&&(f=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),m="result = activation(result);");const g=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights");let v="rc.x",y="rc.x";t[0]<e[0]?v="int(min(float(rc.x), ".concat(t[0]-1,".))"):e[0]<t[0]&&(y="int(min(float(rc.x), ".concat(e[0]-1,".))")),this.userCode="\n      ".concat(f,"\n\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(l,"; i++) {\n          int batchA = ").concat(v,";\n          int batchB = ").concat(y,";\n          vec4 a = getMatrixA(batchA, ").concat(u,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(d[0]," * ").concat(p[0],");\n          result += (").concat(d[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(g,"\n\n        ").concat(m,"\n\n        setOutput(result);\n      }\n    ")}}class qe{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}class He{constructor(t,e,n,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(i,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}class Xe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=Rt("rc",e),i=Ht(e),r=function(t,e,n){if(1===t)return"rc > "+e[0];let i="";for(let r=t-2;r<t;r++)i+="".concat(n[r]," >= ").concat(e[r]),r<t-1&&(i+="||");return i}(e,t,n),s=function(t,e,n,i){if(1===t)return"";const r=i.slice(-2);return"\n    int r = ".concat(r[0],";\n    int c = ").concat(r[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(e,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){const n=t.length,i=function(t,e){const n=[];for(let i=0;i<=1;i++)for(let r=0;r<=1;r++){let s="".concat(0===i?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let n=2;n<t;n++)s=e[e.length-1-n]+","+s;n.push(s)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= ".concat(t[0]," ? 0. : getA(rc + 1),\n            0, 0"):"getA(".concat(i[0],"),\n          cEdge ? 0. : getA(").concat(i[1],"),\n          rEdge ? 0. : getA(").concat(i[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(i[3],")")}(t,n);this.userCode="\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n\n          if(").concat(r,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(s,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}}class Ye{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=Ht(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(n,"));\n        } else {\n          ").concat(r," coords = outC - start;\n          setOutput(getX(").concat(a,"));\n        }\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(n,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class Ke{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=Ht(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=Rt("rc",i),c=Rt("source",i),l="".concat(a[i-1]," < ").concat(this.outputShape[i-1]),u=1===i?"source":"vec2(".concat(c.slice(-2).join(),")"),h=[r+" rc = outputLoc;","".concat(a[i-1]," += 1;\n       if(").concat(l,") {\n      "),1===i?"":"}\n       rc = outputLoc;\n       ".concat(a[i-2]," += 1;\n       if(").concat(a[i-2]," < ").concat(this.outputShape[i-2],") {"),1===i?"":"  ".concat(a[i-1]," += 1;\n         if(").concat(l,") {")],d=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===i?2:4;f<m;f++)p+="\n        ".concat(h[f],"\n        if (").concat(d,") {\n          result[").concat(f,"] = float(").concat(n,");\n        } else {\n          ").concat(r," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ");p+=1===i?"} ":"}}",this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}class Qe{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideHeight,a=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let v="0.0";if(f||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(a,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(i?r?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(e,"(").concat(e,"(").concat(e,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===e&&(y="avgValue / count");const x=4*Math.floor(s/4),b=s%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class Ze{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideDepth,a=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let x="0.0";if(y||(x="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(a,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(i?r?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let b="".concat(e,"(").concat(e,"(").concat(e,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===e&&(b="avgValue / count");const w=4*Math.floor(s/4),S=s%4,_="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(a,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n          setOutput(").concat(b,");\n        }\n      }\n    ")}}class Je{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:i,inSize:r,outSize:s}=t;this.outputShape=[i,s];let o="0.0",a="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",a="min"):"max"===e&&(o="-1.0 / 1e-20",a="max");let c="".concat(e,"(").concat(e,"(").concat(e,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const l=4*Math.floor(n/4),u=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(a,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";r%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}class $e{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2==1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}var i;this.userCode="\n      ".concat((i=e,"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(Mt(["r","c","d"],i),"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(Dt(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class tn{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,r]=e.shape,[,s,o]=t.shape,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],c=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/c[0],u=a[1]/c[1],h=1/l,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(r-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}class en{constructor(t,e,n,i){this.variableNames=["A"],this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const c=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class nn{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const c=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],",\n          ").concat(c[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(a-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}class rn{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,r]=e.shape,[,s,o]=t.shape,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],c=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/c[0],u=a[1]/c[1],h=1/l,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(a[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(a[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}class sn{constructor(t,e,n,i){this.variableNames=["A"],this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const c=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n],u=i?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(u,")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class on{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const i=t.map(((n,i)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(i))).join(","),r=Ht(n);this.userCode="\n      void main() {\n        ".concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}class an{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const i=Rt("rc",n),r="".concat(i[n-1]," + 1 < ").concat(this.outputShape[n-1]),s="".concat(i[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=Ht(n);function a(n){const i=t.map(((i,r)=>function(n,i){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(i[n]," - 1"):""+i[n]}(r,n)));return"getChannel(getX(".concat(i.join(","),"), vec2(").concat(i.slice(-2).join(","),"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(r,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return a(t)}(i.slice()),";\n          if(").concat(r,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(i.slice()),";\n          }\n          if(").concat(s,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice()),";\n            if(").concat(r,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}class cn{constructor(t,e,n,i,r,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const o=Ht(r.length),a=Ht(s.length);let c="";1===n?c="i":2===n&&(c="i, j");const l="getIndices(".concat(c,")");let u="";1===i?u="i":2===i&&(u="i, coords[1]");const h="getUpdates(".concat(u,")"),d=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(a," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}}class ln{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,i=t.batchSize,r=t.inSize,s=t.numSegments,o=s*Math.ceil(r/n);this.outputShape=[i,o];const a=4*Math.floor(n/4),c=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let u="";r%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      "));let h="";r%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ".concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(s,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(s,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(a,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class un{constructor(t,e,n){let i,r;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)r="resRC",i="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let i=0;i<e.length;i++)o.push(""+n[i]),i<t&&s.push(""+n[i]);i=s.join(),r=o.join()}const s=Ht(n);this.userCode="\n      void main() {\n        ".concat(s," resRC = getOutputCoords();\n        float cVal = getC(").concat(i,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(r,"));\n        } else {\n          setOutput(getB(").concat(r,"));\n        }\n      }\n    ")}}class hn{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=Ht(this.rank),n="uniform int start[".concat(this.rank,"];"),i=function(t){if(1===t)return"sourceLoc";if(t<=6)return dn.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let r;r="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(t.map(((t,e)=>"sourceLoc.".concat(dn[e]," = start[").concat(e,"] + coords.").concat(dn[e],";"))).join("\n"),"\n      "),this.userCode="\n      ".concat(n,"\n      void main() {\n        ").concat(r,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the length of start (").concat(t.length,")"));return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const dn=["x","y","z","w","u","v"];class pn{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=Ht(this.rank),n=Rt("coords",this.rank),i=Rt("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":"vec2(".concat(i.slice(-2).join(),")"),s="getChannel(getSource(".concat(i.join(),"), ").concat(r,")"),o="\n      result.x = ".concat(s,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(i[this.rank-1],";\n        result.y = ").concat(s,";\n        --").concat(i[this.rank-1],";\n      }\n    "),a=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(i[this.rank-2],";\n        result.z = ").concat(s,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(i[this.rank-1],";\n          result.w = ").concat(s,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map(((t,e)=>"start[".concat(e,"]"))).join(),");"):t.map(((t,e)=>"".concat(i[e]," = ").concat(n[e]," + start[").concat(e,"];"))).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(a,"\n        setOutput(result);\n      }\n    ")}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the length of start (").concat(t.length,")"));return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}class fn{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const i=n.length,r=Ht(n.length),s=Ht(n.length);let o="";if(1===i)o="coords * strides + begin";else{let t=0;o=n.map(((e,i)=>(t++,1===n.length?"coords * strides[".concat(i,"] + begin[").concat(i,"]"):"coords[".concat(t-1,"] * strides[").concat(i,"] + begin[").concat(i,"]")))).join(",")}this.userCode="\n      ".concat(r," begin = ").concat(r,"(").concat(t,");\n      ").concat(r," strides = ").concat(r,"(").concat(e,");\n\n      void main() {\n        ").concat(s," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}class mn{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const i=vn(e,n),r=yn(t,i,n);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const s=gn(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const t=this.freeTextures[r].shift();return this.usedTextures[r].push(t),t}let o;return i===u.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===u.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===u.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===u.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===u.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[r].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}releaseTexture(t,e,n,i){if(null==this.freeTextures)return;const s=vn(n,i),o=yn(e,s,i);o in this.freeTextures||(this.freeTextures[o]=[]);const a=gn(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),c=Object(r.jb)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],u=l.indexOf(t);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function gn(t,e,n,i,r){const s=function(t,e){switch(t){case u.PACKED_2X2_FLOAT32:return De(e);case u.PACKED_2X2_FLOAT16:return Pe(e);case u.UNPACKED_FLOAT32:return Re(e);case u.UNPACKED_FLOAT16:return Ne(e);case u.PACKED_4X1_UNSIGNED_BYTE:return Me(e);default:throw new Error("Unknown physical texture type "+t)}}(e,i);let o;if(r){const[e,n]=p(t[0],t[1]);o=e*n}else{const[e,n]=h(t[0],t[1]);o=e*n}return o*function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;throw new Error("Unknown internal format "+e)}(n,s)}function vn(t,e){if(t===l.UPLOAD)return u.PACKED_2X2_FLOAT32;if(t===l.RENDER||null==t)return function(t){return Object(r.jb)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?u.PACKED_2X2_FLOAT32:u.UNPACKED_FLOAT32:t?u.PACKED_2X2_FLOAT16:u.UNPACKED_FLOAT16}(e);if(t===l.DOWNLOAD||t===l.PIXELS)return u.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function yn(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}class xn{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[s]*e[s];this.outputShape=n,this.rank=n.length;const i=Ht(this.rank),r=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],i=[];for(let r=0;r<t.length;r++)i.push("imod(".concat(n[r],", ").concat(t[r],")"));return i.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(r,"));\n      }\n    ")}}class bn{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const wn="return abs(x);",Sn="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",_n="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Tn="return (x >= 0.0) ? x : (exp(x) - 1.0);",En="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(r.X.SELU_SCALEALPHA,";\n  float scale = ").concat(r.X.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),Cn="return -x;",kn="return ceil(x);",An="return floor(x);",In="return exp(x);",On="return exp(x) - 1.0;",Rn='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(r.X.ERF_P,";\n  float a1 = ").concat(r.X.ERF_A1,";\n  float a2 = ").concat(r.X.ERF_A2,";\n  float a3 = ").concat(r.X.ERF_A3,";\n  float a4 = ").concat(r.X.ERF_A4,";\n  float a5 = ").concat(r.X.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),Nn="return x;",Mn="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Dn="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Pn="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n";class Fn{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class Ln{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=Rt("rc",e),i=Ht(e),r=function(t,e){if(1===t)return"rc";let n="";for(let i=0;i<t;i++)n+=e[i],i<t-1&&(n+=",");return n}(e,n),s=n.slice(-2),o=e<=1?"rc":"vec2(".concat(s.join(","),")");this.userCode="\n      void main() {\n        ".concat(i," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(r,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const{segment_util:Bn}=r.X,zn=r.lb.split,Un=r.lb.tile,jn=r.lb.topkImpl,Vn=r.lb.whereImpl,Wn={};function Gn(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return"return x;";if("relu"===t)return e?Mn:Sn;if("elu"===t)return e?Pn:Tn;if("relu6"===t)return e?Dn:_n;if("prelu"===t)return e?te:Jt;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}class qn extends r.w{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!Object(r.jb)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=a(Object(r.jb)().getNumber("WEBGL_VERSION"));this.binaryCache=((e=Object(r.jb)().getNumber("WEBGL_VERSION"))in Wn||(Wn[e]={}),Wn[e]),this.gpgpu=new Fe(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new mn(this.gpgpu),this.numMBBeforeWarning=null==Object(r.jb)().global.screen?1024:Object(r.jb)().global.screen.height*Object(r.jb)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new r.k(this,Object(r.ib)())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if((Object(r.jb)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(r.jb)().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={};return this.texData.set(i,{shape:e,dtype:n,values:t,usage:l.UPLOAD,refCount:1,complexParentRefCount:0}),i}incRef(t){this.texData.get(t).refCount++}decRef(t){this.texData.has(t)&&this.texData.get(t).refCount--}move(t,e,n,i){if(Object(r.jb)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:i,values:e,usage:l.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}readSync(t){const e=this.texData.get(t),{values:n,dtype:i,complexTensorInfos:s,slice:o,shape:a,isPacked:c}=e;if(null!=o){let e;e=c?new Fn(a,Nn):new bn(a,Nn);const n=this.runWebGLProgram(e,[{dataId:t,shape:a,dtype:i}],i),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;const l=null!=this.activeTimers;let u,h;if(l&&(u=r.Lb.now()),"complex64"===i){const t=this.readSync(s.real.dataId),e=this.readSync(s.imag.dataId);h=r.X.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=r.Lb.now()-u),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:i,slice:s,dtype:o,complexTensorInfos:a,isPacked:c}=e;if(null!=s){let e;e=c?new Fn(i,Nn):new bn(i,Nn);const n=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:o}],o),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if(!Object(r.jb)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Object(r.jb)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,h=null;if("complex64"!==o&&Object(r.jb)().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(t);const e=this.texData.get(l.dataId);h=this.gpgpu.createBufferFromTexture(e.texture,...d(i))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),e=t[0],n=t[1];u=r.X.mergeRealAndImagArrays(e,n)}else if(null==h)u=this.getValuesFromTexture(t);else{const t=r.Lb.sizeFromShape(i);u=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}null!=l&&this.disposeIntermediateTensorInfo(l);const p=this.convertAndCacheOnCPU(t,u),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach((t=>t(p))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),p}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!g(n)){if(Object(r.jb)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"));throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:i}=this.texData.get(t),s=r.Lb.sizeFromShape(e);if(Object(r.jb)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),i=this.texData.get(n.dataId),r=this.gpgpu.downloadMatrixFromPackedTexture(i.texture,...d(e)).subarray(0,s);return this.disposeIntermediateTensorInfo(n),r}const o=Object(r.jb)().getBool("WEBGL_PACK")&&!0===i,a=o?I(e):e,c=o?new Te(a):new _e(a),l=this.runWebGLProgram(c,[{shape:a,dtype:n,dataId:t}],"float32"),u=this.texData.get(l.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture,u.texShape[0],u.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),h}async time(t){const e=this.activeTimers,n=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();const s=r.Lb.flatten(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),o=r.Lb.flatten(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(s);a.kernelMs=r.Lb.sum(t),a.getExtraProfileInfo=()=>t.map(((t,e)=>({name:o[e],ms:t}))).map((t=>"".concat(t.name,": ").concat(t.ms))).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.Lb.now(),endMs:null}}endTimer(t){return Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.Lb.now(),t)}async getQueryTime(t){if(Object(r.jb)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0)return void this.texData.get(t).refCount--;this.releaseGPUData(t);const{complexTensorInfos:e}=this.texData.get(t);null!=e&&(this.texData.get(e.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.real),this.texData.get(e.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:i,usage:r,isPacked:s,slice:o}=this.texData.get(t),a=o&&o.origDataId||t,c=this.dataRefCount.get(a);c>1?this.dataRefCount.set(a,c-1):(this.dataRefCount.delete(a),null!=e&&(this.numBytesInGPU-=this.computeBytes(i,n),this.textureManager.releaseTexture(e,i,r,s)));const l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Object(r.jb)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(r.ib)().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;const n=this.getCPUBackend();return this.warnedAboutCPUBackend||null!=n||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=n&&t.every((t=>null==this.texData.get(t.dataId).texture&&r.Lb.sizeFromShape(t.shape)<e))}getGPGPUContext(){return this.gpgpu}slice(t,e,n){if(this.shouldExecuteOnCPU([t])){const i=_t(this.texData.get(t.dataId).values,e,n,t.shape,t.dtype);return this.makeOutput(n,t.dtype,i)}if(0===r.Lb.sizeFromShape(n))return Object(r.Gb)([],n,t.dtype);const{isPacked:i}=this.texData.get(t.dataId),s=r.Ab.isSliceContinous(t.shape,e,n);if(i||!s){const i=Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pn(n):new hn(n),s=i.getCustomSetupFunc(e);return this.compileAndRun(i,[t],null,s)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)}shallowSlice(t,e,n){const i=this.texData.get(t.dataId),s=this.makeOutput(n,t.dtype),o=this.texData.get(s.dataId);Object.assign(o,i),o.shape=n,o.dtype=t.dtype;let a=r.Ab.computeFlatOffset(e,t.strides);i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||t.dataId};const c=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,c+1),s}stridedSlice(t,e,n,i){const s=this.tryRunOnCpuOrThrow([t],(()=>this.cpuBackend.stridedSlice(t,e,n,i)));if(s)return s;const o=r.Ab.computeOutShape(e,n,i);if(o.some((t=>0===t)))return Object(r.Gb)([],o);const a=new fn(e,i,o);return this.compileAndRun(a,[t])}reverse(t,e){const n=Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new an(t.shape,e):new on(t.shape,e);return this.compileAndRun(n,[t])}neg(t){const e=this.tryRunOnCpuOrThrow([t],(()=>this.cpuBackend.neg(t)));if(e)return e;if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Cn,t.dtype);const n=new bn(t.shape,Cn);return this.compileAndRun(n,[t])}batchMatMul(t,e,n,i){const s=n?t.shape[2]:t.shape[1],o=i?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],c=Math.max(t.shape[0],e.shape[0]);if((1===s||1===o)&&a>1e3){n&&(t=Object(r.Jb)(t,[0,2,1])),i&&(e=Object(r.Jb)(e,[0,2,1]));const s=1===o?t:t.as3D(c,a,1),l=1===o?2:1,u=1===o?e.as3D(c,1,a):e;return r.pb(s,u).sum(l,!0)}const l=Object(r.Kb)(t.dtype,e.dtype),u=new Ge(t.shape,e.shape,[c,s,o],n,i);return this.compileAndRun(u,[t,e],l)}fusedBatchMatMul(t){let{a:e,b:n,transposeA:i,transposeB:s,bias:o,activation:a,preluActivationWeights:c}=t;const l=i?e.shape[2]:e.shape[1],u=s?n.shape[1]:n.shape[2],h=Math.max(e.shape[0],n.shape[0]),d=Object(r.Kb)(e.dtype,n.dtype),p=null!=o,f=null!=c,m=a?Gn(a,!0):null,g=new Ge(e.shape,n.shape,[h,l,u],i,s,p,m,f),v=[e,n];return o&&v.push(o),c&&v.push(c),this.compileAndRun(g,v,d)}localResponseNormalization4D(t,e,n,i,s){const o=Object(r.jb)().getBool("WEBGL_PACK_NORMALIZATION")?new je(t.shape,e,n,i,s):new ze(t.shape,e,n,i,s);return this.compileAndRun(o,[t])}LRNGrad(t,e,n,i,r,s,o){const a=new Ue(e.shape,i,r,s,o);return this.compileAndRun(a,[e,n,t])}tile(t,e){if("string"===t.dtype){const n=this.readSync(t.dataId).map((t=>r.Lb.decodeString(t))),i=Object(r.Z)(t.shape,t.dtype,n);return Un(i,e)}const n=new xn(t.shape,e);return this.compileAndRun(n,[t])}pad(t,e,n){const i=Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ke(t.shape,e,n):new Ye(t.shape,e,n);return this.compileAndRun(i,[t])}gather(t,e,n){const i=this.tryRunOnCpuOrThrow([t,e],(()=>this.cpuBackend.gather(t,e,n)));if(i)return i;const r=new Ae(t.shape,e.size,n);return this.compileAndRun(r,[t,e])}batchToSpaceND(t,e,n){r.Lb.assert(t.rank<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const i=e.reduce(((t,e)=>t*e)),s=r.X.getReshaped(t.shape,e,i),o=r.X.getPermuted(s.length,e.length),a=r.X.getReshapedPermuted(t.shape,e,i),c=r.X.getSliceBeginCoords(n,e.length),l=r.X.getSliceSize(a,n,e.length);return Object(r.Jb)(t.reshape(s),o).reshape(a).slice(c,l)}spaceToBatchND(t,e,n){r.Lb.assert(t.rank<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const i=e.reduce(((t,e)=>t*e)),s=[[0,0]];s.push(...n);for(let r=1+e.length;r<t.shape.length;++r)s.push([0,0]);const o=t.pad(s),a=r.X.getReshaped(o.shape,e,i,!1),c=r.X.getPermuted(a.length,e.length,!1),l=r.X.getReshapedPermuted(o.shape,e,i,!1),u=Object(r.Jb)(o.reshape(a),c);return Object(r.xb)(u,l)}reduce(t,e,n){const i=t.shape[0],s=t.shape[1],o=r.X.computeOptimalWindowSize(s),a=Math.ceil(s/o),c=new Je({windowSize:o,inSize:s,batchSize:i,outSize:a},e),l=this.compileAndRun(c,[t],n);return 1===l.shape[1]?l:this.reduce(l,e,n)}argReduce(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.shape[0],s=t.shape[1];null!=n&&(i=n.shape[0],s=n.shape[1]);const o=r.X.computeOptimalWindowSize(s),a={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},c=new It(a,e,null==n),l=[t];null!=n&&l.push(n);const u=this.compileAndRun(c,l,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)}argReducePacked(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=null!=n?n.shape:t.shape,s=i[i.length-1],o=r.X.computeOptimalWindowSize(s),a=new Kt(i,o,e,null==n),c=null==n?[t]:[t,n],l=this.compileAndRun(a,c,"int32");return l.rank===t.rank?this.argReducePacked(t,e,l):l}sum(t,e){r.X.assertAxesAreInnerMostDims("sum",e,t.rank);const[n,i]=r.X.computeOutAndReduceShapes(t.shape,e),s=r.Lb.sizeFromShape(i),o=t.as2D(-1,s),a=r.Fb(t.dtype);return this.reduce(o,"sum",a).reshape(n)}prod(t,e){const n=this.tryRunOnCpuOrThrow([t],(()=>this.cpuBackend.prod(t,e)));if(n)return n;const[i,s]=r.X.computeOutAndReduceShapes(t.shape,e),o=r.Lb.sizeFromShape(s),a=t.as2D(-1,o),c=r.Fb(t.dtype);return this.reduce(a,"prod",c).reshape(i)}unsortedSegmentSum(t,e,n){let i=0;const s=r.X.getAxesPermutation([i],t.rank);let o=t;null!=s&&(o=Object(r.Jb)(t,s),i=r.X.getInnerMostAxes(1,t.rank)[0]);const a=Bn.computeOutShape(o.shape,i,n),c=r.Lb.sizeFromShape([o.shape[i]]),l=o.as2D(-1,c),u=r.Fb(t.dtype);let h=this.segOpCompute(l,"unsortedSegmentSum",e,u,n).reshape(a);return null!=s&&(h=Object(r.Jb)(h,r.X.getUndoAxesPermutation(s))),h}segOpCompute(t,e,n,i,s){const o=t.shape[0],a=t.shape[1],c=Bn.segOpComputeOptimalWindowSize(a,s),l=new ln({windowSize:c,inSize:a,batchSize:o,numSegments:s},e),u=this.compileAndRun(l,[t,n],i);return u.shape[1]===s?u:(n=Object(r.ub)(0,s).tile([a/c]),this.segOpCompute(u,e,n,i,s))}argMinMaxReduce(t,e,n){const i=[e];if(r.X.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),i,t.rank),!Object(r.jb)().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){const[e,s]=r.X.computeOutAndReduceShapes(t.shape,i),o=r.Lb.sizeFromShape(s),a=t.as2D(-1,o);return this.argReduce(a,n).reshape(e)}return this.argReducePacked(t,n)}argMin(t,e){return this.argMinMaxReduce(t,e,"min")}argMax(t,e){return this.argMinMaxReduce(t,e,"max")}cumsum(t,e,n,i){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(t.rank-1," but got axis=")+e);const r=t.shape[e];let s=t;for(let o=0;o<=Math.ceil(Math.log2(r))-1;o++){const e=new ge(t.shape,!1,i),n=e.getCustomSetupFunc(o),r=s;s=this.compileAndRun(e,[s],s.dtype,n),r.dispose()}if(n){const e=new ge(t.shape,n,i),r=s;s=this.compileAndRun(e,[s]),r.dispose()}return s}equal(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");const n=new $t("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}less(t,e){const n=this.tryRunOnCpuOrThrow([t,e],(()=>this.cpuBackend.less(t,e)));if(n)return n;if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");const i=new $t("return float(a < b);",t.shape,e.shape);return this.compileAndRun(i,[t,e],"bool")}lessEqual(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");const n=new $t("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}greater(t,e){const n=this.tryRunOnCpuOrThrow([t,e],(()=>this.cpuBackend.greater(t,e)));if(n)return n;if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");const i=new $t("return float(a > b);",t.shape,e.shape);return this.compileAndRun(i,[t,e],"bool")}greaterEqual(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");const n=new $t("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalNot(t){const e=new bn(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])}logicalAnd(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");const n=new $t("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalOr(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");const n=new $t("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}select(t,e,n){const i=new un(t.rank,e.shape,e.rank);return this.compileAndRun(i,[t,e,n],Object(r.Kb)(e.dtype,n.dtype))}where(t){r.X.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return Vn(t.shape,e)}topk(t,e,n){const i=t.dataSync();return jn(i,t.shape,t.dtype,e,n)}min(t,e){r.X.assertAxesAreInnerMostDims("min",e,t.rank);const[n,i]=r.X.computeOutAndReduceShapes(t.shape,e),s=r.Lb.sizeFromShape(i),o=t.as2D(-1,s);return this.reduce(o,"min",o.dtype).reshape(n)}minimum(t,e){const n=this.tryRunOnCpuOrThrow([t,e],(()=>this.cpuBackend.minimum(t,e)));if(n)return n;const i=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new $t("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(i,[t,e])}mod(t,e){const n=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new $t("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}maximum(t,e){const n=this.tryRunOnCpuOrThrow([t,e],(()=>this.cpuBackend.maximum(t,e)));if(n)return n;const i=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new $t("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(i,[t,e])}all(t,e){r.X.assertAxesAreInnerMostDims("all",e,t.rank);const[n,i]=r.X.computeOutAndReduceShapes(t.shape,e),s=r.Lb.sizeFromShape(i),o=t.as2D(-1,s);return this.reduce(o,"all",o.dtype).reshape(n)}any(t,e){r.X.assertAxesAreInnerMostDims("any",e,t.rank);const[n,i]=r.X.computeOutAndReduceShapes(t.shape,e),s=r.Lb.sizeFromShape(i),o=t.as2D(-1,s);return this.reduce(o,"any",o.dtype).reshape(n)}floorDiv(t,e){if(Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");const n=new $t("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")}packedUnaryOp(t,e,n){const i=new Fn(t.shape,e);return this.compileAndRun(i,[t],n)}packedBinaryOp(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new ee(n,t.shape,e.shape,r);return this.compileAndRun(s,[t,e],i)}makeComplexComponentTensorInfo(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}addN(t){if(1===t.length)return t[0];if(t.length>Object(r.jb)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),i=this.addN(t.slice(e));return this.addN([n,i])}const e=t.map((t=>t.dtype)).reduce(((t,e)=>Object(r.Kb)(t,e))),n=t.map((t=>t.shape)),i=Object(r.jb)().getBool("WEBGL_PACK")?new At(t[0].shape,n):new kt(t[0].shape,n);return this.compileAndRun(i,t,e)}pow(t,e){const n=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new $t("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=Object(r.Kb)(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],i)}ceil(t){if(this.shouldExecuteOnCPU([t])){const e=mt(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,kn,t.dtype);const e=new bn(t.shape,kn);return this.compileAndRun(e,[t])}floor(t){if(this.shouldExecuteOnCPU([t])){const e=yt(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,An,t.dtype);const e=new bn(t.shape,An);return this.compileAndRun(e,[t])}sign(t){const e=new bn(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])}isNaN(t){const e=new bn(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")}isInf(t){const e=new bn(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")}isFinite(t){const e=new bn(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")}round(t){const e=new bn(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])}exp(t){if(this.shouldExecuteOnCPU([t])){const e=gt(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,In,t.dtype);const e=new bn(t.shape,In);return this.compileAndRun(e,[t])}expm1(t){if(this.shouldExecuteOnCPU([t])){const e=vt(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,On,t.dtype);const e=new bn(t.shape,On);return this.compileAndRun(e,[t])}softmax(t,e){const n=r.Lb.parseAxisParam([e],t.shape),i=Object(r.nb)(t,n),s=r.X.expandShapeToKeepDim(i.shape,n),o=r.Eb(t,i.reshape(s)),a=this.exp(o),c=this.sum(a,n).reshape(s);return Object(r.hb)(a,c)}log(t){if(this.shouldExecuteOnCPU([t])){const e=xt(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);const e=new bn(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])}log1p(t){const e=new bn(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])}sqrt(t){const e=new bn(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])}rsqrt(t){if(this.shouldExecuteOnCPU([t])){const e=St(this.texData.get(t.dataId).values,t.dtype);return this.makeOutput(t.shape,t.dtype,e)}const e=new bn(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])}reciprocal(t){const e=new bn(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])}relu(t){let e;return e=Object(r.jb)().getBool("WEBGL_PACK")?new Fn(t.shape,Mn):new bn(t.shape,Sn),this.compileAndRun(e,[t])}relu6(t){let e;return e=Object(r.jb)().getBool("WEBGL_PACK")?new Fn(t.shape,Dn):new bn(t.shape,_n),this.compileAndRun(e,[t])}prelu(t,e){const n=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee(te,t.shape,e.shape):new $t(Jt,t.shape,e.shape);return this.compileAndRun(n,[t,e])}elu(t){if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Pn,t.dtype);const e=new bn(t.shape,Tn);return this.compileAndRun(e,[t])}eluDer(t,e){const n=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new $t("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}selu(t){const e=new bn(t.shape,En);return this.compileAndRun(e,[t])}clip(t,e,n){let i;i=Object(r.jb)().getBool("WEBGL_PACK_CLIP")?new ie(t.shape):new ne(t.shape);const s=i.getCustomSetupFunc(e,n);return this.compileAndRun(i,[t],null,s)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=pt(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(Object(r.jb)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,wn,t.dtype);const e=new bn(t.shape,wn);return this.compileAndRun(e,[t])}complexAbs(t){const e=this.texData.get(t.dataId),n=new re(t.shape),i=[this.makeComplexComponentTensorInfo(t,e.complexTensorInfos.real),this.makeComplexComponentTensorInfo(t,e.complexTensorInfos.imag)];return this.compileAndRun(n,i)}sigmoid(t){const e=new bn(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])}softplus(t){const e=new bn(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])}asin(t){const e=new bn(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])}acos(t){const e=new bn(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])}atan(t){const e=new bn(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])}sinh(t){const e=new bn(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}cosh(t){const e=new bn(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}tanh(t){const e=new bn(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])}asinh(t){const e=new bn(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])}acosh(t){const e=new bn(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])}atanh(t){const e=new bn(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])}erf(t){const e=new bn(t.shape,Rn);return this.compileAndRun(e,[t])}step(t,e){const n=new bn(t.shape,function(){return"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,");\n  ")}(e));return this.compileAndRun(n,[t])}conv2dByMatMul(t,e,n,i,s,o){const a=t.shape,c=this.texData.get(t.dataId),l=n.inChannels,u=a[0]*a[1]*a[2],h=n.outChannels,d="channelsLast"===n.dataFormat,p=(1===u||1===h)&&l>1e3,f=a[2]%2!=0&&!!c.isPacked;if(p||!Object(r.jb)().getBool("WEBGL_LAZILY_UNPACK")||!Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!f){const c=d?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],l=Object(r.xb)(t,[1,c,n.inChannels]),u=Object(r.xb)(e,[1,n.inChannels,n.outChannels]),h=this.fusedBatchMatMul({a:l,b:u,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o});return Object(r.xb)(h,n.outShape)}const m=d?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),g={dataId:t.dataId,shape:[1,m,n.inChannels],dtype:t.dtype},v=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,r.Lb.assert(R(c.shape,g.shape),(()=>"packed reshape ".concat(c.shape," to ").concat(g.shape," isn't free")));const y=Object(r.xb)(e,[1,n.inChannels,n.outChannels]),x=this.fusedBatchMatMul({a:g,b:y,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:o}),b=this.texData.get(x.dataId);return r.Lb.assert(b.isPacked,(()=>"batchMatMul result is expected to be packed")),c.shape=v,b.shape=n.outShape,Object(r.ib)().makeTensorFromDataId(x.dataId,n.outShape,x.dtype)}conv2dWithIm2Row(t,e,n,i,r,s){const{filterWidth:o,filterHeight:a,inChannels:c,outWidth:l,outHeight:u,dataFormat:h}=n,d="channelsLast"===h,p=o*a*c,f=u*l,m=[p,f],g=t.squeeze([0]),v=e.reshape([1,p,-1]),y=new Be(m,g.shape,n),x=this.compileAndRun(y,[g]).reshape([1,m[0],m[1]]),b=null!=i,w=null!=s,S=r?Gn(r,!0):null,_=new Ge(x.shape,v.shape,[1,f,n.outChannels],!0,!1,b,S,w),T=[x,v];i&&T.push(i),w&&T.push(s);const E=this.compileAndRun(_,T);return d?E.reshape([1,u,l,n.outChannels]):E.reshape([1,n.outChannels,u,l])}fusedConv2d(t){let{input:e,filter:n,convInfo:i,bias:s,activation:o,preluActivationWeights:a}=t;if(1===i.filterHeight&&1===i.filterWidth&&1===i.dilationHeight&&1===i.dilationWidth&&1===i.strideHeight&&1===i.strideWidth&&("SAME"===i.padInfo.type||"VALID"===i.padInfo.type))return this.conv2dByMatMul(e,n,i,s,o,a);if(Object(r.jb)().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,i,s,o,a);const c=null!=s,l=null!=a,u=o?Gn(o,!1):null,h=new he(i,c,u,l),d=[e,n];return s&&d.push(s),a&&d.push(a),this.compileAndRun(h,d)}conv2d(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(Object(r.jb)().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);const i=new he(n);return this.compileAndRun(i,[t,e])}conv2dDerInput(t,e,n){const i=new oe(n);return this.compileAndRun(i,[t,e])}conv2dDerFilter(t,e,n){const i=new se(n);return this.compileAndRun(i,[t,e])}fusedDepthwiseConv2D(t){let{input:e,filter:n,convInfo:i,bias:s,activation:o,preluActivationWeights:a}=t;const c=Object(r.jb)().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,l=o?Gn(o,c):null,u=[e,n],h=null!=s,d=null!=a;let p;return h&&u.push(s),d&&u.push(a),c?(p=new fe(i,h,l,d),this.compileAndRun(p,u)):(p=new pe(i,h,l,d),this.compileAndRun(p,u))}depthwiseConv2D(t,e,n){let i;return Object(r.jb)().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(i=new fe(n),this.compileAndRun(i,[t,e])):(i=new pe(n),this.compileAndRun(i,[t,e]))}depthwiseConv2DDerInput(t,e,n){const i=new ue(n);return this.compileAndRun(i,[t,e])}depthwiseConv2DDerFilter(t,e,n){const i=new le(n);return this.compileAndRun(i,[t,e])}conv3d(t,e,n){const i=new de(n);return this.compileAndRun(i,[t,e])}conv3dDerInput(t,e,n){const i=new ce(n);return this.compileAndRun(i,[t,e])}conv3dDerFilter(t,e,n){const i=new ae(n);return this.compileAndRun(i,[t,e])}unstack(t,e){const n=t.shape[e],i=new Array(t.rank-1);let r=0;for(let c=0;c<t.rank;c++)c!==e&&(i[r++]=t.shape[c]);const s=new Array(t.rank).fill(0),o=t.shape.slice();o[e]=1;const a=new Array(n);for(let c=0;c<a.length;c++)s[e]=c,a[c]=this.slice(t,s,o).reshape(i);return a}avgPool3d(t,e){const n=new Ze(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}avgPool3dBackprop(t,e,n){const i=new Zt(n);return this.compileAndRun(i,[t],e.dtype)}maxPool3d(t,e){const n=new Ze(e,"max",!1);return this.compileAndRun(n,[t],"float32")}maxPool3dBackprop(t,e,n,i){const r=new Ze(i,"max",!0),s=this.compileAndRun(r,[e]),o=new We(i),a=this.compileAndRun(o,[t,s],e.dtype);return s.dispose(),a}resizeBilinear(t,e,n,i){const s=Object(r.jb)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new nn(t.shape,e,n,i):new en(t.shape,e,n,i);return this.compileAndRun(s,[t],"float32")}resizeBilinearBackprop(t,e,n){const i=new tn(t,e,n);return this.compileAndRun(i,[t])}resizeNearestNeighbor(t,e,n,i){const r=new sn(t.shape,e,n,i);return this.compileAndRun(r,[t])}resizeNearestNeighborBackprop(t,e,n){const i=new rn(t,e,n);return this.compileAndRun(i,[t])}multinomial(t,e,n,i){const s=e?t:Object(r.Bb)(t),o=s.shape[0],a=s.shape[1],c=new qe(o,a,n),l=c.getCustomSetupFunc(i);return this.compileAndRun(c,[s],"int32",l)}oneHot(t,e,n,i){const r=new He(t.size,e,n,i);return this.compileAndRun(r,[t])}diag(t){const e=new Se(t.size);return this.compileAndRun(e,[t])}cropAndResize(t,e,n,i,r,s){const o=new me(t.shape,e.shape,i,r,s);return this.compileAndRun(o,[t,e,n],"float32")}depthToSpace(t,e,n){r.Lb.assert(e>1,(()=>"blockSize should be > 1 for depthToSpace, but was: "+e));const i=t.shape[0],s="NHWC"===n?t.shape[1]:t.shape[2],o="NHWC"===n?t.shape[2]:t.shape[3],a="NHWC"===n?t.shape[3]:t.shape[1],c=s*e,l=o*e,u=a/(e*e),h=new we("NHWC"===n?[i,c,l,u]:[i,u,c,l],e,n);return this.compileAndRun(h,[t])}split(t,e,n){return zn(t,e,n)}scatterND(t,e,n){const{sliceRank:i,numUpdates:s,sliceSize:o,strides:a,outputSize:c}=r.X.calculateShapes(e,t,n),l=[c/o,o],u=t.reshape([s,i]),h=e.reshape([s,o]);if(0===c)return r.X.reshapeTensor(Object(r.Gb)([]),n);const d=Object(r.yb)(0),p=new cn(s,i,u.rank,h.rank,a,l);return this.compileAndRun(p,[h,u,d]).reshape(n)}sparseToDense(t,e,n,i){const{sliceRank:s,numUpdates:o,strides:a,outputSize:c}=r.X.calculateShapes(e,t,n),l=new cn(o,s,t.rank,e.rank,a,[c,1],!1);return this.compileAndRun(l,[e,t,i]).reshape(n)}gatherND(t,e){const n=e.shape,i=n[n.length-1],[s,o,a,c]=r.X.prepareAndValidate(t,e),l=e.reshape([o,i]),u=t.reshape([t.size/a,a]),h=new Ie(i,c,[o,a]);return this.compileAndRun(h,[u,l]).reshape(s)}fill(t,e,n){if("string"===(n=n||r.Lb.inferDtype(e))){const i=r.Lb.getArrayFromDType(n,r.Lb.sizeFromShape(t));return i.fill(e),Object(r.ib)().makeTensor(i,t,n,this)}{const i=new ke(t,e),r=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],n,r)}}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)}zerosLike(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)}linspace(t,e,n){return r.X.linspaceImpl(t,e,n)}makeTensorInfo(t,e,n){const i=this.write(n,t,e);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:e}}makeOutput(t,e,n){const{dataId:i}=this.makeTensorInfo(t,e,n);return Object(r.ib)().makeTensorFromDataId(i,t,e,this)}unpackTensor(t){const e=new Ln(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new Xe(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[k(t.shape),...A(t.shape)],i={dtype:t.dtype,shape:n,dataId:t.dataId},r=[k(e),...A(e)],s=new $e(r,n),o=this.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:i,dtype:r}=e,s=I(i);let o;return o=n?new be(s):new xe(s),{dtype:r,shape:i,dataId:this.runWebGLProgram(o,[{shape:s,dtype:r,dataId:t}],r,null,!0).dataId}}runWebGLProgram(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=this.makeTensorInfo(t.outputShape,n),a=this.texData.get(o.dataId);if(t.packedOutput&&(a.isPacked=!0),t.outPackingScheme===c.DENSE){const e=d(t.outputShape);a.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(a.usage=t.outTexUsage),0===r.Lb.sizeFromShape(o.shape))return a.values=r.Lb.getTypedArrayFromDType(o.dtype,0),o;const l=[],u=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.Lb.sizeFromShape(e.shape)<=Object(r.jb)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),l.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!R(n.shape,e.shape)){const t=e,i=e.shape;e.shape=n.shape,e=this.packedReshape(e,i),l.push(e),n=this.texData.get(e.dataId),t.shape=i}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);const h={shape:o.shape,texData:a,isUniform:!1},p=function(t,e,n){let i="";e.concat(n).forEach((t=>{const e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;i+="".concat(t.shape,"_").concat(n,"_").concat(e)}));const r=t.userCode;let s=t.constructor.name;return s+="_"+i+"_"+r,s}(t,u,h),f=this.getAndSaveBinary(p,(()=>function(t,e,n,i){const s=e.userCode,o=n.map(((t,n)=>{const i={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(i.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:i}})),a=o.map((t=>t.shapeInfo)),c={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},l=Lt(o,c,s,e.packedInputs),u=t.createProgram(l);let h=null;const d=t.getUniformLocation(u,"NAN",!1);1===Object(r.jb)().getNumber("WEBGL_VERSION")&&(h=t.getUniformLocation(u,"INFINITY",!1));const p={};for(let r=0;r<e.variableNames.length;r++){const n=e.variableNames[r],i=!1;p[n]=t.getUniformLocation(u,n,i),p["offset"+n]=t.getUniformLocation(u,"offset"+n,i)}return{program:e,source:l,webGLProgram:u,uniformLocations:p,inShapeInfos:a,outShapeInfo:c,infLoc:h,nanLoc:d}}(this.gpgpu,t,u,h))),m=null!=this.activeTimers;let g;if(m&&(g=this.startTimer()),function(t,e,n,i,s){Le(e.inShapeInfos,n),Le([e.outShapeInfo],[i]);const o=i.texData.texture,a=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===Object(r.jb)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach(((n,i)=>{const s=e.program.variableNames[i],o=e.uniformLocations[s],a=e.uniformLocations["offset"+s];if(null!=o)if(n.isUniform)if(r.Lb.sizeFromShape(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(o,e)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,i)})),null!=s&&s(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,f,u,h,i),l.forEach((t=>this.disposeIntermediateTensorInfo(t))),m&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)})),!Object(r.jb)().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&!1===s){const t=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),t}return o}compileAndRun(t,e,n,i){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;const o=this.runWebGLProgram(t,e,n,i,s);return Object(r.ib)().makeTensorFromDataId(o.dataId,o.shape,o.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Object(r.jb)().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(r.Hb)((()=>{if(!Object(r.jb)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Object(r.jb)().getBool("DEBUG");Object(r.jb)().set("DEBUG",!1);const e=this.abs(Object(r.yb)(1e-8)).dataSync()[0];if(Object(r.jb)().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:i,values:s,texture:o,usage:a,isPacked:c}=e;if(null!=o)return;const u=null!=this.activeTimers;let h;u&&(h=r.Lb.now());let d=e.texShape;if(null==d&&(d=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(r.jb)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map(((e,n)=>n>=t.length-2?r.Lb.nearestLargerEven(t[n]):t[n]))).length&&(t=[2,t[0]])),2!==t.length){const e=r.Lb.squeezeShape(t);t=e.newShape}let i=r.Lb.sizeFromShape(t);if(t.length<=1&&i<=n)return[1,i];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=k(t);let n=2,s=2;return t.length&&([n,s]=A(t)),i=e*(n/2)*(s/2),r.Lb.sizeToSquarishShape(i).map((t=>2*t))}return r.Lb.sizeToSquarishShape(i)}(n,c),e.texShape=d),null!=s){const t=I(n);let o,a=d[1],f=d[0];const m=s instanceof Uint8Array;c?([a,f]=p(d[0],d[1]),o=new Ce(t,[f,a],m)):o=new Ee(t,[f,a],m);const g=this.makeTensorInfo([f,a],i);this.texData.get(g.dataId).usage=m?l.PIXELS:l.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),a,f,s);const v=!0,y=this.runWebGLProgram(o,[g],i,null,v),x=this.texData.get(y.dataId);e.texture=x.texture,e.texShape=x.texShape,e.isPacked=x.isPacked,e.usage=x.usage,this.disposeIntermediateTensorInfo(g),this.texData.delete(y.dataId),e.values=null,u&&(this.uploadWaitMs+=r.Lb.now()-h)}else{const t=this.acquireTexture(d,a,i,c);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:i}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype "+e)}(e,i)),n.values}acquireTexture(t,e,n,i){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, most likely due to a memory leak"))}return this.textureManager.acquireTexture(t,e,i)}computeBytes(t,e){return t[0]*t[1]*r.Lb.bytesPerElement(e)}tryRunOnCpuOrThrow(t,e){if(this.shouldExecuteOnCPU(t))try{return e()}catch(t){if(Object(r.jb)().getBool("IS_TEST"))throw new Error("CPU forwarding failed")}return null}}function Hn(t){const{inputs:e,backend:n}=t,{x:i}=e;return n.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}r.fb.isBrowser()&&Object(r.vb)("webgl",(()=>new qn),2);const Xn={kernelName:r.u,backendName:"webgl",kernelFunc:Hn};function Yn(t){const{inputs:e,backend:n}=t,{real:i,imag:r}=e,s=n.makeTensorInfo(i.shape,"complex64"),o=n.texData.get(s.dataId),a=Hn({inputs:{x:i},backend:n});n.texData.get(a.dataId).complexParentRefCount++;const c=Hn({inputs:{x:r},backend:n});return n.texData.get(c.dataId).complexParentRefCount++,o.complexTensorInfos={real:a,imag:c},s}const Kn={kernelName:r.h,backendName:"webgl",kernelFunc:Yn};function Qn(t){return e=>{let{inputs:n,backend:i}=e;const{x:r}=n,s=i,o=new bn(r.shape,t);return s.runWebGLProgram(o,[r],r.dtype)}}function Zn(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:i=!1,supportsComplex:s=!1,cpuKernelImpl:o,dtype:a}=t;return t=>{let{inputs:c,backend:l}=t;const{a:u,b:h}=c,d=l;if(s&&"complex64"===u.dtype){const t=d.texData.get(u.dataId),n=d.texData.get(h.dataId),[i,s]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,i]=t,s={dataId:n.dataId,dtype:n.dtype,shape:u.shape},o={dataId:i.dataId,dtype:i.dtype,shape:h.shape},a=new $t(e,u.shape,h.shape);return d.runWebGLProgram(a,[s,o],Object(r.Kb)(n.dtype,i.dtype))})),o=Yn({inputs:{real:i,imag:s},backend:d});return d.disposeIntermediateTensorInfo(i),d.disposeIntermediateTensorInfo(s),o}const p=a||Object(r.Kb)(u.dtype,h.dtype);if(d.shouldExecuteOnCPU([u,h])&&null!=o){const t=d.texData.get(u.dataId),e=d.texData.get(h.dataId),[n,i]=o(u.shape,h.shape,t.values,e.values,p),r=d.makeTensorInfo(i,p);return d.texData.get(r.dataId).values=n,r}let f;return f=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new ee(n,u.shape,h.shape,i):new $t(e,u.shape,h.shape),d.runWebGLProgram(f,[u,h],p)}}const Jn="return a + b;",$n=Zn({opSnippet:Jn,packedOpSnippet:Jn,supportsComplex:!0,cpuKernelImpl:ft}),ti={kernelName:r.b,backendName:"webgl",kernelFunc:$n},ei=Zn({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),ni={kernelName:r.c,backendName:"webgl",kernelFunc:ei},ii={kernelName:r.d,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:s}=e;L(s,"avgPool");const{filterSize:o,strides:a,pad:c,dimRoundingMode:l}=i;r.Lb.assert(r.X.eitherStridesOrDilationsAreOne(a,1),(()=>"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '1'")));const u=r.X.computePool2DInfo(s.shape,o,a,1,c,l);if(1===u.filterWidth&&1===u.filterHeight&&r.Lb.arraysEqual(u.inShape,u.outShape))return Hn({inputs:{x:s},backend:n});const h=new Qe(u,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}},ri={kernelName:r.e,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:s,input:o}=e,a=o;L([s,o],"avgPoolBackprop");const{filterSize:c,strides:l,pad:u}=i,h=r.X.computePool2DInfo(a.shape,c,l,1,u),d=new Qt(h);return n.runWebGLProgram(d,[s],a.dtype)}};class si{constructor(t,e,n,i,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],r.X.assertAndGetBroadcastShape(t,e),r.X.assertAndGetBroadcastShape(t,n);let a="0.0";null!=i&&(r.X.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="1.0";null!=s&&(r.X.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(a,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class oi{constructor(t,e,n,i,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],r.X.assertAndGetBroadcastShape(t,e),r.X.assertAndGetBroadcastShape(t,n);let a="vec4(0.0)";null!=i&&(r.X.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="vec4(1.0)";null!=s&&(r.X.assertAndGetBroadcastShape(t,s),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(a,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const ai={kernelName:r.s,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:s,mean:o,variance:a,offset:c,scale:l}=e;r.Lb.assert(o.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),r.Lb.assert(null==c||o.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),r.Lb.assert(null==l||o.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:u}=i;null==u&&(u=.001);const h=[s,o,a];let d=null;null!=c&&(d=c.shape,h.push(c));let p=null;null!=l&&(p=l.shape,h.push(l));const f=Object(r.jb)().getBool("WEBGL_PACK_NORMALIZATION")?new oi(s.shape,o.shape,a.shape,d,p,u):new si(s.shape,o.shape,a.shape,d,p,u);return n.runWebGLProgram(f,h,h[0].dtype)}},ci=Zn({opSnippet:"return float(a != b);",dtype:"bool"}),li={kernelName:r.I,backendName:"webgl",kernelFunc:ci};function ui(t){const{inputs:e,backend:n}=t,{input:i}=e;return Hn({inputs:{x:n.texData.get(i.dataId).complexTensorInfos.real},backend:n})}const hi={kernelName:r.J,backendName:"webgl",kernelFunc:ui},di={kernelName:r.f,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:i,attrs:s}=e,{x:o}=n,{dtype:a}=s;if("complex64"===a){if("complex64"===o.dtype)return Hn({inputs:{x:o},backend:i});const e=r.Nb(o.shape),n=t({inputs:{x:o},backend:i,attrs:{dtype:"float32"}}),s=Yn({inputs:{real:n,imag:e},backend:i});return e.dispose(),i.disposeIntermediateTensorInfo(n),s}if("complex64"===o.dtype){const e=ui({inputs:{input:o},backend:i}),n=t({inputs:{x:e},backend:i,attrs:{dtype:a}});return i.disposeIntermediateTensorInfo(e),n}if(!r.Lb.hasEncodingLoss(o.dtype,a)){const t=Hn({inputs:{x:o},backend:i});return{dataId:t.dataId,shape:t.shape,dtype:a}}if("int32"===a)return function(t,e){const n=new bn(t.shape,"return float(int(x));"),i=e.runWebGLProgram(n,[t],"int32");return{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}(o,i);if("bool"===a){const t=i.makeTensorInfo([],"bool",r.Lb.getTypedArrayFromDType("bool",1)),e=ci({inputs:{a:o,b:t},backend:i});return i.disposeIntermediateTensorInfo(t),e}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(a))}};class pi{constructor(t){this.outputShape=[],this.outputShape=r.X.computeOutShape(t,1),this.variableNames=t.map(((t,e)=>"T"+e));const e=new Array(t.length-1);e[0]=t[0][1];for(let r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let r=1;r<e.length;r++){const t=e[r-1];n.push("else if (yC < ".concat(e[r],") setOutput(getT").concat(r,"(yR, yC-").concat(t,"));"))}const i=e.length,s=e[e.length-1];n.push("else setOutput(getT".concat(i,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class fi{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=r.X.computeOutShape(t,e);const n=this.outputShape,i=n.length,s=Ht(i),o=Rt("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map(((t,e)=>"T"+e));const c=new Array(t.length-1);c[0]=t[0][e];for(let r=1;r<c.length;r++)c[r]=c[r-1]+t[r][e];const l=a[e],u=a.slice(-2),h=a.join();let d="if (".concat(l," < ").concat(c[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(u.join(),"));\n        }");for(let r=1;r<c.length;r++){const t=c[r-1];d+="\n        if (".concat(l," < ").concat(c[r],"  && ").concat(l," >= ").concat(c[r-1],") {\n          return getChannel(\n            getT").concat(r,"(").concat(mi(a,l,t),"),\n            vec2(").concat(mi(u,l,t),"));\n        }")}const p=c.length,f=c[c.length-1];d+="\n        return getChannel(\n          getT".concat(p,"(").concat(mi(a,l,f),"),\n          vec2(").concat(mi(u,l,f),"));"),this.userCode="\n      float getValue(".concat(a.map((t=>"int "+t)),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(s," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," + 1;\n        if (").concat(o[i-1]," < ").concat(n[i-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-2]," = ").concat(o[i-2]," + 1;\n        if (").concat(o[i-2]," < ").concat(n[i-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," - 1;\n        if (").concat(o[i-2]," < ").concat(n[i-2]," &&\n            ").concat(o[i-1]," < ").concat(n[i-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}}function mi(t,e,n){const i=t.indexOf(e);return t.map(((t,e)=>e===i?"".concat(t," - ").concat(n):t)).join()}function gi(t){const{inputs:e,backend:n}=t,{input:i}=e;return Hn({inputs:{x:n.texData.get(i.dataId).complexTensorInfos.imag},backend:n})}const vi={kernelName:r.v,backendName:"webgl",kernelFunc:gi};function yi(t){const{inputs:e,backend:n,attrs:i}=t,{x:s}=e,{shape:o}=i,a=n,c=r.Lb.sizeFromShape(s.shape),l=r.Lb.inferFromImplicitShape(o,c),u=r.Lb.sizeFromShape(l);r.Lb.assert(c===u,(()=>"The new shape (".concat(l,") has ").concat(u," elements and the old shape (").concat(s.shape,") has ").concat(c," elements. The new shape and old shape must have the same number of elements.")));const h=a.texData.get(s.dataId);return!h.isPacked||R(s.shape,l)||null!==h.texture&&R(h.shape,l)?(a.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype}):function(t,e,n){const i=[k(t.shape),...A(t.shape)],r={dtype:t.dtype,shape:i,dataId:t.dataId},s=[k(e),...A(e)],o=new $e(s,i),a=n.runWebGLProgram(o,[r],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}}(s,l,a)}const xi={kernelName:r.K,backendName:"webgl",kernelFunc:yi},bi={kernelName:r.i,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{axis:s}=i,o=r.Lb.parseAxisParam(s,e[0].shape)[0],a=r.X.computeOutShape(e.map((t=>t.shape)),o);if(0===r.Lb.sizeFromShape(a))return n.makeTensorInfo(a,e[0].dtype,[]);const c=e.filter((t=>r.Lb.sizeFromShape(t.shape)>0));if(1===c.length)return c[0];const l=c.map((t=>t.shape));return r.X.assertParamsConsistent(l,o),function t(e,n,i){const s=e[0].dtype;if("complex64"===s){const r=e.map((t=>ui({inputs:{input:t},backend:i}))),s=e.map((t=>gi({inputs:{input:t},backend:i}))),o=t(r,n,i),a=t(s,n,i),c=Yn({inputs:{real:o,imag:a},backend:i});return r.forEach((t=>i.disposeIntermediateTensorInfo(t))),s.forEach((t=>i.disposeIntermediateTensorInfo(t))),i.disposeIntermediateTensorInfo(o),i.disposeIntermediateTensorInfo(a),c}if(e.length>Object(r.jb)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const r=Math.floor(e.length/2),s=t(e.slice(0,r),n,i),o=t(e.slice(r),n,i),a=t([s,o],n,i);return i.disposeIntermediateTensorInfo(s),i.disposeIntermediateTensorInfo(o),a}if(Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){const t=new fi(e.map((t=>t.shape)),n);return i.runWebGLProgram(t,e,s)}const o=r.X.computeOutShape(e.map((t=>t.shape)),n),a=e.map((t=>yi({inputs:{x:t},attrs:{shape:[-1,r.Lb.sizeFromShape(t.shape.slice(n))]},backend:i}))),c=new pi(a.map((t=>t.shape))),l=i.runWebGLProgram(c,a,s);a.forEach((t=>i.disposeIntermediateTensorInfo(t)));const u=yi({inputs:{x:l},attrs:{shape:o},backend:i});return i.disposeIntermediateTensorInfo(l),u}(c,o,n)}},wi=Qn("if (isnan(x)) return x;\n  return cos(x);\n"),Si={kernelName:r.j,backendName:"webgl",kernelFunc:wi},_i=Zn({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),Ti={kernelName:r.l,backendName:"webgl",kernelFunc:_i};class Ei{constructor(t,e,n){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const r=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,s=n?i+".0":"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(r,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(i,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function Ci(t,e,n){const i=n.texData.get(t.dataId),s=r.Lb.sizeFromShape(t.shape),o=t.shape[t.shape.length-1],a=yi({inputs:{x:t},backend:n,attrs:{shape:[s/o,o]}}).shape,c=new Ei("real",a,e),l=new Ei("imag",a,e),u=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:a},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:a}],h=n.runWebGLProgram(c,u,"float32"),d=n.runWebGLProgram(l,u,"float32"),p=Yn({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const f=yi({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(f),f}const ki={kernelName:r.o,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e;return Ci(i,!1,n)}};class Ai{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const Ii={kernelName:r.p,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:i}=e,r=n,s=new Ai(i.shape);return r.runWebGLProgram(s,[i],i.dtype)}};class Oi{constructor(t){this.variableNames=["A"];const e=Nt(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class Ri{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=Nt(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}const Ni={kernelName:r.r,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t;let{pixels:s}=e;const{numChannels:o}=i,a="undefined"!=typeof HTMLVideoElement&&s instanceof HTMLVideoElement,c="undefined"!=typeof HTMLImageElement&&s instanceof HTMLImageElement,[u,h]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],d=[h,u],p=[h,u,o];(c||a)&&(null==Mi&&(Mi=document.createElement("canvas").getContext("2d")),Mi.canvas.width=u,Mi.canvas.height=h,Mi.drawImage(s,0,0,u,h),s=Mi.canvas);const f=n.makeTensorInfo(d,"int32");n.texData.get(f.dataId).usage=l.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);const m=Object(r.jb)().getBool("WEBGL_PACK")?new Ri(p):new Oi(p),g=n.runWebGLProgram(m,[f],"int32");return n.disposeData(f.dataId),g}};let Mi;const Di={kernelName:r.t,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e;return Ci(i,!0,n)}};class Pi{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];const a=4*Math.floor(n/4),c=n%4;let l="sumValue += dot(values, ones);";if(null!=e){const t=1/e;l="sumValue += dot(values * ".concat(r.Lb.isInt(t)?t.toPrecision(2):t,", ones);")}let u="";s%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(s,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(a,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}function Fi(t,e,n,i){const s=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],i=r.X.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:i,outSize:Math.ceil(n/i)})}return e}(t.shape);let o=t;for(let r=0;r<s.length;r++){const{inSize:a,windowSize:c,outSize:l}=s[r];let u,h;u="mean"===n?0===r?new Pi({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},a):new Pi({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l}):new Je({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},n),h=o,o=i.runWebGLProgram(u,[o],e),h.dataId!==t.dataId&&i.disposeIntermediateTensorInfo(h)}return o}class Li{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[e[s]];this.outputShape=n,this.rank=n.length;const i=Ht(this.rank),r=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],i=new Array(e);for(let r=0;r<t.length;r++)i[t[r]]=n[r];return i.join()}(e);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(r,"));\n    }\n    ")}}class Bi{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let l=0;l<n.length;l++)n[l]=t[e[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const i=Ht(this.rank),r=Ot("rc",this.rank),s=new Array(this.rank);for(let l=0;l<e.length;l++)s[e[l]]=r[l];const o="vec2(".concat(s.slice(-2).join(),")"),a="++".concat(r[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(s.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(a,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(r[this.rank-1],";\n      if(++").concat(r[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(a,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function zi(t,e,n){const i=Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Bi(t.shape,e):new Li(t.shape,e);return n.runWebGLProgram(i,[t],t.dtype)}const Ui={kernelName:r.y,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:s}=e,{reductionIndices:o,keepDims:a}=n,c=i,l=s.shape.length,u=r.Lb.parseAxisParam(o,s.shape);let h=u;const d=r.X.getAxesPermutation(h,l),p=null!=d,f=c.shouldExecuteOnCPU([s]);let m=s;if(p){if(f){const t=c.texData.get(m.dataId).values,e=new Array(l);for(let i=0;i<e.length;i++)e[i]=s.shape[d[i]];const n=Et(t,s.shape,s.dtype,d,e);m=c.makeTensorInfo(e,s.dtype),c.texData.get(m.dataId).values=n}else m=zi(s,d,c);h=r.X.getInnerMostAxes(h.length,l)}r.X.assertAxesAreInnerMostDims("max",h,l);const[g,v]=r.X.computeOutAndReduceShapes(m.shape,h);let y,x=g;if(a&&(x=r.X.expandShapeToKeepDim(g,u)),f){const t=c.texData.get(m.dataId).values,e=bt(t,r.Lb.sizeFromShape(v),x,s.dtype);y=c.makeTensorInfo(x,s.dtype),c.texData.get(y.dataId).values=e}else y=function(t,e,n,i){const s=r.Lb.sizeFromShape(e),o=yi({inputs:{x:t},attrs:{shape:[r.Lb.sizeFromShape(t.shape)/s,s]},backend:i}),a=Fi(o,t.dtype,"max",i),c=yi({inputs:{x:a},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(o),i.disposeIntermediateTensorInfo(a),c}(m,v,x,c);return p&&c.disposeIntermediateTensorInfo(m),y}},ji={kernelName:r.z,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:s}=e;L(s,"maxPool");const{filterSize:o,strides:a,pad:c,dimRoundingMode:l}=i;r.Lb.assert(r.X.eitherStridesOrDilationsAreOne(a,1),(()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '1'")));const u=r.X.computePool2DInfo(s.shape,o,a,1,c,l);if(1===u.filterWidth&&1===u.filterHeight&&r.Lb.arraysEqual(u.inShape,u.outShape))return Hn({inputs:{x:s},backend:n});const h=new Qe(u,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}},Vi={kernelName:r.A,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:s,input:o,output:a}=e,c=o;L([o,a],"maxPoolBackprop");const{filterSize:l,strides:u,pad:h,dimRoundingMode:d}=i,p=r.X.computePool2DInfo(c.shape,l,u,1,h,d),f=new Qe(p,"max",!0),m=n.runWebGLProgram(f,[c],c.dtype),g=new Ve(p),v=n.runWebGLProgram(g,[s,m],c.dtype);return n.disposeIntermediateTensorInfo(m),v}},Wi={kernelName:r.B,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:s}=e,{filterSize:o,strides:a,pad:c,includeBatchInIndex:l}=n,u=i;r.Lb.assert(4===s.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(s.shape.length,".")));const h=[1,1];r.Lb.assert(r.X.eitherStridesOrDilationsAreOne(a,h),(()=>"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(h,"'")));const d=r.X.computePool2DInfo(s.shape,o,a,h,c),[p,f]=function(t,e,n,i){let r=new Qe(n,"max",!1);const s=i.runWebGLProgram(r,[t],"float32");return r=new Qe(n,"max",!0,!0,e),[s,i.runWebGLProgram(r,[t],"float32")]}(s,l,d,u);return[p,f]}},Gi={kernelName:r.C,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:s}=e,{keepDims:o,axis:a}=n,c=i,l=s.shape.length,u=r.Lb.parseAxisParam(a,s.shape);let h=u;const d=r.X.getAxesPermutation(h,l),p=null!=d,f=c.shouldExecuteOnCPU([s]),m=[];let g=s;if(p){if(f){const t=c.texData.get(g.dataId).values,e=new Array(l);for(let i=0;i<e.length;i++)e[i]=s.shape[d[i]];const n=Et(t,s.shape,s.dtype,d,e);g=c.makeTensorInfo(e,s.dtype),c.texData.get(g.dataId).values=n}else g=zi(s,d,c);m.push(g),h=r.X.getInnerMostAxes(h.length,l)}r.X.assertAxesAreInnerMostDims("sum",h,l);const[v,y]=r.X.computeOutAndReduceShapes(g.shape,h);let x=v;o&&(x=r.X.expandShapeToKeepDim(v,u));const b=function(t,e,n,i){const s=r.Lb.sizeFromShape(e),o=yi({inputs:{x:t},attrs:{shape:[r.Lb.sizeFromShape(t.shape)/s,s]},backend:i}),a=Fi(o,"float32","mean",i),c=yi({inputs:{x:a},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(o),i.disposeIntermediateTensorInfo(a),c}(g,y,x,c);for(const r of m)c.disposeIntermediateTensorInfo(r);return b}};class qi{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=Ht(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c="reflect"===n?0:1;this.userCode=1!==i?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(i,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(r," coords = outC - start;\n        setOutput(getX(").concat(a,"));\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class Hi{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=Ht(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=Rt("rc",i),c=Rt("source",i),l="".concat(a[i-1]," < ").concat(this.outputShape[i-1]),u=1===i?"source":"vec2(".concat(c.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===i){const t="\n        ".concat(r," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(a[i-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ")}else{const t="\n        ".concat(r," source = rc;\n        ").concat(r," lt = ").concat(r,"(lessThan(source, start));\n        ").concat(r," gte = ").concat(r,"(greaterThanEqual(source, end));\n        ").concat(r," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(a[i-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(a[i-2]," += 1;\n        if(").concat(a[i-2]," < ").concat(this.outputShape[i-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          ").concat(a[i-1]," += 1;\n          if(").concat(l,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const Xi={kernelName:r.D,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:s}=e,{paddings:o,mode:a}=i,c=Object(r.jb)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hi(s.shape,o,a):new qi(s.shape,o,a);return n.runWebGLProgram(c,[s],s.dtype)}};class Yi{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=r.X.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const Ki="return a * b;",Qi={kernelName:r.E,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{a:i,b:s}=e,o=r.X.upcastType(i.dtype,s.dtype);if("complex64"===i.dtype){const t=n.texData.get(i.dataId),e=n.texData.get(s.dataId),r=new Yi("return areal * breal - aimag * bimag;",i.shape,s.shape),o=new Yi("return areal * bimag + aimag * breal;",i.shape,s.shape),a=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:s.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:s.shape}],c=n.runWebGLProgram(r,a,"float32"),l=n.runWebGLProgram(o,a,"float32"),u=Yn({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([i,s])){const t=n.texData.get(i.dataId),e=n.texData.get(s.dataId),[r,a]=wt(i.shape,s.shape,t.values,e.values,o),c=n.makeTensorInfo(a,o);return n.texData.get(c.dataId).values=r,c}let a;return a=Object(r.jb)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ee(Ki,i.shape,s.shape):new $t(Ki,i.shape,s.shape),n.runWebGLProgram(a,[i,s],o)}},Zi={kernelName:r.F,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;r.X.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:c,scoreThreshold:l}=i,u=n,h=u.readSync(s.dataId),d=u.readSync(o.dataId),p=a,f=c,m=l;return r.lb.nonMaxSuppressionV3Impl(h,d,p,f,m)}},Ji=r.lb.nonMaxSuppressionV4Impl,$i={kernelName:r.G,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;r.X.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:c,scoreThreshold:l,padToMaxOutputSize:u}=i,h=n,d=h.readSync(s.dataId),p=h.readSync(o.dataId),{selectedIndices:f,validOutputs:m}=Ji(d,p,a,c,l,u);return[f,m]}},tr=r.lb.nonMaxSuppressionV5Impl,er={kernelName:r.H,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;r.X.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:s,scores:o}=e,{maxOutputSize:a,iouThreshold:c,scoreThreshold:l,softNmsSigma:u}=i,h=n,d=h.readSync(s.dataId),p=h.readSync(o.dataId),f=a,m=c,g=l,v=u,{selectedIndices:y,selectedScores:x}=tr(d,p,f,m,g,v);return[y,x]}};class nr{constructor(t,e,n,i){this.variableNames=["Image"],this.outputShape=[];const s=t[1],o=t[2],a=Math.sin(e).toFixed(3),c=Math.cos(e).toFixed(3);this.outputShape=t;const[l,u]=r.X.getImageCenter(i,s,o),h=l.toFixed(3),d=u.toFixed(3);let p="";p="number"==typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(h,") * ").concat(c," - (float(y) - ").concat(d,") * ").concat(a,";\n          float coordYFloat = (float(x) - ").concat(h,") * ").concat(a," + (float(y) - ").concat(d,") * ").concat(c,";\n          int coordX = int(round(coordXFloat + ").concat(h,"));\n          int coordY = int(round(coordYFloat + ").concat(d,"));\n          ").concat(p,"\n          if(coordX >= 0 && coordX < ").concat(o," && coordY >= 0 && coordY < ").concat(s,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const ir={kernelName:r.L,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:r}=e,{radians:s,fillValue:o,center:a}=n,c=i,l=new nr(r.shape,s,o,a);return c.runWebGLProgram(l,[r],r.dtype)}},rr=Qn("if (isnan(x)) return x;\n  return sin(x);\n"),sr={kernelName:r.N,backendName:"webgl",kernelFunc:rr},or=Qn("return x * x;"),ar={kernelName:r.P,backendName:"webgl",kernelFunc:or},cr=Zn({opSnippet:"return (a - b) * (a - b);",packedOpSnippet:"return (a - b) * (a - b);"}),lr={kernelName:r.Q,backendName:"webgl",kernelFunc:cr},ur="return a - b;",hr=Zn({opSnippet:ur,packedOpSnippet:ur,supportsComplex:!0,cpuKernelImpl:Tt}),dr={kernelName:r.R,backendName:"webgl",kernelFunc:hr},pr=Qn("return tan(x);"),fr=[ti,ni,ii,ri,ai,di,Kn,bi,Si,Ti,ki,Ii,Ni,Xn,Di,vi,Ui,ji,Vi,Wi,Gi,Xi,Qi,Zi,$i,er,li,hi,xi,ir,sr,ar,dr,lr,{kernelName:r.S,backendName:"webgl",kernelFunc:pr},{kernelName:r.U,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:r}=e,{perm:s}=n,o=i,a=r.shape.length,c=new Array(a);for(let u=0;u<c.length;u++)c[u]=r.shape[s[u]];let l;if(o.shouldExecuteOnCPU([r])){const t=o.texData.get(r.dataId).values,e=Et(t,r.shape,r.dtype,s,c);l=o.makeTensorInfo(c,r.dtype),o.texData.get(l.dataId).values=e}else l=zi(r,s,o);return l}},{kernelName:r.V,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:i}=t,{axis:r}=n,{x:s}=e;L(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=i.readSync(s.dataId),{outputValues:a,outputShape:c,indices:l}=Ct(o,r,s.shape,s.dtype);return[i.makeTensorInfo(c,s.dtype,a),i.makeTensorInfo([l.length],"int32",l)]}}];for(const Er of fr)Object(r.wb)(Er);var mr=n(2),gr=n(9),vr=n(20),yr=n(42),xr=n(25);const br=(t,e,n)=>{const i=t.createBuffer(1,e.length,n);return i.copyToChannel(e,0),i};function wr(t,e,n,i,r){return new Promise((s=>{const o={loudness_db:[0],f0_hz:[0]};let a=0;for(let c=e;c<n;c++)i&&c>=r?(o.loudness_db[a]=-120,o.f0_hz[a]=-1):(o.loudness_db[a]=t.loudness_db[c],o.f0_hz[a]=t.f0_hz[c]),a+=1;s(o)}))}function Sr(t){return t*xr.b}function _r(t){return t/xr.b}class Tr{constructor(t,e){this.checkpointUrl=t,e&&(this.settings=e)}async initialize(){let t;mr.registerOp("Roll",(t=>{const e=mr.split(t.inputs[0],2,2),n=mr.concat([e[1],e[0]],2);return e.forEach((t=>t.dispose())),n})),mr.env().set("WEBGL_PACK",!1),mr.env().set("WEBGL_CONV_IM2COL",!1),mr.env().set("WEBGL_DELETE_TEXTURE_THRESHOLD",104857600),this.model=await async function(t){return await mr.loadGraphModel(t)}(this.checkpointUrl+"/model.json");try{t=await fetch(this.checkpointUrl+"/settings.json").then((t=>t.json()))}finally{if(null===this.settings)throw new Error("Passing settings is required if you do not have a settings.json file.")}this.settings={...t,...this.settings},this.initialized=!0}dispose(){this.initialized&&(this.model.dispose(),this.checkpointUrl=null,this.initialized=!1)}isInitialized(){return this.initialized}async memCheck(){return await async function(){const t=window.screen.availWidth*window.screen.availHeight,e=window.devicePixelRatio,n=Math.round(t*e*600/1048576);if(!isNaN(n)&&n<50)throw new Error("Insufficient memory! Your device has ".concat(n," and recommended memory is 50"));try{if(await mr.ready(),"webgl"!==mr.getBackend())throw new Error("It looks like your browser does not support webgl.")}catch(t){throw new Error("insufficient memory - "+t)}return!0}()}async synthesize(t,e){null!==e&&(this.settings={...this.settings,...e});const{f0_hz:n,loudness_db:i,confidences:r}=t,s=Object(yr.c)(n,i.length,this.settings.modelMaxFrameLength),o=Object(yr.c)(r,i.length,this.settings.modelMaxFrameLength),a=await async function(t,e){const n=e.averageMaxLoudness,i=e.meanLoudness,r=e.loudnessThreshold,s=e.meanPitch;let o,a=[];if(t.loudness_db.length>0){const e=mr.tidy((()=>{const e=mr.tensor1d(t.loudness_db,"float32"),i=e.max(),r=mr.sub(n,i),s=mr.add(e,r);return e.dispose(),i.dispose(),r.dispose(),s})),s=e.greater(r),c=await mr.booleanMaskAsync(e,s),l=await c.array(),u=mr.tidy((()=>{const t=l>0?c.mean():e.mean(),r=mr.sub(i,t),s=e.add(r).add(0).clipByValue(-120,n),o=s.min(),a=t.sub(o);return s.sub(o).div(a).mul(i- -120).add(-120)})),h=mr.reshape(t.confidences,[-1,1,1]),d=mr.pool(h,[100,1],"avg","same"),p=d.reshape([-1]),f=mr.lessEqual(p,.7);o=mr.tidy((()=>{const t=f.mul(-25),e=u.add(t),n=mr.maximum(e,-120);return t.dispose(),e.dispose(),n})),a=await o.array(),s.dispose(),e.dispose(),u.dispose(),c.dispose(),d.dispose(),p.dispose(),h.dispose(),f.dispose()}let c=[];if(t.f0_hz.length>0){const e=await Object(vr.c)(t.f0_hz),n=mr.tidy((()=>{for(let t=0,n=e.length;t<n;++t)e[t]===-1/0&&(e[t]=0);return e})),i=mr.lessEqual(t.confidences,.7),a=o.greater(r),l=mr.logicalOr(i,a),u=await mr.booleanMaskAsync(n,l),h=u.mean(),d=await mr.sub(s,h),p=await d.array(),f=mr.tidy((()=>{let e=p/12;return e=Math.round(e),Object(yr.b)(t.f0_hz,e)}));c=await f.array(),o.dispose(),h.dispose(),u.dispose(),d.dispose(),f.dispose(),a.dispose(),l.dispose(),i.dispose()}return{f0_hz:c,loudness_db:a}}({f0_hz:s,loudness_db:i,confidences:o},this.settings),c=[],l=a.loudness_db.length,u=_r(l);let h=!1;const d=_r(this.settings.modelMaxFrameLength);let p;const f=1*xr.c;for(let x=0;x<u;x+=d-1){const t=Math.floor(Sr(x)),e=Sr(x+d);e>l&&(h=!0);const{f0_hz:n,loudness_db:i}=await wr(a,t,e,h,l),r=mr.tensor1d(n,"float32"),s=mr.tensor1d(i,"float32"),o=await this.model.predict({f0_hz:r,loudness_db:s}),u=await o.data();c.push(u),o.dispose(),r.dispose(),s.dispose()}if(u<=d)p=c[0];else{const t=[];for(let e=0;e<c.length;e++){const n=c[e];t.push(n)}p=function(t,e){const n=t.reduce(((t,e)=>t+e.length),0),i=new Float32Array(n);let r=0;for(let o=0;o<t.length;o++){const n=t[o],a=o<t.length-1;if(0===o&&(i.set(n,r),r+=n.length),a){const a=t[o+1],c=r-e;for(let t=c,o=0,l=n.length-e;t<r&&o<a.length;t++,o++,l++){const e=(t-c)/(r-c);i[t]=n[l]*(1-(s=e))+a[o]*s}i.set(a.slice(e),r),r+=a.slice(e).length}}var s;return i}(t,f)}const m=p.slice(0,t.originalRecordedBufferLength).map((t=>t*(this.settings.postGain||1))),g=new gr.Context,v=br(g,m,xr.c),y=await Object(vr.j)(v,48e3);return await async function(t){let e,{audioCtx:n,arrayBuffer:i,sampleRate:r}=t;gr.setContext(n);let s=br(n,i,r);const o=gr.Offline((()=>{const t=new gr.Compressor({attack:.001,release:.001,threshold:-6}).toDestination(),e=new gr.Reverb({wet:.3,decay:3}).connect(t),n=new gr.Filter(8e3,"lowpass",-24).connect(e);return new gr.Player({url:s}).connect(n).start(),e.ready}),i.length/r);e=await o;const a=e.getChannelData(0);return s=null,e.dispose(),e=null,a}({audioCtx:g,arrayBuffer:y,sampleRate:48e3})}}},function(t,e,n){"use strict";n.r(e),n.d(e,"GANSynth",(function(){return x}));var i=n(2),r=n(12),s=n(15),o=n(43),a=n(20);const c=[[1,1,1.0087615084725814],[2,1,.029087889211125567],[2,2,.958243896036208],[3,2,.5326346877272624],[3,3,.45988057223186607],[4,3,1.0072850129664943],[5,4,1.0050894259864507],[6,4,.016233689242197466],[6,5,.9763230964529687],[7,5,.5149287456976357],[7,6,.48299891928441196],[8,6,1.0020339883784544],[9,7,1.0013940582804204],[10,7,.004285414445239434],[10,8,.9936677765505681],[11,8,.4979349533263788],[11,9,.5020647178266697],[12,9,.9896782321684733],[12,10,.006967080931645349],[13,10,1.0022486641537054],[14,11,1.0033233953996759],[15,11,.4782757843614299],[15,12,.5183887055972138],[16,12,.9736767011426267],[16,13,.01804416217807709],[17,13,1.0056329663266226],[18,14,1.00808642668908],[19,14,.4576416347984229],[19,15,.5340800956534676],[20,15,.9582897445862256],[20,16,.028988367857957848],[21,16,1.008754652772106],[22,17,1.0122552436937966],[23,17,.4380796830853842],[23,18,.5491738237632201],[24,18,.9434838949694413],[24,19,.039794474296176746],[25,19,1.0116287566447584],[26,20,1.0158945544322868],[27,20,.41952402212367873],[27,21,.5637020154076856],[28,21,.9292283399303117],[28,22,.05045785324282485],[29,22,1.0142694870195312],[30,23,1.0190617246342517],[31,23,.40191289323704393],[31,24,.5776942788784806],[32,24,.915494649120402],[32,25,.060974426459003916],[33,25,1.016690283888679],[34,26,1.0218076651124588],[35,26,.3851885348435194],[35,27,.5911779611807773],[36,27,.9022565352474414],[36,28,.07134062388959171],[37,28,1.0189038677945517],[38,29,1.0241776077147466],[39,29,.369297000124277],[39,30,.6041783722578726],[40,30,.8894896443111251],[40,31,.08155334505527755],[41,31,1.0209222848386956],[42,32,1.0262117836546005],[43,32,.35418795675261777],[43,33,.6167189821271176],[44,33,.87717137085618],[44,34,.09160992335204851],[45,34,1.0227569476841007],[46,35,1.0279460165329002],[47,35,.3398144781420294],[47,36,.628821594757742],[48,36,.8652806947525041],[48,37,.10150809298528844],[49,37,1.0244186730654867],[50,38,1.029412240942602],[51,38,.32613283297317347],[51,39,.6405065019041107],[52,39,.8537980365619783],[52,40,.11124595830527892],[53,40,1.0259177162406141],[54,41,1.030638956235277],[55,41,.3131022777355948],[55,42,.6517926196031543],[56,42,.8427051290118196],[56,43,.12082196533877268],[57,43,1.0272638027474759],[58,44,1.031651623831845],[59,44,.3006848555240512],[59,45,.6626976096262132],[60,45,.8319849024715039],[60,46,.13023487533380312],[61,46,1.0284661577762764],[62,47,1.0324730153919173],[63,47,.28884520321029805],[63,48,.6732379878311283],[64,48,.821621382643116],[64,49,.1394837401591093],[65,49,1.0295335334192939],[66,50,1.0331235182054521],[67,50,.27755036829985363],[67,51,.68342922107227],[68,51,.8115995989355603],[68,52,.148567879414825],[69,52,1.0304742340231496],[70,53,1.0336214033370148],[71,53,.2667696361817086],[71,54,.6932858140884962],[72,54,.8019055022130549],[72,55,.1574868591255191],[73,55,1.031296139836255],[74,56,1.0339830613212895],[75,56,.2564743680536822],[75,57,.7028213875855097],[76,57,.7925258907912134],[76,58,.16624047189958738],[77,58,1.032006729117501],[78,59,1.0342232095724524],[79,59,.24663784949713183],[79,60,.7120487485622758],[80,60,.7834483437084975],[80,61,.17482871845079165],[81,61,1.032613098850059],[82,62,1.0343550751159198],[83,62,.2372351494674972],[83,63,.7209799537859948],[84,63,.7746611604312031],[84,64,.18325179038711914],[85,64,1.0331219841851924],[86,65,1.0343905557724016],[87,65,.22824298931879333],[87,66,.7296263672031092],[88,66,.7661533062642226],[88,67,.19151005417692718],[89,67,1.0335397767254908],[90,68,1.0343403625078313],[91,68,.21963962139622123],[91,69,.7379987119645334],[92,69,.7579143628308538],[92,70,.19960403621540457],[93,70,1.0338725417430177],[94,71,1.0342141453043734],[95,71,.21140471667072153],[95,72,.746107117663542],[96,72,.7499344830670268],[96,73,.20753440891552338],[97,73,1.0341260344172454],[98,74,1.034020604597683],[99,74,.20351926086574523],[99,75,.7539611633021215],[100,75,.7422043502477234],[100,76,.2153019777561019],[101,76,1.0343057151671131],[102,77,1.0337675900563705],[103,77,.19596545852169872],[103,78,.7615699164421695],[104,78,.734715140616724],[104,79,.22290766922455862],[105,79,1.034416764143981],[106,80,1.03346218824938],[107,80,.1887266444456389],[107,81,.7689419689404797],[108,81,.7274584892496355],[108,82,.23035251959385997],[109,82,1.0344640949448594],[110,83,1.0331108005456808],[111,83,.18178720201436843],[111,84,.7760854696185804],[112,84,.7204264588178948],[112,85,.23763766448199494],[113,85,1.0344523675990727],[114,86,1.032719212418228],[115,86,.1751324878193402],[115,87,.7830081541774375],[116,87,.7136115109646374],[116,88,.2447643291417676],[117,88,1.0343860008764458],[118,89,1.0322926551739824],[119,89,.16874876216974247],[119,90,.789717372631832],[120,90,.7070064800338803],[120,91,.2517338194331562],[121,91,1.0342691839607763],[122,92,1.0318358610025598],[123,92,.16262312499771858],[123,93,.7962201145052664],[124,93,.7006045489251309],[124,94,.25854751343650967],[125,94,1.0341058875275075],[126,95,1.0313531121234998],[127,95,.15674345673841866],[127,96,.8025230320033012],[128,96,.6943992268713032],[128,97,.2652068536620191],[129,97,1.033899874262366],[130,98,1.030848284714744],[131,98,.1510983637896712],[131,99,.8086324613545763],[132,99,.6883843289574696],[132,100,.2717133398209474],[133,100,1.033654708853177],[134,101,1.0303248882205327],[135,101,.14567712818173575],[135,102,.8145544424922615],[136,102,.6825539572209546],[136,103,.2780685221191216],[137,103,1.033373767485838],[138,104,1.0297861005632643],[139,104,.14046966111762169],[139,105,.8202947372282664],[140,105,.6769024831869065],[140,106,.28427399504058354],[141,106,1.0330602468722847],[142,107,1.029234799720434],[143,107,.13546646006984392],[143,108,.8258588460540109],[144,108,.671424531713726],[144,109,.290331391589362],[145,109,1.0327171728357682],[146,110,1.0286735920712562],[147,110,.13065856914309196],[147,111,.8312520236957351],[148,111,.6661149660273628],[148,112,.2962423779602388],[149,112,1.03234740847843],[150,113,1.0281048378703825],[151,113,.12603754244145],[151,114,.8364792935255917],[152,114,.6609688738465388],[152,115,.30200864860954885],[153,115,1.0319536619522978],[154,116,1.0275306741623285],[155,116,.12159541018943322],[155,117,.8415454609370665],[156,117,.655981554500098],[156,118,.3076319217011811],[157,118,1.031538493855763],[158,119,1.0269530354146845],[159,119,.11732464738966399],[159,120,.846455125764718],[160,120,.6511485069565366],[160,121,.3131139349019227],[161,121,1.0311043242739946],[162,122,1.0263736721146446],[163,122,.11321814480714538],[163,123,.851212693834753],[164,123,.6464654186857061],[164,124,.3184564415055735],[165,124,1.0306534394819706],[166,125,1.0257941675461106],[167,125,.10926918209624069],[167,126,.8558223877141483],[168,126,.6419281552876014],[168,127,.32366120686047056],[169,127,1.0301879983273805],[170,128,1.0252159529388847],[171,128,.10547140289367021],[171,129,.8602882567276612],[172,129,.6375327508240597],[172,130,.32873000508360367],[173,130,1.0297100383091813],[174,131,1.0246403211604227],[175,131,.10181879172477112],[175,132,.8646141862987496],[176,132,.6332753987956673],[176,133,.33366461604209907],[177,133,1.0292214813668379],[178,134,1.0240684391009978],[179,134,.09830565257411007],[179,135,.8688039066707689],[180,135,.6291524437169539],[180,136,.3384668225808326],[181,136,1.0287241393952773],[182,137,1.0235013588866442],[183,137,.0949265889928822],[183,138,.8728610010546515],[184,138,.6251603732380943],[184,139,.3431384079843332],[185,139,1.0282197194980238],[186,140,1.0229400280388043],[187,140,.09167648561647405],[187,141,.8767889132518744],[188,141,.6212958107744541],[188,142,.3476811536535296],[189,142,1.0277098289923983],[190,143,1.0223852986877378],[191,143,.08855049098843445],[191,144,.8805909547856343],[192,144,.6175555086043407],[192,145,.35209683698566024],[193,145,1.0271959801772084],[194,146,1.021837935933431],[195,146,.08554400158179727],[195,147,.8842703115872171],[196,147,.6139363413989273],[196,148,.35638722943949186],[197,148,1.026679594876984],[198,149,1.0212986254395027],[199,149,.082652646931321],[199,150,.8878300502607867],[200,150,.6104353001536761],[200,151,.3605540947783916],[201,151,1.0261620087703698],[202,152,1.020767980334856],[203,152,.07987227578640096],[203,153,.8912731239662092],[204,153,.6070494864912312],[204,154,.364599187472458],[205,154,1.025644475516362],[206,155,1.0202465474911722],[207,155,.07719894321045902],[207,156,.8946023779404728],[208,156,.6037761073076129],[208,157,.36852425125748506],[209,157,1.0251281706842847],[210,158,1.0197348132361097],[211,158,.07462889855138014],[211,159,.8978205546916732],[212,159,.6006124697383151],[212,160,.3723310178292769],[213,160,1.0246141955013988],[214,161,1.0192332085569418],[215,161,.07215857422040488],[215,162,.9009302988805],[216,162,.5975559764226185],[216,163,.37602120567284064],[217,163,1.024103580422386],[218,164,1.018742113842709],[219,164,.06978457521665815],[219,165,.9039341619174114],[220,165,.5946041210439893],[220,166,.3795965190111676],[221,166,1.0235972885322195],[222,167,1.0182618632088625],[223,167,.0675036693443592],[223,168,.9068346062921914],[224,168,.5917544841265701],[224,169,.3830586468674795],[225,169,1.0230962187892327],[226,170,1.0177927484431766],[227,170,.06531277806896706],[227,171,.9096340096561174],[228,171,.5890047290713193],[228,172,.38640926223293437],[229,172,1.0226012091159231],[230,173,1.017335022608167],[231,173,.0632089679653424],[231,174,.9123346686734497],[232,174,.586352598418078],[232,175,.3896500213288084],[233,175,1.0221130393455482],[234,176,1.0168889033326205],[235,176,.06118944272087777],[235,177,.914938802652698],[236,177,.5837959103122896],[236,178,.39278256296329067],[237,178,1.0216324340290364],[238,179,1.0164545758191],[239,179,.05925153564332089],[239,180,.9174485569826359],[240,180,.5813325551691159],[240,181,.3958085079669357],[241,181,1.0211600651125134],[242,182,1.01603219559476],[243,182,.05739270264601734],[243,183,.919866006375456],[244,183,.578960492519135],[244,184,.39872945870775167],[245,184,1.020696554488055],[246,185,1.0156218910279706],[247,185,.055610515672866775],[247,186,.9221931579354511],[248,186,.5766777480237313],[248,187,.4015469986761612],[249,187,1.0202424764259312],[250,188,1.0152237656316911],[251,188,.05390265653168126],[251,189,.9244319540637365],[252,189,.5744824106486663],[252,190,.4042626921377848],[253,190,1.0197983598926021],[254,191,1.0148379001729047],[255,191,.052266911108559244],[255,192,.9265842752073952],[256,192,.5723726299899468],[256,193,.40687808384383367],[257,193,1.0193646907609162],[258,194,1.0144643546050645],[259,194,.05070116393653833],[259,195,.9286519424651887],[260,195,.5703466137364466],[260,196,.4093946987997115],[261,196,1.0189419139168765],[262,197,1.014103169839173],[263,197,.04920339309393266],[263,198,.9306367200572258],[264,198,.5684026252644323],[264,199,.41181404208517797],[265,199,1.0185304352678317],[266,200,1.0137543693675302],[267,200,.04777166540942449],[267,201,.9325403176671191],[268,201,.5665389813575877],[268,202,.4141375987198434],[269,202,1.0181306236573189],[270,203,1.0134179607527265],[271,203,.04640413195303674],[271,204,.934364392667829],[272,204,.5647540500383554],[272,205,.4163668335733731],[273,205,1.017742812691386],[274,206,1.0130939369942324],[275,206,.04509902379599986],[275,207,.9361105522297561],[276,207,.5630462485124229],[276,208,.4185031913161667],[277,208,1.0173673024779883],[278,209,1.0127822777820206],[279,209,.043854648017688035],[279,210,.9377803553285139],[280,210,.5614140412123577],[280,211,.42054809640522234],[281,211,1.0170043612872055],[282,212,1.0124829506474082],[283,212,.042669383945431606],[283,213,.9393753146522579],[284,213,.5598559379382144],[284,214,.42250295310432634],[285,214,1.016654227133528],[286,215,1.0121959120202477],[287,215,.04154167961383383],[287,216,.9408968984130733],[288,216,.5583704920894111],[288,217,.42436914553372207],[289,217,1.0163171092845467],[290,218,1.0119211081990869],[291,218,.04047004842376173],[291,219,.9423465320743504],[292,219,.5569562989809166],[292,220,.4261480377490578],[293,220,1.0159931896995795],[294,221,1.0116584762427925],[295,221,.03945306599345366],[295,222,.9437255999933521],[296,222,.5556119942410062],[296,223,.4278409738424421],[297,223,1.0156826244024533],[298,224,1.0114079447897668],[299,224,.038489367187566605],[299,225,.9450354469842541],[300,225,.5543362522836106],[300,226,.42944927807097044],[301,226,1.015385544788648],[302,227,1.0111694348102989],[303,227,.03757764331096192],[303,228,.9462773798108762],[304,228,.5531277848528364],[304,229,.4309742550012965],[305,229,1.0151020588742643],[306,230,1.010942860298229],[307,230,.036716639459590646],[307,231,.9474526686068676],[308,231,.5519853396352962],[308,232,.4324171896758833],[309,232,1.0148322524854105],[310,233,1.0107281289063446],[311,233,.03590515201636021],[311,234,.9485625482321702],[312,234,.5509076989367998],[312,235,.43377934779319954],[313,235,1.0145761903940136],[314,236,1.0105251425307091],[315,236,.03514202628559325],[315,237,.9496082195647421],[316,237,.5498936784177629],[316,238,.4350619759070698],[317,238,1.014333917399279],[318,239,1.0103337978471305],[319,239,.03442615425358563],[319,240,.9505908507379167],[320,240,.5489421258861396],[320,241,.43626630163460317],[321,241,1.0141054593619083],[322,242,1.01015398680447],[323,242,.03375647247069698],[323,243,.9515115783174108],[324,243,.5480519201477565],[324,244,.43739353387882146],[325,244,1.0138908241879996],[326,245,1.0099855970782285],[327,245,.033131960048180864],[327,246,.9523715084281075],[328,246,.5472219699015581],[328,247,.438444863061944],[329,247,1.013690002769195],[330,248,1.009828512486449],[331,248,.0325516367573507],[331,249,.9531717178331495],[332,249,.5464512126887197],[332,250,.43942146136466664],[333,250,1.0135029698801676],[334,251,1.0096826133725936],[335,251,.03201456123217285],[335,252,.9539132549610332],[336,252,.5457386138858732],[336,253,.4403244829779182],[337,253,1.0133296850325435],[338,254,1.009547776957031],[339,254,.03151982926510845],[339,255,.9545971408911784],[340,255,.5450831657405287],[340,256,.44115506435778573],[341,256,1.0131700932920482],[342,257,1.0094238776594737],[343,257,.031066572189892106],[343,258,.9552243702967873],[344,258,.5444838864501296],[344,259,.44191432448690826],[345,259,1.013024126057376],[346,260,1.0093107873949636],[347,260,.030653955347715485],[347,261,.9557959123477745],[348,261,.5439398192781751],[348,262,.44260336514265247],[349,262,1.01289170180302],[350,263,1.0092083758457435],[351,263,.03028117663272106],[351,264,.956312711573757],[352,264,.5434500317097861],[352,265,.44322327116676213],[353,265,1.012772726788603],[354,266,1.0091165107105933],[355,266,.029947465111254432],[355,267,.9567756886915669],[356,267,.5430136146404813],[356,268,.443775110739594],[357,268,1.0126670957357586],[358,269,1.0090350579329337],[359,269,.02965207970869547],[359,270,.9571857414000476],[360,270,.5426296815994802],[360,271,.44425993565630856],[361,271,1.012574692474406],[362,272,1.0089638819102829],[363,272,.029394307963707546],[363,273,.9575437451393404],[364,273,.5422973680058967],[364,274,.4446787816043237],[365,274,1.0124953905592755],[366,275,1.0089028456858484],[367,275,.029173464843693937],[367,276,.9578505538209541],[368,276,.5420158304528419],[368,277,.44503266844280676],[369,277,1.0124290538587923],[370,278,1.0088518111235036],[371,278,.028988891617224174],[371,279,.9581070005279474],[372,279,.5417842460227992],[372,280,.4453226004830567],[373,280,1.012375537116488],[374,281,1.0088106390682976],[375,281,.028839954783933083],[375,282,.9583138981860433],[376,282,.5416018116287169],[376,283,.4455495667668758],[377,283,1.0123346864882432],[378,284,1.008779189492711],[379,284,.02872604505481853],[379,285,.9584720402070429],[380,285,.5414677433849261],[380,286,.44571454134485444],[381,286,1.0123063400541175],[382,287,1.008757321629678],[383,287,.028646576380597488],[383,288,.9585822011116006],[384,288,.5413812759956369],[384,289,.4458184835568685],[385,289,1.0122903283078832],[386,290,1.0087448940943453],[387,290,.028600985028178233],[387,291,.9586451371206854],[388,291,.541341662177547],[388,292,.44586233830592226],[389,292,1.0122864746237836],[390,293,1.0087417649949195],[391,293,.028588728701898054],[391,294,.9586615867284015],[392,294,.5413481720936798],[392,295,.44584703633543826],[393,295,1.0122945957030358],[394,296,1.0087477920325896],[395,296,.028609285702619672],[395,297,.958632271251788],[396,297,.5414000928186515],[396,298,.44577349450072723],[397,298,1.0123145019997328],[398,299,1.0087628325926643],[399,299,.028662154128659946],[399,300,.9585578953591529],[400,300,.5414967278190544],[400,301,.4456426160405528],[401,301,1.0123459981276965],[402,302,1.0087867438270437],[403,302,.028746851113718195],[403,303,.9584391475775814],[404,303,.5416373964555454],[404,304,.4454552908447334],[405,304,1.0123888832492127],[406,305,1.0088193827286074],[407,305,.02886291209986826],[407,306,.9582767007831089],[408,306,.541821433501071],[408,307,.44521239571891796],[409,307,1.0124429514472502],[410,308,1.0088606061980132],[411,308,.029009890142771087],[411,309,.9580712126699451],[412,309,.5420481886827784],[412,310,.4449147946460895],[413,310,1.01250799207953],[414,311,1.0089102711038211],[415,311,.029187355249536997],[415,312,.9578233262044412],[416,312,.5423170262339921],[416,313,.44456333904778883],[417,313,1.0125837901172945],[418,314,1.0089682343360202],[419,314,.02939489374516595],[419,315,.9575336700623188],[420,315,.5426273244683578],[420,316,.4441588680360723],[421,316,1.0126701264704934],[422,317,1.0090343528545804],[423,317,.029632107670909735],[423,318,.9572028590461733],[424,318,.5429784753662162],[424,319,.44370220866623333],[425,319,1.0127667782967882],[426,320,1.0091084837312583],[427,320,.02989861420426184],[427,321,.9568314944924141],[428,321,.5433698841780775],[428,322,.44319417618582607],[429,322,1.0128735192969558],[430,323,1.0091904841873789],[431,323,.03019404510848359],[431,324,.9564201646615609],[432,324,.5438009690392793],[432,325,.442635574278337],[433,325,1.0129901199984148],[434,326,1.0092802116265451],[435,326,.030518046204357472],[435,327,.9559694451142186],[436,327,.5442711606026257],[436,328,.4420271953022404],[437,328,1.013116348025554],[438,329,1.0093775236632159],[439,329,.030870276865616747],[439,330,.9554798990737882],[440,330,.5447799016825403],[440,331,.4413698205263152],[441,331,1.0132519683584005],[442,332,1.009482278147551],[443,332,.03125040953717358],[443,333,.9549520777754482],[444,333,.5453266469100869],[444,334,.4406642203630321],[445,334,1.0133967435791398],[446,335,1.009594333186143],[447,335,.031658129272365214],[447,336,.9543865208053518],[448,336,.5459108623998897],[448,337,.43991115459682073],[449,337,1.0135504341086077],[450,338,1.0097135471594447],[451,338,.03209313328990995],[451,339,.9537837564264052],[452,339,.5465320254328632],[452,340,.4391113726049666],[453,340,1.013712798432744],[454,341,1.009839778736762],[455,341,.03255513055252836],[455,342,.9531443018899375],[456,342,.5471896241467579],[456,343,.43826561357805704],[457,343,1.0138835933177033],[458,344,1.0099728868869051],[459,344,.033043841357819334],[459,345,.9524686637453139],[460,345,.5478831572348231],[460,346,.437374606734874],[461,346,1.0140625740178375],[462,347,1.0101127308880269],[463,347,.03355899695286791],[463,348,.9517573381261256],[464,348,.5486121336621822],[464,349,.436439071532636],[465,349,1.0142494944714182],[466,350,1.0102591703335964],[467,350,.03410033916008615],[467,351,.9510108110386514],[468,351,.5493760723833191],[468,352,.4354597178717026],[469,352,1.0144441074918717],[470,353,1.0104120651366326],[471,353,.03466762001996195],[471,354,.9502295586328896],[472,354,.5501745020753853],[472,355,.43443724629963687],[473,355,1.0146461649465606],[474,356,1.0105712755316636],[475,356,.035260601448092795],[475,357,.9494140474694148],[476,357,.5510069608761691],[476,358,.43337234820709825],[477,358,1.0148554179311553],[478,359,1.0107366620751033],[479,359,.035879054907258415],[479,360,.9485647347731454],[480,360,.5518729961339426],[480,361,.4322657060211073],[481,361,1.0150716169344107],[482,362,1.0109080856433987],[483,362,.036522761091017805],[483,363,.9476820686815849],[484,363,.5527721641646695],[484,364,.4311179933933358],[485,364,1.0152945119966836],[486,365,1.011085407429963],[487,365,.037191509621709105],[487,366,.9467664884832998],[488,366,.5537040300164661],[488,367,.42992987538427074],[489,367,1.0155238528614574],[490,368,1.0112684889404733],[491,368,.03788509876006132],[491,369,.945818424848663],[492,369,.5546681672409077],[492,370,.42870200864543534],[493,370,1.015759389119438],[494,371,1.0114571919861517],[495,371,.038603335123549486],[495,372,.9448383000574974],[496,372,.5556641576735553],[496,373,.42743504159139284],[497,373,1.016000870349307],[498,374,1.0116513786769457],[499,374,.03934603342038135],[499,375,.9438265282100843],[500,375,.556691591222498],[500,376,.42612961457530607],[501,376,1.0162480462474877],[502,377,1.011850911412824],[503,377,.0401130161915153],[503,378,.9427835154401112],[504,378,.5577500656591832],[504,379,.42478636005357434],[505,379,1.0165006667574357],[506,380,1.012055652873517],[507,380,.04090411356002747],[507,381,.9417096601187289],[508,381,.5588391864205529],[508,382,.4234059027505881],[509,382,1.016758482190165],[510,383,1.0122654660085202],[511,383,.04171916299559172],[511,384,.940605353048487],[512,384,.5599585664146272],[512,385,.4219888598177451],[513,385,1.0170212433404524],[514,386,1.0124802140252198],[515,386,.04255800908365318],[515,387,.9394709776545362],[516,387,.5611078258344457],[516,388,.42053584098827806],[517,388,1.0172887015980372],[518,389,1.0126997603766286],[519,389,.04342050330548295],[519,390,.9383069101697904],[520,390,.5622865919744513],[520,391,.4190474487280153],[521,391,1.0175606090547666],[522,392,1.0129239687479124],[523,392,.044306503823998804],[523,393,.9371135198133816],[524,393,.5634944990567509],[524,394,.41752427838399275],[525,394,1.017836718605313],[526,395,1.0131527030429122],[527,395,.04521587528078427],[527,396,.9358911689630978],[528,396,.5647311880602439],[528,397,.4159669183258934],[529,397,1.0181167840454461],[530,398,1.013385827369556],[531,398,.04614848859869256],[531,399,.9346402133241121],[532,399,.5659963065530312],[532,400,.41437595008823225],[533,400,1.0184005601646522],[534,401,1.0136232060250132],[535,401,.04710422079259773],[535,402,.9333610020906034],[536,402,.5672895085344858],[536,403,.41275194850334485],[537,403,1.0186878028359048],[538,404,1.0138647034793364],[539,404,.048082954782625906],[539,405,.9320538781067357],[540,405,.5686104542795039],[540,406,.4110954818363832],[541,406,1.0189782691001303],[542,407,1.0141101843606544],[543,407,.04908457922335384],[543,408,.9307191780153855],[544,408,.5699588101870642],[544,409,.40940711191046436],[545,409,1.0192717172488233],[546,410,1.0143595134378742],[547,410,.05010898832967291],[547,411,.9293572324099554],[548,411,.571334248633412],[548,412,.4076873942350095],[549,412,1.0195679069010588],[550,413,1.014612555604275],[551,413,.05115608171422347],[551,414,.9279683659767549],[552,414,.5727364478324755],[552,415,.4059368781231612],[553,415,1.0198665990790994],[554,416,1.0148691758602966],[555,416,.05222576422885553],[555,417,.9265528976348417],[556,417,.5741650916958022],[556,418,.40415610681371494],[557,418,1.0201675562784311],[558,419,1.0151292392959954],[559,419,.05331794581129548],[559,420,.9251111406735011],[560,420,.575619869698764],[560,421,.40234561758289383],[561,421,1.020470542537326],[562,422,1.0153926110734461],[563,422,.05443254133751677],[563,423,.9236434028815992],[564,423,.577100476753225],[564,424,.40050594185671334],[565,424,1.0207753235006762],[566,425,1.0156591564087798],[567,425,.05556947047932675],[567,426,.9221499866777003],[568,426,.5786066130792553],[568,427,.3986376053171075],[569,427,1.021081666483685],[570,428,1.0159287405542117],[571,428,.056728657567230105],[571,429,.9206311892316345],[572,429,.5801379840824749],[572,430,.3967411280111777],[573,430,1.0213893405291132],[574,431,1.016201228779567],[575,431,.057910031456259455],[575,432,.9190873025878152],[576,432,.5816943002369833],[576,433,.39481702444623007],[577,433,1.021698116466727],[578,434,1.0164764863538518],[579,434,.05911352539724152],[579,435,.9175186137811212],[580,435,.5832752769689779],[580,436,.3928658036922941],[581,436,1.0220077669657777],[582,437,1.0167543785266802],[583,437,.06033907691219022],[583,438,.9159254049505173],[584,438,.5848806345442068],[584,439,.3908879694785636],[585,439,1.022318066586335],[586,440,1.017034770509633],[587,440,.061586627674206584],[587,441,.914307953451257],[588,441,.58651009795775],[588,442,.3888840202832941],[589,442,1.0226287918300547],[590,443,1.017317527457434],[591,443,.06285612338957339],[591,444,.9126665319603182],[592,444,.5881633968320044],[592,445,.3868544494242516],[593,445,1.0229397211858324],[594,446,1.0176025144493452],[595,446,.06414751368695158],[595,447,.9110014085827639],[596,447,.5898402653081352],[596,448,.3847997451452973],[597,448,1.0232506351759092],[598,449,1.0178895964699735],[599,449,.06546075200505637],[599,450,.9093128469516464],[600,450,.5915404419502857],[600,451,.38272039070347513],[601,451,1.0235613163962847],[602,452,1.018178638390636],[603,452,.06679579548876291],[603,453,.9076011063291527],[604,453,.5932636696450677],[604,454,.3806168644453139],[605,454,1.0238715495601471],[606,455,1.0184695049504477],[607,455,.06815260488510425],[607,456,.9058664416991429],[608,456,.5950096955107654],[608,457,.37848963988927037],[609,457,1.024181121533852],[610,458,1.0187620607370533],[611,458,.06953114444294146],[611,459,.9041091038666588],[612,459,.5967782707982764],[612,460,.3763391858013562],[613,460,1.0244898213757605],[614,461,1.0190561701684775],[615,461,.07093138181829654],[615,462,.9023293395404434],[616,462,.5985691508103589],[616,463,.37416596626748977],[617,463,1.0247974403689852],[618,464,1.0193516974735164],[619,464,.07235328797779521],[619,465,.9005273914292568],[620,465,.6003820948062436],[620,466,.37197044076689306],[621,466,1.0251037720559506],[622,467,1.0196485066733956],[623,467,.07379683710904351],[623,468,.8987034983230944],[624,468,.6022168659211814],[624,469,.3697530642404009],[625,469,1.025408612268551],[626,470,1.01994646156273],[627,470,.07526200653052777],[627,471,.8968578951803935],[628,471,.6040732310832857],[628,472,.36751428715382667],[629,472,1.0257117591594511],[630,473,1.0202454256910738],[631,473,.07674877660715493],[631,474,.8949908132065928],[632,474,.6059509609308075],[632,475,.3652545555682938],[633,475,1.0260130132278693],[634,476,1.0205452623441595],[635,476,.07825713066499564],[635,477,.8931024799348216],[636,477,.6078498297369068],[636,478,.36297431119783957],[637,478,1.026312177347325],[638,479,1.0208458345252258],[639,479,.07978705490923481],[639,480,.8911931193041005],[640,480,.6097696153313106],[640,481,.360673991471839],[641,481,1.0266090567901067],[642,482,1.021147004936792],[643,482,.08133853834681559],[643,483,.8892629517341233],[644,483,.6117100990244927],[644,484,.3583540295921792],[645,484,1.0269034592511874],[646,485,1.0214486359623245],[647,485,.08291157270803175],[647,486,.8873121941972261],[648,486,.6136710655396947],[648,487,.35601485458732646],[649,487,1.0271951948700204],[650,488,1.0217505896477503],[651,488,.08450615237016054],[651,489,.885341060291742],[652,489,.6156523029400911],[652,490,.3536568913681695],[653,490,1.0274840762511013],[654,491,1.022052727683594],[655,491,.08612227428601159],[655,492,.8833497603088218],[656,492,.6176536025590085],[656,493,.3512805607832744],[657,493,1.02776991848203],[658,494,1.0223549113867765],[659,494,.08775993791161714],[659,495,.8813385013049766],[660,495,.6196747589336273],[660,496,.34888627966024516],[661,496,1.028052539155018],[662,497,1.0226570016825074],[663,497,.08941914513388247],[663,498,.8793074871648813],[664,498,.621715569739104],[664,499,.346474460866357],[665,499,1.0283317583791294],[666,500,1.0229588590871557],[667,500,.09109990020637701],[667,501,.8772569186645972],[668,501,.6237758357289777],[668,502,.34404551334349676],[669,502,1.0286073987990987],[670,503,1.023260343690056],[671,503,.09280220968027517],[671,504,.8751869935378795],[672,504,.6258553606671395],[672,505,.3415998421603758],[673,505,1.0288792856085094],[674,506,1.0235613151361742],[675,506,.09452608233896752],[675,507,.8730979065358732],[676,507,.6279539512706841],[676,508,.33913784855416224],[677,508,1.0291472465628844],[678,509,1.0238616326091752],[679,509,.09627152913686766],[679,510,.8709898494841083],[680,510,.6300714171530707],[680,511,.3366599299694516],[681,511,1.0294111119920568],[682,512,1.0241611548135297],[683,512,.09803856313307117],[683,513,.8688630113461538],[684,513,.6322075707612916],[684,514,.3341664801038121],[685,514,1.0296707148107829],[686,515,1.0244597399582411],[687,515,.09982719943517422],[687,516,.8667175782751595],[688,516,.6343622273238361],[688,517,.33165788894132453],[689,517,1.029925890529174],[690,518,1.024757245739534],[691,518,.10163745513498708],[691,519,.864553733672022],[692,519,.6365352047963319],[692,520,.32913454279236454],[693,520,1.0301764772610114],[694,521,1.0250535293244536],[695,521,.10346934925456013],[695,522,.8623716582378126],[696,522,.6387263238040831],[696,523,.32659682433041565],[697,523,1.0304223157317631],[698,524,1.0253484473338592],[699,524,.10532290268142636],[699,525,.8601715300305955],[700,525,.6409354075949926],[700,526,.32404511262442137],[701,526,1.0306632492858765],[702,527,1.0256418558269649],[703,527,.10719813812199533],[703,528,.8579535245094766],[704,528,.6431622819855923],[704,529,.3214797831731655],[705,529,1.0308991238920382],[706,530,1.0259336102845216],[707,530,.10909508003982304],[707,531,.855717814591042],[708,531,.6454067753119441],[708,532,.3189012079363341],[709,532,1.03112978814904],[710,533,1.0262235655929648],[711,533,.11101375459950885],[711,534,.8534645706974212],[712,534,.6476687183847731],[712,535,.31630975536452444],[713,535,1.0313550932895121],[714,536,1.0265115760290215],[715,536,.11295418962138112],[715,537,.8511939607995829],[716,537,.6499479444348513],[716,538,.3137057904341974],[717,538,1.0315748931821125],[718,539,1.0267974952437684],[719,539,.11491641452111552],[719,540,.8489061504692988],[720,540,.6522442890739327],[720,541,.3110896746693046],[721,541,1.0317890443354898],[722,542,1.027081176247435],[723,542,.11690046026072583],[723,543,.8466013029223681],[724,543,.6545575902471419],[724,544,.3084617661720711],[725,544,1.0319974058989068],[726,545,1.0273624713942857],[727,545,.11890635929917114],[727,546,.8442795790631381],[728,546,.6568876881880987],[728,547,.3058224196480645],[729,547,1.0321998396634169],[730,548,1.0276412323675237],[731,548,.12093414553884717],[731,549,.8419411375296247],[732,549,.6592344253774453],[732,550,.3031719864317822],[733,550,1.0323962100616533],[734,551,1.027917310164898],[735,551,.12298385427920393],[735,552,.8395861347312832],[736,552,.661597646501151],[736,553,.30051081451364153],[737,553,1.0325863841657408],[738,554,1.028190555083932],[739,554,.12505552216817234],[739,555,.8372147248951822],[740,555,.6639771984076539],[740,556,.2978392485576317],[741,556,1.0327702316879357],[742,557,1.0284608167076257],[743,557,.12714918714905468],[743,558,.8348270601054527],[744,558,.6663729300704698],[744,559,.2951576299293991],[745,559,1.0329476249762861],[746,560,1.0287279438905246],[747,560,.12926488841857217],[747,561,.8324232903405301],[748,561,.6687846925454237],[748,562,.2924662967182933],[749,562,1.0331184390116956],[750,563,1.0289917847447467],[751,563,.13140266637549056],[751,564,.8300035635173267],[752,564,.6712123389365675],[752,565,.28976558374944045],[753,565,1.033282551406384],[754,566,1.0292521866268258],[755,566,.13356256257828694],[755,567,.8275680255195722],[756,567,.6736557243576808],[756,568,.28705582261488644],[757,568,1.0334398423957492],[758,569,1.0295089961237516],[759,569,.1357446196959754],[759,570,.8251168202441111],[760,570,.6761147058925864],[760,571,.2843373416864493],[761,571,1.0335901948361186],[762,572,1.0297620590403478],[763,572,.13794888146102224],[763,573,.822650089632257],[764,573,.6785891425651428],[764,574,.2816104661359854],[765,574,1.0337334941973482],[766,575,1.0300112203862977],[767,575,.1401753926301894],[767,576,.8201679737037143],[768,576,.6810788952992894],[768,577,.278875517953921],[769,577,1.0338696285566522],[770,578,1.0302563243634062],[771,578,.14242419893016717],[771,579,.8176706105975015],[772,579,.6835838268889712],[772,580,.2761328159639002],[773,580,1.0339984885922306],[774,581,1.0304972143534852],[775,581,.14469534702456693],[775,582,.8151581365963325],[776,582,.6861038019600981],[776,583,.2733826758448351],[777,583,1.0341199675739228],[778,584,1.0307337329063364],[779,584,.14698888445850505],[779,585,.8126306861670012],[780,585,.6886386869453004],[780,586,.2706254101402667],[781,586,1.0342339613562985],[782,587,1.0309657217274584],[783,587,.14930485962229872],[783,588,.810088391991206],[784,588,.6911883500416512],[784,589,.267861328280309],[785,589,1.0343403683692496],[786,590,1.0311930216672842],[787,590,.1516433217043255],[787,591,.80753138499415],[788,591,.6937526611907388],[788,592,.2650907365900638],[789,592,1.0344390896084676],[790,593,1.0314154727094134],[791,593,.1540043206504027],[791,594,.8049597943767033],[792,594,.6963314920402311],[792,595,.2623139383094437],[793,595,1.034530028625162],[794,596,1.0316329139598897],[795,596,.1563879071152346],[795,597,.8023737476471726],[796,597,.6989247159176777],[796,598,.25953123360660696],[797,598,1.0346130915153564],[798,599,1.0318451836365417],[799,599,.15879413242528773],[799,600,.799773370648628],[800,600,.7015322078013413],[800,601,.256742919587031],[801,601,1.0346881869094755],[802,602,1.0320521190584917],[803,602,.16122304853347555],[803,603,.7971587875884961],[804,603,.7041538442893039],[804,604,.2539492903120581],[805,604,1.0347552259598483],[806,605,1.032253556636297],[807,605,.16367470797552194],[807,606,.7945301210672343],[808,606,.7067895035746306],[808,607,.2511506368077842],[809,607,1.0348141223290412],[810,608,1.0324493318619021],[811,608,.16614916382632547],[811,609,.7918874921076472],[812,609,.709439065413448],[812,610,.24834724708249672],[813,610,1.0348647921767888],[814,611,1.032639279299876],[815,611,.1686464696616927],[815,612,.7892310201754584],[816,612,.7121024111062217],[816,613,.24553940613187852],[817,613,1.0349071541468273],[818,614,1.0328232325774014],[819,614,.17116667951302045],[819,615,.7865608232133336],[820,615,.7147794234616441],[820,616,.24272739595679857],[821,616,1.0349411293537],[822,617,1.0330010243763053],[823,617,.17370984782335191],[823,618,.7838770176637189],[824,618,.7174699867799718],[824,619,.23991149556876706],[825,619,1.0349666413686411],[826,620,1.033172486424039],[827,620,.17627602940857415],[827,621,.7811797184924586],[828,621,.720173986819918],[828,622,.23709198101021747],[829,622,1.0349836162040225],[830,623,1.0333374494861536],[831,623,.1788652794118951],[831,624,.7784690392157592],[832,624,.7228913107823544],[832,625,.234269125354749],[833,625,1.0349919822996723],[834,626,1.0334957433581187],[835,626,.18147765326305537],[835,627,.7757450919251534],[836,627,.7256218472813651],[836,628,.23144319872166874],[837,628,1.0349916705072433],[838,629,1.033647196858036],[839,629,.1841132066386375],[839,630,.773007987305413],[840,630,.7283654863202004],[840,631,.22861446829229304],[841,631,1.0349826140730403],[842,632,1.033791637819688],[843,632,.1867719954109858],[843,633,.7702578346682248],[844,633,.7311221192693971],[844,634,.2257831983137577],[845,634,1.0349647486235953],[846,635,1.0339288930859631],[847,635,.18945407561392777],[847,636,.7674947419659374],[848,636,.7338916388459672],[848,637,.22294965011006523],[849,637,1.0349380121480094],[850,638,1.0342420464149167],[851,638,.1924281237940313],[851,639,.5378425839134362],[852,639,.5202524171708031],[852,640,.4568109772775498],[852,641,.05199677850209752],[853,640,.24351254102567055],[853,641,.5225687624093359],[853,642,.2921493228893563],[854,642,.25538328243481595],[854,643,.5241438210153896],[854,644,.23257172527298814],[855,643,.011987787701546808],[855,644,.3172219958151092],[855,645,.4868674616302827],[855,646,.176468024136203],[856,645,.07357769424953754],[856,646,.38294232266815553],[856,647,.4259205416014665],[856,648,.11753224171517974],[857,647,.13246196705929972],[857,648,.4398303708699065],[857,649,.36708371923835004],[857,650,.06067586883292038],[858,649,.18926719214302565],[858,650,.4946697651421086],[858,651,.3040061179704405],[858,652,.005602736230038195],[859,651,.23906249586178907],[859,652,.5231149368578739],[859,653,.2495840468006932],[860,653,.2897970473112013],[860,654,.5026442283960142],[860,655,.20274559579570214],[861,654,.04664315619110009],[861,655,.3473240465998149],[861,656,.4526192727121032],[861,657,.1523595035438806],[862,656,.09766699822939251],[862,657,.3969699779916487],[862,658,.40188113292822186],[862,659,.1034820659161816],[863,658,.14649823031506354],[863,659,.44395391725661004],[863,660,.3530826952522148],[863,661,.056517279244449437],[864,660,.193417537810633],[864,661,.48905272813711814],[864,662,.30196784607077015],[864,663,.011088189502860925],[865,662,.235165441654809],[865,663,.5161755064939912],[865,664,.25593745749264785],[866,664,.27598857145168865],[866,665,.5055165820237347],[866,666,.21733399798014585],[867,665,.03142691535889764],[867,666,.321995701601107],[867,667,.4677769922252197],[867,668,.17692400337387545],[868,667,.07312870986769164],[868,668,.3630952451007391],[868,669,.4264378437134144],[868,670,.13731285791147696],[869,669,.11270032695167025],[869,670,.4009509624326517],[869,671,.38688927555227676],[869,672,.09946833663506985],[870,671,.15050630725355646],[870,672,.43706477714430675],[870,673,.34910378546507886],[870,674,.06336347754327785],[871,673,.1865736616624162],[871,674,.4714631653468664],[871,675,.3125696686315781],[871,676,.028869775846049314],[872,675,.22058655357283705],[872,676,.502393455771382],[872,677,.27458473006488804],[873,677,.24983886475629993],[873,678,.5137748593109537],[873,679,.24315322539257223],[874,678,.0036240101488931717],[874,679,.2812413419420975],[874,680,.49584386088869215],[874,681,.2153614227018543],[875,680,.034735500335029305],[875,681,.3144060917430617],[875,682,.46485314373790926],[875,683,.18595981453922283],[876,682,.0641063484572785],[876,683,.34219859962945964],[876,684,.43549740951782173],[876,685,.15817234633893226],[877,684,.091864261548934],[877,685,.3683988258245694],[877,686,.407752916631107],[877,687,.13197572785525458],[878,686,.11803256264694018],[878,687,.3930296465168421],[878,688,.3815964769154389],[878,689,.10734720976073055],[879,688,.1426340315995158],[879,689,.4161134070872291],[879,690,.35700543857338174],[879,691,.08426456699687354],[880,690,.16569092182506315],[880,691,.43767193845249674],[880,692,.33395766972405766],[880,693,.06270608273067858],[881,692,.1872249764612122],[881,693,.457726572814142],[881,694,.3124315425508366],[881,695,.04265053289025597],[882,694,.20725744392861123],[882,695,.47629815883858434],[882,696,.29240591801936916],[882,697,.024077171256560802],[883,696,.22580909293436022],[883,697,.49340707629100294],[883,698,.272739666255128],[883,699,.006906252371233933],[884,698,.24190643067177103],[884,699,.5047275543873398],[884,700,.2549459812508028],[885,700,.2567100539467806],[885,701,.5031577036963546],[885,702,.24065881914660317],[886,701,.008634717813202674],[886,702,.27224949572145724],[886,703,.49094674236787206],[886,704,.22719544196570912],[887,703,.02292373131969297],[887,704,.28597629401801355],[887,705,.47672398599653515],[887,706,.2143533208320832],[888,705,.035751602096786475],[888,706,.29743237559552355],[888,707,.46390276826706217],[888,708,.20289630196958544],[889,707,.04719579903029385],[889,708,.3075210742305127],[889,709,.45246460115847775],[889,710,.19280622955805915],[890,709,.057274491299496445],[890,710,.3162602301176305],[890,711,.4423913913890736],[890,712,.18406533389761395],[891,711,.0660054606502899],[891,712,.3236673045470217],[891,713,.43366542899845073],[891,714,.17665622026124392],[892,713,.07340611260620647],[892,714,.3297593908476435],[892,715,.4262693763198494],[892,716,.17056185812791913],[893,715,.07949348729590157],[893,716,.33455322495703466],[893,717,.42018625732795906],[893,718,.16576557078065143],[894,717,.0842842699121286],[894,718,.3380651956328206],[894,719,.41539944734620887],[894,720,.16225102525634236],[895,719,.0877948008176482],[895,720,.3403113543186734],[895,721,.41189266310148215],[895,722,.1600022226324315],[896,721,.09004108530992379],[896,722,.3413074246800344],[896,723,.4096499531105413],[896,724,.15900348863810745],[897,723,.0910388030604564],[897,724,.341068811820455],[897,725,.4086556883871424],[897,726,.15923946457791555],[898,725,.09080331723824445],[898,726,.33961061119156805],[898,727,.40889455345709996],[898,728,.16069509855546693],[899,727,.08934968333179105],[899,728,.33694761720865024],[899,729,.41035153766953336],[899,730,.1633556369851302],[900,729,.08669265767999552],[900,730,.33309433158306806],[900,731,.41301192679237225],[900,732,.16720661638248935],[901,731,.08284670572359325],[901,732,.32806497138102175],[901,733,.41686129488304347],[901,734,.17223385542154263],[902,733,.0778260099865808],[902,734,.3218734768206457],[902,735,.421885496422382],[902,736,.17842344724960524],[903,735,.07164447779930824],[903,736,.31453351881588426],[903,737,.42807065870301164],[903,738,.185761752049803],[904,737,.06431574877136567],[904,738,.3060585062772846],[904,739,.435403174462235],[904,740,.19423538984244326],[905,739,.05585320202451507],[905,740,.29646159317816856],[905,741,.4438696947508069],[905,742,.20383123351642937],[906,741,.04626996319383157],[906,742,.2857556853951481],[906,743,.4534571220289279],[906,744,.21453640208174513],[907,743,.03557891120608933],[907,744,.27395344733160587],[907,745,.4640838862781736],[907,746,.2259711147745072],[908,745,.02378916236694485],[908,746,.26064383557298154],[908,747,.4744097020055178],[908,748,.23741469023048611],[908,749,.0029874664482454345],[909,747,.010888485342882084],[909,748,.24524012825579347],[909,749,.47705262348683797],[909,750,.25146343127990345],[909,751,.018030374036361534],[910,750,.23051594568994063],[910,751,.4659638155007443],[910,752,.26789265476733026],[910,753,.034103962104678205],[911,752,.2157780537828917],[911,753,.4490488012027463],[911,754,.28394240197843773],[911,755,.051207169174446954],[912,754,.19869680451466967],[912,755,.4309201309554197],[912,756,.3010279740476113],[912,757,.06933596927309439],[913,756,.18059146729117878],[913,757,.4117775174928008],[913,758,.3191380672559441],[913,759,.08847923890660256],[914,758,.16147315955443303],[914,759,.3916318997027402],[914,760,.33826157637971177],[914,761,.10862604895508292],[915,760,.14135280401108383],[915,761,.37049402581791996],[915,762,.35838758963377015],[915,763,.12976565972904766],[916,762,.12024113359574008],[916,763,.34837445826725],[916,764,.3795053837685538],[916,765,.15188751617588445],[917,764,.0981486962833266],[917,765,.32528357838026745],[917,766,.40160441931520835],[917,767,.17498124323033803],[918,766,.07508585975635881],[918,767,.30123159095005636],[918,768,.42467433597326765],[918,769,.19903664130457108],[919,768,.05106281593203439],[919,769,.2762285286588279],[919,770,.4480441892579001],[919,771,.22091817857346802],[920,770,.02605116606412028],[920,771,.24679268601046497],[920,772,.4613333588465915],[920,773,.24636316696152993],[920,774,.026661594315488448],[921,772,.00017143112777602207],[921,773,.22016507993495968],[921,774,.4450006731455823],[921,775,.27654268563105877],[921,776,.05450703342817279],[922,775,.19537707282293476],[922,776,.4169980825615683],[922,777,.3043455873211709],[922,778,.08322496813649063],[923,777,.16671893224886847],[923,778,.3873911007134449],[923,779,.333032487802997],[923,780,.11284587069811512],[924,779,.1371380798307044],[924,780,.3568813039463011],[924,781,.36262258254682433],[924,782,.14336176762117853],[925,781,.10666365535341012],[925,782,.32548606626333626],[925,783,.39310680323983005],[925,784,.17476372572452537],[926,783,.07530458232966944],[926,784,.2932141772790525],[926,785,.4235343782302751],[926,786,.20429957725699868],[927,785,.04297407877416276],[927,786,.2566282342451322],[927,787,.44609730979381396],[927,788,.23600300007995265],[927,789,.023774697332874434],[928,787,.00973561058609779],[928,788,.22213324067090034],[928,789,.4366882593279592],[928,790,.27231575108916795],[928,791,.058813271383982776],[929,790,.1899112794795718],[929,791,.4051174305988943],[929,792,.3087329260703045],[929,793,.09459113946159277],[930,792,.15536737862587172],[930,793,.36909687837539557],[930,794,.3443998634306182],[930,795,.13113054742980831],[931,794,.11887833690004168],[931,795,.3317399346424034],[931,796,.3809015150071346],[931,797,.1684974582828263],[932,796,.08156315084174257],[932,797,.29356399783457987],[932,798,.4168389957384664],[932,799,.2027189344423823],[933,798,.043285265762028874],[933,799,.2496929999720567],[933,800,.44089395742648096],[933,801,.24052352812737388],[933,802,.03507425254057242],[934,800,.0043335535351657515],[934,801,.21027601904641954],[934,802,.42143856683278325],[934,803,.2844016743443022],[934,804,.07585590645285804],[935,803,.17353832434253885],[935,804,.38262846297038483],[935,805,.3257498632562316],[935,806,.11730189433403454],[936,805,.13268775789077444],[936,806,.3407519309130924],[936,807,.3670972990020704],[936,808,.15947396875496164],[937,807,.09057464650490143],[937,808,.2978183751219168],[937,809,.40749895190525254],[937,810,.19795010289674397],[938,809,.0474866463063797],[938,810,.24850494279526708],[938,811,.4346436181876547],[938,812,.2403211224239381],[938,813,.04014881320170647],[939,811,.003878639500178961],[939,812,.2047038150773143],[939,813,.41157455841171137],[939,814,.28957529821809164],[939,815,.08560320920592149],[940,814,.16385621221760913],[940,815,.36828320787286745],[940,816,.33550406688664397],[940,817,.13164677712134118],[941,816,.11836297424309958],[941,817,.32185871977911545],[941,818,.3799973298161782],[941,819,.17581896778117206],[942,818,.07143918326167292],[942,819,.2705029465809176],[942,820,.4180894904987747],[942,821,.22040151023922497],[942,822,.023261093492508676],[943,820,.023754358875460287],[943,821,.22082957274806367],[943,822,.41735892037093947],[943,823,.26975946681527463],[943,824,.07244459405934162],[944,823,.17462856886910824],[944,824,.376380003235797],[944,825,.32258384746152186],[944,826,.12234695850241085],[945,825,.12764964491952732],[945,826,.32754202842781277],[945,827,.3705351976091778],[945,828,.17002290467196218],[946,827,.07705703864783364],[946,828,.27228373423426855],[946,829,.4119493110954956],[946,830,.21796235075295245],[946,831,.024608216085607083],[947,829,.025780053026113373],[947,830,.2190518649272109],[947,831,.41169318411556594],[947,832,.27077590916361477],[947,833,.07732052594065236],[948,832,.1695115580680664],[948,833,.36773423672329814],[948,834,.3275311475162098],[948,835,.13077893984001213],[949,834,.11922966876699366],[949,835,.31565346594837984],[949,836,.37813100062036553],[949,837,.17991281790206778],[950,836,.06510103041600655],[950,837,.25463712967072577],[950,838,.4162975451493948],[950,839,.23222690463246418],[950,840,.043347365043106205],[951,838,.010682336294089382],[951,839,.20025854636251755],[951,840,.3947874901107556],[951,841,.2917173663646273],[951,842,.09950708368621437],[952,841,.14911244770443477],[952,842,.3431424199239878],[952,843,.3480530442639449],[952,844,.15411315971947762],[953,843,.0934299055238343],[953,844,.2830893937829872],[953,845,.3971235804951196],[953,846,.20716078374370134],[953,847,.020137203526012115],[954,845,.036025540013401365],[954,846,.22261124110739972],[954,847,.40630997808531094],[954,848,.2648205963423913],[954,849,.07872881878459281],[955,848,.16692727676480973],[955,849,.35954874836594064],[955,850,.328443108696204],[955,851,.13751082396144756],[956,850,.11152248261980105],[956,851,.3006327942159715],[956,852,.3829521945790107],[956,853,.1916328343080391],[956,854,.0076262937092498664],[957,852,.0514953905500914],[957,853,.2343500090068106],[957,854,.41021535649217705],[957,855,.25030428726128284],[957,856,.06835964516566889],[958,855,.17563114080501685],[958,856,.3667504924135684],[958,857,.31835263030310357],[958,858,.1299663000321827],[959,857,.11940718803292909],[959,858,.3065438045294419],[959,859,.37569491987401304],[959,860,.18605528589059708],[959,861,.004834820768368334],[960,859,.05684866493974193],[960,860,.2366688077210537],[960,861,.4085057240274029],[960,862,.24678375999468344],[960,863,.06783571840441664],[961,862,.17558642045742334],[961,863,.36451985113857055],[961,864,.3173137388508224],[961,865,.13129392160626782],[962,864,.11725721455632943],[962,865,.3008194332920608],[962,866,.37580301677160466],[962,867,.19024874552861262],[962,868,.011245575393110812],[963,866,.05231298976932004],[963,867,.23017401181136463],[963,868,.40175554736854613],[963,869,.2536595659979476],[963,870,.07679940668774121],[964,869,.16706057585212106],[964,870,.35303258747063304],[964,871,.3251768586309606],[964,872,.14116418004635392],[965,871,.10550294433561781],[965,872,.28424844668945237],[965,873,.38249269088982873],[965,874,.2036626805762719],[965,875,.02684871916582402],[966,873,.03836058116912999],[966,874,.21480488879977247],[966,875,.389260042863657],[966,876,.27095452974310497],[966,877,.09504101254228686],[967,876,.1502807743955375],[967,877,.3328577086192332],[967,878,.3421239629983485],[967,879,.15918522100542254],[968,878,.08474515454977341],[968,879,.25820758590913884],[968,880,.3938397310124852],[968,881,.22523159171338067],[968,882,.05190695217080459],[969,880,.015820211753405387],[969,881,.19007905592596833],[969,882,.36921246833932636],[969,883,.2980889913883655],[969,884,.12132017371569158],[970,883,.1247775639085626],[970,884,.3015570552958629],[970,885,.36552163552482225],[970,886,.18684713857492927],[970,887,.014284415706242481],[971,885,.055013622481818666],[971,886,.2263705108609403],[971,887,.39186593267986564],[971,888,.2561333080985603],[971,889,.08592049273991473],[972,888,.1575841200944441],[972,889,.3370827060887002],[972,890,.33284859953655166],[972,891,.15390042438231766],[973,890,.08972988049108406],[973,891,.2590326783958039],[973,892,.38812639016604245],[973,893,.22348813860080616],[973,894,.054161074977768404],[974,892,.017081968749935856],[974,893,.18740927170107446],[974,894,.3625874079443392],[974,895,.2990263270079478],[974,896,.12613079428882987],[975,895,.11819045745461297],[975,896,.28905735771716573],[975,897,.36789499357104777],[975,898,.19628130377264577],[975,899,.02735424128922767],[976,897,.04494375361325131],[976,898,.21330043570426716],[976,899,.37902147922066165],[976,900,.2697531768133337],[976,901,.10241904377888808],[977,900,.14130067843136315],[977,901,.3150246804904708],[977,902,.3480110183643501],[977,903,.1725701388645175],[977,904,.005966983373903607],[978,902,.06884101502859519],[978,903,.23351128359258333],[978,904,.3898863909020141],[978,905,.24593198700119934],[978,906,.08224765045066],[979,905,.1597942440306211],[979,906,.3346851109670727],[979,907,.3285973743088808],[979,908,.15444027476874822],[980,907,.08792661347585409],[980,908,.2508895640647832],[980,909,.38533070676895603],[980,910,.22893712756876922],[980,911,.06583953763953361],[981,909,.01060737785460527],[981,910,.17530908392596897],[981,911,.34707093920704996],[981,912,.3101853041457825],[981,913,.1404924603408273],[982,912,.1016482122325276],[982,913,.2640331008343238],[982,914,.3757885914855772],[982,915,.21658719088481612],[982,916,.05379076081392352],[983,914,.023321537452804155],[983,915,.1869789080592518],[983,916,.35433193126746176],[983,917,.2960976478285003],[983,918,.13047091456929613],[984,917,.11086010315035294],[984,918,.272590889791831],[984,919,.3683410258652817],[984,920,.20801518542415245],[984,921,.04616290894518408],[985,919,.03202626907959427],[985,920,.1942489952348069],[985,921,.35801621736570555],[985,922,.2871844809716754],[985,923,.12448425960359358],[986,922,.11614980664040801],[986,923,.2769245860037902],[986,924,.3634503371272694],[986,925,.20337777894188264],[986,926,.04278533591281287],[987,924,.036633170664026604],[987,925,.19735437260885233],[987,926,.3585975660673821],[987,927,.28298312203941667],[987,928,.12237172260813765],[988,927,.11761764880185657],[988,928,.2769347836061358],[988,929,.3613222869658947],[988,930,.20269252495682932],[988,931,.04352084243134597],[989,929,.03715658569409518],[989,930,.19646584076452728],[989,931,.3563193376763676],[989,932,.28325914825402143],[989,933,.12401877287718965],[990,932,.11535841088563661],[990,933,.2726772185957825],[990,934,.36193002492598775],[990,935,.2058724789923987],[990,936,.04828585408934835],[991,934,.03368059076582972],[991,935,.19166681871807822],[991,936,.35120102320155516],[991,937,.2879669101334489],[991,938,.12934311950798513],[992,937,.10947528483272252],[992,938,.2643619456949593],[992,939,.36503164238003943],[992,940,.21273290367631378],[992,941,.05704255868679827],[993,939,.026351338857843194],[993,940,.18296002570453515],[993,941,.3430562989307297],[993,942,.29724916938947604],[993,943,.13830626997954892],[994,942,.10006782116457263],[994,943,.2523219642979947],[994,944,.3701807952606593],[994,945,.22297333198451888],[994,946,.06976592160365215],[995,944,.015392306252147629],[995,945,.17030051412165803],[995,946,.33152253946088156],[995,947,.31147369956054877],[995,948,.1509473916728322],[996,947,.087196881644584],[996,948,.2369586950063475],[996,949,.376718339613223],[996,950,.2345765114615184],[996,951,.08521591343298078],[997,949,.0011357385555340561],[997,950,.15263475001807864],[997,951,.311827742306229],[997,952,.32860504822914505],[997,953,.16942021655341175],[997,954,.016626147439510436],[998,952,.07024774813594223],[998,953,.2212622403680772],[998,954,.36621398307130515],[998,955,.2523140266095425],[998,956,.10329850546808812],[999,955,.13345393361930616],[999,956,.2868146645965228],[999,957,.3438149621043634],[999,958,.19052159754051476],[999,959,.038598535306774456],[1e3,957,.04874340776161587],[1e3,958,.20027433884645776],[1e3,959,.35045072214288214],[1e3,960,.2752172040116266],[1e3,961,.1246081801436533],[1001,960,.11153410463061227],[1001,961,.25968030157128735],[1001,962,.3589611456155988],[1001,963,.21376355164890676],[1001,964,.06462574300561937],[1002,962,.024112239164856285],[1002,963,.1744379670887302],[1002,964,.32884307142135794],[1002,965,.3038963549633426],[1002,966,.14989396525089382],[1002,967,.002787631885767016],[1003,965,.08652179776851913],[1003,966,.23158274748299973],[1003,967,.37014802862444746],[1003,968,.23660182809114255],[1003,969,.09233857620429504],[1004,968,.14320871996140178],[1004,969,.2949268298641504],[1004,970,.33370967770704096],[1004,971,.1821563205430922],[1004,972,.03341416685633306],[1005,970,.05691996613850173],[1005,971,.2048164607341282],[1005,972,.34996958396767003],[1005,973,.26846185022737096],[1005,974,.12203613352843197],[1006,973,.11270360292617912],[1006,974,.2573174820670815],[1006,975,.35551075517876596],[1006,976,.21342439841857963],[1006,977,.06808655521031844],[1007,975,.02300584415020569],[1007,976,.1693741701851818],[1007,977,.31909197071849676],[1007,978,.3064750144925845],[1007,979,.1569666027177789],[1007,980,.01237576860780718],[1008,978,.07918600624195261],[1008,979,.22224585329482],[1008,980,.36060022658704466],[1008,981,.24542280629144228],[1008,982,.10372340547250797],[1009,981,.13025049048804305],[1009,982,.2755544084078468],[1009,983,.34173289952302016],[1009,984,.19757209548510224],[1009,985,.052414383405106256],[1010,983,.04055057399599624],[1010,984,.18602861646793578],[1010,985,.3325126760154172],[1010,986,.28836807114447566],[1010,987,.1417402962688462],[1010,988,.0007268068329768394],[1011,986,.0921230324039655],[1011,987,.23132424535108578],[1011,988,.3651955312519228],[1011,989,.23251096307120944],[1011,990,.09383068210249161],[1012,989,.1395300348660987],[1012,990,.2846106560560243],[1012,991,.33325384799782276],[1012,992,.18901293891606955],[1012,993,.045352651706964286],[1013,991,.0492531143811913],[1013,992,.19272260635298227],[1013,993,.33561458168523745],[1013,994,.27986377343343843],[1013,995,.13637852619084528],[1014,994,.09650852938196901],[1014,995,.2338020594070448],[1014,996,.36193613166585775],[1014,997,.22898317334607854],[1014,998,.09193468643195023],[1015,996,.002457496874436509],[1015,997,.14093777570167637],[1015,998,.28368384860268375],[1015,999,.33027760738271117],[1015,1e3,.1884400273628213],[1015,1001,.046968846655108074],[1016,999,.04899295849310335],[1016,1e3,.19034003312195327],[1016,1001,.3313219755276299],[1016,1002,.28105052006571385],[1016,1003,.13948843868730657],[1016,1004,.0023949943264103815],[1017,1002,.09296476581718328],[1017,1003,.22852898102309294],[1017,1004,.35981389159869226],[1017,1005,.23289594529521537],[1017,1006,.09793041579114306],[1018,1005,.13381394889325862],[1018,1006,.27358691892030107],[1018,1007,.33460745416509985],[1018,1008,.1955825556102765],[1018,1009,.05665143264068217],[1019,1007,.040361378819567154],[1019,1008,.17925977203170015],[1019,1009,.31806447498945245],[1019,1010,.2909077306146313],[1019,1011,.1516962543781077],[1019,1012,.01525050343287846],[1020,1010,.08150854362929537],[1020,1011,.21698349128246774],[1020,1012,.3497669475500838],[1020,1013,.24583808157633427],[1020,1014,.11136370502634059],[1021,1013,.1194990282921764],[1021,1014,.25479878825131264],[1021,1015,.34346022054644576],[1021,1016,.20933239464254857],[1021,1017,.07400664151417581],[1022,1015,.023670383811016393],[1022,1016,.1594303860158249],[1022,1017,.29640289279632487],[1022,1018,.3088876485347881],[1022,1019,.17249814489158258],[1022,1020,.03643709112995095],[1023,1018,.062217701784737935],[1023,1019,.19815982330648652],[1023,1020,.3337745723213922],[1023,1021,.3700921432339217],[1023,1022,.3700921432339217]];function l(){const t=i.buffer([1024,1024]);for(let e=0;e<c.length;e++){const n=c[e];t.set(n[2],n[0],n[1])}return t.toTensor()}function u(t,e,n){return i.div(i.sub(t,n),e)}async function h(t){const e=i.tidy((()=>{const e=i.slice(t,[0,0,0,0],[1,-1,-1,1]).reshape([1,128,1024]),n=(r=e,i.tidy((()=>{const t=l().expandDims(0),e=u(r,.0661371661726,.113718730221),n=i.exp(e),s=i.matMul(n,t);return i.sqrt(s)})));var r;const s=function(t){return i.tidy((()=>{const e=l().expandDims(0),n=u(t,.8,0),r=i.cumsum(i.mul(n,Math.PI),1);return i.matMul(r,e)}))}(i.slice(t,[0,0,0,1],[1,-1,-1,1]).reshape([1,128,1024]));let o=n.mul(i.cos(s));const a=i.reverse(o.slice([0,0,0],[1,128,1023]),2);o=i.concat([o,a],2);let c=n.mul(i.sin(s));const h=i.reverse(c.slice([0,0,0],[1,128,1023]),2);return c=i.concat([c,i.mul(h,-1)],2),[o,c]})),n=await function(t,e){const n=i.tidy((()=>{let n=i.concat([t,e],0).expandDims(3);return n=i.pad(n,[[0,0],[0,0],[1,0],[0,0]]),i.batchToSpaceND(n,[1,2],[[0,0],[0,0]]).reshape([128,4096])})),r=n.dataSync(),s=[];for(let i=0;i<128;i++)s[i]=r.slice(4096*i,4096*(i+1));return n.dispose(),s}(e[0],e[1]),r=await async function(t){return function(t,e){const n=t.length,i=t[0].length/2,r=e.winLength||i,s=e.hopLength||Math.floor(r/4),o=e.center||!1;let c=Object(a.b)(r);for(let a=0;a<c.length;a++)c[a]=c[a]/1.5;c=Object(a.h)(c,i);const l=i+s*(n-1),u=new Float32Array(l);for(let m=0;m<n;m++){const e=m*s;let n=d(t[m]);n=Object(a.a)(n,c),n=p(n,u.slice(e,e+i)),u.set(n,e)}let h=0,f=l;return o?(h=i/2,f=u.length-i/2):(h=l-64e3,f=u.length-h),u.slice(h,f)}(t,{nFFt:2048,winLength:2048,hopLength:512,sampleRate:16e3,center:!1})}(n);return e.forEach((t=>t.dispose())),r}function d(t){const e=t.length/2,n=new o(e),i=n.createComplexArray();return n.inverseTransform(i,t),n.fromComplexArray(i)}function p(t,e){if(t.length!==e.length)return console.error("Array lengths must be equal to add: ".concat(t.length,", ").concat(t.length)),null;const n=new Float32Array(t.length);for(let i=0;i<t.length;i++)n[i]=t[i]+e[i];return n}class f extends i.layers.Layer{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this.epsilon=t,this.layerConfig=e,this.supportsMasking=!0}computeOutputShape(t){return[t[0],t[1],t[2],t[3]]}call(t){return i.tidy((()=>{let e=t;Array.isArray(e)&&(e=e[0]);const n=i.mean(i.square(e),[3],!0);return i.mul(e,i.rsqrt(i.add(n,this.epsilon)))}))}getClassName(){return"PixelNorm"}}function m(){return new f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-8,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}class g extends i.layers.Layer{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(n),this.kernelH=t,this.kernelW=e,this.layerConfig=n,this.supportsMasking=!0}computeOutputShape(t){return[t[0],2*(this.kernelH-1)+t[1],2*(this.kernelW-1)+t[2],t[3]]}call(t){let e=t;Array.isArray(e)&&(e=e[0]);const n=this.kernelH-1,r=this.kernelW-1;return i.pad(e,[[0,0],[n,n],[r,r],[0,0]])}getClassName(){return"InitialPad"}}class v extends i.layers.Layer{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;super({}),this.scale=t,this.supportsMasking=!0}computeOutputShape(t){return[t[0],this.scale*t[1],this.scale*t[2],t[3]]}call(t){return i.tidy((()=>{let e=t;Array.isArray(e)&&(e=e[0]);const n=i.tile(e,[this.scale**2,1,1,1]);return i.batchToSpaceND(n,[this.scale,this.scale],[[0,0],[0,0]])}))}getClassName(){return"BoxUpscale"}}function y(){return new v(arguments.length>0&&void 0!==arguments[0]?arguments[0]:2)}class x{constructor(t){this.nn=i.sequential(),this.nLatents=256,this.nPitches=61,this.minMidiPitch=24,this.maxMidiPitch=84,this.midiPitches=this.maxMidiPitch-this.minMidiPitch+1,this.checkpointURL=t}async initialize(){const t=s.d.now(),e=await Object(s.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>i.io.loadWeights(t,this.checkpointURL)));i.tidy((()=>{for(const t in e)if(t.includes("kernel")){const n=e[t].shape[0]*e[t].shape[1]*e[t].shape[2],r=e[t];e[t]=i.mul(r,i.sqrt(2/n)),r.dispose()}this.build(e),this.initialized=!0,r.logWithDuration("Initialized model",t,"GANSynth")})),Object.keys(e).map((t=>e[t].dispose()))}dispose(){this.initialized&&(this.nn.dispose(),this.initialized=!1)}isInitialized(){return this.initialized}build(t){i.tidy((()=>{const e={filters:256,kernelSize:[2,16],strides:[1,1],activation:"linear",useBias:!0,padding:"valid",dilationRate:[1,1],trainable:!1},n={inputShape:[1,1,this.nLatents+this.nPitches]};this.nn.add(m(1e-8,n)),this.nn.add(function(){return new g(arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(2,16)),this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.leakyReLU({alpha:.2})),this.nn.add(m()),e.padding="same",e.kernelSize=[3,3],this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.leakyReLU({alpha:.2})),this.nn.add(m());const r=[256,256,256,128,64,32];for(let t=0;t<r.length;t++)this.nn.add(y(2)),e.filters=r[t],this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.leakyReLU({alpha:.2})),this.nn.add(m()),this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.leakyReLU({alpha:.2})),this.nn.add(m());e.filters=2,e.kernelSize=[1,1],e.activation="tanh",this.nn.add(i.layers.conv2d(e)),this.setWeights(t)}))}setWeights(t){function e(e){const n=t[e];if(void 0===n)throw Error("Variable not found: "+e);return n}const n="Generator/progressive_gan_generator/progressive_gan_block_",i=[e(n+"1/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"1/conv0/bias/ExponentialMovingAverage"),e(n+"1/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"1/conv1/bias/ExponentialMovingAverage"),e(n+"2/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"2/conv0/bias/ExponentialMovingAverage"),e(n+"2/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"2/conv1/bias/ExponentialMovingAverage"),e(n+"3/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"3/conv0/bias/ExponentialMovingAverage"),e(n+"3/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"3/conv1/bias/ExponentialMovingAverage"),e(n+"4/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"4/conv0/bias/ExponentialMovingAverage"),e(n+"4/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"4/conv1/bias/ExponentialMovingAverage"),e(n+"5/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"5/conv0/bias/ExponentialMovingAverage"),e(n+"5/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"5/conv1/bias/ExponentialMovingAverage"),e(n+"6/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"6/conv0/bias/ExponentialMovingAverage"),e(n+"6/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"6/conv1/bias/ExponentialMovingAverage"),e(n+"7/conv0/conv2d/kernel/ExponentialMovingAverage"),e(n+"7/conv0/bias/ExponentialMovingAverage"),e(n+"7/conv1/conv2d/kernel/ExponentialMovingAverage"),e(n+"7/conv1/bias/ExponentialMovingAverage"),e(n+"7/to_rgb/conv2d/kernel/ExponentialMovingAverage"),e(n+"7/to_rgb/bias/ExponentialMovingAverage")];this.nn.setWeights(i)}predict(t,e){return this.nn.predict(t,{batchSize:e})}randomSample(t){return i.tidy((()=>{const e=i.randomNormal([1,this.nLatents],0,1,"float32"),n=i.tensor1d([t-this.minMidiPitch],"int32"),r=i.oneHot(n,this.midiPitches),s=i.concat([e,r],1).expandDims(1).expandDims(1);return this.predict(s,1)}))}specgramsToAudio(t){return h(t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"OnsetsAndFrames",(function(){return l}));var i=n(2),r=n(20),s=n(12),o=n(15),a=n(10);function c(t,e,n){return 1===t.shape[0]?t:i.tidy((()=>{const r=t.slice([0,0],[1,e]);let s=n%e;s<=3&&(s+=e);const o=t.slice([t.shape[0]-1,t.shape[1]-s],[-1,-1]);let a=[r,o];if(t.shape[0]>2){const n=t.shape[0]-2;a=[r,t.slice([1,3],[n,e]).as3D(1,n*e,-1),o]}return i.concat(a,1)}))}class l{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;this.checkpointURL=t,this.chunkLength=e}async initialize(){this.dispose();const t=o.d.now(),e=await Object(o.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>i.io.loadWeights(t,this.checkpointURL)));this.build(e),Object.keys(e).map((t=>e[t].dispose())),this.initialized=!0,s.logWithDuration("Initialized model",t,"O&F")}dispose(){this.initialized&&(this.onsetsCnn.dispose(),this.onsetsRnn.dispose(),this.activationCnn.dispose(),this.frameRnn.dispose(),this.velocityCnn.dispose(),this.initialized=!1)}isInitialized(){return this.initialized}async transcribeFromMelSpec(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;this.isInitialized()||this.initialize();const n=o.d.now();s.log("Computing onsets, frames, and velocities...","O&F",20);const[r,c,l]=i.tidy((()=>{const n=function(t,e){let n=Math.ceil(t.length/e),r=t.length%e,s=0;if(n>1&&r>0&&r<=3&&(n-=1,s=r,r=0),1===n)return i.tensor2d(t).expandDims(0);const o=e+6,a=i.tensor2d(t.slice(0,o)).expandDims(0),c=i.tensor2d(t.slice(t.length-o)).expandDims(0);if(2===n)return i.concat([a,c],0);let l;l=r?i.tensor2d(t).pad([[0,e-r],[0,0]]).as3D(n,e,-1):i.tensor2d(t.slice(0,t.length-s)).as3D(n,e,-1);const u=i.slice(l,[0,e-3],[n-2,-1]),h=i.slice(l,[2,0],[-1,3]),d=i.concat([u,l.slice(1,n-2),h],1);return i.concat([a,d,c],0)}(t,this.chunkLength);return this.processBatches(n,this.chunkLength,t.length,e)}));s.log("Converting to NoteSequence...","O&F",20);const u=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const o=a.a.create(),c=new Uint32Array(88),l=new Uint8Array(88);let u=new Uint8Array(88);function h(t,e){o.notes.push(a.a.Note.create({pitch:t+21,startTime:.032*(c[t]-1),endTime:.032*e,velocity:l[t]})),c[t]=0}function d(t,e,n){c[t]?u[t]||(h(t,e),c[t]=e+1,l[t]=n):(c[t]=e+1,l[t]=n)}const p=i.tidy((()=>{let o=i.greater(e,r),a=i.greater(t,s);return o=o.pad([[0,1],[0,0]]),a=a.pad([[0,1],[0,0]]),n=n.pad([[0,1],[0,0]]),a=i.logicalOr(a,o),[a,o,n]})),[f,m,g]=await Promise.all(p.map((t=>t.data())));p.forEach((t=>t.dispose()));const v=t.shape[0];for(let i=0;i<v+1;++i){for(let t=0;t<88;++t){const e=88*i+t;m[e]?d(t,i,g[e]):!f[e]&&c[t]&&h(t,i)}u=m.slice(88*i,88*(i+1))}return o.totalTime=.032*v,o}(r,c,l);return u.then((()=>{r.dispose(),c.dispose(),l.dispose(),s.logWithDuration("Transcribed from mel spec",n,"O&F")})),u}async transcribeFromAudioBuffer(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=o.d.now(),i=async function(t){const e=await Object(r.j)(t);return Object(r.i)(Object(r.f)(e,{sampleRate:16e3,hopLength:512,nMels:229,nFft:2048,fMin:30}))}(t);return i.then((()=>s.logWithDuration("Converted audio to mel spec",n,"O&F",20))),i.then((t=>this.transcribeFromMelSpec(t.map((t=>Array.from(t)),e))))}async transcribeFromAudioFile(t){const e=await Object(r.d)(t);return this.transcribeFromAudioBuffer(e)}async transcribeFromAudioURL(t){const e=await Object(r.e)(t);return this.transcribeFromAudioBuffer(e)}processBatches(t,e,n,r){const s=t=>[this.onsetsCnn.predict(t,r),this.activationCnn.predict(t,r),this.velocityCnn.predict(t,r)];let o,a,l;if(1===t.shape[0])[o,a,l]=s(t.expandDims(-1));else{const i=s(t.expandDims(-1)),r=[];for(let t=0;t<3;++t)r.push(c(i[t],e,n));[o,a,l]=r}const u=this.onsetsRnn.predict(o,this.chunkLength);o.dispose();const h=i.concat3d([u,a],-1);a.dispose();const d=this.frameRnn.predict(h,this.chunkLength),p=i.clipByValue(l,0,1).mul(i.scalar(80)).add(i.scalar(10)).toInt();return l.dispose(),[d.squeeze(),u.squeeze(),p.squeeze()]}build(t){i.tidy((()=>{this.onsetsCnn=new u,this.onsetsCnn.setWeights(t,"onsets"),this.onsetsRnn=new h([null,this.onsetsCnn.outputShape[2]]),this.onsetsRnn.setWeights(t,"onsets","onset_probs"),this.activationCnn=new u("sigmoid"),this.activationCnn.setWeights(t,"frame","activation_probs"),this.frameRnn=new h([null,176]),this.frameRnn.setWeights(t,"frame","frame_probs"),this.velocityCnn=new u("linear"),this.velocityCnn.setWeights(t,"velocity","onset_velocities")}))}}class u{constructor(t){this.nn=i.sequential();const e={filters:48,kernelSize:[3,3],activation:"linear",useBias:!1,padding:"same",dilationRate:[1,1],inputShape:[null,229,1],trainable:!1},n={scale:!1,trainable:!1};this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.batchNormalization(n)),this.nn.add(i.layers.activation({activation:"relu"})),e.inputShape=null,this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.batchNormalization(n)),this.nn.add(i.layers.activation({activation:"relu"})),this.nn.add(i.layers.maxPooling2d({poolSize:[1,2],strides:[1,2]})),e.filters=96,this.nn.add(i.layers.conv2d(e)),this.nn.add(i.layers.batchNormalization(n)),this.nn.add(i.layers.activation({activation:"relu"})),this.nn.add(i.layers.maxPooling2d({poolSize:[1,2],strides:[1,2]}));const r=this.nn.outputShape;this.nn.add(i.layers.reshape({targetShape:[r[1],r[2]*r[3]]})),this.nn.add(i.layers.dense({units:768,activation:"relu",trainable:!1})),t&&this.nn.add(i.layers.dense({units:88,activation:t,trainable:!1})),this.outputShape=this.nn.outputShape}dispose(){this.nn.dispose()}predict(t,e){return this.nn.predict(t,{batchSize:e})}setWeights(t,e,n){function i(e){const n=t[e];if(void 0===n)throw Error("Variable not found: "+e);return n}let r=[i(e+"/conv0/weights"),i(e+"/conv0/BatchNorm/beta"),i(e+"/conv0/BatchNorm/moving_mean"),i(e+"/conv0/BatchNorm/moving_variance"),i(e+"/conv1/weights"),i(e+"/conv1/BatchNorm/beta"),i(e+"/conv1/BatchNorm/moving_mean"),i(e+"/conv1/BatchNorm/moving_variance"),i(e+"/conv2/weights"),i(e+"/conv2/BatchNorm/beta"),i(e+"/conv2/BatchNorm/moving_mean"),i(e+"/conv2/BatchNorm/moving_variance"),i(e+"/fc_end/weights"),i(e+"/fc_end/biases")];n&&(r=r.concat([i("".concat(e,"/").concat(n,"/weights")),i("".concat(e,"/").concat(n,"/biases"))])),this.nn.setWeights(r)}}class h{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:384;this.dense=i.sequential(),this.units=e,this.lstm=function(){const n=i.layers.lstm({inputShape:t,units:e,returnSequences:!0,recurrentActivation:"sigmoid",returnState:!0,kernelInitializer:"zeros",recurrentInitializer:"zeros",biasInitializer:"zeros",trainable:!1}),r=[i.input({shape:t}),i.input({shape:[e]}),i.input({shape:[e]})],s=n.apply(r);return i.model({inputs:r,outputs:s})}(),this.dense.add(i.layers.dense({inputShape:[null,e],units:88,activation:"sigmoid",trainable:!1}))}dispose(){this.lstm.dispose(),this.dense.dispose()}setWeights(t,e,n){function r(e){const n=t[e];if(void 0===n)throw Error("Variable not found: "+e);return n}const s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[n,r,s,o]=i.split(t,4,-1);return i.concat([n,s.add(i.scalar(e)),r,o],-1)},o="cudnn_lstm/rnn/multi_rnn_cell/cell_0/cudnn_compatible_lstm_cell";this.lstm.setWeights((t=>i.split(s(t),[t.shape[0]-this.units,this.units]))(r("".concat(e,"/").concat(o,"/kernel"))).concat(s(r("".concat(e,"/").concat(o,"/bias")),1))),this.dense.setWeights([r("".concat(e,"/").concat(n,"/weights")),r("".concat(e,"/").concat(n,"/biases"))])}predict(t,e){return i.tidy((()=>this.predictImpl(t,e)))}predictImpl(t,e){const n=t.shape[1],r=Math.ceil(n/e);let s=[i.zeros([1,this.units]),i.zeros([1,this.units])];const o=[];for(let i=0;i<r;++i){const n=t.slice([0,i*e],[-1,i<r-1?e:-1]),a=this.lstm.predict([n,s[0],s[1]]);o.push(this.dense.predict(a[0])),s=a.slice(1)}return 1===o.length?o[0]:i.concat3d(o,1)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"Coconet",(function(){return h}));var i=n(0),r=n(15),s=n(12),o=n(13),a=n(10);const c=/iPad|iPhone|iPod/.test(navigator.userAgent),l={useSoftmaxLoss:!0,batchNormVarianceEpsilon:1e-7,numInstruments:4,numFilters:128,numLayers:33,numRegularConvLayers:0,dilation:[[1,1],[2,2],[4,4],[8,8],[16,16],[16,32],[1,1],[2,2],[4,4],[8,8],[16,16],[16,32],[1,1],[2,2],[4,4],[8,8],[16,16],[16,32],[1,1],[2,2],[4,4],[8,8],[16,16],[16,32],[1,1],[2,2],[4,4],[8,8],[16,16],[16,32]],layers:null,interleaveSplitEveryNLayers:16,numPointwiseSplits:4};class u{constructor(t,e){this.residualPeriod=2,this.outputForResidual=null,this.residualCounter=-1,this.rawVars=null,this.spec=t,this.rawVars=e}dispose(){null!==this.rawVars&&i.gb(this.rawVars),this.outputForResidual&&this.outputForResidual.dispose()}predictFromPianoroll(t,e){return i.Hb((()=>{let n=this.getConvnetInput(t,e);const i=this.spec.layers.length;for(let t=0;t<i;t++){this.residualCounter+=1,this.residualSave(n);let e=null;this.spec.interleaveSplitEveryNLayers&&t>0&&t<i-2&&t%(this.spec.interleaveSplitEveryNLayers+1)==0&&(e=this.spec.numPointwiseSplits),n=this.applyConvolution(n,this.spec.layers[t],t,t>=this.spec.numRegularConvLayers,e),n=this.applyResidual(n,0===t,t===i-1,t),n=this.applyActivation(n,this.spec.layers[t],t),n=this.applyPooling(n,this.spec.layers[t],t)}return this.computePredictions(n)}))}computePredictions(t){return this.spec.useSoftmaxLoss?t.transpose([0,1,3,2]).softmax().transpose([0,1,3,2]):t.sigmoid()}residualReset(){this.outputForResidual=null,this.residualCounter=0}residualSave(t){this.residualCounter%this.residualPeriod==1&&(this.outputForResidual=t)}applyResidual(t,e,n,i){return null==this.outputForResidual?t:this.outputForResidual.shape[this.outputForResidual.shape.length-1]!==t.shape[t.shape.length-1]?(this.residualReset(),t):(this.residualCounter%this.residualPeriod==0&&(e||n||(t=t.add(this.outputForResidual))),t)}getVar(t,e){const n="model/conv".concat(e,"/").concat(t);return this.rawVars[n]}getSepConvVar(t,e){const n="model/conv".concat(e,"/SeparableConv2d/").concat(t);return this.rawVars[n]}getPointwiseSplitVar(t,e,n){const i="model/conv".concat(e,"/split_").concat(e,"_").concat(n,"/").concat(t);return this.rawVars[i]}applyConvolution(t,e,n,r,s){if(null==e.filters)return t;const o=e.filters,a=e.convStride||1,c=e.convPad?e.convPad.toLowerCase():"same";let l=null;if(r){const r=this.getSepConvVar("depthwise_weights",n);if(s){l=i.eb(t,r,[a,a],c,"NHWC",e.dilation);const u=i.Cb(l,s,l.rank-1),h=[];for(let t=0;t<s;t++){const e=o[3]/s,r=this.getPointwiseSplitVar("kernel",n,t),a=this.getPointwiseSplitVar("bias",n,t),c=i.mb(u[t].reshape([-1,e]),r,!1,!1),l=i.W(c,a);h.push(l.reshape([u[t].shape[0],u[t].shape[1],u[t].shape[2],e]))}l=i.bb(h,l.rank-1)}else{const s=this.getSepConvVar("pointwise_weights",n),o=this.getSepConvVar("biases",n);l=i.zb(t,r,s,[a,a],c,e.dilation,"NHWC").add(o)}}else{const r=this.getVar("weights",n),s=e.convStride||1,o=e.convPad?e.convPad.toLowerCase():"same";l=i.cb(t,r,[s,s],o,"NHWC",[1,1])}return this.applyBatchnorm(l,n)}applyBatchnorm(t,e){const n=this.getVar("gamma",e),r=this.getVar("beta",e),s=this.getVar("popmean",e),o=this.getVar("popvariance",e);if(c){const e=o.arraySync()[0][0][0],a=i.Gb(e.map((t=>Math.sqrt(t+this.spec.batchNormVarianceEpsilon))));return t.sub(s).mul(n.div(a)).add(r)}return i.Y(t,i.Db(s),i.Db(o),i.Db(r),i.Db(n),this.spec.batchNormVarianceEpsilon)}applyActivation(t,e,n){return"identity"===e.activation?t:t.relu()}applyPooling(t,e,n){if(null==e.pooling)return t;const r=e.pooling,s=e.poolPad?e.poolPad.toLowerCase():"same";return i.ob(t,[r[0],r[1]],[r[0],r[1]],s)}getConvnetInput(t,e){return t=i.yb(1,"float32").sub(e).mul(t),e=i.yb(1,"float32").sub(e),t.concat(e,3)}}class h{constructor(t){this.spec=null,this.initialized=!1,this.checkpointURL=t,this.spec=l}async initialize(){this.dispose();const t=r.d.now();this.instantiateFromSpec();const e=await Object(r.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>i.kb.loadWeights(t,this.checkpointURL)));this.convnet=new u(this.spec,e),this.initialized=!0,s.logWithDuration("Initialized model",t,"Coconet")}dispose(){this.convnet&&this.convnet.dispose(),this.initialized=!1}isInitialized(){return this.initialized}instantiateFromSpec(){this.spec.layers=[],this.spec.layers.push({filters:[3,3,2*this.spec.numInstruments,this.spec.numFilters]});for(let t=0;t<this.spec.numLayers-3;t++)this.spec.layers.push({filters:[3,3,this.spec.numFilters,this.spec.numFilters],dilation:this.spec.dilation?this.spec.dilation[t]:null});this.spec.layers.push({filters:[2,2,this.spec.numFilters,this.spec.numFilters]}),this.spec.layers.push({filters:[2,2,this.spec.numFilters,this.spec.numInstruments],activation:"identity"})}async infill(t,e){if(o.assertIsRelativeQuantizedSequence(t),0===t.notes.length)throw new Error("NoteSequence ".concat(t.id," does not have any notes to infill."));const n=t.totalQuantizedSteps||t.notes[t.notes.length-1].quantizedEndStep,r=function(t,e){const n=i.Hb((()=>i.Nb([e,46,4]).arraySync()));return t.notes.forEach((i=>{const r=i.pitch-36,o=i.quantizedStartStep,a=i.quantizedEndStep-i.quantizedStartStep,c=i.instrument;if(c<0||c>=4)s.log("Found invalid voice ".concat(c,". Skipping."),"Coconet",5);else{if(o+a>e)throw new Error("NoteSequence ".concat(t.id," has notes that are longer than the sequence's\n          totalQuantizedSteps."));for(let t=o;t<o+a;t++)n[t][r][c]=1}})),i.Gb([n])}(t,n);let c,l=.99,u=96;e?(u=e.numIterations||u,l=e.temperature||l,c=this.getCompletionMaskFromInput(e.infillMask,r)):c=this.getCompletionMask(r);const h=await this.run(r,u,l,c),d=function(t,e){const n=i.Hb((()=>t.reshape([e,46,4]).arraySync())),r=a.a.create(),s=[];for(let i=0;i<e;i++)for(let t=0;t<46;t++)for(let e=0;e<4;e++)if(1===n[i][t][e]){const n=a.a.Note.create({pitch:t+36,instrument:e,quantizedStartStep:i,quantizedEndStep:i+1});s.push(n)}return r.notes=s,r.totalQuantizedSteps=s[s.length-1].quantizedEndStep,r.quantizationInfo={stepsPerQuarter:4},r}(h,n);return r.dispose(),h.dispose(),c.dispose(),d}async run(t,e,n,i){return this.gibbs(t,e,n,i)}getCompletionMaskFromInput(t,e){if(t){const n=i.Z([e.shape[1],4]);for(let e=0;e<t.length;e++)n.set(1,t[e].step,t[e].voice);return i.Hb((()=>n.toTensor().expandDims(1).tile([1,46,1]).expandDims(0)))}return this.getCompletionMask(e)}getCompletionMask(t){return i.Hb((()=>{const e=t.sum(2,!0).equal(i.yb(0,"float32"));return i.ab(e,"float32").add(i.Ob(t))}))}async gibbs(t,e,n,r){const s=i.yb(e,"float32");let o=t.clone();for(let a=0;a<e;a++){const t=this.yaoSchedule(a,s),e=this.bernoulliMask(o.shape,t,r);await i.qb();const c=i.Hb((()=>this.convnet.predictFromPianoroll(o,e)));await i.qb(),o=i.Hb((()=>{const r=this.samplePredictions(c,n),s=i.Mb(i.ab(e,"bool"),r,o);return o.dispose(),c.dispose(),e.dispose(),t.dispose(),s})),await i.qb()}return s.dispose(),o}yaoSchedule(t,e){return i.Hb((()=>{const n=i.yb(.1,"float32"),r=i.yb(.9,"float32"),s=i.yb(.7,"float32"),o=r.sub(n).mul(i.yb(t,"float32")).div(e),a=r.sub(o).div(s);return n.reshape([1]).concat(a.reshape([1])).max()}))}bernoulliMask(t,e,n){return i.Hb((()=>{const[r,s,o,a]=t,c=i.Ib(i.tb([r,s,1,a],0,1,"float32"),[1,1,o,1]).less(e);return i.ab(c,"float32").mul(n)}))}samplePredictions(t,e){return i.Hb((()=>{t=i.sb(t,i.yb(1/e,"float32"));const n=i.db(t,2,!1,!1),r=n.slice([0,0,n.shape[2]-1,0],[n.shape[0],n.shape[1],1,n.shape[3]]),s=i.tb(r.shape,0,1,"float32").mul(r).less(n).argMax(2);return i.rb(s.flatten(),t.shape[2],1,0).reshape([t.shape[0],t.shape[1],t.shape[3],t.shape[2]]).transpose([0,1,3,2])}))}}},function(t,e,n){"use strict";n.r(e),n.d(e,"MusicRNN",(function(){return h}));var i=n(2),r=n(48),s=n(37),o=n(36),a=n(15),c=n(12),l=n(13);class u{constructor(t,e,n){this.cells=t,this.attnLength=e,this.attnSize=n}static isWrapped(t){return"rnn/attention_cell_wrapper/kernel"in t}initialize(t){const e="rnn/attention_cell_wrapper/";this.attnInputMatrix=t[e+"kernel"],this.attnInputBias=t[e+"bias"],this.attnW=t[e+"attention/attn_w"],this.attnV=t[e+"attention/attn_v"],this.attnMatrix=t[e+"attention/kernel"],this.attnBias=t[e+"attention/bias"],this.attnOutputMatrix=t[e+"attention_output_projection/kernel"],this.attnOutputBias=t[e+"attention_output_projection/bias"]}initState(){return{attention:i.zeros([this.attnSize]),attentionState:i.zeros([1,this.attnSize*this.attnLength])}}call(t,e,n,r){const s=i.concat([t,r.attention.as2D(1,-1)],1),o=i.add(i.matMul(s,this.attnInputMatrix),this.attnInputBias.as2D(1,-1));[e,n]=i.multiRNNCell(this.cells,o,e,n);const a=i.reshape(r.attentionState,[-1,this.attnLength,1,this.attnSize]),c=i.conv2d(a,this.attnW,[1,1],"same"),l=[];for(let i=0;i<e.length;i++)l.push(e[i]),l.push(n[i]);const u=i.concat(l,1),h=i.matMul(u,this.attnMatrix).reshape([-1,1,1,this.attnSize]),d=i.sum(i.mul(this.attnV,i.tanh(i.add(c,h))),[2,3]),p=i.softmax(d),f=i.sum(i.mul(i.reshape(p,[-1,this.attnLength,1,1]),a),[1,2]).reshape([-1,this.attnSize]),m=r.attentionState.reshape([-1,this.attnLength,this.attnSize]),g=i.slice(m,[0,1,0],[m.shape[0],m.shape[1]-1,m.shape[2]]),v=i.add(i.matMul(i.concat([n[2],f],1),this.attnOutputMatrix),this.attnOutputBias),y=f.flatten(),x=i.concat([g,v.as3D(v.shape[0],1,v.shape[1])],1).reshape([-1,this.attnLength*this.attnSize]);return{output:v,c:e,h:n,attentionState:{attention:y,attentionState:x}}}}class h{constructor(t,e){this.checkpointURL=t,this.spec=e,this.initialized=!1,this.rawVars={},this.biasShapes=[],this.lstmCells=[]}isInitialized(){return this.initialized}instantiateFromSpec(){this.dataConverter=o.converterFromSpec(this.spec.dataConverter),this.attentionLength=this.spec.attentionLength,this.chordEncoder=this.spec.chordEncoder?s.chordEncoderFromType(this.spec.chordEncoder):void 0,this.auxInputs=this.spec.auxInputs?this.spec.auxInputs.map((t=>r.auxiliaryInputFromSpec(t))):void 0}async initialize(){this.dispose();const t=a.d.now();this.spec||await Object(a.a)(this.checkpointURL+"/config.json").then((t=>t.json())).then((t=>{if("MusicRNN"!==t.type)throw new Error("Attempted to instantiate MusicRNN model with incorrect type:\n                  "+t.type);this.spec=t})),this.instantiateFromSpec();const e=await Object(a.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>i.io.loadWeights(t,this.checkpointURL))),n=u.isWrapped(e),r=n?"rnn/attention_cell_wrapper/":"rnn/";this.forgetBias=i.scalar(1),this.lstmCells.length=0,this.biasShapes.length=0;let s=0;for(;;){const t=r+"multi_rnn_cell/cell_%d/basic_lstm_cell/".replace("%d",s.toString());if(!(t+"kernel"in e))break;this.lstmCells.push(((n,r,s)=>i.basicLSTMCell(this.forgetBias,e[t+"kernel"],e[t+"bias"],n,r,s))),this.biasShapes.push(e[t+"bias"].shape[0]),++s}this.lstmFcW=e["fully_connected/weights"],this.lstmFcB=e["fully_connected/biases"],n&&(this.attentionWrapper=new u(this.lstmCells,this.attentionLength,this.biasShapes[0]/4),this.attentionWrapper.initialize(e)),this.rawVars=e,this.initialized=!0,c.logWithDuration("Initialized model",t,"MusicRNN")}dispose(){Object.keys(this.rawVars).forEach((t=>this.rawVars[t].dispose())),this.rawVars={},this.forgetBias&&(this.forgetBias.dispose(),this.forgetBias=void 0),this.initialized=!1}async continueSequence(t,e,n,i){return(await this.continueSequenceImpl(t,e,n,i,!1)).sequence}async continueSequenceAndReturnProbabilities(t,e,n,i){return this.continueSequenceImpl(t,e,n,i,!0)}async continueSequenceImpl(t,e,n,r,s){if(l.assertIsRelativeQuantizedSequence(t),this.chordEncoder&&!r)throw new Error("Chord progression expected but not provided.");if(!this.chordEncoder&&r)throw new Error("Unexpected chord progression provided.");this.initialized||await this.initialize();const o=a.d.now(),u=i.tidy((()=>{const o=this.dataConverter.toTensor(t),a=o.shape[0],c=o.shape[1],l=this.chordEncoder?this.chordEncoder.encodeProgression(r,a+e):void 0,u=this.auxInputs?i.concat(this.auxInputs.map((t=>t.getTensors(a+e))),1):void 0,h=this.sampleRnn(o,e,n,l,u,s),d=h.samples;return{samples:i.stack(d).as2D(d.length,c),probs:h.probs}})),h=await u,d=this.dataConverter.toNoteSequence(h.samples,t.quantizationInfo.stepsPerQuarter),p=[];if(s)for(let i=0;i<h.probs.length;i++)p.push(await h.probs[i].data()),h.probs[i].dispose();return u.samples.dispose(),d.then((()=>c.logWithDuration("Continuation completed",o,"MusicRNN",20))),{sequence:d,probs:p}}sampleRnn(t,e,n,r,s,o){const a=t.shape[0],c=t.shape[1];let l=[],u=[];for(let y=0;y<this.biasShapes.length;y++)l.push(i.zeros([1,this.biasShapes[y]/4])),u.push(i.zeros([1,this.biasShapes[y]/4]));let h,d=this.attentionWrapper?this.attentionWrapper.initState():null;t=t.toFloat();const p=[],f=[],m=i.split(t.toFloat(),a),g=r?i.split(r,r.shape[0]):void 0,v=s?i.split(s,s.shape[0]):void 0;for(let y=0;y<a+e;y++){let t;if(y<a)t=m[y];else{let e,r=h.matMul(this.lstmFcW).add(this.lstmFcB).as1D();n?(r=r.div(i.scalar(n)),e=i.multinomial(r,1).as1D()):e=r.argMax().as1D(),o&&f.push(i.softmax(r)),t=i.oneHot(e,c).toFloat(),p.push(t.as1D())}if(y===a+e-1)break;const r=[];if(g&&r.push(g[y+1]),r.push(t),v&&r.push(v[y]),t=i.concat(r,1),this.attentionWrapper){const e=this.attentionWrapper.call(t,l,u,d);l=e.c,u=e.h,d=e.attentionState,h=e.output}else[l,u]=i.multiRNNCell(this.lstmCells,t,l,u),h=u[u.length-1]}return{samples:p,probs:f}}}},function(t,e,n){"use strict";n.r(e),n.d(e,"MidiMe",(function(){return a})),n.d(e,"Decoder",(function(){return y})),n.d(e,"Encoder",(function(){return p})),n.d(e,"MusicVAE",(function(){return k}));var i=n(2),r=n(12),s=n(15);class o extends i.layers.Layer{constructor(){super({})}computeOutputShape(t){return t[0]}call(t){return i.tidy((()=>{const[e,n]=t;return i.add(i.mul(i.randomNormal(n.shape),n),e)}))}getClassName(){return"SamplingLayer"}}class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.trained=!1,this.initialized=!1,this.config={encoder_layers:t.encoder_layers||[1024,256,64],decoder_layers:t.decoder_layers||[64,256,1024],input_size:t.input_size||256,latent_size:t.latent_size||4,beta:t.beta||1,epochs:t.epochs||10}}dispose(){this.initialized&&(this.encoder.dispose(),this.decoder.dispose(),this.vae.dispose(),this.initialized=!1)}initialize(){this.dispose();const t=s.d.now(),e=i.input({shape:[this.config.input_size]});this.encoder=this.getEncoder(e);const[n,,]=this.encoder.apply(e);this.decoder=this.getDecoder(n.shape.slice(1));const o=this.decoder.apply(n);this.vae=i.model({inputs:e,outputs:o,name:"vae"}),this.initialized=!0,r.logWithDuration("Initialized model",t,"MidiMe")}async train(t,e){const n=s.d.now();this.trained=!1;let o=.001;!1===i.ENV.get("WEBGL_RENDER_FLOAT32_ENABLED")&&!1===i.ENV.get("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&1===i.ENV.get("WEBGL_VERSION")&&(o=5e-5);const a=i.train.adam(o);for(let r=0;r<this.config.epochs;r++)await i.nextFrame(),await a.minimize((()=>i.tidy((()=>{const[,n,i]=this.encoder.predict(t),s=this.vae.predict(t),o=this.loss(n,i,s,t);return e&&e(r,{y:s,total:o.totalLoss.arraySync(),losses:[o.reconLoss.arraySync(),o.latentLoss.arraySync()]}),o.totalLoss})))),await i.nextFrame();r.logWithDuration("Training finished",n,"MidiMe"),this.trained=!0,a.dispose()}async sample(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.initialized||await this.initialize(),i.tidy((()=>{const e=i.randomNormal([t,this.config.latent_size]);return this.decoder.predict(e)}))}async decode(t){return this.initialized||await this.initialize(),this.decoder.predict(t)}async encode(t){this.initialized||await this.initialize();const[e,,]=this.encoder.predict(t);return e}predict(t){return this.vae.predict(t)}getEncoder(t){let e=t;for(let o=0;o<this.config.encoder_layers.length;o++)e=i.layers.dense({units:this.config.encoder_layers[o],activation:"relu"}).apply(e);const n=this.getAffineLayers(e,this.config.latent_size,t,!1),r=this.getAffineLayers(e,this.config.latent_size,t,!0),s=(new o).apply([n,r]);return i.model({inputs:t,outputs:[s,n,r],name:"encoder"})}getDecoder(t){const e=i.input({shape:t});let n=e;for(let s=0;s<this.config.decoder_layers.length;s++)n=i.layers.dense({units:this.config.decoder_layers[s],activation:"relu"}).apply(n);const r=this.getAffineLayers(n,this.config.input_size,e,!1);return i.model({inputs:e,outputs:r,name:"decoder"})}loss(t,e,n,r){return i.tidy((()=>{const s=this.klLoss(t,e),o=this.reconstructionLoss(r,n);return{latentLoss:s,reconLoss:o,totalLoss:i.add(o,i.mul(s,this.config.beta))}}))}reconstructionLoss(t,e){return i.tidy((()=>{const n=i.pow(i.sub(t,e),2),r=i.div(n,i.mul(2,i.pow(i.ones([1]),2)));return i.mean(i.sum(r,-1))}))}klLoss(t,e){return i.tidy((()=>{const n=i.pow(t,2),r=i.pow(e,2),s=i.add(1,i.log(r)),o=i.add(n,r),a=i.sub(s,o),c=i.div(i.mean(i.sum(a,-1)),2);return i.mul(-1,c)}))}getAffineLayers(t,e,n,r){const s=i.layers.dense({units:e}).apply(t);return r?i.layers.activation({activation:"softplus"}).apply(s):s}}var c=n(37),l=n(8),u=n(36);class h{constructor(t,e){if(void 0===t)throw Error("`kernel` is undefined.");if(void 0===e)throw Error("`bias` is undefined.");this.kernel=t,this.bias=e}}function d(t,e){return e.matMul(t.kernel).add(t.bias)}class p{}class f{constructor(t,e){this.lstmFwVars=t,this.lstmBwVars=e}process(t){return i.tidy((()=>[this.singleDirection(t,!0),this.singleDirection(t,!1)]))}singleDirection(t,e){const n=t.shape[0],r=t.shape[1],s=e?this.lstmFwVars:this.lstmBwVars;let o=[i.zeros([n,s.bias.shape[0]/4]),i.zeros([n,s.bias.shape[0]/4])];const a=i.scalar(1),c=(t,e)=>i.basicLSTMCell(a,s.kernel,s.bias,t,e[0],e[1]),l=i.split(t.toFloat(),r,1),u=[];for(const i of e?l:l.reverse())o=c(i.squeeze([1]),o),u.push(o[1]);return e?u:u.reverse()}}class m extends p{constructor(t,e,n){super(),this.bidirectionalLstm=new f(t,e),this.muVars=n,this.zDims=n?this.muVars.bias.shape[0]:null}encode(t,e){if(e)throw new Error("Variable-length segments not supported in flat encoder");return i.tidy((()=>{const[e,n]=this.bidirectionalLstm.process(t),r=i.concat([e[e.length-1],n[0]],1);return this.muVars?d(this.muVars,r):r}))}}class g extends p{constructor(t,e,n){super(),this.baseEncoders=t,this.numSteps=e,this.muVars=n,this.zDims=this.muVars.bias.shape[0]}encode(t,e){if(e){if(1!==t.shape[0])throw new Error("When using variable-length segments, batch size must be 1.");if(e.length!==this.numSteps[0])throw new Error("Must provide length for all variable-length segments.")}return i.tidy((()=>{let n=t;for(let t=0;t<this.baseEncoders.length;++t){const r=this.numSteps[t],s=i.split(n,r,1),o=[];for(let n=0;n<r;++n)o.push(this.baseEncoders[t].encode(0===t&&e?i.slice3d(s[n],[0,0,0],[1,e[n],-1]):s[n]));n=i.stack(o,1)}return d(this.muVars,n.squeeze([1]))}))}}function v(t,e,n){const r=[],s=[],o=[],a=i.split(d(n,t).tanh(),2*e.length,1);for(let c=0;c<e.length;++c){const t=e[c],n=i.scalar(1);r.push(((e,r,s)=>i.basicLSTMCell(n,t.kernel,t.bias,e,r,s))),s.push(a[2*c]),o.push(a[2*c+1])}return{cell:r,c:s,h:o}}class y{}class x extends y{constructor(t,e,n,i,r,s){super(),this.lstmCellVars=t,this.zToInitStateVars=e,this.outputProjectVars=n,this.zDims=this.zToInitStateVars.kernel.shape[0],this.outputDims=i||n.bias.shape[0],r&&s&&(this.controlBidirectionalLstm=new f(r,s))}decode(t,e,n,r,s){const o=t.shape[0];return i.tidy((()=>{const a=v(t,this.lstmCellVars,this.zToInitStateVars);let c=s?i.expandDims(s,0):void 0;const l=[];let u=n||i.zeros([o,this.outputDims]);if(this.controlBidirectionalLstm){const[t,e]=this.controlBidirectionalLstm.process(c);c=i.concat([i.stack(t,1),i.stack(e,1)],2)}const h=c?i.split(i.tile(c,[o,1,1]),s.shape[0],1):void 0;for(let n=0;n<e;++n){const e=h?[u,t,i.squeeze(h[n],[1])]:[u,t];[a.c,a.h]=i.multiRNNCell(a.cell,i.concat(e,1),a.c,a.h);const s=d(this.outputProjectVars,a.h[a.h.length-1]);u=this.sample(s,r),l.push(u)}return i.stack(l,1)}))}}class b extends x{sample(t,e){const n=t;return(e?i.greaterEqual(i.sigmoid(n.div(i.scalar(e))),i.randomUniform(n.shape)):i.greaterEqual(n,0)).toFloat()}}class w extends x{sample(t,e){const n=t,r=e?i.multinomial(n.div(i.scalar(e)),1).as1D():n.argMax(1).as1D();return i.oneHot(r,this.outputDims).toFloat()}}class S extends x{constructor(t,e,n,i,r,s){super(t,e,n,i.numDims,r,s),this.nade=i}sample(t,e){const[n,r]=i.split(t,[this.nade.numHidden,this.nade.numDims],1);return this.nade.sample(n,r)}}class _ extends x{sample(t,e){let[n,r,s]=i.split(t,3,1);if(r=i.sigmoid(r),s=i.tanh(s),e){n=i.sigmoid(n.div(i.scalar(e)));const t=i.randomUniform(n.shape,0,1);n=i.greater(n,t).toFloat()}else n=i.greater(i.sigmoid(n),.5).toFloat();return i.concat([n,r,s],1)}}class T extends y{constructor(t){super(),this.coreDecoders=t,this.numDecoders=this.coreDecoders.length,this.zDims=this.coreDecoders[0].zDims,this.outputDims=this.coreDecoders.reduce(((t,e)=>t+e.outputDims),0)}decodeSeparately(t,e,n,i,r){const s=[];for(let o=0;o<this.coreDecoders.length;++o)s.push(this.coreDecoders[o].decode(t,e,n[o],i,r));return s}decode(t,e,n,r,s){return i.tidy((()=>{const o=this.decodeSeparately(t,e,this.coreDecoders.map((t=>n)),r,s);return i.concat(o,-1)}))}}class E extends y{constructor(t,e,n,i){super(),this.splitDecoder=new T(t),this.lstmCellVars=e,this.zToInitStateVars=n,this.numSteps=i,this.zDims=this.zToInitStateVars.kernel.shape[0],this.outputDims=this.splitDecoder.outputDims}decode(t,e,n,r,s){const o=t.shape[0];return i.tidy((()=>{const n=v(t,this.lstmCellVars,this.zToInitStateVars),a=[];let c=new Array(this.splitDecoder.numDecoders).fill(void 0);const l=i.zeros([o,1]),u=s?i.split(s,this.numSteps):void 0;for(let t=0;t<this.numSteps;++t){[n.c,n.h]=i.multiRNNCell(n.cell,l,n.c,n.h);const s=this.splitDecoder.decodeSeparately(n.h[n.h.length-1],e/this.numSteps,c,r,u?u[t]:void 0);a.push(i.concat(s,-1)),c=s.map((t=>t.slice([0,t.shape[1]-1,0],[o,1,t.shape[t.rank-1]]).squeeze([1]).toFloat()))}return i.concat(a,1)}))}}class C{constructor(t,e){this.numDims=t.shape[0],this.numHidden=t.shape[2],this.encWeights=t.as2D(this.numDims,this.numHidden),this.decWeightsT=e.as2D(this.numDims,this.numHidden)}sample(t,e){const n=t.shape[0];return i.tidy((()=>{const r=[];let s=t.clone();for(let t=0;t<this.numDims;t++){const o=i.sigmoid(s),a=this.encWeights.slice([t,0],[1,this.numHidden]).as1D(),c=this.decWeightsT.slice([t,0],[1,this.numHidden]),l=e.slice([0,t],[n,1]).add(i.matMul(o,c,!1,!0)).sigmoid().greaterEqual(i.scalar(.5)).toFloat().as1D();t<this.numDims-1&&(s=s.add(i.outerProduct(l.toFloat(),a))),r.push(l)}return i.stack(r,1)}))}}class k{constructor(t,e){this.initialized=!1,this.checkpointURL=t,this.spec=e}instantiateFromSpec(){this.dataConverter=u.converterFromSpec(this.spec.dataConverter),this.chordEncoder=this.spec.chordEncoder?c.chordEncoderFromType(this.spec.chordEncoder):void 0}dispose(){void 0!==this.rawVars&&Object.keys(this.rawVars).forEach((t=>this.rawVars[t].dispose())),this.encoder=void 0,this.decoder=void 0,this.initialized=!1}getLstmLayers(t,e){const n=[];let i=0;for(;;){const r=t.replace("%d",i.toString());if(!(r+"kernel"in e))break;n.push(new h(e[r+"kernel"],e[r+"bias"])),++i}return n}async initialize(){this.dispose();const t=s.d.now();this.spec||await Object(s.a)(this.checkpointURL+"/config.json").then((t=>t.json())).then((t=>{if("MusicVAE"!==t.type)throw new Error("Attempted to instantiate MusicVAE model with incorrect type:\n                  "+t.type);this.spec=t})),this.instantiateFromSpec();const e="cell_%d/bidirectional_rnn/%s/multi_rnn_cell/cell_0/lstm_cell/",n="encoder/"+e,o="encoder/hierarchical_level_%d/"+e.replace("%d","0"),a="control_preprocessing/"+e,c=await Object(s.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>i.io.loadWeights(t,this.checkpointURL)));this.rawVars=c;const l=new h(c["encoder/mu/kernel"],c["encoder/mu/bias"]);if(this.dataConverter.numSegments){const t=this.getLstmLayers(o.replace("%s","fw"),c),e=this.getLstmLayers(o.replace("%s","bw"),c);if(t.length!==e.length||2!==t.length)throw Error("Only 2 hierarchical encoder levels are supported. Got ".concat(t.length," forward and ").concat(e.length," backward."));const n=[0,1].map((n=>new m(t[n],e[n])));this.encoder=new g(n,[this.dataConverter.numSegments,1],l)}else{const t=this.getLstmLayers(n.replace("%s","fw"),c),e=this.getLstmLayers(n.replace("%s","bw"),c);if(t.length!==e.length||1!==t.length)throw Error("Only single-layer bidirectional encoders are supported. Got ".concat(t.length," forward and ").concat(e.length," backward."));this.encoder=new m(t[0],e[0],l)}const u=a.replace("%s","fw").replace("%d","0")+"kernel"in c,d=this.dataConverter.numSegments?"core_decoder/":"",p=[];if(this.dataConverter.NUM_SPLITS)for(let i=0;i<this.dataConverter.NUM_SPLITS;++i)p.push("".concat(d,"core_decoder_").concat(i,"/decoder/"));else p.push(d+"decoder/");let f=[null],v=[null];if(u&&(f=this.getLstmLayers(a.replace("%s","fw"),c),v=this.getLstmLayers(a.replace("%s","bw"),c),f.length!==v.length||1!==f.length))throw Error("Only single-layer bidirectional control preprocessing is supported. Got ".concat(f.length," forward and ").concat(v.length," backward."));const y=p.map((t=>{const e=this.getLstmLayers(t+"multi_rnn_cell/cell_%d/lstm_cell/",c),n=new h(c[t+"z_to_initial_state/kernel"],c[t+"z_to_initial_state/bias"]),i=new h(c[t+"output_projection/kernel"],c[t+"output_projection/bias"]);return t+"nade/w_enc"in c?new S(e,n,i,new C(c[t+"nade/w_enc"],c[t+"nade/w_dec_t"]),f[0],v[0]):"GrooveConverter"===this.spec.dataConverter.type?new _(e,n,i,void 0,f[0],v[0]):this.spec.useBooleanDecoder?new b(e,n,i,void 0,f[0],v[0]):new w(e,n,i,void 0,f[0],v[0])}));if(this.dataConverter.numSegments){const t=this.getLstmLayers("decoder/hierarchical_level_0/cell_%d/lstm_cell/",c),e=new h(c["decoder/hierarchical_level_0/initial_state/kernel"],c["decoder/hierarchical_level_0/initial_state/bias"]);this.decoder=new E(y,t,e,this.dataConverter.numSegments)}else 1===y.length?this.decoder=y[0]:this.decoder=new T(y);this.zDims=this.decoder.zDims,this.initialized=!0,r.logWithDuration("Initialized model",t,"MusicVAE")}isInitialized(){return this.initialized}checkControlArgs(t){const e=(t=t||{}).extraControls||{};if(this.chordEncoder&&!t.chordProgression)throw new Error("Chord progression expected but not provided.");if(!this.chordEncoder&&t.chordProgression)throw new Error("Unexpected chord progression provided.");if(this.chordEncoder&&this.dataConverter.endTensor&&t.chordProgression.length>1)throw new Error("Multiple chords not supported when using variable-length segments.");if(this.spec.conditionOnKey&&null==t.key)throw new Error("Key expected but not provided.");if(!this.spec.conditionOnKey&&null!=t.key)throw new Error("Unexpected key provided.");if(this.spec.extraControls)for(const i of this.spec.extraControls){if(!(i.name in e))throw new Error("Missing control signal: "+i.name);if(e[i.name].shape[1]!==i.depth)throw new Error("Control signal ".concat(i.name," has invalid depth: ").concat(e[i.name].shape[1]," != ").concat(i.depth))}const n=this.spec.extraControls?new Set(this.spec.extraControls.map((t=>t.name))):new Set;for(const i in e)n.has(i)||r.log("Unspecified control signal provided: "+i,"MusicVAE",5)}controlArgsToTensor(t){return t=t||{},i.tidy((()=>{const e=[];if(t.chordProgression){const n=this.encodeChordProgression(t.chordProgression);e.push(n)}if(null!=t.key){const n=i.oneHot(i.fill([this.dataConverter.numSteps],t.key,"int32"),12);e.push(n)}if(t.extraControls)for(const n of this.spec.extraControls)e.push(t.extraControls[n.name]);return e.length?i.concat2d(e,1):void 0}))}async interpolateTensors(t,e,n,r){this.initialized||await this.initialize();const s=await this.encodeTensors(t,r),o=i.tidy((()=>this.getInterpolatedZs(s,e)));s.dispose();const a=await this.decodeTensors(o,n,r);return o.dispose(),a}async interpolate(t,e,n,s){this.checkControlArgs(s),this.initialized||await this.initialize();const o=await this.encode(t,s),a=i.tidy((()=>this.getInterpolatedZs(o,e)));o.dispose();const c=this.decode(a,n,s);return a.dispose(),c.then((()=>r.logWithDuration("Interpolation completed",0,"MusicVAE",20))),c}async getSegmentLengths(t){if(t.shape[0]>1)throw new Error("Variable-length segments not supported for batch size > 1.");const e=this.dataConverter.numSteps,n=this.dataConverter.numSegments,r=i.tidy((()=>i.min(i.equal(t.squeeze([0]),this.dataConverter.endTensor.expandDims(0)),1))),s=await r.data();r.dispose();const o=e/n,a=[];let c=0,l=s.indexOf(1);for(;-1!==l;)a.push(l-c+1),c+=o,l=s.indexOf(1,c);if(a.length!==n)throw new Error("Incorrect number of segments: ".concat(a.length," != ").concat(n));return a}encodeChordProgression(t){const e=this.dataConverter.numSteps,n=this.dataConverter.numSegments,r=this.dataConverter.SEGMENTED_BY_TRACK?e/n:e,s=this.dataConverter.SEGMENTED_BY_TRACK?i.concat2d([this.chordEncoder.encode(l.NO_CHORD).expandDims(0),this.chordEncoder.encodeProgression(t,r-1)],0):this.chordEncoder.encodeProgression(t,r);return this.dataConverter.SEGMENTED_BY_TRACK?i.tile(s,[n,1]):s}async encodeTensors(t,e){this.checkControlArgs(e),this.initialized||await this.initialize();const n=this.dataConverter.endTensor?await this.getSegmentLengths(t):void 0;return i.tidy((()=>{const r=this.controlArgsToTensor(e),s=[t];if(r){const e=i.tile(i.expandDims(r,0),[t.shape[0],1,1]);s.push(e)}const o=i.concat3d(s,2);return this.encoder.encode(o,n)}))}async encode(t,e){this.initialized||await this.initialize();const n=s.d.now(),o=i.tidy((()=>i.stack(t.map((t=>this.dataConverter.toTensor(t)))))),a=await this.encodeTensors(o,e);return o.dispose(),r.logWithDuration("Encoding completed",n,"MusicVAE",20),a}async decodeTensors(t,e,n){return this.checkControlArgs(n),this.initialized||await this.initialize(),i.tidy((()=>{const i=this.controlArgsToTensor(n);return this.decoder.decode(t,this.dataConverter.numSteps,void 0,e,i)}))}async decode(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.DEFAULT_STEPS_PER_QUARTER,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.DEFAULT_QUARTERS_PER_MINUTE;this.initialized||await this.initialize();const c=s.d.now(),u=await this.decodeTensors(t,e,n),h=i.tidy((()=>i.split(u,u.shape[0]).map((t=>t.squeeze([0]))))),d=[];for(const i of h)d.push(await this.dataConverter.toNoteSequence(i,o,a)),i.dispose();return u.dispose(),r.logWithDuration("Decoding completed",c,"MusicVAE",20),d}getInterpolatedZs(t,e){if("number"==typeof e&&(e=[e]),2!==t.shape[0]&&4!==t.shape[0])throw new Error("Invalid number of input sequences. Requires length 2, or 4");if(1!==e.length&&2!==e.length)throw new Error("Invalid number of dimensions. Requires length 1, or 2.");const n=e[0],r=2===e.length?e[1]:n;return i.tidy((()=>{const e=i.linspace(0,1,n),s=t.slice([0,0],[1,t.shape[1]]).as1D(),o=t.slice([1,0],[1,t.shape[1]]).as1D();if(2===t.shape[0]){const t=o.sub(s);return i.outerProduct(e,t).add(s)}if(4===t.shape[0]){const a=i.linspace(0,1,r),c=t.slice([2,0],[1,t.shape[1]]).as1D(),l=t.slice([3,0],[1,t.shape[1]]).as1D(),u=i.scalar(1).sub(e),h=i.scalar(1).sub(a);let d=s.mul(i.outerProduct(h,u).as3D(r,n,1));return d=i.addStrict(d,o.mul(i.outerProduct(a,u).as3D(r,n,1))),d=i.addStrict(d,c.mul(i.outerProduct(h,e).as3D(r,n,1))),d=i.addStrict(d,l.mul(i.outerProduct(a,e).as3D(r,n,1))),d.as2D(n*r,t.shape[1])}throw new Error("Invalid number of note sequences. Requires length 2, or 4")}))}async sampleTensors(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0;this.checkControlArgs(n),this.initialized||await this.initialize();const r=i.tidy((()=>i.randomNormal([t,this.decoder.zDims]))),s=await this.decodeTensors(r,e,n);return r.dispose(),s}async sample(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.DEFAULT_STEPS_PER_QUARTER,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.DEFAULT_QUARTERS_PER_MINUTE;this.checkControlArgs(n),this.initialized||await this.initialize();const c=s.d.now(),u=i.tidy((()=>i.randomNormal([t,this.decoder.zDims]))),h=this.decode(u,e,n,o,a);return u.dispose(),h.then((()=>r.logWithDuration("Sampling completed",c,"MusicVAE",20))),h}async similarTensors(t,e,n,r,s){if(n<0||n>1)throw new Error("Similarity must be between 0 and 1.");this.initialized||await this.initialize();const o=i.expandDims(t,0),a=await this.encodeTensors(o,s);o.dispose();const c=i.tidy((()=>{const t=i.randomNormal([e,this.decoder.zDims]);return i.add(a.mul(n),t.mul(1-n))}));a.dispose();const l=await this.decodeTensors(c,r,s);return c.dispose(),l}async similar(t,e,n,s,o){if(this.checkControlArgs(o),n<0||n>1)throw new Error("Similarity must be between 0 and 1.");this.initialized||await this.initialize();const a=await this.encode([t],o),c=i.tidy((()=>{const t=i.randomNormal([e,this.decoder.zDims]);return i.add(a.mul(n),t.mul(1-n))}));a.dispose();const l=this.decode(c,s,o);return c.dispose(),l.then((()=>r.logWithDuration("Similar sequence generation completed",0,"MusicVAE",20))),l}}},function(t,e,n){"use strict";n.r(e),n.d(e,"PianoGenie",(function(){return m})),n.d(e,"PianoGenieKeysig",(function(){return v})),n.d(e,"PianoGenieChord",(function(){return g})),n.d(e,"PianoGenieKeysigChordFamily",(function(){return x})),n.d(e,"PianoGenieKeysigChord",(function(){return y}));var i,r,s=n(2),o=n(15),a=n(73);function c(t){for(let e=0;e<2;++e)t.c[e].dispose(),t.h[e].dispose()}function l(t,e,n){if((e=void 0!==e?e:1)<0||e>1)throw new Error("Invalid temperature specified");let i;if(0===e)i=s.argMax(t,0);else{e<1&&(t=s.div(t,s.scalar(e,"float32")));const r=s.reshape(s.softmax(t,0),[1,-1]),o=s.multinomial(r,1,n,!0);i=s.reshape(o,[])}return i}class u extends class{constructor(t){this.checkpointURL=t,this.initialized=!1}isInitialized(){return this.initialized}async initialize(t){if(this.initialized&&this.dispose(),void 0===this.checkpointURL&&void 0===t)throw new Error("Need to specify either URI or static variables");if(void 0===t){const t=await Object(o.a)(this.checkpointURL+"/weights_manifest.json").then((t=>t.json())).then((t=>s.io.loadWeights(t,this.checkpointURL)));this.modelVars=t}else this.modelVars=t;this.decLSTMCells=[],this.decForgetBias=s.scalar(1,"float32");for(let e=0;e<2;++e){const t="phero_model/decoder/rnn/rnn/multi_rnn_cell/cell_".concat(e,"/lstm_cell/");this.decLSTMCells.push(((e,n,i)=>s.basicLSTMCell(this.decForgetBias,this.modelVars[t+"kernel"],this.modelVars[t+"bias"],e,n,i)))}this.resetState(),this.initialized=!0,this.next(0),this.resetState()}getRnnInputFeats(){return s.tidy((()=>{const t=s.tensor1d([this.button],"float32");return s.sub(s.mul(2,s.div(t,7)),1).as1D()}))}next(t,e,n){return this.nextWithCustomSamplingFunction(t,(t=>l(t,e,n)))}nextFromKeyList(t,e,n,i){return this.nextWithCustomSamplingFunction(t,(t=>{const r=s.tensor1d(e,"int32");let o=l(t=s.gather(t,r),n,i);const a=s.gather(r,s.reshape(o,[1]));return o=s.reshape(a,[]),o}))}nextFromKeyWhitelist(t,e,n,i){return a.logging.log("nextFromKeyWhitelist() is deprecated, and will be removed in a future          version. Please use nextFromKeyList() instead","PianoGenie",5),this.nextFromKeyList(t,e,n,i)}nextWithCustomSamplingFunction(t,e){const n=this.lastState;this.button=t;const i=this.getRnnInputFeats(),[r,s]=this.evaluateModelAndSample(i,n,e);return i.dispose(),c(this.lastState),this.lastState=r,s}evaluateModelAndSample(t,e,n){if(!this.initialized)throw new Error("Model is not initialized.");const[i,r]=s.tidy((()=>{let i=s.matMul(s.expandDims(t,0),this.modelVars["phero_model/decoder/rnn_input/dense/kernel"]);i=s.add(i,this.modelVars["phero_model/decoder/rnn_input/dense/bias"]);const[r,o]=s.multiRNNCell(this.decLSTMCells,i,e.c,e.h),a={c:r,h:o};let c=s.matMul(o[1],this.modelVars["phero_model/decoder/pitches/dense/kernel"]);c=s.add(c,this.modelVars["phero_model/decoder/pitches/dense/bias"]);const l=s.reshape(c,[88]);return[a,n(l).dataSync()[0]]}));return[i,r]}resetState(){void 0!==this.lastState&&c(this.lastState),this.lastState=function(){const t={c:[],h:[]};for(let e=0;e<2;++e)t.c.push(s.zeros([1,128],"float32")),t.h.push(s.zeros([1,128],"float32"));return t}()}dispose(){this.initialized&&(Object.keys(this.modelVars).forEach((t=>this.modelVars[t].dispose())),this.decForgetBias.dispose(),c(this.lastState),this.initialized=!1)}}{getRnnInputFeats(){return s.tidy((()=>{const t=[super.getRnnInputFeats()],e=this.lastOutput,n=this.lastTime,i=this.time;let r;void 0===this.deltaTimeOverride?r=(i.getTime()-n.getTime())/1e3:(r=this.deltaTimeOverride,this.deltaTimeOverride=void 0);const o=s.scalar(e,"int32"),a=s.addStrict(o,s.scalar(1,"int32")),c=s.cast(s.oneHot(a,89),"float32");t.push(c);const l=s.scalar(r,"float32"),u=s.round(s.mul(l,31.25)),h=s.minimum(u,32),d=s.cast(s.add(h,1e-4),"int32"),p=s.oneHot(d,33),f=s.cast(p,"float32");return t.push(f),this.lastTime=i,s.concat1d(t)}))}nextWithCustomSamplingFunction(t,e){this.time=new Date;const n=super.nextWithCustomSamplingFunction(t,e);return this.lastOutput=n,this.lastTime=this.time,n}overrideLastOutput(t){this.lastOutput=t}overrideDeltaTime(t){this.deltaTimeOverride=t}resetState(){super.resetState(),this.lastOutput=-1,this.lastTime=new Date,this.lastTime.setSeconds(this.lastTime.getSeconds()-1e5),this.time=new Date}}!function(t){t[t.None=0]="None",t[t.C=1]="C",t[t.Cs=2]="Cs",t[t.D=3]="D",t[t.Eb=4]="Eb",t[t.E=5]="E",t[t.F=6]="F",t[t.Fs=7]="Fs",t[t.G=8]="G",t[t.Ab=9]="Ab",t[t.A=10]="A",t[t.Bb=11]="Bb",t[t.B=12]="B"}(i||(i={})),function(t){t[t.None=0]="None",t[t.Maj=1]="Maj",t[t.Min=2]="Min",t[t.Aug=3]="Aug",t[t.Dim=4]="Dim",t[t.Seven=5]="Seven",t[t.Maj7=6]="Maj7",t[t.Min7=7]="Min7",t[t.Min7b5=8]="Min7b5"}(r||(r={}));class h extends u{getRnnInputFeats(){return s.tidy((()=>{const t=[super.getRnnInputFeats()],e=s.scalar(this.chordRoot,"int32"),n=s.subStrict(e,s.scalar(1,"int32")),i=s.cast(s.oneHot(n,12),"float32");t.push(i);const r=s.scalar(this.chordFamily,"int32"),o=s.subStrict(r,s.scalar(1,"int32")),a=s.cast(s.oneHot(o,8),"float32");return t.push(a),s.concat1d(t)}))}setChordRoot(t){this.chordRoot=t}setChordFamily(t){this.chordFamily=t}resetState(){super.resetState(),this.chordRoot=i.None,this.chordFamily=r.None}}class d extends u{getRnnInputFeats(){return s.tidy((()=>{const t=[super.getRnnInputFeats()],e=s.scalar(this.keySignature,"int32"),n=s.subStrict(e,s.scalar(1,"int32")),i=s.cast(s.oneHot(n,12),"float32");return t.push(i),s.concat1d(t)}))}setKeySignature(t){this.keySignature=t}resetState(){super.resetState(),this.keySignature=i.None}}class p extends d{getRnnInputFeats(){return s.tidy((()=>{const t=[super.getRnnInputFeats()],e=s.scalar(this.chordRoot,"int32"),n=s.subStrict(e,s.scalar(1,"int32")),i=s.cast(s.oneHot(n,12),"float32");t.push(i);const r=s.scalar(this.chordFamily,"int32"),o=s.subStrict(r,s.scalar(1,"int32")),a=s.cast(s.oneHot(o,8),"float32");return t.push(a),s.concat1d(t)}))}setChordRoot(t){this.chordRoot=t}setChordFamily(t){this.chordFamily=t}resetState(){super.resetState(),this.chordRoot=i.None,this.chordFamily=r.None}}class f extends d{getRnnInputFeats(){return s.tidy((()=>{const t=[super.getRnnInputFeats()],e=s.scalar(this.chordFamily,"int32"),n=s.subStrict(e,s.scalar(1,"int32")),i=s.cast(s.oneHot(n,8),"float32");return t.push(i),s.concat1d(t)}))}setChordFamily(t){this.chordFamily=t}resetState(){super.resetState(),this.chordFamily=r.None}}class m extends u{}class g extends h{}class v extends d{}class y extends p{}class x extends f{}},,function(t,e,n){"use strict";n.r(e),n.d(e,"tf",(function(){return i})),n.d(e,"aux_inputs",(function(){return r.aux_inputs})),n.d(e,"chords",(function(){return r.chords})),n.d(e,"constants",(function(){return r.constants})),n.d(e,"data",(function(){return r.data})),n.d(e,"logging",(function(){return r.logging})),n.d(e,"melodies",(function(){return r.melodies})),n.d(e,"performance",(function(){return r.performance})),n.d(e,"sequences",(function(){return r.sequences})),n.d(e,"MetronomeCallbackObject",(function(){return r.MetronomeCallbackObject})),n.d(e,"Metronome",(function(){return r.Metronome})),n.d(e,"MidiConversionError",(function(){return r.MidiConversionError})),n.d(e,"midiToSequenceProto",(function(){return r.midiToSequenceProto})),n.d(e,"sequenceProtoToMidi",(function(){return r.sequenceProtoToMidi})),n.d(e,"urlToBlob",(function(){return r.urlToBlob})),n.d(e,"blobToNoteSequence",(function(){return r.blobToNoteSequence})),n.d(e,"urlToNoteSequence",(function(){return r.urlToNoteSequence})),n.d(e,"BasePlayerCallback",(function(){return r.BasePlayerCallback})),n.d(e,"BasePlayer",(function(){return r.BasePlayer})),n.d(e,"Player",(function(){return r.Player})),n.d(e,"SoundFontPlayer",(function(){return r.SoundFontPlayer})),n.d(e,"PlayerWithClick",(function(){return r.PlayerWithClick})),n.d(e,"MIDIPlayer",(function(){return r.MIDIPlayer})),n.d(e,"BaseRecorderCallback",(function(){return r.BaseRecorderCallback})),n.d(e,"Recorder",(function(){return r.Recorder})),n.d(e,"BaseVisualizer",(function(){return r.BaseVisualizer})),n.d(e,"PianoRollCanvasVisualizer",(function(){return r.PianoRollCanvasVisualizer})),n.d(e,"Visualizer",(function(){return r.Visualizer})),n.d(e,"BaseSVGVisualizer",(function(){return r.BaseSVGVisualizer})),n.d(e,"PianoRollSVGVisualizer",(function(){return r.PianoRollSVGVisualizer})),n.d(e,"WaterfallSVGVisualizer",(function(){return r.WaterfallSVGVisualizer})),n.d(e,"ScrollType",(function(){return r.ScrollType})),n.d(e,"StaffSVGVisualizer",(function(){return r.StaffSVGVisualizer})),n.d(e,"Coconet",(function(){return s.Coconet})),n.d(e,"MusicRNN",(function(){return o.MusicRNN})),n.d(e,"MidiMe",(function(){return a.MidiMe})),n.d(e,"Decoder",(function(){return a.Decoder})),n.d(e,"Encoder",(function(){return a.Encoder})),n.d(e,"MusicVAE",(function(){return a.MusicVAE})),n.d(e,"PianoGenie",(function(){return c.PianoGenie})),n.d(e,"PianoGenieKeysig",(function(){return c.PianoGenieKeysig})),n.d(e,"PianoGenieChord",(function(){return c.PianoGenieChord})),n.d(e,"PianoGenieKeysigChordFamily",(function(){return c.PianoGenieKeysigChordFamily})),n.d(e,"PianoGenieKeysigChord",(function(){return c.PianoGenieKeysigChord})),n.d(e,"NoteSequence",(function(){return l.NoteSequence})),n.d(e,"OnsetsAndFrames",(function(){return u.OnsetsAndFrames})),n.d(e,"GANSynth",(function(){return h.GANSynth})),n.d(e,"SPICE",(function(){return p})),n.d(e,"DDSP",(function(){return f.DDSP}));var i=n(2),r=n(73),s=n(185),o=n(186),a=n(187),c=n(188),l=n(181),u=n(184),h=n(183),d=n(25);class p{constructor(t){this.modelUrl=t||"https://tfhub.dev/google/tfjs-model/spice/2/default/1"}async initialize(){this.spiceModel=await Object(d.h)(this.modelUrl),this.initialized=!0}async getAudioFeatures(t,e){return await Object(d.g)(t,this.spiceModel,e)}dispose(){this.initialized&&(this.spiceModel.dispose(),this.initialized=!1)}isInitialized(){return this.initialized}}var f=n(182)}])},module.exports=e(__webpack_require__(6948),__webpack_require__(6869))},8598:(t,e,n)=>{var i=n(7401),r=n(3627),s=n(7320),o=n(7220),a=n(4972),c=n(2584),l=n(9638);l.alea=i,l.xor128=r,l.xorwow=s,l.xorshift7=o,l.xor4096=a,l.tychei=c,t.exports=l},7401:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n=function(){var t=4022871197,e=function(e){e=e.toString();for(var n=0;n<e.length;n++){var i=.02519603282416938*(t+=e.charCodeAt(n));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t=n.nmd(t),n.amdD)},2584:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t=n.nmd(t),n.amdD)},3627:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t=n.nmd(t),n.amdD)},4972:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],c=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,c=Math.max(c,e.length)),r=0,s=-32;s<c;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},7220:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},7320:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},9638:(t,e,n)=>{var i;!function(r,s){var o,a=this,c=256,l="random",u=s.pow(c,6),h=s.pow(2,52),d=2*h,p=c-1;function f(t,e,n){var i=[],p=y(v((e=1==e?{entropy:!0}:e||{}).entropy?[t,x(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(c):(t=new Uint8Array(c),(a.crypto||a.msCrypto).getRandomValues(t)),x(t)}catch(i){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,x(r)]}}():t,3),i),f=new m(i),b=function(){for(var t=f.g(6),e=u,n=0;t<h;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(x(f.S),r),(e.pass||n||function(t,e,n,i){return i&&(i.S&&g(i,f),t.state=function(){return g(f,{})}),n?(s[l]=t,e):t})(b,p,"global"in e?e.global:this==s,e.state)}function m(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<c;)o[r]=r++;for(r=0;r<c;r++)o[r]=o[s=p&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=p&r+1],n=n*c+o[p&(o[r]=o[s=p&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(c)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(v(t[n],e-1))}catch(s){}return i.length?i:"string"==r?t:t+"\0"}function y(t,e){for(var n,i=t+"",r=0;r<i.length;)e[p&r]=p&(n^=19*e[p&r])+i.charCodeAt(r++);return x(e)}function x(t){return String.fromCharCode.apply(0,t)}if(s["seed"+l]=f,y(s.random(),r),t.exports){t.exports=f;try{o=n(914)}catch(b){}}else void 0===(i=function(){return f}.call(e,n,e,t))||(t.exports=i)}([],Math)},282:(t,e,n)=>{var i=n(5141),r=n(9619),s=n(6422),o=n(6304),a=n(3410),c=n(5463),l=n(5274);l.alea=i,l.xor128=r,l.xorwow=s,l.xorshift7=o,l.xor4096=a,l.tychei=c,t.exports=l},5141:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n=function(){var t=4022871197,e=function(e){e=e.toString();for(var n=0;n<e.length;n++){var i=.02519603282416938*(t+=e.charCodeAt(n));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t=n.nmd(t),n.amdD)},5463:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t=n.nmd(t),n.amdD)},9619:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t=n.nmd(t),n.amdD)},3410:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],c=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,c=Math.max(c,e.length)),r=0,s=-32;s<c;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},6304:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},6422:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},5274:(t,e,n)=>{var i;!function(r,s){var o,a=this,c=256,l="random",u=s.pow(c,6),h=s.pow(2,52),d=2*h,p=c-1;function f(t,e,n){var i=[],p=y(v((e=1==e?{entropy:!0}:e||{}).entropy?[t,x(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(c):(t=new Uint8Array(c),(a.crypto||a.msCrypto).getRandomValues(t)),x(t)}catch(i){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,x(r)]}}():t,3),i),f=new m(i),b=function(){for(var t=f.g(6),e=u,n=0;t<h;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(x(f.S),r),(e.pass||n||function(t,e,n,i){return i&&(i.S&&g(i,f),t.state=function(){return g(f,{})}),n?(s[l]=t,e):t})(b,p,"global"in e?e.global:this==s,e.state)}function m(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<c;)o[r]=r++;for(r=0;r<c;r++)o[r]=o[s=p&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=p&r+1],n=n*c+o[p&(o[r]=o[s=p&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(c)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(v(t[n],e-1))}catch(s){}return i.length?i:"string"==r?t:t+"\0"}function y(t,e){for(var n,i=t+"",r=0;r<i.length;)e[p&r]=p&(n^=19*e[p&r])+i.charCodeAt(r++);return x(e)}function x(t){return String.fromCharCode.apply(0,t)}if(s["seed"+l]=f,y(s.random(),r),t.exports){t.exports=f;try{o=n(5778)}catch(b){}}else void 0===(i=function(){return f}.call(e,n,e,t))||(t.exports=i)}([],Math)},6948:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Abs:()=>qt,Acos:()=>Ht,Acosh:()=>Xt,AdadeltaOptimizer:()=>ja,AdagradOptimizer:()=>Wa,AdamOptimizer:()=>Ha,AdamaxOptimizer:()=>Ja,Add:()=>Yt,AddN:()=>Kt,All:()=>Qt,Any:()=>Zt,ArgMax:()=>Jt,ArgMin:()=>$t,Asin:()=>te,Asinh:()=>ee,Atan:()=>ne,Atan2:()=>re,Atanh:()=>ie,AvgPool:()=>se,AvgPool3D:()=>ae,AvgPool3DGrad:()=>ce,AvgPoolGrad:()=>oe,BatchMatMul:()=>le,BatchToSpaceND:()=>ue,Bincount:()=>he,BroadcastTo:()=>de,Callback:()=>VS,CallbackList:()=>Nv,Cast:()=>pe,Ceil:()=>fe,ClipByValue:()=>me,Complex:()=>ge,ComplexAbs:()=>ve,Concat:()=>ye,Conv2D:()=>xe,Conv2DBackpropFilter:()=>be,Conv2DBackpropInput:()=>we,Conv3D:()=>Se,Conv3DBackpropFilterV2:()=>_e,Conv3DBackpropInputV2:()=>Te,Cos:()=>Ee,Cosh:()=>Ce,CropAndResize:()=>Ae,Cumsum:()=>ke,CustomCallback:()=>Pv,DataStorage:()=>W,DenseBincount:()=>Ie,DepthToSpace:()=>Oe,DepthwiseConv2dNative:()=>Re,DepthwiseConv2dNativeBackpropFilter:()=>Ne,DepthwiseConv2dNativeBackpropInput:()=>Me,Diag:()=>De,Dilation2D:()=>Pe,Dilation2DBackpropFilter:()=>Le,Dilation2DBackpropInput:()=>Fe,ENV:()=>Vt,EarlyStopping:()=>qS,Elu:()=>ze,EluGrad:()=>Ue,Environment:()=>zt,Equal:()=>Ve,Erf:()=>je,Exp:()=>We,ExpandDims:()=>Ge,Expm1:()=>qe,FFT:()=>He,Fill:()=>Xe,FlipLeftRight:()=>Ye,Floor:()=>Ke,FloorDiv:()=>Qe,FromPixels:()=>Fi,FusedBatchNorm:()=>Ze,FusedConv2D:()=>zi,FusedDepthwiseConv2D:()=>Ui,GatherNd:()=>$e,GatherV2:()=>Je,GraphModel:()=>sT,Greater:()=>tn,GreaterEqual:()=>en,History:()=>Dv,IFFT:()=>rn,Identity:()=>nn,Imag:()=>sn,InputSpec:()=>xv,IsFinite:()=>on,IsInf:()=>an,IsNan:()=>cn,KernelBackend:()=>G,LRN:()=>xn,LRNGrad:()=>bn,LayerVariable:()=>gv,LayersModel:()=>Yy,LeakyRelu:()=>ln,Less:()=>un,LessEqual:()=>hn,LinSpace:()=>dn,Log:()=>pn,Log1p:()=>fn,LogSoftmax:()=>yn,LogicalAnd:()=>mn,LogicalNot:()=>gn,LogicalOr:()=>vn,Max:()=>wn,MaxPool:()=>_n,MaxPool3D:()=>En,MaxPool3DGrad:()=>Cn,MaxPoolGrad:()=>Tn,MaxPoolWithArgmax:()=>kn,Maximum:()=>Sn,Mean:()=>An,Min:()=>In,Minimum:()=>On,MirrorPad:()=>Rn,Mod:()=>Nn,MomentumOptimizer:()=>tc,Multinomial:()=>Mn,Multiply:()=>Dn,Neg:()=>Pn,NonMaxSuppressionV3:()=>Ln,NonMaxSuppressionV4:()=>Bn,NonMaxSuppressionV5:()=>zn,NotEqual:()=>Fn,OP_SCOPE_SUFFIX:()=>Xr,OneHot:()=>jn,OnesLike:()=>Un,Optimizer:()=>Ua,Pack:()=>Vn,PadV2:()=>Wn,Pool:()=>Gn,Pow:()=>qn,Prelu:()=>Hn,Prod:()=>Xn,RMSPropOptimizer:()=>ec,RNN:()=>eb,Range:()=>Yn,Rank:()=>wr,Real:()=>Kn,RealDiv:()=>Be,Reciprocal:()=>Qn,Reduction:()=>Ld,Relu:()=>Zn,Relu6:()=>ii,Reshape:()=>Jn,ResizeBilinear:()=>ei,ResizeBilinearGrad:()=>ni,ResizeNearestNeighbor:()=>$n,ResizeNearestNeighborGrad:()=>ti,Reverse:()=>ri,RotateWithOffset:()=>Li,Round:()=>si,Rsqrt:()=>oi,SGDOptimizer:()=>$a,ScatterNd:()=>ai,Select:()=>ci,Selu:()=>li,Sequential:()=>Jy,Sigmoid:()=>fi,Sign:()=>pi,Sin:()=>hi,Sinh:()=>di,Slice:()=>ui,Softmax:()=>bi,Softplus:()=>mi,SpaceToBatchND:()=>yi,SparseToDense:()=>Ti,SplitV:()=>xi,Sqrt:()=>gi,Square:()=>Si,SquaredDifference:()=>wi,Step:()=>Pi,StridedSlice:()=>Ei,Sub:()=>_i,Sum:()=>vi,SymbolicTensor:()=>bv,Tan:()=>Ci,Tanh:()=>ki,Tensor:()=>xr,TensorBuffer:()=>mr,Tile:()=>Ai,TopK:()=>Ii,Transpose:()=>Oi,Unique:()=>Ri,Unpack:()=>Ni,UnsortedSegmentSum:()=>Mi,Variable:()=>br,ZerosLike:()=>Di,_FusedMatMul:()=>Bi,abs:()=>Xa,acos:()=>nc,acosh:()=>ic,add:()=>Ea,addN:()=>rc,addStrict:()=>Mh,all:()=>sc,any:()=>oc,argMax:()=>ac,argMin:()=>cc,asin:()=>lc,asinh:()=>uc,atan:()=>hc,atan2:()=>dc,atanh:()=>pc,avgPool:()=>Ac,avgPool3d:()=>Ic,backend:()=>_a,backend_util:()=>g,basicLSTMCell:()=>Dc,batchNorm:()=>Fc,batchNorm2d:()=>Lc,batchNorm3d:()=>Bc,batchNorm4d:()=>zc,batchToSpaceND:()=>Pc,bincount:()=>Uc,booleanMaskAsync:()=>Ch,broadcastTo:()=>jc,browser:()=>c,buffer:()=>Hs,callbacks:()=>HS,cast:()=>Xs,ceil:()=>Vc,clipByValue:()=>Wc,clone:()=>Ys,complex:()=>Kr,concat:()=>Oc,concat1d:()=>Gc,concat2d:()=>qc,concat3d:()=>Hc,concat4d:()=>Xc,constraints:()=>y,conv1d:()=>Kc,conv2d:()=>Yc,conv2dTranspose:()=>Zc,conv3d:()=>Jc,conv3dTranspose:()=>tl,copyRegisteredKernels:()=>Qi,cos:()=>el,cosh:()=>nl,cosineWindow:()=>Qh,cumsum:()=>il,customGrad:()=>La,data:()=>j,denseBincount:()=>rl,deprecationWarn:()=>aa,depthToSpace:()=>sl,depthwiseConv2d:()=>ol,deregisterOp:()=>JS,device_util:()=>s,diag:()=>al,dilation2d:()=>cl,disableDeprecationWarnings:()=>oa,dispose:()=>pa,disposeVariables:()=>ca,div:()=>ka,divNoNan:()=>hl,divStrict:()=>Dh,dot:()=>dl,dropout:()=>Yh,elu:()=>pl,enableDebugMode:()=>sa,enableProdMode:()=>ra,enclosingPowerOfTwo:()=>Kh,engine:()=>la,env:()=>Ut,equal:()=>ll,equalStrict:()=>kh,erf:()=>fl,exp:()=>ml,expandDims:()=>gl,expm1:()=>vl,eye:()=>xl,fft:()=>nh,fill:()=>Va,findBackend:()=>ba,findBackendFactory:()=>wa,floor:()=>bl,floorDiv:()=>Ca,fused:()=>f,gather:()=>wl,gatherND:()=>Xh,gather_util:()=>l,getBackend:()=>ya,getGradient:()=>Gi,getKernel:()=>Wi,getKernelsForBackend:()=>qi,grad:()=>Na,grads:()=>Ma,greater:()=>Sl,greaterEqual:()=>_l,greaterEqualStrict:()=>Ah,greaterStrict:()=>Ih,ifft:()=>ih,imag:()=>Tl,image:()=>Kd,inTopKAsync:()=>Zh,initializers:()=>x,input:()=>nx,io:()=>o,irfft:()=>rh,isFinite:()=>El,isInf:()=>Cl,isNaN:()=>kl,keep:()=>fa,kernel_impls:()=>v,layers:()=>b,leakyRelu:()=>Al,less:()=>Il,lessEqual:()=>Ol,lessEqualStrict:()=>Oh,lessStrict:()=>Rh,linalg:()=>Qd,linspace:()=>Rl,loadGraphModel:()=>oT,loadLayersModel:()=>ex,localResponseNormalization:()=>Nl,log:()=>Ml,log1p:()=>Dl,logSigmoid:()=>Ll,logSoftmax:()=>Ul,logSumExp:()=>Kl,logicalAnd:()=>Ql,logicalNot:()=>Zl,logicalOr:()=>Jl,logicalXor:()=>$l,losses:()=>Zd,matMul:()=>fo,math:()=>a,max:()=>Bl,maxPool:()=>tu,maxPool3d:()=>eu,maxPoolWithArgmax:()=>nu,maximum:()=>Za,maximumStrict:()=>Ph,mean:()=>iu,memory:()=>ua,metrics:()=>w,min:()=>ru,minimum:()=>su,minimumStrict:()=>Fh,mirrorPad:()=>ou,mod:()=>au,modStrict:()=>Lh,model:()=>$y,models:()=>S,moments:()=>cu,movingAverage:()=>Gh,mul:()=>Aa,mulStrict:()=>Bh,multiRNNCell:()=>lu,multinomial:()=>uu,neg:()=>Pl,nextFrame:()=>ep,norm:()=>Wh,notEqual:()=>hu,notEqualStrict:()=>Nh,oneHot:()=>mo,ones:()=>pu,onesLike:()=>fu,op:()=>Yr,outerProduct:()=>mu,pad:()=>gu,pad1d:()=>vu,pad2d:()=>yu,pad3d:()=>xu,pad4d:()=>bu,pool:()=>Su,pow:()=>Ga,powStrict:()=>zh,prelu:()=>_u,print:()=>Ks,prod:()=>Tu,profile:()=>ha,rand:()=>Eu,randomGamma:()=>Ou,randomNormal:()=>Ru,randomUniform:()=>Nu,range:()=>Mu,ready:()=>va,real:()=>Du,reciprocal:()=>Pu,registerBackend:()=>Sa,registerCallbackConstructor:()=>ix,registerGradient:()=>Xi,registerKernel:()=>Hi,registerOp:()=>QS,regularizers:()=>_,relu:()=>Fu,relu6:()=>Lu,removeBackend:()=>xa,reshape:()=>kc,reverse:()=>Bu,reverse1d:()=>zu,reverse2d:()=>Uu,reverse3d:()=>ju,reverse4d:()=>Vu,rfft:()=>oh,round:()=>Wu,rsqrt:()=>Gu,scalar:()=>za,scatterND:()=>qh,scatter_util:()=>u,selu:()=>qu,separableConv2d:()=>Hu,sequential:()=>tx,serialization:()=>d,setBackend:()=>ga,setPlatform:()=>Ta,setdiff1dAsync:()=>Xu,sigmoid:()=>Rc,sign:()=>Yu,signal:()=>Yd,sin:()=>Ku,sinh:()=>Qu,slice:()=>Nc,slice1d:()=>Zu,slice2d:()=>Ju,slice3d:()=>$u,slice4d:()=>th,slice_util:()=>h,softmax:()=>eh,softplus:()=>Fl,spaceToBatchND:()=>wu,sparseToDense:()=>Hh,spectral:()=>Xd,split:()=>sh,sqrt:()=>Ia,square:()=>Oa,squaredDifference:()=>ah,squaredDifferenceStrict:()=>Uh,squeeze:()=>ch,stack:()=>lh,step:()=>uh,stridedSlice:()=>hh,sub:()=>qa,subStrict:()=>jh,sum:()=>zl,sumOutType:()=>Ar,tan:()=>dh,tanh:()=>Mc,tensor:()=>Zr,tensor1d:()=>ph,tensor2d:()=>fh,tensor3d:()=>yo,tensor4d:()=>mh,tensor5d:()=>gh,tensor6d:()=>vh,tensor_util:()=>r,test_util:()=>p,tidy:()=>da,tile:()=>yl,time:()=>ma,topk:()=>yh,train:()=>$d,transpose:()=>go,truncatedNormal:()=>xh,unique:()=>bh,unregisterGradient:()=>Ki,unregisterKernel:()=>Yi,unsortedSegmentSum:()=>wh,unstack:()=>Sh,upcastType:()=>kr,util:()=>i,valueAndGrad:()=>Da,valueAndGrads:()=>Pa,variable:()=>_h,variableGrads:()=>Fa,version:()=>Nz,version_converter:()=>aT,version_core:()=>ia,version_layers:()=>by,where:()=>ul,whereAsync:()=>Eh,zeros:()=>du,zerosLike:()=>Ra});var i={};n.r(i),n.d(i,{arraysEqual:()=>rt,assert:()=>J,assertNonNegativeIntegerDimensions:()=>Dt,assertNonNull:()=>tt,assertShapesMatch:()=>$,bytesFromStringArray:()=>wt,bytesPerElement:()=>bt,checkConversionForErrors:()=>gt,clamp:()=>X,computeStrides:()=>At,createScalarValue:()=>lr,createShuffledIndices:()=>ct,decodeString:()=>fr,distSquared:()=>Z,encodeString:()=>pr,fetch:()=>dr,flatten:()=>et,getArrayFromDType:()=>mt,getTypedArrayFromDType:()=>ft,hasEncodingLoss:()=>yt,indexToLoc:()=>Ft,inferDtype:()=>Et,inferFromImplicitShape:()=>ht,isBoolean:()=>_t,isFunction:()=>Ct,isInt:()=>st,isNumber:()=>Tt,isPromise:()=>Lt,isScalarShape:()=>it,isString:()=>St,isTypedArray:()=>xt,isValidDtype:()=>vt,locToIndex:()=>Pt,makeOnesTypedArray:()=>Rt,makeZerosNestedTypedArray:()=>Mt,makeZerosTypedArray:()=>Nt,nearestDivisor:()=>kt,nearestLargerEven:()=>Y,now:()=>hr,parseAxisParam:()=>dt,randUniform:()=>Q,repeatedTry:()=>ut,rightPad:()=>lt,shuffle:()=>H,sizeFromShape:()=>nt,sizeToSquarishShape:()=>at,squeezeShape:()=>pt,sum:()=>K,tanh:()=>ot,toNestedArray:()=>Ot,toTypedArray:()=>ur});var r={};n.r(r),n.d(r,{assertTypesMatch:()=>Or,getTensorsInContainer:()=>Nr,isTensorInList:()=>Rr,makeTypesMatch:()=>Ir});var s={};n.r(s),n.d(s,{isBrowser:()=>Ur,isMobile:()=>zr});var o={};n.r(o),n.d(o,{browserFiles:()=>$s,browserHTTPRequest:()=>co,concatenateArrayBuffers:()=>ss,copyModel:()=>Us,decodeWeights:()=>es,encodeWeights:()=>ts,fromMemory:()=>ho,getLoadHandlers:()=>ps,getModelArtifactsInfoForJSON:()=>as,getSaveHandlers:()=>ds,http:()=>ao,isHTTPScheme:()=>so,listModels:()=>Bs,loadWeights:()=>no,moveModel:()=>js,registerLoadRouter:()=>hs,registerSaveRouter:()=>us,removeModel:()=>zs,weightsLoaderFactory:()=>io,withSaveHandler:()=>po});var a={};n.r(a),n.d(a,{confusionMatrix:()=>vo});var c={};n.r(c),n.d(c,{fromPixels:()=>wo,toPixels:()=>bo});var l={};n.r(l),n.d(l,{prepareAndValidate:()=>So});var u={};n.r(u),n.d(u,{calculateShapes:()=>Eo,validateInput:()=>To,validateUpdateShape:()=>_o});var h={};n.r(h),n.d(h,{assertParamsValid:()=>Co,computeFlatOffset:()=>zo,computeOutShape:()=>Ao,getNormalizedAxes:()=>No,isSliceContinous:()=>Bo,maskToAxes:()=>ko,parseSliceParams:()=>Uo,sliceInfo:()=>jo,startForAxis:()=>Fo,startIndicesWithElidedDims:()=>Mo,stopForAxis:()=>Lo,stopIndicesWithElidedDims:()=>Do,stridesForAxis:()=>Po,stridesWithElidedDims:()=>Io});var d={};n.r(d),n.d(d,{Serializable:()=>Vo,SerializationMap:()=>Wo,registerClass:()=>Go});var p={};n.r(p),n.d(p,{TEST_EPSILON_FLOAT16:()=>Ho,encodeStrings:()=>na,expectArrayBuffersEqual:()=>ea,expectArraysClose:()=>Xo,expectArraysEqual:()=>Zo,expectNumbersClose:()=>Jo,expectPromiseToFail:()=>Qo,expectValuesInRange:()=>ta,testEpsilon:()=>Yo});var f={};n.r(f),n.d(f,{conv2d:()=>id,depthwiseConv2d:()=>od,matMul:()=>ad});var m={};n.r(m),n.d(m,{collectGatherOpShapeInfo:()=>Mp,computeOutShape:()=>Np,segOpComputeOptimalWindowSize:()=>Rp});var g={};n.r(g),n.d(g,{ERF_A1:()=>mp,ERF_A2:()=>gp,ERF_A3:()=>vp,ERF_A4:()=>yp,ERF_A5:()=>xp,ERF_P:()=>fp,PARALLELIZE_THRESHOLD:()=>rp,SELU_SCALE:()=>pp,SELU_SCALEALPHA:()=>dp,applyActivation:()=>ed,assertAndGetBroadcastShape:()=>Qa,assertAxesAreInnerMostDims:()=>ql,assertParamsConsistent:()=>np,assignToTypedArray:()=>kp,axesAreInnerMostDims:()=>jl,calculateShapes:()=>Eo,castTensor:()=>Dp,combineLocations:()=>Vl,complexWithEvenIndex:()=>Tp,complexWithOddIndex:()=>Ep,computeConv2DInfo:()=>vc,computeConv3DInfo:()=>yc,computeDefaultPad:()=>xc,computeDilation2DInfo:()=>fc,computeOptimalWindowSize:()=>sp,computeOutAndReduceShapes:()=>Wl,computeOutShape:()=>ip,computePool2DInfo:()=>mc,computePool3DInfo:()=>gc,convertConv2DDataFormat:()=>Cc,eitherStridesOrDilationsAreOne:()=>Ec,expandShapeToKeepDim:()=>Gl,exponent:()=>Ip,exponents:()=>Ap,fromStringArrayToUint8:()=>Lp,fromUint8ToStringArray:()=>Fp,getAxesPermutation:()=>Hl,getBroadcastDims:()=>Ya,getComplexWithIndex:()=>Cp,getFusedBiasGradient:()=>td,getFusedDyActivation:()=>$h,getImageCenter:()=>op,getInnerMostAxes:()=>Yl,getPermuted:()=>cp,getReductionAxes:()=>Ka,getReshaped:()=>ap,getReshapedPermuted:()=>lp,getSliceBeginCoords:()=>up,getSliceSize:()=>hp,getUndoAxesPermutation:()=>Xl,log:()=>wp,mergeRealAndImagArrays:()=>Sp,prepareAndValidate:()=>So,prepareSplitSize:()=>Op,reshapeTensor:()=>Pp,segment_util:()=>m,shouldFuse:()=>nd,slice_util:()=>h,splitRealAndImagArrays:()=>_p,tupleValuesAreOne:()=>Tc,upcastType:()=>kr,validateInput:()=>To,validateUpdateShape:()=>_o,warn:()=>bp});var v={};n.r(v),n.d(v,{nonMaxSuppressionV3Impl:()=>xd,nonMaxSuppressionV4Impl:()=>bd,nonMaxSuppressionV5Impl:()=>wd,whereImpl:()=>Th});var y={};n.r(y),n.d(y,{maxNorm:()=>Fm,minMaxNorm:()=>zm,nonNeg:()=>Bm,unitNorm:()=>Lm});var x={};n.r(x),n.d(x,{constant:()=>Xg,glorotNormal:()=>tv,glorotUniform:()=>$g,heNormal:()=>ev,heUniform:()=>nv,identity:()=>Zg,leCunNormal:()=>iv,leCunUniform:()=>rv,ones:()=>Hg,orthogonal:()=>sv,randomNormal:()=>Kg,randomUniform:()=>Yg,truncatedNormal:()=>Qg,varianceScaling:()=>Jg,zeros:()=>qg});var b={};n.r(b),n.d(b,{Layer:()=>Tv,RNN:()=>eb,RNNCell:()=>nb,activation:()=>_w,add:()=>Nw,alphaDropout:()=>SS,average:()=>Mw,averagePooling1d:()=>Vw,averagePooling2d:()=>qw,averagePooling3d:()=>Yw,avgPool1d:()=>Ww,avgPool2d:()=>Hw,avgPool3d:()=>Kw,avgPooling1d:()=>Gw,avgPooling2d:()=>Xw,avgPooling3d:()=>Qw,batchNormalization:()=>zw,bidirectional:()=>fS,concatenate:()=>Dw,conv1d:()=>mw,conv2d:()=>gw,conv2dTranspose:()=>vw,conv3d:()=>yw,convLstm2d:()=>uS,convLstm2dCell:()=>hS,cropping2D:()=>bw,dense:()=>Tw,depthwiseConv2d:()=>Sw,dot:()=>Bw,dropout:()=>Ew,elu:()=>lw,embedding:()=>Rw,flatten:()=>kw,gaussianDropout:()=>wS,gaussianNoise:()=>bS,globalAveragePooling1d:()=>Zw,globalAveragePooling2d:()=>Jw,globalMaxPool1d:()=>gS,globalMaxPool2d:()=>vS,globalMaxPooling1d:()=>$w,globalMaxPooling2d:()=>tS,gru:()=>rS,gruCell:()=>sS,input:()=>nx,inputLayer:()=>cw,layerNormalization:()=>Uw,leakyReLU:()=>hw,lstm:()=>oS,lstmCell:()=>aS,masking:()=>_S,maxPool1d:()=>yS,maxPool2d:()=>xS,maxPooling1d:()=>eS,maxPooling2d:()=>nS,maxPooling3d:()=>iS,maximum:()=>Pw,minimum:()=>Fw,multiply:()=>Lw,permute:()=>Ow,prelu:()=>dw,reLU:()=>uw,repeatVector:()=>Aw,reshape:()=>Iw,rnn:()=>dS,separableConv2d:()=>xw,simpleRNN:()=>cS,simpleRNNCell:()=>lS,softmax:()=>pw,spatialDropout1d:()=>Cw,stackedRNNCells:()=>pS,thresholdedReLU:()=>fw,timeDistributed:()=>mS,upSampling2d:()=>ww,zeroPadding2d:()=>jw});var w={};n.r(w),n.d(w,{MAPE:()=>DS,MSE:()=>LS,binaryAccuracy:()=>TS,binaryCrossentropy:()=>ES,categoricalAccuracy:()=>kS,categoricalCrossentropy:()=>AS,cosineProximity:()=>RS,mape:()=>PS,meanAbsoluteError:()=>NS,meanAbsolutePercentageError:()=>MS,meanSquaredError:()=>FS,mse:()=>BS,precision:()=>IS,recall:()=>OS,sparseCategoricalAccuracy:()=>CS});var S={};n.r(S),n.d(S,{modelFromJSON:()=>Qy});var _={};n.r(_),n.d(_,{l1:()=>US,l1l2:()=>zS,l2:()=>jS});var T={};n.r(T),n.d(T,{json:()=>o_});var E={};n.r(E),n.d(E,{json:()=>a_});var C={};n.r(C),n.d(C,{json:()=>c_});var k={};n.r(k),n.d(k,{json:()=>l_});var A={};n.r(A),n.d(A,{json:()=>u_});var I={};n.r(I),n.d(I,{json:()=>h_});var O={};n.r(O),n.d(O,{json:()=>d_});var R={};n.r(R),n.d(R,{json:()=>p_});var N={};n.r(N),n.d(N,{json:()=>f_});var M={};n.r(M),n.d(M,{json:()=>m_});var D={};n.r(D),n.d(D,{json:()=>g_});var P={};n.r(P),n.d(P,{json:()=>v_});var F={};n.r(F),n.d(F,{json:()=>y_});var L={};n.r(L),n.d(L,{json:()=>x_});var B={};n.r(B),n.d(B,{json:()=>b_});var z={};n.r(z),n.d(z,{json:()=>w_});var U={};n.r(U),n.d(U,{json:()=>S_});var j={};n.r(j),n.d(j,{CSVDataset:()=>JT,Dataset:()=>UT,FileDataSource:()=>hE,TextLineDataset:()=>qT,URLDataSource:()=>dE,array:()=>VT,csv:()=>pE,func:()=>fE,generator:()=>mE,microphone:()=>vE,version_data:()=>yE,webcam:()=>gE,zip:()=>WT});var V={};n.r(V),n.d(V,{addImpl:()=>YE,bincountImpl:()=>UC,bincountReduceImpl:()=>jC,ceilImpl:()=>GC,concatImpl:()=>QC,expImpl:()=>Fk,expm1Impl:()=>jk,floorImpl:()=>cA,gatherV2Impl:()=>vA,greaterImpl:()=>xA,lessImpl:()=>NA,linSpaceImpl:()=>BA,logImpl:()=>UA,maxImpl:()=>eI,maximumImpl:()=>rI,minimumImpl:()=>gI,multiplyImpl:()=>Gk,negImpl:()=>kI,prodImpl:()=>YI,rangeImpl:()=>QI,rsqrtImpl:()=>cO,simpleAbsImpl:()=>iC,sliceImpl:()=>FC,stridedSliceImpl:()=>UO,subImpl:()=>Zk,tileImpl:()=>qO,topKImpl:()=>XO,transposeImpl:()=>uC,uniqueImpl:()=>KO});class W{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class G{decComplexRef(t){}time(t){return q("time")}read(t){return q("read")}readSync(t){return q("readSync")}numDataIds(){return q("numDataIds")}disposeData(t){return q("disposeData")}write(t,e,n){return q("write")}move(t,e,n,i){return q("move")}memory(){return q("memory")}floatPrecision(){return q("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,i){return q("batchMatMul")}fusedBatchMatMul(t){let{a:e,b:n,transposeA:i,transposeB:r,bias:s,activation:o,preluActivationWeights:a}=t;return q("fusedBatchMatMul")}slice(t,e,n){return q("slice")}stridedSlice(t,e,n,i){return q("stridedSlice")}unstack(t,e){return q("unstack")}reverse(t,e){return q("reverse")}concat(t,e){return q("concat")}neg(t){return q("neg")}add(t,e){return q("add")}addN(t){return q("addN")}subtract(t,e){return q("subtract")}multiply(t,e){return q("multiply")}realDivide(t,e){return q("realDivide")}floorDiv(t,e){return q("floorDiv")}sum(t,e){return q("sum")}prod(t,e){return q("prod")}unsortedSegmentSum(t,e,n){return q("unsortedSegmentSum")}argMin(t,e){return q("argMin")}argMax(t,e){return q("argMax")}equal(t,e){return q("equal")}notEqual(t,e){return q("notEqual")}less(t,e){return q("less")}lessEqual(t,e){return q("lessEqual")}greater(t,e){return q("greater")}greaterEqual(t,e){return q("greaterEqual")}logicalNot(t){return q("logicalNot")}logicalAnd(t,e){return q("logicalAnd")}logicalOr(t,e){return q("logicalOr")}where(t){return q("where")}select(t,e,n){return q("select")}topk(t,e,n){return q("topk")}min(t,e){return q("min")}minimum(t,e){return q("minimum")}mod(t,e){return q("mod")}max(t,e){return q("max")}maximum(t,e){return q("maximum")}all(t,e){return q("all")}any(t,e){return q("any")}squaredDifference(t,e){return q("squaredDifference")}ceil(t){return q("ceil")}floor(t){return q("floor")}round(t){return q("round")}sign(t){return q("sign")}isNaN(t){return q("isNaN")}isInf(t){return q("isInf")}isFinite(t){return q("isFinite")}pow(t,e){return q("pow")}exp(t){return q("exp")}expm1(t){return q("expm1")}softmax(t,e){return q("softmax")}log(t){return q("log")}log1p(t){return q("log1p")}sqrt(t){return q("sqrt")}rsqrt(t){return q("rsqrt")}square(t){return q("square")}reciprocal(t){return q("reciprocal")}relu(t){return q("relu")}relu6(t){return q("relu6")}prelu(t,e){return q("prelu")}elu(t){return q("elu")}eluDer(t,e){return q("eluDer")}selu(t){return q("selu")}int(t){return q("int")}clip(t,e,n){return q("clip")}abs(t){return q("abs")}complexAbs(t){return q("complexAbs")}sigmoid(t){return q("sigmoid")}softplus(t){return q("softplus")}sin(t){return q("sin")}cos(t){return q("cos")}tan(t){return q("tan")}asin(t){return q("asin")}acos(t){return q("acos")}atan(t){return q("atan")}atan2(t,e){return q("atan2")}sinh(t){return q("sinh")}cosh(t){return q("cosh")}tanh(t){return q("tanh")}asinh(t){return q("asinh")}acosh(t){return q("acosh")}atanh(t){return q("atanh")}erf(t){return q("erf")}step(t,e){return q("step")}fusedConv2d(t){let{input:e,filter:n,convInfo:i,bias:r,activation:s,preluActivationWeights:o}=t;return q("fusedConv2d")}conv2d(t,e,n){return q("conv2d")}conv2dDerInput(t,e,n){return q("conv2dDerInput")}conv2dDerFilter(t,e,n){return q("conv2dDerFilter")}fusedDepthwiseConv2D(t){let{input:e,filter:n,convInfo:i,bias:r,activation:s,preluActivationWeights:o}=t;return q("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return q("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return q("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return q("depthwiseConv2DDerFilter")}conv3d(t,e,n){return q("conv3d")}conv3dDerInput(t,e,n){return q("conv3dDerInput")}conv3dDerFilter(t,e,n){return q("conv3dDerFilter")}maxPool(t,e){return q("maxPool")}maxPoolBackprop(t,e,n,i){return q("maxPoolBackprop")}avgPool(t,e){return q("avgPool")}avgPoolBackprop(t,e,n){return q("avgPoolBackprop")}avgPool3d(t,e){return q("avgPool3d")}avgPool3dBackprop(t,e,n){return q("avgPool3dBackprop")}maxPool3d(t,e){return q("maxPool3d")}maxPool3dBackprop(t,e,n,i){return q("maxPool3dBackprop")}reshape(t,e){return q("reshape")}cast(t,e){return q("cast")}tile(t,e){return q("tile")}pad(t,e,n){return q("pad")}transpose(t,e){return q("transpose")}gather(t,e,n){return q("gather")}gatherND(t,e){return q("gatherND")}scatterND(t,e,n){return q("scatterND")}batchToSpaceND(t,e,n){return q("batchToSpaceND")}spaceToBatchND(t,e,n){return q("spaceToBatchND")}resizeBilinear(t,e,n,i,r){return q("resizeBilinear")}resizeBilinearBackprop(t,e,n){return q("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,i,r){return q("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return q("resizeNearestNeighborBackprop")}batchNorm(t,e,n,i,r,s){return q("batchNorm")}localResponseNormalization4D(t,e,n,i,r){return q("localResponseNormalization4D")}LRNGrad(t,e,n,i,r,s,o){return q("LRNGrad")}multinomial(t,e,n,i){return q("multinomial")}oneHot(t,e,n,i){return q("oneHot")}cumsum(t,e,n,i){return q("cumsum")}nonMaxSuppression(t,e,n,i,r){return q("nonMaxSuppression")}fft(t){return q("fft")}ifft(t){return q("ifft")}complex(t,e){return q("complex")}real(t){return q("real")}imag(t){return q("imag")}cropAndResize(t,e,n,i,r,s){return q("cropAndResize")}depthToSpace(t,e,n){return q("depthToSpace")}split(t,e,n){return q("split")}sparseToDense(t,e,n,i){return q("sparseToDense")}diag(t){return q("diag")}fill(t,e,n){return q("fill")}onesLike(t){return q("onesLike")}zerosLike(t){return q("zerosLike")}linspace(t,e,n){return q("linspace")}dispose(){return q("dispose")}}function q(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function H(t){let e=t.length,n=0,i=0;for(;e>0;)i=Math.random()*e|0,e--,n=t[e],t[e]=t[i],t[i]=n}function X(t,e,n){return Math.max(t,Math.min(e,n))}function Y(t){return t%2===0?t:t+1}function K(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function Q(t,e){const n=Math.random();return e*n+(1-n)*t}function Z(t,e){let n=0;for(let i=0;i<t.length;i++){const r=Number(t[i])-Number(e[i]);n+=r*r}return n}function J(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function $(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";J(rt(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}function tt(t){J(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function et(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||xt(t)&&!n)for(let i=0;i<t.length;++i)et(t[i],e,n);else e.push(t);return e}function nt(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function it(t){return 0===t.length}function rt(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function st(t){return t%1===0}function ot(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function at(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function ct(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return H(e),e}function lt(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function ut(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0;return new Promise(((i,r)=>{let s=0;const o=()=>{if(t())return void i();s++;const a=e(s);null!=n&&s>=n?r():setTimeout(o,a)};o()}))}function ht(t,e){let n=1,i=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(-1===t[s]){if(-1!==i)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(i," and dim ").concat(s));i=s}else if(t[s]<0)throw Error("Shapes can not be < 0. Found ".concat(t[s]," at dim ").concat(s));if(-1===i){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));const r=t.slice();return r[i]=e/n,r}function dt(t,e){const n=e.length;return J((t=null==t?e.map(((t,e)=>e)):[].concat(t)).every((t=>t>=-n&&t<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t))),J(t.every((t=>st(t))),(()=>"All values in axis param must be integers but "+"got axis ".concat(t))),t.map((t=>t<0?n+t:t))}function pt(t,e){const n=[],i=[],r=null!=e&&Array.isArray(e)&&0===e.length,s=null==e||r?null:dt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(null!=s){if(s[o]===a&&1!==t[a])throw new Error("Can't squeeze axis ".concat(a," since its dim '").concat(t[a],"' is not 1"));(null==s[o]||s[o]>a)&&1===t[a]&&(n.push(t[a]),i.push(a)),s[o]<=a&&o++}1!==t[a]&&(n.push(t[a]),i.push(a))}return{newShape:n,keptDims:i}}function ft(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type ".concat(t));n=new Uint8Array(e)}return n}function mt(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function gt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(isNaN(i)||!isFinite(i))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(i,"."))}}function vt(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function yt(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function xt(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function bt(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function wt(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function St(t){return"string"===typeof t||t instanceof String}function _t(t){return"boolean"===typeof t}function Tt(t){return"number"===typeof t}function Et(t){return Array.isArray(t)?Et(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":Tt(t)?"float32":St(t)?"string":_t(t)?"bool":"float32"}function Ct(t){return!!(t&&t.constructor&&t.call&&t.apply)}function kt(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function At(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let i=e-3;i>=0;--i)n[i]=n[i+1]*t[i+1];return n}function It(t,e,n){const i=new Array;if(1===e.length){const r=e[0];for(let e=0;e<r;e++)i[e]=n[t+e]}else{const r=e[0],s=e.slice(1),o=s.reduce(((t,e)=>t*e));for(let e=0;e<r;e++)i[e]=It(t+e*o,s,n)}return i}function Ot(t,e){if(0===t.length)return e[0];const n=t.reduce(((t,e)=>t*e));if(0===n)return[];if(n!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length,"."));return It(0,t,e)}function Rt(t,e){const n=Nt(t,e);for(let i=0;i<n.length;i++)n[i]=1;return n}function Nt(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function Mt(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return Ot(t,new Float32Array(n));if("int32"===e)return Ot(t,new Int32Array(n));if("bool"===e)return Ot(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function Dt(t){t.forEach((e=>{J(Number.isInteger(e)&&e>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")))}))}function Pt(t,e,n){if(0===e)return 0;if(1===e)return t[0];let i=t[t.length-1];for(let r=0;r<t.length-1;++r)i+=n[r]*t[r];return i}function Ft(t,e,n){if(0===e)return[];if(1===e)return[t];const i=new Array(e);for(let r=0;r<i.length-1;++r)i[r]=Math.floor(t/n[r]),t-=i[r]*n[r];return i[i.length-1]=t,i}function Lt(t){return t&&t.then&&"function"===typeof t.then}const Bt="tfjsflags";class zt{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,".")),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Lt(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,i[0],i[1]),i.join("=")})),e}(this.global.location.search);if(Bt in t){t[Bt].split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if("".concat(+e)===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(e,n)}))}}}function Ut(){return Vt}let jt,Vt=null;function Wt(){if(null==jt){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}jt=t}return jt}function Gt(t,e){const n=function(){const t=Wt();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const i=e();return n.set(t,i),n.get(t)}}const qt="Abs",Ht="Acos",Xt="Acosh",Yt="Add",Kt="AddN",Qt="All",Zt="Any",Jt="ArgMax",$t="ArgMin",te="Asin",ee="Asinh",ne="Atan",ie="Atanh",re="Atan2",se="AvgPool",oe="AvgPoolGrad",ae="AvgPool3D",ce="AvgPool3DGrad",le="BatchMatMul",ue="BatchToSpaceND",he="Bincount",de="BroadcastTo",pe="Cast",fe="Ceil",me="ClipByValue",ge="Complex",ve="ComplexAbs",ye="Concat",xe="Conv2D",be="Conv2DBackpropFilter",we="Conv2DBackpropInput",Se="Conv3D",_e="Conv3DBackpropFilterV2",Te="Conv3DBackpropInputV2",Ee="Cos",Ce="Cosh",ke="Cumsum",Ae="CropAndResize",Ie="DenseBincount",Oe="DepthToSpace",Re="DepthwiseConv2dNative",Ne="DepthwiseConv2dNativeBackpropFilter",Me="DepthwiseConv2dNativeBackpropInput",De="Diag",Pe="Dilation2D",Fe="Dilation2DBackpropInput",Le="Dilation2DBackpropFilter",Be="RealDiv",ze="Elu",Ue="EluGrad",je="Erf",Ve="Equal",We="Exp",Ge="ExpandDims",qe="Expm1",He="FFT",Xe="Fill",Ye="FlipLeftRight",Ke="Floor",Qe="FloorDiv",Ze="FusedBatchNorm",Je="GatherV2",$e="GatherNd",tn="Greater",en="GreaterEqual",nn="Identity",rn="IFFT",sn="Imag",on="IsFinite",an="IsInf",cn="IsNan",ln="LeakyRelu",un="Less",hn="LessEqual",dn="LinSpace",pn="Log",fn="Log1p",mn="LogicalAnd",gn="LogicalNot",vn="LogicalOr",yn="LogSoftmax",xn="LRN",bn="LRNGrad",wn="Max",Sn="Maximum",_n="MaxPool",Tn="MaxPoolGrad",En="MaxPool3D",Cn="MaxPool3DGrad",kn="MaxPoolWithArgmax",An="Mean",In="Min",On="Minimum",Rn="MirrorPad",Nn="Mod",Mn="Multinomial",Dn="Multiply",Pn="Neg",Fn="NotEqual",Ln="NonMaxSuppressionV3",Bn="NonMaxSuppressionV4",zn="NonMaxSuppressionV5",Un="OnesLike",jn="OneHot",Vn="Pack",Wn="PadV2",Gn="Pool",qn="Pow",Hn="Prelu",Xn="Prod",Yn="Range",Kn="Real",Qn="Reciprocal",Zn="Relu",Jn="Reshape",$n="ResizeNearestNeighbor",ti="ResizeNearestNeighborGrad",ei="ResizeBilinear",ni="ResizeBilinearGrad",ii="Relu6",ri="Reverse",si="Round",oi="Rsqrt",ai="ScatterNd",ci="Select",li="Selu",ui="Slice",hi="Sin",di="Sinh",pi="Sign",fi="Sigmoid",mi="Softplus",gi="Sqrt",vi="Sum",yi="SpaceToBatchND",xi="SplitV",bi="Softmax",wi="SquaredDifference",Si="Square",_i="Sub",Ti="SparseToDense",Ei="StridedSlice",Ci="Tan",ki="Tanh",Ai="Tile",Ii="TopK",Oi="Transpose",Ri="Unique",Ni="Unpack",Mi="UnsortedSegmentSum",Di="ZerosLike",Pi="Step",Fi="FromPixels",Li="RotateWithOffset",Bi="_FusedMatMul",zi="FusedConv2D",Ui="FusedDepthwiseConv2D",ji=Gt("kernelRegistry",(()=>new Map)),Vi=Gt("gradRegistry",(()=>new Map));function Wi(t,e){const n=Zi(t,e);return ji.get(n)}function Gi(t){return Vi.get(t)}function qi(t){const e=ji.entries(),n=[];for(;;){const{done:i,value:r}=e.next();if(i)break;const[s,o]=r,[a]=s.split("_");a===t&&n.push(o)}return n}function Hi(t){const{kernelName:e,backendName:n}=t,i=Zi(e,n);ji.has(i)&&console.warn("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),ji.set(i,t)}function Xi(t){const{kernelName:e}=t;Vi.has(e)&&Ut().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(e,"'")),Vi.set(e,t)}function Yi(t,e){const n=Zi(t,e);if(!ji.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));ji.delete(n)}function Ki(t){if(!Vi.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));Vi.delete(t)}function Qi(t,e){qi(t).forEach((t=>{Hi(Object.assign({},t,{backendName:e}))}))}function Zi(t,e){return"".concat(e,"_").concat(t)}class Ji{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new tr)}profileKernel(t,e,n){let i;const r=this.backendTimer.time((()=>{i=n()}));if(Ut().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<i.length;s++){const e=i[s];e.data().then((n=>{$i(n,e.dtype,t)}))}return{kernelName:t,outputs:i,inputs:e,timeMs:r.then((t=>t.kernelMs)),extraInfo:r.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:i,inputs:r,extraInfo:s}=t;n.forEach((t=>{Promise.all([t.data(),i,s]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],r,n[2])}))}))}}function $i(t,e,n){if("float32"!==e)return!1;for(let i=0;i<t.length;i++){const e=t[i];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class tr{logKernelProfile(t,e,n,i,r,s){const o="number"===typeof i?lt("".concat(i,"ms"),9):i.error,a=lt(t,25),c=e.rank,l=e.size,u=lt(e.shape.toString(),14);let h="";for(const d in r){const t=r[d];if(null!=t){const n=t.shape||e.shape,i=n.length;h+="".concat(d,": ").concat(i,"D ").concat(i>0?n:""," ")}}console.log("%c".concat(a,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(u,"\t%c").concat(l,"\t%c").concat(h,"\t%c").concat(s),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}const er=20,nr=3,ir=7;function rr(t,e,n,i){const r=At(e),s=function(t,e,n,i){const r=nt(e),s=i[i.length-1],o=new Array(s).fill(0),a=e.length,c="complex64"===n?cr(t):t;if(a>1)for(let l=0;l<r/s;l++){const t=l*s;for(let e=0;e<s;e++)o[e]=Math.max(o[e],sr(c[t+e],0,n).length)}return o}(t,e,n,r),o=e.length,a=ar(t,e,n,r,s),c=["Tensor"];return i&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(o)),c.push("  shape: [".concat(e,"]")),c.push("  values:")),c.push(a.map((t=>"    "+t)).join("\n")),c.join("\n")}function sr(t,e,n){let i;return i=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(ir))," + ")+"".concat(parseFloat(t[1].toFixed(ir)),"j"):St(t)?"'".concat(t,"'"):"bool"===n?or(t):parseFloat(t.toFixed(ir)).toString(),lt(i,e)}function or(t){return 0===t?"false":"true"}function ar(t,e,n,i,r){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o="complex64"===n?2:1,a=e[0],c=e.length;if(0===c){if("complex64"===n){return[sr(cr(t)[0],0,n)]}return"bool"===n?[or(t[0])]:[t[0].toString()]}if(1===c){if(a>er){const e=nr*o;let i=Array.from(t.slice(0,e)),s=Array.from(t.slice((a-nr)*o,a*o));return"complex64"===n&&(i=cr(i),s=cr(s)),["["+i.map(((t,e)=>sr(t,r[e],n))).join(", ")+", ..., "+s.map(((t,e)=>sr(t,r[a-nr+e],n))).join(", ")+"]"]}return["["+("complex64"===n?cr(t):Array.from(t)).map(((t,e)=>sr(t,r[e],n))).join(", ")+"]"]}const l=e.slice(1),u=i.slice(1),h=i[0]*o,d=[];if(a>er){for(let e=0;e<nr;e++){const i=e*h,s=i+h;d.push(...ar(t.slice(i,s),l,n,u,r,!1))}d.push("...");for(let e=a-nr;e<a;e++){const i=e*h,s=i+h;d.push(...ar(t.slice(i,s),l,n,u,r,e===a-1))}}else for(let m=0;m<a;m++){const e=m*h,i=e+h;d.push(...ar(t.slice(e,i),l,n,u,r,m===a-1))}const p=2===c?",":"";d[0]="["+d[0]+p;for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+p;let f=",\n";for(let m=2;m<c;m++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":f),d}function cr(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}function lr(t,e){return"string"===e?pr(t):ur([t],e)}function ur(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=et(t)),Ut().getBool("DEBUG")&&gt(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type ".concat(e))}function hr(){return Ut().platform.now()}function dr(t,e){return Ut().platform.fetch(t,e)}function pr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Ut().platform.encode(t,e)}function fr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",Ut().platform.decode(t,e)}class mr{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=nt(t),null!=n){const t=n.length;J(t===this.size,(()=>"Length of values '".concat(t,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||mt(e,this.size),this.strides=At(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];0===n.length&&(n=[0]),J(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const r=this.locToIndex(n);this.values[r]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let i=0;for(const s of e){if(s<0||s>=this.shape[i]){const t="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(t)}i++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return gr().makeTensor(this.values,this.shape,this.dtype)}}let gr=null,vr=null,yr=null;class xr{constructor(t,e,n,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=nt(t),this.strides=At(t),this.dataId=n,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return vr.buffer(this.shape,this.dtype,t)}bufferSync(){return vr.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Ot(this.shape,t)}arraySync(){return Ot(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=gr().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map((t=>fr(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=gr().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>fr(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await gr().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(gr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return vr.print(this,t)}clone(){return this.throwIfDisposed(),vr.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return rr(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),vr.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),gr().makeVariable(this,t,e,n)}}Object.defineProperty(xr,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed});class br extends xr{constructor(t,e,n,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!rt(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));gr().disposeTensor(this),this.dataId=t.dataId,gr().incRef(this,null)}dispose(){gr().disposeVariable(this),this.isDisposedInternal=!0}}var wr,Sr,_r,Tr,Er;Object.defineProperty(br,Symbol.hasInstance,{value:t=>t instanceof xr&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(wr||(wr={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Sr||(Sr={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(_r||(_r={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Tr||(Tr={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Er||(Er={}));const Cr={float32:Tr,int32:Sr,bool:_r,complex64:Er};function kr(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return Cr[t][e]}function Ar(t){return kr(t,"int32")}function Ir(t,e){if(t.dtype===e.dtype)return[t,e];const n=kr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Or(t,e){J(t.dtype===e.dtype,(()=>"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")))}function Rr(t,e){return e.some((e=>e.id===t.id))}function Nr(t){const e=[];return Mr(t,e,new Set),e}function Mr(t,e,n){if(null==t)return;if(t instanceof xr)return void e.push(t);if(i=t,!Array.isArray(i)&&"object"!==typeof i)return;var i;const r=t;for(const s in r){const t=r[s];n.has(t)||(n.add(t),Mr(t,e,n))}}class Dr{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Pr{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Dr}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(console.warn("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Ji(this.backendInstance),!0}setupRegisteredKernels(){qi(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){qi(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof G||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,i=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn("Initialization of backend ".concat(t," failed")),console.warn(n.stack||n.message)),!1)));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}}catch(n){return console.warn("Initialization of backend ".concat(t," failed")),console.warn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:i,asyncInit:r}=this.initializeBackend(n);if(r||i)return{name:n,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),i=n.backend,r=this.readSync(e);i.disposeData(e),n.backend=t,t.move(e,r,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,i=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((()=>this.startScope(i)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(i){throw e(),i}}nextTensorId(){return Pr.nextTensorId++}nextVariableId(){return Pr.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e="float32",n={x:t},i={dtype:e};return Lr.runKernelFunc((n=>n.cast(t,e)),n,null,pe,i)}})),[],{}),e}runKernel(t,e,n,i,r){return this.runKernelFunc(null,e,null,t,n,i,r)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const i=this.backend.numDataIds();let r=0;n.forEach((t=>{r+="complex64"===t.dtype?3:1}));const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-e-r-s;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))}runKernelFunc(t,e,n,i,r,s,o){let a,c=[];const l=this.isTapeOn();null==i&&(i=null!=this.state.activeScope?this.state.activeScope.name:"");const u=this.state.numBytes,h=this.state.numTensors;let d;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const p=Wi(i,this.backendName);let f,m;if(null!=p)d=()=>{const t=this.backend.numDataIds();f=p.kernelFunc({inputs:e,attrs:r,backend:this.backend});const n=Array.isArray(f)?f:[f];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,t,n);const a=n.map((t=>{if(null!=t.rank)return t;const{dataId:e,shape:n,dtype:i}=t;return this.makeTensorFromDataId(e,n,i)}));if(l){let t=this.getTensorsForGradient(i,e,a);if(null==t){null==o&&(o=[]);const e=a.filter(((t,e)=>o[e]));t=(s||[]).slice().concat(e)}c=this.saveTensorsForBackwardMode(t)}return a};else{if(null==t)throw new Error("Error running ".concat(i,": Neither modular kernel nor forward func passed"));const e=t=>{l&&(c=t.map((t=>this.keep(this.clone(t)))))};d=()=>{const n=this.backend.numDataIds();f=this.tidy((()=>t(this.backend,e)));const r=Array.isArray(f)?f:[f];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,n,r),r}}return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(m=this.profiler.profileKernel(i,e,(()=>d())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),a=m.outputs):a=d()})),l&&this.addTapeNode(i,e,a,n,c,r),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-u,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((t=>null!=e[t]?e[t].shape:null)),outputShapes:a.map((t=>t.shape)),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(f)?a:a[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const i=Gi(t);if(null!=i){const t=i.inputsToSave||[],r=i.outputsToSave||[];let s;i.saveAllInputs?(J(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),s=Object.keys(e).map((t=>e[t]))):s=t.map((t=>e[t]));const o=n.filter(((t,e)=>r[e]));return s.concat(o)}return null}makeTensor(t,e,n,i){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",i=i||this.backend;let r=t;"string"===n&&St(t[0])&&(r=t.map((t=>pr(t))));const s=i.write(r,e,n),o=new xr(e,n,s,this.nextTensorId());if(this.incRef(o,i),"string"===n){const t=this.state.tensorInfo.get(s),e=wt(r);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,i){const r=new xr(e,n=n||"float32",t,this.nextTensorId());return this.incRef(r,i),r}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=i&&i!==t.dtype&&(t=t.cast(i));const r=new br(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw new Error("Variable with name ".concat(r.name," was already registered"));return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*bt(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof br||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):(e.backend.decComplexRef(t.dataId),this.state.tensorInfo.get(t.dataId).refCount--)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,i,r,s){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:r},a=Gi(t);null!=a&&(i=a.gradFunc),null!=i&&(o.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],i=Nt(t.size,t.dtype);return this.makeTensor(i,t.shape,t.dtype)}return t})),i(t.length>1?t:t[0],r,s))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Nr(t),n=new Set(e.map((t=>t.id)));for(let r=0;r<this.state.activeScope.track.length;r++){const t=this.state.activeScope.track[r];t.kept||n.has(t.id)||t.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==i.id||this.track(t)}))}gradients(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(J(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const r=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));J(r instanceof xr,(()=>"The result y returned by f() must be a tensor."));const s=function(t,e,n){const i={},r={};for(let c=0;c<e.length;c++)i[e[c].id]=!0;for(let c=0;c<t.length;c++){const n=t[c],s=n.inputs;for(const t in s){const o=s[t];let a=!1;for(let t=0;t<e.length;t++)if(i[o.id]){n.outputs.forEach((t=>i[t.id]=!0)),a=!0,r[n.id]=!0;break}if(a)break}}const s={};s[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const e=t[c],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(s[e.outputs[t].id]){for(const t in n)s[n[t].id]=!0,o[e.id]=!0;break}}const a=[];for(let c=0;c<t.length;c++){const e=t[c];if(r[e.id]&&o[e.id]){const t={};for(const r in e.inputs){const n=e.inputs[r];i[n.id]&&(t[r]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,a.push(n)}}return a}(this.state.activeTape,e,r);if(!i&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[r.id]=null==n?function(t){const e=Rt(nt(t),"float32");return Lr.makeTensor(e,t,"float32")}(r.shape):n,function(t,e,n,i){for(let r=e.length-1;r>=0;r--){const s=e[r],o=[];if(s.outputs.forEach((e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)})),null==s.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(s.kernelName,"."));const a=s.gradient(o);for(const e in s.inputs){if(!(e in a))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(a),"."));const r=n((()=>a[e]()));if("float32"!==r.dtype)throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(r.dtype,"'"));const o=s.inputs[e];if(!rt(r.shape,o.shape))throw new Error("Error in gradient for op ".concat(s.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(r.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=r;else{const e=t[o.id];t[o.id]=i(e,r),e.dispose()}}}}(t,s,(t=>this.tidy(t)),Br);const i=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:r,grads:i}}))}customGrad(t){var e=this;return J(Ct(t),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];let s;J(i.every((t=>t instanceof xr)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};return i.forEach(((t,e)=>{o[e]=t})),e.runKernelFunc(((e,n)=>(s=t(...i,n),J(s.value instanceof xr,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),J(Ct(s.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),s.value)),o,((t,e)=>{const n=s.gradFunc(t,e),r=Array.isArray(n)?n:[n];J(r.length===i.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),J(r.every((t=>t instanceof xr)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return r.forEach(((t,e)=>{o[e]=()=>t})),o}))}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=hr(),n=await this.backend.time(t);return n.wallMs=hr()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Dr;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function Fr(){const t=Wt();if(null==t._tfengine){const e=new zt(t);t._tfengine=new Pr(e)}var e;return e=t._tfengine.ENV,Vt=e,gr=()=>t._tfengine,t._tfengine}Pr.nextTensorId=0,Pr.nextVariableId=0;const Lr=Fr();function Br(t,e){const n={a:t,b:e};return Lr.runKernel(Yt,n)}function zr(){if("undefined"!==typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Ur(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const jr=Ut();function Vr(t,e){let n=t;if(xt(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const i=[];for(;Array.isArray(n)||xt(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&Ut().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Wr(t,i,[]),i}function Wr(t,e,n){if(n=n||[],!Array.isArray(t)&&!xt(t))return void J(0===e.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")));J(e.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements"))),J(t.length===e[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")));const i=e.slice(1);for(let r=0;r<t.length;++r)Wr(t[r],i,n.concat(r))}function Gr(t,e,n,i){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(i,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function qr(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof xr)return Gr(i,t.dtype,e,n),t;let r=Et(t);if("string"!==r&&["bool","int32","float32"].indexOf(i)>=0&&(r=i),Gr(i,r,e,n),null==t||!xt(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const i=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}const s=Vr(t,r);xt(t)||Array.isArray(t)||(t=[t]);const o="string"!==r?ur(t,r):et(t,[],!0);return Lr.makeTensor(o,s,r)}function Hr(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map(((t,r)=>qr(t,"".concat(e,"[").concat(r,"]"),n,i)))}jr.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),jr.registerFlag("IS_BROWSER",(()=>Ur())),jr.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),jr.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),jr.registerFlag("PROD",(()=>!1)),jr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>jr.getBool("DEBUG"))),jr.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),jr.registerFlag("IS_TEST",(()=>!1)),jr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>!0));const Xr="__op";function Yr(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let n=e[0];const i=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Xr;const r=function(){Lr.startScope(n);try{const t=i(...arguments);return Lt(t)&&console.error("Cannot return a Promise inside of tidy."),Lr.endScope(t),t}catch(t){throw Lr.endScope(null),t}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}const Kr=Yr({complex_:function(t,e){const n=qr(t,"real","complex"),i=qr(e,"imag","complex");$(n.shape,i.shape,"real and imag shapes, ".concat(n.shape," and ").concat(i.shape,", ")+"must match in call to tf.complex().");const r={real:n,imag:i};return Lr.runKernel(ge,r)}});function Qr(t,e,n,i){if(null==i&&(i=Et(t)),"complex64"===i)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!xt(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Dt(e);const t=nt(e),i=nt(n);J(t===i,(()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(t," values but has ").concat(i)));for(let r=0;r<n.length;++r){const t=n[r],i=r!==n.length-1||t!==nt(e.slice(r));J(n[r]===e[r]||!i,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")))}}return xt(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==i?ur(t,i):et(t,[],!0),Lr.makeTensor(t,e,i)}function Zr(t,e,n){return Qr(t,e,Vr(t,n),n)}const Jr={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},$r=4;async function ts(t,e){const n=[],i=[],r=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let s=0;s<r.length;++s){const o=r[s],a=Array.isArray(t)?t[s].tensor:t[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(a.dtype));const c={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const t=new Promise((async t=>{const e=await a.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+$r*e.length,i=new Uint8Array(n);let r=0;for(let s=0;s<e.length;s++){const t=e[s],n=new Uint8Array(new Uint32Array([t.length]).buffer);i.set(n,r),r+=$r,i.set(t,r),r+=t.length}t(i)}));i.push(t)}else i.push(a.data());null!=e&&(c.group=e),n.push(c)}return{data:ns(await Promise.all(i)),specs:n}}function es(t,e){const n={};let i,r=0;for(const s of e){const e=s.name,o=s.dtype,a=s.shape,c=nt(a);let l;if("quantization"in s){const n=s.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error("Weight ".concat(s.name," with quantization ").concat(n.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==n.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(n.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==o)throw new Error("Weight ".concat(s.name," is quantized with ").concat(n.dtype," ")+"which only supports weights of type float32 not ".concat(o,"."))}const a=Jr[n.dtype],u=t.slice(r,r+c*a),h="uint8"===n.dtype?new Uint8Array(u):new Uint16Array(u);if("float32"===o)if("uint8"===n.dtype||"uint16"===n.dtype){l=new Float32Array(h.length);for(let t=0;t<h.length;t++){const e=h[t];l[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," ")+"for weight type float32.");void 0===i&&(i=cs()),l=i(h)}else{if("int32"!==o)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(o));if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," ")+"for weight type int32.");l=new Int32Array(h.length);for(let t=0;t<h.length;t++){const e=h[t];l[t]=Math.round(e*n.scale+n.min)}}r+=c*a}else if("string"===o){const e=nt(s.shape);l=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(r,r+$r))[0];r+=$r;const n=new Uint8Array(t.slice(r,r+e));l.push(n),r+=e}}else{const i=Jr[o],s=t.slice(r,r+c*i);if("float32"===o)l=new Float32Array(s);else if("int32"===o)l=new Int32Array(s);else if("bool"===o)l=new Uint8Array(s);else{if("complex64"!==o)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(o));{l=new Float32Array(s);const t=new Float32Array(l.length/2),i=new Float32Array(l.length/2);for(let e=0;e<t.length;e++)t[e]=l[2*e],i[e]=l[2*e+1];const r=Zr(t,a,"float32"),o=Zr(i,a,"float32");n[e]=Kr(r,o),r.dispose(),o.dispose()}}r+=c*i}"complex64"!==o&&(n[e]=Zr(l,a,o))}return n}function ns(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));const i=new Uint8Array(e);let r=0;return n.forEach((t=>{i.set(new Uint8Array(t.buffer),r),r+=t.byteLength})),i.buffer}const is="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function rs(t){return is?Buffer.byteLength(t):new Blob([t]).size}function ss(t){if(1===t.length)return t[0];let e=0;t.forEach((t=>{e+=t.byteLength}));const n=new Uint8Array(e);let i=0;return t.forEach((t=>{n.set(new Uint8Array(t),i),i+=t.byteLength})),n.buffer}function os(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function as(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:rs(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:rs(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function cs(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return i=>{const r=new ArrayBuffer(4*i.length),s=new Uint32Array(r);for(let o=0;o<i.length;o++){const r=i[o],a=t[n[r>>10]+(1023&r)]+e[r>>10];s[o]=a}return new Float32Array(r)}}class ls{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==ls.instance&&(ls.instance=new ls),ls.instance}static registerSaveRouter(t){ls.getInstance().saveRouters.push(t)}static registerLoadRouter(t){ls.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return ls.getHandlers(t,"save")}static getLoadHandlers(t,e){return ls.getHandlers(t,"load",e)}static getHandlers(t,e,n){const i=[];return("load"===e?ls.getInstance().loadRouters:ls.getInstance().saveRouters).forEach((e=>{const r=e(t,n);null!==r&&i.push(r)})),i}}const us=t=>ls.registerSaveRouter(t),hs=t=>ls.registerLoadRouter(t),ds=t=>ls.getSaveHandlers(t),ps=(t,e)=>ls.getLoadHandlers(t,e),fs="tensorflowjs",ms="models_store",gs="model_info_store";function vs(){if(!Ut().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ys(t){const e=t.result;e.createObjectStore(ms,{keyPath:"modelPath"}),e.createObjectStore(gs,{keyPath:"modelPath"})}class xs{constructor(t){if(this.indexedDB=vs(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const i=this.indexedDB.open(fs,1);i.onupgradeneeded=()=>ys(i),i.onsuccess=()=>{const r=i.result;if(null==e){const e=r.transaction(ms,"readonly"),i=e.objectStore(ms).get(this.modelPath);i.onsuccess=()=>{if(null==i.result)return r.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));t(i.result.modelArtifacts)},i.onerror=t=>(r.close(),n(i.error)),e.oncomplete=()=>r.close()}else{const i=as(e),s=r.transaction(gs,"readwrite");let o=s.objectStore(gs);const a=o.put({modelPath:this.modelPath,modelArtifactsInfo:i});let c;a.onsuccess=()=>{c=r.transaction(ms,"readwrite");const a=c.objectStore(ms).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:i});a.onsuccess=()=>t({modelArtifactsInfo:i}),a.onerror=t=>{o=s.objectStore(gs);const e=o.delete(this.modelPath);e.onsuccess=()=>(r.close(),n(a.error)),e.onerror=t=>(r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==c?r.close():c.oncomplete=()=>r.close()}}},i.onerror=t=>n(i.error)}))}}xs.URL_SCHEME="indexeddb://";const bs=t=>{return Ut().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xs.URL_SCHEME)?(e=t.slice(xs.URL_SCHEME.length),new xs(e)):null;var e};ls.registerSaveRouter(bs),ls.registerLoadRouter(bs);class ws{constructor(){this.indexedDB=vs()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(fs,1);n.onupgradeneeded=()=>ys(n),n.onsuccess=()=>{const i=n.result,r=i.transaction(gs,"readonly"),s=r.objectStore(gs).getAll();s.onsuccess=()=>{const e={};for(const t of s.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},s.onerror=t=>(i.close(),e(s.error)),r.oncomplete=()=>i.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(xs.URL_SCHEME)?e.slice(xs.URL_SCHEME.length):e,new Promise(((e,n)=>{const i=this.indexedDB.open(fs,1);i.onupgradeneeded=()=>ys(i),i.onsuccess=()=>{const r=i.result,s=r.transaction(gs,"readwrite"),o=s.objectStore(gs),a=o.get(t);let c;a.onsuccess=()=>{if(null==a.result)return r.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));{const i=o.delete(t),s=()=>{c=r.transaction(ms,"readwrite");const i=c.objectStore(ms).delete(t);i.onsuccess=()=>e(a.result.modelArtifactsInfo),i.onerror=t=>n(a.error)};i.onsuccess=s,i.onerror=t=>(s(),r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==c?r.close():c.oncomplete=()=>r.close()}},i.onerror=t=>n(i.error)}))}}const Ss="/",_s="tensorflowjs_models",Ts="info",Es="model_topology",Cs="weight_specs",ks="weight_data",As="model_metadata";function Is(t){return{info:[_s,t,Ts].join(Ss),topology:[_s,t,Es].join(Ss),weightSpecs:[_s,t,Cs].join(Ss),weightData:[_s,t,ks].join(Ss),modelMetadata:[_s,t,As].join(Ss)}}function Os(t){const e=t.split(Ss);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(Ss)}class Rs{constructor(t){if(!Ut().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Is(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),i=JSON.stringify(t.weightSpecs),r=as(t);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,i),this.LS.setItem(this.keys.weightData,function(t){if(is)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);return btoa(n)}(t.weightData));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:r}}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(r.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(r.weightSpecsBytes,", ")+"weightDataBytes=".concat(r.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");e.modelTopology=n;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==i)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");e.weightSpecs=i;const r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){const t=JSON.parse(r);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer)}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=function(t){if(is){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)n.set([e.charCodeAt(i)],i);return n.buffer}(s),e}}Rs.URL_SCHEME="localstorage://";const Ns=t=>{return Ut().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Rs.URL_SCHEME)?(e=t.slice(Rs.URL_SCHEME.length),new Rs(e)):null;var e};ls.registerSaveRouter(Ns),ls.registerLoadRouter(Ns);class Ms{constructor(){J(Ut().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),J("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=_s+Ss,n=Ss+Ts;for(let i=0;i<this.LS.length;++i){const r=this.LS.key(i);if(r.startsWith(e)&&r.endsWith(n)){t[Os(r)]=JSON.parse(this.LS.getItem(r))}}return t}async removeModel(t){var e;const n=Is(t=(e=t).startsWith(Rs.URL_SCHEME)?e.slice(Rs.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const i=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),i}}const Ds="://";class Ps{constructor(){this.managers={}}static getInstance(){return null==Ps.instance&&(Ps.instance=new Ps),Ps.instance}static registerManager(t,e){J(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(Ds)&&(t=t.slice(0,t.indexOf(Ds))),J(t.length>0,(()=>"scheme must not be an empty string."));const n=Ps.getInstance();J(null==n.managers[t],(()=>"A model store manager is already registered for scheme '".concat(t,"'."))),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function Fs(t){if(-1===t.indexOf(Ds))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Ps.getSchemes().join(",")));return{scheme:t.split(Ds)[0],path:t.split(Ds)[1]}}async function Ls(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];J(t!==e,(()=>"Old path and new path are the same: '".concat(t,"'")));const i=ls.getLoadHandlers(t);J(i.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(t,"."))),J(i.length<2,(()=>"Copying failed because more than one (".concat(i.length,") ")+"load handlers for source URL ".concat(t,".")));const r=i[0],s=ls.getSaveHandlers(e);J(s.length>0,(()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,"."))),J(s.length<2,(()=>"Copying failed because more than one (".concat(i.length,") ")+"save handlers for destination URL ".concat(e,".")));const o=s[0],a=Fs(t).scheme,c=Fs(t).path,l=a===Fs(t).scheme,u=await r.load();n&&l&&await Ps.getManager(a).removeModel(c);const h=await o.save(u);return n&&!l&&await Ps.getManager(a).removeModel(c),h.modelArtifactsInfo}async function Bs(){const t=Ps.getSchemes(),e={};for(const n of t){const t=await Ps.getManager(n).listModels();for(const i in t){e[n+Ds+i]=t[i]}}return e}async function zs(t){const e=Fs(t);return Ps.getManager(e.scheme).removeModel(e.path)}async function Us(t,e){return Ls(t,e,!1)}async function js(t,e){return Ls(t,e,!0)}class Vs{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}if(Ut().get("IS_BROWSER")){Ut().setPlatform("browser",new Vs);try{Ps.registerManager(Rs.URL_SCHEME,new Ms)}catch(Mz){}try{Ps.registerManager(xs.URL_SCHEME,new ws)}catch(Mz){}}const Ws=()=>n(5410);let Gs;class qs{constructor(){this.util=n(8628),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=Ut().global.fetch?Ut().global.fetch(t,e):(null==Gs&&(Gs=Ws()),Gs(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}function Hs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",Dt(t),new mr(t,e,n)}Ut().get("IS_NODE")&&Ut().setPlatform("node",new qs);const Xs=Yr({cast_:function(t,e){const n=qr(t,"x","cast");if(!vt(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const i={x:n},r={dtype:e};return Lr.runKernel(pe,i,r)}});const Ys=Yr({clone_:function(t){const e={x:qr(t,"x","clone","string_or_numeric")};return Lr.runKernel(nn,e)}});function Ks(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}Fr();vr={buffer:Hs,cast:Xs,clone:Ys,print:Ks};function Qs(t){return new Promise((t=>setTimeout(t))).then(t)}class Zs{constructor(t){if(!Ut().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Zs.URL_SCHEME)&&(t=t.slice(Zs.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer);const r=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),s=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(s.download=this.modelTopologyFileName,s.href=r,await Qs((()=>s.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await Qs((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:as(t)}}}}Zs.URL_SCHEME="downloads://";class Js{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise(((n,i)=>{const r=new FileReader;r.onload=r=>{const s=JSON.parse(r.target.result),o=s.modelTopology;if(null==o)return void i(new Error("modelTopology field is missing from file ".concat(t.name)));0===e.length&&n({modelTopology:o});const a=s.weightsManifest;if(null==a)return void i(new Error("weightManifest field is missing from file ".concat(t.name)));let c;try{c=this.checkManifestAndWeightFiles(a,e)}catch(Mz){return void i(Mz)}const l=[],u=[],h=[];a.forEach((t=>{t.paths.forEach((t=>{u.push(t),h.push(null)})),l.push(...t.weights)})),a.forEach((t=>{t.paths.forEach((t=>{const e=new FileReader;e.onload=e=>{const i=e.target.result,r=u.indexOf(t);if(h[r]=i,-1===h.indexOf(null)){const t={modelTopology:o,weightSpecs:l,weightData:ss(h),format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy};null!=s.signature&&(t.signature=s.signature),null!=s.userDefinedMetadata&&(t.userDefinedMetadata=s.userDefinedMetadata),null!=s.modelInitializer&&(t.modelInitializer=s.modelInitializer),n(t)}},e.onerror=e=>i("Failed to weights data from file of path '".concat(t,"'.")),e.readAsArrayBuffer(c[t])}))}))},r.onerror=e=>i("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),r.readAsText(t)}))}checkManifestAndWeightFiles(t,e){const n=[],i=e.map((t=>os(t.name))),r={};for(const s of t)s.paths.forEach((t=>{const s=os(t);if(-1!==n.indexOf(s))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(s,"'"));if(n.push(s),-1===i.indexOf(s))throw new Error("Weight file with basename '".concat(s,"' is not provided."));r[t]=e[i.indexOf(s)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(n.length,") and the number of weight files provided ")+"(".concat(e.length,")."));return r}}function $s(t){return new Js(t)}function to(t,e,n,i){!function(t){J(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){J(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t))),J(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e))),J(e>=t,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)))}(n=null==n?0:n,i=null==i?1:i);let r=0;return Promise.all(t.map((s=>(s.then((s=>{const o=n+ ++r/t.length*(i-n);return e(o),s})),s))))}async function eo(t,e){null==e&&(e={});const n=null==e.fetchFunc?Ut().platform.fetch:e.fetchFunc,i=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),r=(null==e.onProgress?await Promise.all(i):await to(i,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(r):await to(r,e.onProgress,.5,1)}async function no(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return io((t=>eo(t,{requestInit:i})))(t,e,n)}function io(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;const r=e.map((()=>!1)),s={},o=null!=i?i.map((()=>!1)):[],a=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const c="quantization"in t?t.quantization.dtype:t.dtype,l=Jr[c]*nt(t.shape),u=()=>{r[e]=!0,null==s[e]&&(s[e]=[]),s[e].push({manifestEntry:t,groupOffset:n,sizeBytes:l})};null!=i?i.forEach(((e,n)=>{e===t.name&&(u(),o[n]=!0)})):u(),a.push(t.name),n+=l}))})),!o.every((t=>t))){const t=i.filter(((t,e)=>!o[e]));throw new Error("Could not find weights in manifest with names: "+"".concat(t.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(a.join(", "),"."))}const c=r.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),l=[];c.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;l.push(e)}))}));const u=await t(l),h={};let d=0;return c.forEach((t=>{const n=e[t].paths.length;let i=0;for(let e=0;e<n;e++)i+=u[d+e].byteLength;const r=new ArrayBuffer(i),o=new Uint8Array(r);let a=0;for(let e=0;e<n;e++){const t=new Uint8Array(u[d+e]);o.set(t,a),a+=t.byteLength}s[t].forEach((t=>{const e=es(r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const n in e)h[n]=e[n]})),d+=n})),h}}ls.registerSaveRouter((t=>Ut().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Zs.URL_SCHEME)?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Zs(t)}(t.slice(Zs.URL_SCHEME.length)):null));class ro{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(J("function"===typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=Ut().platform.fetch,J(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&J(2===t.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,")."))),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),e.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:as(t),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(p){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,i=e.weightsManifest,r=e.generatedBy,s=e.convertedBy,o=e.format,a=e.signature,c=e.userDefinedMetadata;if(null==n&&null==i)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");let l,u;if(null!=i){const t=await this.loadWeights(i);[l,u]=t}const h={modelTopology:n,weightSpecs:l,weightData:u,generatedBy:r,convertedBy:s,format:o};null!=a&&(h.signature=a),null!=c&&(h.userDefinedMetadata=c);const d=e.modelInitializer;return d&&(h.modelInitializer=d),h}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,i]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),i=t.substring(0,e),r=n>e?t.substring(n):"";return[i+"/",r]}(e),r=this.weightPathPrefix||n,s=[];for(const c of t)s.push(...c.weights);const o=[],a=[];for(const c of t)for(const t of c.paths)null!=this.weightUrlConverter?a.push(this.weightUrlConverter(t)):o.push(r+t+i);this.weightUrlConverter&&o.push(...await Promise.all(a));return[s,ss(await eo(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function so(t){return null!=t.match(ro.URL_SCHEME_REGEX)}ro.URL_SCHEME_REGEX=/^https?:\/\//;const oo=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>so(t))):so(t),n)return ao(t,e)}return null};function ao(t,e){return new ro(t,e)}function co(t,e){return ao(t,e)}ls.registerSaveRouter(oo),ls.registerLoadRouter(oo);class lo{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class uo{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function ho(t,e,n,i){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new lo(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lo({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lo({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:i})}function po(t){return new uo(t)}const fo=Yr({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=qr(t,"a","matMul"),s=qr(e,"b","matMul");[r,s]=Ir(r,s);const o={a:r,b:s},a={transposeA:n,transposeB:i};return Lr.runKernel(le,o,a)}});const mo=Yr({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const r={indices:qr(t,"indices","oneHot","int32")},s={depth:e,onValue:n,offValue:i};return Lr.runKernel(jn,r,s)}});const go=Yr({transpose_:function(t,e){const n=qr(t,"x","transpose");if(null==e&&(e=n.shape.map(((t,e)=>e)).reverse()),J(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(e,"."))),e.forEach((t=>{J(t>=0&&t<n.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(e)))})),n.rank<=1)return n.clone();const i={x:n},r={perm:e};return Lr.runKernel(Oi,i,r)}});const vo=Yr({confusionMatrix_:function(t,e,n){const i=qr(t,"labels","confusionMatrix"),r=qr(e,"predictions","confusionMatrix");J(null==n||n>0&&Number.isInteger(n),(()=>"If provided, numClasses must be a positive integer, "+"but got ".concat(n))),J(1===i.rank,(()=>"Expected the rank of labels to be 1, but got ".concat(i.rank))),J(1===r.rank,(()=>"Expected the rank of predictions to be 1, "+"but got ".concat(r.rank))),J(i.shape[0]===r.shape[0],(()=>"Mismatch in the number of examples: "+"".concat(i.shape[0]," vs. ").concat(r.shape[0],". ")+"Labels and predictions should have the same number of elements.")),J(n>0&&Number.isInteger(n),(()=>"numClasses is required to be a positive integer, but got "+"".concat(n)));const s=mo(Xs(i,"int32"),n),o=mo(Xs(r,"int32"),n),a=go(s),c=fo(a,o);return Xs(c,"int32")}});function yo(t,e,n){if(tt(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const i=Vr(t,n);if(3!==i.length&&1!==i.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Qr(t,e,i,n)}let xo;async function bo(t,e){let n=qr(t,"img","toPixels");if(!(t instanceof xr)){const t=n;n=Xs(t,"int32"),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(n.rank,"."));const[i,r]=n.shape.slice(0,2),s=2===n.rank?1:n.shape[2];if(s>4||2===s)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(s));if("float32"!==n.dtype&&"int32"!==n.dtype)throw new Error("Unsupported type for toPixels: ".concat(n.dtype,".")+" Please use float32 or int32 tensors.");const o=await n.data(),a="float32"===n.dtype?255:1,c=new Uint8ClampedArray(r*i*4);for(let l=0;l<i*r;++l){const t=[0,0,0,255];for(let i=0;i<s;i++){const e=o[l*s+i];if("float32"===n.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===n.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===s?(t[0]=e*a,t[1]=e*a,t[2]=e*a):t[i]=e*a}const e=4*l;c[e+0]=Math.round(t[0]),c[e+1]=Math.round(t[1]),c[e+2]=Math.round(t[2]),c[e+3]=Math.round(t[3])}if(null!=e){e.width=r,e.height=i;const t=e.getContext("2d"),n=new ImageData(c,r,i);t.putImageData(n,0,0)}return n!==t&&n.dispose(),c}const wo=Yr({fromPixels_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,i=!1,r=!1,s=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)i=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)r=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)s=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));a=!0}if(r){const e=2;if(r&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Wi(Fi,Lr.backendName)){const n={pixels:t},i={numChannels:e};return Lr.runKernel(Fi,n,i)}const[c,l]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let u,h;if(o?u=t.getContext("2d").getImageData(0,0,c,l).data:i||n?u=t.data:(s||r||a)&&(null==xo&&(xo=document.createElement("canvas").getContext("2d")),xo.canvas.width=c,xo.canvas.height=l,xo.drawImage(t,0,0,c,l),u=xo.getImageData(0,0,c,l).data),4===e)h=new Int32Array(u);else{const t=c*l;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=u[4*n+t]}return yo(h,[l,c,e],"int32")}});function So(t,e){const n=t.shape.length,i=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(i<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(i,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[i-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[i-1]," vs. ").concat(n));if(0===nt(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));const r=e.shape,s=r[r.length-1];let o=1;for(let h=0;h<r.length-1;++h)o*=r[h];const a=t.shape,c=r.slice();c.pop();let l=1;for(let h=s;h<n;++h)l*=a[h],c.push(a[h]);const u=[...At(t.shape).map((t=>t/l)),1].slice(0,s);return[c,o,l,u]}function _o(t,e,n){const i=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(i,", and batchDim: ").concat(r,".");if(n.rank<r)throw new Error(s+" update.rank < ".concat(r,". "));if(t.length<i+(n.rank-r))throw new Error(s+" Output shape length < ".concat(i+(n.rank-r)));if(n.rank!==r+t.length-i)throw new Error(s+" update.rank != ".concat(r+t.length-i));for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(s+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+i])throw new Error(s+" updates.shape[".concat(o+r,"] (").concat(n.shape[o+r],") != shape[").concat(o+r,"] (").concat(t[o+r],")"))}function To(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}_o(n,e,t)}function Eo(t,e,n){const i=e.shape.length,r=i>1?e.shape[i-1]:1,s=n.length;let o=1;for(let c=r;c<s;++c)o*=n[c];const a=r<1?1:r;return{sliceRank:r,numUpdates:nt(e.shape)/a,sliceSize:o,strides:[...At(n.slice(0,r)),1],outputSize:nt(n)}}function Co(t,e,n){const i=t.shape.length;J(i===e.length,(()=>"Error in slice".concat(i,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(i,")."))),J(i===n.length,(()=>"Error in slice".concat(i,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(i,").")));for(let r=0;r<i;++r)J(e[r]+n[r]<=t.shape[r],(()=>"Error in slice".concat(i,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(e[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(t.shape[r],")")))}function ko(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Ao(t,e,n){const i=[];for(let r=0;r<t.length;r++)i[r]=Math.ceil((e[r]-t[r])/n[r]);return i}function Io(t,e,n,i){const r=[...t];for(let s=r.length;s<i.length;s++)r.push(1);for(let s=0;s<n;s++)0===s?r[e]=1:(r.splice(e,0,1),r.pop());return r}function Oo(t,e,n){return n<=t?n:n-(e-1)}function Ro(t,e){const n=[];for(let i=0;i<t;i++)n.push(e+i);return n}function No(t,e,n,i,r,s,o,a,c){const l=t.length;let u=new Array(l),h=new Array(l),d=new Array(l);if(e.length&&n>0){const c=e[0],l=n+1;u=Mo(o,c,l,i,t),h=Do(a,c,l,r,t),d=Io(s,c,l,t)}else for(let p=0;p<l;p++)u[p]=Fo(o,i,s,t,p,c),h[p]=Lo(a,r,s,t,p,c),d[p]=Po(s,p,c);return{begin:u,end:h,strides:d}}function Mo(t,e,n,i,r){const s=[...r],o=Ro(n,e);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const r=Oo(e,n,a);let o=i[r];t&1<<r&&(o=0),s[a]=o}return s}function Do(t,e,n,i,r){const s=[...r],o=Ro(n,e);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const r=Oo(e,n,a);let o=i[r];t&1<<r&&(o=Number.MAX_SAFE_INTEGER),s[a]=o}for(let a=0;a<s.length;a++){const t=r[a];s[a]<0&&(s[a]+=t),s[a]=X(0,s[a],r[a])}return s}function Po(t,e,n){let i=t[e];return(n&1<<e||null==i)&&(i=1),i}function Fo(t,e,n,i,r,s){let o=e[r];const a=n[r]||1;(t&1<<r||s&1<<r||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=i[r];return o<0&&(o+=c),o=X(0,o,c-1),o}function Lo(t,e,n,i,r,s){let o=e[r];const a=n[r]||1;(t&1<<r||s&1<<r||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=i[r];return o<0&&(o+=c),o=a>0?X(0,o,c):X(-1,o,c-1),o}function Bo(t,e,n){let i=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){i=r;break}for(let r=i+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function zo(t,e){let n=t.length>0?t[t.length-1]:1;for(let i=0;i<t.length-1;i++)n+=t[i]*e[i];return n}function Uo(t,e,n){let i;const r=t.shape.length;let s;return i="number"===typeof e?[e,...new Array(r-1).fill(0)]:e.length<r?e.concat(new Array(r-e.length).fill(0)):e.slice(),i.forEach((t=>{J(-1!==t,(()=>"slice() does not support negative begin indexing."))})),s=null==n?new Array(r).fill(-1):"number"===typeof n?[n,...new Array(r-1).fill(-1)]:n.length<r?n.concat(new Array(r-n.length).fill(-1)):n,s=s.map(((e,n)=>e>=0?e:(J(-1===e,(()=>"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,"."))),t.shape[n]-i[n]))),[i,s]}function jo(t,e,n,i,r,s,o,a,c){let l=e.slice(),u=n.slice(),h=i;null==i&&(h=new Array(l.length));const d=ko(o);if(d.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==a)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==c)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const p=t.length-l.length,f=ko(a),m=t.slice();f.forEach((t=>{l[t]=0,u[t]=1,m.splice(t,0,1)}));const{begin:g,end:v,strides:y}=No(m,d,p,l,u,h,r,s,o);l=g,u=v,h=y;const x=ko(c);x.forEach((t=>{u[t]=l[t]+1,h[t]=1}));const b=Ao(l,u,h),w=b.filter(((t,e)=>-1===x.indexOf(e)));return{nonStrided:h.every((t=>1===t)),$begin:l,$end:u,$strides:h,size:b,newShape:m,outShape:w}}class Vo{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Wo{constructor(){this.classNameMap={}}static getMap(){return null==Wo.instance&&(Wo.instance=new Wo),Wo.instance}static register(t){Wo.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Go(t){J(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),J("string"===typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),J(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),Wo.register(t)}const qo=.001,Ho=.1;function Xo(t,e,n){return null==n&&(n=Yo()),Ko(t,e,((t,e)=>$o(t,e,n)))}function Yo(){return 32===Lr.backend.floatPrecision()?qo:Ho}function Ko(t,e,n){let i=!0;if((xt(t)||xt(e))&&(i=!1),xt(t)&&xt(e)&&(i=!0),i){const n=t.constructor.name,i=e.constructor.name;if(n!==i)throw new Error("Arrays are of different type. Actual: ".concat(n,". ")+"Expected: ".concat(i))}if(Array.isArray(t)&&Array.isArray(e)){const n=Vr(t),i=Vr(e);if(!rt(n,i))throw new Error("Arrays have different shapes. "+"Actual: [".concat(n,"]. Expected: [").concat(i,"]"))}const r=xt(t)?t:et(t),s=xt(e)?e:et(e);if(r.length!==s.length)throw new Error("Arrays have different lengths actual: ".concat(r.length," vs ")+"expected: ".concat(s.length,".\n")+"Actual:   ".concat(r,".\n")+"Expected: ".concat(s,"."));for(let o=0;o<s.length;++o){const t=r[o],e=s[o];if(!n(t,e))throw new Error("Arrays differ: actual[".concat(o,"] = ").concat(t,", expected[").concat(o,"] = ").concat(e,".\n")+"Actual:   ".concat(r,".\n")+"Expected: ".concat(s,"."))}}function Qo(t,e){t().then((()=>e.fail()),(()=>e()))}function Zo(t,e){const n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return St(t)||St(t[0])||St(e)||St(e[0])?Ko(t,n,((t,e)=>t==e)):Ko(t,e,((t,e)=>$o(t,e,0)))}function Jo(t,e,n){if(null==n&&(n=Yo()),!$o(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e))}function $o(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function ta(t,e,n){for(let i=0;i<t.length;i++)if(t[i]<e||t[i]>n)throw new Error("Value out of range:".concat(t[i]," low: ").concat(e,", high: ").concat(n))}function ea(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}function na(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?na(n):t[e]=pr(n)}return t}const ia="2.8.6";function ra(){Ut().set("PROD",!0)}function sa(){Ut().set("DEBUG",!0)}function oa(){Ut().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function aa(t){Ut().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ca(){Lr.disposeVariables()}function la(){return Lr}function ua(){return Lr.memory()}function ha(t){return Lr.profile(t)}function da(t,e){return Lr.tidy(t,e)}function pa(t){Nr(t).forEach((t=>t.dispose()))}function fa(t){return Lr.keep(t)}function ma(t){return Lr.time(t)}function ga(t){return Lr.setBackend(t)}function va(){return Lr.ready()}function ya(){return Lr.backendName}function xa(t){Lr.removeBackend(t)}function ba(t){return Lr.findBackend(t)}function wa(t){return Lr.findBackendFactory(t)}function Sa(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Lr.registerBackend(t,e,n)}function _a(){return Lr.backend}function Ta(t,e){Ut().setPlatform(t,e)}yr=aa;const Ea=Yr({add_:function(t,e){let n=qr(t,"a","add"),i=qr(e,"b","add");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(Yt,r)}});const Ca=Yr({floorDiv_:function(t,e){let n=qr(t,"a","floorDiv"),i=qr(e,"b","floorDiv");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(Qe,r)}});const ka=Yr({div_:function(t,e){let n=qr(t,"a","div"),i=qr(e,"b","div");if([n,i]=Ir(n,i),"int32"===n.dtype&&"int32"===i.dtype)return Ca(n,i);const r={a:n,b:i};return Lr.runKernel(Be,r,{})}});const Aa=Yr({mul_:function(t,e){let n=qr(t,"a","mul"),i=qr(e,"b","mul");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(Dn,r)}});const Ia=Yr({sqrt_:function(t){const e={x:qr(t,"x","sqrt")};return Lr.runKernel(gi,e)}});const Oa=Yr({square_:function(t){const e=qr(t,"x","square");return Lr.runKernel("Square",{x:e},{})}});const Ra=Yr({zerosLike_:function(t){const e={x:qr(t,"x","zerosLike")};return Lr.runKernel(Di,e)}});function Na(t){return J(Ct(t),(()=>"The f passed in grad(f) must be a function")),(e,n)=>{const i=qr(e,"x","tf.grad","string_or_numeric"),r=null!=n?qr(n,"dy","tf.grad"):null;return Lr.tidy((()=>{const{value:e,grads:n}=Lr.gradients((()=>t(i)),[i],r);return null!=r&&$(e.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Ba(n),n[0]}))}}function Ma(t){return J(Ct(t),(()=>"The f passed in grads(f) must be a function")),(e,n)=>{J(Array.isArray(e),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));const i=Hr(e,"args","tf.grads","string_or_numeric"),r=null!=n?qr(n,"dy","tf.grads"):null;return Lr.tidy((()=>{const{value:e,grads:n}=Lr.gradients((()=>t(...i)),i,r);return null!=r&&$(e.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ba(n),n}))}}function Da(t){return J(Ct(t),(()=>"The f passed in valueAndGrad(f) must be a function")),(e,n)=>{J(e instanceof xr,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),J(null==n||n instanceof xr,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));const{grads:i,value:r}=Lr.gradients((()=>t(e)),[e],n);return Ba(i),{grad:i[0],value:r}}}function Pa(t){return J(Ct(t),(()=>"The f passed in valueAndGrads(f) must be a function")),(e,n)=>{J(Array.isArray(e)&&e.every((t=>t instanceof xr)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),J(null==n||n instanceof xr,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));const i=Lr.gradients((()=>t(...e)),e,n);return null!=n&&$(i.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ba(i.grads),i}}function Fa(t,e){J(Ct(t),(()=>"The f passed in variableGrads(f) must be a function")),J(null==e||Array.isArray(e)&&e.every((t=>t instanceof br)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in Lr.registeredVariables)e.push(Lr.registeredVariables[t])}const i=n?e.filter((t=>!t.trainable)):null,r=e.length;e=e.filter((t=>t.trainable)),J(e.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(r," variables is ")+"trainable."));const{value:s,grads:o}=Lr.gradients(t,e,null,!0);J(o.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),J(0===s.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")));const a={};return e.forEach(((t,e)=>{null!=o[e]&&(a[t.name]=o[e])})),null!=i&&i.forEach((t=>a[t.name]=null)),{value:s,grads:a}}function La(t){return Lr.customGrad(t)}function Ba(t){if(t.filter((t=>null==t)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function za(t,e){if((xt(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&xt(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Qr(t,[],[],e)}class Ua extends Vo{minimize(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:i,grads:r}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:r[t.name]})));this.applyGradients(t)}else this.applyGradients(r);return pa(r),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return Fa(t,e)}dispose(){null!=this.iterations_&&pa(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:za(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Ua,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});class ja extends Ua{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=Lr.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const i=Lr.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(e,"/accum_grad"),variable:da((()=>Ra(i).variable(false)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(e,"/accum_var"),variable:da((()=>Ra(i).variable(false)))});const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;da((()=>{const t=Ea(Aa(s,this.rho),Aa(Oa(r),1-this.rho)),e=Aa(ka(Ia(Ea(o,this.epsilon)),Ia(Ea(s,this.epsilon))),r),n=Ea(Aa(o,this.rho),Aa(Oa(e),1-this.rho));s.assign(t),o.assign(n);const a=Ea(Aa(e,-this.learningRate),i);i.assign(a)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(pa(this.accumulatedGrads.map((t=>t.variable))),pa(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}function Va(t,e,n){const i={shape:t,value:e,dtype:n};return Lr.runKernel(Xe,{},i)}ja.className="Adadelta",Go(ja);class Wa extends Ua{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const i=Lr.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:"".concat(e,"/accumulator"),variable:da((()=>Va(i.shape,this.initialAccumulatorValue).variable(t)))}}const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const s=this.accumulatedGrads[n].variable;da((()=>{const t=Ea(s,Oa(r));s.assign(t);const e=Ea(Aa(ka(r,Ia(Ea(t,Lr.backend.epsilon()))),-this.learningRate),i);i.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&pa(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}Wa.className="Adagrad",Go(Wa);const Ga=Yr({pow_:function(t,e){let n=qr(t,"base","pow"),i=qr(e,"exp","pow");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(qn,r)}});const qa=Yr({sub_:function(t,e){let n=qr(t,"a","sub"),i=qr(e,"b","sub");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(_i,r)}});class Ha extends Ua{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],da((()=>{this.accBeta1=za(e).variable(),this.accBeta2=za(n).variable()})),null==i&&(this.epsilon=Lr.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);da((()=>{const n=qa(1,this.accBeta1),i=qa(1,this.accBeta2);e.forEach(((e,r)=>{const s=Lr.registeredVariables[e];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(e,"/m"),variable:da((()=>Ra(s).variable(false)))}),null==this.accumulatedSecondMoment[r]&&(this.accumulatedSecondMoment[r]={originalName:"".concat(e,"/v"),variable:da((()=>Ra(s).variable(false)))});const o=Array.isArray(t)?t[r].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[r].variable,c=this.accumulatedSecondMoment[r].variable,l=Ea(Aa(a,this.beta1),Aa(o,1-this.beta1)),u=Ea(Aa(c,this.beta2),Aa(Oa(o),1-this.beta2)),h=ka(l,n),d=ka(u,i);a.assign(l),c.assign(u);const p=Ea(Aa(ka(h,Ea(Ia(d),this.epsilon)),-this.learningRate),s);s.assign(p)})),this.accBeta1.assign(Aa(this.accBeta1,this.beta1)),this.accBeta2.assign(Aa(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&pa(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&pa(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),da((()=>{this.accBeta1.assign(Ga(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ga(this.beta2,this.iterations_+1))}));const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}Ha.className="Adam",Go(Ha);const Xa=Yr({abs_:function(t){const e=qr(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return Lr.runKernel(ve,t)}{const t={x:e};return Lr.runKernel(qt,t)}}});function Ya(t,e){const n=t.length,i=[];for(let r=0;r<n;r++){const s=n-1-r,o=t[s]||1;(e[e.length-1-r]||1)>1&&1===o&&i.unshift(s)}return i}function Ka(t,e){const n=[];for(let i=0;i<e.length;i++){const r=t[t.length-i-1],s=e.length-i-1,o=e[s];(null==r||1===r&&o>1)&&n.unshift(s)}return n}function Qa(t,e){const n=[],i=Math.max(t.length,e.length);for(let r=0;r<i;r++){let i=t[t.length-r-1];null==i&&(i=1);let s=e[e.length-r-1];if(null==s&&(s=1),1===i)n.unshift(s);else if(1===s)n.unshift(i);else{if(i!==s){const n="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(n)}n.unshift(i)}}return n}const Za=Yr({maximum_:function(t,e){let n=qr(t,"a","maximum"),i=qr(e,"b","maximum");[n,i]=Ir(n,i),"bool"===n.dtype&&(n=Xs(n,"int32"),i=Xs(i,"int32")),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(Sn,r)}});class Ja extends Ua{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=i,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],da((()=>{this.iteration=za(0).variable(),this.accBeta1=za(e).variable()})),null==i&&(this.epsilon=Lr.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);da((()=>{const n=qa(1,this.accBeta1),i=ka(-this.learningRate,Ea(Aa(this.iteration,this.decay),1));e.forEach(((e,r)=>{const s=Lr.registeredVariables[e];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:"".concat(e,"/m"),variable:Ra(s).variable(false)}),null==this.accumulatedWeightedInfNorm[r]&&(this.accumulatedWeightedInfNorm[r]={originalName:"".concat(e,"/v"),variable:Ra(s).variable(false)});const o=Array.isArray(t)?t[r].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[r].variable,c=this.accumulatedWeightedInfNorm[r].variable,l=Ea(Aa(a,this.beta1),Aa(o,1-this.beta1)),u=Aa(c,this.beta2),h=Xa(o),d=Za(u,h);a.assign(l),c.assign(d);const p=Ea(Aa(ka(i,n),ka(l,Ea(d,this.epsilon))),s);s.assign(p)})),this.iteration.assign(Ea(this.iteration,1)),this.accBeta1.assign(Aa(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&pa(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&pa(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}Ja.className="Adamax",Go(Ja);class $a extends Ua{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const r=Lr.registeredVariables[e];da((()=>{const t=Ea(Aa(this.c,i),r);r.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=fa(za(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}$a.className="SGD",Go($a);class tc extends $a{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=za(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const i=Lr.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:"".concat(e,"/momentum"),variable:da((()=>Ra(i).variable(t)))}}const r=this.accumulations[n].variable,s=Array.isArray(t)?t[n].tensor:t[e];null!=s&&da((()=>{let t;const e=Ea(Aa(this.m,r),s);t=this.useNesterov?Ea(Aa(this.c,Ea(s,Aa(e,this.m))),i):Ea(Aa(this.c,e),i),r.assign(e),i.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&pa(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}tc.className="Momentum",Go(tc);class ec extends Ua{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==i&&(this.epsilon=Lr.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const i=Lr.registeredVariables[e],r=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(e,"/rms"),variable:da((()=>Ra(i).variable(r)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(e,"/momentum"),variable:da((()=>Ra(i).variable(r)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(e,"/mg"),variable:da((()=>Ra(i).variable(r)))});const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const o=this.accumulatedMeanSquares[n].variable,a=this.accumulatedMoments[n].variable;da((()=>{const t=Ea(Aa(o,this.decay),Aa(Oa(s),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,r=Ea(Aa(e,this.decay),Aa(s,1-this.decay)),c=ka(Aa(s,this.learningRate),Ia(qa(t,Ea(Oa(r),this.epsilon)))),l=Ea(Aa(a,this.momentum),c);o.assign(t),e.assign(r),a.assign(l);const u=qa(i,l);i.assign(u)}else{const t=Ea(Aa(o,this.decay),Aa(Oa(s),1-this.decay)),e=Ea(Aa(a,this.momentum),ka(Aa(s,this.learningRate),Ia(Ea(t,this.epsilon))));o.assign(t),a.assign(e);const n=qa(i,e);i.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&pa(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&pa(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&pa(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}ec.className="RMSProp",Go(ec);const nc=Yr({acos_:function(t){const e={x:qr(t,"x","acos")};return Lr.runKernel(Ht,e)}});const ic=Yr({acosh_:function(t){const e={x:qr(t,"x","acosh")};return Lr.runKernel(Xt,e)}});const rc=Yr({addN_:function(t){J(Array.isArray(t),(()=>"The argument passed to tf.addN() must be a list of tensors")),J(t.length>=1,(()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)));const e=t.map(((t,e)=>qr(t,"tensors".concat(e),"addN"))),n=e[0];e.forEach((t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((t=>{if(!rt(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const i=e;return Lr.runKernel(Kt,i)}});const sc=Yr({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={x:qr(t,"x","all","bool")},r={axis:e,keepDims:n};return Lr.runKernel(Qt,i,r)}});const oc=Yr({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={x:qr(t,"x","any","bool")},r={axis:e,keepDims:n};return Lr.runKernel(Zt,i,r)}});const ac=Yr({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:qr(t,"x","argMax")},i={axis:e};return Lr.runKernel(Jt,n,i)}});const cc=Yr({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:qr(t,"x","argMin")},i={axis:e};return Lr.runKernel($t,n,i)}});const lc=Yr({asin_:function(t){const e={x:qr(t,"x","asin")};return Lr.runKernel(te,e)}});const uc=Yr({asinh_:function(t){const e={x:qr(t,"x","asinh")};return Lr.runKernel(ee,e)}});const hc=Yr({atan_:function(t){const e={x:qr(t,"x","atan")};return Lr.runKernel(ne,e)}});const dc=Yr({atan2_:function(t,e){let n=qr(t,"a","atan2"),i=qr(e,"b","atan2");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(re,r)}});const pc=Yr({atanh_:function(t){const e={x:qr(t,"x","atanh")};return Lr.runKernel(ie,e)}});function fc(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5?arguments[5]:void 0;return vc(t,[...e,t[3]],n,s,i,null,null,Cc(r))}function mc(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[a,c]=bc(e);let l;if("channelsLast"===o)l=[a,c,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));l=[a,c,t[1],t[1]]}return vc(t,l,n,i,r,s,!1,o)}function gc(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[a,c,l]=wc(e);let u,h;if("NDHWC"===o)h="channelsLast",u=[a,c,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));h="channelsFirst",u=[a,c,l,t[1],t[1]]}return yc(t,u,n,i,r,!1,h,s)}function vc(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,l,u,h]=[-1,-1,-1,-1];if("channelsLast"===a)[c,l,u,h]=t;else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat ".concat(a));[c,h,l,u]=t}const[d,p,,f]=e,[m,g]=bc(n),[v,y]=bc(i),x=Sc(d,v),b=Sc(p,y),{padInfo:w,outHeight:S,outWidth:_}=function(t,e,n,i,r,s,o,a,c){let l,u,h;if("number"===typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const r=function(t,e,n,i,r){null==i&&(i=xc(t,e,n));const s=t[0],o=t[1],a=_c((s-e+2*i)/n+1,r),c=_c((o-e+2*i)/n+1,r);return[a,c]}([e,n],s,i,t,a);u=r[0],h=r[1]}else if("same"===t){u=Math.ceil(e/i),h=Math.ceil(n/r);const t=Math.max(0,(u-1)*i+s-e),a=Math.max(0,(h-1)*r+o-n),c=Math.floor(t/2),d=t-c,p=Math.floor(a/2);l={top:c,bottom:d,left:p,right:a-p,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-s+1)/i),h=Math.ceil((n-o+1)/r);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));{const d="channelsLast"===c?t[1][0]:t[2][0],p="channelsLast"===c?t[1][1]:t[2][1],f="channelsLast"===c?t[2][0]:t[3][0],m="channelsLast"===c?t[2][1]:t[3][1];l={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=_c((e-s+d+p)/i+1,a),h=_c((n-o+f+m)/r+1,a)}}return{padInfo:l,outHeight:u,outWidth:h}}(r,l,u,m,g,x,b,s,a),T=o?f*h:f;let E;return"channelsFirst"===a?E=[c,T,S,_]:"channelsLast"===a&&(E=[c,S,_,T]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:u,inChannels:h,outHeight:S,outWidth:_,outChannels:T,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:x,effectiveFilterWidth:b,dilationHeight:v,dilationWidth:y,inShape:t,outShape:E,filterShape:e}}function yc(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",a=arguments.length>7?arguments[7]:void 0,[c,l,u,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,l,u,h,d]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[c,d,l,u,h]=t}const[p,f,m,,g]=e,[v,y,x]=wc(n),[b,w,S]=wc(i),_=Sc(p,b),T=Sc(f,w),E=Sc(m,S),{padInfo:C,outDepth:k,outHeight:A,outWidth:I}=function(t,e,n,i,r,s,o,a,c,l,u){let h,d,p,f;if("number"===typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const s=function(t,e,n,i,r,s){null==r&&(r=xc(t,e,i));const o=t[0],a=t[1],c=t[2],l=_c((o-e+2*r)/i+1,s),u=_c((a-e+2*r)/i+1,s),h=_c((c-e+2*r)/i+1,s);return[l,u,h,n]}([e,n,i,1],a,1,r,t,u);d=s[0],p=s[1],f=s[2]}else if("same"===t){d=Math.ceil(e/r),p=Math.ceil(n/s),f=Math.ceil(i/o);const t=(d-1)*r+a-e,u=(p-1)*s+c-n,m=(f-1)*o+l-i,g=Math.floor(t/2),v=t-g,y=Math.floor(u/2),x=u-y,b=Math.floor(m/2);h={top:y,bottom:x,left:b,right:m-b,front:g,back:v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/r),p=Math.ceil((n-c+1)/s),f=Math.ceil((i-l+1)/o)}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(r,l,u,h,v,y,x,_,T,E,a),O=s?g*d:g;let R;return"channelsFirst"===o?R=[c,O,k,A,I]:"channelsLast"===o&&(R=[c,k,A,I,O]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:u,inWidth:h,inChannels:d,outDepth:k,outHeight:A,outWidth:I,outChannels:O,padInfo:C,strideDepth:v,strideHeight:y,strideWidth:x,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:_,effectiveFilterHeight:T,effectiveFilterWidth:E,dilationDepth:b,dilationHeight:w,dilationWidth:S,inShape:t,outShape:R,filterShape:e}}function xc(t,e,n){const i=Sc(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+i)/2)}function bc(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function wc(t){return"number"===typeof t?[t,t,t]:t}function Sc(t,e){return e<=1?t:t+(t-1)*(e-1)}function _c(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function Tc(t){const[e,n,i]=bc(t);return 1===e&&1===n&&1===i}function Ec(t,e){return Tc(t)||Tc(e)}function Cc(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}const kc=Yr({reshape_:function(t,e){const n={x:qr(t,"x","reshape","string_or_numeric")},i={shape:e};return Lr.runKernel(Jn,n,i)}});const Ac=Yr({avgPool_:function(t,e,n,i,r){const s=qr(t,"x","avgPool","float32");J(Ec(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let o=s,a=!1;3===s.rank&&(a=!0,o=kc(s,[1,s.shape[0],s.shape[1],s.shape[2]])),J(4===o.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,"."))),null!=r&&J(st(i),(()=>"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const c={x:o},l={filterSize:e,strides:n,pad:i,dimRoundingMode:r};let u=Lr.runKernel(se,c,l);return u=Xs(u,s.dtype),a?kc(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const Ic=Yr({avgPool3d_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:aa("dilations is deprecated, this field will be gone in v3.0.0.");const a=qr(t,"x","avgPool3d","float32");let c=a,l=!1;4===a.rank&&(l=!0,c=kc(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),J(5===c.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(c.rank,"."))),J("NDHWC"===s,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(s))),J(Ec(n,o),(()=>"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'"))),null!=r&&J(st(i),(()=>"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const u={x:c},h={filterSize:e,strides:n,pad:i,dimRoundingMode:r,dataFormat:s,dilations:o};let d=Lr.runKernel(ae,u,h);return d=Xs(d,c.dtype),l?kc(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const Oc=Yr({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;J(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=Hr(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return Ys(n[0]);const i=n,r={axis:e};return Lr.runKernel(ye,i,r)}});const Rc=Yr({sigmoid_:function(t){const e={x:qr(t,"x","sigmoid")};return Lr.runKernel(fi,e)}});const Nc=Yr({slice_:function(t,e,n){const i=qr(t,"x","slice","string_or_numeric");if(0===i.rank)throw new Error("Slicing scalar is not possible");const r={x:i},s={begin:e,size:n};return Lr.runKernel(ui,r,s)}});const Mc=Yr({tanh_:function(t){const e={x:qr(t,"x","tanh")};return Lr.runKernel(ki,e)}});const Dc=Yr({basicLSTMCell_:function(t,e,n,i,r,s){const o=qr(t,"forgetBias","basicLSTMCell"),a=qr(e,"lstmKernel","basicLSTMCell"),c=qr(n,"lstmBias","basicLSTMCell"),l=qr(i,"data","basicLSTMCell"),u=qr(r,"c","basicLSTMCell"),h=qr(s,"h","basicLSTMCell"),d=Oc([l,h],1),p=fo(d,a),f=Ea(p,c),m=f.shape[0],g=f.shape[1]/4,v=[m,g],y=Nc(f,[0,0],v),x=Nc(f,[0,g],v),b=Nc(f,[0,2*g],v),w=Nc(f,[0,3*g],v),S=Ea(Aa(Rc(y),Mc(x)),Aa(u,Rc(Ea(o,b))));return[S,Aa(Mc(S),Rc(w))]}});const Pc=Yr({batchToSpaceND_:function(t,e,n){const i=qr(t,"x","batchToSpaceND"),r=e.reduce(((t,e)=>t*e));J(i.rank>=1+e.length,(()=>"input rank is ".concat(i.rank," but should be > than blockShape.length ").concat(e.length))),J(n.length===e.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length))),J(i.shape[0]%r===0,(()=>"input tensor batch is ".concat(i.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(r)));const s={x:i},o={blockShape:e,crops:n};return Lr.runKernel(ue,s,o)}});const Fc=Yr({batchNorm_:function(t,e,n,i,r,s){null==s&&(s=.001);const o=qr(t,"x","batchNorm"),a=qr(e,"mean","batchNorm"),c=qr(n,"variance","batchNorm");let l,u;null!=r&&(l=qr(r,"scale","batchNorm")),null!=i&&(u=qr(i,"offset","batchNorm")),J(a.rank===c.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),J(null==u||a.rank===u.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),J(null==l||a.rank===l.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const h={x:function(t){let e;return e=0===t.rank||1===t.rank?kc(t,[1,1,1,t.size]):2===t.rank?kc(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?kc(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(o),scale:l,offset:u,mean:a,variance:c},d={varianceEpsilon:s},p=Lr.runKernel(Ze,h,d);return kc(p,o.shape)}});const Lc=Yr({batchNorm2d_:function(t,e,n,i,r,s){const o=qr(t,"x","batchNorm"),a=qr(e,"mean","batchNorm"),c=qr(n,"variance","batchNorm");let l,u;return null!=r&&(l=qr(r,"scale","batchNorm")),null!=i&&(u=qr(i,"offset","batchNorm")),J(2===o.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,"."))),J(2===a.rank||1===a.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(a.rank,"."))),J(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&J(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&J(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),Fc(o,a,c,u,l,s)}});const Bc=Yr({batchNorm3d_:function(t,e,n,i,r,s){const o=qr(t,"x","batchNorm"),a=qr(e,"mean","batchNorm"),c=qr(n,"variance","batchNorm");let l,u;return null!=r&&(l=qr(r,"scale","batchNorm")),null!=i&&(u=qr(i,"offset","batchNorm")),J(3===o.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,"."))),J(3===a.rank||1===a.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(a.rank,"."))),J(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&J(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&J(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),Fc(o,a,c,u,l,s)}});const zc=Yr({batchNorm4d_:function(t,e,n,i,r,s){const o=qr(t,"x","batchNorm"),a=qr(e,"mean","batchNorm"),c=qr(n,"variance","batchNorm");let l,u;return null!=r&&(l=qr(r,"scale","batchNorm")),null!=i&&(u=qr(i,"offset","batchNorm")),J(4===o.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,"."))),J(4===a.rank||1===a.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(a.rank,"."))),J(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&J(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&J(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),Fc(o,a,c,u,l,s)}});const Uc=Yr({bincount_:function(t,e,n){const i=qr(t,"x","bincount"),r=qr(e,"weights","bincount");J("int32"===i.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(i.dtype))),J(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),J(r.size===i.size||0===r.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(i.shape,", weights shape: ")+"".concat(r.shape,".")));const s={x:i,weights:r},o={size:n};return Lr.runKernel(he,s,o)}});const jc=Yr({broadcastTo_:function(t,e){let n=qr(t,"broadcastTo","x");const i=n.shape;if(e.some((t=>!(t>0)||t%1!==0)))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=kc(n,t)}const r=n.shape,s=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])s[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(i,"] cannot be broadcast to [").concat(e,"]."));if(0===s.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0)).length)return Ys(n);const o={x:n},a={reps:s};return Lr.runKernel(Ai,o,a)}});const Vc=Yr({ceil_:function(t){const e={x:qr(t,"x","ceil")};return Lr.runKernel(fe,e)}});const Wc=Yr({clipByValue_:function(t,e,n){const i=qr(t,"x","clipByValue");J(e<=n,(()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")));const r={x:i},s={clipValueMin:e,clipValueMax:n};return Lr.runKernel(me,r,s)}});const Gc=Yr({concat1d_:function(t){return Oc(t,0)}});const qc=Yr({concat2d_:function(t,e){return Oc(t,e)}});const Hc=Yr({concat3d_:function(t,e){return Oc(t,e)}});const Xc=Yr({concat4d_:function(t,e){return Oc(t,e)}});const Yc=Yr({conv2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=qr(t,"x","conv2d"),c=qr(e,"filter","conv2d");let l=a,u=!1;3===a.rank&&(u=!0,l=kc(a,[1,a.shape[0],a.shape[1],a.shape[2]])),J(4===l.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,"."))),J(4===c.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(c.rank,"."))),null!=o&&J(st(i),(()=>"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")));const h="NHWC"===r?l.shape[3]:l.shape[1];J(h===c.shape[2],(()=>"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(c.shape[2],"."))),J(Ec(n,s),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(s,"'")));const d={x:l,filter:c},p={strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o},f=Lr.runKernel(xe,d,p);return u?kc(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Kc=Yr({conv1d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const a=qr(t,"x","conv1d"),c=qr(e,"filter","conv1d");let l=a,u=!1;2===a.rank&&(u=!0,l=kc(a,[1,a.shape[0],a.shape[1]])),J(3===l.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,"."))),J(3===c.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(c.rank,"."))),null!=o&&J(st(i),(()=>"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,"."))),J(l.shape[2]===c.shape[1],(()=>"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(c.shape[1],"."))),J(Ec(n,s),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(s,"'"))),J("NWC"===r,(()=>"Error in conv1d: got dataFormat of ".concat(r," but only NWC is currently supported.")));const h=kc(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=kc(l,[l.shape[0],1,l.shape[1],l.shape[2]]),p=Yc(d,h,[1,n],i,"NHWC",[1,s],o);return kc(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const Qc=Yr({conv2DBackpropInput_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;J(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let a=t,c=e,l=!1;3===e.rank&&(l=!0,c=kc(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),J(4===a.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(a.length,"."))),J(4===c.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(c.rank))),J(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const u="NHWC"===s?a[3]:a[1],h="NHWC"===s?c.shape[3]:c.shape[1];J(u===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),J(h===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),null!=o&&J(st(r),(()=>"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")));const d={dy:c,filter:n},p={strides:i,pad:r,dataFormat:s,dimRoundingMode:o,inputShape:a},f=Lr.runKernel(we,d,p);return l?kc(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Zc=Yr({conv2dTranspose_:function(t,e,n,i,r,s){const o=qr(t,"x","conv2dTranspose"),a=qr(e,"filter","conv2dTranspose");return Qc(n,o,a,i,r,"NHWC",s)}});const Jc=Yr({conv3d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=qr(t,"x","conv3d"),a=qr(e,"filter","conv3d");let c=o,l=!1;4===o.rank&&(l=!0,c=kc(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),J(5===c.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,"."))),J(5===a.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(a.rank,"."))),J(c.shape[4]===a.shape[3],(()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(a.shape[3],"."))),J(Ec(n,s),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(s,"'"))),J("NDHWC"===r,(()=>"Error in conv3d: got dataFormat of ".concat(r," but only NDHWC is currently supported.")));const u={x:c,filter:a},h={strides:n,pad:i,dataFormat:r,dilations:s},d=Lr.runKernel(Se,u,h);return l?kc(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const $c=Yr({conv3DBackpropInput_:function(t,e,n,i,r){J(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let s=t,o=e,a=!1;4===e.rank&&(a=!0,o=kc(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const c=s[4],l=o.shape[4];J(5===s.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(s.length,"."))),J(5===o.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank))),J(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),J(c===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),J(l===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const u={dy:o,filter:n},h={pad:r,strides:i,inputShape:s},d=Lr.runKernel(Te,u,h);return a?kc(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const tl=Yr({conv3dTranspose_:function(t,e,n,i,r){const s=qr(t,"x","conv3dTranspose"),o=qr(e,"filter","conv3dTranspose");return $c(n,s,o,i,r)}});const el=Yr({cos_:function(t){const e={x:qr(t,"x","cos")};return Lr.runKernel(Ee,e)}});const nl=Yr({cosh_:function(t){const e={x:qr(t,"x","cosh")};return Lr.runKernel(Ce,e)}});const il=Yr({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={x:qr(t,"x","cumsum")},s={axis:e,exclusive:n,reverse:i};return Lr.runKernel(ke,r,s)}});const rl=Yr({denseBincount_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=qr(t,"x","denseBincount"),s=qr(e,"weights","denseBincount");J("int32"===r.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(r.dtype))),J(r.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(r.rank,"."))),J(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),J(s.size===r.size||0===s.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(r.shape,", weights shape: ")+"".concat(s.shape,".")));const o={x:r,weights:s},a={size:n,binaryOutput:i};return Lr.runKernel(Ie,o,a)}});const sl=Yr({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const i=qr(t,"x","depthToSpace"),r="NHWC"===n?i.shape[1]:i.shape[2],s="NHWC"===n?i.shape[2]:i.shape[3],o="NHWC"===n?i.shape[3]:i.shape[1];J(r*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(i.shape))),J(s*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(e," for depthToSpace with input shape\n        ").concat(i.shape))),J(o%(e*e)===0,(()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(i.shape)));const a={x:i},c={blockSize:e,dataFormat:n};return Lr.runKernel(Oe,a,c)}});const ol=Yr({depthwiseConv2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const a=qr(t,"x","depthwiseConv2d"),c=qr(e,"filter","depthwiseConv2d");let l=a,u=!1;3===a.rank&&(u=!0,l=kc(a,[1,a.shape[0],a.shape[1],a.shape[2]])),J(4===l.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,"."))),J(4===c.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(c.rank,"."))),J(l.shape[3]===c.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(l.shape[3],") must match the inChannels dimension in ")+"filter ".concat(c.shape[2],"."))),null!=o&&J(st(i),(()=>"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")));const h={x:l,filter:c},d={strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o},p=Lr.runKernel(Re,h,d);return u?kc(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const al=Yr({diag_:function(t){const e={x:qr(t,"x","diag")};return Lr.runKernel(De,e)}});const cl=Yr({dilation2d_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=qr(t,"x","dilation2d"),a=qr(e,"filter","dilation2d");J(3===o.rank||4===o.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,"."))),J(3===a.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(a.rank,"."))),J("NHWC"===s,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(s)));let c=o,l=!1;3===o.rank&&(c=kc(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0);const u={x:c,filter:a},h={strides:n,pad:i,dilations:r},d=Lr.runKernel(Pe,u,h);return l?kc(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const ll=Yr({equal_:function(t,e){let n=qr(t,"a","equal"),i=qr(e,"b","equal");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(Ve,r)}});const ul=Yr({where_:function(t,e,n){const i=qr(e,"a","where"),r=qr(n,"b","where"),s=qr(t,"condition","where","bool"),o=Qa(i.shape,r.shape),a=jc(i,o),c=jc(r,o);1===s.rank&&J(s.shape[0]===i.shape[0],(()=>"The first dimension of `a` must match the size of `condition`.")),1!==s.rank&&$(s.shape,c.shape,"Error in where: ");const l={condition:s,t:a,e:c};return Lr.runKernel(ci,l)}});const hl=Yr({divNoNan_:function(t,e){let n=qr(t,"a","div"),i=qr(e,"b","div");[n,i]=Ir(n,i);const r=ka(n,i),s=Ra(r),o=ll(i,s);return ul(o,s,r)}});const dl=Yr({dot_:function(t,e){const n=qr(t,"t1","dot"),i=qr(e,"t2","dot");J((1===n.rank||2===n.rank)&&(1===i.rank||2===i.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(i.rank,".")));const r=1===n.rank?n.size:n.shape[1],s=1===i.rank?i.size:i.shape[0];if(J(r===s,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(r," and ").concat(s,"."))),1===n.rank&&1===i.rank){const t=kc(n,[1,-1]),e=kc(i,[-1,1]),r=fo(t,e);return kc(r,[])}if(1===n.rank&&2===i.rank){const t=kc(n,[1,-1]),e=kc(i,[i.shape[0],i.shape[1]]),r=fo(t,e);return kc(r,[r.size])}if(2===n.rank&&1===i.rank){const t=kc(i,[-1,1]),e=fo(n,t);return kc(e,[e.size])}{const t=kc(i,[i.shape[0],i.shape[1]]);return fo(n,t)}}});const pl=Yr({elu_:function(t){const e={x:qr(t,"x","elu")};return Lr.runKernel(ze,e)}});const fl=Yr({erf_:function(t){let e=qr(t,"x","erf");J("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=Xs(e,"float32"));const n={x:e};return Lr.runKernel(je,n)}});const ml=Yr({exp_:function(t){const e={x:qr(t,"x","exp")};return Lr.runKernel(We,e)}});const gl=Yr({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=qr(t,"x","expandDims","string_or_numeric");J(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const i={input:n},r={dim:e};return Lr.runKernel(Ge,i,r)}});const vl=Yr({expm1_:function(t){const e={x:qr(t,"x","expm1")};return Lr.runKernel(qe,e)}});const yl=Yr({tile_:function(t,e){const n=qr(t,"x","tile","string_or_numeric");J(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")));const i={x:n},r={reps:e};return Lr.runKernel(Ai,i,r)}});const xl=Yr({eye_:function(t,e,n){null==e&&(e=t);const i=Hs([t,e],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),r=t<=e?t:e;for(let o=0;o<r;++o)i.set(1,o,o);const s=kc(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return yl(gl(s,0),[n[0],1,1]);if(2===n.length)return yl(gl(gl(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return yl(gl(gl(gl(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const bl=Yr({floor_:function(t){const e={x:qr(t,"x","floor")};return Lr.runKernel(Ke,e)}});const wl=Yr({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r={x:qr(t,"x","gather"),indices:qr(e,"indices","gather","int32")},s={axis:n,batchDims:i};return Lr.runKernel(Je,r,s)}});const Sl=Yr({greater_:function(t,e){let n=qr(t,"a","greater"),i=qr(e,"b","greater");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(tn,r)}});const _l=Yr({greaterEqual_:function(t,e){let n=qr(t,"a","greaterEqual"),i=qr(e,"b","greaterEqual");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(en,r)}});const Tl=Yr({imag_:function(t){const e={input:qr(t,"input","imag")};return Lr.runKernel(sn,e)}});const El=Yr({isFinite_:function(t){const e={x:qr(t,"x","isFinite")};return Lr.runKernel(on,e)}});const Cl=Yr({isInf_:function(t){const e={x:qr(t,"x","isInf")};return Lr.runKernel(an,e)}});const kl=Yr({isNaN_:function(t){const e={x:qr(t,"x","isNaN")};return Lr.runKernel(cn,e)}});const Al=Yr({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:qr(t,"x","leakyRelu")},i={alpha:e};return Lr.runKernel(ln,n,i)}});const Il=Yr({less_:function(t,e){let n=qr(t,"a","less"),i=qr(e,"b","less");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(un,r)}});const Ol=Yr({lessEqual_:function(t,e){let n=qr(t,"a","lessEqual"),i=qr(e,"b","lessEqual");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(hn,r)}});function Rl(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const i={start:t,stop:e,num:n};return Lr.runKernel(dn,{},i)}const Nl=Yr({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const s=qr(t,"x","localResponseNormalization");J(4===s.rank||3===s.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(s.rank,"."))),J(st(e),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")));let o=s,a=!1;3===s.rank&&(a=!0,o=kc(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const c={x:o},l={depthRadius:e,bias:n,alpha:i,beta:r},u=Lr.runKernel(xn,c,l);return a?kc(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const Ml=Yr({log_:function(t){const e={x:qr(t,"x","log")};return Lr.runKernel(pn,e)}});const Dl=Yr({log1p_:function(t){const e={x:qr(t,"x","log1p")};return Lr.runKernel(fn,e)}});const Pl=Yr({neg_:function(t){const e={x:qr(t,"x","neg")};return Lr.runKernel(Pn,e)}});const Fl=Yr({softplus_:function(t){const e={x:qr(t,"x","softplus")};return Lr.runKernel(mi,e)}});const Ll=Yr({logSigmoid_:function(t){const e=qr(t,"x","logSigmoid");return La((t=>({value:Pl(Fl(Pl(t))),gradFunc:e=>Aa(e,Rc(Pl(t)))})))(e)}});const Bl=Yr({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={x:qr(t,"x","max")},r={reductionIndices:e,keepDims:n};return Lr.runKernel(wn,i,r)}});const zl=Yr({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=qr(t,"x","sum");"bool"===i.dtype&&(i=Xs(i,"int32"));const r={x:i},s={axis:e,keepDims:n};return Lr.runKernel(vi,r,s)}});const Ul=Yr({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=qr(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));const i=La(((t,n)=>{const i=Bl(t,e,!0),r=qa(t,i),s=qa(Xs(r,"float32"),Ml(zl(ml(r),e,!0)));n([s]);return{value:s,gradFunc:(t,n)=>{const[i]=n,r=ml(i);return qa(t,Aa(zl(t,e,!0),r))}}}));return i(n)}});function jl(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Vl(t,e,n){const i=t.length+e.length,r=[];let s=0,o=0;for(let a=0;a<i;a++)-1===n.indexOf(a)?r.push(t[s++]):r.push(e[o++]);return r}function Wl(t,e){const n=[],i=t.length;for(let r=0;r<i;r++)-1===e.indexOf(r)&&n.push(t[r]);return[n,e.map((e=>t[e]))]}function Gl(t,e){return Vl(t,e.map((t=>1)),e)}function ql(t,e,n){J(jl(e,n),(()=>"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")))}function Hl(t,e){if(jl(t,e))return null;const n=[];for(let i=0;i<e;++i)-1===t.indexOf(i)&&n.push(i);return t.forEach((t=>n.push(t))),n}function Xl(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function Yl(t,e){const n=[];for(let i=e-t;i<e;++i)n.push(i);return n}const Kl=Yr({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=qr(t,"x","logSumExp"),r=dt(e,i.shape),s=Bl(i,r,!0),o=qa(i,s),a=ml(o),c=zl(a,r),l=Ml(c),u=Ea(kc(s,l.shape),l);if(n){const t=Gl(u.shape,r);return kc(u,t)}return u}});const Ql=Yr({logicalAnd_:function(t,e){const n=qr(t,"a","logicalAnd","bool"),i=qr(e,"b","logicalAnd","bool");Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(mn,r)}});const Zl=Yr({logicalNot_:function(t){const e={x:qr(t,"x","logicalNot","bool")};return Lr.runKernel(gn,e)}});const Jl=Yr({logicalOr_:function(t,e){const n=qr(t,"a","logicalOr","bool"),i=qr(e,"b","logicalOr","bool");Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(vn,r)}});const $l=Yr({logicalXor_:function(t,e){const n=qr(t,"a","logicalXor","bool"),i=qr(e,"b","logicalXor","bool");return Qa(n.shape,i.shape),Ql(Jl(t,e),Zl(Ql(t,e)))}});const tu=Yr({maxPool_:function(t,e,n,i,r){const s=qr(t,"x","maxPool");let o=s,a=!1;3===s.rank&&(a=!0,o=kc(s,[1,s.shape[0],s.shape[1],s.shape[2]])),J(4===o.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,"."))),J(Ec(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),null!=r&&J(st(i),(()=>"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const c={x:o},l={filterSize:e,strides:n,pad:i,dimRoundingMode:r},u=Lr.runKernel(_n,c,l);return a?kc(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const eu=Yr({maxPool3d_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:aa("dilations is deprecated, this field will be gone in v3.0.0.");const a=qr(t,"x","maxPool3d");let c=a,l=!1;4===a.rank&&(l=!0,c=kc(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),J(5===c.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(c.rank,"."))),J("NDHWC"===s,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(s))),J(Ec(n,o),(()=>"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'"))),null!=r&&J(st(i),(()=>"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(r," but got pad ").concat(i,".")));const u={x:c},h={filterSize:e,strides:n,pad:i,dimRoundingMode:r,dataFormat:s,dilations:o},d=Lr.runKernel(En,u,h);return l?kc(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const nu=Yr({maxPoolWithArgmax_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s={x:qr(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:i,includeBatchInIndex:r},a=Lr.runKernel(kn,s,o);return{result:a[0],indexes:a[1]}}});const iu=Yr({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={x:qr(t,"x","mean")},r={axis:e,keepDims:n};return Lr.runKernel(An,i,r)}});const ru=Yr({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i={x:qr(t,"x","min")},r={axis:e,keepDims:n};return Lr.runKernel(In,i,r)}});const su=Yr({minimum_:function(t,e){let n=qr(t,"a","minimum"),i=qr(e,"b","minimum");[n,i]=Ir(n,i),"bool"===n.dtype&&(n=Xs(n,"int32"),i=Xs(i,"int32")),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(On,r)}});const ou=Yr({mirrorPad_:function(t,e,n){J("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const i=qr(t,"x","mirrorPad");if(0===i.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");J(e.length===i.rank,(()=>"Padding doesn't match input. Must be ".concat(i.rank,". ")+"Got ".concat(e.length,".")));const r="reflect"===n?1:0;for(let a=0;a<i.rank;a++)J(2===e[a].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),J(e[a][0]>=0&&e[a][0]<=i.shape[a]-r&&e[a][1]>=0&&e[a][1]<=i.shape[a]-r,(()=>"Padding in dimension ".concat(a," cannot be greater than or equal ")+"to ".concat(i.shape[a]-r," or less than 0 for input of ")+"shape ".concat(i.shape)));const s={paddings:e,mode:n},o={x:i};return Lr.runKernel(Rn,o,s)}});const au=Yr({mod_:function(t,e){let n=qr(t,"a","mod"),i=qr(e,"b","mod");[n,i]=Ir(n,i);const r={a:n,b:i};return Lr.runKernel(Nn,r)}});const cu=Yr({moments_:function(t){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=dt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(t=qr(t,"x","moments")).shape),i=iu(t,n,e);let r=i.shape;e||(r=Gl(i.shape,n));const s=Oa(qa(Xs(t,"float32"),kc(i,r)));return{mean:i,variance:iu(s,n,e)}}});const lu=Yr({multiRNNCell_:function(t,e,n,i){const r=qr(e,"data","multiRNNCell"),s=Hr(n,"c","multiRNNCell"),o=Hr(i,"h","multiRNNCell");let a=r;const c=[];for(let h=0;h<t.length;h++){const e=t[h](a,s[h],o[h]);c.push(e[0]),c.push(e[1]),a=e[1]}const l=[],u=[];for(let h=0;h<c.length;h+=2)l.push(c[h]),u.push(c[h+1]);return[l,u]}});const uu=Yr({multinomial_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=qr(t,"logits","multinomial"),s=r.size,o=r.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(s,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();const a={logits:1===o?kc(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:i},l=Lr.runKernel(Mn,a,c);return 1===o?kc(l,[l.size]):l}});const hu=Yr({notEqual_:function(t,e){let n=qr(t,"a","notEqual"),i=qr(e,"b","notEqual");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(Fn,r)}});function du(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=du(t,"float32"),n=du(t,"float32");return Kr(e,n)}const n=Nt(nt(t),e);return Lr.makeTensor(n,t,e)}function pu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=pu(t,"float32"),n=du(t,"float32");return Kr(e,n)}const n=Rt(nt(t),e);return Lr.makeTensor(n,t,e)}const fu=Yr({onesLike_:function(t){const e={x:qr(t,"x","onesLike")};return Lr.runKernel(Un,e)}});const mu=Yr({outerProduct_:function(t,e){const n=qr(t,"v1","outerProduct"),i=qr(e,"v2","outerProduct");J(1===n.rank&&1===i.rank,(()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(i.rank,".")));const r=kc(n,[-1,1]),s=kc(i,[1,-1]);return fo(r,s)}});const gu=Yr({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=qr(t,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},s={x:i};return Lr.runKernel(Wn,s,r)}});const vu=Yr({pad1d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return J(2===e.length,(()=>"Invalid number of paddings. Must be length of 2.")),gu(t,[e],n)}});const yu=Yr({pad2d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return J(2===e.length&&2===e[0].length&&2===e[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),gu(t,e,n)}});const xu=Yr({pad3d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return J(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),gu(t,e,n)}});const bu=Yr({pad4d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return J(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),gu(t,e,n)}});const wu=Yr({spaceToBatchND_:function(t,e,n){const i=qr(t,"x","spaceToBatchND");J(i.rank>=1+e.length,(()=>"input rank ".concat(i.rank," should be > than [blockShape] ").concat(e.length))),J(n.length===e.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length))),J(i.shape.reduce(((t,i,r)=>r>0&&r<=e.length?t&&(i+n[r-1][0]+n[r-1][1])%e[r-1]===0:t),!0),(()=>"input spatial dimensions ".concat(i.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())));const r={x:i},s={blockShape:e,paddings:n};return Lr.runKernel(yi,r,s)}});const Su=Yr({pool_:function(t,e,n,i,r,s){null==r&&(r=[1,1]),null==s&&(s=1),0===i&&(i="valid");const o=qr(t,"x","maxPool");let a=o,c=!1;3===o.rank&&(c=!0,a=kc(o,[1,o.shape[0],o.shape[1],o.shape[2]])),J(Ec(s,r),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(r,"'")));const l=mc(a.shape,e,s,r,i),u=[l.dilationHeight,l.dilationWidth];let h;h="same"===i?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),i=n.map((t=>t-1)),r=i.map((t=>Math.floor(t/2))),s=i.map(((t,e)=>t-r[e]));return i.map(((t,e)=>[r[e],s[e]]))}([l.filterHeight,l.filterWidth],u):[[0,0],[0,0]];const d=1===u[0]&&1===u[1],[p,f]=function(t,e,n){const i=n.map((t=>t[0])),r=n.map((t=>t[1])),s=t.concat(i,r),o=e.map(((t,e)=>(t-s[e]%t)%t)),a=r.map(((t,e)=>t+o[e])),c=e.map(((t,e)=>[i[e],a[e]])),l=e.map(((t,e)=>[0,o[e]]));return[c,l]}([l.inHeight,l.inWidth],u,h),m=d?i:"valid",g=d?a:wu(a,u,p),v=("avg"===n?()=>Ac(g,e,s,m):()=>tu(g,e,s,m))(),y=d?v:Pc(v,u,f);return c?kc(y,[y.shape[1],y.shape[2],y.shape[3]]):y}});const _u=Yr({prelu_:function(t,e){const n={x:qr(t,"x","prelu"),alpha:qr(e,"alpha","prelu")};return Lr.runKernel(Hn,n)}});const Tu=Yr({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=qr(t,"x","prod");"bool"===i.dtype&&(i=Xs(i,"int32"));const r={x:i},s={axis:e,keepDims:n};return Lr.runKernel(Xn,r,s)}});const Eu=Yr({rand_:function(t,e,n){const i=nt(t);let r=null;if(null==n||"float32"===n)r=new Float32Array(i);else if("int32"===n)r=new Int32Array(i);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));r=new Uint8Array(i)}for(let s=0;s<i;s++)r[s]=e();return Lr.makeTensor(r,t,n)}});var Cu=n(282);class ku{constructor(t,e,n,i,r){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=r||Math.random();this.random=Cu.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let i,r,s;do{i=2*this.random()-1,r=2*this.random()-1,s=i*i+r*r}while(s>=1||0===s);const o=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*o,e=this.mean+this.stdDev*r*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Au{constructor(t,e,n,i){this.alpha=t,this.beta=1/e,this.dtype=n;const r=i||Math.random();this.randu=Cu.alea(r.toString()),this.randn=new ku(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,i,r,s;for(;;){do{i=this.randn.nextValue(),s=1+this.c*i}while(s<=0);if(s*=s*s,t=i*i,e=1-.331*t*t,n=.5*t+this.d*(1-s+Math.log(s)),r=this.randu(),r<e||Math.log(r)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Iu{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=Cu.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Ou=Yr({randomGamma_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",r=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==i&&(i="float32"),"float32"!==i&&"int32"!==i)throw new Error("Unsupported data type ".concat(i));const s=new Au(e,n,i,r),o=Hs(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}});const Ru=Yr({randomNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(null!=i&&"bool"===i)throw new Error("Unsupported data type ".concat(i));const s=new ku(e,n,i,!1,r),o=Hs(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}});const Nu=Yr({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>4?arguments[4]:void 0;const r=Hs(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),s=new Iu(e,n,null,i);for(let o=0;o<r.values.length;o++)r.values[o]=s.nextValue();return r.toTensor()}});function Mu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:i};return Lr.runKernel(Yn,{},r)}const Du=Yr({real_:function(t){const e={input:qr(t,"input","real")};return Lr.runKernel(Kn,e)}});const Pu=Yr({reciprocal_:function(t){const e={x:qr(t,"x","reciprocal")};return Lr.runKernel(Qn,e)}});const Fu=Yr({relu_:function(t){const e={x:qr(t,"x","relu")};return Lr.runKernel(Zn,e)}});const Lu=Yr({relu6_:function(t){const e={x:qr(t,"x","relu6")};return Lr.runKernel(ii,e)}});const Bu=Yr({reverse_:function(t,e){const n={x:qr(t,"x","reverse")},i={dims:e};return Lr.runKernel(ri,n,i)}});const zu=Yr({reverse1d_:function(t){const e=qr(t,"x","reverse");return J(1===e.rank,(()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,"."))),Bu(e,0)}});const Uu=Yr({reverse2d_:function(t,e){const n=qr(t,"x","reverse");return J(2===n.rank,(()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,"."))),Bu(n,e)}});const ju=Yr({reverse3d_:function(t,e){const n=qr(t,"x","reverse");return J(3===n.rank,(()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,"."))),Bu(n,e)}});const Vu=Yr({reverse4d_:function(t,e){const n=qr(t,"x","reverse");return J(4===n.rank,(()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,"."))),Bu(n,e)}});const Wu=Yr({round_:function(t){const e={x:qr(t,"x","round")};return Lr.runKernel(si,e)}});const Gu=Yr({rsqrt_:function(t){const e={x:qr(t,"x","rsqrt")};return Lr.runKernel(oi,e)}});const qu=Yr({selu_:function(t){const e={x:qr(t,"x","selu")};return Lr.runKernel(li,e)}});const Hu=Yr({separableConv2d_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const a=qr(t,"x","separableConv2d"),c=qr(e,"depthwiseFilter","separableConv2d"),l=qr(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(3===a.rank&&(h=!0,u=kc(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");J(4===u.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,"."))),J(4===c.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(c.rank,"."))),J(4===l.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(c.rank,"."))),J(1===l.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],"."))),J(1===l.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],".")));const d=c.shape[2],p=c.shape[3];J(l.shape[2]===d*p,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*p,", ")+"but got ".concat(l.shape[2],".")));const f=ol(u,c,i,r,o,s),m=Yc(f,l,1,"valid",o);return h?kc(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const Xu=async function(t,e){const n=qr(t,"x","setdiff1d"),i=qr(e,"y","setdiff1d");J(n.dtype===i.dtype,(()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(i.dtype,")."))),J(1===n.rank,(()=>"x should be 1D tensor, but got x (".concat(n.shape,")."))),J(1===i.rank,(()=>"y should be 1D tensor, but got y (".concat(i.shape,").")));const r=await n.data(),s=await i.data(),o=new Set(s);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const c=new mr([a],n.dtype),l=new mr([a],"int32");for(let u=0,h=0;u<r.length;u++)o.has(r[u])||(c.values[h]=r[u],l.values[h]=u,h++);return[c.toTensor(),l.toTensor()]};const Yu=Yr({sign_:function(t){const e={x:qr(t,"x","sign")};return Lr.runKernel(pi,e)}});const Ku=Yr({sin_:function(t){const e={x:qr(t,"x","sin")};return Lr.runKernel(hi,e)}});const Qu=Yr({sinh_:function(t){const e={x:qr(t,"x","sinh")};return Lr.runKernel(di,e)}});const Zu=Yr({slice1d_:function(t,e,n){const i=qr(t,"x","slice1d");return J(1===i.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(i.rank," tensor"))),Nc(i,[e],[n])}});const Ju=Yr({slice2d_:function(t,e,n){const i=qr(t,"x","slice2d");return J(2===i.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(i.rank," tensor"))),Nc(i,e,n)}});const $u=Yr({slice3d_:function(t,e,n){const i=qr(t,"x","slice3d");return J(3===i.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(i.rank," tensor"))),Nc(i,e,n)}});const th=Yr({slice4d_:function(t,e,n){const i=qr(t,"x","slice4d");return J(4===i.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(i.rank," tensor"))),Nc(i,e,n)}});const eh=Yr({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=qr(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));const i={logits:n},r={dim:e};return Lr.runKernel(bi,i,r)}});const nh=Yr({fft_:function(t){J("complex64"===t.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return Lr.runKernel(He,e)}});const ih=Yr({ifft_:function(t){J("complex64"===t.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return Lr.runKernel(rn,e)}});const rh=Yr({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let i;if(e<=2){const r=kc(t,[n,e]);i=ih(r)}else{const r=[n,2*(e-1)],s=kc(Du(t),[n,e]),o=kc(Tl(t),[n,e]),a=Bu(Nc(s,[0,1],[n,e-2]),1),c=Aa(Bu(Nc(o,[0,1],[n,e-2]),1),za(-1)),l=Oc([s,a],1),u=Oc([o,c],1),h=kc(Kr(l,u),[r[0],r[1]]);i=ih(h)}if(i=Du(i),3===t.rank&&0!==t.shape[0]){const e=i,n=t.shape[0];i=kc(i,[n,i.shape[0]/n,i.shape[1]]),e.dispose()}return i}});const sh=Yr({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i={x:qr(t,"x","split")},r={numOrSizeSplits:e,axis:n};return Lr.runKernel(xi,i,r)}});const oh=Yr({rfft_:function(t,e){J("float32"===t.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(t.dtype)));let n=t.shape[t.shape.length-1];const i=t.size/n;let r;if(null!=e&&e<n){const i=t.shape.map((t=>0)),s=t.shape.map((t=>t));s[t.shape.length-1]=e,r=Nc(t,i,s),n=e}else if(null!=e&&e>n){const i=t.shape.map((t=>t));i[t.shape.length-1]=e-n,r=Oc([t,du(i)],t.shape.length-1),n=e}else r=t;const s=Ra(r),o=kc(Kr(r,s),[i,n]),a=nh(o),c=Math.floor(n/2)+1,l=Du(a),u=Tl(a),h=sh(l,[c,n-c],l.shape.length-1),d=sh(u,[c,n-c],u.shape.length-1),p=r.shape.slice();return p[r.shape.length-1]=c,kc(Kr(h[0],d[0]),p)}});const ah=Yr({squaredDifference_:function(t,e){let n=qr(t,"a","squaredDifference"),i=qr(e,"b","squaredDifference");[n,i]=Ir(n,i),Qa(n.shape,i.shape);const r={a:n,b:i};return Lr.runKernel(wi,r,{})}});const ch=Yr({squeeze_:function(t,e){const n=qr(t,"x","squeeze");return kc(n,pt(n.shape,e).newShape)}});const lh=Yr({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Hr(t,"tensors","stack","string_or_numeric");J(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&J(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const i=n,r={axis:e};return Lr.runKernel(Vn,i,r)}});const uh=Yr({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:qr(t,"x","step")},i={alpha:e};return Lr.runKernel(Pi,n,i)}});const hh=Yr({stridedSlice_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const l={x:qr(t,"x","stridedSlice")},u={begin:e,end:n,strides:i,beginMask:r,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:c};return Lr.runKernel(Ei,l,u)}});const dh=Yr({tan_:function(t){const e={x:qr(t,"x","tan")};return Lr.runKernel(Ci,e)}});function ph(t,e){tt(t);const n=Vr(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Qr(t,null,n,e)}function fh(t,e,n){if(tt(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const i=Vr(t,n);if(2!==i.length&&1!==i.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Qr(t,e,i,n)}function mh(t,e,n){if(tt(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const i=Vr(t,n);if(4!==i.length&&1!==i.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Qr(t,e,i,n)}function gh(t,e,n){if(tt(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const i=Vr(t,n);if(5!==i.length&&1!==i.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Qr(t,e,i,n)}function vh(t,e,n){if(tt(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const i=Vr(t,n);if(6!==i.length&&1!==i.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Qr(t,e=e||i,i,n)}const yh=Yr({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=qr(t,"x","topk");if(0===i.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const r=i.shape[i.shape.length-1];if(e>r)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(r,") ")+"but got ".concat(e));const s={x:i},o={k:e,sorted:n},[a,c]=Lr.runKernel(Ii,s,o);return{values:a,indices:c}}});const xh=Yr({truncatedNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(null!=i&&"bool"===i)throw new Error("Unsupported data type $ { dtype }");const s=new ku(e,n,i,!0,r),o=Hs(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}});const bh=Yr({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=qr(t,"x","unique","string_or_numeric");J(n.rank>0,(()=>"The input tensor must be at least 1D"));const i={x:n},r={axis:e},[s,o]=Lr.runKernel(Ri,i,r);return{values:s,indices:o}}});const wh=Yr({unsortedSegmentSum_:function(t,e,n){const i=qr(t,"x","unsortedSegmentSum"),r=qr(e,"segmentIds","unsortedSegmentSum","int32");J(st(n),(()=>"numSegments must be of dtype int"));const s={x:i,segmentIds:r},o={numSegments:n};return Lr.runKernel(Mi,s,o)}});const Sh=Yr({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=qr(t,"x","unstack","string_or_numeric");J(e>=-n.shape.length&&e<n.shape.length,(()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const i={value:n},r={axis:e};return Lr.runKernel(Ni,i,r)}});function _h(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return Lr.makeVariable(t,e,n,i)}function Th(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const i=Hs(t,"int32"),r=Hs([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const e=i.indexToLoc(n[s]),o=s*t.length;r.values.set(e,o)}return r.toTensor()}const Eh=async function(t){const e=qr(t,"condition","whereAsync","bool"),n=await e.data(),i=Th(e.shape,n);return t!==e&&e.dispose(),i};const Ch=async function(t,e,n){const i=qr(t,"tensor","boolMask"),r=qr(e,"mask","boolMask","bool"),s=null==n?0:n,o=r.rank,a=i.shape;J(o>0,(()=>"mask cannot be scalar")),$(a.slice(s,s+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let m=s;m<s+o;m++)c*=a[m];const l=a.slice(0,s).concat([c],a.slice(s+o)),u=kc(i,l),h=kc(r,[-1]),d=await Eh(h),p=ch(d,[1]),f=wl(u,p,s);return t!==i&&i.dispose(),e!==r&&r.dispose(),p.dispose(),u.dispose(),h.dispose(),d.dispose(),f};const kh=Yr({equalStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","equalStrict"),i=qr(e,"b","equalStrict");return $(n.shape,i.shape,"Error in equalStrict: "),ll(n,i)}}),Ah=Yr({greaterEqualStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","greaterEqualStrict"),i=qr(e,"b","greaterEqualStrict");return $(n.shape,i.shape,"Error in greaterEqualStrict: "),_l(n,i)}}),Ih=Yr({greaterStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","greaterStrict"),i=qr(e,"b","greaterStrict");return $(n.shape,i.shape,"Error in greaterStrict: "),Sl(n,i)}}),Oh=Yr({lessEqualStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","lessEqualStrict"),i=qr(e,"b","lessEqualStrict");return $(n.shape,i.shape,"Error in lessEqualStrict: "),Ol(n,i)}}),Rh=Yr({lessStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","lessStrict"),i=qr(e,"b","lessStrict");return $(n.shape,i.shape,"Error in lessStrict: "),Il(n,i)}}),Nh=Yr({notEqualStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","notEqualStrict"),i=qr(e,"b","notEqualStrict");return $(n.shape,i.shape,"Error in notEqualStrict: "),hu(n,i)}});const Mh=Yr({addStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","addStrict"),i=qr(e,"b","addStrict");return $(n.shape,i.shape,"Error in addStrict: "),Ea(n,i)}}),Dh=Yr({divStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","div"),i=qr(e,"b","div");return $(n.shape,i.shape,"Error in divideStrict: "),ka(n,i)}}),Ph=Yr({maximumStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","maximumStrict"),i=qr(e,"b","maximumStrict");return $(n.shape,i.shape,"Error in maximumStrict: "),Za(n,i)}}),Fh=Yr({minimumStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","minimumStrict"),i=qr(e,"b","minimumStrict");return $(n.shape,i.shape,"Error in minimumStrict: "),su(n,i)}}),Lh=Yr({modStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","modStrict"),i=qr(e,"b","modStrict");return $(n.shape,i.shape,"Error in modStrict: "),au(n,i)}}),Bh=Yr({mulStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","mul"),i=qr(e,"b","mul");return $(n.shape,i.shape,"Error in multiplyStrict: "),Aa(n,i)}}),zh=Yr({powStrict_:function(t,e){return aa("strict variants of ops have been deprecated and will be removed in future"),$(t.shape,e.shape,"Error in powStrict: "),Ga(t,e)}}),Uh=Yr({squaredDifferenceStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","squaredDifferenceStrict"),i=qr(e,"b","squaredDifferenceStrict");return $(n.shape,i.shape,"Error in squaredDifferenceStrict: "),ah(n,i)}}),jh=Yr({subStrict_:function(t,e){aa("strict variants of ops have been deprecated and will be removed in future");const n=qr(t,"a","subStrict"),i=qr(e,"b","subStrict");return $(n.shape,i.shape,"Error in subStrict: "),qa(n,i)}});function Vh(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return Xa(t);if(1!==t.rank&&null===n)return Vh(kc(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return zl(Xa(t),n);if(e===1/0)return Bl(Xa(t),n);if(e===-1/0)return ru(Xa(t),n);if("euclidean"===e||2===e)return Ia(zl(Ga(Xa(t),za(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return Bl(zl(Xa(t),n[0]),n[1]-1);if(e===1/0)return Bl(zl(Xa(t),n[1]),n[0]);if(e===-1/0)return ru(zl(Xa(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Ia(zl(Oa(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}const Wh=Yr({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=Vh(t=qr(t,"x","norm"),e,n);let s=r.shape;if(i){const e=dt(n,t.shape);s=Gl(r.shape,e)}return kc(r,s)}});const Gh=Yr({movingAverage_:function(t,e,n,i){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const s=qr(t,"v","movingAverage"),o=qr(e,"x","movingAverage"),a=qr(n,"decay","movingAverage");Or(s,o),J(rt(s.shape,o.shape),(()=>"Shape mismatch in v and x"));const c=za(1),l=qa(c,a);let u=Aa(qa(o,s),l);if(r){J(null!=i,(()=>"When using zeroDebias: true, step is required."));const t=qr(i,"step","movingAverage");u=ka(u,qa(c,Ga(a,t)))}return Ea(s,u)}});const qh=Yr({scatterND_:function(t,e,n){const i=qr(t,"indices","scatterND","int32"),r=qr(e,"updates","scatterND");To(r,i,n);const s={indices:i,updates:r},o={shape:n};return Lr.runKernel(ai,s,o)}});const Hh=Yr({sparseToDense_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=qr(t,"sparseIndices","sparseToDense","int32"),s=qr(e,"sparseValues","sparseToDense"),o=qr(i,"defaultValue","sparseToDense",s.dtype);!function(t,e,n,i){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));const r=t.rank>0?t.shape[0]:1,s=t.rank>1?t.shape[1]:1;if(n.length!==s)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(s,"."));const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==r))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(r,"]"));if(e.dtype!==i.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,s,n,o);const a={sparseIndices:r,sparseValues:s,defaultValue:o},c={outputShape:n};return Lr.runKernel(Ti,a,c)}});const Xh=Yr({gatherND_:function(t,e){const n=qr(e,"indices","gatherND","int32"),i={params:qr(t,"x","gatherND"),indices:n};return Lr.runKernel($e,i)}});const Yh=Yr({dropout_:function(t,e,n,i){const r=qr(t,"x","dropout");if(J("float32"===r.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(r.dtype," tensor instead."))),J(e>=0&&e<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(e,"."))),0===e)return t instanceof xr?r.clone():r;const s=function(t,e){if(null==e)return t.shape.slice();if(rt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let i=0;i<t.shape.length;i++)null==e[i]&&null!=t.shape[i]?n.push(t.shape[i]):n.push(e[i]);return n}return e}(r,n),o=1-e,a=ka(bl(Ea(Nu(s,0,1,"float32",i),o)),o);return Aa(r,a)}});function Kh(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Qh(t,e,n){const i=1-t%2,r=new Float32Array(t);for(let s=0;s<t;++s){const o=2*Math.PI*s/(t+i-1);r[s]=e-n*Math.cos(o)}return ph(r,"float32")}const Zh=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=qr(t,"predictions","inTopK"),r=qr(e,"targets","inTopK");J(i.rank>1,(()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(i.rank))),J(i.rank-1===r.rank,(()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(i.rank," and targets rank ").concat(r.rank))),$(i.shape.slice(0,i.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=i.shape[i.shape.length-1];J(n>0&&n<=s,(()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(s,"), but got ").concat(n)));const o=await i.data(),a=await r.data(),[c,l]=[o.length/s,s],u=ft("bool",c);for(let h=0;h<c;h++){const t=h*l,e=o.subarray(t,t+l),i=[];for(let n=0;n<e.length;n++)i.push({value:e[n],index:n});i.sort(((t,e)=>e.value-t.value)),u[h]=0;for(let r=0;r<n;r++)if(i[r].index===a[h]){u[h]=1;break}}return t!==i&&i.dispose(),e!==r&&r.dispose(),Zr(u,r.shape,"bool")};const Jh=Yr({conv2DBackpropFilter_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,a=t;3===t.rank&&(a=kc(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;3===c.rank&&(c=kc(e,[1,e.shape[0],e.shape[1],e.shape[2]])),J(4===a.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(a.shape,"."))),J(4===c.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(c.shape,"."))),J(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const l="NHWC"===s?a.shape[3]:a.shape[1],u="NHWC"===s?c.shape[3]:c.shape[1];J(l===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],"."))),J(u===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],")."))),null!=o&&J(st(r),(()=>"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")));const h={x:a,dy:c},d={strides:i,pad:r,dataFormat:s,dimRoundingMode:o,filterShape:n};return Lr.runKernel(be,h,d)}});function $h(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Aa(t,uh(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function td(t,e){let n=e;const i=Ka(t.shape,e.shape);return i.length>0&&(n=zl(n,i)),kc(n,t.shape)}function ed(t,e,n,i){if("linear"===e)return t;if("relu"===e)return Fu(t);if("elu"===e)return pl(t);if("relu6"===e)return Lu(t);if("prelu"===e)return _u(t,n);if("leakyrelu"===e)return Al(t,i);throw new Error("Unknown fused activation ".concat(e,"."))}const nd=(t,e)=>!(t>0)||"linear"===e;const id=Yr({fusedConv2d_:function(t){let{x:e,filter:n,strides:i,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(l=l||"linear",!1===nd(Lr.state.gradientDepth,l)){let t=Yc(e,n,i,r,s,o,a);return null!=c&&(t=Ea(t,c)),ed(t,l,u,h)}const d=qr(e,"x","conv2d"),p=qr(n,"filter","conv2d");let f=d,m=!1;3===d.rank&&(m=!0,f=kc(d,[1,d.shape[0],d.shape[1],d.shape[2]])),J(4===f.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(f.rank,"."))),J(4===p.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,"."))),null!=a&&J(st(r),(()=>"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,"."))),J(f.shape[3]===p.shape[2],(()=>"Error in conv2d: depth of input (".concat(f.shape[3],") must match ")+"input depth for filter ".concat(p.shape[2],"."))),J(Ec(i,o),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(o,"'"))),J("NHWC"===s,(()=>"Error in conv2d: got dataFormat of ".concat(s," but only NHWC is currently supported.")));const g=vc(f.shape,p.shape,i,o,r,a);let v,y;null!=c&&(v=qr(c,"bias","fused conv2d"),[v]=Ir(v,d),Qa(g.outShape,v.shape)),null!=u&&(y=qr(u,"prelu weights","fused conv2d"));const x=(t,e)=>{const[n,s,a,c]=e,u=$h(t,a,l);J(Tc(o),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")));const h=[Qc(s.shape,u,n,i,r),Jh(s,u,n.shape,i,r)];if(null!=c){const t=td(c,u);h.push(t)}return h},b={x:f,filter:p,bias:v,preluActivationWeights:y},w={strides:i,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:h};if(null==c){const t=La(((t,e,n)=>{let i=Lr.runKernel(zi,b,w);return n([e,t,i]),m&&(i=kc(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return t(f,p)}{const t=La(((t,e,n,i)=>{let r=Lr.runKernel(zi,b,w);return i([e,t,r,n]),m&&(r=kc(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return t(f,p,v)}}});const rd=Yr({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=t;3===t.rank&&(a=kc(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;3===c.rank&&(c=kc(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={x:a,dy:c},u={strides:i,pad:r,dimRoundingMode:o,dilations:s,filterShape:n};return Lr.runKernel(Ne,l,u)}});const sd=Yr({depthwiseConv2dNativeBackpropInput_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,a=e,c=!1;3===e.rank&&(c=!0,a=kc(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={dy:a,filter:n},u={strides:i,pad:r,dimRoundingMode:o,dilations:s,inputShape:t},h=Lr.runKernel(Me,l,u);return c?kc(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const od=Yr({fusedDepthwiseConv2d_:function(t){let{x:e,filter:n,strides:i,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(!1===nd(Lr.state.gradientDepth,l)){let t=ol(e,n,i,r,s,o,a);return null!=c&&(t=Ea(t,c)),ed(t,l,u,h)}const d=qr(e,"x","depthwiseConv2d"),p=qr(n,"filter","depthwiseConv2d");let f=d,m=!1;3===d.rank&&(m=!0,f=kc(d,[1,d.shape[0],d.shape[1],d.shape[2]])),J(4===f.rank,(()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(f.rank,"."))),J(4===p.rank,(()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(p.rank,"."))),J(f.shape[3]===p.shape[2],(()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(f.shape[3],") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],"."))),null==o&&(o=[1,1]),J(Ec(i,o),(()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(i," and dilations '").concat(o,"'"))),null!=a&&J(st(r),(()=>"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(a," but got pad ").concat(r,".")));const g=vc(f.shape,p.shape,i,o,r,a,!0);let v,y;null!=c&&(v=qr(c,"bias","fused conv2d"),[v]=Ir(v,d),Qa(g.outShape,v.shape)),null!=u&&(y=qr(u,"prelu weights","fused depthwiseConv2d"));const x=(t,e)=>{J(Tc(o),(()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'")));const[n,s,c,u]=e,h=$h(t,c,l),d=sd(s.shape,h,n,i,r,o,a),p=rd(s,h,n.shape,i,r,o,a);if(null!=u){return[d,p,td(v,h)]}return[d,p]},b={x:f,filter:p,bias:v,preluActivationWeights:y},w={strides:i,pad:r,dataFormat:s,dilations:o,dimRoundingMode:a,activation:l,leakyreluAlpha:h};if(null==c){const t=La(((t,e,n)=>{let i=Lr.runKernel(Ui,b,w);return n([e,t,i]),m&&(i=kc(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return t(f,p)}{const t=La(((t,e,n,i)=>{let r=Lr.runKernel(Ui,b,w);return i([e,t,r,n]),m&&(r=kc(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return t(f,p,v)}}});const ad=Yr({fusedMatMul_:function(t){let{a:e,b:n,transposeA:i=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:c}=t;if(!1===nd(Lr.state.gradientDepth,o)){let t=fo(e,n,i,r);return null!=s&&(t=Ea(t,s)),ed(t,o,a,c)}let l=qr(e,"a","fused matMul"),u=qr(n,"b","fused matMul");[l,u]=Ir(l,u);const h=i?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=i?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),v=nt(m),y=nt(g);J(l.rank>=2&&u.rank>=2&&l.rank===u.rank,(()=>"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(l.rank," and ").concat(u.rank,"."))),J(rt(m,g),(()=>"Error in fused matMul: outer dimensions (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(l.shape," and ")+"".concat(u.shape," must match."))),J(h===d,(()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(l.shape," and ")+"".concat(u.shape," and transposeA=").concat(i)+" and transposeB=".concat(r," must match.")));const x=l.shape.slice(0,-2).concat([p,f]),b=kc(l,i?[v,h,p]:[v,p,h]),w=kc(u,r?[y,f,d]:[y,d,f]);let S,_;null!=s&&(S=qr(s,"bias","fused matMul"),[S]=Ir(S,l),Qa(x,S.shape)),null!=a&&(_=qr(a,"prelu weights","fused matMul"));const T=(t,e)=>{const[n,a,c,l]=e,u=$h(kc(t,c.shape),c,o);let h,d;if(i||r?!i&&r?(h=fo(u,a,!1,!1),d=fo(u,n,!0,!1)):i&&!r?(h=fo(a,u,!1,!0),d=fo(n,u,!1,!1)):(h=fo(a,u,!0,!0),d=fo(u,n,!0,!0)):(h=fo(u,a,!1,!0),d=fo(n,u,!0,!1)),null!=s){return[h,d,td(l,u)]}return[h,d]},E={a:b,b:w,bias:S,preluActivationWeights:_},C={transposeA:i,transposeB:r,activation:o,leakyreluAlpha:c};if(null==s){const t=La(((t,e,n)=>{const i=Lr.runKernel(Bi,E,C);return n([t,e,i]),{value:kc(i,x),gradFunc:T}}));return t(b,w)}{const t=La(((t,e,n,i)=>{const r=Lr.runKernel(Bi,E,C);return i([t,e,r,n]),{value:kc(r,x),gradFunc:T}}));return t(b,w,S)}}});const cd=Yr({hammingWindow_:function(t){return Qh(t,.54,.46)}});const ld=Yr({hannWindow_:function(t){return Qh(t,.5,.5)}});const ud=Yr({frame_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=0;const o=[];for(;s+e<=t.size;)o.push(Nc(t,s,e)),s+=n;if(i)for(;s<t.size;){const i=s+e-t.size,a=Oc([Nc(t,s,e-i),Va([i],r)]);o.push(a),s+=n}return 0===o.length?fh([],[0,e]):kc(Oc(o),[o.length,e])}});const hd=Yr({stft_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ld;null==i&&(i=Kh(e));const s=ud(t,e,n),o=Aa(s,r(e)),a=[];for(let c=0;c<s.shape[0];c++)a.push(oh(Nc(o,[c,0],[1,e]),i));return Oc(a)}});const dd=Yr({cropAndResize_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=qr(t,"image","cropAndResize"),a=qr(e,"boxes","cropAndResize","float32"),c=qr(n,"boxInd","cropAndResize","int32"),l=a.shape[0];J(4===o.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),J(2===a.rank&&4===a.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(a.shape,"."))),J(1===c.rank&&c.shape[0]===l,(()=>"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(a.shape,"."))),J(2===i.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(i.length,"."))),J(i[0]>=1&&i[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(i))),J("bilinear"===r||"nearest"===r,(()=>"method must be bilinear or nearest, but was ".concat(r)));const u={image:o,boxes:a,boxInd:c},h={method:r,extrapolationValue:s,cropSize:i};return Lr.runKernel(Ae,u,h)}});const pd=Yr({flipLeftRight_:function(t){const e=qr(t,"image","flipLeftRight","float32");J(4===e.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")));const n={image:e};return Lr.runKernel(Ye,n,{})}});const fd=Yr({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const r=qr(t,"image","rotateWithOffset","float32");J(4===r.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(r.rank,".")));const s={image:r},o={radians:e,fillValue:n,center:i};return Lr.runKernel(Li,s,o)}});function md(t,e,n,i,r,s){null==i&&(i=.5),null==r&&(r=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=t.shape[0];return n=Math.min(n,o),J(0<=i&&i<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(i,"'"))),J(2===t.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'"))),J(4===t.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1]))),J(1===e.rank,(()=>"scores must be a 1D tensor")),J(e.shape[0]===o,(()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0]))),J(0<=s&&s<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(s,"'"))),{maxOutputSize:n,iouThreshold:i,scoreThreshold:r,softNmsSigma:s}}const gd=Yr({nonMaxSuppression_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const s=qr(t,"boxes","nonMaxSuppression"),o=qr(e,"scores","nonMaxSuppression"),a=md(s,o,n,i,r);n=a.maxOutputSize,i=a.iouThreshold,r=a.scoreThreshold;const c={maxOutputSize:n,iouThreshold:i,scoreThreshold:r};return Lr.runKernel(Ln,{boxes:s,scores:o},c)}});function vd(t,e,n){const i=function(t,e,n){return function(t,e,n){let i=0,r=t.length,s=0,o=!1;for(;i<r;){s=i+(r-i>>>1);const a=n(e,t[s]);a>0?i=s+1:(r=s,o=!a)}return o?i:-i-1}(t,e,n||yd)}(t,e,n),r=i<0?-(i+1):i;t.splice(r,0,e)}function yd(t,e){return t>e?1:t<e?-1:0}function xd(t,e,n,i,r){return Sd(t,e,n,i,r,0)}function bd(t,e,n,i,r,s){return Sd(t,e,n,i,r,0,!1,s,!0)}function wd(t,e,n,i,r,s){return Sd(t,e,n,i,r,s,!0)}function Sd(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=[];for(let g=0;g<e.length;g++)e[g]>r&&l.push({score:e[g],boxIndex:g,suppressBeginIndex:0});l.sort(Ed);const u=s>0?-.5/s:0,h=[],d=[];for(;h.length<n&&l.length>0;){const e=l.pop(),{score:n,boxIndex:s,suppressBeginIndex:o}=e;if(n<r)break;let a=!1;for(let c=h.length-1;c>=o;--c){const n=_d(t,s,h[c]);if(n>=i){a=!0;break}if(e.score=e.score*Td(i,u,n),e.score<=r)break}e.suppressBeginIndex=h.length,a||(e.score===n?(h.push(s),d.push(e.score)):e.score>r&&vd(l,e,Ed))}const p=h.length,f=n-p;a&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:h};return o&&(m.selectedScores=d),c&&(m.validOutputs=p),m}function _d(t,e,n){const i=t.subarray(4*e,4*e+4),r=t.subarray(4*n,4*n+4),s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),c=Math.max(i[1],i[3]),l=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),p=(a-s)*(c-o),f=(h-l)*(d-u);if(p<=0||f<=0)return 0;const m=Math.max(s,l),g=Math.max(o,u),v=Math.min(a,h),y=Math.min(c,d),x=Math.max(v-m,0)*Math.max(y-g,0);return x/(p+f-x)}function Td(t,e,n){const i=Math.exp(e*n*n);return n<=t?i:0}function Ed(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const Cd=async function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const s=qr(t,"boxes","nonMaxSuppressionAsync"),o=qr(e,"scores","nonMaxSuppressionAsync"),a=md(s,o,n,i,r);n=a.maxOutputSize,i=a.iouThreshold,r=a.scoreThreshold;const c=await Promise.all([s.data(),o.data()]),l=c[0],u=c[1],{selectedIndices:h}=xd(l,u,n,i,r);return s!==t&&s.dispose(),o!==e&&o.dispose(),ph(h,"int32")};const kd=Yr({nonMaxSuppressionWithScore_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=qr(t,"boxes","nonMaxSuppression"),a=qr(e,"scores","nonMaxSuppression"),c=md(o,a,n,i,r,s);n=c.maxOutputSize,i=c.iouThreshold,r=c.scoreThreshold,s=c.softNmsSigma;const l={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:i,scoreThreshold:r,softNmsSigma:s},h=Lr.runKernel(zn,l,u);return{selectedIndices:h[0],selectedScores:h[1]}}});const Ad=async function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=qr(t,"boxes","nonMaxSuppressionAsync"),a=qr(e,"scores","nonMaxSuppressionAsync"),c=md(o,a,n,i,r,s);n=c.maxOutputSize,i=c.iouThreshold,r=c.scoreThreshold,s=c.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),u=l[0],h=l[1],{selectedIndices:d,selectedScores:p}=wd(u,h,n,i,r,s);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ph(d,"int32"),selectedScores:ph(p)}};const Id=Yr({nonMaxSuppressionPadded_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=qr(t,"boxes","nonMaxSuppression"),a=qr(e,"scores","nonMaxSuppression"),c=md(o,a,n,i,r,null),l={boxes:o,scores:a},u={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:s},h=Lr.runKernel(Bn,l,u);return{selectedIndices:h[0],validOutputs:h[1]}}});const Od=async function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=qr(t,"boxes","nonMaxSuppressionAsync"),a=qr(e,"scores","nonMaxSuppressionAsync"),c=md(o,a,n,i,r,null),l=c.maxOutputSize,u=c.iouThreshold,h=c.scoreThreshold,[d,p]=await Promise.all([o.data(),a.data()]),{selectedIndices:f,validOutputs:m}=bd(d,p,l,u,h,s);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:ph(f,"int32"),validOutputs:za(m,"int32")}};const Rd=Yr({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=qr(t,"images","resizeBilinear");J(3===r.rank||4===r.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,"."))),J(2===e.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,"."))),J(!1===i||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let s=r,o=!1;3===r.rank&&(o=!0,s=kc(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const[]=e,a={images:s},c={alignCorners:n,halfPixelCenters:i,size:e},l=Lr.runKernel(ei,a,c);return o?kc(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const Nd=Yr({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=qr(t,"images","resizeNearestNeighbor");J(3===r.rank||4===r.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,"."))),J(2===e.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,"."))),J("float32"===r.dtype||"int32"===r.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),J(!1===i||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let s=r,o=!1;3===r.rank&&(o=!0,s=kc(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const[]=e,a={images:s},c={alignCorners:n,halfPixelCenters:i,size:e},l=Lr.runKernel($n,a,c);return o?kc(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const Md=Yr({bandPart_:function(t,e,n){J(e%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(e,"."))),J(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")));const i=qr(t,"a","bandPart");J(i.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(i.rank,".")));const r=i.shape,[s,o]=i.shape.slice(-2);if(!(e<=s))throw new Error("bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(s,")."));if(!(n<=o))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,")."));e<0&&(e=s),n<0&&(n=o);const a=kc(Mu(0,s,1,"int32"),[-1,1]),c=Mu(0,o,1,"int32"),l=qa(a,c),u=Ql(Ol(l,za(+e,"int32")),_l(l,za(-n,"int32"))),h=du([s,o],i.dtype);return kc(lh(Sh(kc(i,[-1,s,o])).map((t=>ul(u,t,h)))),r)}});const Dd=Yr({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,J(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)J(t[e].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")))}else e=!0,t=sh(t,t.shape[0],0).map((t=>ch(t,[0])));J(t.length<=t[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")));const n=[],i=t;for(let r=0;r<t.length;++r)n.push(Lr.tidy((()=>{let t=i[r];if(r>0)for(let e=0;e<r;++e){const i=Aa(zl(Aa(n[e],t)),n[e]);t=qa(t,i)}return ka(t,Wh(t,"euclidean"))})));return e?lh(n,0):n}});function Pd(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Lr.tidy((()=>{J(2===t.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")));const n=t.shape[0],i=t.shape[1];let r=xl(n),s=Ys(t);const o=fh([[1]],[1,1]);let a=Ys(o);const c=n>=i?i:n;for(let t=0;t<c;++t){const e=s,c=a,l=r;[a,s,r]=Lr.tidy((()=>{const e=Nc(s,[t,t],[n-t,1]),c=Wh(e),l=Nc(s,[t,t],[1,1]),u=ul(Sl(l,0),fh([[-1]]),fh([[1]])),h=qa(l,Aa(u,c)),d=ka(e,h);a=1===d.shape[0]?Ys(o):Oc([o,Nc(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=Pl(ka(fo(u,h),c)),f=Nc(s,[t,0],[n-t,i]),m=Aa(p,a),g=go(a);if(0===t)s=qa(f,fo(m,fo(g,f)));else{const e=qa(f,fo(m,fo(g,f)));s=Oc([Nc(s,[0,0],[t,i]),e],0)}const v=go(m),y=Nc(r,[0,t],[n,r.shape[1]-t]);if(0===t)r=qa(y,fo(fo(y,a),v));else{const e=qa(y,fo(fo(y,a),v));r=Oc([Nc(r,[0,0],[n,t]),e],1)}return[a,s,r]})),pa([e,c,l])}return!e&&n>i&&(r=Nc(r,[0,0],[n,i]),s=Nc(s,[0,0],[i,i])),[r,s]}))}const Fd=Yr({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(J(t.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank))),2===t.rank)return Pd(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),i=Sh(kc(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],s=[];i.forEach((t=>{const[n,i]=Pd(t,e);r.push(n),s.push(i)}));return[kc(lh(r,0),t.shape),kc(lh(s,0),t.shape)]}}});var Ld;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ld||(Ld={}));const Bd=Yr({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ld.SUM_BY_NONZERO_WEIGHTS;const i=qr(t,"losses","computeWeightedLoss");let r=null;null!=e&&(r=qr(e,"weights","computeWeightedLoss"));const s=null==r?i:Aa(i,r);if(n===Ld.NONE)return s;if(n===Ld.SUM)return zl(s);if(n===Ld.MEAN){if(null==r)return iu(s);{const t=i.size/r.size,e=ka(zl(s),zl(r));return t>1?ka(e,za(t)):e}}if(n===Ld.SUM_BY_NONZERO_WEIGHTS){if(null==r)return ka(zl(s),za(i.size));{const t=Aa(r,pu(i.shape)),e=Xs(zl(hu(t,za(0))),"float32");return ka(zl(s),e)}}throw Error("Unknown reduction: ".concat(n))}});const zd=Yr({absoluteDifference_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ld.SUM_BY_NONZERO_WEIGHTS;const r=qr(t,"labels","absoluteDifference"),s=qr(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=qr(n,"weights","absoluteDifference")),$(r.shape,s.shape,"Error in absoluteDifference: ");const a=Xa(qa(r,s));return Bd(a,o,i)}});const Ud=Yr({cosineDistance_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ld.SUM_BY_NONZERO_WEIGHTS;const s=qr(t,"labels","cosineDistance"),o=qr(e,"predictions","cosineDistance");let a=null;null!=i&&(a=qr(i,"weights","cosineDistance")),$(s.shape,o.shape,"Error in cosineDistance: ");const c=za(1),l=qa(c,zl(Aa(s,o),n,!0));return Bd(l,a,r)}});const jd=Yr({hingeLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ld.SUM_BY_NONZERO_WEIGHTS,r=qr(t,"labels","hingeLoss");const s=qr(e,"predictions","hingeLoss");let o=null;null!=n&&(o=qr(n,"weights","hingeLoss")),$(r.shape,s.shape,"Error in hingeLoss: ");const a=za(1);r=qa(Aa(za(2),r),a);const c=Fu(qa(a,Aa(r,s)));return Bd(c,o,i)}});const Vd=Yr({huberLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ld.SUM_BY_NONZERO_WEIGHTS;const s=qr(t,"labels","huberLoss"),o=qr(e,"predictions","huberLoss");let a=null;null!=n&&(a=qr(n,"weights","huberLoss")),$(s.shape,o.shape,"Error in huberLoss: ");const c=za(i),l=Xa(qa(o,s)),u=su(l,c),h=qa(l,u),d=Ea(Aa(za(.5),Oa(u)),Aa(c,h));return Bd(d,a,r)}});const Wd=Yr({logLoss_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ld.SUM_BY_NONZERO_WEIGHTS;const s=qr(t,"labels","logLoss"),o=qr(e,"predictions","logLoss");let a=null;null!=n&&(a=qr(n,"weights","logLoss")),$(s.shape,o.shape,"Error in logLoss: ");const c=za(1),l=za(i),u=Pl(Aa(s,Ml(Ea(o,l)))),h=Aa(qa(c,s),Ml(Ea(qa(c,o),l))),d=qa(u,h);return Bd(d,a,r)}});const Gd=Yr({meanSquaredError_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ld.SUM_BY_NONZERO_WEIGHTS;const r=qr(t,"labels","meanSquaredError"),s=qr(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=qr(n,"weights","meanSquaredError")),$(r.shape,s.shape,"Error in meanSquaredError: ");const a=ah(r,s);return Bd(a,o,i)}});const qd=Yr({sigmoidCrossEntropy_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ld.SUM_BY_NONZERO_WEIGHTS,s=qr(t,"multiClassLabels","sigmoidCrossEntropy");const o=qr(e,"logits","sigmoidCrossEntropy");let a=null;if(null!=n&&(a=qr(n,"weights","sigmoidCrossEntropy")),$(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),i>0){const t=za(i),e=za(1),n=za(.5);s=Ea(Aa(s,qa(e,t)),Aa(n,t))}const c=function(t,e){const n=qr(t,"labels","sigmoidCrossEntropyWithLogits"),i=qr(e,"logits","sigmoidCrossEntropyWithLogits");$(n.shape,i.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Fu(i),s=Aa(i,n),o=Dl(ml(Pl(Xa(i))));return Ea(qa(r,s),o)}(s,o);return Bd(c,a,r)}});const Hd=Yr({softmaxCrossEntropy_:function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ld.SUM_BY_NONZERO_WEIGHTS,s=qr(t,"onehotLabels","softmaxCrossEntropy");const o=qr(e,"logits","softmaxCrossEntropy");let a=null;if(null!=n&&(a=qr(n,"weights","softmaxCrossEntropy")),$(s.shape,o.shape,"Error in softmaxCrossEntropy: "),i>0){const t=za(i),e=za(1),n=za(s.shape[1]);s=Ea(Aa(s,qa(e,t)),ka(t,n))}const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));const i=La(((t,e,i)=>{const r=Kl(e,[n],!0),s=qa(Xs(e,"float32"),r);i([t,s]);const o=Pl(Aa(s,t));return{value:zl(o,[n]),gradFunc:(t,e)=>{const[i,r]=e,s=Gl(t.shape,[n]);return[Aa(kc(t,s),qa(Xs(i,"float32"),ml(r))),Aa(kc(t,s),qa(ml(r),Xs(i,"float32")))]}}}));return i(t,e)}(s,o);return Bd(c,a,r)}}),Xd={fft:nh,ifft:ih,rfft:oh,irfft:rh},Yd={hammingWindow:cd,hannWindow:ld,frame:ud,stft:hd},Kd={flipLeftRight:pd,resizeNearestNeighbor:Nd,resizeBilinear:Rd,rotateWithOffset:fd,cropAndResize:dd,nonMaxSuppression:gd,nonMaxSuppressionAsync:Cd,nonMaxSuppressionWithScore:kd,nonMaxSuppressionWithScoreAsync:Ad,nonMaxSuppressionPadded:Id,nonMaxSuppressionPaddedAsync:Od},Qd={bandPart:Md,gramSchmidt:Dd,qr:Fd},Zd={absoluteDifference:zd,computeWeightedLoss:Bd,cosineDistance:Ud,hingeLoss:jd,huberLoss:Vd,logLoss:Wd,meanSquaredError:Gd,sigmoidCrossEntropy:qd,softmaxCrossEntropy:Hd};class Jd{static sgd(t){return new $a(t)}static momentum(t,e){return new tc(t,e,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(t){return new ec(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new Ha(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new ja(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new Ja(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(t){return new Wa(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}const $d={sgd:Jd.sgd,momentum:Jd.momentum,adadelta:Jd.adadelta,adagrad:Jd.adagrad,rmsprop:Jd.rmsprop,adamax:Jd.adamax,adam:Jd.adam},tp="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t();function ep(){return new Promise((t=>tp((()=>t()))))}function np(t,e){const n=t[0].length;t.forEach(((t,e)=>{J(t.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),J(e>=0&&e<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const i=t[0];t.forEach(((t,r)=>{for(let s=0;s<n;s++)J(s===e||t[s]===i[s],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(r,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(i,") ")+"along the non-concatenated axis ".concat(r,".")))}))}function ip(t,e){const n=t[0].slice();for(let i=1;i<t.length;i++)n[e]+=t[i][e];return n}const rp=30;function sp(t){return t<=rp?t:kt(t,Math.floor(Math.sqrt(t)))}function op(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function ap(t,e,n){let i=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}return i}function cp(t,e){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(e);for(let i=e+1;i<t;++i)i<=2*e?(n.push(i),n.push(i-(e+1))):n.push(i)}else{const i=[],r=[];for(let n=1;n<t;++n)n>=2*e+1||n%2===1?r.push(n):i.push(n);n.push(...i),n.push(0),n.push(...r)}return n}function lp(t,e,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=[];i?r.push(t[0]/n):r.push(t[0]*n);for(let s=1;s<t.length;++s)s<=e.length?i?r.push(e[s-1]*t[s]):r.push(t[s]/e[s-1]):r.push(t[s]);return r}function up(t,e){const n=[0];for(let i=0;i<e;++i)n.push(t[i][0]);return n}function hp(t,e,n){const i=t.slice(0,1);for(let r=0;r<n;++r)i.push(t[r+1]-e[r][0]-e[r][1]);return i}const dp=1.7580993408473768,pp=1.0507009873554805,fp=.3275911,mp=.254829592,gp=-.284496736,vp=1.421413741,yp=-1.453152027,xp=1.061405429;function bp(){Ut().getBool("IS_TEST")||console.warn(...arguments)}function wp(){Ut().getBool("IS_TEST")||console.log(...arguments)}function Sp(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let i=0;i<n.length;i+=2)n[i]=t[i/2],n[i+1]=e[i/2];return n}function _p(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let i=0;i<t.length;i+=2)e[i/2]=t[i],n[i/2]=t[i+1];return{real:e,imag:n}}function Tp(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function Ep(t){const e=Math.floor(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function Cp(t,e){return{real:t[2*e],imag:t[2*e+1]}}function kp(t,e,n,i){t[2*i]=e,t[2*i+1]=n}function Ap(t,e){const n=new Float32Array(t/2),i=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const s=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(s),i[r]=Math.sin(s)}return{real:n,imag:i}}function Ip(t,e,n){const i=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(i),imag:Math.sin(i)}}function Op(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if("number"===typeof e)J(t.shape[n]%e===0,(()=>"Number of splits must evenly divide the axis.")),i=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);J(r<=1,(()=>"There should be only one negative value in split array."));const s=e.indexOf(-1);if(-1!==s){const i=e.reduce(((t,e)=>e>0?t+e:t));e[s]=t.shape[n]-i}J(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),i=e}return i}function Rp(t,e){let n,i=!1;for(t<=rp?(n=t,i=!0):n=kt(t,Math.floor(Math.sqrt(t)));!i;)n>e||n===t?i=!0:n=kt(t,n+1);return n}function Np(t,e,n){const i=[],r=t.length;for(let s=0;s<r;s++)s!==e?i.push(t[s]):i.push(n);return i}function Mp(t,e,n,i){const r=e.shape.length,s=t.shape.length;if(0!==i&&(i<-r||i>r))throw new Error("Expect batchDims in the range of [-".concat(r,", ").concat(r,"], but got ").concat(i));if(i<0&&(i+=r),i>s)throw new Error("batchDims (".concat(i,") must be less than rank(x) (\n    ").concat(s,")."));if(n<i)throw new Error("batchDims (".concat(i,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<i;++h)if(t.shape[h]!==e.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(t.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(e.shape[h],"."));const o=t.shape[n],a=[];let c=1,l=1,u=1;for(let h=0;h<i;++h)a.push(t.shape[h]),c*=t.shape[h];for(let h=i;h<n;h++)a.push(t.shape[h]),l*=t.shape[h];for(let h=i;h<r;h++)a.push(e.shape[h]);for(let h=n+1;h<s;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:o,outputShape:a}}function Dp(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=du(t.shape),i=Xs(t,"float32"),r=n.complex(i,e);return e.dispose(),i.dispose(),r}if(!yt(t.dtype,e))return Lr.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const i=n.real(t),r=Xs(i,e);return i.dispose(),r}if("int32"===e)return n.int(t);if("bool"===e){const e=za(0,t.dtype),i=n.notEqual(t,e);return e.dispose(),i}throw new Error("Error in Cast: failed to cast ".concat(t.dtype," to ").concat(e))}function Pp(t,e){return Lr.makeTensorFromDataId(t.dataId,e,t.dtype)}function Fp(t){try{return t.map((t=>fr(t)))}catch(Mz){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Mz))}}function Lp(t){return t.map((t=>pr(t)))}const Bp={kernelName:qt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,uh(Xs(n,"float32"),-1))}}},zp={kernelName:Ht,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Oa(Xs(n,"float32")),i=Ia(qa(za(1),e));return Pl(ka(t,i))}}}},Up={kernelName:Xt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Ia(qa(Oa(Xs(n,"float32")),1));return ka(t,e)}}}},jp={kernelName:Yt,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{let e=t;const i=Ka(n.shape,r);return i.length>0&&(e=zl(e,i)),kc(e,n.shape)},b:()=>{let e=t;const n=Ka(i.shape,r);return n.length>0&&(e=zl(e,n)),kc(e,i.shape)}}}},Vp={kernelName:Kt,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,i)=>{n[i]=()=>t.clone()})),n}},Wp={kernelName:Jt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(n)}}},Gp={kernelName:$t,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(n)}}},qp={kernelName:te,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Ia(qa(za(1),Oa(Xs(n,"float32")))))}}},Hp={kernelName:ee,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Ia(Ea(za(1),Oa(Xs(n,"float32"))));return ka(t,e)}}}},Xp={kernelName:re,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{const e=Ea(Oa(n),Oa(i));let s=Aa(t,ka(i,e));const o=Ka(n.shape,r);return o.length>0&&(s=zl(s,o)),kc(s,n.shape)},b:()=>{const e=Ea(Oa(n),Oa(i));let s=Pl(Aa(t,ka(n,e)));const o=Ka(i.shape,r);return o.length>0&&(s=zl(s,o)),kc(s,i.shape)}}}},Yp={kernelName:ne,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Ea(Oa(Xs(n,"float32")),1))}}},Kp={kernelName:ie,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,qa(za(1),Oa(Xs(n,"float32"))))}}};const Qp=Yr({avgPool3dGrad_:function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;const a=qr(t,"dy","avgPool3dGrad"),c=qr(e,"input","avgPool3dGrad");let l=a,u=c,h=!1;4===c.rank&&(h=!0,l=kc(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),u=kc(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),J(5===l.rank,(()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,"."))),J(5===u.rank,(()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(u.rank,"."))),J(Ec(i,r),(()=>"Error in avgPool3dGrad: Either strides or dilations "+"must be 1. Got strides ".concat(i," and dilations '").concat(r,"'"))),null!=o&&J(st(s),(()=>"Error in avgPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(s,".")));const d={dy:l,input:u},p={filterSize:n,strides:i,dilations:r,pad:s,dimRoundingMode:o},f=Lr.runKernel(ce,d,p);return h?kc(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Zp={kernelName:ae,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,dilations:o,pad:a,dimRoundingMode:c}=n,l=null==o?[1,1,1]:o;return{x:()=>Qp(t,i,r,s,l,a,c)}}};const Jp=Yr({avgPoolGrad_:function(t,e,n,i,r){const s=qr(t,"dy","avgPoolGrad"),o=qr(e,"input","avgPoolGrad");J(o.rank===s.rank,(()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(s.rank,")")));let a=o,c=s,l=!1;3===o.rank&&(l=!0,a=kc(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=kc(s,[1,s.shape[0],s.shape[1],s.shape[2]])),J(4===c.rank,(()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,"."))),J(4===a.rank,(()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(a.rank,".")));const u={dy:c,input:a},h={filterSize:n,strides:i,pad:r},d=Lr.runKernel(oe,u,h);return l?kc(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),$p={kernelName:se,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,pad:o}=n;return{x:()=>Jp(t,i,r,s,o)}}},tf={kernelName:le,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[i,r]=e,{transposeA:s,transposeB:o}=n;return s||o?!s&&o?{a:()=>fo(t,r,!1,!1),b:()=>fo(t,i,!0,!1)}:s&&!o?{a:()=>fo(r,t,!1,!0),b:()=>fo(i,t,!1,!1)}:{a:()=>fo(r,t,!0,!0),b:()=>fo(t,i,!0,!0)}:{a:()=>fo(t,r,!1,!0),b:()=>fo(i,t,!0,!1)}}},ef={kernelName:ue,gradFunc:(t,e,n)=>{const{blockShape:i,crops:r}=n;return{x:()=>wu(t,i,r)}}},nf={kernelName:de,gradFunc:(t,e,n)=>{const i=n,r=i.inputShape,s=i.shape,o=Array.from(s);for(let c=r.length-1;c>=0;c--)if(r[c]===s[c])o[c]=1;else if(1!==r[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(s,"]."));const a=[];for(let c=0;c<o.length;c++)o[c]>1&&a.push(c);return{x:()=>zl(t,a,!0)}}},rf={kernelName:pe,gradFunc:t=>({x:()=>t.clone()})},sf={kernelName:fe,gradFunc:t=>({x:()=>Ra(t)})},of={kernelName:me,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{clipValueMin:r,clipValueMax:s}=n;return{x:()=>ul(Ql(_l(i,r),Ol(i,s)),t,Ra(t))}}},af={kernelName:ve,inputsToSave:["x"],gradFunc:Bp.gradFunc},cf={kernelName:ye,saveAllInputs:!0,gradFunc:(t,e,n)=>{const i=e.map((t=>t.shape)),{axis:r}=n,s=dt(r,e[0].shape)[0],o=i.map((t=>t[s]));return sh(t,o,s).map((t=>()=>t))}},lf={kernelName:xe,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{dilations:s,strides:o,pad:a,dataFormat:c}=n;return J(Tc(s),(()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'"))),{x:()=>Qc(i.shape,t,r,o,a,c),filter:()=>Jh(i,t,r.shape,o,a,c)}}},uf={kernelName:we,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{strides:s,pad:o,dataFormat:a,dimRoundingMode:c}=n;return{dy:()=>Yc(t,r,s,o,a,1,c),filter:()=>Jh(t,i,r.shape,s,o,a,c)}}};const hf=Yr({conv3DBackpropFilter_:function(t,e,n,i,r){let s=t;4===t.rank&&(s=kc(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=kc(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),J(5===s.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(s.shape,"."))),J(5===o.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,"."))),J(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,"."))),J(s.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(s.shape[4],") must ")+"match input depth in filter (".concat(n[3],"."))),J(o.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")));const a={x:s,dy:o},c={strides:i,pad:r,filterShape:n};return Lr.runKernel(_e,a,c)}}),df={kernelName:Se,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s}=n;J(Tc(i),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(i,"'")));const[o,a]=e;return{x:()=>$c(o.shape,t,a,r,s),filter:()=>hf(o,t,a.shape,r,s)}}},pf={kernelName:Ee,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(Pl(Ku(Xs(n,"float32"))),t)}}},ff={kernelName:Ce,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(Qu(Xs(n,"float32")),t)}}},mf={kernelName:ke,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{axis:r,exclusive:s,reverse:o}=n;return{x:()=>{const e=Hl([r],i.rank);let n=il(t,r,s,!o);return null!=e&&(n=go(n,e)),n}}}},gf={kernelName:Re,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s,dimRoundingMode:o}=n,a=null==i?[1,1]:i;J(Tc(a),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(a,"'")));const[c,l]=e;return J(4===c.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,"."))),J(4===l.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,"."))),J(c.shape[3]===l.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],"."))),J(Ec(r,a),(()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(r," and dilations ")+"'".concat(a,"'."))),null!=o&&J(st(s),(()=>"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(s,"."))),{x:()=>sd(c.shape,t,l,r,s,i,o),filter:()=>rd(c,t,l.shape,r,s,i,o)}}},vf={kernelName:Pe,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,s={x:i,filter:r,dy:t},o={x:i,filter:r,dy:t};return{x:()=>Lr.runKernel(Fe,s,n),filter:()=>Lr.runKernel(Le,o,n)}}},yf={kernelName:ze,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,i={dy:t,y:n};return{x:()=>Lr.runKernel(Ue,i)}}},xf={kernelName:je,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,i=Aa(ml(Pl(Oa(n))),2/Math.sqrt(Math.PI));return{x:()=>Aa(t,i)}}},bf={kernelName:We,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,n)}}},wf={kernelName:Ge,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>kc(t,n.shape)}}},Sf={kernelName:qe,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,ml(n))}}},_f={kernelName:Ke,gradFunc:t=>({x:()=>Ra(t)})},Tf={kernelName:Qe,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{const e=ka(t,Xs(i,"float32")),s=Ka(n.shape,r);return s.length>0?kc(zl(e,s),n.shape):e},b:()=>{let e=Aa(t,Xs(n,"float32"));const s=Ka(i.shape,r);s.length>0&&(e=kc(zl(e,s),i.shape));const o=Oa(i);return Pl(ka(e,Xs(o,"float32")))}}}},Ef={kernelName:Ze,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:i}=n,[r,s,o,a]=e,c=null==a?za(1):a,l=Ka(s.shape,r.shape),u=[];if(1===s.rank){for(let t=0;t<r.shape.length-1;++t)u.push(r.shape[t]);u.push(1)}const h=qa(r,s),d=Aa(t,c),p=Gu(Ea(o,za(i))),f=Aa(Aa(Aa(p,p),p),za(-.5));return{x:()=>1===s.rank?kc(Aa(Aa(t,yl(kc(p,[1,1,1,s.shape[0]]),u)),c),r.shape):kc(Aa(Aa(t,p),c),r.shape),mean:()=>{let t=Aa(Aa(p,za(-1)),d);return 1===s.rank&&(t=zl(t,l)),kc(t,s.shape)},variance:()=>{let t=Aa(Aa(f,h),d);return 1===s.rank&&(t=zl(t,l)),kc(t,s.shape)},scale:()=>{const e=Aa(h,p);let n=Aa(t,e);return 1===s.rank&&(n=zl(n,l)),kc(n,s.shape)},offset:()=>{let e=t;return 1===s.rank&&(e=zl(e,l)),kc(e,s.shape)}}}},Cf={kernelName:Je,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[i,r]=e,{axis:s}=n,o=dt(s,i.shape)[0];return{x:()=>{const e=i.shape,n=r.size,a=e.slice(0,o),c=a.length,l=e.slice(s,e.length).slice(1),u=l.length,h=kf(0,c),d=kf(c+1,c+1+u),p=Af([a,[n],l]),f=kc(t,p),m=kc(r,[n]),g=Af([[c],h,d]),v=go(f,g);let y=wh(v,m,i.shape[o]);const x=Xl(g);return y=go(y,x),y},indices:()=>r}}};function kf(t,e){const n=[];for(let i=t;i<e;++i)n.push(i);return n}function Af(t){const e=[];for(let n=0;n<t.length;++n)for(let i=0;i<t[n].length;++i)e.push(t[n][i]);return e}const If={kernelName:en,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>Ra(n),b:()=>Ra(i)}}},Of={kernelName:nn,gradFunc:t=>({x:()=>Xs(t,"float32")})},Rf={kernelName:on,gradFunc:t=>({x:()=>Ra(t)})},Nf={kernelName:an,gradFunc:t=>({x:()=>Ra(t)})},Mf={kernelName:cn,gradFunc:t=>({x:()=>Ra(t)})},Df={kernelName:ln,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{alpha:r}=n,s=Sl(i,0);return{x:()=>ul(s,t,Aa(t,r))}}},Pf={kernelName:fn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Ea(n,1))}}},Ff={kernelName:pn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Xs(n,"float32"))}}},Lf={kernelName:yn,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i]=e,{axis:r}=n;return{logits:()=>{const e=ml(i);return qa(t,Aa(zl(t,r,!0),e))}}}};const Bf=Yr({localResponseNormalizationBackprop_:function(t,e,n){const i={x:t,y:e,dy:n},r={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return Lr.runKernel(bn,i,r)}}),zf={kernelName:xn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{depthRadius:s,bias:o,alpha:a,beta:c}=n;return{x:()=>Bf(i,r,t,s,o,a,c)}}};function Uf(t,e,n,i){return e.rank<n.rank&&(e=kc(e,Gl(e.shape,i))),t.rank<n.rank&&(t=kc(t,Gl(t.shape,i))),{x:()=>Aa(t,Xs(ll(n,e),t.dtype))}}const jf={kernelName:wn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const i=n,{reductionIndices:r}=i,s=e[0],o=Uf(t,e[1],s,dt(r,s.shape));return{x:()=>o.x()}}},Vf={kernelName:Sn,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>Aa(t,Xs(_l(n,i),"float32")),b:()=>Aa(t,Xs(Il(n,i),"float32"))}}};const Wf=Yr({maxPool3dGrad_:function(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0;const c=qr(t,"dy","maxPool3dGrad"),l=qr(e,"input","maxPool3dGrad"),u=qr(n,"output","maxPool3dGrad");let h=c,d=l,p=u,f=!1;4===l.rank&&(f=!0,h=kc(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=kc(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=kc(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),J(5===h.rank,(()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(h.rank,"."))),J(5===d.rank,(()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,"."))),J(5===p.rank,(()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(p.rank,"."))),J(Ec(r,s),(()=>"Error in maxPool3dGrad: Either strides or dilations "+"must be 1. Got strides ".concat(r," and dilations '").concat(s,"'"))),null!=a&&J(st(o),(()=>"Error in maxPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(a," but got pad ").concat(o,".")));const m={dy:h,input:d,output:p},g={filterSize:i,strides:r,dilations:s,pad:o,dimRoundingMode:a},v=Lr.runKernel(Cn,m,g);return f?kc(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}}),Gf={kernelName:En,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,dilations:a,pad:c,dimRoundingMode:l}=n,u=null==a?[1,1,1]:a;return{x:()=>Wf(t,i,r,s,o,u,c,l)}}};const qf=Yr({maxPoolGrad_:function(t,e,n,i,r,s,o){const a=qr(t,"dy","maxPoolGrad"),c=qr(e,"input","maxPoolGrad"),l=qr(n,"output","maxPoolGrad");J(c.rank===a.rank,(()=>"Rank of input (".concat(c.rank,") does not match rank of dy ")+"(".concat(a.rank,")"))),J(4===a.rank,(()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(a.rank,"."))),J(4===c.rank,(()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,"."))),null!=o&&J(st(s),(()=>"Error in maxPoolGrad: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(s,".")));const u={dy:a,input:c,output:l},h={filterSize:i,strides:r,pad:s,dimRoundingMode:o};return Lr.runKernel(Tn,u,h)}}),Hf={kernelName:_n,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,pad:a}=n;return{x:()=>qf(t,i,r,s,o,a)}}},Xf={kernelName:Rn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const i=e[0],{paddings:r}=n,s=r.map((t=>t[0]));return{x:()=>Nc(t,s,i.shape)}}},Yf={kernelName:Wn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const i=e[0],{paddings:r}=n,s=r.map((t=>t[0]));return{x:()=>Nc(t,s,i.shape)}}},Kf={kernelName:qn,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,i,r]=e,s=n,o=i,a=Qa(s.shape,o.shape);return{a:()=>{const e=Xs(o,"float32");let n=Aa(t,Aa(e,Ga(s,qa(e,za(1)))));const i=Ka(s.shape,a);return i.length>0&&(n=zl(n,i)),kc(n,s.shape)},b:()=>{const e=Sl(s,0),n=ul(e,Ml(s),Ra(s));let i=Aa(t,Aa(r,n));const c=Ka(o.shape,a);return c.length>0&&(i=zl(i,c)),kc(i,o.shape)}}}},Qf={kernelName:li,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Sl(n,za(0)),i=za(dp),r=za(pp),s=Aa(t,r),o=Aa(Aa(t,i),ml(Xs(n,"float32")));return ul(e,s,o)}}}},Zf={kernelName:yi,gradFunc:(t,e,n)=>{const{blockShape:i,paddings:r}=n;return{x:()=>Pc(t,i,r)}}},Jf={kernelName:xi,gradFunc:(t,e,n)=>{const{axis:i}=n;return{x:()=>Oc(t,i)}}};const $f=[Bp,zp,Up,jp,Vp,Wp,Gp,qp,Hp,Xp,Yp,Kp,Zp,$p,tf,ef,nf,rf,sf,of,af,cf,uf,lf,df,pf,ff,mf,gf,vf,{kernelName:Be,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{const e=ka(t,Xs(i,"float32")),s=Ka(n.shape,r);return s.length>0?kc(zl(e,s),n.shape):e},b:()=>{let e=Aa(t,Xs(n,"float32"));const s=Ka(i.shape,r);s.length>0&&(e=kc(zl(e,s),i.shape));const o=Oa(i);return Pl(ka(e,Xs(o,"float32")))}}}},yf,xf,bf,wf,Sf,Tf,_f,Ef,Cf,If,Of,Rf,Nf,Mf,Df,Pf,Ff,Lf,zf,jf,jf,Vf,Gf,Hf,{kernelName:An,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{axis:r}=n,s=dt(r,i.shape),o=nt(Wl(i.shape,s)[1]);return{x:()=>{const e=i.shape.slice();s.forEach((t=>{e[t]=1}));const n=kc(t,e);return ka(Aa(n,pu(i.shape,"float32")),o)}}}},{kernelName:In,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const i=n,{axis:r}=i,[s,o]=e,a=Uf(t,o,s,dt(r,s.shape));return{x:()=>a.x()}}},{kernelName:On,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>Aa(t,Xs(Ol(n,i),"float32")),b:()=>Aa(t,Xs(Sl(n,i),"float32"))}}},Xf,{kernelName:Nn,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{const e=Ka(n.shape,r);return e.length>0?kc(zl(t,e),n.shape):t},b:()=>{const e=Aa(t,Pl(bl(ka(n,i)))),s=Ka(i.shape,r);return s.length>0?kc(zl(e,s),i.shape):e}}}},{kernelName:Dn,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{const e=Aa(t,Xs(i,"float32")),s=Ka(n.shape,r);return s.length>0?kc(zl(e,s),n.shape):e},b:()=>{const e=Aa(t,Xs(n,"float32")),s=Ka(i.shape,r);return s.length>0?kc(zl(e,s),i.shape):e}}}},{kernelName:Pn,gradFunc:t=>({x:()=>Pl(t)})},{kernelName:jn,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>du(n.shape,"float32")}}},{kernelName:Un,gradFunc:t=>({x:()=>Ra(t)})},{kernelName:Vn,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:i}=n;return Sh(t,i).map((t=>()=>t))}},Yf,Yf,Kf,{kernelName:Hn,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,i]=e,r=Sl(n,0);return{x:()=>ul(r,t,Aa(t,i)),alpha:()=>{let e=ul(r,Ra(t),Aa(t,n));const s=Ka(i.shape,t.shape);return s.length>0&&(e=zl(e,s)),kc(e,i.shape)}}}},{kernelName:Qn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Pl(Oa(n)))}}},{kernelName:ii,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,i=Aa(Ol(n,6),uh(n));return{x:()=>Aa(t,Xs(i,"float32"))}}},{kernelName:Zn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,Xs(uh(n),"float32"))}}},{kernelName:Jn,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>kc(t,n.shape)}}},{kernelName:ei,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[i]=e,r={dy:t,images:i};return{images:()=>Lr.runKernel(ni,r,n)}}},{kernelName:$n,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[i]=e,r={dy:t,images:i};return{images:()=>Lr.runKernel(ti,r,n)}}},{kernelName:ri,gradFunc:(t,e,n)=>{const{dims:i}=n,r=dt(i,t.shape);return{x:()=>Bu(t,r)}}},{kernelName:si,gradFunc:t=>({x:()=>Ra(t)})},{kernelName:oi,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Pl(ka(t,Aa(Ga(n,1.5),2)))}}},{kernelName:ci,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Xs(Ra(n),"float32"),t:()=>Aa(t,Xs(n,t.dtype)),e:()=>Aa(t,Xs(Zl(n),t.dtype))}}},Qf,{kernelName:fi,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,Aa(n,qa(za(1),n)))}}},{kernelName:pi,gradFunc:t=>({x:()=>Ra(t)})},{kernelName:hi,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(el(Xs(n,"float32")),t)}}},{kernelName:di,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(nl(Xs(n,"float32")),t)}}},{kernelName:ui,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{begin:r,size:s}=n,o=i.shape,[a,c]=Uo(i,r,s),l=[];for(let u=0;u<t.rank;u++)l.push([a[u],o[u]-a[u]-c[u]]);return{x:()=>gu(t,l)}}},{kernelName:bi,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i]=e,{dim:r}=n,s=Aa(t,i);return{logits:()=>qa(s,Aa(zl(s,[r],true),i))}}},{kernelName:mi,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,Rc(n))}}},Zf,Zf,Jf,Jf,{kernelName:gi,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Aa(Ia(Xs(n,"float32")),2))}}},{kernelName:wi,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=za(2);return{a:()=>Aa(t,Aa(r,qa(n,i))),b:()=>Aa(t,Aa(r,qa(i,n)))}}},{kernelName:Si,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(t,Aa(Xs(n,"float32"),2))}}},{kernelName:Pi,gradFunc:t=>({x:()=>Ra(t)})},{kernelName:_i,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Qa(n.shape,i.shape);return{a:()=>{let e=t;const i=Ka(n.shape,r);return i.length>0&&(e=zl(e,i)),kc(e,n.shape)},b:()=>{let e=t;const n=Ka(i.shape,r);return n.length>0&&(e=zl(e,n)),kc(Pl(e),i.shape)}}}},{kernelName:vi,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,r=i.shape.slice(),{axis:s}=n;dt(s,i.shape).forEach((t=>{r[t]=1}));const o=kc(t,r),a=Aa(o,pu(i.shape,"float32"));return{x:()=>a}}},{kernelName:Ci,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ka(t,Oa(el(n)))}}},{kernelName:ki,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Aa(qa(za(1),Oa(n)),t)}}},{kernelName:Ai,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{reps:r}=n;return{x:()=>{let e=Ra(i);if(1===i.rank)for(let n=0;n<r[0];++n)e=Ea(e,Nc(t,[n*i.shape[0]],[i.shape[0]]));else if(2===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)e=Ea(e,Nc(t,[n*i.shape[0],s*i.shape[1]],[i.shape[0],i.shape[1]]));else if(3===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)e=Ea(e,Nc(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(4!==i.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(i.rank," tensors yet."));for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)for(let a=0;a<r[3];++a)e=Ea(e,Nc(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2],a*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return e}}}},{kernelName:Oi,gradFunc:(t,e,n)=>{const i=n,{perm:r}=i,s=Xl(r);return{x:()=>go(t,s)}}},{kernelName:Ni,gradFunc:(t,e,n)=>{const i=n,{axis:r}=i;return{value:()=>lh(t,r)}}},{kernelName:Mi,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=Za(e,Ra(e)),i=wl(t,n);let r=_l(e,za(0,"int32"));const s=i.rank-r.rank;for(let a=0;a<s;++a)r=gl(r,a+1);r=Ql(r,pu(i.shape,"bool"));const o=Ra(i);return ul(r,i,o)}(t,n)}}},{kernelName:Di,gradFunc:t=>({x:()=>Ra(t)})}];for(const Dz of $f)Xi(Dz);let tm;function em(){return null==tm&&(tm=_a().epsilon()),tm}xr.prototype.abs=function(){return this.throwIfDisposed(),Xa(this)},xr.prototype.acos=function(){return this.throwIfDisposed(),nc(this)},xr.prototype.acosh=function(){return this.throwIfDisposed(),ic(this)},xr.prototype.addStrict=function(t){return this.throwIfDisposed(),Mh(this,t)},xr.prototype.add=function(t){return this.throwIfDisposed(),Ea(this,t)},xr.prototype.all=function(t,e){return this.throwIfDisposed(),sc(this,t,e)},xr.prototype.any=function(t,e){return this.throwIfDisposed(),oc(this,t,e)},xr.prototype.argMax=function(t){return this.throwIfDisposed(),ac(this,t)},xr.prototype.argMin=function(t){return this.throwIfDisposed(),cc(this,t)},xr.prototype.asScalar=function(){return this.throwIfDisposed(),J(1===this.size,(()=>"The array must have only 1 element.")),kc(this,[])},xr.prototype.asType=function(t){return this.throwIfDisposed(),Xs(this,t)},xr.prototype.as1D=function(){return this.throwIfDisposed(),kc(this,[this.size])},xr.prototype.as2D=function(t,e){return this.throwIfDisposed(),kc(this,[t,e])},xr.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),kc(this,[t,e,n])},xr.prototype.as4D=function(t,e,n,i){return this.throwIfDisposed(),kc(this,[t,e,n,i])},xr.prototype.as5D=function(t,e,n,i,r){return this.throwIfDisposed(),kc(this,[t,e,n,i,r])},xr.prototype.asin=function(){return this.throwIfDisposed(),lc(this)},xr.prototype.asinh=function(){return this.throwIfDisposed(),uc(this)},xr.prototype.atan=function(){return this.throwIfDisposed(),hc(this)},xr.prototype.atan2=function(t){return this.throwIfDisposed(),dc(this,t)},xr.prototype.atanh=function(){return this.throwIfDisposed(),pc(this)},xr.prototype.avgPool=function(t,e,n,i){return this.throwIfDisposed(),Ac(this,t,e,n,i)},xr.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Pc(this,t,e)},xr.prototype.batchNorm=function(t,e,n,i,r){return this.throwIfDisposed(),Fc(this,t,e,n,i,r)},xr.prototype.broadcastTo=function(t){return this.throwIfDisposed(),jc(this,t)},xr.prototype.cast=function(t){return this.throwIfDisposed(),Xs(this,t)},xr.prototype.ceil=function(){return this.throwIfDisposed(),Vc(this)},xr.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Wc(this,t,e)},xr.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof xr&&(t=[t]),Oc([this,...t],e)},xr.prototype.conv1d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Kc(this,t,e,n,i,r,s)},xr.prototype.conv2dTranspose=function(t,e,n,i,r){return this.throwIfDisposed(),Zc(this,t,e,n,i,r)},xr.prototype.conv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Yc(this,t,e,n,i,r,s)},xr.prototype.cos=function(){return this.throwIfDisposed(),el(this)},xr.prototype.cosh=function(){return this.throwIfDisposed(),nl(this)},xr.prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),il(this,t,e,n)},xr.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),sl(this,t,e)},xr.prototype.depthwiseConv2D=function(t,e,n,i,r,s){return aa("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),ol(this,t,e,n,i,r,s)},xr.prototype.depthwiseConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),ol(this,t,e,n,i,r,s)},xr.prototype.dilation2d=function(t,e,n,i,r){return this.throwIfDisposed(),cl(this,t,e,n,i,r)},xr.prototype.divNoNan=function(t){return this.throwIfDisposed(),hl(this,t)},xr.prototype.divStrict=function(t){return this.throwIfDisposed(),Dh(this,t)},xr.prototype.div=function(t){return this.throwIfDisposed(),ka(this,t)},xr.prototype.dot=function(t){return this.throwIfDisposed(),dl(this,t)},xr.prototype.elu=function(){return this.throwIfDisposed(),pl(this)},xr.prototype.equalStrict=function(t){return this.throwIfDisposed(),kh(this,t)},xr.prototype.equal=function(t){return this.throwIfDisposed(),ll(this,t)},xr.prototype.erf=function(){return this.throwIfDisposed(),fl(this)},xr.prototype.exp=function(){return this.throwIfDisposed(),ml(this)},xr.prototype.expandDims=function(t){return this.throwIfDisposed(),gl(this,t)},xr.prototype.expm1=function(){return this.throwIfDisposed(),vl(this)},xr.prototype.fft=function(){return this.throwIfDisposed(),nh(this)},xr.prototype.flatten=function(){return this.throwIfDisposed(),kc(this,[this.size])},xr.prototype.floor=function(){return this.throwIfDisposed(),bl(this)},xr.prototype.floorDiv=function(t){return this.throwIfDisposed(),Ca(this,t)},xr.prototype.gather=function(t,e){return this.throwIfDisposed(),wl(this,t,e)},xr.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Ah(this,t)},xr.prototype.greaterEqual=function(t){return this.throwIfDisposed(),_l(this,t)},xr.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Ih(this,t)},xr.prototype.greater=function(t){return this.throwIfDisposed(),Sl(this,t)},xr.prototype.ifft=function(){return this.throwIfDisposed(),ih(this)},xr.prototype.irfft=function(){return this.throwIfDisposed(),rh(this)},xr.prototype.isFinite=function(){return this.throwIfDisposed(),El(this)},xr.prototype.isInf=function(){return this.throwIfDisposed(),Cl(this)},xr.prototype.isNaN=function(){return this.throwIfDisposed(),kl(this)},xr.prototype.leakyRelu=function(t){return this.throwIfDisposed(),Al(this,t)},xr.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Oh(this,t)},xr.prototype.lessEqual=function(t){return this.throwIfDisposed(),Ol(this,t)},xr.prototype.lessStrict=function(t){return this.throwIfDisposed(),Rh(this,t)},xr.prototype.less=function(t){return this.throwIfDisposed(),Il(this,t)},xr.prototype.localResponseNormalization=function(t,e,n,i){return this.throwIfDisposed(),Nl(this,t,e,n,i)},xr.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ll(this)},xr.prototype.logSoftmax=function(t){return this.throwIfDisposed(),Ul(this,t)},xr.prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Kl(this,t,e)},xr.prototype.log=function(){return this.throwIfDisposed(),Ml(this)},xr.prototype.log1p=function(){return this.throwIfDisposed(),Dl(this)},xr.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ql(this,t)},xr.prototype.logicalNot=function(){return this.throwIfDisposed(),Zl(this)},xr.prototype.logicalOr=function(t){return this.throwIfDisposed(),Jl(this,t)},xr.prototype.logicalXor=function(t){return this.throwIfDisposed(),$l(this,t)},xr.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),fo(this,t,e,n)},xr.prototype.maxPool=function(t,e,n,i){return this.throwIfDisposed(),tu(this,t,e,n,i)},xr.prototype.max=function(t,e){return this.throwIfDisposed(),Bl(this,t,e)},xr.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Ph(this,t)},xr.prototype.maximum=function(t){return this.throwIfDisposed(),Za(this,t)},xr.prototype.mean=function(t,e){return this.throwIfDisposed(),iu(this,t,e)},xr.prototype.min=function(t,e){return this.throwIfDisposed(),ru(this,t,e)},xr.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Fh(this,t)},xr.prototype.minimum=function(t){return this.throwIfDisposed(),su(this,t)},xr.prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),ou(this,t,e)},xr.prototype.modStrict=function(t){return this.throwIfDisposed(),Lh(this,t)},xr.prototype.mod=function(t){return this.throwIfDisposed(),au(this,t)},xr.prototype.mulStrict=function(t){return this.throwIfDisposed(),Bh(this,t)},xr.prototype.mul=function(t){return this.throwIfDisposed(),Aa(this,t)},xr.prototype.neg=function(){return this.throwIfDisposed(),Pl(this)},xr.prototype.norm=function(t,e,n){return this.throwIfDisposed(),Wh(this,t,e,n)},xr.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Nh(this,t)},xr.prototype.notEqual=function(t){return this.throwIfDisposed(),hu(this,t)},xr.prototype.oneHot=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),mo(this,t,e,n)},xr.prototype.onesLike=function(){return this.throwIfDisposed(),fu(this)},xr.prototype.pad=function(t,e){return this.throwIfDisposed(),gu(this,t,e)},xr.prototype.pool=function(t,e,n,i,r){return this.throwIfDisposed(),Su(this,t,e,n,i,r)},xr.prototype.powStrict=function(t){return this.throwIfDisposed(),zh(this,t)},xr.prototype.pow=function(t){return this.throwIfDisposed(),Ga(this,t)},xr.prototype.prelu=function(t){return this.throwIfDisposed(),_u(this,t)},xr.prototype.prod=function(t,e){return this.throwIfDisposed(),Tu(this,t,e)},xr.prototype.reciprocal=function(){return this.throwIfDisposed(),Pu(this)},xr.prototype.relu=function(){return this.throwIfDisposed(),Fu(this)},xr.prototype.relu6=function(){return this.throwIfDisposed(),Lu(this)},xr.prototype.reshapeAs=function(t){return this.throwIfDisposed(),kc(this,t.shape)},xr.prototype.reshape=function(t){return this.throwIfDisposed(),kc(this,t)},xr.prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Rd(this,t,e,n)},xr.prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Nd(this,t,e,n)},xr.prototype.reverse=function(t){return this.throwIfDisposed(),Bu(this,t)},xr.prototype.rfft=function(){return this.throwIfDisposed(),oh(this)},xr.prototype.round=function(){return this.throwIfDisposed(),Wu(this)},xr.prototype.rsqrt=function(){return this.throwIfDisposed(),Gu(this)},xr.prototype.selu=function(){return this.throwIfDisposed(),qu(this)},xr.prototype.separableConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Hu(this,t,e,n,i,r,s)},xr.prototype.sigmoid=function(){return this.throwIfDisposed(),Rc(this)},xr.prototype.sign=function(){return this.throwIfDisposed(),Yu(this)},xr.prototype.sin=function(){return this.throwIfDisposed(),Ku(this)},xr.prototype.sinh=function(){return this.throwIfDisposed(),Qu(this)},xr.prototype.slice=function(t,e){return this.throwIfDisposed(),Nc(this,t,e)},xr.prototype.softmax=function(t){return this.throwIfDisposed(),eh(this,t)},xr.prototype.softplus=function(){return this.throwIfDisposed(),Fl(this)},xr.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),wu(this,t,e)},xr.prototype.split=function(t,e){return this.throwIfDisposed(),sh(this,t,e)},xr.prototype.sqrt=function(){return this.throwIfDisposed(),Ia(this)},xr.prototype.square=function(){return this.throwIfDisposed(),Oa(this)},xr.prototype.squaredDifference=function(t){return this.throwIfDisposed(),ah(this,t)},xr.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Uh(this,t)},xr.prototype.squeeze=function(t){return this.throwIfDisposed(),ch(this,t)},xr.prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof xr?[this,t]:[this,...t];return lh(n,e)},xr.prototype.step=function(t){return this.throwIfDisposed(),uh(this,t)},xr.prototype.stridedSlice=function(t,e,n,i,r,s,o,a){return this.throwIfDisposed(),hh(this,t,e,n,i,r,s,o,a)},xr.prototype.subStrict=function(t){return this.throwIfDisposed(),jh(this,t)},xr.prototype.sub=function(t){return this.throwIfDisposed(),qa(this,t)},xr.prototype.sum=function(t,e){return this.throwIfDisposed(),zl(this,t,e)},xr.prototype.tan=function(){return this.throwIfDisposed(),dh(this)},xr.prototype.tanh=function(){return this.throwIfDisposed(),Mc(this)},xr.prototype.tile=function(t){return this.throwIfDisposed(),yl(this,t)},xr.prototype.toBool=function(){return this.throwIfDisposed(),Xs(this,"bool")},xr.prototype.toFloat=function(){return this.throwIfDisposed(),Xs(this,"float32")},xr.prototype.toInt=function(){return this.throwIfDisposed(),Xs(this,"int32")},xr.prototype.topk=function(t,e){return this.throwIfDisposed(),yh(this,t,e)},xr.prototype.transpose=function(t){return this.throwIfDisposed(),go(this,t)},xr.prototype.unique=function(t){return this.throwIfDisposed(),bh(this,t)},xr.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),wh(this,t,e)},xr.prototype.unstack=function(t){return this.throwIfDisposed(),Sh(this,t)},xr.prototype.where=function(t,e){return this.throwIfDisposed(),ul(t,this,e)},xr.prototype.zerosLike=function(){return this.throwIfDisposed(),Ra(this)};class nm extends Error{constructor(t){super(t),Object.setPrototypeOf(this,nm.prototype)}}class im extends Error{constructor(t){super(t),Object.setPrototypeOf(this,im.prototype)}}class rm extends Error{constructor(t){super(t),Object.setPrototypeOf(this,rm.prototype)}}class sm extends Error{constructor(t){super(t),Object.setPrototypeOf(this,sm.prototype)}}class om extends Error{constructor(t){super(t),Object.setPrototypeOf(this,om.prototype)}}function am(t,e){if(Array.isArray(t)){let n=[];for(let i=0;i<e;i++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function cm(t,e){if(!t)throw new om(e)}function lm(t,e){let n=0;for(const i of t)i===e&&n++;return n}function um(t){return 1===t.length?t[0]:t}function hm(t){return Array.isArray(t)?t:[t]}function dm(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function pm(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,((t,e)=>e.toUpperCase()))}let fm={};function mm(t){if(null===t||void 0===t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function gm(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach((t=>gm(t)));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!==typeof e.value?gm(e):t[n]=e.value)}}}function vm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof t){const r=t;let s;if(r in n)s=n[r];else if(r in fm)s=fm[r];else if(s=e[r],null==s)throw new rm("Unknown ".concat(i,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(i," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(i," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return s}{const s=t;if(null==s.className||null==s.config)throw new rm("".concat(i,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");const o=s.className;let a,c;if(o in n?[a,c]=n[o]:o in fm?[a,c]=fm.className:o in e&&([a,c]=e[o]),null==a)throw new rm("Unknown ".concat(i,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(i," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(i," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){const t={};for(const n of Object.keys(fm))t[n]=fm[n];for(const r of Object.keys(n))t[r]=n[r];s.config.customObjects=t;const e=Object.assign({},fm);for(const r of Object.keys(n))fm[r]=n[r];gm(s.config);const i=c(a,s.config,n,r);return fm=Object.assign({},e),i}{const t=Object.assign({},fm);for(const i of Object.keys(n))fm[i]=n[i];const e=new a(s.config);return fm=Object.assign({},t),e}}}function ym(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function xm(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function bm(t){if(null==t)throw new rm("Invalid value in obj: ".concat(JSON.stringify(t)));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function wm(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new rm("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function Sm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return cm(n>=0),cm(i>=n),Array.isArray(t)&&t.length>=n&&t.length<=i&&t.every((t=>typeof t===e))}function _m(t,e){Array.isArray(t)?(J(t.length>0,(()=>"".concat(e," is unexpectedly an empty array."))),t.forEach(((t,n)=>_m(t,"element ".concat(n+1," of ").concat(e))))):J(Number.isInteger(t)&&t>0,(()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(Tm(t),".")))}function Tm(t){return null===t?"null":Array.isArray(t)?"["+t.map((t=>Tm(t))).join(",")+"]":"string"===typeof t?'"'.concat(t,'"'):"".concat(t)}function Em(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function Cm(t,e){return da((()=>Ia(zl(Aa(t,t),e,!0))))}class km extends Vo{getConfig(){return{}}}class Am extends km{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return da((()=>{const e=Cm(t,this.axis),n=Wc(e,0,this.maxValue);return Aa(t,ka(n,Ea(em(),e)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Am.className="MaxNorm",Go(Am);class Im extends km{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return da((()=>ka(t,Ea(em(),Cm(t,this.axis)))))}getConfig(){return{axis:this.axis}}}Im.className="UnitNorm",Go(Im);class Om extends km{apply(t){return Fu(t)}}Om.className="NonNeg",Go(Om);class Rm extends km{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return da((()=>{const e=Cm(t,this.axis),n=Ea(Aa(this.rate,Wc(e,this.minValue,this.maxValue)),Aa(1-this.rate,e));return Aa(t,ka(n,Ea(em(),e)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Rm.className="MinMaxNorm",Go(Rm);const Nm={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Mm(t){return mm(t)}function Dm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vm(t,Wo.getMap().classNameMap,e,"constraint")}function Pm(t){if(null==t)return null;if("string"===typeof t){return Dm({className:t in Nm?Nm[t]:t,config:{}})}return t instanceof km?t:Dm(t)}function Fm(t){return new Am(t)}function Lm(t){return new Im(t)}function Bm(){return new Om}function zm(t){return new Rm(t)}const Um=["channelsFirst","channelsLast"],jm=["nearest","bilinear"],Vm=["valid","same","causal"],Wm=["max","avg"],Gm=["sum","mul","concat","ave"],qm=new Map;function Hm(t){wm(Um,"DataFormat",t)}function Xm(t){wm(Vm,"PaddingMode",t)}function Ym(t){wm(Wm,"PoolMode",t)}const Km=[],Qm="/";function Zm(t,e){Km.push(t);try{const t=e();return Km.pop(),t}catch(n){throw Km.pop(),n}}function Jm(t){if(!eg(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===Km.length?"":Km.join(Qm)+Qm)+t}function $m(t){if(!eg(t))throw new Error("Not a valid tensor name: '"+t+"'");qm.has(t)||qm.set(t,0);const e=qm.get(t);if(qm.set(t,qm.get(t)+1),e>0){const n="".concat(t,"_").concat(e);return qm.set(n,1),n}return t}const tg=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function eg(t){return!!t.match(tg)}function ng(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let i=1;for(let r=e;r<n;++r)i*=t[r];return i}function ig(t){return ph(t=Array.isArray(t)?new Float32Array(t):t)}function rg(t){return ru(ig(t)).dataSync()[0]}function sg(t){return Bl(ig(t)).dataSync()[0]}function og(t,e){if(e<t)throw new rm("end (".concat(e,") < begin (").concat(t,") is forbidden."));const n=[];for(let i=t;i<e;++i)n.push(i);return n}function ag(t,e){return t.asType(e)}function cg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function lg(t,e,n){return da((()=>{switch(t.rank){case 1:return Zu(t,e,n);case 2:return Ju(t,[e,0],[n,t.shape[1]]);case 3:return $u(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return th(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Nc(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Nc(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new rm("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function ug(t,e,n){return da((()=>{switch(t.rank){case 1:return Zu(t,e,n);case 2:return Ju(t,[0,e],[t.shape[0],n]);case 3:return $u(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return th(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new rm("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function hg(t,e,n,i){return da((()=>{switch(t.rank){case 1:return Zu(t,e,n);case 2:switch(i){case 1:return lg(t,e,n);case 2:return ug(t,e,n);default:throw new rm("The axis is not within the rank of the tensor "+"".concat(i))}case 3:switch(i){case 1:return lg(t,e,n);case 2:return $u(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return ug(t,e,n);default:throw new rm("The axis is not within the rank of the tensor "+"".concat(i))}case 4:switch(i){case 1:return lg(t,e,n);case 2:return th(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return th(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return ug(t,e,n);default:throw new rm("The axis is not within the rank of the tensor "+"".concat(i))}default:throw new rm("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function dg(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(e=t[0].rank,n=0!==e?e:0),n===t[0].rank&&(n=-1),Oc(t,n)}function pg(t,e){switch(t.rank){case 1:return Gc([t,e]);case 2:return qc([t,e],0);case 3:return Hc([t,e],0);case 4:return Xc([t,e],0);default:throw new rm("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function fg(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new rm("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return yl(t,e)}function mg(t){return Ru(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function gg(t,e,n,i){if(t.rank<2||e.rank<2)throw new sm("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new sm("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape))}if(2===t.rank&&2===e.rank){return ad({a:t,b:e,transposeA:!1,transposeB:!1,bias:i?xg(t.rank,i,"channelsLast"):null,activation:n})}{const r=t.shape.slice(),s=r.pop();t=t.reshape([-1,s]);const o=e.shape.slice(),a=o.pop(),c=o.pop(),l=[...o,a],u=Array.from({length:e.rank},((t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n));e=e.transpose(u).reshape([c,-1]);const h=[...r,...l];return ad({a:t,b:e,transposeA:!1,transposeB:!1,bias:i?xg(t.rank,i,"channelsLast"):null,activation:n}).reshape(h)}}function vg(t,e,n){return da((()=>(e=Array.isArray(e)?ph(e,"int32"):e.toInt(),wl(t,e,n))))}function yg(t){return Aa(t,t)}function xg(t,e,n){const i=e.shape;if(1!==e.rank&&e.rank!==t)throw new rm("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return 1===i.length?e.reshape([1,i[0],1,1,1]):e.reshape([1,i[3],i[0],i[1],i[2]]);if("channelsLast"===n)return 1===i.length?e.reshape([1,1,1,1,i[0]]):e.reshape([1].concat(i))}else if(4===t){if("channelsFirst"===n)return 1===i.length?e.reshape([1,i[0],1,1]):e.reshape([1,i[2],i[0],i[1]]);if("channelsLast"===n)return 1===i.length?e.reshape([1,1,1,i[0]]):e.reshape([1].concat(i))}else if(3===t){if("channelsFirst"===n)return 1===i.length?e.reshape([1,i[0],1]):e.reshape([1,i[1],i[0]]);if("channelsLast"===n)return 1===i.length?e.reshape([1,1,i[0]]):e.reshape([1].concat(i))}else if(t<3)return e;throw new rm("Unsupported input rank by biasAdd: ".concat(e.rank))}function bg(t,e,n){return da((()=>(null==n&&(n="channelsLast"),Hm(n),t.add(xg(t.rank,e,n)))))}function wg(t,e,n,i){return da((()=>Yh(t,e,n,i)))}function Sg(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t():e()}const _g=["fanIn","fanOut","fanAvg"],Tg=["normal","uniform","truncatedNormal"];class Eg extends Vo{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Cg extends Eg{apply(t,e){return du(t,e)}}Cg.className="Zeros",Go(Cg);class kg extends Eg{apply(t,e){return pu(t,e)}}kg.className="Ones",Go(kg);class Ag extends Eg{constructor(t){if(super(),"object"!==typeof t)throw new rm("Expected argument of type ConstantConfig but got ".concat(t));if(void 0===t.value)throw new rm("config must have value set but got ".concat(t));this.value=t.value}apply(t,e){return da((()=>Aa(za(this.value),pu(t,e))))}getConfig(){return{value:this.value}}}Ag.className="Constant",Go(Ag);class Ig extends Eg{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Nu(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Ig.className="RandomUniform",Go(Ig);class Og extends Eg{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new sm("randomNormal does not support dType ".concat(e,"."));return mg(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Og.className="RandomNormal",Go(Og);class Rg extends Eg{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new sm("truncatedNormal does not support dType ".concat(e,"."));return xh(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Rg.className="TruncatedNormal",Go(Rg);class Ng extends Eg{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return da((()=>{if(2!==t.length||t[0]!==t[1])throw new rm("Identity matrix initializer can only be used for 2D square matrices.");return Aa(this.gain,xl(t[0]))}))}getConfig(){return{gain:this.gain}}}Ng.className="Identity",Go(Ng);class Mg extends Eg{constructor(t){if(super(),t.scale<0)throw new rm("scale must be a positive float. Got: ".concat(t.scale));var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,wm(_g,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){wm(Tg,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t){let e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Hm(i),2===t.length)e=t[0],n=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===i){const i=ng(t,2);e=t[1]*i,n=t[0]*i}else if("channelsLast"===i){const i=ng(t,0,t.length-2);e=t[t.length-2]*i,n=t[t.length-1]*i}}else{const i=ng(t);e=Math.sqrt(i),n=Math.sqrt(i)}return[e,n]}(t),i=n[0],r=n[1];let s=this.scale;if("fanIn"===this.mode?s/=Math.max(1,i):"fanOut"===this.mode?s/=Math.max(1,r):s/=Math.max(1,(i+r)/2),"normal"===this.distribution){const n=Math.sqrt(s);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new sm("".concat(this.getClassName()," does not support dType ").concat(e,"."));return xh(t,0,n,e,this.seed)}{const n=Math.sqrt(3*s);return Nu(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Mg.className="VarianceScaling",Go(Mg);class Dg extends Mg{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}Dg.className="GlorotUniform",Go(Dg);class Pg extends Mg{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}Pg.className="GlorotNormal",Go(Pg);class Fg extends Mg{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}Fg.className="HeNormal",Go(Fg);class Lg extends Mg{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}Lg.className="HeUniform",Go(Lg);class Bg extends Mg{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}Bg.className="LeCunNormal",Go(Bg);class zg extends Mg{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Mg.className}}zg.className="LeCunNormal",Go(zg);class Ug extends Eg{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new sm("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return da((()=>{if(t.length<2)throw new sm("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(t[0]*t[1],") elements: ")+"Slowness may result.");const e=mg(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=Qd.gramSchmidt(e);return t[0]>t[1]&&(n=n.transpose()),Aa(this.gain,n)}))}getConfig(){return{gain:this.gain,seed:this.seed}}}Ug.className="Orthogonal",Go(Ug);const jg={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Vg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vm(t,Wo.getMap().classNameMap,e,"initializer")}function Wg(t){return mm(t)}function Gg(t){if("string"===typeof t){const e=t in jg?jg[t]:t;if("GlorotNormal"===e)return new Pg;if("GlorotUniform"===e)return new Dg;if("HeNormal"===e)return new Fg;if("HeUniform"===e)return new Lg;if("LeCunNormal"===e)return new Bg;if("LeCunUniform"===e)return new zg;{const t={};return t.className=e,t.config={},Vg(t)}}return t instanceof Eg?t:Vg(t)}function qg(){return new Cg}function Hg(){return new kg}function Xg(t){return new Ag(t)}function Yg(t){return new Ig(t)}function Kg(t){return new Og(t)}function Qg(t){return new Rg(t)}function Zg(t){return new Ng(t)}function Jg(t){return new Mg(t)}function $g(t){return new Dg(t)}function tv(t){return new Pg(t)}function ev(t){return new Fg(t)}function nv(t){return new Lg(t)}function iv(t){return new Bg(t)}function rv(t){return new zg(t)}function sv(t){return new Ug(t)}let ov=0;function av(){return ov++}const cv={};function lv(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t in cv||(cv[t]=0),cv[t]+=1,t+cv[t].toString()}function uv(t){return Array.isArray(t)&&Array.isArray(t[0])}function hv(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function dv(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new rm("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function pv(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new rm("Expected exactly 1 Shape; got ".concat(t.length))}return t}function fv(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce(((t,e)=>t*e));return e}const mv="Variable";class gv{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mv,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=av(),n=null==n?mv:n,this.originalName=Jm(n),this.name=$m(this.originalName),this.trainable_=i,this.constraint=r,this.val=_h(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function vv(t){return t.map((t=>t.read()))}function yv(t){t.forEach((t=>{t[0].write(t[1])}))}class xv{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class bv{constructor(t,e,n,i,r,s,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=i,this.callArgs=r,this.outputTensorIndex=o,this.id=av(),null!=s&&(this.originalName=Jm(s),this.name=$m(this.originalName)),this.rank=e.length}}let wv=0;class Sv{constructor(t,e){this.callArgs=e,this.id=wv++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let _v=0;class Tv extends Vo{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=_v++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=dm(t)+"_"+lv(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new im("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new rm("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]}getInputAt(t){return um(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return um(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new nm("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new nm("Layer ".concat(this.name)+" is not connected, no input to return.");return um(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new nm("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new nm("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return um(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((t=>t()))}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach((e=>e.trainable=t)),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((t=>t.trainable)):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((t=>!t.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=hm(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=hm(this.inputSpec);if(t.length!==e.length)throw new rm("Layer ".concat(this.name," expects ").concat(e.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(t));for(let n=0;n<t.length;n++){const i=t[n],r=e[n];if(null==r)continue;const s=i.rank;if(null!=r.ndim&&s!==r.ndim)throw new rm("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(r.ndim,", found ndim=").concat(s));if(null!=r.maxNDim&&s>r.maxNDim)throw new rm("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(r.maxNDim,", found ndim=").concat(s));if(null!=r.minNDim&&s<r.minNDim)throw new rm("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(r.minNDim,", found ndim=").concat(s,"."));if(null!=r.dtype&&i.dtype!==r.dtype)throw new rm("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(r.dtype,", found dtype=").concat(i.dtype,"."));if(r.axes){const t=i.shape;for(const e in r.axes){const i=Number(e),s=r.axes[e],o=i>=0?t[i]:t[t.length+i];if(null!=s&&-1===[s,null].indexOf(o))throw new rm("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(i," of input shape to ")+"have value ".concat(s," but got shape ").concat(t,"."))}}if(null!=r.shape)for(let t=0;t<r.shape.length;++t){const e=r.shape[t],s=i.shape[t];if(null!=e&&null!=s&&e!==s)throw new rm("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(r.shape,", ")+"found shape=".concat(i.shape,"."))}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=hm(t);let i=!0;for(const s of n)if(!(s instanceof bv)){i=!1;break}let r=!0;for(const s of n)if(s instanceof bv){r=!1;break}if(i===r)throw new rm("Arguments to apply() must be all SymbolicTensors or all Tensors");return Zm(this.name,(()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of hm(t))e.push(n.shape);this.build(um(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(t),r){let i=this.call(t,e);const r=hm(i),s=[];for(let t of r)-1!==n.indexOf(t)&&(t=t.clone()),s.push(t);if(i=um(s),null!=this.activityRegularizer)throw new sm("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}{const n=function(t){t=hm(t);const e=[];for(const n of t)e.push(n.shape);return um(e)}(t),i=this.computeOutputShape(n);let r;const s="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),r=null!=i&&i.length>0&&Array.isArray(i[0])?i.map(((n,i)=>new bv(s,n,this,hm(t),e,this.name,i))):new bv(s,i,this,hm(t),e,this.name),this.addInboundNode(t,r,null,null,n,i,e),this._refCount++,null!=this.activityRegularizer)throw new sm("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}}))}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let e=!1;this.batchInputShape.forEach(((n,i)=>{null!=n&&null!=t[i]&&t[i]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new nm("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new nm("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new im("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return fv(this.weights)}build(t){this.built=!0}getWeights(){return vv(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(t){da((()=>{const e=this.weights;if(e.length!==t.length)throw new rm('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(e.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0===e.length)return;const n=[],i=vv(e);for(let r=0;r<i.length;++r){const s=i[r],o=e[r],a=t[r];if(!rt(s.shape,a.shape))throw new rm("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(a.shape));n.push([o,a])}yv(n)}))}addWeight(t,e,n,i,r,s,o){if(-1!==this._addedWeightNames.indexOf(t))throw new rm("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(i=Gg("zeros"));const a=i.apply(e,n),c=new gv(a,n,t,s,o);return a.dispose(),null!=r&&this.addLoss((()=>r.apply(c.read()))),null==s&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=hm(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach((t=>{if(null!=t)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return e}addInboundNode(t,e,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const a=hm(t);e=hm(e),n=hm(n),i=hm(i),r=hv(r),s=hv(s);const c=[],l=[],u=[];for(const h of a)c.push(h.sourceLayer),l.push(h.nodeIndex),u.push(h.tensorIndex);new Sv({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:u,inputTensors:a,outputTensors:e,inputMasks:n,outputMasks:i,inputShapes:r,outputShapes:s},o);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach((t=>t.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Ev(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const i=Ev(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of i)-1===e.indexOf(t)&&e.push(t)}return e}}}class Cv extends Tv{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:lv("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new rm("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new rm("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new rm("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const i=new bv(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new Sv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new rm("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function kv(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new rm("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");return new Cv({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}async function Av(t){if(null==t)return;const e=[],n=[],i=[];for(const r in t){const s=t[r];if("number"!==typeof s){const t=s;e.push(t.data()),n.push(r),i.push(t)}}if(e.length>0){const r=await Promise.all(e);for(let e=0;e<r.length;++e)t[n[e]]=r[e][0];pa(i)}}function Iv(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}var Ov;Cv.className="InputLayer",Go(Cv),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Ov||(Ov={}));class Rv{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Nv{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class Mv extends Rv{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const i in e){const t=e[i];if("number"===typeof t)this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+t*n;else{let e;i in this.totals?e=this.totals[i]:this.totals[i]=0;const r=da((()=>Ea(this.totals[i],Aa(t,n))));this.totals[i]=r,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:da((()=>{const t=Aa(ka(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),fa(e[n])})))}}class Dv extends Rv{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const r in this.history){const i=this.history[r];for(let s=0;s<i.length;++s)if("number"!==typeof i[s]){const o=i[s];t.push(o.data()),e.push(r),n.push(s)}}const i=await Promise.all(t);for(let r=0;r<i.length;++r){this.history[e[r]][n[r]].dispose(),this.history[e[r]][n[r]]=i[r][0]}}}class Pv extends Rv{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Tt(this.yieldEvery)&&(this.maybeWait=function(t,e){let n,i=hr();return function(){const r=hr();return r-i<e||(i=r,n=t(...arguments)),n}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const i=[];null!=this.yield&&(await Av(n),i.push(this.yield(t,e,n))),i.push(ep()),await Promise.all(i)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Av(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Av(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(ep()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Av(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Av(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(ep()):Tt(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Av(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Av(t),await this.trainEnd(t))}}function Fv(t,e){if(null==t&&(t={}),t instanceof Rv)return[t];if(Array.isArray(t)&&t[0]instanceof Rv)return t;return hm(t).map((t=>new Pv(t,e)))}class Lv{constructor(){}static registerCallbackConstructor(t,e){J(t>=0&&Number.isInteger(t),(()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t))),Lv.checkForDuplicate(e),null==Lv.constructors[t]&&(Lv.constructors[t]=[]),Lv.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Lv.constructors){Lv.constructors[+e].forEach((e=>{if(e===t)throw new rm("Duplicate callback constructor.")}))}}static clear(){Lv.constructors={}}static createCallbacks(t){const e=[];for(const n in Lv.constructors){const i=+n;t>=i&&e.push(...Lv.constructors[i])}return e.map((t=>new t))}}function Bv(t,e,n,i,r,s,o,a,c){const l=new Dv,u=[new Mv,...Lv.createCallbacks(e)];null!=t&&u.push(...t),u.push(l);const h=new Nv(u);return h.setParams({epochs:n,initialEpoch:i,samples:r,steps:s,batchSize:o,verbose:e,doValidation:a,metrics:c}),{callbackList:h,history:l}}function zv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return vm(t,Wo.getMap().classNameMap,e,"layer",n)}function Uv(t,e){return da((()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const n=zl(yg(t),e,!0),i=Va(n.shape,em()),r=Ia(Za(n,i));return ka(t,r)}))}function jv(t,e){return da((()=>iu(yg(qa(e,t)),-1)))}function Vv(t,e){return da((()=>iu(Xa(qa(e,t)),-1)))}function Wv(t,e){return da((()=>{const n=qa(t,e),i=Wc(Xa(t),em(),Number.MAX_VALUE),r=Xa(ka(n,i));return Aa(100,iu(r,-1))}))}function Gv(t,e){return da((()=>{const n=Wc(e,em(),Number.MAX_VALUE),i=Ml(Ea(1,n)),r=Wc(t,em(),Number.MAX_VALUE),s=Ml(Ea(1,r));return iu(yg(qa(i,s)),-1)}))}function qv(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return da((()=>{if(n)e=eh(e);else{const t=zl(e,e.shape.length-1,!0);e=ka(e,t)}return e=Wc(e,em(),1-em()),Pl(zl(Aa(t.toFloat(),Ml(e)),e.shape.length-1))}))}function Hv(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return da((()=>{const i=bl(function(t){const e=[ng(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=Wc(e,em(),1-em())).shape;return qv(mo(i,r[r.length-1]).reshape(r),e,n)}))}function Xv(t,e){return da((()=>{let n;return n=Wc(e,em(),1-em()),n=Ml(ka(n,qa(1,n))),iu(function(t,e){if(!rt(t.shape,e.shape))throw new rm("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return da((()=>{const n=e.relu(),i=e.abs().neg();return n.sub(e.mul(t)).add(i.exp().log1p())}))}(t,n),-1)}))}function Yv(t,e){return da((()=>{const n=Wc(t,em(),1),i=Wc(e,em(),1);return zl(Aa(t,Ml(ka(n,i))),-1)}))}function Kv(t,e){return da((()=>{const n=Uv(t,-1),i=Uv(e,-1),r=Aa(n,i);return Pl(zl(r,-1))}))}Lv.constructors={};const Qv={meanSquaredError:jv,meanAbsoluteError:Vv,meanAbsolutePercentageError:Wv,meanSquaredLogarithmicError:Gv,squaredHinge:function(t,e){return da((()=>{const n=Za(0,qa(1,Aa(t,e)));return iu(yg(n),-1)}))},hinge:function(t,e){return da((()=>{const n=Za(0,qa(1,Aa(t,e)));return iu(n,-1)}))},categoricalHinge:function(t,e){return da((()=>{const n=zl(Aa(t,e),-1),i=Bl(Aa(qa(1,t),e),-1);return Za(0,Ea(1,qa(i,n)))}))},logcosh:function(t,e){return da((()=>{const n=Math.log(2),i=qa(e,t),r=qa(Ea(i,Fl(Aa(-2,i))),n);return iu(r,-1)}))},categoricalCrossentropy:qv,sparseCategoricalCrossentropy:Hv,binaryCrossentropy:Xv,kullbackLeiblerDivergence:Yv,poisson:function(t,e){return da((()=>{const n=Ml(Ea(em(),e));return iu(qa(e,Aa(t,n)),-1)}))},cosineProximity:Kv};function Zv(t){if("string"===typeof t){if(t in Qv)return Qv[t];let e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new rm(e)}return t}function Jv(t,e){return da((()=>{const n=Aa(.5,fu(e)),i=ag(Sl(e,n),t.dtype);return iu(ll(t,i),-1)}))}function $v(t,e){return da((()=>ag(ll(ac(t,-1),ac(e,-1)),"float32")))}function ty(t,e){return da((()=>Ql(t.equal(1),e.equal(1)).sum().cast("float32")))}function ey(t,e){return da((()=>{const n=ty(t,e),i=function(t,e){return da((()=>Ql(t.equal(0),e.equal(1)).sum().cast("float32")))}(t,e),r=n.add(i);return ul(Sl(r,0),n.div(r),0).cast("float32")}))}function ny(t,e){return da((()=>{const n=ty(t,e),i=function(t,e){return da((()=>Ql(t.equal(1),e.equal(0)).sum().cast("float32")))}(t,e),r=n.add(i);return ul(Sl(r,0),n.div(r),0).cast("float32")}))}function iy(t,e){return Xv(t,e)}function ry(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),ll(t,e).asType("float32")}const sy=qv,oy=Hv,ay={binaryAccuracy:Jv,categoricalAccuracy:$v,precision:ey,categoricalCrossentropy:sy,sparseCategoricalCrossentropy:oy,mse:jv,MSE:jv,mae:Vv,MAE:Vv,mape:Wv,MAPE:Wv,cosine:Kv};function cy(t){if("string"===typeof t&&t in ay)return ay[t];if("string"!==typeof t&&null!=t)return t;throw new rm("Unknown metric ".concat(t))}function ly(t){if(cm(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"===typeof t)return t;{let e;for(const n of Object.keys(Qv))if(Qv[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(ay))if(ay[n]===t){e=n;break}return void 0!==e?e:t.name}}const uy=1048576;function hy(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!dy(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>uy&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(uy,"."))}}function dy(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!dy(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!dy(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function py(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const r=function(t){let e=!0;const n=[],i=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||1===r.length&&r[0].inboundLayers.length>1){e=!1;break}i.push(...r)}if(e)for(const r of t.layers){let t=!1;for(const n of r.inboundNodes)if(-1!==i.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),s=["Layer (type)","Output shape","Param #"];let o;if(r?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((t=>Math.floor(e*t)))),!r){s.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}i("_".repeat(e)),fy(s,n,i),i("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?my(a[u],n,i):gy(a[u],n,o,i),i((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=function(t){let e;e=null!=t.collectedTrainableWeights?fv(t.collectedTrainableWeights):fv(t.trainableWeights);return e}(t),l=fv(t.nonTrainableWeights);i("Total params: ".concat(c+l)),i("Trainable params: ".concat(c)),i("Non-trainable params: ".concat(l)),i("_".repeat(e))}function fy(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,i="";for(let r=0;r<t.length;++r)r>0&&(i=i.slice(0,i.length-1)+" "),i+=t[r],i=i.slice(0,e[r]),i+=" ".repeat(e[r]-i.length);n(i)}function my(t,e,n){let i;try{i=JSON.stringify(t.outputShape)}catch(Mz){i="multiple"}const r=t.name,s=t.getClassName();fy(["".concat(r," (").concat(s,")"),i,t.countParams().toString()],e,n)}function gy(t,e,n,i){let r;try{r=JSON.stringify(t.outputShape)}catch(Mz){r="multiple"}const s=[];for(const l of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(l)))for(let t=0;t<l.inboundLayers.length;++t){const e=l.inboundLayers[t].name,n=l.nodeIndices[t],i=l.tensorIndices[t];s.push("".concat(e,"[").concat(n,"][").concat(i,"]"))}const o=t.name,a=t.getClassName(),c=0===s.length?"":s[0];fy(["".concat(o," (").concat(a,")"),r,t.countParams().toString(),c],e,i);for(let l=1;l<s.length;++l)fy(["","","",s[l]],e,i)}function vy(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function yy(t,e){if(null===t)return null;if("string"===typeof t)return pm(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],i=t.length;for(let r=0;r<i;++r){const i=t[r];vy(e,r,i)?n.push(i):n.push(yy(i,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n];if("name"===n&&"string"===typeof i)e[n]=i;else{const t=pm(n);e[t]=yy(i,t)}}return e}}function xy(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return dm(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],i=t.length;for(let r=0;r<i;++r){const i=t[r];vy(e,r,i)?n.push(i):n.push(xy(i,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n],r=dm(n);e[r]="name"!==n&&"className"!==n||"string"!==typeof i?xy(i,n):i}return e}}const by="2.8.6";class wy{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof wy)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new rm("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Xs(e,t.dtype)}catch(Mz){throw new rm("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof bv){if(null==this.id2Value[t.id])throw new rm("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new rm("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]}}getMask(t){if(t instanceof bv){if(null==this.id2Value[t.id])throw new rm("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new rm("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&pa(this.id2Mask)}}const Sy={},_y={};function Ty(t,e,n,i){const r=null!=n&&n.training,s=Array.isArray(t),o=s?t:[t],a=o.map((t=>t.name)),c=[],l=e.names();for(const f of a)-1!==l.indexOf(f)?c.push(e.getValue(f)):c.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().join(",");let h,d;if(null==Sy[u]){const t=function(t,e){J(null!=t&&t.length>0,(()=>"Expected at least one fetch, got none"));let n=[],i={};if(1===t.length){const r=Cy(t[0],e);n=r.sorted,i=r.recipientMap}else{const r=new Set;for(const s of t){const{sorted:t,recipientMap:o}=Cy(s,e);for(const e of t)r.has(e.name)||(n.push(e),r.add(e.name));for(const e in o)null==i[e]&&(i[e]=new Set),o[e].forEach((t=>i[e].add(t)))}}return{sorted:n,recipientCounts:Ey(i)}}(o,e);h=t.sorted,d=t.recipientCounts,Sy[u]=h,_y[u]=d}h=Sy[u],d={},r||Object.assign(d,_y[u]);const p=new wy(e);for(let f=0;f<h.length;++f){if(null!=i){const t=ua().numTensors;t>i.maxNumTensors&&(i.maxNumTensors=t),t<i.minNumTensors&&(i.minNumTensors=t)}const t=h[f],s=t.sourceLayer;if(s instanceof Cv)continue;const o=[],l=[],u=[];let m=!1;for(const n of t.inputs){const t=p.getValue(n),i=p.getMask(n);o.push(t),l.push(i),null!=i&&(m=!0),r||(d[n.name]--,0!==d[n.name]||e.hasKey(n)||-1!==a.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||u.push(t))}m&&((n=n||{}).mask=l[0]);const g=hm(s.apply(o,n));let v=null;s.supportsMasking&&(v=s.computeMask(o,l));const y=ky(t),x=Array.isArray(y)?y:[y];for(let e=0;e<x.length;++e){p.hasKey(x[e])||p.add(x[e],g[e],Array.isArray(v)?v[0]:v);const t=a.indexOf(x[e].name);-1!==t&&(c[t]=g[e])}r||pa(u)}return p.disposeMasks(),s?c:c[0]}function Ey(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Cy(t,e){const n=new Set,i=[],r={};for(const a of e.names())n.add(a);const s=[],o=[];for(s.push(t);s.length>0;){const t=s[s.length-1];if(n.has(t.name)){s.pop();continue}const e=o[o.length-1]===s.length-1;if(0===t.inputs.length||e)s.pop(),i.push(t),n.add(t.name),e&&o.pop();else{o.push(s.length-1);for(const e of t.inputs)null==r[e.name]&&(r[e.name]=new Set),r[e.name].add(t.name),n.has(e.name)||s.push(e)}}return{sorted:i,recipientMap:r}}function ky(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const i of t.sourceLayer.inboundNodes[e].outputTensors)if(i.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}class Ay extends Tv{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=lv(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],xm(this.inputs).length!==this.inputs.length)throw new rm("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map((t=>t.name))));xm(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map((t=>t.name)))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const t=v.sourceLayer,e=v.nodeIndex,n=v.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const v of this.inputs){const t=v.sourceLayer,e=v.nodeIndex,n=v.tensorIndex;cm(0===e,"input layer has >1 nodes"),cm(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const e=this.inputLayers[v];if(!(e instanceof Cv))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(t.inputs,". ")+"Input ".concat(v," (0-based) originates ")+"from layer type ".concat(e.getClassName(),"."));this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map((t=>t.shape)),this.internalOutputShapes=this.outputs.map((t=>t.shape));const e={},n={},i={},r={},s={},o=[],a=(t,e,n,i,r,c)=>{null!=i&&null!=r&&null!=c||(i=t.sourceLayer,r=t.nodeIndex,c=t.tensorIndex);const l=i.inboundNodes[r];if(-1!==n.indexOf(l))throw new im("The tensor ".concat(t.name,' at layer "').concat(i.name,'" ')+"is part of a cycle.");if(-1!==e.indexOf(l))return;this.containerNodes.add(Ay.nodeKey(i,r)),i.id in s||(s[i.id]=Object.keys(s).length),-1===n.indexOf(l)&&n.push(l);const u=l.inboundLayers.length;for(let s=0;s<u;s++){const t=l.inputTensors[s],i=l.inboundLayers[s],r=l.nodeIndices[s],o=l.tensorIndices[s];a(t,e,n,i,r,o)}for(e.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);o.push(l)},c=[],l=[];for(const v of this.outputs)a(v,c,l);const u=o.slice().reverse();for(const v of u){n[v.id]=v,v.id in e||(e[v.id]=0);let t=e[v.id];const s=null==i[v.outboundLayer.id]?0:i[v.outboundLayer.id];t=Math.max(t,s),i[v.outboundLayer.id]=t,r[v.outboundLayer.id]=v.outboundLayer,e[v.id]=t;for(let i=0;i<v.inboundLayers.length;i++){const r=v.inboundLayers[i],s=v.nodeIndices[i],o=r.inboundNodes[s],a=null==e[o.id]?0:e[o.id];e[o.id]=Math.max(t+1,a),n[o.id]=o}}const h={};for(const v in e){const t=e[v];t in h||(h[t]=[]),h[t].push(n[v])}const d={};for(const v in i){const t=i[v];t in d||(d[t]=[]),d[t].push(r[v])}let p=Object.keys(d).map((t=>parseInt(t,10))).sort(ym);this.layers=[];for(const v of p){const t=d[v];t.sort(((t,e)=>{const n=s[t.id],i=s[e.id];return n<i?-1:n>i?1:0}));for(const e of t)e instanceof Ay&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,p=Object.keys(h).map((t=>parseInt(t,10))).sort(ym);const f=this.inputs.slice(),m=[];for(const v of p)for(const t of h[v]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===f.indexOf(n))throw new im("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(e.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(m));for(const e of t.outputTensors)f.push(e);m.push(e.name)}}this.nodesByDepth=h;const g=this.layers.map((t=>t.name));for(const v of g){const t=g.filter((t=>t===v)).length;if(1!==t)throw new im('The name "'.concat(v,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Sv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((t=>null)),outputMasks:this.outputs.map((t=>null)),inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs.map((t=>t.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach((e=>{e._trainableWeights.forEach((e=>e.trainable=t))})),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new rm("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let i=0;for(const s of this.layers)for(const t of s.weights){if(null!=n[t.originalName])throw new rm("Duplicate weight name: ".concat(t.originalName));n[t.originalName]=t,i++}const r=[];for(const s in t){let i=s;if(null==n[s]){const t=s.split("/");i=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[i])r.push([n[i],t[s]]);else if(e)throw new rm("Provided weight data has no target variable: ".concat(s));delete n[i]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new rm("".concat(t.length," of ").concat(i," weights are not set: ")+"".concat(t))}yv(r)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers ".concat(by),e.backend="TensorFlow.js",e}toJSON(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=xy(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return da((()=>{t=hm(t);const n=new wy;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return Ty(this.outputs,n,e)}))}computeMask(t,e){return da((()=>{let n;return t=hm(t),n=null==e?am(null,t.length):hm(e),this.runInternalGraph(t,n)[1]}))}computeOutputShape(t){const e=hv(t);if(e.length!==this.inputLayers.length)throw new rm("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let o=0;o<e.length;o++){const t=this.inputLayers[o],i=e[o];n[t.name+"_0_0"]=i}const i=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(ym);if(i.length>1)for(const o of i){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map((t=>t.id)).indexOf(t.id))continue;const i=[];for(let o=0;o<e.inboundLayers.length;o++){const t=e.inboundLayers[o],r=e.nodeIndices[o],s=e.tensorIndices[o],a=n["".concat(t.name,"_").concat(r,"_").concat(s)];i.push(a)}const r=hv(t.computeOutputShape(um(i))),s=t.inboundNodes.indexOf(e);for(let e=0;e<r.length;e++){n["".concat(t.name,"_").concat(s,"_").concat(e)]=r[e]}}}const r=[],s=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],e=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],i="".concat(t.name,"_").concat(e,"_").concat(n);s.push(i)}for(let o=0;o<s.length;o++){const t=s[o];cm(t in n),r.push(n[t])}return um(r)}runInternalGraph(t,e){null==e&&(e=am(null,t.length));const n={};for(let a=0;a<this.inputs.length;++a){const i=this.inputs[a],r=t[a],s=e[a];n[i.id]=[r,s]}const i=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(ym);for(const a of i){const t=this.nodesByDepth[a];for(const e of t){const t=e.outboundLayer,i=e.inputTensors,r=e.outputTensors,s=new Array;for(const e of i)e.id in n&&s.push(n[e.id]);if(s.length===i.length){let i,o,a,c,l={};if(null!=e.callArgs&&(l=e.callArgs),1===s.length){const[e,n]=s[0];null==l.mask&&(l.mask=n),a=hm(t.call(e,l)),c=hm(t.computeMask(e,n)),i=[e],o=[n]}else i=s.map((t=>t[0])),o=s.map((t=>t[1])),null==l.mask&&(l.mask=o),a=hm(t.call(i,l)),c=hm(t.computeMask(i,o));if(t.activityRegularizer)throw new sm("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<r.length;++t){const e=r[t],i=a[t],s=c[t];n[e.id]=[i,s]}}}}const r=[],s=[],o=[];for(const a of this.outputs){cm(a.id in n,"Could not compute output ".concat(a.name," : ").concat(a.id));const[t,e]=n[a.id];o.push(t.shape),r.push(t),s.push(e)}return[r,s,o]}buildNodeConversionMap(t){const e={};let n;for(const i of this.layers){n=i instanceof Ay?1:0;for(let t=0;t<i.inboundNodes.length;t++){const r=Ay.nodeKey(i,t);this.containerNodes.has(r)&&(e[r]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new rm("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}if(null==t)throw new rm("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new rm("No such layer: ".concat(t))}calculateLosses(){return da((()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const i=Ay.nodeKey(e,n);this.containerNodes.has(i)&&t.push(...e.calculateLosses())}return t}))}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const s of this.layers){const t=s.getClassName(),i=s.getConfig(),r=[];for(let n=0;n<s.inboundNodes.length;n++){const t=s.inboundNodes[n],i=Ay.nodeKey(s,n);let o={};if(this.containerNodes.has(i)){if(t.callArgs)try{JSON.stringify(t.callArgs),o=t.callArgs}catch(Mz){console.warn("Layer ".concat(s.name," was passed ")+"non-serializable keyword arguments: "+"".concat(t.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),o={}}if(t.inboundLayers.length>0){const n=[];for(let i=0;i<t.inboundLayers.length;i++){const r=t.inboundLayers[i],s=t.nodeIndices[i],a=t.tensorIndices[i];let c=e[Ay.nodeKey(r,s)];null==c&&(c=0),n.push([r.name,c,a,o])}r.push(n)}}}const o={};o.name=s.name,o.className=t,o.config=i,o.inboundNodes=r,n.push(o)}t.layers=n;const i=[];for(let s=0;s<this.inputLayers.length;s++){const t=this.inputLayers[s],n=this.inputLayersNodeIndices[s],r=Ay.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let o=e[r];null!==o&&void 0!==o||(o=0);const a=this.inputLayersTensorIndices[s];i.push([t.name,o,a])}t.inputLayers=i;const r=[];for(let s=0;s<this.outputLayers.length;s++){const t=this.outputLayers[s],n=this.outputLayersNodeIndices[s],i=Ay.nodeKey(t,n);if(!this.containerNodes.has(i))continue;let o=e[i];null!==o&&void 0!==o||(o=0);const a=this.outputLayersTensorIndices[s];r.push([t.name,o,a])}return t.outputLayers=r,t}static fromConfig(t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={},r={};function s(t,e){t.name in r?r[t.name].push(e):r[t.name]=[e]}function o(t,e){const n=[];let r;for(const o of e){const a=o[0],c=o[1],l=o[2];if(r=null==o[3]?{}:o[3],!(a in i))return void s(t,e);const u=i[a];if(u.inboundNodes.length<=c)return void s(t,e);const h=u.inboundNodes[c];n.push(h.outputTensors[l])}n.length>0&&t.apply(um(n),r)}function a(t){const r=t.name,o=zv(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(n),i[r]=o;t.inboundNodes.forEach((t=>{if(!(t instanceof Array))throw new rm("Corrupted configuration, expected array for nodeData: ".concat(t));s(o,t)}))}const c=e.name,l=e.layers;for(const f of l)a(f);for(;!bm(r);)for(const t of l){const e=i[t.name];if(e.name in r){const t=r[e.name];delete r[e.name];for(const n of t)o(e,n)}}const u=[],h=[],d=e.inputLayers;for(const f of d){const t=f[0],e=f[1],n=f[2];cm(t in i);const r=i[t].inboundNodes[e].outputTensors;u.push(r[n])}const p=e.outputLayers;for(const f of p){const t=f[0],e=f[1],n=f[2];cm(t in i);const r=i[t].inboundNodes[e].outputTensors;h.push(r[n])}return new t({inputs:u,outputs:h,name:c})}get stateful(){if(this._stateful)throw new rm("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){da((()=>{this.layers.forEach((t=>{t.stateful&&t.resetStates()}))}))}}function Iy(t,e,n){const i=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>null));if(1===i)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==i)throw new Error("Provided ".concat(n," is an array of ").concat(t.length," ")+"element(s), but the model has ".concat(i," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach((e=>{e in t?n.push(t[e]):n.push(null)})),n}throw new Error("The model has multiple (".concat(i,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(i," elements or an object with ").concat(e," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(t)))}function Oy(t,e){return Iy(t,e,"classWeight")}async function Ry(t,e,n,i){if(null!=e||null!=i)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=da((()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){const e=1;return t.argMax(e)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),i=Array.from(await e.data());pa(e);const r=[];return i.forEach((t=>{if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");r.push(n[t])})),ph(r,"float32")}return null}function Ny(t,e){return Aa(t,e)}function My(t,e){let n,i;const r=e;n=r.xs,i=r.ys,J(null!=n&&null!=i,(()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e)));const s=Dy("input",t.inputNames,n),o=Dy("output",t.outputNames,i),a=s[0].shape[0];J(s.length===t.inputs.length,(()=>"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(s.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")"))),J(o.length===t.outputs.length,(()=>"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")")));for(let c=0;c<s.length;c++)J(s[c].shape[0]===a,(()=>"Batch size mismatch: input "+"".concat(t.inputNames[c]," has ").concat(s[c].shape[0],"; ")+"expected  ".concat(a," based on input ").concat(t.inputNames[0],".")));for(let c=0;c<o.length;c++)J(o[c].shape[0]===a,(()=>"Batch size mismatch: output "+"".concat(t.outputNames[c]," has ").concat(o[c].shape[0],"; ")+"expected  ".concat(a," based on input ").concat(t.inputNames[0],".")));return{xs:s,ys:o}}function Dy(t,e,n){if(n instanceof xr)return[n];if(Array.isArray(n))return J(n.length===e.length,(()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,"."))),n;{const i=[];for(const r of e){if(null==n[r])throw new rm("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(r,"'."));i.push(n[r])}return i}}async function Py(t,e,n){const i=null!=n.batchesPerEpoch;if(J(null!=t.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),J(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),J(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs))),J(!i||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch))),J(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=null!=n.validationData;let s,o;if(r)if(Fy(n.validationData))J(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)));else{const t=function(t){if(3===t.length)throw new sm("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);s=t.xs,o=t.ys}const a=t.makeTrainFunction(),c=t.getDedupedMetricsNames();let l;l=r?c.slice().concat(c.map((t=>"val_"+t))):c.slice();const u=Fv(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:d,history:p}=Bv(u,h,n.epochs,null,null,function(t,e){let n=null;null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size);return n}(e,n),null,r,l);d.setModel(t),t.history=p,await d.onTrainBegin(),t.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await e.iterator();for(;f<n.epochs;){const l={};await d.onEpochBegin(f);let u=0,h=0;for(i||(m=await e.iterator());!i||u<n.batchesPerEpoch;){const e=await m.next();if(i&&e.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(u," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:i,ys:r}=My(t,e.value),s={};s.batch=h,s.size=i[0].shape[0],await d.onBatchBegin(h,s);const o=[];if(null!=n.classWeight){const e=Oy(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await Ry(r[t],null,e[t]))}const l=i.concat(r).concat(o),p=a(l);pa(l);for(let t=0;t<c.length;++t){const e=c[t],n=p[t];s[e]=n,fa(n)}await d.onBatchEnd(h,s),Iv(s),h++,u++}if(i?u>=n.batchesPerEpoch:e.done){if(r){let e;e=Fy(n.validationData)?hm(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):hm(t.evaluate(s,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)l["val_".concat(t.metricsNames[n])]=e[n]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(f,l),f++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Fy(t){return"function"===typeof t.iterator}function Ly(t){J(t>0&&Number.isInteger(t),(()=>"batchSize is required to be a positive integer, but got ".concat(t)))}function By(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((t=>lg(t,e,n-e))):lg(t,e,n-e)}function zy(t,e){return da((()=>null==t?null:Array.isArray(t)?t.map((t=>zy(t,e))):vg(t,"int32"===e.dtype?e:e.toInt())))}function Uy(t,e){const n=[];let i=0,r=null;for(;i<t;)r=i+e,r>=t&&(r=t),n.push([i,r]),i=r;return n}async function jy(t,e,n){let i,r,s,o,a,c,l,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const h=null==u.batchSize?32:u.batchSize;Ly(h);const d=!1,p=await t.standardizeUserData(e,n,u.sampleWeight,u.classWeight,d,h);i=p[0],r=p[1],l=p[2];let f,m=!1;if(null!=u.validationData&&u.validationData.length>0){if(m=!0,2!==u.validationData.length)throw 3===u.validationData.length?new sm("validationData including sample weights is not supported yet."):new rm("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(u.validationData," is invalid."));s=u.validationData[0],o=u.validationData[1];const e=!0,n=await t.standardizeUserData(s,o,null,null,e,h);a=n[0],c=n[1],f=a.concat(c)}else if(null!=u.validationSplit&&u.validationSplit>0&&u.validationSplit<1){m=!0;const t=Math.floor(i[0].shape[0]*(1-u.validationSplit)),e=i[0].shape[0];a=By(i,t,e),i=By(i,0,t),c=By(r,t,e),r=By(r,0,t),f=a.concat(c)}else null!=u.validationSteps&&(m=!0);const g=i.concat(r).concat(l);t.checkTrainableWeightsConsistency();const v=t.makeTrainFunction(),y=t.getDedupedMetricsNames();let x,b;m?(t.makeTestFunction(),x=t.testFunction,b=y.slice().concat(y.map((t=>"val_"+t)))):(x=null,f=[],b=y.slice());const w=Fv(u.callbacks,u.yieldEvery),S=await async function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f){null==r&&(r=32),null==s&&(s=1),null==u&&(u=!0),null==d&&(d=0);let m=!1;if(null!=c&&null!=l&&(m=!0),null!=f&&(m=!0,null==p))throw new rm("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=t.checkNumSamples(n,r,p,"steps_per_epoch");let v;null!=g&&(v=og(0,g)),null==o&&(o=1);const{callbackList:y,history:x}=Bv(a,o,s,d,g,p,r,m,h);y.setModel(t),t.history=x,await y.onTrainBegin(),t.stopTraining_=!1;for(let b=d;b<s;++b){await y.onEpochBegin(b);const s={};if(null!=p)throw new sm("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new sm("batch shuffling is not implemneted yet");u&&H(v);const o=ph(v),a=Uy(g,r);for(let u=0;u<a.length;++u){const h={};if(await y.onBatchBegin(u,h),da((()=>{const d=a[u][0],p=a[u][1],f=lg(o,d,p-d);h.batch=u,h.size=p-d;const g=zy(n,f),v=e(g);for(let t=0;t<i.length;++t){const e=i[t],n=v[t];h[e]=n,fa(n)}if(u===a.length-1&&m){const e=t.testLoop(c,l,r);for(let t=0;t<i.length;++t){const n=i[t],r=e[t];fa(r),s["val_"+n]=r}}})),await y.onBatchEnd(u,h),Iv(h),t.stopTraining_)break}o.dispose()}if(await y.onEpochEnd(b,s),t.stopTraining_)break}return await y.onTrainEnd(),await t.history.syncData(),t.history}(t,v,g,y,h,u.epochs,u.verbose,w,x,f,u.shuffle,b,u.initialEpoch,null,null);return S}finally{t.isTraining=!1,Wy(i,e),Wy(r,n),Wy(a,s),Wy(c,o),null!=l&&pa(l)}}function Vy(t){const e=[];t instanceof xr&&(t=[t]);for(let n=0;n<t.length;++n){const i=t[n];if(1===i.rank)e.push(cg(i,1));else{if(0===i.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(i)}}return e}function Wy(t,e){if(null==t)return;const n=[];if(e instanceof xr)n.push(e.id);else if(Array.isArray(e))e.forEach((t=>n.push(t.id)));else if(null!=e)for(const r in e){const t=e[r];n.push(t.id)}const i=[];if(t instanceof xr)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach((t=>{-1===n.indexOf(t.id)&&i.push(t)}));else if(null!=t)for(const r in t){const e=t[r];-1===n.indexOf(e.id)&&i.push(e)}i.forEach((t=>{t.isDisposed||t.dispose()}))}function Gy(t){return Array.isArray(t)}function qy(t){return!function(t){return t instanceof xr}(t)&&!Gy(t)}function Hy(t,e,n){let i,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0===e.length){if(null!=t){let e=!1;if(Gy(t)&&t.length>0)e=!0;else if(qy(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new rm("Error when checking model ".concat(s," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map((t=>null));if(qy(t)){i=[];for(const n of e){if(null==t[n])throw new rm('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(e));i.push(t[n])}}else if(Gy(t)){if(t.length!==e.length)throw new rm("Error when checking model ".concat(s,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));i=t}else{if(e.length>1)throw new rm("The model ".concat(s," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));i=[t]}if(i=Vy(i),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=i[o];if(t.shape.length!==n[o].length)throw new rm("Error when checking ".concat(s,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(t.shape));for(let i=0;i<n[o].length;++i){if(0===i&&!r)continue;const a=t.shape[i],c=n[o][i];if(null!=c&&c>=0&&a!==c)throw new rm("Error when checking ".concat(s,": expected ").concat(e[o]," ")+"to have shape [".concat(n[o],"], but got array with shape ")+"[".concat(t.shape,"]."))}}return i}function Xy(t,e,n){let i,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(t)){if(t.length!==e.length)throw new rm("Error when checking model ".concat(s,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));i=t}else{if(e.length>1)throw new rm("The model expects ".concat(e.length," ").concat(s," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));i=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=i[o];if(t.shape.length!==n[o].length)throw new rm("Error when checking ".concat(s,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(t.shape)));for(let i=0;i<n[o].length;++i){if(0===i&&!r)continue;const a=t.shape[i],c=n[o][i];if(null!=c&&c!==a)throw new rm("Error when checking ".concat(s,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(t.shape),"."))}}}class Yy extends Ay{constructor(t){super(t),this.isTraining=!1}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new rm("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");py(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>$d.adagrad(.01),Adadelta:()=>$d.adadelta(1,.95,em()),Adam:()=>$d.adam(.001,.9,.999,em()),Adamax:()=>$d.adamax(.002,.9,.999,em(),0),RMSProp:()=>$d.rmsprop(.001,.9,0,em()),SGD:()=>$d.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new rm("Unknown Optimizer ".concat(t))}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Ua))throw new rm("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new rm("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));const n=t.loss;e=n.map((t=>Zv(t)))}else{const n=Zv(t.loss);this.outputs.forEach((t=>{e.push(n)}))}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new rm('Unknown entry in loss dictionary: "'.concat(e,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==t.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),e.push(Zv(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){const t=this.internalOutputShapes[s],e=this.outputNames[s];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[s])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Zm("loss",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}}));const i=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>[]));let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));n=t}if(Array.isArray(n))return e.map((t=>n));{const t=[];for(const i of e){let e=n.hasOwnProperty(i)?n[i]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),r=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};Zm("metric",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;(e=>{let n,i,s;for(const o of e){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let r;1===e[e.length-1]||this.lossFunctions[t]===Xv?-1!==["accuracy","acc"].indexOf(o)?i=Jv:-1!==["crossentropy","ce"].indexOf(o)&&(i=iy):this.lossFunctions[t]===Hv?-1!==["accuracy","acc"].indexOf(o)?i=ry:-1!==["crossentropy","ce"].indexOf(o)&&(i=oy):-1!==["accuracy","acc"].indexOf(o)?i=$v:-1!==["crossentropy","ce"].indexOf(o)&&(i=sy),-1!==["accuracy","acc"].indexOf(o)?r="acc":-1!==["crossentropy","ce"].indexOf(o)&&(r="ce"),s=i,n=""+r}else{const t=cy(o);s=t,n=""+ly(o)}let e;Zm(n,(()=>{e=s})),r(t,n,e)}})(i[t])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=null==n.batchSize?32:n.batchSize;Ly(i);const r=this.standardizeUserDataXY(t,e,!0,i);try{const t=r[0].concat(r[1]);this.makeTestFunction();const e=this.testFunction;return um(this.testLoop(e,t,i,n.verbose,n.steps))}finally{Wy(r[0],t),Wy(r[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const i=null!=(n=n||{}).batches,r=t.testFunction;let s=[];if(n.verbose>0)throw new sm("Verbose mode is not implemented yet.");J(!i||n.batches>0&&Number.isInteger(n.batches),(()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))));const o="function"===typeof e.next?e:await e.iterator();let a=0,c=0;for(;!i||c<n.batches;){const e=await o.next();if(s=da((()=>{if(e.value){const{xs:n,ys:i}=My(t,e.value),o=n.concat(i),l=da((()=>r(o)));if(pa(o),0===c)for(let t=0;t<l.length;++t)s.push(za(0));const u=o[0].shape[0];for(let t=0;t<l.length;++t){const e=l[t],n=s[t];s[t]=da((()=>Ea(s[t],Aa(u,e)))),c>0&&pa(n)}pa(l),a+=u,++c}return s})),e.done){i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let l=0;l<s.length;++l){const t=s[l];s[l]=ka(s[l],a),pa(t)}return um(s)}(this,t,e)}checkNumSamples(t,e,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(i=null,null!=e)throw new rm("If ".concat(r," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new rm("Either the input data should have a defined shape, or "+"".concat(r," shoud be specified."));i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new rm("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),i=n?e:[e],r=this.retrieveSymbolicTensors(i),s=new wy;if(t instanceof xr&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new rm("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let e=0;e<this.inputs.length;++e)s.add(this.inputs[e],t[e])}else for(const a of this.inputs){const e=t[a.name];if(null==e)throw new rm("No value is provided for the model's input ".concat(a.name));s.add(a,e)}const o=Ty(r,s);return n?o:o[0]}retrieveSymbolicTensors(t){const e=am(null,t.length);let n=t.length;for(const i of this.layers){const r=Array.isArray(i.output)?i.output:[i.output],s=r.map((t=>t.name));for(let i=0;i<t.length;++i){const o=s.indexOf(t[i]);if(-1!==o&&(e[i]=r[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach(((e,i)=>{null==e&&n.push(t[i])})),new rm("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return e}predictLoop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return da((()=>{const i=this.checkNumSamples(t);if(n)throw new sm("Verbose predictLoop() is not implemented yet.");const r=Uy(i,e),s=this.outputs.map((t=>[]));for(let e=0;e<r.length;++e){da((()=>{const n=r[e][0],i=r[e][1],s=By(t,n,i),o=[];if(Array.isArray(s))for(let t=0;t<s.length;++t)o.push({key:this.inputs[t],value:s[t]});else o.push({key:this.inputs[0],value:s});const a=new wy(o);return Ty(this.outputs,a)})).forEach(((t,e)=>s[e].push(t)))}return um(s.map((t=>Oc(t,0))))}))}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Vy(t);Xy(n,this.inputNames,this.feedInputShapes,!1);try{const t=null==e.batchSize?32:e.batchSize;return Ly(t),this.predictLoop(n,t)}finally{Wy(n,t)}}predictOnBatch(t){Xy(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new im("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let r=0;r<this.feedOutputShapes.length;++r){const t=this.feedOutputShapes[r];this.feedLossFns[r]===Hv?i.push(t.slice(0,t.length-1).concat([1])):i.push(t)}if(function(t,e,n){const i=xm(t.map((t=>t.shape[0])));i.sort();const r=xm(e.map((t=>t.shape[0])));if(r.sort(),i.length>1)throw new rm("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((t=>t.shape)))));if(r.length>1)throw new rm("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((t=>t.shape)))));if(i.length>0&&r.length>0&&!rt(i,r))throw new rm("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(i[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(t=Hy(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=Hy(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){const i=[jv,Xv,qv];for(let r=0;r<t.length;++r){const s=t[r],o=e[r],a=n[r];if(null!=o){if(o===qv&&1===s.shape[s.shape.length-1])throw new rm("You are passing a target array of shape ".concat(s.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==i.indexOf(o)){const t=s.shape.slice(1),e=a.slice(1);for(let n=0;n<t.length;++n){const i=t[n],r=e[n];if(null!=r&&i!==r)throw new rm("A target Tensor with shape ".concat(s.shape," was passed for an ")+"output of shape ".concat(a,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&t[0].shape[0]%n!==0)throw new rm("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]}async standardizeUserData(t,e,n,i){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0;const[o,a]=this.standardizeUserDataXY(t,e,r,s);if(null!=n)throw new Error("sample weight is not supported yet.");let c=null;if(null!=i){const t=Oy(i,this.outputNames);c=[];for(let e=0;e<t.length;++e)c.push(await Ry(a[e],null,t[e]))}return[o,a,c]}testLoop(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;return da((()=>{const s=this.checkNumSamples(e,n,r,"steps"),o=[];if(i>0)throw new sm("Verbose mode is not implemented yet.");if(null!=r)throw new sm("steps mode in testLoop() is not implemented yet");{const i=Uy(s,n),r=ph(og(0,s));for(let n=0;n<i.length;++n){const s=i[n][0],a=i[n][1],c=lg(r,s,a-s),l=zy(e,c),u=t(l);if(0===n)for(let t=0;t<u.length;++t)o.push(za(0));for(let t=0;t<u.length;++t){const e=u[t];o[t]=Ea(o[t],Aa(a-s,e))}}for(let t=0;t<o.length;++t)o[t]=ka(o[t],s)}return o}))}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const i=t[n];let r=i;if(lm(t,i)>1){const e=lm(t.slice(0,n),i);r+="_".concat(e)}e.push(r)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),s=[],o=this.collectedTrainableWeights.map((t=>t.read()));return[this.optimizer_.minimize((()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const o=new wy(t),a=Ty(this.outputs,o,{training:!0});let c;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(i[n],a[n]);null!=r[n]&&(t=Ny(t,r[n]));const s=iu(t);e.push(s),c=0===n?t:Ea(c,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],r=this.metricsTensors[n][1];t=iu(e(i[r],a[r]))}fa(t),s.push(t)}return c=iu(c),this.calculateLosses().forEach((t=>{c=Ea(c,t)})),c}),!0,o)].concat(s)}}makeTestFunction(){this.testFunction=t=>da((()=>{const e=[];let n;const i=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let t=0;t<this.inputs.length;++t)s.push({key:this.inputs[t],value:i[t]});const o=new wy(s),a=Ty(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const i=this.lossFunctions[t],s=iu(i(r[t],a[t]));n=0===t?s:Ea(n,s),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],i=this.metricsTensors[t][1],s=iu(n(r[i],a[i]));e.push(s)}return e}))}async fit(t,e){return jy(this,t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async fitDataset(t,e){return Py(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),i=n[0],r=n[1],s=this.makeTrainFunction()(i.concat(r)),o=[];for(const a of s){const t=await a.data();o.push(t[0])}return pa(s),um(o)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,i=n?this.trainableWeights:this.weights,r=this.getWeights(n);for(let s=0;s<i.length;++s)n&&!i[s].trainable||e.push({name:i[s].originalName,tensor:r[s]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=ua().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-ua().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=dm(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((t=>dm(t)))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const i of e){if("string"!==typeof n[i])throw new Error("Serialization of non-string loss is not supported.");t[i]=dm(n[i])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[dm(ly(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((t=>dm(ly(t))));{const t={};for(const e in this.metrics)t[e]=dm(ly(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=zv(yy(t.optimizer_config));let n,i;if("string"===typeof t.loss)n=pm(t.loss);else if(Array.isArray(t.loss))n=t.loss.map((t=>pm(t)));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=pm(t.loss[e])}if(Array.isArray(t.metrics))i=t.metrics.map((t=>pm(t)));else if(null!=t.metrics){i={};for(const e in t.metrics)i[e]=pm(t.metrics[e])}this.compile({loss:n,metrics:i,optimizer:e})}async save(t,e){if("string"===typeof t){const e=ds(t);if(0===e.length)throw new rm("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new rm("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new rm("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await ts(this.getNamedWeights(e)),i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(by),convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){i.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:r}=await ts(await this.optimizer.getWeights(),t);n.specs.push(...r),n.data=ss([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;hy(this.userDefinedMetadata,this.name,t),i.userDefinedMetadata=this.userDefinedMetadata}return i.weightData=n.data,i.weightSpecs=n.specs,t.save(i)}setUserDefinedMetadata(t){hy(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Yy.className="Model",Go(Yy);class Ky extends Yy{}async function Qy(t,e){"modelTopology"in t||(t={modelTopology:t});let n=t.modelTopology;null!=n.model_config&&(n=n.model_config);const i=zv(yy(n),e);if(null!=t.weightsManifest){const e=await no(t.weightsManifest,t.pathPrefix,i.weights.map((t=>t.originalName))),n={};for(const t of i.weights)n[t.originalName]=e[t.originalName];i.loadWeights(n),pa(e)}return i}async function Zy(t,e){if(null==e&&(e={}),"string"===typeof t){const n=ps(t,e);if(0===n.length)n.push(co(t,e));else if(n.length>1)throw new rm("Found more than one (".concat(n.length,") load handlers for ")+"URL '".concat(t,"'"));t=n[0]}return async function(t,e,n){null==n&&(n={});if(null==t.load)throw new rm("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const i=await t.load();let r=i.modelTopology;null!=r.model_config&&(r=r.model_config);const s=null==n.strict||n.strict,o=null!=i.weightData&&null!=i.weightSpecs&&s,a=zv(yy(r),e,o),c=i.trainingConfig;null!=c&&a.loadTrainingConfig(c);null!=i.userDefinedMetadata&&a.setUserDefinedMetadata(i.userDefinedMetadata);if(null!=i.weightData){if(null==i.weightSpecs)throw new rm("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=es(t,e),i={},r=[];return e.forEach((t=>{"optimizer"===t.group?r.push({name:t.name,tensor:n[t.name]}):i[t.name]=n[t.name]})),{modelWeights:i,optimizerWeights:r}}(i.weightData,i.weightSpecs);a.loadWeights(t,s),null!=a.optimizer&&e.length>0&&await a.optimizer.setWeights(e),pa(t),pa(e.map((t=>t.tensor)))}return a}(t,void 0,e)}Ky.className="Functional",Go(Ky);class Jy extends Yy{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:lv("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some((t=>t<0)))throw new rm("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){const e=t instanceof Jy||t instanceof Yy;let n;if(e){if(n=t,1!==n.outputs.length)throw new rm("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new rm("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new rm("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=kv({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new rm("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new rm("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Ev(this.outputs[0])}this.inboundNodes=[],new Sv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:am(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(pv(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Yy({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new im("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new im("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new im("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new im("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new rm("Legacy serialization format not supported yet.");n=e}else J(null!=e.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=e.layers,delete e.layers,r=e;const s=new t(r);if(!(s instanceof Jy))throw new sm("Sequential.fromConfig called on non-Sequential input: ".concat(s));for(const o of n){const t=zv(o,void 0,i);i&&t.setFastWeightInitDuringBuild(!0),s.add(t)}return s}set stopTraining(t){if(null==this.model)throw new rm("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new rm("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}function $y(t){return new Yy(t)}function tx(t){return new Jy(t)}function ex(t,e){return null==e&&(e={}),Zy(t,e)}function nx(t){return kv(t)}function ix(t,e){Lv.registerCallbackConstructor(t,e)}Jy.className="Sequential",Go(Jy);class rx extends Vo{getConfig(){return{}}}class sx extends rx{apply(t){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==e)throw new sm("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return pl(t)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}sx.className="elu",Go(sx);class ox extends rx{apply(t){return qu(t)}}ox.className="selu",Go(ox);class ax extends rx{apply(t){return Fu(t)}}ax.className="relu",Go(ax);class cx extends rx{apply(t){return da((()=>su(6,Fu(t))))}}cx.className="relu6",Go(cx);class lx extends rx{apply(t){return t}}lx.className="linear",Go(lx);class ux extends rx{apply(t){return Rc(t)}}ux.className="sigmoid",Go(ux);class hx extends rx{apply(t){return function(t){return da((()=>{const e=Ea(.5,Aa(.2,t));return Wc(e,0,1)}))}(t)}}hx.className="hardSigmoid",Go(hx);class dx extends rx{apply(t){return Fl(t)}}dx.className="softplus",Go(dx);class px extends rx{apply(t){return function(t){return da((()=>ka(t,Xa(t).add(1))))}(t)}}px.className="softsign",Go(px);class fx extends rx{apply(t){return Mc(t)}}fx.className="tanh",Go(fx);class mx extends rx{apply(t){return eh(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}mx.className="softmax",Go(mx);class gx extends rx{apply(t){return Ul(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}gx.className="logSoftmax",Go(gx);class vx extends rx{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return da((()=>Rc(t.mul(e)).mul(t)))}}function yx(t){return t.getClassName()}function xx(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vm(t,Wo.getMap().classNameMap,e,"activation")}function bx(t){if(null==t){const t={className:"linear",config:{}};return xx(t)}if("string"===typeof t){const e={};return e.className=t,e.config={},xx(e)}return t instanceof rx?t:xx(t)}function wx(t){if(null!=t&&"object"!==typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}vx.className="swish",Go(vx);class Sx extends Vo{}class _x extends Sx{constructor(t){super(),wx(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return da((()=>{let e=du([1]);return this.hasL1&&(e=Ea(e,zl(Aa(this.l1,Xa(t))))),this.hasL2&&(e=Ea(e,zl(Aa(this.l2,yg(t))))),e.asScalar()}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}_x.className="L1L2",Go(_x);const Tx={l1l2:"L1L2"};function Ex(t){return mm(t)}function Cx(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vm(t,Wo.getMap().classNameMap,e,"regularizer")}function kx(t){if(null==t)return null;if("string"===typeof t){return Cx({className:t in Tx?Tx[t]:t,config:{}})}return t instanceof Sx?t:Cx(t)}class Ax extends Tv{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=dv(t);let n=Fu(t);return null!=this.maxValue&&(n=Wc(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Ax.className="ReLU",Go(Ax);class Ix extends Tv{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=dv(t);return Al(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Ix.className="LeakyReLU",Go(Ix);class Ox extends Tv{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Gg(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=kx(t.alphaRegularizer),this.alphaConstraint=Pm(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new rm("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(t.sharedAxes));this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=pv(t)).slice(1);if(null!=this.sharedAxes)for(const i of this.sharedAxes)e[i-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let i=1;i<t.length;++i)n[i]=t[i];this.inputSpec=[new xv({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=dv(t),_u(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Wg(this.alphaInitializer),alphaRegularizer:Ex(this.alphaRegularizer),alphaConstraint:Mm(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}Ox.className="PReLU",Go(Ox);class Rx extends Tv{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new sm("Non-default alpha value (".concat(t.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=dv(t);return pl(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Rx.className="ELU",Go(Rx);class Nx extends Tv{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=dv(t);return n.mul(ag(n.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}Nx.className="ThresholdedReLU",Go(Nx);class Mx extends Tv{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new mx).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=dv(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Dx(t,e,n){if("number"===typeof t)return am(t,e);if(t.length!==e)throw new rm("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(let r=0;r<e;++r){const s=t[r];if((i=s)!==parseInt(i.toString(),10))throw new rm("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(s))}return t;var i}function Px(t,e,n,i){if(null==t)return t;let r;return r="same"===n?t:t-(e+(e-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((r+i-1)/i)}function Fx(t,e,n,i){if(null==t)return null;if("valid"===i)t=t*e+sg([n-e,0]);else{if("same"!==i)throw new rm("Unsupport padding mode: ".concat(i,"."));t*=e}return t}function Lx(t,e){return da((()=>(Hm(e),"channelsFirst"===e?go(t,[0,2,3,1]):t)))}function Bx(t,e){return da((()=>(Hm(e),"channelsFirst"===e?go(t,[0,2,3,4,1]):t)))}function zx(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return da((()=>{if(null==s&&(s="channelsLast"),Hm(s),3!==t.shape.length)throw new rm("The input of a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead."));if(3!==e.shape.length)throw new rm("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new rm("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(e.shape.length," instead"));if("channelsFirst"===s&&(t=go(t,[0,2,1])),"causal"===r)throw new sm("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Kc(t,e,i,"same"===r?"same":"valid","NWC",o);return null!=n&&(a=bg(a,n)),a}))}function Ux(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return da((()=>{if(null==s&&(s="channelsLast"),Hm(s),3!==t.rank&&4!==t.rank)throw new rm("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new rm("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));let c=Lx(t,s);if("causal"===r)throw new sm("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=id({x:c,filter:e,strides:i,pad:"same"===r?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),"channelsFirst"===s&&(c=go(c,[0,3,1,2])),c}))}function jx(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return da((()=>{if(null==s&&(s="channelsLast"),Hm(s),4!==t.rank&&5!==t.rank)throw new rm("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new rm("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));let a=Bx(t,s);if("causal"===r)throw new sm("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Jc(a,e,i,"same"===r?"same":"valid","NDHWC",o),null!=n&&(a=bg(a,n)),"channelsFirst"===s&&(a=go(a,[0,4,1,2,3])),a}))}Mx.className="Softmax",Go(Mx);class Vx extends Tv{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Vx.verifyArgs(e),this.rank=t,_m(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new sm("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=Dx(e.kernelSize,t,"kernelSize"),this.strides=Dx(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,Xm(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Hm(this.dataFormat),this.activation=bx(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=Gg(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Pm(e.biasConstraint),this.biasRegularizer=kx(e.biasRegularizer),this.activityRegularizer=kx(e.activityRegularizer),this.dilationRate=Dx(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new rm("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new rm("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new rm("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(t){if(cm("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!Sm(t.kernelSize,"number",1,3))throw new rm("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:yx(this.activation),useBias:this.useBias,biasInitializer:Wg(this.biasInitializer),biasRegularizer:Ex(this.biasRegularizer),activityRegularizer:Ex(this.activityRegularizer),biasConstraint:Mm(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Wx extends Vx{constructor(t,e){super(t,e),this.kernel=null,Wx.verifyArgs(e),this.filters=e.filters,_m(this.filters,"filters"),this.kernelInitializer=Gg(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Pm(e.kernelConstraint),this.kernelRegularizer=kx(e.kernelRegularizer)}build(t){t=pv(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new rm("The channel dimension of the input should be defined. "+"Found ".concat(t[e]));const n=t[e],i=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return da((()=>{let e;t=dv(t);const n=null==this.bias?null:this.bias.read(),i=Em(this.activation.getClassName());if(null!=i&&2===this.rank)e=Ux(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(1===this.rank)e=zx(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=Ux(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new sm("convolutions greater than 3D are not implemented yet.");e=jx(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e}))}computeOutputShape(t){t=pv(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let r=0;r<n.length;++r){const t=Px(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(t)}let i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e),i.push(this.filters)):(i.push(this.filters),i=i.concat(e)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Wg(this.kernelInitializer),kernelRegularizer:Ex(this.kernelRegularizer),kernelConstraint:Mm(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new rm("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))}}class Gx extends Wx{constructor(t){super(2,t),Gx.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!Sm(t.kernelSize,"number",1,2))throw new rm("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))}}Gx.className="Conv2D",Go(Gx);class qx extends Wx{constructor(t){super(3,t),qx.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new rm("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))}}qx.className="Conv3D",Go(qx);class Hx extends Gx{constructor(t){if(super(t),this.inputSpec=[new xv({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new rm("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(4!==(t=pv(t)).length)throw new rm("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new rm("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],i=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new xv({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return da((()=>{let e=dv(t);if(4!==e.shape.length)throw new rm("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,i=n[0];let r,s;"channelsFirst"===this.dataFormat?(r=2,s=3):(r=1,s=2);const o=n[r],a=n[s],c=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],h=this.strides[1],d=[i,Fx(o,u,c,this.padding),Fx(a,h,l,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=go(e,[0,2,3,1]));let p=Zc(e,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=go(p,[0,3,1,2])),null!=this.bias&&(p=bg(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(t){const e=(t=pv(t)).slice();let n,i,r;"channelsFirst"===this.dataFormat?(n=1,i=2,r=3):(n=3,i=1,r=2);const s=this.kernelSize[0],o=this.kernelSize[1],a=this.strides[0],c=this.strides[1];return e[n]=this.filters,e[i]=Fx(e[i],a,s,this.padding),e[r]=Fx(e[r],c,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Hx.className="Conv2DTranspose",Go(Hx);class Xx extends Wx{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new rm("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new rm("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new rm("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(e.padding)));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=Gg(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=kx(e.depthwiseRegularizer),this.depthwiseConstraint=Pm(e.depthwiseConstraint),this.pointwiseInitializer=Gg(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=kx(e.pointwiseRegularizer),this.pointwiseConstraint=Pm(e.pointwiseConstraint)}build(t){if((t=pv(t)).length<this.rank+2)throw new rm("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new rm("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[e])));const n=t[e],i=this.kernelSize.concat([n,this.depthMultiplier]),r=[];for(let o=0;o<this.rank;++o)r.push(1);r.push(n*this.depthMultiplier,this.filters);const s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new xv({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return da((()=>{let e;if(t=dv(t),1===this.rank)throw new sm("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=go(t,[0,2,3,1])),e=Hu(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=bg(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=go(e,[0,3,1,2])),e}))}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Wg(this.depthwiseInitializer),t.pointwiseInitializer=Wg(this.pointwiseInitializer),t.depthwiseRegularizer=Ex(this.depthwiseRegularizer),t.pointwiseRegularizer=Ex(this.pointwiseRegularizer),t.depthwiseConstraint=Mm(this.depthwiseConstraint),t.pointwiseConstraint=Mm(this.pointwiseConstraint),t}}Xx.className="SeparableConv";class Yx extends Xx{constructor(t){super(2,t)}}Yx.className="SeparableConv2D",Go(Yx);class Kx extends Wx{constructor(t){super(1,t),Kx.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!Sm(t.kernelSize,"number",1,1))throw new rm("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))}}Kx.className="Conv1D",Go(Kx);class Qx extends Tv{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return da((()=>{if(t=dv(t),"channelsLast"===this.dataFormat){const e=hg(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return hg(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=hg(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return hg(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}Qx.className="Cropping2D",Go(Qx);class Zx extends Tv{constructor(t){var e;super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Hm(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,e=this.interpolation,wm(jm,"InterpolationFormat",e)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return da((()=>{let e=dv(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=go(e,[0,2,3,1]);const t=this.size[0]*n[2],i=this.size[1]*n[3],r="nearest"===this.interpolation?e.resizeNearestNeighbor([t,i]):e.resizeBilinear([t,i]);return go(r,[0,3,1,2])}{const t=this.size[0]*n[1],i=this.size[1]*n[2];return"nearest"===this.interpolation?e.resizeNearestNeighbor([t,i]):e.resizeBilinear([t,i])}}))}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}Zx.className="UpSampling2D",Go(Zx);class Jx extends Vx{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=Gg(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Pm(t.depthwiseConstraint),this.depthwiseRegularizer=kx(t.depthwiseRegularizer)}build(t){if((t=pv(t)).length<4)throw new rm("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new rm("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));const n=t[e],i=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return da((()=>{let e=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return da((()=>{null==r&&(r="channelsLast"),Hm(r);let o=Lx(t,r);if(4!==t.rank)throw new rm("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));if(4!==e.rank)throw new rm("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return o=ol(o,e,n,"same"===i?"same":"valid","NHWC",s),"channelsFirst"===r&&(o=go(o,[0,3,1,2])),o}))}(t=dv(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=bg(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e}))}computeOutputShape(t){t=pv(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=Px(e,this.kernelSize[0],this.padding,this.strides[0]),s=Px(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],i,r,s]:[t[0],r,s,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Wg(this.depthwiseInitializer),t.depthwiseRegularizer=Ex(this.depthwiseRegularizer),t.depthwiseConstraint=Mm(this.depthwiseRegularizer),t}}function $x(t,e,n,i){if(Array.isArray(t)){if(null!=e||null!=n)throw new rm("When inputs is an array, neither initialState or constants should be provided");null!=i&&(n=t.slice(t.length-i,t.length),t=t.slice(0,t.length-i)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=r(e),constants:n=r(n)}}function tb(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return da((()=>{const c=e.shape.length;if(c<3)throw new rm("Input should be at least 3D, but is ".concat(c,"D."));const l=[1,0].concat(og(2,c));if(e=go(e,l),null!=s)throw new sm("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=r&&(r=r.asType("bool").asType("float32"),r.rank===c-1&&(r=gl(r,-1)),r=go(r,l)),i&&(e=Bu(e,0),null!=r&&(r=Bu(r,0)));const u=[];let h,d=n;const p=e.shape[0],f=Sh(e);let m,g;null!=r&&(m=Sh(r));for(let e=0;e<p;++e){const n=f[e],i=da((()=>t(n,d)));if(null==r)h=i[0],d=i[1];else{const t=da((()=>{const t=m[e],n=fu(t).sub(t);return{output:i[0].mul(t).add(d[0].mul(n)),newStates:d.map(((e,r)=>i[1][r].mul(t).add(e.mul(n))))}}));h=t.output,d=t.newStates}a&&u.push(h)}if(a){g=lh(u,1)}return[h,g,d]}))}Jx.className="DepthwiseConv2D",Go(Jx);class eb extends Tv{constructor(t){let e;if(super(t),null==t.cell)throw new rm("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new lb({cells:t.cell}):t.cell,null==e.stateSize)throw new rm("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new xv({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return og(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((t=>null))}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){uv(t)&&(t=t[0]);let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let i;if(i=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const i of e)n.push([t[0],i]);return[i].concat(n)}return i}computeMask(t,e){return da((()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map((t=>null));return[t].concat(e)}return t}))}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new sm("Constants support is not implemented in RNN yet.");uv(t)&&(t=t[0]);const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new xv({shape:[e,null,...n]});const i=[t[0]].concat(t.slice(2));let r;if(this.cell.build(i),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!rt(this.stateSpec.map((t=>t.shape[t.shape.length-1])),r))throw new rm("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((t=>new xv({shape:[null,t]})));this.stateful&&this.resetStates()}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];da((()=>{if(!this.stateful)throw new nm("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new rm("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>du([n,t]))):this.states_=[du([n,this.cell.stateSize])];else if(null==t)pa(this.states_),null!=this.keptStates&&(pa(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>du([n,t]))):this.states_[0]=du([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new rm("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===e?this.keptStates.push(this.states_.slice()):pa(this.states_);for(let e=0;e<this.states_.length;++e){const i=t[e],r=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,s=[n,r];if(!rt(i.shape,s))throw new rm("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));this.states_[e]=i}}this.states_=this.states_.map((t=>fa(t.clone())))}))}apply(t,e){let n=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const r=$x(t,n,i,this.numConstants);t=r.inputs,n=r.initialState,i=r.constants;let s=[],o=[];if(null!=n){e.initialState=n,s=s.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new xv({shape:t.shape}));o=o.concat(this.stateSpec)}null!=i&&(e.constants=i,s=s.concat(i),this.numConstants=i.length);if(s[0]instanceof bv){const n=[t].concat(s),i=this.inputSpec.concat(o),r=this.inputSpec;this.inputSpec=i;const a=super.apply(n,e);return this.inputSpec=r,a}return super.apply(t,e)}call(t,e){return da((()=>{const n=null==e?null:e.mask,i=null==e?null:e.training;let r=null==e?null:e.initialState;t=dv(t),null==r&&(r=this.stateful?this.states_:this.getInitialState(t));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==s)throw new rm("RNN Layer has ".concat(s," state(s) but was passed ")+"".concat(r.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},a=tb(((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]}),t,r,this.goBackwards,n,null,this.unroll,this.returnSequences),c=a[0],l=a[1],u=a[2];this.stateful&&this.resetStates(u,i);const h=this.returnSequences?l:c;return this.returnState?[h].concat(u):h}))}getInitialState(t){return da((()=>{let e=du(t.shape);return e=zl(e,[1,2]),e=cg(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((t=>t>1?fg(e,[1,t]):e)):this.cell.stateSize>1?[fg(e,[1,this.cell.stateSize])]:[e]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===eb.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=zv(e.cell,n);return new t(Object.assign(e,{cell:i}))}}eb.className="RNN",Go(eb);class nb extends Tv{}class ib extends nb{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,_m(this.units,"units"),this.activation=bx(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Gg(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gg(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gg(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kx(t.kernelRegularizer),this.recurrentRegularizer=kx(t.recurrentRegularizer),this.biasRegularizer=kx(t.biasRegularizer),this.kernelConstraint=Pm(t.kernelConstraint),this.recurrentConstraint=Pm(t.recurrentConstraint),this.biasConstraint=Pm(t.biasConstraint),this.dropout=rg([1,sg([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=rg([1,sg([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=pv(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return da((()=>{if(2!==t.length)throw new rm("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));let n=t[1];t=t[0];const i=null!=e.training&&e.training;let r;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ub({ones:()=>fu(t),rate:this.dropout,training:i})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ub({ones:()=>fu(n),rate:this.recurrentDropout,training:i}));const s=this.dropoutMask,o=this.recurrentDropoutMask;r=gg(null!=s?Aa(t,s):t,this.kernel.read()),null!=this.bias&&(r=bg(r,this.bias.read())),null!=o&&(n=Aa(n,o));let a=Ea(r,gg(n,this.recurrentKernel.read()));return null!=this.activation&&(a=this.activation.apply(a)),[a,a]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yx(this.activation),useBias:this.useBias,kernelInitializer:Wg(this.kernelInitializer),recurrentInitializer:Wg(this.recurrentInitializer),biasInitializer:Wg(this.biasInitializer),kernelRegularizer:Ex(this.kernelRegularizer),recurrentRegularizer:Ex(this.recurrentRegularizer),biasRegularizer:Ex(this.biasRegularizer),activityRegularizer:Ex(this.activityRegularizer),kernelConstraint:Mm(this.kernelConstraint),recurrentConstraint:Mm(this.recurrentConstraint),biasConstraint:Mm(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}ib.className="SimpleRNNCell",Go(ib);class rb extends eb{constructor(t){t.cell=new ib(t),super(t)}call(t,e){return da((()=>{null!=this.cell.dropoutMask&&(pa(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(pa(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,r=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:r})}))}static fromConfig(t,e){return new t(e)}}rb.className="SimpleRNN",Go(rb);class sb extends nb{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new rm("GRUCell does not support reset_after parameter set to true.");this.units=t.units,_m(this.units,"units"),this.activation=bx(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=bx(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Gg(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gg(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gg(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kx(t.kernelRegularizer),this.recurrentRegularizer=kx(t.recurrentRegularizer),this.biasRegularizer=kx(t.biasRegularizer),this.kernelConstraint=Pm(t.kernelConstraint),this.recurrentConstraint=Pm(t.recurrentConstraint),this.biasConstraint=Pm(t.biasConstraint),this.dropout=rg([1,sg([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=rg([1,sg([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=pv(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return da((()=>{if(2!==t.length)throw new rm("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=null!=e.training&&e.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ub({ones:()=>fu(t),rate:this.dropout,training:n,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ub({ones:()=>fu(i),rate:this.recurrentDropout,training:n,count:3}));const r=this.dropoutMask,s=this.recurrentDropoutMask;let o,a,c;0<this.dropout&&this.dropout<1&&(t=Aa(t,r[0]));let l=gg(t,this.kernel.read());this.useBias&&(l=bg(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=Aa(i,s[0]));const u=this.recurrentKernel.read(),[h,d]=sh(u,[2*this.units,this.units],u.rank-1),p=gg(i,h),[f,m,g]=sh(l,3,l.rank-1),[v,y]=sh(p,2,p.rank-1);o=this.recurrentActivation.apply(Ea(f,v)),a=this.recurrentActivation.apply(Ea(m,y));const x=gg(Aa(a,i),d);c=this.activation.apply(Ea(g,x));const b=Ea(Aa(o,i),Aa(Ea(1,Pl(o)),c));return[b,b]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yx(this.activation),recurrentActivation:yx(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Wg(this.kernelInitializer),recurrentInitializer:Wg(this.recurrentInitializer),biasInitializer:Wg(this.biasInitializer),kernelRegularizer:Ex(this.kernelRegularizer),recurrentRegularizer:Ex(this.recurrentRegularizer),biasRegularizer:Ex(this.biasRegularizer),activityRegularizer:Ex(this.activityRegularizer),kernelConstraint:Mm(this.kernelConstraint),recurrentConstraint:Mm(this.recurrentConstraint),biasConstraint:Mm(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}sb.className="GRUCell",Go(sb);class ob extends eb{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new sb(t),super(t)}call(t,e){return da((()=>{null!=this.cell.dropoutMask&&(pa(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(pa(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,r=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:r})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}ob.className="GRU",Go(ob);class ab extends nb{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,_m(this.units,"units"),this.activation=bx(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=bx(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Gg(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Gg(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Gg(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=kx(t.kernelRegularizer),this.recurrentRegularizer=kx(t.recurrentRegularizer),this.biasRegularizer=kx(t.biasRegularizer),this.kernelConstraint=Pm(t.kernelConstraint),this.recurrentConstraint=Pm(t.recurrentConstraint),this.biasConstraint=Pm(t.biasConstraint),this.dropout=rg([1,sg([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=rg([1,sg([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=pv(t))[t.length-1];let i;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;i=new((e=class extends Eg{apply(e,i){const r=t.apply([n]),s=(new kg).apply([n]),o=t.apply([2*n]);return pg(pg(r,s),o)}}).className="CustomInit",e)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return da((()=>{const n=null!=e.training&&e.training;if(3!==t.length)throw new rm("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));let i=t[1];const r=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ub({ones:()=>fu(t),rate:this.dropout,training:n,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ub({ones:()=>fu(i),rate:this.recurrentDropout,training:n,count:4}));const s=this.dropoutMask,o=this.recurrentDropoutMask;let a,c,l,u;0<this.dropout&&this.dropout<1&&(t=Aa(t,s[0]));let h=gg(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=Aa(i,o[0])),h=Ea(h,gg(i,this.recurrentKernel.read())),this.useBias&&(h=bg(h,this.bias.read()));const[d,p,f,m]=sh(h,4,h.rank-1);a=this.recurrentActivation.apply(d),c=this.recurrentActivation.apply(p),l=Ea(Aa(c,r),Aa(a,this.activation.apply(f))),u=this.recurrentActivation.apply(m);const g=Aa(u,this.activation.apply(l));return[g,g,l]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yx(this.activation),recurrentActivation:yx(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Wg(this.kernelInitializer),recurrentInitializer:Wg(this.recurrentInitializer),biasInitializer:Wg(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Ex(this.kernelRegularizer),recurrentRegularizer:Ex(this.recurrentRegularizer),biasRegularizer:Ex(this.biasRegularizer),activityRegularizer:Ex(this.activityRegularizer),kernelConstraint:Mm(this.kernelConstraint),recurrentConstraint:Mm(this.recurrentConstraint),biasConstraint:Mm(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}ab.className="LSTMCell",Go(ab);class cb extends eb{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new ab(t),super(t)}call(t,e){return da((()=>{null!=this.cell.dropoutMask&&(pa(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(pa(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,r=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:r})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}cb.className="LSTM",Go(cb);class lb extends nb{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return da((()=>{let n=t.slice(1);const i=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?i.push(n.splice(0,t.stateSize.length)):i.push(n.splice(0,1));i.reverse();const r=[];let s;for(let o=0;o<this.cells.length;++o){const a=this.cells[o];n=i[o],s=0===o?[t[0]].concat(n):[s[0]].concat(n),s=a.call(s,e),r.push(s.slice(1))}n=[];for(const t of r.slice().reverse())n.push(...t);return[s[0]].concat(n)}))}build(t){let e;uv(t)&&(t=t[0]),this.cells.forEach(((n,i)=>{Zm("RNNCell_".concat(i),(()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map((t=>({className:t.getClassName(),config:t.getConfig()})))};return Object.assign({},t,e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=[];for(const r of e.cells)i.push(zv(r,n));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return vv(t)}setWeights(t){const e=[];for(const n of this.cells){const i=n.weights.length,r=t.splice(i);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],r[t]])}yv(e)}}function ub(t){const{ones:e,rate:n,training:i=!1,count:r=1}=t,s=()=>wg(e(),n),o=()=>Sg(s,e,i);if(!r||r<=1)return fa(o().clone());return Array(r).fill(void 0).map(o).map((t=>fa(t.clone())))}lb.className="StackedRNNCells",Go(lb);var hb=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};class db extends eb{constructor(t){if(t.unroll)throw new sm("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new sm("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new xv({ndim:5})]}call(t,e){return da((()=>{if(null!=this.cell.dropoutMask&&(pa(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(pa(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new rm("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,i=null==e?null:e.training,r=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:r})}))}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return da((()=>{const{stateSize:e}=this.cell,n=t.shape,i=this.computeSingleOutputShape(n),r=du([i[0],...i.slice(2)]);return Array.isArray(e)?Array(e.length).fill(r):[r]}))}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];da((()=>{if(!this.stateful)throw new nm("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,i=this.computeSingleOutputShape(n),r=[i[0],...i.slice(2)];if(null==n[0])throw new rm("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>du(r))):this.states_=[du(r)];else if(null==t)pa(this.states_),null!=this.keptStates&&(pa(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>du(r))):this.states_[0]=du(r);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new rm("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));e?this.keptStates.push(this.states_.slice()):pa(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],i=r;if(!rt(n.shape,i))throw new rm("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(i,", received shape=").concat(n.shape));this.states_[e]=n}}this.states_=this.states_.map((t=>fa(t.clone())))}))}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:i,padding:r,strides:s,dilationRate:o}=this.cell,a="channelsFirst"===e,c=t[a?3:2],l=t[a?4:3],u=Px(c,i[0],r,s[0],o[0]),h=Px(l,i[1],r,s[1],o[1]);return[...t.slice(0,2),...a?[n,u,h]:[u,h,n]]}}db.className="ConvRNN2D";class pb extends ab{constructor(t){const{filters:e,kernelSize:n,strides:i,padding:r,dataFormat:s,dilationRate:o}=t;super(Object.assign({},t,{units:e})),this.filters=e,_m(this.filters,"filters"),this.kernelSize=Dx(n,2,"kernelSize"),this.kernelSize.forEach((t=>_m(t,"kernelSize"))),this.strides=Dx(i||1,2,"strides"),this.strides.forEach((t=>_m(t,"strides"))),this.padding=r||"valid",Xm(this.padding),this.dataFormat=s||"channelsLast",Hm(this.dataFormat),this.dilationRate=Dx(o||1,2,"dilationRate"),this.dilationRate.forEach((t=>_m(t,"dilationRate")))}build(t){var e;t=pv(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new rm("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));const i=t[n],r=this.kernelSize.concat([i,4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const s=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,i=this.filters;t=new((e=class extends Eg{apply(t,e){return dg([n.apply([i]),pu([i]),n.apply([2*i])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return da((()=>{if(3!==t.length)throw new rm("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=e.training||!1,i=t[0],r=t[1],s=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ub({ones:()=>fu(i),rate:this.dropout,training:n,count:4}));const o=this.dropoutMask,a=(t,e,n)=>e&&e[n]?Aa(e[n],t):t;let c=a(i,o,0),l=a(i,o,1),u=a(i,o,2),h=a(i,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ub({ones:()=>fu(r),rate:this.recurrentDropout,training:n,count:4}));const d=this.recurrentDropoutMask;let p=a(r,d,0),f=a(r,d,1),m=a(r,d,2),g=a(r,d,3);const[v,y,x,b]=sh(this.kernel.read(),4,3),[w,S,_,T]=this.useBias?sh(this.bias.read(),4):[null,null,null,null];c=this.inputConv(c,v,w,this.padding),l=this.inputConv(l,y,S,this.padding),u=this.inputConv(u,x,_,this.padding),h=this.inputConv(h,b,T,this.padding);const[E,C,k,A]=sh(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,E),f=this.recurrentConv(f,C),m=this.recurrentConv(m,k),g=this.recurrentConv(g,A);const I=this.recurrentActivation.apply(Ea(c,p)),O=this.recurrentActivation.apply(Ea(l,f)),R=Ea(Aa(O,s),Aa(I,this.activation.apply(Ea(u,m)))),N=Aa(this.recurrentActivation.apply(Ea(h,g)),this.activation.apply(R));return[N,N,R]}))}getConfig(){const t=super.getConfig(),{units:e}=t,n=hb(t,["units"]),i={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,i)}inputConv(t,e,n,i){const r=Yc(t,e,this.strides,i||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?bg(r,n,this.dataFormat):r}recurrentConv(t,e){return Yc(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}pb.className="ConvLSTM2DCell",Go(pb);class fb extends db{constructor(t){const e=new pb(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}fb.className="ConvLSTM2D",Go(fb);class mb extends Tv{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let i=0;i<this.noiseShape.length;++i)n.push(null==this.noiseShape[i]?e[i]:this.noiseShape[i]);return n}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,i=this.getNoiseShape(n);return Sg((()=>wg(n,this.rate,i,this.seed)),(()=>n),t)}return t}))}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}mb.className="Dropout",Go(mb);class gb extends mb{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}gb.className="SpatialDropout1D",Go(gb);class vb extends Tv{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,_m(this.units,"units"),this.activation=bx(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=Gg(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Gg(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Pm(t.kernelConstraint),this.biasConstraint=Pm(t.biasConstraint),this.kernelRegularizer=kx(t.kernelRegularizer),this.biasRegularizer=kx(t.biasRegularizer),this.activityRegularizer=kx(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=pv(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=pv(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t),i=Em(this.activation.getClassName());let r;return null!=i?r=gg(n,this.kernel.read(),i,this.bias?this.bias.read():null):(r=gg(n,this.kernel.read()),null!=this.bias&&(r=bg(r,this.bias.read())),null!=this.activation&&(r=this.activation.apply(r))),r}))}getConfig(){const t={units:this.units,activation:yx(this.activation),useBias:this.useBias,kernelInitializer:Wg(this.kernelInitializer),biasInitializer:Wg(this.biasInitializer),kernelRegularizer:Ex(this.kernelRegularizer),biasRegularizer:Ex(this.biasRegularizer),activityRegularizer:Ex(this.activityRegularizer),kernelConstraint:Mm(this.kernelConstraint),biasConstraint:Mm(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}vb.className="Dense",Go(vb);class yb extends Tv{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=pv(t);for(const e of t.slice(1))if(null==e)throw new rm('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],ng(t,1)]}call(t,e){return da((()=>{this.invokeCallHook(t,e);let n=dv(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=n.transpose(t)}return function(t){if(t.rank<=1)throw new rm("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));const e=[t.shape[0],ng(t.shape,1)];return t.reshape(e)}(n)}))}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}yb.className="Flatten",Go(yb);class xb extends Tv{constructor(t){super(t),this.supportsMasking=!0,this.activation=bx(t.activation)}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t);return this.activation.apply(n)}))}getConfig(){const t={activation:yx(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}xb.className="Activation",Go(xb);class bb extends Tv{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return da((()=>{return t=dv(t),e=t,n=this.n,da((()=>{if(2!==e.shape.length)throw new rm("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return fg(cg(e,1),[1,n,1])}));var e,n}))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}bb.className="RepeatVector",Go(bb);class wb extends Tv{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",i=e.slice();let r=1,s=null;for(let a=0;a<i.length;++a){const t=i[a];if(this.isUnknown(t)){if(null!==s)throw new rm("Can only specifiy one unknown dimension.");s=a}else r*=t}const o=ng(t);if(null!==s){if(0===r||o%r!==0)throw new rm(n);i[s]=o/r}else if(o!==r)throw new rm(n);return i}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t),i=n.shape,r=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return n.reshape(r)}))}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}wb.className="Reshape",Go(wb);class Sb extends Tv{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(t.dims," instead."));const e=og(1,t.dims.length+1);if(!rt(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new xv({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=pv(t)).slice();return this.dims.forEach(((n,i)=>{e[i+1]=t[n]})),e}call(t,e){return go(dv(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}Sb.className="Permute",Go(Sb);class _b extends Tv{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=dv(t);return oc(hu(n,this.maskValue),-1)}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t),i=oc(hu(n,this.maskValue),-1,!0);return n.mul(i.asType(n.dtype))}))}}_b.className="Masking",Go(_b);class Tb extends Tv{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(hm(t.inputLength))}this.inputDim=t.inputDim,_m(this.inputDim,"inputDim"),this.outputDim=t.outputDim,_m(this.outputDim,"outputDim"),this.embeddingsInitializer=Gg(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=kx(t.embeddingsRegularizer),this.activityRegularizer=kx(t.activityRegularizer),this.embeddingsConstraint=Pm(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return da((()=>this.maskZero?(t=dv(t),hu(t,Ra(t))):null))}computeOutputShape(t){if(t=pv(t),null==this.inputLength)return[...t,this.outputDim];const e=hm(this.inputLength);if(e.length!==t.length-1)throw new rm('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));{let n=0;for(let i=0;i<e.length;++i){const r=e[i],s=t[i+1];if(null!=r&&null!=s&&r!==s)throw new rm('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==r&&(e[n]=s),n++}}return[t[0],...e,this.outputDim]}call(t,e){return da((()=>{this.invokeCallHook(t,e);let n=dv(t);"int32"!==n.dtype&&(n=ag(n,"int32"));return vg(this.embeddings.read(),n.as1D()).reshape(pv(this.computeOutputShape(n.shape)))}))}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Wg(this.embeddingsInitializer),embeddingsRegularizer:Ex(this.embeddingsRegularizer),activityRegularizer:Ex(this.activityRegularizer),embeddingsConstraint:Mm(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}Tb.className="Embedding",Go(Tb);class Eb extends Tv{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new sm}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let i=0;i<e.length;++i){const r=t[t.length-e.length+i],s=e[i];if(null==r||null==s||r<0||s<0)n.push(null);else if(1===r)n.push(s);else if(1===s)n.push(r);else{if(r!==s)throw new rm("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(r)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[pv(t)]),t.length<2)throw new rm("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));let e=[];for(const r of t)null!=r&&null!==r[0]&&e.push(r[0]);if(e=xm(e),e.length>1)throw new rm("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));let n=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const e=null==t[r]?null:t[r].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const i=t.map((t=>t.length));-1===t.indexOf(null)&&1===xm(i).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return da((()=>{if(this.reshapeRequired){const e=[],n=t.map((t=>t.rank));if(-1===n.indexOf(null)){const i=sg(n);for(let n of t){const t=n.rank;for(let e=0;e<i-t;++e)n=cg(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const s of t){const t=s.rank;if(null==t){const t=s.shape,i=t[0],r=t.slice(1).concat([i]);let o=s.reshape([i].concat(ng(t.slice(1))));o=go(o,[1,0]),o=o.reshape(r),e.push(o),n=!0}else if(t>1){const i=og(1,t).concat([0]);e.push(go(s,i)),n=!0}else e.push(s)}let i=this.mergeFunction(e);const r=i.rank;if(n)if(null==r){const t=i.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));i=go(i.reshape([-1,e]),[1,0]).reshape(n)}else if(r>1){const t=[r-1].concat(og(0,r-1));i=go(i,t)}return i}}return this.mergeFunction(t)}))}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const n=null==t[i]?null:t[i].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const i of t)null!=i&&null!==i[0]&&n.push(i[0]);return n=xm(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return da((()=>{if(null==e)return null;if(!Array.isArray(e))throw new rm("`mask` should be an Array");if(!Array.isArray(t))throw new rm("`inputs` should be an Array");if(e.length!==t.length)throw new rm("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every((t=>null==t)))return null;let n=(e=e.map((t=>null==t?t:gl(t,0))))[0];for(let t=1;t<e.length-1;++t)n=Ql(n,e[t]);return n}))}}class Cb extends Eb{constructor(t){super(t)}mergeFunction(t){return da((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Ea(e,t[n]);return e}))}}Cb.className="Add",Go(Cb);class kb extends Eb{constructor(t){super(t)}mergeFunction(t){return da((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Aa(e,t[n]);return e}))}}kb.className="Multiply",Go(kb);class Ab extends Eb{constructor(t){super(t)}mergeFunction(t){return da((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Ea(e,t[n]);return Aa(1/t.length,e)}))}}Ab.className="Average",Go(Ab);class Ib extends Eb{constructor(t){super(t)}mergeFunction(t){return da((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=Za(e,t[n]);return e}))}}Ib.className="Maximum",Go(Ib);class Ob extends Eb{constructor(t){super(t)}mergeFunction(t){return da((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=su(e,t[n]);return e}))}}Ob.className="Minimum",Go(Ob);class Rb extends Eb{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new rm("A `Concatenate` layer should be called on a list of at least 2 inputs");let e=!0;for(const i of t)if(null!=i){e=!1;break}if(e)return;const n=[];for(let i=0;i<t.length;++i){const e=t[i].slice();e.splice(this.axis,1);let r=!1;for(const t of n)if(rt(t,e)){r=!0;break}r||n.push(e)}if(n.length>1)throw new rm("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return da((()=>dg(t,this.axis)))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new rm("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),i=this.axis<0?n.length+this.axis:this.axis;for(const r of e.slice(1)){if(null==n[i]||null==r[i]){n[i]=null;break}n[i]+=r[i]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new rm("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new rm("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new rm("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return da((()=>{let n=!0;if(e.forEach((t=>{null==t||(n=!1)})),n)return null;const i=[];for(let s=0;s<t.length;++s)null==e[s]?i.push(fu(t[s]).asType("bool")):e[s].rank<t[s].rank?i.push(gl(e[s],-1)):i.push(e[s]);const r=Oc(i,this.axis);return sc(r,-1,!1)}))}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Nb(t,e){for(;t<0;)t+=e;return t}Rb.className="Concatenate",Go(Rb);class Mb extends Eb{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){J(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new sm("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);if(e[i[0]]!==n[i[1]])throw new rm("Dimension incompatibility: "+"".concat(e[i[0]]," !== ").concat(n[i[1]]))}mergeFunction(t){if(2!==t.length)throw new rm("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));let e,n=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map(((e,n)=>Nb(e,t[n].shape.length))):[Nb(this.axes,n.shape.length),Nb(this.axes,i.shape.length)],this.normalize&&(n=Uv(n,e[0]),i=Uv(i,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new sm("batchDot is not implemented for tensors of 4D or higher rank yet");if(J(t.shape.length>=2,(()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length))),J(t.shape.length>=2,(()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length))),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new sm("batchDot is not implemented for complex64-type Tensors yet.");const i=t.shape.length,r=e.shape.length;null==n&&(n=[i-1,r-2]);const s=n;return da((()=>{let n,o;if(i>r){n=i-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(r>i){n=r-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=s[0]===s[1]?t.mul(e).sum(s[0]):t.transpose([1,0]).mul(e).sum(s[1]);else{const n=s[0]!==t.shape.length-1,i=s[1]===e.shape.length-1;o=t.matMul(e,n,i)}if(n>0){let t;t=i>r?i+r-3:i-1;const e=[];for(let i=t;i<t+n;++i)e.push(i);o=o.squeeze(e)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,i,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[Nb(this.axes,t.length),Nb(this.axes,e.length)],n}computeOutputShape(t){J(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new sm("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);e.splice(i[0],1),n.splice(i[1],1),n.splice(0,1);const r=e.concat(n);return 1===r.length&&r.push(1),r}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}Mb.className="Dot",Go(Mb);class Db extends Tv{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t);return Sg((()=>mg(n.shape,0,this.stddev).add(n)),(()=>n),e.training||!1)}))}}Db.className="GaussianNoise",Go(Db);class Pb extends Tv{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return da((()=>{this.invokeCallHook(t,e);const n=dv(t);if(this.rate>0&&this.rate<1){return Sg((()=>{const t=Math.sqrt(this.rate/(1-this.rate));return n.mul(mg(n.shape,1,t))}),(()=>n),e.training||!1)}return n}))}}Pb.className="GaussianDropout",Go(Pb);class Fb extends Tv{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||dv(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return da((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),i=()=>{const e=dv(t),i=-1.7580993408473766;let r=_l(Nu(n),this.rate);r=ag(r,"float32");const s=((1-this.rate)*(1+this.rate*i**2))**-.5,o=-s*i*this.rate;return e.mul(r).add(r.add(-1).mul(i)).mul(s).add(o)};return Sg(i,(()=>dv(t)),e.training||!1)}return t}))}}function Lb(t,e,n,i,r){let s,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===t.rank)s=Lc(t,e,n,i,r,o);else if(3===t.rank)s=Bc(t,e,n,i,r,o);else{if(4!==t.rank)throw new sm("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");s=zc(t,e,n,i,r,o)}return s}function Bb(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return rt(i.slice().sort(),og(0,t.rank-1))?function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return da((()=>{const s=cu(t,i),o=s.mean,a=s.variance;return[Lb(t,o,a,n,e,r),o,a]}))}(t,e,n,i,r):function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return da((()=>{const s=cu(t,i),o=s.mean,a=s.variance,c=[];for(const e of og(0,t.rank))-1!==i.indexOf(e)?c.push(1):c.push(t.shape[e]);const l=o.reshape(c),u=a.reshape(c),h=null==e?null:e.reshape(c),d=null==n?null:n.reshape(c);return[Lb(t,l,u,d,h,r),o,a]}))}(t,e,n,i,r)}Fb.className="AlphaDropout",Go(Fb);class zb extends Tv{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Gg(t.betaInitializer||"zeros"),this.gammaInitializer=Gg(t.gammaInitializer||"ones"),this.movingMeanInitializer=Gg(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Gg(t.movingVarianceInitializer||"ones"),this.betaConstraint=Pm(t.betaConstraint),this.gammaConstraint=Pm(t.gammaConstraint),this.betaRegularizer=kx(t.betaRegularizer),this.gammaRegularizer=kx(t.gammaRegularizer)}build(t){t=pv(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new rm("Axis ".concat(e," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new xv({ndim:t.length,axes:{[e]:n}})];const i=[n];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return da((()=>{const n=null!=e.training&&e.training,i=dv(t),r=i.shape,s=r.length,o=og(0,s),a=this.axis>=0?this.axis:this.axis+s;o.splice(a,1);const c=am(1,s);c[a]=r[a];const l=o.slice();l.sort();const u=!rt(l,og(0,s).slice(0,s-1));if(!n)return(()=>{if(u){const t=this.movingMean.read().reshape(c),e=this.movingVariance.read().reshape(c),n=this.center?this.beta.read().reshape(c):null,r=this.scale?this.gamma.read().reshape(c):null;return Lb(i,t,e,n,r,this.epsilon)}return Lb(i,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[h,d,p]=Bb(i,this.gamma.read(),this.beta.read(),o,this.epsilon),f=(t,e,n)=>{da((()=>{const i=1-n,r=t.read(),s=r.sub(e).mul(i);t.write(r.sub(s))}))};return(()=>{f(this.movingMean,d,this.momentum),f(this.movingVariance,p,this.momentum)})(),h}))}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Wg(this.betaInitializer),gammaInitializer:Wg(this.gammaInitializer),movingMeanInitializer:Wg(this.movingMeanInitializer),movingVarianceInitializer:Wg(this.movingVarianceInitializer),betaRegularizer:Ex(this.betaRegularizer),gammaRegularizer:Ex(this.gammaRegularizer),betaConstraint:Mm(this.betaConstraint),gammaConstraint:Mm(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}zb.className="BatchNormalization",Go(zb);class Ub extends Tv{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Gg(t.betaInitializer||"zeros"),this.gammaInitializer=Gg(t.gammaInitializer||"ones"),this.betaRegularizer=kx(t.betaRegularizer),this.gammaRegularizer=kx(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=pv(t)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=e);for(const i of this.axis)if(i<0||i>=e)throw new Error("Invalid axis: ".concat(i));if(this.axis.length!==xm(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map((e=>t[e]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}call(t,e){const n=dv(t),i=n.shape,r=i.length;return da((()=>{let{mean:t,variance:e}=cu(n,this.axis,!0);const s=am(1,r);for(const n of this.axis)s[n]=i[n];const o=t=>null!=t&&t.shape.length!==r&&this.axis!==[r-1]?t.reshape(s):t;let a=o(this.gamma.read()),c=o(this.beta.read());const l=[],u=[];for(let n=0;n<r;++n)-1!==this.axis.indexOf(n)?(l.push(i[n]),u.push(1)):(l.push(1),u.push(i[n]));return t=t.tile(l),e=e.tile(l),a=a.tile(u),c=c.tile(u),Lb(n,t,e,c,a,this.epsilon)}))}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Wg(this.betaInitializer),gammaInitializer:Wg(this.gammaInitializer),betaRegularizer:Ex(this.betaRegularizer),gammaRegularizer:Ex(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}Ub.className="LayerNormalization",Go(Ub);class jb extends Tv{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new rm("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(t.padding.length," array."));let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new rm("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(t.padding[0].length," array."));if(e=t.padding[0],2!==t.padding[1].length)throw new rm("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(t.padding[1].length," array."));n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new xv({ndim:4})]}computeOutputShape(t){let e,n;return t=pv(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return da((()=>{return e=dv(t),n=this.padding,i=this.dataFormat,da((()=>{if(4!==e.rank)throw new rm("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new rm("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new rm("Unknown data format: ".concat(i,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let t;return t="channelsFirst"===i?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],gu(e,t)}));var e,n,i}))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function Vb(t,e,n,i,r,s){return da((()=>{let o;Hm(r),Ym(s),Xm(i),null==n&&(n=[1,1]),null==i&&(i="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),t=Lx(t,r);const a="same"===i?"same":"valid";return o="max"===s?tu(t,e,n,a):Ac(t,e,n,a),"channelsFirst"===r&&(o=go(o,[0,3,1,2])),o}))}function Wb(t,e,n,i,r,s){return da((()=>{let o;Hm(r),Ym(s),Xm(i),null==n&&(n=[1,1,1]),null==i&&(i="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),t=Bx(t,r);const a="same"===i?"same":"valid";return o="max"===s?eu(t,e,n,a):Ic(t,e,n,a),"channelsFirst"===r&&(o=go(o,[0,4,1,2,3])),o}))}jb.className="ZeroPadding2D",Go(jb);class Gb extends Tv{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new rm("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.poolSize)));this.poolSize=t.poolSize}if(_m(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new rm("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.strides)));this.strides=t.strides}_m(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,Xm(this.padding),this.inputSpec=[new xv({ndim:3})]}computeOutputShape(t){const e=Px((t=pv(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return da((()=>{this.invokeCallHook(t,e),t=cg(dv(t),2);const n=this.poolingFunction(dv(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return ch(n,[2])}))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class qb extends Gb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Vb(t,e,n,i,r,"max")}}qb.className="MaxPooling1D",Go(qb);class Hb extends Gb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Vb(t,e,n,i,r,"avg")}}Hb.className="AveragePooling1D",Go(Hb);class Xb extends Tv{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new rm("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides];_m(this.poolSize,"poolSize"),_m(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Hm(this.dataFormat),Xm(this.padding),this.inputSpec=[new xv({ndim:4})]}computeOutputShape(t){t=pv(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Px(e,this.poolSize[0],this.padding,this.strides[0]),n=Px(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return da((()=>(this.invokeCallHook(t,e),this.poolingFunction(dv(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Yb extends Xb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Vb(t,e,n,i,r,"max")}}Yb.className="MaxPooling2D",Go(Yb);class Kb extends Xb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Vb(t,e,n,i,r,"avg")}}Kb.className="AveragePooling2D",Go(Kb);class Qb extends Tv{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new rm("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];_m(this.poolSize,"poolSize"),_m(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Hm(this.dataFormat),Xm(this.padding),this.inputSpec=[new xv({ndim:5})]}computeOutputShape(t){t=pv(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Px(e,this.poolSize[0],this.padding,this.strides[0]),n=Px(n,this.poolSize[1],this.padding,this.strides[1]),i=Px(i,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,i]:[t[0],e,n,i,t[4]]}call(t,e){return da((()=>(this.invokeCallHook(t,e),this.poolingFunction(dv(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Zb extends Qb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Wb(t,e,n,i,r,"max")}}Zb.className="MaxPooling3D",Go(Zb);class Jb extends Qb{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return Hm(r),Xm(i),Wb(t,e,n,i,r,"avg")}}Jb.className="AveragePooling3D",Go(Jb);class $b extends Tv{constructor(t){super(t),this.inputSpec=[new xv({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new sm}}class tw extends $b{constructor(t){super(t||{})}call(t,e){return da((()=>{const e=dv(t);return iu(e,1)}))}}tw.className="GlobalAveragePooling1D",Go(tw);class ew extends $b{constructor(t){super(t||{})}call(t,e){return da((()=>{const e=dv(t);return Bl(e,1)}))}}ew.className="GlobalMaxPooling1D",Go(ew);class nw extends Tv{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Hm(this.dataFormat),this.inputSpec=[new xv({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new sm}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class iw extends nw{call(t,e){return da((()=>{const e=dv(t);return"channelsLast"===this.dataFormat?iu(e,[1,2]):iu(e,[2,3])}))}}iw.className="GlobalAveragePooling2D",Go(iw);class rw extends nw{call(t,e){return da((()=>{const e=dv(t);return"channelsLast"===this.dataFormat?Bl(e,[1,2]):Bl(e,[2,3])}))}}rw.className="GlobalMaxPooling2D",Go(rw);class sw extends Tv{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=zv(e.layer,n);delete e.layer;const r={layer:i};return Object.assign(r,e),new t(r)}}class ow extends sw{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=pv(t)).length<3)throw new rm("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(t)));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=pv(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),i=t[1];return[n[0],i].concat(n.slice(1))}call(t,e){return da((()=>tb(((t,n)=>[dv(this.layer.call(t,e)),[]]),t=dv(t),[],!1,null,null,!1,!0)[1]))}}ow.className="TimeDistributed",Go(ow);class aw extends sw{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=zv(n),e.goBackwards=!0!==e.goBackwards;const i={};var r;if(i.className=t.layer.getClassName(),i.config=e,this.backwardLayer=zv(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,r=this.mergeMode,wm(Gm,"BidirectionalMergeMode",r),t.weights)throw new sm("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,i,r=this.forwardLayer.computeOutputShape(t);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),this.returnState?(i=r.slice(1),e=r[0]):e=r[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(i).concat(i.slice()):[e].concat(i).concat(i.slice()):um(n)}apply(t,e){let n=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const r=$x(t,n,i,this.numConstants);if(t=r.inputs,n=r.initialState,i=r.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==i)return super.apply(t,e);const s=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new rm("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,s.push(...n);const i=n.map((t=>new xv({shape:t.shape})));this.forwardLayer.stateSpec=i.slice(0,t/2),this.backwardLayer.stateSpec=i.slice(t/2),o.push(...i)}if(null!=i)throw new sm("Support for constants in Bidirectional layers is not implemented yet.");const a=s[0]instanceof bv;for(const c of s)if(c instanceof bv!==a)throw new rm("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(a){const n=[t].concat(s),i=this.inputSpec.concat(o),r=this.inputSpec;this.inputSpec=i;const a=super.apply(n,e);return this.inputSpec=r,a}return super.apply(t,e)}call(t,e){return da((()=>{const n=e.initialState;let i,r,s,o;if(null==n)i=this.forwardLayer.call(t,e),r=this.backwardLayer.call(t,e);else{const s=n.slice(0,n.length/2),o=n.slice(n.length/2);i=this.forwardLayer.call(t,Object.assign(e,{initialState:s})),r=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(i)&&(s=i.slice(1).concat(r.slice(1))),i=i[0],r=r[0]),this.returnSequences&&(r=Bu(r,1)),"concat"===this.mergeMode?o=dg([i,r]):"sum"===this.mergeMode?o=Ea(i,r):"ave"===this.mergeMode?o=Aa(.5,Ea(i,r)):"mul"===this.mergeMode?o=Aa(i,r):null==this.mergeMode&&(o=[i,r]),this.returnState?null==this.mergeMode?o.concat(s):[o].concat(s):o}))}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Zm(this.forwardLayer.name,(()=>{this.forwardLayer.build(t)})),Zm(this.backwardLayer.name,(()=>{this.backwardLayer.build(t)})),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map((t=>null));return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=zv(e.layer);if(delete e.layer,null!=e.numConstants)throw new sm("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=e;return i.layer=n,new t(i)}}function cw(t){return new Cv(t)}function lw(t){return new Rx(t)}function uw(t){return new Ax(t)}function hw(t){return new Ix(t)}function dw(t){return new Ox(t)}function pw(t){return new Mx(t)}function fw(t){return new Nx(t)}function mw(t){return new Kx(t)}function gw(t){return new Gx(t)}function vw(t){return new Hx(t)}function yw(t){return new qx(t)}function xw(t){return new Yx(t)}function bw(t){return new Qx(t)}function ww(t){return new Zx(t)}function Sw(t){return new Jx(t)}function _w(t){return new xb(t)}function Tw(t){return new vb(t)}function Ew(t){return new mb(t)}function Cw(t){return new gb(t)}function kw(t){return new yb(t)}function Aw(t){return new bb(t)}function Iw(t){return new wb(t)}function Ow(t){return new Sb(t)}function Rw(t){return new Tb(t)}function Nw(t){return new Cb(t)}function Mw(t){return new Ab(t)}function Dw(t){return new Rb(t)}function Pw(t){return new Ib(t)}function Fw(t){return new Ob(t)}function Lw(t){return new kb(t)}function Bw(t){return new Mb(t)}function zw(t){return new zb(t)}function Uw(t){return new Ub(t)}function jw(t){return new jb(t)}function Vw(t){return new Hb(t)}function Ww(t){return Vw(t)}function Gw(t){return Vw(t)}function qw(t){return new Kb(t)}function Hw(t){return qw(t)}function Xw(t){return qw(t)}function Yw(t){return new Jb(t)}function Kw(t){return Yw(t)}function Qw(t){return Yw(t)}function Zw(t){return new tw(t)}function Jw(t){return new iw(t)}function $w(t){return new ew(t)}function tS(t){return new rw(t)}function eS(t){return new qb(t)}function nS(t){return new Yb(t)}function iS(t){return new Zb(t)}function rS(t){return new ob(t)}function sS(t){return new sb(t)}function oS(t){return new cb(t)}function aS(t){return new ab(t)}function cS(t){return new rb(t)}function lS(t){return new ib(t)}function uS(t){return new fb(t)}function hS(t){return new pb(t)}function dS(t){return new eb(t)}function pS(t){return new lb(t)}function fS(t){return new aw(t)}function mS(t){return new ow(t)}aw.className="Bidirectional",Go(aw);const gS=$w,vS=tS,yS=eS,xS=nS;function bS(t){return new Db(t)}function wS(t){return new Pb(t)}function SS(t){return new Fb(t)}function _S(t){return new _b(t)}function TS(t,e){return Jv(t,e)}function ES(t,e){return iy(t,e)}function CS(t,e){return ry(t,e)}function kS(t,e){return $v(t,e)}function AS(t,e){return sy(t,e)}function IS(t,e){return ey(t,e)}function OS(t,e){return ny(t,e)}function RS(t,e){return Kv(t,e)}function NS(t,e){return Vv(t,e)}function MS(t,e){return Wv(t,e)}function DS(t,e){return Wv(t,e)}function PS(t,e){return Wv(t,e)}function FS(t,e){return jv(t,e)}function LS(t,e){return jv(t,e)}function BS(t,e){return jv(t,e)}function zS(t){return new _x(t)}function US(t){return wx(e=t),new _x({l1:null!=e?e.l1:null,l2:0});var e}function jS(t){return wx(e=t),new _x({l2:null!=e?e.l2:null,l1:0});var e}class VS extends Rv{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof Yy))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function WS(t,e){return t<e}function GS(t,e){return t>e}class qS extends VS{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new sm("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn("EarlyStopping mode '".concat(this.mode,"' is invalid. ")+"Falling back to mode 'auto'."),this.mode="auto"),"min"===this.mode?this.monitorFunc=WS:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=GS:this.monitorFunc=WS,this.monitorFunc===WS&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===WS?1/0:-1/0}async onEpochEnd(t,e){await Av(e);const n=this.getMonitorValue(e);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log("Epoch ".concat(this.stoppedEpoch,": early stopping."))}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping ".concat(this.monitor," is not available. ")+"Available metrics are: ".concat(Object.keys(t))),e}}const HS={earlyStopping:function(t){return new qS(t)}};var XS,YS;!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(XS||(XS={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(YS||(YS={}));const KS={};function QS(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};KS[t]=n}function ZS(t){return KS[t]}function JS(t){delete KS[t]}function $S(t,e,n,i,r){const s=e.inputParams[t];if(s&&void 0!==s.inputIndexStart){const t=s.inputIndexStart,o=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?t+1:s.inputIndexEnd;if("tensor"===s.type)return t_(e.inputNames[s.inputIndexStart],n,i,r);if("tensors"===s.type){return e.inputNames.slice(t,o).map((t=>t_(t,n,i,r)))}const a=t_(e.inputNames.slice(t)[0],n,i,r),c=a.dataSync();return"number"===s.type?c[0]:Ot(a.shape,c)}const o=e.attrParams[t];return o&&o.value}function t_(t,e,n,i){const[r,s]=i_(t);if(null!=i){const t=i.getHashTableHandleByName(r);if(null!=t)return t}const o=n.currentContextIds.find((t=>!!e[n_(r,t)]));return void 0!==o?e[n_(r,o)][s]:void 0}function e_(t,e){const[n,i]=i_(t);return[n_(n,e&&e.currentContextId),i]}function n_(t,e){return e?"".concat(t,"-").concat(e):t}function i_(t){const e=t.split(":");if(1===e.length)return[t,0];return[e[0],Number(e[e.length-1])]}function r_(t,e,n){let i=$S("pad",t,e,n);if("explicit"===i){i=$S("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)r[t][0]=i[2*t],r[t][1]=i[2*t+1];return r}return i}function s_(t){return t.kept?t:Ys(t)}const o_=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],a_=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],c_=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],l_=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],u_=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],h_=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],d_=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],p_=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],f_=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}],m_=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],g_=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],v_=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],y_=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],x_=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],b_=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],w_=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],S_=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];class __{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[T,E,C,k,A,I,O,D,M,R,P,F,L,B,z,U,N].map((t=>t.json)));this.opMappers=t.reduce(((t,e)=>(t[e.tfOpName]=e,t)),{})}transformGraph(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.node,i=[],r=[],s=[],o=n.reduce(((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?i.push(t[e.name]):"Const"===e.op?r.push(t[e.name]):null!=e.input&&0!==e.input.length||s.push(t[e.name]),t)),{});let a=[];const c=[];let l={},u={};null!=e&&(l=this.mapSignatureEntries(e.inputs),u=this.mapSignatureEntries(e.outputs));const h=Object.keys(o);h.forEach((t=>{const e=o[t];e.inputNames.forEach((t=>{const[n]=e_(t);e.inputs.push(o[n]),o[n].children.push(e)}))})),0===Object.keys(u).length?h.forEach((t=>{const e=o[t];0===e.children.length&&c.push(e)})):Object.keys(u).forEach((t=>{const[e]=e_(t),n=o[e];null!=n&&(n.signatureKey=u[t],c.push(n))})),Object.keys(l).length>0?Object.keys(l).forEach((t=>{const[e]=e_(t),n=o[e];n&&(n.signatureKey=l[t],a.push(n))})):a=i;let d={};null!=t.library&&null!=t.library.function&&(d=t.library.function.reduce(((t,e)=>(t[e.signature.name]=this.mapFunction(e),t)),{}));const p={nodes:o,inputs:a,outputs:c,weights:r,placeholders:i,signature:e,functions:d};return s.length>0&&(p.initNodes=s),p}mapSignatureEntries(t){return Object.keys(t||{}).reduce(((e,n)=>(e[t[n].name]=n,e)),{})}mapNode(t){const e=ZS(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((t=>t.startsWith("^")?t.substr(1):t)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce(((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t)),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce(((e,n)=>{const i=n.type;let r;switch(n.type){case"string":r=E_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=E_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":r=P_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=P_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":r=k_(t.attr,n.tfName,n.defaultValue||0),void 0===r&&n.tfDeprecatedName&&(r=k_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":r=D_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=D_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":r=C_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=C_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":r=L_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=L_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":r=M_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=M_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":r=F_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=F_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":r=O_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=O_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":r=R_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=R_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":r=I_(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=I_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:r,type:i},e}),{})),n}mapFunction(t){const e=t.nodeDef,n=[];let i={};null!=e&&(i=e.reduce(((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t)),{}));const r=[],s=[];t.signature.inputArg.forEach((t=>{const[e]=e_(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:A_(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,r.push(n),i[e]=n}));Object.keys(i).forEach((t=>{const e=i[t];e.inputNames.forEach((t=>{const[n]=e_(t);e.inputs.push(i[n]),i[n].children.push(e)}))}));const o=t.ret;t.signature.outputArg.forEach((t=>{const[e,n]=e_(o[t.name]),r=i[e];null!=r&&(r.defaultOutput=n,s.push(r))}));const a=this.mapArgsToSignature(t);return{nodes:i,inputs:r,outputs:s,weights:n,placeholders:[],signature:a}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce(((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t)),{}),outputs:t.signature.outputArg.reduce(((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e)),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function T_(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){const e=Ut().global;if("undefined"!==typeof e.atob)return e.atob(t);if("undefined"!==typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function E_(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t[e];return null!=r?T_(r.s,i):n}function C_(t,e,n){const i=t[e];return i?i.b:n}function k_(t,e,n){const i=t[e]||{},r=null!=i.i?i.i:null!=i.f?i.f:n;return"number"===typeof r?r:parseInt(r,10)}function A_(t){switch("string"===typeof t&&(t=XS[t]),t){case XS.DT_FLOAT:return"float32";case XS.DT_INT32:case XS.DT_INT64:case XS.DT_INT8:case XS.DT_UINT8:return"int32";case XS.DT_BOOL:return"bool";case XS.DT_DOUBLE:return"float32";case XS.DT_STRING:return"string";default:return null}}function I_(t,e,n){const i=t[e];return i&&i.func?i.func.name:n}function O_(t,e,n){const i=t[e];return i&&i.type?A_(i.type):n}function R_(t,e,n){const i=t[e];return i&&i.list&&i.list.type?i.list.type.map((t=>A_(t))):n}function N_(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((t=>"number"===typeof t.size?t.size:parseInt(t.size,10))):[]}function M_(t,e,n){const i=t[e];return i&&i.shape?N_(i.shape):n}function D_(t,e,n){const i=t[e];return i?((i.list.f&&i.list.f.length?i.list.f:i.list.i)||[]).map((t=>"number"===typeof t?t:parseInt(t,10))):n}function P_(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t[e];return r&&r.list&&r.list.s?r.list.s.map((t=>T_(t,i))):n}function F_(t,e,n){const i=t[e];return i&&i.list&&i.list.shape?i.list.shape.map((t=>N_(t))):n}function L_(t,e,n){const i=t[e];return i&&i.list&&i.list.b?i.list.b:n}class B_{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((t=>this.getInput(t))),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce(((t,e)=>(t[e]=this.getAttr(e),t)),{}))}getInput(t){return t_(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return t_(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return k_(this.node.rawAttrs,t,e);if(null!=n.s)return E_(this.node.rawAttrs,t,e);if(null!=n.b)return C_(this.node.rawAttrs,t,e);if(null!=n.shape)return M_(this.node.rawAttrs,t,e);if(null!=n.type)return O_(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return D_(this.node.rawAttrs,t,e);if(null!=n.list.s)return P_(this.node.rawAttrs,t,e);if(null!=n.list.shape)return F_(this.node.rawAttrs,t,e);if(null!=n.list.b)return L_(this.node.rawAttrs,t,e);if(null!=n.list.type)return R_(this.node.rawAttrs,t,e)}return e}}function z_(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";J(function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}class U_{constructor(t,e,n,i,r,s,o){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=i,this.identicalElementShapes=r,this.dynamicSize=s,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=za(0),fa(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach((e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));const e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map((t=>this.read(t)))}write(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),z_(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,fa(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach(((t,n)=>this.write(t,e[n])))}gather(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Zr([],[0].concat(this.elementShape));const n=this.readMany(t);return z_(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),lh(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return Zr([],[0].concat(this.elementShape));const e=[];for(let i=0;i<this.size();i++)e.push(i);const n=this.readMany(e);return z_(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),Oc(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,Sh(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));let n=0;const i=t.map((t=>(n+=t,n)));if(n!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const r=0===n?0:e.size/n,s=[];da((()=>{e=kc(e,[1,n,r]);for(let n=0;n<t.length;++n){const o=[0,0===n?0:i[n-1],0],a=[1,t[n],r];s[n]=kc(Nc(e,o,a),this.elementShape)}return s}));const o=[];for(let a=0;a<t.length;a++)o[a]=a;this.writeMany(o,s)}}class j_{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach((t=>{if(n!==t.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(t.dtype));z_(e,t.shape,"TensorList shape mismatch: "),fa(t)})),this.idTensor=za(0),this.maxNumElements=i,fa(this.idTensor)}get id(){return this.idTensor.id}copy(){return new j_([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach((e=>{null!=t&&t.has(e.id)||e.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));return z_(t,this.elementShape,"TensorList shape mismatch: "),da((()=>{const e=this.tensors.map((e=>kc(e,t)));return lh(e,0)}))}popBack(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=this.tensors.pop();return z_(n.shape,t,"TensorList shape mismatch: "),kc(n,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(z_(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");fa(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=t}getItem(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));return z_(this.tensors[t].shape,e,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));z_(this.elementShape,e.shape,"TensorList shape mismatch: "),fa(e),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));return z_(this.elementShape,n,"TensorList shape mismatch: "),0===(t=t.slice(0,this.size())).length?Zr([],[0].concat(this.elementShape)):da((()=>{const e=t.map((t=>kc(this.tensors[t],n)));return lh(e,0)}))}concat(t,e){if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));return z_(this.elementShape,e,"TensorList shape mismatch: "),0===this.size()?Zr([],[0].concat(this.elementShape)):da((()=>{const t=this.tensors.map((t=>kc(t,e)));return Oc(t,0)}))}}const V_=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const i=$S("thenBranch",t,e,n),r=$S("elseBranch",t,e,n),s=$S("cond",t,e,n),o=$S("args",t,e,n);return(await s.data())[0]?n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const i=$S("body",t,e,n),r=$S("cond",t,e,n),s=$S("args",t,e,n),o=await n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),a=s.map((t=>t.id));let c=await o[0].data();o.forEach((t=>{t.kept||-1!==a.indexOf(t.id)||t.dispose()}));let l=s;for(;c[0];){const t=l;l=await n.functionMap[i].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const e=l.map((t=>t.id));t.forEach((t=>{t.kept||-1!==a.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()}));const s=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);c=await s[0].data(),s.forEach((t=>{t.kept||-1!==a.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()}))}return l}case"LoopCond":return[s_($S("pred",t,e,n))];case"Switch":{const i=$S("pred",t,e,n);let r=$S("data",t,e,n);return r.kept||(r=s_(r)),(await i.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const i=t.inputNames.find((t=>void 0!==t_(t,e,n)));if(i){return[s_(t_(i,e,n))]}return}case"Enter":{const i=$S("frameName",t,e,n),r=$S("tensor",t,e,n);return n.enterFrame(i),[s_(r)]}case"Exit":{const i=$S("tensor",t,e,n);return n.exitFrame(),[s_(i)]}case"NextIteration":{const i=$S("tensor",t,e,n);return n.nextIteration(),[s_(i)]}case"TensorArrayV3":{const i=$S("size",t,e,n),r=$S("dtype",t,e,n),s=$S("elementShape",t,e,n),o=$S("dynamicSize",t,e,n),a=$S("clearAfterRead",t,e,n),c=$S("identicalElementShapes",t,e,n),l=$S("name",t,e,n),u=new U_(l,r,i,s,c,o,a);return n.addTensorArray(u),[u.idTensor,za(1)]}case"TensorArrayWriteV3":{const i=$S("tensorArrayId",t,e,n),r=$S("index",t,e,n),s=$S("tensor",t,e,n),o=n.getTensorArray(i.id);return o.write(r,s),[o.idTensor]}case"TensorArrayReadV3":{const i=$S("tensorArrayId",t,e,n),r=$S("index",t,e,n);return[n.getTensorArray(i.id).read(r)]}case"TensorArrayGatherV3":{const i=$S("tensorArrayId",t,e,n),r=$S("indices",t,e,n),s=$S("dtype",t,e,n);return[n.getTensorArray(i.id).gather(r,s)]}case"TensorArrayScatterV3":{const i=$S("tensorArrayId",t,e,n),r=$S("indices",t,e,n),s=$S("tensor",t,e,n),o=n.getTensorArray(i.id);return o.scatter(r,s),[o.idTensor]}case"TensorArrayConcatV3":{const i=$S("tensorArrayId",t,e,n),r=n.getTensorArray(i.id),s=$S("dtype",t,e,n);return[r.concat(s)]}case"TensorArraySplitV3":{const i=$S("tensorArrayId",t,e,n),r=$S("tensor",t,e,n),s=$S("lengths",t,e,n),o=n.getTensorArray(i.id);return o.split(s,r),[o.idTensor]}case"TensorArraySizeV3":{const i=$S("tensorArrayId",t,e,n);return[za(n.getTensorArray(i.id).size(),"int32")]}case"TensorArrayCloseV3":{const i=$S("tensorArrayId",t,e,n),r=n.getTensorArray(i.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const i=$S("tensorListId",t,e,n),r=$S("index",t,e,n),s=$S("tensor",t,e,n),o=n.getTensorList(i.id);return o.setItem(r,s),[o.idTensor]}case"TensorListGetItem":{const i=$S("tensorListId",t,e,n),r=$S("index",t,e,n),s=$S("elementShape",t,e,n),o=$S("elementDType",t,e,n);return[n.getTensorList(i.id).getItem(r,s,o)]}case"TensorListScatterV2":case"TensorListScatter":{const i=$S("indices",t,e,n),r=function(t,e,n,i){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const r=Math.max(...e);if(null!=i&&-1!==i&&r>=i)throw new Error("Max index must be < array size (".concat(r,"  vs. ").concat(i,")"));const s=new j_([],n,t.dtype,i),o=Sh(t,0);return e.forEach(((t,e)=>{s.setItem(t,o[e])})),s}($S("tensor",t,e,n),i,$S("elementShape",t,e,n),$S("numElements",t,e,n));return n.addTensorList(r),[r.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const i=$S("elementShape",t,e,n),r=$S("elementDType",t,e,n);let s;s="TensorListReserve"===t.op?"numElements":"maxNumElements";const o=function(t,e,n){return new j_([],t,e,n)}(i,r,$S(s,t,e,n));return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{const i=$S("tensorListId",t,e,n),r=$S("indices",t,e,n),s=$S("elementShape",t,e,n),o=$S("elementDType",t,e,n);return[n.getTensorList(i.id).gather(r,o,s)]}case"TensorListStack":{const i=$S("tensorListId",t,e,n),r=$S("elementShape",t,e,n),s=$S("elementDType",t,e,n),o=$S("numElements",t,e,n);return[n.getTensorList(i.id).stack(r,s,o)]}case"TensorListFromTensor":{const i=function(t,e,n){const i=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));z_(t.shape.slice(1),e,"TensorList shape mismatch: ");const r=Sh(t);return new j_(r,e,i)}($S("tensor",t,e,n),$S("elementShape",t,e,n),$S("elementDType",t,e,n));return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":{const i=$S("tensorListId",t,e,n),r=n.getTensorList(i.id),s=$S("dtype",t,e,n),o=$S("elementShape",t,e,n);return[r.concat(s,o)]}case"TensorListPushBack":{const i=$S("tensorListId",t,e,n),r=$S("tensor",t,e,n),s=n.getTensorList(i.id);return s.pushBack(r),[s.idTensor]}case"TensorListPopBack":{const i=$S("tensorListId",t,e,n),r=$S("elementShape",t,e,n),s=$S("elementDType",t,e,n);return[n.getTensorList(i.id).popBack(r,s)]}case"TensorListSplit":{const i=$S("tensor",t,e,n),r=$S("elementShape",t,e,n),s=function(t,e,n){let i=0;const r=e.map((t=>(i+=t,i)));if(i!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(i,", and tensor's shape is: ").concat(t.shape));const s=0===i?0:t.size/i,o=da((()=>{const o=[];t=kc(t,[1,i,s]);for(let i=0;i<e.length;++i){const a=[0,0===i?0:r[i-1],0],c=[1,e[i],s];o[i]=kc(Nc(t,a,c),n)}return t.dispose(),o})),a=new j_([],n,t.dtype,e.length);for(let c=0;c<o.length;c++)a.setItem(c,o[c]);return a}(i,$S("lengths",t,e,n),r);return n.addTensorList(s),[s.idTensor]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function W_(t,e,n){const[i,r]=$S("fusedOps",t,e,n),s="biasadd"===i,o="prelu"===r,a="fusedbatchnorm"===i,c=$S("numArgs",t,e,n);if(s){if(o&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(a)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const l=$S("strides",t,e,n),u=r_(t,e,n),h=$S("dataFormat",t,e,n).toUpperCase(),d=$S("dilations",t,e,n),[p,f]=$S("args",t,e,n);return{stride:l,pad:u,dataFormat:h,dilations:d,biasArg:p,preluArg:f,activationFunc:r,leakyreluAlpha:$S("leakyreluAlpha",t,e,n)}}function G_(t,e,n){return{boxes:$S("boxes",t,e,n),scores:$S("scores",t,e,n),maxOutputSize:$S("maxOutputSize",t,e,n),iouThreshold:$S("iouThreshold",t,e,n),scoreThreshold:$S("scoreThreshold",t,e,n),softNmsSigma:$S("softNmsSigma",t,e,n)}}class q_{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=za(0),this.tensorMap=new Map,fa(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach((t=>t.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach((t=>t.dispose())),this.tensorMap.clear(),da((()=>{const t=Sh(e),i=n.length,r=t.length;J(i===r,(()=>"The number of elements doesn't match, keys has "+"".concat(i," elements, the values has ").concat(r," ")+"elements."));for(let e=0;e<i;e++){const i=n[e],r=t[e];fa(r),this.tensorMap.set(i,r)}return this.handle}))}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return da((()=>{const t=[];for(let i=0;i<n.length;i++){const r=n[i],s=this.findWithDefault(r,e);t.push(s)}return lh(t)}))}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))}}function H_(t,e,n,i){const r=((t,e,n)=>{switch(t.category){case"arithmetic":return da((()=>((t,e,n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[Ea($S("a",t,e,n),$S("b",t,e,n))];case"AddN":return[rc($S("tensors",t,e,n))];case"FloorMod":case"Mod":return[au($S("a",t,e,n),$S("b",t,e,n))];case"Mul":return[Aa($S("a",t,e,n),$S("b",t,e,n))];case"RealDiv":case"Div":return[ka($S("a",t,e,n),$S("b",t,e,n))];case"DivNoNan":return[hl($S("a",t,e,n),$S("b",t,e,n))];case"FloorDiv":return[Ca($S("a",t,e,n),$S("b",t,e,n))];case"Sub":return[qa($S("a",t,e,n),$S("b",t,e,n))];case"Minimum":return[su($S("a",t,e,n),$S("b",t,e,n))];case"Maximum":return[Za($S("a",t,e,n),$S("b",t,e,n))];case"Pow":return[Ga($S("a",t,e,n),$S("b",t,e,n))];case"SquaredDifference":return[ah($S("a",t,e,n),$S("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"basic_math":return da((()=>((t,e,n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[Xa($S("x",t,e,n))];case"Acos":return[nc($S("x",t,e,n))];case"Acosh":return[ic($S("x",t,e,n))];case"Asin":return[lc($S("x",t,e,n))];case"Asinh":return[uc($S("x",t,e,n))];case"Atan":return[hc($S("x",t,e,n))];case"Atan2":return[dc($S("x",t,e,n),$S("y",t,e,n))];case"Atanh":return[pc($S("x",t,e,n))];case"Ceil":return[Vc($S("x",t,e,n))];case"Complex":return[Kr($S("real",t,e,n),$S("imag",t,e,n))];case"Cos":return[el($S("x",t,e,n))];case"Cosh":return[nl($S("x",t,e,n))];case"Elu":return[pl($S("x",t,e,n))];case"Erf":return[fl($S("x",t,e,n))];case"Exp":return[ml($S("x",t,e,n))];case"Expm1":return[vl($S("x",t,e,n))];case"Floor":return[bl($S("x",t,e,n))];case"Log":return[Ml($S("x",t,e,n))];case"Log1p":return[Dl($S("x",t,e,n))];case"Imag":return[Tl($S("x",t,e,n))];case"Neg":return[Pl($S("x",t,e,n))];case"Reciprocal":return[Pu($S("x",t,e,n))];case"Real":return[Du($S("x",t,e,n))];case"Relu":return[Fu($S("x",t,e,n))];case"Round":return[Wu($S("x",t,e,n))];case"Selu":return[qu($S("x",t,e,n))];case"Sigmoid":return[Rc($S("x",t,e,n))];case"Sin":return[Ku($S("x",t,e,n))];case"Sign":return[Yu($S("x",t,e,n))];case"Sinh":return[Qu($S("x",t,e,n))];case"Softplus":return[Fl($S("x",t,e,n))];case"Sqrt":return[Ia($S("x",t,e,n))];case"Square":return[Oa($S("x",t,e,n))];case"Tanh":return[Mc($S("x",t,e,n))];case"Tan":return[dh($S("x",t,e,n))];case"ClipByValue":return[Wc($S("x",t,e,n),$S("clipValueMin",t,e,n),$S("clipValueMax",t,e,n))];case"Relu6":return[Lu($S("x",t,e,n))];case"Rsqrt":return[Gu(t_(t.inputNames[0],e,n))];case"Prod":return[Tu($S("x",t,e,n),$S("axes",t,e,n))];case"LeakyRelu":return[Al($S("x",t,e,n),$S("alpha",t,e,n))];case"Prelu":return[_u($S("x",t,e,n),$S("alpha",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"control":return V_(t,e,n);case"convolution":return da((()=>((t,e,n)=>{switch(t.op){case"Conv1D":{const i=$S("stride",t,e,n),r=$S("pad",t,e,n),s=$S("dataFormat",t,e,n).toUpperCase(),o=$S("dilation",t,e,n);return[Kc($S("x",t,e,n),$S("filter",t,e,n),i,r,s,o)]}case"Conv2D":{const i=$S("strides",t,e,n),r=r_(t,e,n),s=$S("dataFormat",t,e,n).toUpperCase(),o=$S("dilations",t,e,n);return[Yc($S("x",t,e,n),$S("filter",t,e,n),[i[1],i[2]],r,s,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:i,pad:r,dataFormat:s,dilations:o,biasArg:a,preluArg:c,activationFunc:l,leakyreluAlpha:u}=W_(t,e,n);return[id({x:$S("x",t,e,n),filter:$S("filter",t,e,n),strides:[i[1],i[2]],pad:r,dataFormat:s,dilations:[o[1],o[2]],bias:a,activation:l,preluActivationWeights:c,leakyreluAlpha:u})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:r,dataFormat:s,dilations:o,biasArg:a,preluArg:c,activationFunc:l,leakyreluAlpha:u}=W_(t,e,n);return[od({x:$S("x",t,e,n),filter:$S("filter",t,e,n),strides:[i[1],i[2]],pad:r,dataFormat:s,dilations:[o[1],o[2]],bias:a,activation:l,preluActivationWeights:c,leakyreluAlpha:u})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=$S("outputShape",t,e,n),r=$S("strides",t,e,n),s=r_(t,e,n);return[Zc($S("x",t,e,n),$S("filter",t,e,n),i,[r[1],r[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=$S("strides",t,e,n),r=r_(t,e,n),s=$S("dilations",t,e,n),o=$S("dataFormat",t,e,n).toUpperCase();return[ol($S("input",t,e,n),$S("filter",t,e,n),[i[1],i[2]],r,o,[s[1],s[2]])]}case"Conv3D":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("dataFormat",t,e,n).toUpperCase(),o=$S("dilations",t,e,n);return[Jc($S("x",t,e,n),$S("filter",t,e,n),[i[1],i[2],i[3]],r,s,[o[1],o[2],o[3]])]}case"AvgPool":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("kernelSize",t,e,n);return[Ac($S("x",t,e,n),[s[1],s[2]],[i[1],i[2]],r)]}case"MaxPool":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("kernelSize",t,e,n);return[tu($S("x",t,e,n),[s[1],s[2]],[i[1],i[2]],r)]}case"MaxPoolWithArgmax":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("kernelSize",t,e,n),o=$S("includeBatchInIndex",t,e,n),{result:a,indexes:c}=nu($S("x",t,e,n),[s[1],s[2]],[i[1],i[2]],r,o);return[a,c]}case"AvgPool3D":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("kernelSize",t,e,n);return[Ic($S("x",t,e,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],r)]}case"MaxPool3D":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("kernelSize",t,e,n);return[eu($S("x",t,e,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],r)]}case"Dilation2D":{const i=$S("strides",t,e,n),r=$S("pad",t,e,n),s=$S("dilations",t,e,n),o=i[1],a=i[2],c=s[1],l=s[2];return[cl($S("x",t,e,n),$S("filter",t,e,n),[o,a],r,[c,l],"NHWC")]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"creation":return da((()=>((t,e,n)=>{switch(t.op){case"Fill":{const i=$S("shape",t,e,n),r=$S("dtype",t,e,n);return[Va(i,$S("value",t,e,n),r)]}case"LinSpace":return[Rl($S("start",t,e,n),$S("stop",t,e,n),$S("num",t,e,n))];case"Multinomial":{const i=$S("logits",t,e,n),r=$S("numSamples",t,e,n),s=$S("seed",t,e,n);return[uu(i,r,s)]}case"OneHot":{const i=$S("indices",t,e,n),r=$S("depth",t,e,n),s=$S("onValue",t,e,n),o=$S("offValue",t,e,n);return[mo(i,r,s,o)]}case"Ones":return[pu($S("shape",t,e,n),$S("dtype",t,e,n))];case"OnesLike":return[fu($S("x",t,e,n))];case"RandomUniform":return[Nu($S("shape",t,e,n),$S("minval",t,e,n),$S("maxval",t,e,n),$S("dtype",t,e,n))];case"Range":return[Mu($S("start",t,e,n),$S("stop",t,e,n),$S("step",t,e,n),$S("dtype",t,e,n))];case"TruncatedNormal":{const i=$S("shape",t,e,n),r=$S("mean",t,e,n),s=$S("stdDev",t,e,n),o=$S("seed",t,e,n);return[xh(i,r,s,$S("dtype",t,e,n),o)]}case"Zeros":return[du($S("shape",t,e,n),$S("dtype",t,e,n))];case"ZerosLike":return[Ra($S("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"dynamic":return(async(t,e,n)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:r,maxOutputSize:s,iouThreshold:o,scoreThreshold:a,softNmsSigma:c}=G_(t,e,n),l=await Kd.nonMaxSuppressionWithScoreAsync(i,r,s,o,a,c);return[l.selectedIndices,l.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:r,maxOutputSize:s,iouThreshold:o,scoreThreshold:a}=G_(t,e,n),c=$S("padToMaxOutputSize",t,e,n),l=await Kd.nonMaxSuppressionPaddedAsync(i,r,s,o,a,c);return[l.selectedIndices,l.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:r,maxOutputSize:s,iouThreshold:o,scoreThreshold:a}=G_(t,e,n);return[await Kd.nonMaxSuppressionAsync(i,r,s,o,a)]}case"Where":{const i=Xs($S("condition",t,e,n),"bool"),r=[await Eh(i)];return i.dispose(),r}case"ListDiff":return Xu($S("x",t,e,n),$S("y",t,e,n));default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n);case"evaluation":return da((()=>((t,e,n)=>{switch(t.op){case"TopKV2":{const i=$S("x",t,e,n),r=$S("k",t,e,n),s=$S("sorted",t,e,n),o=yh(i,r,s);return[o.values,o.indices]}case"Unique":{const i=$S("x",t,e,n),r=bh(i);return[r.values,r.indices]}case"UniqueV2":{const i=$S("x",t,e,n),r=$S("axis",t,e,n),s=bh(i,r);return[s.values,s.indices]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"image":return da((()=>((t,e,n)=>{switch(t.op){case"ResizeBilinear":{const i=$S("images",t,e,n),r=$S("size",t,e,n),s=$S("alignCorners",t,e,n),o=$S("halfPixelCenters",t,e,n);return[Kd.resizeBilinear(i,[r[0],r[1]],s,o)]}case"ResizeNearestNeighbor":{const i=$S("images",t,e,n),r=$S("size",t,e,n),s=$S("alignCorners",t,e,n),o=$S("halfPixelCenters",t,e,n);return[Kd.resizeNearestNeighbor(i,[r[0],r[1]],s,o)]}case"CropAndResize":{const i=$S("image",t,e,n),r=$S("boxes",t,e,n),s=$S("boxInd",t,e,n),o=$S("cropSize",t,e,n),a=$S("method",t,e,n),c=$S("extrapolationValue",t,e,n);return[Kd.cropAndResize(i,r,s,o,a,c)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"graph":return da((()=>((t,e,n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const i=$S("default",t,e,n);return[t_(t.name,e,n)||i];case"Placeholder":return[t_(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[s_($S("x",t,e,n))];case"IdentityN":return $S("x",t,e,n).map((t=>s_(t)));case"Shape":return[ph($S("x",t,e,n).shape,"int32")];case"ShapeN":return $S("x",t,e,n).map((t=>ph(t.shape)));case"Size":return[za($S("x",t,e,n).size,"int32")];case"Rank":return[za($S("x",t,e,n).rank,"int32")];case"NoOp":return[za(1)];case"Print":const r=$S("x",t,e,n),s=$S("data",t,e,n),o=$S("message",t,e,n),a=$S("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let t=0;t<s.length;t++)console.log(Array.prototype.slice.call(s[t].dataSync()).slice(0,a));return[r];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"logical":return da((()=>((t,e,n)=>{switch(t.op){case"Equal":return[ll($S("a",t,e,n),$S("b",t,e,n))];case"NotEqual":return[hu($S("a",t,e,n),$S("b",t,e,n))];case"Greater":return[Sl($S("a",t,e,n),$S("b",t,e,n))];case"GreaterEqual":return[_l($S("a",t,e,n),$S("b",t,e,n))];case"Less":return[Il($S("a",t,e,n),$S("b",t,e,n))];case"LessEqual":return[Ol($S("a",t,e,n),$S("b",t,e,n))];case"LogicalAnd":return[Ql($S("a",t,e,n),$S("b",t,e,n))];case"LogicalNot":return[Zl($S("a",t,e,n))];case"LogicalOr":return[Jl($S("a",t,e,n),$S("b",t,e,n))];case"Select":case"SelectV2":return[ul($S("condition",t,e,n),$S("a",t,e,n),$S("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"matrices":return da((()=>((t,e,n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[fo($S("a",t,e,n),$S("b",t,e,n),$S("transposeA",t,e,n),$S("transposeB",t,e,n))];case"Transpose":return[go($S("x",t,e,n),$S("perm",t,e,n))];case"_FusedMatMul":const[i,r]=$S("fusedOps",t,e,n),s="biasadd"===i,o="prelu"===r,a=$S("numArgs",t,e,n),c=$S("leakyreluAlpha",t,e,n);if(s){if(o&&2!==a)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==a)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,u]=$S("args",t,e,n);return[ad({a:$S("a",t,e,n),b:$S("b",t,e,n),transposeA:$S("transposeA",t,e,n),transposeB:$S("transposeB",t,e,n),bias:l,activation:r,preluActivationWeights:u,leakyreluAlpha:c})];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"normalization":return da((()=>((t,e,n)=>{switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Fc($S("x",t,e,n),$S("mean",t,e,n),$S("variance",t,e,n),$S("offset",t,e,n),$S("scale",t,e,n),$S("epsilon",t,e,n))];case"LRN":return[Nl($S("x",t,e,n),$S("radius",t,e,n),$S("bias",t,e,n),$S("alpha",t,e,n),$S("beta",t,e,n))];case"Softmax":return[eh($S("x",t,e,n))];case"LogSoftmax":return[Ul($S("x",t,e,n))];case"SparseToDense":return[Hh($S("sparseIndices",t,e,n),$S("outputShape",t,e,n),$S("sparseValues",t,e,n),$S("defaultValue",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"reduction":return da((()=>((t,e,n)=>{switch(t.op){case"Max":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[Bl($S("x",t,e,n),i,r)]}case"Mean":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[iu($S("x",t,e,n),i,r)]}case"Min":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[ru($S("x",t,e,n),i,r)]}case"Sum":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[zl($S("x",t,e,n),i,r)]}case"All":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[sc($S("x",t,e,n),i,r)]}case"Any":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[oc($S("x",t,e,n),i,r)]}case"ArgMax":{const i=$S("axis",t,e,n);return[ac($S("x",t,e,n),i)]}case"ArgMin":{const i=$S("axis",t,e,n);return[cc($S("x",t,e,n),i)]}case"Prod":{const i=$S("axis",t,e,n),r=$S("keepDims",t,e,n);return[Tu($S("x",t,e,n),i,r)]}case"Cumsum":{const i=$S("axis",t,e,n),r=$S("exclusive",t,e,n),s=$S("reverse",t,e,n);return[il($S("x",t,e,n),i,r,s)]}case"Bincount":const i=$S("x",t,e,n),r=$S("weights",t,e,n),s=$S("size",t,e,n);return[Uc(i,r,s)];case"DenseBincount":{const i=$S("x",t,e,n),r=$S("weights",t,e,n),s=$S("size",t,e,n),o=$S("binaryOutput",t,e,n);return[rl(i,r,s,o)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"slice_join":return da((()=>((t,e,n)=>{switch(t.op){case"ConcatV2":case"Concat":{const i=$S("n",t,e,n),r=$S("axis",t,e,n);let s=$S("tensors",t,e,n);return s=s.slice(0,i),[Oc(s,r)]}case"Gather":{const i=$S("x",t,e,n),r=$S("indices",t,e,n);return[wl(i,Xs(r,"int32"),0)]}case"GatherV2":{const i=$S("axis",t,e,n),r=$S("batchDims",t,e,n),s=$S("x",t,e,n),o=$S("indices",t,e,n);return[wl(s,Xs(o,"int32"),i,r)]}case"Reverse":{const i=$S("dims",t,e,n),r=[];for(let t=0;t<i.length;t++)i[t]&&r.push(t);const s=$S("x",t,e,n);return[Bu(s,r)]}case"ReverseV2":{const i=$S("axis",t,e,n),r=$S("x",t,e,n);return[Bu(r,i)]}case"Slice":{const i=$S("begin",t,e,n),r=$S("size",t,e,n);return[Nc($S("x",t,e,n),i,r)]}case"StridedSlice":{const i=$S("begin",t,e,n),r=$S("end",t,e,n),s=$S("strides",t,e,n),o=$S("beginMask",t,e,n),a=$S("endMask",t,e,n),c=$S("ellipsisMask",t,e,n),l=$S("newAxisMask",t,e,n),u=$S("shrinkAxisMask",t,e,n),h=$S("x",t,e,n);return[hh(h,i,r,s,o,a,c,l,u)]}case"Pack":return da((()=>{const i=$S("axis",t,e,n),r=$S("tensors",t,e,n),s=r[0].shape,o=ch(r[0]).shape,a=r.map((t=>{const e=rt(t.shape,s);if(!e&&!rt(ch(t).shape,o))throw new Error("the input tensors shape does not match");return e?t:kc(t,s)}));return[lh(a,i)]}));case"Unpack":{const i=$S("axis",t,e,n),r=$S("tensor",t,e,n);return Sh(r,i)}case"Tile":{const i=$S("reps",t,e,n);return[yl($S("x",t,e,n),i)]}case"Split":case"SplitV":{const i=$S("axis",t,e,n),r=$S("numOrSizeSplits",t,e,n),s=$S("x",t,e,n);return sh(s,r,i)}case"ScatterNd":{const i=$S("indices",t,e,n),r=$S("values",t,e,n),s=$S("shape",t,e,n);return[qh(i,r,s)]}case"GatherNd":{const i=$S("x",t,e,n),r=$S("indices",t,e,n);return[Xh(i,r)]}case"SparseToDense":{const i=$S("sparseIndices",t,e,n),r=$S("outputShape",t,e,n),s=$S("sparseValues",t,e,n),o=$S("defaultValue",t,e,n);return[Hh(i,s,r,s.dtype===o.dtype?o:Xs(o,s.dtype))]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"spectral":return da((()=>((t,e,n)=>{switch(t.op){case"FFT":return[nh($S("x",t,e,n))];case"IFFT":return[ih($S("x",t,e,n))];case"RFFT":return[oh($S("x",t,e,n))];case"IRFFT":return[rh($S("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"transformation":return da((()=>((t,e,n)=>{switch(t.op){case"Cast":return[Xs($S("x",t,e,n),$S("dtype",t,e,n))];case"ExpandDims":{const i=$S("axis",t,e,n);return[gl($S("x",t,e,n),i)]}case"Squeeze":{const i=$S("axis",t,e,n);return[ch($S("x",t,e,n),i)]}case"Reshape":return[kc($S("x",t,e,n),$S("shape",t,e,n))];case"MirrorPad":return[ou($S("x",t,e,n),$S("padding",t,e,n),$S("mode",t,e,n))];case"PadV2":case"Pad":return[gu($S("x",t,e,n),$S("padding",t,e,n),$S("constantValue",t,e,n))];case"SpaceToBatchND":{const i=$S("blockShape",t,e,n),r=$S("paddings",t,e,n);return[wu($S("x",t,e,n),i,r)]}case"BatchToSpaceND":{const i=$S("blockShape",t,e,n),r=$S("crops",t,e,n);return[Pc($S("x",t,e,n),i,r)]}case"DepthToSpace":{const i=$S("blockSize",t,e,n),r=$S("dataFormat",t,e,n).toUpperCase();return[sl($S("x",t,e,n),i,r)]}case"BroadcastTo":return[jc($S("x",t,e,n),$S("shape",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n)));case"hash_table":return(async(t,e,n,i)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=$S("keyDType",t,e,n),s=$S("valueDType",t,e,n),o=new q_(r,s);return i.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const r=$S("tableHandle",t,e,n,i),s=$S("keys",t,e,n),o=$S("values",t,e,n),a=i.getHashTableById(r.id);return[await a.import(s,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=$S("tableHandle",t,e,n,i),s=$S("keys",t,e,n),o=$S("defaultValue",t,e,n),a=i.getHashTableById(r.id);return[await a.find(s,o)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n,i);case"custom":const r=ZS(t.op);if(r&&r.customExecutor)return r.customExecutor(new B_(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(t,e,n);return Lt(r)?r.then((t=>[].concat(t))):[].concat(r)}class X_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map((t=>0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId))).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function Y_(t,e,n,i){const r=new Set,s=[];let o=null,a=null;const c=new Set,l=Object.keys(t).map((t=>i_(t)[0]));let u=[];null!=i&&(u=i.map((t=>i_(t.name)[0])));const h=[...e];for(;h.length>0;){const t=h.pop();(J_(t)||$_(t)||tT(t))&&null==o&&(o=t,a=o.children.map((t=>t.name)).filter((t=>r.has(t)))),r.add(t.name),null==n[t.name]&&(-1===l.indexOf(t.name)&&-1===u.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach((t=>{c.has(t.name)||(c.add(t.name),h.push(t))})):s.push(t.name)))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:s,dynamicNode:o,syncInputs:a}}const K_=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Q_=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Z_=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function J_(t){return K_.indexOf(t.op)>=0}function $_(t){return Q_.indexOf(t.op)>=0}function tT(t){return Z_.indexOf(t.op)>=0}class eT{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((e=>{this._functionExecutorMap[e]=new eT(t.functions[e],this)}))}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map((e=>t[e].map((t=>t.id))));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map((t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((t=>t.signatureKey||t.name))}get outputNodes(){return this._outputs.map((t=>{const e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e}))}get functions(){return Object.keys(this._functions).reduce(((t,e)=>(t[e]=this._functions[e].signature,t)),{})}getCompilationKey(t,e){const n=t.map((t=>t.name)).sort(),i=e.map((t=>t.name)).sort();return n.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)}compile(t,e){const n=Y_(t,e,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:r,syncInputs:s}=n;if(null!=r)throw new Error("This execution contains the node '".concat(r.name,"', which has ")+"the dynamic op '".concat(r.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(s,"]"));if(i.length>0){const n=e.map((t=>t.name)),r=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(r,"]. Missing the following inputs: [").concat(i,"]"))}return function(t,e,n){const{usedNodes:i,inputs:r}=n,s=[],o=Object.keys(r).map((t=>i_(t)[0])).map((e=>t.nodes[e])),a=t.initNodes;o.forEach((t=>{i.has(t.name)&&s.push(t)})),t.weights.forEach((t=>{i.has(t.name)&&s.push(t)})),null!=a&&a.forEach((t=>{i.has(t.name)&&s.push(t)}));const c=new Set,l=[];for(;s.length>0;){const t=s.pop();c.add(t.name),e[t.name]||l.push(t),t.children.forEach((t=>{!c.has(t.name)&&i.has(t.name)&&t.inputs.every((t=>c.has(t.name)))&&s.push(t)}))}return l}(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const i=n.map((t=>this.graph.nodes[i_(t)[0]])),r=e.map((t=>i_(t)[0]));let s=r.map((t=>this.graph.nodes[t]));0===s.length&&(s=this._outputs);const o=this.getCompilationKey(i,s);let a=this.compiledMap.get(o);null==a&&(a=this.compile(t,s),this.compiledMap.set(o,a));const c={},l={};return da((()=>{const n=new X_(this.weightMap,c,l,this.functionExecutorMap),i=Object.assign({},this.weightMap);Object.keys(t).forEach((e=>{const[n,r]=i_(e),s=[];s[r]=t[e],i[n]=s}));const s=this.getFrozenTensorIds(i),o={};for(let t=0;t<a.length;t++){const e=a[t];if(!i[e.name]){const t=H_(e,i,n,this._resourceManager);if(Lt(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");i[e.name]=t,this.checkTensorForDisposal(e.name,e,i,n,s,r,o)}}return null==this.parent&&n.dispose(s),e.map((t=>t_(t,i,n)))}))}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map((e=>t[e])).map((t=>t.map((t=>t.id)))));return new Set(e)}checkTensorForDisposal(t,e,n,i,r,s,o){"control"!==e.category&&-1===s.indexOf(t)&&(n[t].forEach((t=>{null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((t=>{if("control"!==t.category){const e=function(t,e,n){return e[n_(t,n.currentContextId)]}(t.name,n,i);null!=e&&e.forEach((t=>{if(t&&!r.has(t.id)){const e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}}))}})))}async executeAsync(t,e){return this._executeAsync(t,e)}async _executeAsync(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));const s=new X_(this.weightMap,i,r,this.functionExecutorMap),o=await this.executeWithControlFlow(t,s,e,n),a=e.map((t=>t_(t,o,s))),c=a.map((t=>t.id)),l=Object.keys(t).map((e=>t[e].id)),u=new Set([...c,...l,...this.weightIds]);return Object.keys(o).forEach((t=>{o[t].forEach((t=>{!t||t.isDisposed||u.has(t.id)||t.dispose()}))})),null==this.parent&&s.dispose(u),a}async executeFunctionAsync(t,e,n){const i=t.reduce(((t,e,n)=>(t[this.inputs[n].name]=e,t)),{});return this._executeAsync(i,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,i){const r=Object.keys(t),s=r.map((t=>this.graph.nodes[i_(t)[0]])),o=n.map((t=>i_(t)[0]));let a=o.map((t=>this.graph.nodes[t]));0===a.length&&(a=this._outputs);const{usedNodes:c,missingInputs:l,dynamicNode:u,syncInputs:h}=Y_(t,a,this.weightMap,this._initNodes),d=[...s,...this.graph.weights,...this._initNodes||[]].map((t=>({node:t,contexts:e.currentContext}))),p=Object.assign({},this.weightMap);Object.keys(t).forEach((e=>{const[n,i]=i_(e),r=[];r[i]=t[e],p[n]=r}));const f={},m=this.getFrozenTensorIds(p),g={};for(;d.length>0;){const t=this.processStack(s,d,e,p,g,m,o,f,c);await Promise.all(t)}null!=u||i||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=a.filter((t=>!J_(t)&&!t_(t.name,p,e))).map((t=>t.name));if(v.length>0){let t="";throw null!=u&&(t="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(v,"] from the provided ")+"inputs [".concat(r,"]. Consider providing the following inputs: ")+"[".concat(l,"]. ").concat(t))}return p}processStack(t,e,n,i,r,s,o,a,c){const l=[];for(;e.length>0;){const t=e.pop();n.currentContext=t.contexts;let u="";if("Enter"===t.node.op&&$S("isConstant",t.node,i,n)&&([u]=e_(t.node.name,n)),null==i[t.node.name]){const h=H_(t.node,i,n,this._resourceManager);u||([u]=e_(t.node.name,n));const d=n.currentContext;Lt(h)?l.push(h.then((l=>(i[u]=l,n.currentContext=d,this.checkTensorForDisposal(u,t.node,i,n,s,o,a),this.processChildNodes(t.node,e,n,i,r,c),l)))):(i[u]=h,this.checkTensorForDisposal(u,t.node,i,n,s,o,a),this.processChildNodes(t.node,e,n,i,r,c))}else this.processChildNodes(t.node,e,n,i,r,c)}return l}processChildNodes(t,e,n,i,r,s){t.children.forEach((t=>{const[o]=e_(t.name,n);!r[o]&&s.has(t.name)&&("Merge"===t.op?t.inputNames.some((t=>!!t_(t,i,n)))&&(r[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((t=>!!t_(t,i,n)))&&(r[o]=!0,e.push({contexts:n.currentContext,node:t})))}))}dispose(){Object.keys(this.weightMap).forEach((t=>this.weightMap[t].forEach((t=>t.dispose()))))}checkInputShapeAndType(t){Object.keys(t).forEach((e=>{const n=t[e],[i]=i_(e),r=this.graph.nodes[i];if(r.attrParams.shape&&r.attrParams.shape.value){const t=r.attrParams.shape.value;J(t.length===n.shape.length&&n.shape.every(((e,n)=>-1===t[n]||t[n]===e)),(()=>"The shape of dict['".concat(r.name,"'] provided in ")+"model.execute(dict) must be [".concat(t,"], but was ")+"[".concat(n.shape,"]")))}r.attrParams.dtype&&r.attrParams.dtype.value&&J(n.dtype===r.attrParams.dtype.value,(()=>"The dtype of dict['".concat(r.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(r.attrParams.dtype.value,", but was ").concat(n.dtype)))}))}mapInputs(t){const e={};for(const n in t)if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]){e[this._signature.inputs[n].name]=t[n]}else e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter((t=>{const[e]=i_(t);return null==this.graph.nodes[e]}));if(e.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(e,"] that are not part of graph"))}mapOutputs(t){return t.map((t=>{if(null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]){return this._signature.outputs[t].name}return t}),{})}checkOutputs(t){t.forEach((t=>{const[e]=i_(t);if(!this.graph.nodes[e])throw new Error("The output '".concat(t,"' is not found in the graph"))}))}}class nT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}const iT="?tfjs-format=file",rT="model.json";class sT{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={}),this.resourceManager=new nT}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=co(t,this.loadOptions);else{const e=ps(t,this.loadOptions);if(0===e.length)e.push(co(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=await this.handler.load();return this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n;n=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=n,this.version="".concat(e.versions.producer,".").concat(e.versions.minConsumer);const i=es(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new eT(__.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=__.Instance.transformGraph(t.modelInitializer);this.initializer=new eT(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,e){if("string"===typeof t){const e=ds(t);if(0===e.length)throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new Error("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof xr)&&!Array.isArray(t))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(t.length," input tensors."));return this.inputNodes.reduce(((e,n,i)=>(e[n]=t[i],e)),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce(((e,n)=>(e[n]=[t[n]],e)),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function oT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t).concat(rT).concat(iT));const n=new sT(t,e);return await n.load(),n}const aT="2.8.6";var cT,lT=n(6699);function uT(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if(i.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&null!==r.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse){if(mT(t)){const r=Array.isArray(t)?[]:{};i.add(t);for(const s in t){const o=uT(t[s],e,n,i);r[s]=o}return i.delete(t),r}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return n.set(t,r.value),r.value}function hT(t){return dT(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:pT)}function dT(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const i=t[0];if(n.has(i))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&null!==r.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse){if(mT(i)){const r=Array.isArray(i)?[]:{};n.add(i);for(const s in i){const i=dT(t.map((t=>t[s])),e,n);r[s]=i}return n.delete(i),r}throw new Error("Can't recurse into non-iterable type: ".concat(i))}return r.value}function pT(t){return null===t?null:mT(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function fT(t,e){const n=new Map;uT(t,e,n);for(const i of Array.from(n.keys())){const t=n.get(i);if(Lt(t)){const e=await t;n.set(i,e)}}return uT(t,e,n)}function mT(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof xr))}function gT(t){return function(t,e){return uT(t,e)}(t,vT)}function vT(t){return t instanceof xr?{value:t.clone(),recurse:!1}:mT(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}class yT{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class xT extends yT{constructor(){super(xT.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let i=0;i<n;i++)e[i]=this.get(this.wrap(this.begin+i));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function bT(t){return new TT(t)}function wT(t){return new ET(t)}function ST(t,e){return new FT(t,e)}xT.INITIAL_CAPACITY=32;class _T{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new NT(this,t)}filter(t){return new OT(this,t)}map(t){return new RT(this,t)}mapAsync(t){return new MT(this,t)}serialMapAsync(t){return new MT(this,t).serial()}flatmap(t){return new PT(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile((t=>!0===t))}rowMajorBatch(t){return new IT(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pT;return this.rowMajorBatch(t,e).map((t=>hT(t,n)))}concatenate(t,e){return new FT(bT([this,t]),e)}take(t){return t<0||null==t?this:new AT(this,t)}skip(t){return t<0||null==t?this:new kT(this,t)}prefetch(t){return new BT(this,t)}shuffle(t,e){return new zT(this,t,e)}serial(){return new CT(this)}}class TT extends _T{constructor(t){super(),this.items=t,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:gT(t),done:!1}}}class ET extends _T{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: ".concat(t.message),t}}}class CT extends _T{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class kT extends _T{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;pa(t.value)}return this.upstream.next()}}class AT extends _T{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class IT extends _T{constructor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class OT extends _T{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;pa(t.value)}}}class RT extends _T{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=Nr(t.value),n=this.transform(t.value),i=Nr(n);for(const r of e)Rr(r,i)||r.dispose();return{value:n,done:!1}}}class NT extends _T{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class MT extends _T{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=Nr(t.value),n=await this.transform(t.value),i=Nr(n);for(const r of e)Rr(r,i)||r.dispose();return{value:n,done:!1}}}class DT extends _T{constructor(){super(),this.outputQueue=new xT,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class PT extends DT{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=Nr(t.value),n=this.transform(t.value),i=Nr(n);this.outputQueue.pushAll(n);for(const r of e)Rr(r,i)||r.dispose();return!0}}class FT extends _T{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(cT||(cT={}));class LT extends _T{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cT.FAIL;super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{".concat("TODO: fill in upstream of zip summaries","} -> Zip")}async nextState(t){await t;let e=0,n=0;const i=await fT(this.iterators,(function(t){if(t instanceof _T){return{value:t.next().then((t=>(e++,t.done&&n++,t.value))),recurse:!1}}return{value:null,recurse:!0}}));if(e===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case cT.FAIL:throw new Error("Zipped streams should have the same length. "+"Mismatched at element ".concat(this.count,"."));case cT.SHORTEST:return{value:null,done:!0};case cT.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class BT extends _T{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new yT(e)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class zT extends BT{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=lT.alea(n||hr().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}class UT{constructor(){this.size=null}batch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let i;return J(t>0,(()=>"batchSize needs to be positive, but it is\n      ".concat(t))),i=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),jT((async()=>(await n.iterator()).columnMajorBatch(t,e,GT)),i)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,jT((async()=>(await e.iterator()).concatenate(await t.iterator())),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,jT((async()=>(await e.iterator()).filter((e=>da((()=>t(e)))))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return jT((async()=>(await e.iterator()).map((e=>da((()=>t(e)))))),this.size)}mapAsync(t){const e=this;return jT((async()=>(await e.iterator()).mapAsync(t)),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return jT((async()=>(await e.iterator()).prefetch(t)),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,jT((async()=>ST(wT((async()=>({value:await e.iterator(),done:!1}))).take(t))),n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,jT((async()=>(await e.iterator()).skip(t)),n)}shuffle(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const i=this,r=lT.alea(e||hr().toString());return jT((async()=>{let e=r.int32();return n&&(e+=r.int32()),(await i.iterator()).shuffle(t,e.toString())}),this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,jT((async()=>(await e.iterator()).take(t)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function jT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends UT{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function VT(t){return jT((async()=>bT(t)),t.length)}function WT(t){if(!mT(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=null==e?t[n].size:Math.min(e,t[n].size);return jT((async()=>function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cT.FAIL;return new LT(t,e)}(await fT(t,(t=>{if(t instanceof UT)return{value:t.iterator(),recurse:!1};if(mT(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})),cT.SHORTEST)),e)}function GT(t){if(null===t)return null;if(function(t){return null==t||null===(e=t)||"object"!==typeof e&&"function"!==typeof e||Array.isArray(t)||"object"===typeof t&&t instanceof xr||xt(t);var e}(t[0])){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof xr?lh(t):Zr(t)}(t),recurse:!1}}return{value:null,recurse:!0}}UT.MAX_BUFFER_SIZE=1e4;class qT extends UT{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map((t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t)))}}const HT='"',XT=Symbol("out"),YT=Symbol("field"),KT=Symbol("quote"),QT=Symbol("quoteafterquote"),ZT=Symbol("quoteinquote");class JT extends UT{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new qT(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(J(null==e.delimiter,(()=>"Delimiter should not be provided when delimWhitespace is true.")),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&J(t.length===this.fullColumnNames.length,(()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+").")),this.fullColumnNames||(this.fullColumnNames=t);const e=this.fullColumnNames.reduce(((t,e)=>(t[e]=t[e]+1||1,t)),{}),n=Object.keys(e).filter((t=>e[t]>1));if(J(0===n.length,(()=>"Duplicate column names found: "+n.toString())),this.columnConfigs)for(const i of Object.keys(this.columnConfigs)){if(-1===this.fullColumnNames.indexOf(i))throw new Error('The key "'+i+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await this.base.iterator(),e=await t.next();if(e.done)throw new Error("No data was found for CSV parsing.");const n=e.value;return this.parseRow(n,!1)}return null}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map((t=>this.makeDataElement(t)))}makeDataElement(t){const e=this.parseRow(t),n={},i={};for(let r=0;r<this.fullColumnNames.length;r++){const s=this.fullColumnNames[r],o=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||o){const a=e[r];let c=null;if(""===a)if(o&&void 0!==o.default)c=o.default;else{if(o&&(o.required||o.isLabel))throw new Error("Required column ".concat(s," is empty in this line: ").concat(t));c=void 0}else{const t=Number(a);if(isNaN(t))c=o&&"bool"===o.dtype?this.getBoolean(a):a;else if(o&&o.dtype)switch(o.dtype){case"float32":default:c=t;break;case"int32":c=Math.floor(t);break;case"bool":c=this.getBoolean(a)}else c=t}o&&o.isLabel?i[s]=c:n[s]=c}}return 0===Object.keys(i).length?n:{xs:n,ys:i}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=[];let i=0;const r=t.length;let s=XT;for(let o=0;o<r;o++)switch(s){case XT:switch(t.charAt(o)){case HT:i=o+1,s=KT;break;case this.delimiter:if(i=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),s=XT;break;default:s=YT,i=o}break;case YT:if(t.charAt(o)===this.delimiter)n.push(t.substring(i,o)),s=XT,i=o+1;break;case KT:if(t.charAt(o)===HT)s=QT;break;case QT:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(i,o-1)),s=XT,i=o+1;break;case HT:s=KT;break;default:s=ZT}break;case ZT:if(t.charAt(o)===HT)s=KT}if(s===QT?n.push(t.substring(i,r-1)):n.push(t.substring(i)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have ".concat(this.fullColumnNames.length," elements in a row, but got ").concat(n));return n}}class $T extends _T{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error("Invalid fftSize: it must be a power of 2 between "+"2 to 4 and 2 to 14, but got ".concat(this.fftSize));if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Ut().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const e=new $T(t);return await e.start(),e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: ".concat(n.message))}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: "+"Expected: ".concat(this.sampleRateHz,"; ")+"Actual: ".concat(this.audioContext.sampleRate))}else this.sampleRateHz=this.audioContext.sampleRate;const e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,e;const n=await this.getAudioData();if(this.includeSpectrogram){const e=this.flattenQueue(n.freqDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const t=this.flattenQueue(n.timeDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],e=[];let n=0;return new Promise((i=>{const r=setInterval((()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(r),i({freqDataQueue:t,timeDataQueue:e}))}),this.fftSize/this.sampleRateHz*1e3)}))}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,n=new Float32Array(t.length*e);return t.forEach(((t,i)=>n.set(t,i*e))),n}getTensorFromAudioDataArray(t,e){const n=new Float32Array(nt(e));return n.set(t,n.length-t.length),Zr(n,e)}}class tE extends _T{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=ph([0],"int32"),this.webcamConfig.centerCrop){const t=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,e=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-t)/2,i=(1-e)/2,r=n+t,s=e+i;this.cropBox=fh([i,n,s,r],[1,4])}else this.cropBox=fh([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ut().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const n=new tE(t,e);return await n.start(),n}async start(){this.webcamConfig.facingMode&&J("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(()=>"Invalid webcam facing mode: ".concat(this.webcamConfig.facingMode,". ")+"Please provide 'user' or 'environment'"));try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message="Error thrown while initializing video stream: ".concat(t.message),t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise((t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}}))}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=wo(this.webcamVideoElement)}catch(e){throw new Error("Error thrown converting video to pixels: ".concat(JSON.stringify(e)))}if(!this.resize)return{value:t,done:!1};try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(e){throw new Error("Error thrown cropping the video: ".concat(e.message))}finally{t.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return da((()=>{const e=t.toFloat().expandDims(0);let n;n=Kd.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const i=n.shape;return n.reshape(i.slice(1))}))}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach((t=>t.stop()));try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class eE{}class nE extends _T{split(t){return new iE(this,t)}}class iE extends nE{constructor(t,e){super(),this.upstream=t,this.impl=new rE(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class rE extends DT{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const n of e.slice(0,-1))this.outputQueue.push(n);return this.carryover=e[e.length-1],!0}}class sE extends _T{decodeUTF8(){return new oE(this)}}class oE extends nE{constructor(t){super(),this.upstream=t,this.impl=new aE(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class aE extends DT{constructor(t){if(super(),this.upstream=t,Ut().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=n(1601);this.decoder=new t("utf8")}}summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){const t=await this.upstream.next();let e,n;return!t.done&&(e=t.value,n=Ut().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),!0)}}class cE extends sE{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.file=t,this.options=e,J(t instanceof Uint8Array||!!Ut().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),(()=>"FileChunkIterator only supports File, Blob and Uint8Array right now.")),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return"FileChunks ".concat(this.file)}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise(((t,e)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,n)));else{const i=new FileReader;i.onload=n=>{let r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=t=>e(new Error("Aborted")),i.onerror=t=>e(new Error(t.type));const r=this.file.slice(this.offset,n);i.readAsArrayBuffer(r)}this.offset=n}));return{value:await t,done:!1}}}const lE=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});function uE(t){return"string"===typeof t&&"file://"===t.substr(0,7)}class hE extends eE{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.input=t,this.options=e}async iterator(){if(uE(this.input)&&Ut().get("IS_NODE")){const t=n(7792);this.input=t.readFileSync(this.input.substr(7))}return new cE(this.input,this.options)}}class dE extends eE{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.url=t,this.fileOptions=e}async iterator(){return uE(this.url)?new hE(this.url,this.fileOptions).iterator():async function(t){let e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"===typeof t?e=t:(e=t.url,n=lE(t));const r=await dr(e,n);if(r.ok){const t=new Uint8Array(await r.arrayBuffer());return new cE(t,i)}throw new Error(r.statusText)}(this.url,this.fileOptions)}}function pE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new JT(new dE(t),e)}function fE(t){const e=wT(t);return jT((async()=>e))}function mE(t){return jT((async()=>{const e=await t();return wT((()=>e.next()))}))}async function gE(t,e){return tE.create(t,e)}async function vE(t){return $T.create(t)}const yE="2.8.6";function xE(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&J("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors in the CPU backend.")))}))}const bE=Th;class wE extends G{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new W(this,la())}write(t,e,n){this.firstUse&&(this.firstUse=!1,Ut().get("IS_NODE")&&bp("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const i={};return this.data.set(i,{values:t,dtype:n,refCount:1}),i}makeTensorInfo(t,e,n){let i;if("string"===e&&null!=n&&n.length>0&&St(n[0])){const r=n.map((t=>pr(t)));i=this.write(r,t,e)}else i=this.write(n,t,e);return{dataId:i,shape:t,dtype:e}}incRef(t){this.data.get(t).refCount++}decRef(t){if(this.data.has(t)){this.data.get(t).refCount--}}move(t,e,n,i){this.data.set(t,{values:e,dtype:i,refCount:1})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){return Sp(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map((t=>fr(t)))}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return Hs(t.shape,t.dtype,n)}makeOutput(t,e,n){const i=this.write(t,e,n);return la().makeTensorFromDataId(i,e,n,this)}disposeData(t){if(this.data.has(t)){const{complexTensorInfos:e}=this.data.get(t);null!=e&&(this.disposeData(e.real.dataId),this.disposeData(e.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.data.has(e)){const t=this.data.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}async time(t){const e=hr();t();return{kernelMs:hr()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){xE([t],"where");const e=this.readSync(t.dataId);return bE(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function SE(t,e,n){return i=>{let{inputs:r,attrs:s,backend:o}=i;const{x:a}=r;if(xE(a,t),"string"===a.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=o,l=c.data.get(a.dataId).values,u=nt(a.shape),h=n||a.dtype,d=mt(h,u);for(let t=0;t<u;++t)d[t]=e(l[t],s);return c.makeTensorInfo(a.shape,h,d)}}function _E(t,e,n){return i=>{let{inputs:r,attrs:s,backend:o}=i;const{x:a}=r;if(xE(a,t),"string"===a.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=o,l=c.data.get(a.dataId).values,u=n||a.dtype,h=e(l,u,s);return c.makeTensorInfo(a.shape,u,h)}}Sa("cpu",(()=>new wE),1);const TE=SE(ze,(t=>t>=0?t:Math.exp(t)-1)),EE={kernelName:ze,backendName:"cpu",kernelFunc:TE};function CE(t){const{inputs:e,backend:n}=t,{x:i}=e;return n.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}const kE={kernelName:nn,backendName:"cpu",kernelFunc:CE};function AE(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{alpha:s}=i;xE([r],"leakyRelu");const o=nt(r.shape),a=n.data.get(r.dataId).values,c=ft("float32",o);for(let l=0;l<a.length;l++)c[l]=a[l]<0?s*a[l]:a[l];return n.makeTensorInfo(r.shape,"float32",c)}const IE={kernelName:ln,backendName:"cpu",kernelFunc:AE};function OE(t){return(e,n,i,r,s)=>{const o=Qa(e,n),a=o.length,c=At(o),l=ft(s,nt(o)),u=e.length,h=n.length,d=At(e),p=At(n),f=Ya(e,o),m=Ya(n,o);if(f.length+m.length===0)for(let g=0;g<l.length;++g)l[g]=t(i[g%i.length],r[g%r.length]);else for(let g=0;g<l.length;++g){const e=Ft(g,a,c),n=e.slice(-u);f.forEach((t=>n[t]=0));const s=Pt(n,u,d),o=e.slice(-h);m.forEach((t=>o[t]=0));const v=Pt(o,h,p);l[g]=t(i[s],r[v])}return[l,o]}}const RE=OE(((t,e)=>t<0?e*t:t));function NE(t){const{inputs:e,backend:n}=t,{x:i,alpha:r}=e;xE([i,r],"prelu");const s=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values,[a,c]=RE(i.shape,r.shape,s,o,i.dtype);return n.makeTensorInfo(c,i.dtype,a)}const ME={kernelName:Hn,backendName:"cpu",kernelFunc:NE},DE=SE(Zn,(t=>Math.max(0,t))),PE={kernelName:Zn,backendName:"cpu",kernelFunc:DE},FE=SE(ii,(t=>Math.min(Math.max(0,t),6))),LE={kernelName:ii,backendName:"cpu",kernelFunc:FE};function BE(t,e,n,i,r){if("linear"===n)return CE({inputs:{x:e},backend:t});if("relu"===n)return DE({inputs:{x:e},backend:t});if("elu"===n)return TE({inputs:{x:e},backend:t});if("relu6"===n)return FE({inputs:{x:e},backend:t});if("prelu"===n)return NE({inputs:{x:e,alpha:i},backend:t});if("leakyrelu"===n)return AE({inputs:{x:e},backend:t,attrs:{alpha:r}});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function zE(t){const{inputs:e,backend:n}=t,{real:i,imag:r}=e,s=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(i.shape,"complex64");return n.data.get(a.dataId).complexTensorInfos={real:n.makeTensorInfo(i.shape,"float32",s),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const UE={kernelName:ge,backendName:"cpu",kernelFunc:zE};function jE(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return zE({inputs:{real:jE(t,e,"float32"),imag:jE(t,e,"float32")},backend:t})}const i=Nt(nt(e),n);return t.makeTensorInfo(e,n,i)}function VE(t){const{inputs:e,backend:n}=t,{input:i}=e,r=n.data.get(i.dataId).complexTensorInfos.real,s=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,s)}const WE={kernelName:Kn,backendName:"cpu",kernelFunc:VE};function GE(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{dtype:s}=i;if("complex64"===s){if("complex64"===r.dtype)return CE({inputs:{x:r},backend:n});const t=jE(n,r.shape,r.dtype),e=GE({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),i=zE({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),i}if("complex64"===r.dtype){const t=VE({inputs:{input:r},backend:n}),e=GE({inputs:{x:t},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(t),e}if(!yt(r.dtype,s)){const t=CE({inputs:{x:r},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:s}}if("int32"===s){const t=n.data.get(r.dataId).values,e=Int32Array.from(t);return n.makeTensorInfo(r.shape,"int32",e)}if("bool"===s){const t=n.data.get(r.dataId).values,e=ur([0],r.dtype),[i,s]=OE(((t,e)=>t!==e?1:0))(r.shape,[],t,e,"bool");return n.makeTensorInfo(s,"bool",i)}throw new Error("Error in Cast: failed to cast ".concat(r.dtype," to ").concat(s))}const qE={kernelName:pe,backendName:"cpu",kernelFunc:GE};function HE(t,e,n,i){return null==n?n=>{let{inputs:r,backend:s}=n;const{a:o,b:a}=r,c=s;xE([o,a],t);const l=c.data.get(o.dataId).values,u=c.data.get(a.dataId).values,h=i||o.dtype,[d,p]=e(o.shape,a.shape,l,u,h);return c.makeTensorInfo(p,h,d)}:t=>{let{inputs:r,backend:s}=t;const{a:o,b:a}=r,c=s;if("complex64"===o.dtype||"complex64"===a.dtype){const t=GE({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),e=c.data.get(t.dataId),i=e.complexTensorInfos.real,r=e.complexTensorInfos.imag,s=c.data.get(i.dataId).values,l=c.data.get(r.dataId).values,u=GE({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),h=c.data.get(u.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=c.data.get(d.dataId).values,m=c.data.get(p.dataId).values,[g,v,y]=n(o.shape,a.shape,s,l,f,m),x=c.makeTensorInfo(y,"float32",g),b=c.makeTensorInfo(y,"float32",v),w=zE({inputs:{real:x,imag:b},backend:c});return c.disposeIntermediateTensorInfo(t),c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(b),w}{const t=c.data.get(o.dataId).values,n=c.data.get(a.dataId).values,r=i||o.dtype,[s,l]=e(o.shape,a.shape,t,n,r);return c.makeTensorInfo(l,r,s)}}}function XE(t){return(e,n,i,r,s,o)=>{const a=Qa(e,n),c=nt(a),l=a.length,u=At(a),h=ft("float32",c),d=ft("float32",c),p=Ya(e,a),f=Ya(n,a),m=Sp(i,r),g=Sp(s,o),v=e.length,y=At(e),x=n.length,b=At(n);if(p.length+f.length===0)for(let w=0;w<h.length;w++){const e=w%m.length,n=w%g.length,i=t(m[2*e],m[2*e+1],g[2*n],g[2*n+1]);h[w]=i.real,d[w]=i.imag}else for(let w=0;w<h.length;w++){const e=Ft(w,l,u),n=e.slice(-v);p.forEach((t=>n[t]=0));const i=Pt(n,v,y),r=e.slice(-x);f.forEach((t=>r[t]=0));const s=Pt(r,x,b),o=t(m[2*i],m[2*i+1],g[2*s],g[2*s+1]);h[w]=o.real,d[w]=o.imag}return[h,d,a]}}const YE=OE(((t,e)=>t+e)),KE=XE(((t,e,n,i)=>({real:t+n,imag:e+i}))),QE=HE(Yt,YE,KE),ZE={kernelName:Yt,backendName:"cpu",kernelFunc:QE};function JE(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{shape:s}=i,o=nt(r.shape),a=ht(s,o),c=nt(a);J(o===c,(()=>"The new shape (".concat(a,") has ").concat(c," elements and the old ")+"shape (".concat(r.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements.")),n.incRef(r.dataId);const l=n.data.get(r.dataId);if(null!=l.complexTensorInfos){const t=l.complexTensorInfos.real,e=l.complexTensorInfos.imag;t.shape=a,e.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const $E={kernelName:Jn,backendName:"cpu",kernelFunc:JE};function tC(t){const{inputs:e,backend:n,attrs:i}=t,{a:r,b:s}=e,{transposeA:o,transposeB:a}=i;xE([r,s],"matMul");const c=r.shape.length,l=s.shape.length,u=o?r.shape[c-2]:r.shape[c-1],h=a?s.shape[l-1]:s.shape[l-2],d=o?r.shape[c-1]:r.shape[c-2],p=a?s.shape[l-2]:s.shape[l-1],f=r.shape.slice(0,-2),m=s.shape.slice(0,-2),g=nt(f),v=nt(m);J(c>=2&&l>=2&&(g===v||1===g||1===v),(()=>"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(f,") and (").concat(m,").")));const y=(g>v?r.shape.slice(0,-2):s.shape.slice(0,-2)).concat([d,p]);J(u===h,(()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(h,") of Tensors with shapes ").concat(r.shape," and ")+"".concat(s.shape," and transposeA=").concat(o)+" and transposeB=".concat(a," must match.")));const x=a?[v,p,h]:[v,h,p],b=JE({inputs:{x:r},backend:n,attrs:{shape:o?[g,u,d]:[g,d,u]}}),w=JE({inputs:{x:s},backend:n,attrs:{shape:x}}),S=o?b.shape[1]:b.shape[2],_=o?b.shape[2]:b.shape[1],T=a?w.shape[1]:w.shape[2],E=Math.max(g,v),C=n.data.get(b.dataId).values,k=n.data.get(w.dataId).values,A=At(b.shape),I=At(w.shape),[O,R,N]=o?[A[0],1,A[1]]:[A[0],A[1],1],[M,D,P]=a?[1,I[1],I[0]]:[I[1],1,I[0]],F=_*T,L=Hs([E,_,T],b.dtype),B=L.values,z=n.blockSize;for(let U=0;U<E;U++)for(let t=0;t<_;t+=z)for(let e=0;e<T;e+=z)for(let n=0;n<S;n+=z){const i=Math.min(t+z,_),r=Math.min(e+z,T),s=Math.min(n+z,S);for(let o=t;o<i;o++)for(let t=e;t<r;t++){let e=0;for(let i=n;i<s;i++){const n=Math.min(U,g-1)*O,r=Math.min(U,v-1)*P;e+=C[n+o*R+i*N]*k[i*M+t*D+r]}B[U*F+(o*T+t)]+=e}}return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,L.dtype,L.values)}const eC={kernelName:le,backendName:"cpu",kernelFunc:tC};const nC={kernelName:Bi,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{a:r,b:s,bias:o,preluActivationWeights:a}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:h}=i;let d,p,f;const m=[];d=tC({inputs:{a:r,b:s},attrs:{transposeA:c,transposeB:l},backend:n}),o&&(p=QE({inputs:{a:d,b:o},backend:n}),m.push(d),d=p),u&&(f=BE(n,d,u,a,h),m.push(d),d=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return d}};function iC(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const rC={kernelName:qt,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;xE(e,"abs");let i=new Float32Array(nt(e.shape));return i=iC(n.data.get(e.dataId).values),n.makeOutput(i,e.shape,"float32")}},sC=SE(Ht,(t=>Math.acos(t))),oC={kernelName:Ht,backendName:"cpu",kernelFunc:sC},aC=SE(Xt,(t=>Math.acosh(t))),cC={kernelName:Xt,backendName:"cpu",kernelFunc:aC};const lC={kernelName:Kt,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,i=e;xE(e,"addN");const r=i.map((t=>n.data.get(t.dataId).values)),s=Hs(i[0].shape,i[0].dtype),o=s.values;for(let a=0;a<i.length;a++){const t=r[a];for(let e=0;e<o.length;e++)o[e]+=t[e]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}};function uC(t,e,n,i,r){const s=e.length,o=nt(e),a=At(e),c=At(r),l=ft(n,nt(r));for(let u=0;u<o;++u){const e=Ft(u,s,a),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[i[t]];l[Pt(n,s,c)]=t[u]}return l}function hC(t){const{inputs:e,attrs:n,backend:i}=t,{x:r}=e,{perm:s}=n;xE(r,"transpose");const o=r.shape.length,a=new Array(o);for(let l=0;l<a.length;l++)a[l]=r.shape[s[l]];const c=uC(i.data.get(r.dataId).values,r.shape,r.dtype,s,a);return{dataId:i.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const dC={kernelName:Oi,backendName:"cpu",kernelFunc:hC};const pC={kernelName:Qt,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;xE(r,"all");const a=dt(s,r.shape);let c=a;const l=Hl(c,r.shape.length);let u=r;null!=l&&(u=hC({inputs:{x:r},backend:n,attrs:{perm:l}}),c=Yl(c.length,r.shape.length)),ql("all",c,u.shape.length);const[h,d]=Wl(u.shape,c),p=nt(d),f=Nt(nt(h),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const t=v*p;let e=m[t];for(let n=0;n<p;++n){const i=m[t+n];e=e&&i}f[v]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,f);if(o){const t=JE({inputs:{x:g},backend:n,attrs:{shape:Gl(h,a)}});return n.disposeIntermediateTensorInfo(g),t}return g}};const fC={kernelName:Zt,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;xE(r,"any");const a=dt(s,r.shape);let c=a;const l=Hl(c,r.shape.length);let u=r;null!=l&&(u=hC({inputs:{x:r},backend:n,attrs:{perm:l}}),c=Yl(c.length,r.shape.length)),ql("any",c,u.shape.length);const[h,d]=Wl(u.shape,c),p=nt(d),f=Nt(nt(h),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const t=v*p;let e=m[t];for(let n=0;n<p;++n){const i=m[t+n];e=e||i}f[v]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,f);if(o){const t=JE({inputs:{x:g},backend:n,attrs:{shape:Gl(h,a)}});return n.disposeIntermediateTensorInfo(g),t}return g}};const mC={kernelName:Jt,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s}=i;xE(r,"argMax");let o=dt(s,r.shape);const a=Hl(o,r.shape.length);let c=r;const l=[];null!=a&&(c=hC({inputs:{x:r},backend:n,attrs:{perm:a}}),l.push(c),o=Yl(o.length,c.shape.length)),o=[o[0]],ql("argMax",o,c.shape.length);const[u,h]=Wl(c.shape,o),d=Nt(nt(u),"int32"),p=nt(h),f=n.data.get(c.dataId).values;for(let m=0;m<d.length;++m){const t=m*p;let e=f[t],n=0;for(let i=0;i<p;++i){const r=f[t+i];r>e&&(e=r,n=i)}d[m]=n}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(u,"int32",d)}};const gC={kernelName:$t,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s}=i;xE(r,"argMin");let o=dt(s,r.shape);const a=Hl(o,r.shape.length);let c=r;const l=[];null!=a&&(c=hC({inputs:{x:r},backend:n,attrs:{perm:a}}),l.push(c),o=Yl(o.length,c.shape.length)),o=[o[0]],ql("argMin",o,c.shape.length);const[u,h]=Wl(c.shape,o),d=Nt(nt(u),"int32"),p=nt(h),f=n.data.get(c.dataId).values;for(let m=0;m<d.length;++m){const t=m*p;let e=f[t],n=0;for(let i=0;i<p;++i){const r=f[t+i];r<e&&(e=r,n=i)}d[m]=n}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(u,"int32",d)}},vC=SE(te,(t=>Math.asin(t))),yC={kernelName:te,backendName:"cpu",kernelFunc:vC},xC=SE(ee,(t=>Math.asinh(t))),bC={kernelName:ee,backendName:"cpu",kernelFunc:xC},wC=SE(ne,(t=>Math.atan(t))),SC={kernelName:ne,backendName:"cpu",kernelFunc:wC},_C=OE(((t,e)=>Math.atan2(t,e))),TC=HE(re,_C),EC={kernelName:re,backendName:"cpu",kernelFunc:TC},CC=SE(ie,(t=>Math.atanh(t))),kC={kernelName:ie,backendName:"cpu",kernelFunc:CC};function AC(t,e,n,i,r,s){const o=r.strideHeight,a=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,f="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Hs(r.outShape,n),g=m.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3];for(let b=0;b<r.batchSize;++b){const e=b*v,n=b*i[0];for(let m=0;m<r.inChannels;++m)for(let v=0;v<r.outHeight;++v){const b=v*o-d,w=Math.max(0,b),S=Math.min(r.inHeight,u+b),_=e+v*y;for(let e=0;e<r.outWidth;++e){const o=e*a-p,u=Math.max(0,o),d=Math.min(r.inWidth,h+o);let v=f,y=0,b=0;for(let e=w;e<S;e+=c){const r=n+e*i[1];for(let e=u;e<d;e+=l){const n=t[r+e*i[2]+m];"max"===s&&n>v?v=n:"avg"===s&&(y+=n,b++)}if(isNaN(v))break}g[_+e*x+m]="avg"===s?y/b:v}}}return m}function IC(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=Hs(i.outShape,"int32"),a=i.strideHeight,c=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,h=i.effectiveFilterHeight,d=i.effectiveFilterWidth,p=i.padInfo.top,f=i.padInfo.left,m=Hs(e,n,t);for(let g=0;g<i.batchSize;++g)for(let t=0;t<i.inChannels;++t)for(let e=0;e<i.outHeight;++e){const n=e*a-p;let v=n;for(;v<0;)v+=l;const y=Math.min(i.inHeight,h+n);for(let a=0;a<i.outWidth;++a){const h=a*c-f;let p=h;for(;p<0;)p+=u;const x=Math.min(i.inWidth,d+h);let b=Number.NEGATIVE_INFINITY,w=-1;for(let e=v;e<y;e+=l){const o=e-n;for(let n=p;n<x;n+=u){const a=n-h,c=m.get(g,e,n,t);c>b&&(b=c,w=r?s?((g*i.inHeight+e)*i.inWidth+n)*i.inChannels+t:(e*i.inWidth+n)*i.inChannels+t:o*d+a)}}o.set(w,g,e,a,t)}}return o}function OC(t,e,n,i,r,s){const o=r.strideDepth,a=r.strideHeight,c=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,v=r.padInfo.left,y="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Hs(r.outShape,n),b=x.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],_=r.outShape[3]*r.outShape[4],T=r.outShape[4];for(let E=0;E<r.batchSize;++E){const e=E*w,n=E*i[0];for(let x=0;x<r.inChannels;++x)for(let w=0;w<r.outDepth;++w){const E=w*o-m;let C=E;for(;C<0;)C+=l;const k=Math.min(r.inDepth,d+E),A=e+w*S;for(let e=0;e<r.outHeight;++e){const o=e*a-g;let d=o;for(;d<0;)d+=u;const m=Math.min(r.inHeight,p+o),w=A+e*_;for(let e=0;e<r.outWidth;++e){const o=e*c-v;let a=o;for(;a<0;)a+=h;const p=Math.min(r.inWidth,f+o),g=w+e*T;let S=y,_=0,E=0;for(let e=C;e<k;e+=l){const r=n+e*i[1];for(let e=d;e<m;e+=u){const n=r+e*i[2];for(let e=a;e<p;e+=h){const r=t[n+e*i[3]+x];if("max"===s&&r>S?S=r:"avg"===s&&(_+=r,E++),isNaN(S))break}if(isNaN(S))break}if(isNaN(S))break}b[g+x]="avg"===s?_/E:S}}}}return x}const RC={kernelName:se,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e;xE(r,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:c}=i;J(Ec(o,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const l=mc(r.shape,s,o,1,a,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&rt(l.inShape,l.outShape))u=CE({inputs:{x:r},backend:n});else{const t=n.data.get(r.dataId).values,e=At(r.shape),i=AC(t,r.shape,r.dtype,e,l,"avg");u=n.makeTensorInfo(l.outShape,r.dtype,i.values)}return u}};const NC={kernelName:ae,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:c,dataFormat:l,dilations:u}=i;xE(r,"avgPool3d");let h=u;null==h&&(h=[1,1,1]);const d=gc(r.shape,s,o,h,a,c,l),p=OC(n.data.get(r.dataId).values,r.shape,r.dtype,At(r.shape),d,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}};const MC={kernelName:ce,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,{filterSize:o,strides:a,pad:c,dilations:l,dimRoundingMode:u}=i;xE([r,s],"avgPool3DGrad");const h=gc(s.shape,o,a,l,c,u),d=h.strideDepth,p=h.strideHeight,f=h.strideWidth,m=h.filterDepth,g=h.filterHeight,v=h.filterWidth,y=h.dilationDepth,x=h.dilationHeight,b=h.dilationWidth,w=h.effectiveFilterDepth,S=h.effectiveFilterHeight,_=h.effectiveFilterWidth,T=w-1-h.padInfo.front,E=_-1-h.padInfo.left,C=S-1-h.padInfo.top,k=Hs(s.shape,"float32"),A=1/(m*g*v),I=n.bufferSync(r);for(let O=0;O<h.batchSize;++O)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let i=0;i<h.inWidth;++i){const r=e-T,s=n-C,o=i-E;let a=0;for(let e=0;e<w;e+=y){const n=(r+e)/d;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let e=0;e<S;e+=x){const i=(s+e)/p;if(!(i<0||i>=h.outHeight||Math.floor(i)!==i))for(let e=0;e<_;e+=b){const r=(o+e)/f;if(r<0||r>=h.outWidth||Math.floor(r)!==r)continue;a+=I.get(O,n,i,r,t)}}}k.set(a*A,O,e,n,i,t)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};const DC={kernelName:oe,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,o=s;xE([r,s],"avgPoolGrad");const{filterSize:a,strides:c,pad:l}=i,u=mc(o.shape,a,c,1,l),h=u.strideHeight,d=u.strideWidth,p=u.filterHeight,f=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,v=u.effectiveFilterHeight,y=u.effectiveFilterWidth,x=y-1-u.padInfo.left,b=v-1-u.padInfo.top,w=Hs(o.shape,"float32"),S=1/(p*f),_=n.data.get(r.dataId).values,T=Hs(r.shape,"float32",_);for(let E=0;E<u.batchSize;++E)for(let t=0;t<u.inChannels;++t)for(let e=0;e<u.inHeight;++e)for(let n=0;n<u.inWidth;++n){const i=e-b,r=n-x;let s=0;for(let e=0;e<v;e+=m){const n=(i+e)/h;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let e=0;e<y;e+=g){const i=(r+e)/d;if(i<0||i>=u.outWidth||Math.floor(i)!==i)continue;s+=T.get(E,n,i,t)}}w.set(s*S,E,e,n,t)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const PC={kernelName:Ze,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,scale:s,offset:o,mean:a,variance:c}=e;J(a.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),J(null==o||a.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),J(null==s||a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),xE([r,a,c,s,o],"batchNorm");let{varianceEpsilon:l}=i;null==l&&(l=.001);const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(c.dataId).values,p=s?n.data.get(s.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,v=p.length,y=d.length,x=h.length;let b=0,w=0,S=0,_=0;for(let T=0;T<u.length;++T)m[T]=f[b++]+(u[T]-h[w++])*p[S++]/Math.sqrt(d[_++]+l),b>=g&&(b=0),w>=x&&(w=0),S>=v&&(S=0),_>=y&&(_=0);return n.makeTensorInfo(r.shape,r.dtype,m)}};function FC(t,e,n,i,r){const s=Bo(i,e,n),o=nt(n),a=At(i);if(s){const n=zo(e,a);return"string"===r?t.slice(n,n+o):t.subarray(n,n+o)}const c=Hs(i,r,"string"===r?Fp(t):t),l=Hs(n,r);for(let u=0;u<l.size;++u){const t=l.indexToLoc(u),n=t.map(((t,n)=>t+e[n]));l.set(c.get(...n),...t)}return"string"===r?Lp(l.values):l.values}function LC(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{begin:s,size:o}=i;xE(r,"slice");const[a,c]=Uo(r,s,o);Co(r,a,c);const l=FC(n.data.get(r.dataId).values,a,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,l)}const BC={kernelName:ui,backendName:"cpu",kernelFunc:LC};const zC={kernelName:ue,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockShape:s,crops:o}=i;xE([r],"batchToSpaceND");const a=s.reduce(((t,e)=>t*e)),c=ap(r.shape,s,a),l=cp(c.length,s.length),u=lp(r.shape,s,a),h=up(o,s.length),d=hp(u,o,s.length),p=JE({inputs:{x:r},backend:n,attrs:{shape:c}}),f=hC({inputs:{x:p},backend:n,attrs:{perm:l}}),m=JE({inputs:{x:f},backend:n,attrs:{shape:u}}),g=LC({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};function UC(t,e,n,i,r){const s=nt(i),o=Nt(r,n);for(let a=0;a<t.length;a++){const n=t[a];if(n<0)throw new Error("Input x must be non-negative!");n>=r||(o[n]+=s>0?e[a]:1)}return o}function jC(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t.shape[0],s=t.shape[1],o=Hs([r,n],e.dtype);for(let a=0;a<r;a++)for(let r=0;r<s;r++){const s=t.get(a,r);if(s<0)throw new Error("Input x must be non-negative!");s>=n||(i?o.set(1,a,s):e.size>0?o.set(o.get(a,s)+e.get(a,r),a,s):o.set(o.get(a,s)+1,a,s))}return o}const VC={kernelName:he,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,weights:s}=e,{size:o}=i,a=UC(n.data.get(r.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,a)}};function WC(t){return(e,n,i)=>{const r=ft(n,e.length);for(let s=0;s<e.length;++s)r[s]=t(e[s],i);return r}}const GC=WC((t=>Math.ceil(t))),qC=_E(fe,GC),HC={kernelName:fe,backendName:"cpu",kernelFunc:qC},XC=SE(me,((t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),YC={kernelName:me,backendName:"cpu",kernelFunc:XC},KC={kernelName:ve,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,i=new Float32Array(nt(e.shape)),r=n.data.get(e.dataId),s=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values;for(let l=0;l<a.length;l++){const t=a[l],e=c[l];i[l]=Math.hypot(t,e)}return n.makeOutput(i,e.shape,"float32")}};function QC(t,e,n,i){const r=mt(n,nt(e));if(i&&"string"!==n){let e=0;t.forEach((t=>{const n=nt(t.shape);r.set(t.vals,e),e+=n}))}else{let i=0;t.forEach((t=>{const s="string"===n?Fp(t.vals):t.vals;let o=0;for(let n=0;n<t.shape[0];++n){const a=n*e[1]+i;for(let e=0;e<t.shape[1];++e)r[a+e]=s[o++]}i+=t.shape[1]}))}return r}function ZC(t){const{inputs:e,backend:n}=t,{input:i}=e,r=n.data.get(i.dataId).complexTensorInfos.imag,s=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,s)}const JC={kernelName:sn,backendName:"cpu",kernelFunc:ZC};function $C(t){const{inputs:e,backend:n,attrs:i}=t,{axis:r}=i,s=dt(r,e[0].shape)[0];let o=ip(e.map((t=>t.shape)),s);if(0===nt(o))return n.makeTensorInfo(o,e[0].dtype,[]);const a=e.filter((t=>nt(t.shape)>0));if(1===a.length)return CE({inputs:{x:a[0]},backend:n});if(np(a.map((t=>t.shape)),s),"complex64"===a[0].dtype){const t=a.map((t=>VE({inputs:{input:t},backend:n}))),e=a.map((t=>ZC({inputs:{input:t},backend:n}))),i=$C({inputs:t,backend:n,attrs:{axis:s}}),r=$C({inputs:e,backend:n,attrs:{axis:s}}),o=zE({inputs:{real:i,imag:r},backend:n});return t.forEach((t=>n.disposeIntermediateTensorInfo(t))),e.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(r),o}const c=a.map((t=>{const e=nt(t.shape.slice(s));return JE({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})})),l=c.map((t=>({vals:n.data.get(t.dataId).values,shape:t.shape})));o=ip(c.map((t=>t.shape)),1);const u=1===c[0].shape[0],h=QC(l,o,e[0].dtype,u),d=ip(a.map((t=>t.shape)),s),p=n.makeTensorInfo(d,e[0].dtype,h);return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),p}const tk={kernelName:ye,backendName:"cpu",kernelFunc:$C};function ek(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dataFormat:c,dilations:l,dimRoundingMode:u}=i;xE([r,s],"conv2d");const h=Cc(c),d=vc(r.shape,s.shape,o,l,a,u,!1,h),p=d.filterHeight,f=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,v=d.padInfo.left,y=d.padInfo.top,x="channelsLast"===d.dataFormat,b=new mr(d.outShape,r.dtype),w=At(r.shape),S=At(s.shape),_=w[0],T=x?w[1]:w[2],E=x?w[2]:1,C=x?1:w[1],k=b.strides[0],A=x?b.strides[1]:b.strides[2],I=x?b.strides[2]:1,O=x?1:b.strides[1],R=n.data.get(r.dataId).values,N=n.data.get(s.dataId).values,M=b.values;for(let D=0;D<d.batchSize;++D){const t=D*_,e=D*k;for(let n=0;n<d.outHeight;++n){const i=e+n*A,r=n*d.strideHeight-y;for(let e=0;e<p;++e){const n=r+e*m;if(n<0||n>=d.inHeight)continue;const s=e*S[0],o=t+n*T;for(let t=0;t<d.outWidth;++t){const e=i+t*I,n=t*d.strideWidth-v;for(let t=0;t<f;++t){const i=n+t*g;if(i<0||i>=d.inWidth)continue;const r=o+i*E;let a=s+t*S[1];for(let t=0;t<d.inChannels;++t){const n=R[r+t*C];for(let t=0;t<d.outChannels;++t)M[e+t*O]+=n*N[a+t];a+=d.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,M)}const nk={kernelName:xe,backendName:"cpu",kernelFunc:ek};const ik={kernelName:be,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:u}=i;xE([r,s],"conv2dBackpropFilter");const h=Cc(c),d=vc(r.shape,u,o,1,a,l,!1,h),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=d,v="channelsLast"===d.dataFormat,y=new mr(d.filterShape,"float32"),x=d.padInfo.left,b=d.padInfo.top,w=n.data.get(r.dataId).values,S=n.data.get(s.dataId).values,_=new mr(r.shape,r.dtype,w),T=new mr(s.shape,s.dtype,S);for(let E=0;E<m;++E){const t=Math.max(0,Math.ceil((b-E)/p)),e=Math.min(d.outHeight,(d.inHeight+b-E)/p);for(let n=0;n<g;++n){const i=Math.max(0,Math.ceil((x-n)/f)),r=Math.min(d.outWidth,(d.inWidth+x-n)/f);for(let s=0;s<d.inChannels;++s)for(let o=0;o<d.outChannels;++o){let a=0;for(let c=0;c<d.batchSize;++c)for(let l=t;l<e;++l){const t=E+l*p-b;for(let e=i;e<r;++e){const i=n+e*f-x;a+=v?_.get(c,t,i,s)*T.get(c,l,e,o):_.get(c,s,t,i)*T.get(c,o,l,e)}}y.set(a,E,n,s,o)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const rk={kernelName:we,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{inputShape:o,strides:a,pad:c,dataFormat:l,dimRoundingMode:u}=i;xE([r,s],"conv2dBackpropInput");const h=At(s.shape),d=At(r.shape);let p=Cc(l);const f=vc(o,s.shape,a,1,c,u,!1,p),m=new mr(f.inShape,"float32"),g=m.values,v=n.data.get(r.dataId).values,y=n.data.get(s.dataId).values,[x,b,w]=h,{batchSize:S,filterHeight:_,filterWidth:T,inChannels:E,inHeight:C,inWidth:k,outChannels:A,outHeight:I,outWidth:O,strideHeight:R,strideWidth:N}=f;p=f.dataFormat;const M=_-1-f.padInfo.top,D=T-1-f.padInfo.left,P="channelsLast"===p,F=m.strides[0],L=P?m.strides[1]:m.strides[2],B=P?m.strides[2]:1,z=P?1:m.strides[1],U=d[0],j=P?d[1]:d[2],V=P?d[2]:1,W=P?1:d[1];for(let G=0;G<S;++G)for(let t=0;t<E;++t)for(let e=0;e<C;++e){const n=e-M,i=Math.max(0,Math.ceil(n/R)),r=Math.min(I,(_+n)/R);for(let s=0;s<k;++s){const o=s-D,a=Math.max(0,Math.ceil(o/N)),c=Math.min(O,(T+o)/N);let l=0;for(let e=i;e<r;++e){const i=e*R-n;for(let n=a;n<c;++n){const r=U*G+j*e+V*n,s=x*(_-1-i)+b*(T-1-(n*N-o))+w*t;for(let t=0;t<A;++t){l+=v[r+W*t]*y[s+t]}}}g[F*G+L*e+B*s+z*t]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const sk={kernelName:Se,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dilations:c}=i;xE([r,s],"conv3d");const l=yc(r.shape,s.shape,o,c,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=l,v=g.front,y=g.left,x=g.top,b=new mr(l.outShape,r.dtype),w=n.data.get(r.dataId).values,S=n.data.get(s.dataId).values,_=b.values,T=At(r.shape),E=At(s.shape);for(let C=0;C<l.batchSize;++C){const t=C*T[0],e=C*b.strides[0];for(let n=0;n<l.outDepth;++n){const i=e+n*b.strides[1],r=n*l.strideDepth-v;for(let e=0;e<u;++e){const n=r+e*p;if(n<0||n>=l.inDepth)continue;const s=e*E[0],o=t+n*T[1];for(let t=0;t<l.outHeight;++t){const e=i+t*b.strides[2],n=t*l.strideHeight-x;for(let t=0;t<h;++t){const i=n+t*f;if(i<0||i>=l.inHeight)continue;const r=s+t*E[1],a=o+i*T[2];for(let t=0;t<l.outWidth;++t){const n=e+t*l.outChannels,i=t*l.strideWidth-y;for(let t=0;t<d;++t){const e=i+t*m;if(e<0||e>=l.inWidth)continue;const s=r+t*E[2],o=a+e*l.inChannels;let c=s;for(let t=0;t<l.inChannels;++t){const e=w[o+t];for(let t=0;t<l.outChannels;++t)_[n+t]+=e*S[c+t];c+=l.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};const ok={kernelName:_e,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,pad:a,filterShape:c}=i;xE([r,s],"conv3dBackpropFilterV2");const l=At(r.shape),u=At(s.shape),h=yc(r.shape,c,o,1,a),d=h.strideDepth,p=h.strideHeight,f=h.strideWidth,m=h.filterDepth,g=h.filterHeight,v=h.filterWidth,y=new mr(h.filterShape,"float32"),x=y.values,[b,w,S,_]=y.strides,T=n.data.get(s.dataId).values,[E,C,k,A]=u,I=n.data.get(r.dataId).values,[O,R,N,M]=l,D=h.padInfo.front,P=h.padInfo.left,F=h.padInfo.top;for(let L=0;L<m;++L){const t=Math.max(0,Math.ceil((D-L)/d)),e=Math.min(h.outDepth,(h.inDepth+D-L)/d),n=L*b;for(let i=0;i<g;++i){const r=Math.max(0,Math.ceil((F-i)/p)),s=Math.min(h.outHeight,(h.inHeight+F-i)/p),o=i*w+n;for(let n=0;n<v;++n){const a=Math.max(0,Math.ceil((P-n)/f)),c=Math.min(h.outWidth,(h.inWidth+P-n)/f),l=n*S+o;for(let o=0;o<h.inChannels;++o){const u=o*_+l;for(let l=0;l<h.outChannels;++l){let m=0;for(let u=0;u<h.batchSize;++u){const h=u*O,g=u*E;for(let u=t;u<e;++u){const t=(L+u*d-D)*R+h,e=u*C+g;for(let u=r;u<s;++u){const r=(i+u*p-F)*N+t,s=u*k+e;for(let t=a;t<c;++t){const e=t*A+s;m+=I[(n+t*f-P)*M+r+o]*T[e+l]}}}}x[u+l]=m}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const ak={kernelName:Te,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{pad:o,strides:a,inputShape:c}=i;xE([r],"conv3dBackpropInputV2");const l=At(r.shape),u=At(s.shape),h=yc(c,s.shape,a,1,o),d=new mr(h.inShape,"float32"),p=d.values,[f,m,g,v]=d.strides,y=n.data.get(r.dataId).values,[x,b,w,S]=l,_=n.data.get(s.dataId).values,[T,E,C,k]=u,{batchSize:A,filterDepth:I,filterHeight:O,filterWidth:R,inChannels:N,inDepth:M,inHeight:D,inWidth:P,outChannels:F,outDepth:L,outHeight:B,outWidth:z,strideDepth:U,strideHeight:j,strideWidth:V}=h,W=I-1-h.padInfo.front,G=O-1-h.padInfo.top,q=R-1-h.padInfo.left;for(let H=0;H<A;++H)for(let t=0;t<N;++t)for(let e=0;e<M;++e){const n=e-W,i=Math.max(0,Math.ceil(n/U)),r=Math.min(L,(I+n)/U);for(let s=0;s<D;++s){const o=s-G,a=Math.max(0,Math.ceil(o/j)),c=Math.min(B,(O+o)/j);for(let l=0;l<P;++l){const u=l-q,h=Math.max(0,Math.ceil(u/V)),d=Math.min(z,(R+u)/V);let A=0;for(let e=i;e<r;++e){const i=e*U-n;for(let n=a;n<c;++n){const r=n*j-o;for(let s=h;s<d;++s){const o=x*H+b*e+w*n+S*s,a=T*(I-1-i)+E*(O-1-r)+C*(R-1-(s*V-u))+k*t;for(let t=0;t<F;++t){A+=y[o+t]*_[a+t]}}}}p[f*H+m*e+g*s+v*l+t]=A}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},ck=SE(Ee,(t=>Math.cos(t))),lk={kernelName:Ee,backendName:"cpu",kernelFunc:ck},uk=SE(Ce,(t=>Math.cosh(t))),hk={kernelName:Ce,backendName:"cpu",kernelFunc:uk};const dk={kernelName:Ae,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{image:r,boxes:s,boxInd:o}=e,{cropSize:a,method:c,extrapolationValue:l}=i,[u,h,d,p]=r.shape,f=s.shape[0],[m,g]=a,v=Hs([f,m,g,p],"float32"),y=n.data.get(s.dataId).values,x=n.data.get(o.dataId).values,b=n.data.get(r.dataId).values,w=At(r.shape),S=At(v.shape);for(let _=0;_<f;_++){const t=4*_,e=y[t],n=y[t+1],i=y[t+2],r=y[t+3],s=x[_];if(s>=u)continue;const o=m>1?(i-e)*(h-1)/(m-1):0,a=g>1?(r-n)*(d-1)/(g-1):0;for(let u=0;u<m;u++){const t=m>1?e*(h-1)+u*o:.5*(e+i)*(h-1);if(t<0||t>h-1)for(let e=0;e<g;e++)for(let t=0;t<p;t++){const n=t+e*S[2]+u*S[1]+_*S[0];v.values[n]=l}else if("bilinear"===c){const e=Math.floor(t),i=Math.ceil(t),o=t-e;for(let t=0;t<g;t++){const c=g>1?n*(d-1)+t*a:.5*(n+r)*(d-1);if(c<0||c>d-1){for(let e=0;e<p;e++){const n=e+t*S[2]+u*S[1]+_*S[0];v.values[n]=l}continue}const h=Math.floor(c),f=Math.ceil(c),m=c-h;for(let n=0;n<p;n++){let r=n+h*w[2]+e*w[1]+s*w[0];const a=b[r];r=n+f*w[2]+e*w[1]+s*w[0];const c=b[r];r=n+h*w[2]+i*w[1]+s*w[0];const l=b[r];r=n+f*w[2]+i*w[1]+s*w[0];const d=a+(c-a)*m,p=l+(b[r]-l)*m;r=n+t*S[2]+u*S[1]+_*S[0],v.values[r]=d+(p-d)*o}}}else for(let e=0;e<g;++e){const i=g>1?n*(d-1)+e*a:.5*(n+r)*(d-1);if(i<0||i>d-1){for(let t=0;t<p;t++){const n=t+e*S[2]+u*S[1]+_*S[0];v.values[n]=l}continue}const o=Math.round(i),c=Math.round(t);for(let t=0;t<p;t++){const n=t+o*w[2]+c*w[1]+s*w[0],i=t+e*S[2]+u*S[1]+_*S[0];v.values[i]=b[n]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const pk={kernelName:ke,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,exclusive:o,reverse:a}=i;xE(r,"cumsum");const c=Hl([s],r.shape.length);let l=r;null!=c&&(l=hC({inputs:{x:r},backend:n,attrs:{perm:c}}));const u=Yl(1,r.shape.length)[0];if(u!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(u));const h=kr(l.dtype,"int32"),d=Nt(nt(l.shape),h),p=n.data.get(l.dataId).values,f=l.shape[l.shape.length-1],m=a?(t,e)=>t+f-e-1:(t,e)=>t+e;for(let v=0;v<p.length;v+=f)for(let t=0;t<f;t++){const e=m(v,t);if(0===t)d[e]=o?0:p[e];else{const n=m(v,t-1);d[e]=o?p[n]+d[n]:p[e]+d[n]}}const g=n.makeTensorInfo(l.shape,h,d);if(null!=c){const t=hC({inputs:{x:g},backend:n,attrs:{perm:Xl(c)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),t}return g}};const fk={kernelName:Ie,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,weights:s}=e,{size:o,binaryOutput:a}=i;if(1===r.shape.length){const t=UC(n.data.get(r.dataId).values,n.data.get(s.dataId).values,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,t)}if(2===r.shape.length){const t=jC(n.bufferSync(r),n.bufferSync(s),o,a);return n.makeTensorInfo(t.shape,s.dtype,t.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(r.shape.length,"."))}};const mk={kernelName:Oe,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockSize:s,dataFormat:o}=i;J("NHWC"===o,(()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o))),J(s>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(s)));const a=r.shape[0],c=r.shape[1],l=r.shape[2],u=r.shape[3],h=c*s,d=l*s,p=u/(s*s),f=n.data.get(r.dataId).values,m=new Float32Array(a*h*d*p);let g=0;for(let v=0;v<a;++v)for(let t=0;t<h;++t){const e=Math.floor(t/s),n=t%s;for(let t=0;t<d;++t){const i=Math.floor(t/s),r=(n*s+t%s)*p;for(let t=0;t<p;++t){const n=t+r+u*(i+l*(e+c*v));m[g++]=f[n]}}}return n.makeTensorInfo([a,h,d,p],r.dtype,m)}};function gk(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dilations:c,dimRoundingMode:l}=i;xE([r,s],"depthwiseConv2DNative");const u=At(r.shape),h=At(s.shape);let d=c;null==d&&(d=[1,1]),J(Ec(o,d),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(d,"'")));const p=vc(r.shape,s.shape,o,d,a,l,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:v,padInfo:y}=p,x=y.left,b=y.top,w=p.outChannels/p.inChannels,S=new mr(p.outShape,r.dtype),_=n.data.get(r.dataId).values,T=n.data.get(s.dataId).values,E=S.values;for(let C=0;C<p.batchSize;++C){const t=C*u[0],e=C*S.strides[0];for(let n=0;n<p.outHeight;++n){const i=e+n*S.strides[1],r=n*p.strideHeight-x;for(let e=0;e<f;++e){const n=r+e*g;if(n<0||n>=p.inHeight)continue;const s=e*h[0],o=t+n*u[1];for(let t=0;t<p.outWidth;++t){const e=i+t*S.strides[2],n=t*p.strideWidth-b;for(let t=0;t<m;++t){const i=n+t*v;if(i<0||i>=p.inWidth)continue;const r=s+t*h[1],a=o+i*p.inChannels;let c=e,l=r;for(let t=0;t<p.inChannels;++t){const e=_[a+t];for(let t=0;t<w;++t)E[c+t]+=e*T[l+t];c+=w,l+=w}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const vk={kernelName:Re,backendName:"cpu",kernelFunc:gk};const yk={kernelName:Ne,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,filterShape:u}=i;xE([r,s],"depthwiseConv2dNativeBackpropFilter");const h=vc(r.shape,u,o,a,c,l,!0),{strideHeight:d,strideWidth:p,filterHeight:f,filterWidth:m}=h,g=new mr(h.filterShape,"float32"),v=h.padInfo.left,y=h.padInfo.top,x=h.outChannels/h.inChannels,b=n.data.get(r.dataId).values,w=new mr(r.shape,r.dtype,b),S=n.data.get(s.dataId).values,_=new mr(s.shape,s.dtype,S);for(let T=0;T<f;++T){const t=Math.max(0,Math.ceil((y-T)/d)),e=Math.min(h.outHeight,(h.inHeight+y-T)/d);for(let n=0;n<m;++n){const i=Math.max(0,Math.ceil((v-n)/p)),r=Math.min(h.outWidth,(h.inWidth+v-n)/p);for(let s=0;s<h.outChannels;++s){const o=Math.trunc(s/x),a=s%x;let c=0;for(let l=0;l<h.batchSize;++l)for(let a=t;a<e;++a){const t=T+a*d-y;for(let e=i;e<r;++e){const i=n+e*p-v;c+=w.get(l,t,i,o)*_.get(l,a,e,s)}}g.set(c,T,n,o,a)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const xk={kernelName:Me,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,inputShape:u}=i;xE([r,s],"depthwiseConv2DNativeBackpropInput");const h=At(r.shape),d=At(s.shape),p=vc(u,s.shape,o,a,c,l,!0),f=new mr(p.inShape,"float32"),m=f.values,[g,v,y]=f.strides,x=n.data.get(r.dataId).values,[b,w,S]=h,_=n.data.get(s.dataId).values,[T,E,C]=d,{batchSize:k,filterHeight:A,filterWidth:I,inChannels:O,inHeight:R,inWidth:N,outChannels:M,outHeight:D,outWidth:P,strideHeight:F,strideWidth:L}=p,B=A-1-p.padInfo.top,z=I-1-p.padInfo.left,U=M/O;for(let j=0;j<k;++j)for(let t=0;t<O;++t)for(let e=0;e<R;++e){const n=e-B,i=Math.max(0,Math.ceil(n/F)),r=Math.min(D,(A+n)/F);for(let s=0;s<N;++s){const o=s-z,a=Math.max(0,Math.ceil(o/L)),c=Math.min(P,(I+o)/L);let l=0;for(let e=i;e<r;++e){const i=e*F-n;for(let n=a;n<c;++n){const r=b*j+w*e+S*n,s=T*(A-1-i)+E*(I-1-(n*L-o))+C*t;for(let e=0;e<U;++e){l+=x[r+(t*U+e)]*_[s+e]}}}m[g*j+v*e+y*s+t]=l}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const bk={kernelName:De,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e,r=nt(i.shape),s=n.data.get(i.dataId).values,o=Hs([r,r],i.dtype),a=o.values;for(let l=0;l<s.length;l++)a[l*r+l]=s[l];const c=[...i.shape,...i.shape];return n.makeTensorInfo(c,o.dtype,o.values)}},wk={kernelName:Pe,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:r,filter:s}=e,{strides:o,pad:a,dilations:c}=i,l=n,u=l.data.get(r.dataId).values,h=r.shape.length,d=l.data.get(s.dataId).values,p=s.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:x,padInfo:b,strideHeight:w,strideWidth:S,filterHeight:_,filterWidth:T,dilationHeight:E,dilationWidth:C,outShape:k}=fc(r.shape,s.shape,o,a,"NHWC",c),A=nt(k),I=k.length,O=mt(r.dtype,A);for(let R=0;R<f;++R)for(let t=0;t<y;++t){const e=t*w-b.top;for(let n=0;n<x;++n){const i=n*S-b.left;for(let o=0;o<v;++o){let a=Number.MIN_SAFE_INTEGER;for(let t=0;t<_;++t){const n=e+t*E;if(n>=0&&n<m)for(let e=0;e<T;++e){const c=i+e*C;if(c>=0&&c<g){const i=Pt([R,n,c,o],h,At(r.shape)),l=Pt([t,e,o],p,At(s.shape)),f=u[i]+d[l];f>a&&(a=f)}}}O[Pt([R,t,n,o],I,At(k))]=a}}}return{dataId:l.write(ur(O,r.dtype),k,r.dtype),shape:k,dtype:r.dtype}}},Sk={kernelName:Le,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:r,filter:s,dy:o}=e,{strides:a,pad:c,dilations:l}=i,u=n,h=Ot(r.shape,u.data.get(r.dataId).values),d=Ot(s.shape,u.data.get(s.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:x,strideHeight:b,strideWidth:w,filterHeight:S,filterWidth:_,dilationHeight:T,dilationWidth:E,outShape:C}=fc(r.shape,s.shape,a,c,"NHWC",l);J(o.rank===C.length,(()=>"Error in ".concat(Le,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(o.rank)));const k=Ot(C,u.data.get(o.dataId).values),A=Mt(s.shape,s.dtype);for(let I=0;I<p;++I)for(let t=0;t<v;++t){const e=t*b-x.top;for(let n=0;n<y;++n){const i=n*w-x.left;for(let r=0;r<g;++r){let s=Number.MIN_SAFE_INTEGER,o=0,a=0;for(let t=0;t<S;++t){const n=e+t*T;if(n>=0&&n<f)for(let e=0;e<_;++e){const c=i+e*E;if(c>=0&&c<m){const i=h[I][n][c][r]+d[t][e][r];i>s&&(s=i,o=t,a=e)}}}A[o][a][r]+=k[I][t][n][r]}}}return{dataId:u.write(ur(A,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},_k={kernelName:Fe,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:r,filter:s,dy:o}=e,{strides:a,pad:c,dilations:l}=i,u=n,h=Ot(r.shape,u.data.get(r.dataId).values),d=Ot(s.shape,u.data.get(s.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:x,strideHeight:b,strideWidth:w,filterHeight:S,filterWidth:_,dilationHeight:T,dilationWidth:E,outShape:C}=fc(r.shape,s.shape,a,c,"NHWC",l);J(o.rank===C.length,(()=>"Error in ".concat(Fe,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(o.rank)));const k=Ot(C,u.data.get(o.dataId).values),A=Mt(r.shape,r.dtype);for(let I=0;I<p;++I)for(let t=0;t<v;++t){const e=t*b-x.top;for(let n=0;n<y;++n){const i=n*w-x.left;for(let r=0;r<g;++r){let s=Number.MIN_SAFE_INTEGER,o=e<0?0:e,a=i<0?0:i;for(let t=0;t<S;++t){const n=e+t*T;if(n>=0&&n<f)for(let e=0;e<_;++e){const c=i+e*E;if(c>=0&&c<m){const i=h[I][n][c][r]+d[t][e][r];i>s&&(s=i,o=n,a=c)}}}A[I][o][a][r]+=k[I][t][n][r]}}}return{dataId:u.write(ur(A,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};const Tk={kernelName:Ue,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:i,y:r}=e;xE([i,r],"eluGrad");const s=new Float32Array(nt(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values;for(let c=0;c<o.length;++c){const t=o[c];s[c]=t>=1?a[c]:a[c]*(t+1)}return n.makeTensorInfo(r.shape,"float32",s)}},Ek=OE(((t,e)=>t===e?1:0)),Ck=HE(Ve,Ek,null,"bool"),kk={kernelName:Ve,backendName:"cpu",kernelFunc:Ck},Ak=fp,Ik=mp,Ok=gp,Rk=vp,Nk=yp,Mk=xp,Dk=SE(je,(t=>{const e=Math.sign(t),n=Math.abs(t),i=1/(1+Ak*n);return e*(1-((((Mk*i+Nk)*i+Rk)*i+Ok)*i+Ik)*i*Math.exp(-n*n))})),Pk={kernelName:je,backendName:"cpu",kernelFunc:Dk},Fk=WC((t=>Math.exp(t))),Lk=_E(We,Fk),Bk={kernelName:We,backendName:"cpu",kernelFunc:Lk};function zk(t){const{inputs:e,backend:n,attrs:i}=t,{input:r}=e,{dim:s}=i,o=r.shape.length,a=r.shape.slice();let c=s;return s<0&&(J(-(o+1)<=s,(()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]"))),c=o+s+1),a.splice(c,0,1),JE({inputs:{x:r},backend:n,attrs:{shape:a}})}const Uk={kernelName:Ge,backendName:"cpu",kernelFunc:zk},jk=WC((t=>Math.expm1(t))),Vk=_E(qe,jk),Wk={kernelName:qe,backendName:"cpu",kernelFunc:Vk},Gk=OE(((t,e)=>t*e)),qk=XE(((t,e,n,i)=>({real:t*n-e*i,imag:t*i+e*n}))),Hk=HE(Dn,Gk,qk),Xk={kernelName:Dn,backendName:"cpu",kernelFunc:Hk},Yk=OE(((t,e)=>t/e)),Kk=HE(Be,Yk),Qk={kernelName:Be,backendName:"cpu",kernelFunc:Kk},Zk=OE(((t,e)=>t-e)),Jk=XE(((t,e,n,i)=>({real:t-n,imag:e-i}))),$k=HE(_i,Zk,Jk),tA={kernelName:_i,backendName:"cpu",kernelFunc:$k};function eA(t,e,n){const i=t.shape,r=i[0],s=i[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,l=[r,s],u=nt(l),h=ft("float32",u),d=ft("float32",u);for(let g=0;g<r;g++){const t=LC({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,s]}}),i=LC({inputs:{x:c},backend:n,attrs:{begin:[g,0],size:[1,s]}}),r=zE({inputs:{real:t,imag:i},backend:n}),{real:o,imag:l}=nA(r,e,n),u=Sp(o,l);for(let e=0;e<s;e++){const t=Cp(u,e);h[g*s+e]=t.real,d[g*s+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(r)}const p=n.makeTensorInfo(l,"float32",h),f=n.makeTensorInfo(l,"float32",d),m=zE({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}function nA(t,e,n){const i=nt(t.shape),r=n.data.get(t.dataId),s=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(0===((a=i)&a-1)){const r=iA(s,o,i,e,n),a=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(a,"float32",r.real),e=n.makeTensorInfo(a,"float32",r.imag),s=n.makeTensorInfo([],"float32",lr(i,"float32")),o=CE({inputs:{x:s},backend:n}),c=Qk.kernelFunc({inputs:{a:t,b:s},backend:n}),l=Qk.kernelFunc({inputs:{a:e,b:o},backend:n}),u=n.data.get(c.dataId).values,h=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),{real:u,imag:h}}return r}{const t=function(t,e,n){const i=new Float32Array(2*e);for(let r=0;r<e;r++){let s=0,o=0;for(let i=0;i<e;i++){const a=Ip(r*i,e,n),c=Cp(t,i);s+=c.real*a.real-c.imag*a.imag,o+=c.real*a.imag+c.imag*a.real}n&&(s/=e,o/=e),kp(i,s,o,r)}return i}(Sp(s,o),i,e);return _p(t)}var a}function iA(t,e,n,i,r){if(1===n)return{real:t,imag:e};const s=Sp(t,e),o=n/2,a=Tp(s),c=a.real,l=a.imag,u=[c.length],h=r.makeTensorInfo(u,"float32",c),d=r.makeTensorInfo(u,"float32",l),p=zE({inputs:{real:h,imag:d},backend:r}),f=Ep(s),m=f.real,g=f.imag,v=[m.length],y=r.makeTensorInfo(v,"float32",m),x=r.makeTensorInfo(v,"float32",g),b=zE({inputs:{real:y,imag:x},backend:r}),w=iA(c,l,o,i,r),S=w.real,_=w.imag,T=[S.length],E=r.makeTensorInfo(T,"float32",S),C=r.makeTensorInfo(T,"float32",_),k=zE({inputs:{real:E,imag:C},backend:r}),A=iA(m,g,o,i,r),I=A.real,O=A.imag,R=[I.length],N=r.makeTensorInfo(R,"float32",I),M=r.makeTensorInfo(R,"float32",O),D=zE({inputs:{real:N,imag:M},backend:r}),P=Ap(n,i),F=[P.real.length],L=r.makeTensorInfo(F,"float32",P.real),B=r.makeTensorInfo(F,"float32",P.imag),z=zE({inputs:{real:L,imag:B},backend:r}),U=Hk({inputs:{a:z,b:D},backend:r}),j=QE({inputs:{a:k,b:U},backend:r}),V=$k({inputs:{a:k,b:U},backend:r}),W=VE({inputs:{input:j},backend:r}),G=VE({inputs:{input:V},backend:r}),q=ZC({inputs:{input:j},backend:r}),H=ZC({inputs:{input:V},backend:r}),X=$C({inputs:[W,G],backend:r,attrs:{axis:0}}),Y=$C({inputs:[q,H],backend:r,attrs:{axis:0}}),K=r.data.get(X.dataId).values,Q=r.data.get(Y.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(V),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(Y),{real:K,imag:Q}}const rA={kernelName:He,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e,r=nt(i.shape),s=i.shape[i.shape.length-1],o=JE({inputs:{x:i},backend:n,attrs:{shape:[r/s,s]}}),a=eA(o,!1,n),c=JE({inputs:{x:a},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}};function sA(t){const{backend:e,attrs:n}=t,{shape:i,value:r,dtype:s}=n,o=s||Et(r),a=mt(o,nt(i));return function(t,e,n){t.fill(e)}(a,r),e.makeTensorInfo(i,o,a)}const oA={kernelName:Xe,backendName:"cpu",kernelFunc:sA};const aA={kernelName:Ye,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:r}=e,s=i,o=ft(r.dtype,nt(r.shape)),[a,c,l,u]=r.shape,h=s.data.get(r.dataId).values;for(let d=0;d<a;d++){const t=d*l*c*u;for(let e=0;e<c;e++){const n=e*(l*u);for(let i=0;i<l;i++){const r=i*u;for(let s=0;s<u;s++){const c=[a,e,i,s][2],d=Math.round(l-c),p=t+n+r+s;let f=h[p];if(d>=0&&d<l){f=h[t+n+d*u+s]}o[p]=f}}}}return{dataId:s.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},cA=WC((t=>Math.floor(t))),lA=_E(Ke,cA),uA={kernelName:Ke,backendName:"cpu",kernelFunc:lA},hA=OE(((t,e)=>Math.floor(t/e))),dA=HE(Qe,hA,null,"int32"),pA={kernelName:Qe,backendName:"cpu",kernelFunc:dA};const fA={kernelName:zi,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=i;let m=ek({inputs:{x:r,filter:s},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const t=m;m=QE({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=m;m=BE(n,m,p,a,f),n.disposeIntermediateTensorInfo(t)}return m}};const mA={kernelName:Ui,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=i;let m=gk({inputs:{x:r,filter:s},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const t=m;m=QE({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=m;m=BE(n,m,p,a,f),n.disposeIntermediateTensorInfo(t)}return m}};const gA={kernelName:$e,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:i,indices:r}=e,s=nt(i.shape),o=r.shape,a=o[o.length-1],[c,l,u,h]=So(i,r);if(0===l)return n.makeTensorInfo(c,i.dtype,[]);const d=Hs([l,u],i.dtype),p=n.data.get(r.dataId).values,f=n.data.get(i.dataId).values;for(let m=0;m<l;m++){const t=[];let e=0;for(let n=0;n<a;n++){const i=p[m*a+n];e+=i*h[n],t.push(i)}if(e<0||e>=s/u)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(i.shape));for(let n=0;n<u;n++)d.values[m*u+n]=f[e*u+n]}return n.makeTensorInfo(c,d.dtype,d.values)}};function vA(t,e,n){const i=Hs(n,t.dtype);for(let r=0;r<i.size;++r){const n=i.indexToLoc(r).slice(),s=n[0],o=n[2],a=e.locToIndex([s,o]);n[2]=e.values[a];const c=t.locToIndex(n);i.values[r]=t.values[c]}return i}const yA={kernelName:Je,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,indices:s}=e,{axis:o,batchDims:a}=i;xE([r,s],"gatherV2");let c=a;null==a&&(c=0);const l=nt(s.shape),u=Mp(r,s,dt(o,r.shape)[0],c),h=JE({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=JE({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,l/u.batchSize]}}),p=[u.batchSize,u.outerSize,l/u.batchSize,u.sliceSize],f=n.bufferSync(d),m=vA(n.bufferSync(h),f,p);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.makeTensorInfo(u.outputShape,m.dtype,m.values)}},xA=OE(((t,e)=>t>e?1:0)),bA=HE(tn,xA,null,"bool"),wA={kernelName:tn,backendName:"cpu",kernelFunc:bA},SA=OE(((t,e)=>t>=e?1:0)),_A=HE(en,SA,null,"bool"),TA={kernelName:en,backendName:"cpu",kernelFunc:_A};const EA={kernelName:rn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e,r=nt(i.shape),s=i.shape[i.shape.length-1],o=JE({inputs:{x:i},backend:n,attrs:{shape:[r/s,s]}}),a=eA(o,!0,n),c=JE({inputs:{x:a},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}},CA=SE(on,(t=>Number.isFinite(t)?1:0),"bool"),kA={kernelName:on,backendName:"cpu",kernelFunc:CA},AA=SE(an,(t=>Math.abs(t)===1/0?1:0),"bool"),IA={kernelName:an,backendName:"cpu",kernelFunc:AA},OA=SE(cn,(t=>Number.isNaN(t)?1:0),"bool"),RA={kernelName:cn,backendName:"cpu",kernelFunc:OA},NA=OE(((t,e)=>t<e?1:0)),MA=HE(un,NA,null,"bool"),DA={kernelName:un,backendName:"cpu",kernelFunc:MA},PA=OE(((t,e)=>t<=e?1:0)),FA=HE(hn,PA,null,"bool"),LA={kernelName:hn,backendName:"cpu",kernelFunc:FA};function BA(t,e,n){const i=(e-t)/(n-1),r=Nt(n,"float32");r[0]=t;for(let s=1;s<r.length;s++)r[s]=r[s-1]+i;return r}const zA={kernelName:dn,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:i,stop:r,num:s}=n,o=BA(i,r,s);return e.makeTensorInfo([o.length],"float32",o)}},UA=WC((t=>Math.log(t))),jA=_E(pn,UA),VA={kernelName:pn,backendName:"cpu",kernelFunc:jA},WA=SE(fn,(t=>Math.log1p(t))),GA={kernelName:fn,backendName:"cpu",kernelFunc:WA},qA=OE(((t,e)=>t&&e)),HA=HE(mn,qA,null,"bool"),XA={kernelName:mn,backendName:"cpu",kernelFunc:HA},YA=SE(gn,(t=>t?0:1),"bool"),KA={kernelName:gn,backendName:"cpu",kernelFunc:YA},QA=OE(((t,e)=>t||e)),ZA=HE(vn,QA,null,"bool"),JA={kernelName:vn,backendName:"cpu",kernelFunc:ZA};const $A={kernelName:xn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{depthRadius:s,bias:o,alpha:a,beta:c}=i;xE(r,"LRN");const l=r.shape[3],u=l-1,h=n.data.get(r.dataId).values,d=nt(r.shape),p=new Float32Array(d);function f(t){const e=t%l;let n=t-e+Math.max(0,e-s);const i=t-e+Math.min(e+s,u);let r=0;for(;n<=i;n++){const t=h[n];r+=t*t}return r}for(let m=0;m<d;m++){const t=f(m),e=h[m]*Math.pow(o+a*t,-c);p[m]=e}return n.makeTensorInfo(r.shape,r.dtype,p)}};const tI={kernelName:bn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,y:s,dy:o}=e,{depthRadius:a,bias:c,alpha:l,beta:u}=i;xE(o,"LRNGrad");const h=nt(o.shape),d=o.shape[3],p=n.data.get(o.dataId).values,f=n.data.get(r.dataId).values,m=n.data.get(s.dataId).values,g=new Float32Array(h),v=h;for(let y=0;y<v;y++){const t=y%d,e=y-t+Math.max(0,t-a),n=y-t+Math.min(d,t+a+1);let i=0;for(let r=e;r<n;r++)i+=Math.pow(f[r],2);i=l*i+c;for(let r=e;r<n;r++){let t=-2*l*u*f[r]*m[y]/i;y===r&&(t+=Math.pow(i,-u)),t*=p[y],g[r]+=t}}return n.makeTensorInfo(o.shape,r.dtype,g)}};function eI(t,e,n,i){const r=ft(i,nt(n));for(let s=0;s<r.length;++s){const n=s*e;let i=t[n];for(let r=0;r<e;++r){const e=t[n+r];e>i&&(i=e)}r[s]=i}return r}function nI(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{reductionIndices:s,keepDims:o}=i,a=n;let c=r.shape;const l=c.length,u=dt(s,c);let h=u;const d=Hl(h,l);let p=a.data.get(r.dataId).values;if(null!=d){const t=new Array(l);for(let e=0;e<t.length;e++)t[e]=c[d[e]];p=uC(p,c,r.dtype,d,t),h=Yl(h.length,l),c=t}xE(r,"max"),ql("max",h,l);const[f,m]=Wl(c,h),g=eI(p,nt(m),f,r.dtype),v=a.write(g,f,r.dtype);let y=f;if(o){y=Gl(f,u)}return{dataId:v,shape:y,dtype:r.dtype}}const iI={kernelName:wn,backendName:"cpu",kernelFunc:nI},rI=OE(((t,e)=>Math.max(t,e))),sI=HE(Sn,rI),oI={kernelName:Sn,backendName:"cpu",kernelFunc:sI};const aI={kernelName:_n,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e;xE(r,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:c}=i;J(Ec(o,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const l=mc(r.shape,s,o,1,a,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&rt(l.inShape,l.outShape))u=CE({inputs:{x:r},backend:n});else{const t=n.data.get(r.dataId).values,e=At(r.shape),i=AC(t,r.shape,r.dtype,e,l,"max");u=n.makeTensorInfo(l.outShape,r.dtype,i.values)}return u}};const cI={kernelName:En,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:c,dataFormat:l,dilations:u}=i;xE(r,"maxPool3d");let h=u;null==h&&(h=[1,1,1]);const d=gc(r.shape,s,o,h,a,c,l),p=OC(n.data.get(r.dataId).values,r.shape,r.dtype,At(r.shape),d,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}};const lI={kernelName:Cn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,{filterSize:o,strides:a,pad:c,dilations:l,dimRoundingMode:u}=i;xE([r,s],"maxPool3DGrad");const h=gc(s.shape,o,a,l,c,u),d=function(t,e){const n=Hs(e.outShape,"int32"),i=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let v=0;v<e.outDepth;++v){const y=v*i-d;let x=y;for(;x<0;)x+=o;const b=Math.min(e.inDepth,l+y);for(let i=0;i<e.outHeight;++i){const l=i*r-p;let d=l;for(;d<0;)d+=a;const w=Math.min(e.inHeight,u+l);for(let r=0;r<e.outWidth;++r){const p=r*s-f;let S=p;for(;S<0;)S+=c;const _=Math.min(e.inWidth,h+p);let T=Number.NEGATIVE_INFINITY,E=-1;for(let e=x;e<b;e+=o){const n=e-y;for(let i=d;i<w;i+=a){const r=i-l;for(let s=S;s<_;s+=c){const o=s-p,a=t.get(m,e,i,s,g);a>=T&&(T=a,E=n*u*h+r*u+o)}}}n.set(E,m,v,i,r,g)}}}return n}(n.bufferSync(s),h),p=h.strideDepth,f=h.strideHeight,m=h.strideWidth,g=h.dilationDepth,v=h.dilationHeight,y=h.dilationWidth,x=h.effectiveFilterDepth,b=h.effectiveFilterHeight,w=h.effectiveFilterWidth,S=x-1-h.padInfo.front,_=w-1-h.padInfo.left,T=b-1-h.padInfo.top,E=Hs(s.shape,"float32"),C=n.bufferSync(r);for(let k=0;k<h.batchSize;++k)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let i=0;i<h.inWidth;++i){const r=e-S,s=n-T,o=i-_;let a=0;for(let e=0;e<x;e+=g){const n=(r+e)/p;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let i=0;i<b;i+=v){const r=(s+i)/f;if(!(r<0||r>=h.outHeight||Math.floor(r)!==r))for(let s=0;s<w;s+=y){const c=(o+s)/m;if(c<0||c>=h.outWidth||Math.floor(c)!==c)continue;const l=x*b*w-1-d.get(k,n,r,c,t)===e*b*w+i*w+s?1:0;if(0===l)continue;a+=C.get(k,n,r,c,t)*l}}}E.set(a,k,e,n,i,t)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};const uI={kernelName:Tn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s,output:o}=e,a=s;xE([s,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:h}=i,d=mc(a.shape,c,l,1,u,h),p=n.data.get(a.dataId).values,f=Hs(d.outShape,a.dtype,IC(p,a.shape,a.dtype,d).values),m=d.strideHeight,g=d.strideWidth,v=d.dilationHeight,y=d.dilationWidth,x=d.effectiveFilterHeight,b=d.effectiveFilterWidth,w=b-1-d.padInfo.left,S=x-1-d.padInfo.top,_=Hs(a.shape,"float32"),T=n.data.get(r.dataId).values,E=Hs(r.shape,"float32",T);for(let C=0;C<d.batchSize;++C)for(let t=0;t<d.inChannels;++t)for(let e=0;e<d.inHeight;++e)for(let n=0;n<d.inWidth;++n){const i=e-S,r=n-w;let s=0;for(let e=0;e<x;e+=v){const n=(i+e)/m;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let i=0;i<b;i+=y){const o=(r+i)/g;if(o<0||o>=d.outWidth||Math.floor(o)!==o)continue;const a=x*b-1-f.get(C,n,o,t)===e*b+i?1:0;if(0===a)continue;s+=E.get(C,n,o,t)*a}}_.set(s,C,e,n,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};const hI={kernelName:kn,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:r}=e,{filterSize:s,strides:o,pad:a,includeBatchInIndex:c}=n,l=i;xE(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,h=mc(r.shape,s,o,[1,1],a),[d,p]=function(t,e,n,i,r){const s=AC(t,0,n,At(e),r,"max"),o=IC(t,e,n,r,!0,i);return[s.values,o.values]}(u,r.shape,r.dtype,c,h),f=l.write(d,h.outShape,r.dtype),m=l.write(p,h.outShape,r.dtype);return[{dataId:f,shape:h.outShape,dtype:r.dtype},{dataId:m,shape:h.outShape,dtype:"int32"}]}};function dI(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;let a;xE(r,"sum"),a="bool"===r.dtype?GE({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):CE({inputs:{x:r},backend:n});const c=a.shape.length,l=dt(s,a.shape),u=Hl(l,c);let h=l,d=a;null!=u&&(d=hC({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Yl(h.length,c)),ql("sum",h,d.shape.length);const[p,f]=Wl(d.shape,h);let m=jE(n,p,kr(d.dtype,"int32"));const g=nt(f),v=n.data.get(m.dataId).values,y=n.data.get(d.dataId).values;for(let x=0;x<v.length;++x){const t=x*g;let e=0;for(let n=0;n<g;++n)e+=y[t+n];v[x]=e}if(o){const t=m;m=JE({inputs:{x:m},backend:n,attrs:{shape:Gl(m.shape,l)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(a),null!=u&&n.disposeIntermediateTensorInfo(d),m}const pI={kernelName:vi,backendName:"cpu",kernelFunc:dI};const fI={kernelName:An,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i,a=dt(s,r.shape),c=nt(Wl(r.shape,a)[1]),l=[],u=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(u);const h=GE({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});l.push(h);const d=Kk({inputs:{a:h,b:u},backend:n});l.push(d);const p=dI({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:o}});return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),p}};const mI={kernelName:In,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;xE(r,"min");const a=dt(s,r.shape);let c=a;const l=Hl(c,r.shape.length);let u=r;null!=l&&(u=hC({inputs:{x:r},backend:n,attrs:{perm:l}}),c=Yl(c.length,r.shape.length)),ql("min",c,u.shape.length);const[h,d]=Wl(u.shape,c),p=nt(d),f=Nt(nt(h),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const t=v*p;let e=m[t];for(let n=0;n<p;++n){const i=m[t+n];i<e&&(e=i)}f[v]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,f);if(o){const t=JE({inputs:{x:g},backend:n,attrs:{shape:Gl(h,a)}});return n.disposeIntermediateTensorInfo(g),t}return g}},gI=OE(((t,e)=>Math.min(t,e))),vI=HE(On,gI),yI={kernelName:On,backendName:"cpu",kernelFunc:vI};const xI={kernelName:Rn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{paddings:s,mode:o}=i;xE(r,"mirrorPad");const a=s.map(((t,e)=>t[0]+r.shape[e]+t[1])),c=s.map((t=>t[0])),l=s.map(((t,e)=>t[0]+r.shape[e])),u="reflect"===o?0:1,h=n.data.get(r.dataId).values,d=r.shape.length,p=At(r.shape),f=nt(a),m=a.length,g=At(a),v=ft(r.dtype,f);for(let y=0;y<f;y++){let t=Ft(y,m,g);for(let n=0;n<m;n++)t[n]<c[n]?t[n]=2*c[n]-t[n]-u:t[n]>=l[n]&&(t[n]=2*(l[n]-1)-t[n]+u);t=t.map(((t,e)=>t-c[e]));const e=Pt(t,d,p);v[y]=h[e]}return{dataId:n.write(v,a,r.dtype),shape:a,dtype:r.dtype}}},bI=OE(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),wI=HE(Nn,bI),SI={kernelName:Nn,backendName:"cpu",kernelFunc:wI};var _I=n(8598);function TI(t){const{inputs:e,backend:n,attrs:i}=t,{logits:r}=e,{dim:s}=i,o=r.shape.length;let a=s;if(-1===a&&(a=o-1),a!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(a));const c=dt([a],r.shape),l=nI({inputs:{x:r},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),u=Gl(l.shape,c),h=JE({inputs:{x:l},backend:n,attrs:{shape:u}}),d=$k({inputs:{a:r,b:h},backend:n}),p=Lk({inputs:{x:d},backend:n}),f=dI({inputs:{x:p},backend:n,attrs:{axis:c,keepDims:!1}}),m=JE({inputs:{x:f},backend:n,attrs:{shape:u}}),g=Kk({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const EI={kernelName:bi,backendName:"cpu",kernelFunc:TI};const CI={kernelName:Mn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{logits:r}=e,{numSamples:s,seed:o,normalized:a}=i;xE(r,"multinomial");const c=a?r:TI({inputs:{logits:r},backend:n,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],h=n.data.get(c.dataId).values,d=[l,s],p=Nt(nt(d),"int32");for(let f=0;f<l;++f){const t=f*u,e=new Float32Array(u-1);e[0]=h[t];for(let r=1;r<e.length;++r)e[r]=e[r-1]+h[t+r];const n=_I.alea(o.toString()),i=f*s;for(let r=0;r<s;++r){const t=n();p[i+r]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){p[i+r]=n;break}}}return a||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(d,"int32",p)}};function kI(t,e,n){const i=lr(-1,n);return Gk([],e,i,t,n)}const AI={kernelName:Pn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e;xE(i,"neg");const r=n.data.get(i.dataId).values,[s,o]=kI(r,i.shape,i.dtype);return n.makeTensorInfo(o,i.dtype,s)}},II=xd;const OI={kernelName:Ln,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c}=i;xE(r,"NonMaxSuppression");const l=n.data.get(r.dataId).values,u=n.data.get(s.dataId).values,{selectedIndices:h}=II(l,u,o,a,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},RI=bd;const NI={kernelName:Bn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=i;xE(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,h=n.data.get(s.dataId).values,{selectedIndices:d,validOutputs:p}=RI(u,h,o,a,c,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},MI=wd;const DI={kernelName:zn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=i;xE(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,h=n.data.get(s.dataId).values,d=o,p=a,f=c,m=l,{selectedIndices:g,selectedScores:v}=MI(u,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}},PI=OE(((t,e)=>t!==e?1:0)),FI=HE(Fn,PI,null,"bool"),LI={kernelName:Fn,backendName:"cpu",kernelFunc:FI};const BI={kernelName:jn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{indices:r}=e,{depth:s,onValue:o,offValue:a}=i;xE(r,"oneHot");const c=nt(r.shape),l=new Float32Array(c*s);l.fill(a);const u=n.data.get(r.dataId).values;for(let h=0;h<c;++h)u[h]>=0&&u[h]<s&&(l[h*s+u[h]]=o);return n.makeTensorInfo([...r.shape,s],"int32",l)}};function zI(t){const{inputs:e,backend:n}=t,{x:i}=e;if("string"===i.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===i.dtype){const t=VE({inputs:{input:i},backend:n}),e=zI({inputs:{x:t},backend:n}),r=ZC({inputs:{input:i},backend:n}),s=zI({inputs:{x:r},backend:n}),o=zE({inputs:{real:e,imag:s},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),o}return sA({backend:n,attrs:{shape:i.shape,value:0,dtype:i.dtype}})}const UI={kernelName:Di,backendName:"cpu",kernelFunc:zI};const jI={kernelName:Un,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:i}=e,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){const e=VE({inputs:{input:r},backend:i}),n=t({inputs:{x:e},backend:i}),s=ZC({inputs:{input:r},backend:i}),o=zI({inputs:{x:s},backend:i}),a=zE({inputs:{real:n,imag:o},backend:i});return i.disposeIntermediateTensorInfo(e),i.disposeIntermediateTensorInfo(n),i.disposeIntermediateTensorInfo(s),i.disposeIntermediateTensorInfo(o),a}return sA({backend:i,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}};function VI(t){const{inputs:e,backend:n,attrs:i}=t,{axis:r}=i;if(1===e.length)return zk({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const s=e[0].shape,o=e[0].dtype;e.forEach((t=>{$(s,t.shape,"All tensors passed to stack must have matching shapes"),J(o===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],c=$C({inputs:e.map((t=>{const e=zk({inputs:{input:t},backend:n,attrs:{dim:r}});return a.push(e),e})),backend:n,attrs:{axis:r}});return a.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}const WI={kernelName:Vn,backendName:"cpu",kernelFunc:VI};const GI={kernelName:Wn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{paddings:s,constantValue:o}=i;xE(r,"pad");const a=s.map(((t,e)=>t[0]+r.shape[e]+t[1])),c=s.map((t=>t[0])),l=n.data.get(r.dataId).values,u=nt(r.shape),h=r.shape.length,d=At(r.shape),p=nt(a),f=a.length,m=At(a),g=ft(r.dtype,p);0!==o&&g.fill(o);for(let v=0;v<u;v++){g[Pt(Ft(v,h,d).map(((t,e)=>t+c[e])),f,m)]=l[v]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}},qI=OE(((t,e)=>Math.pow(t,e))),HI=HE(qn,qI),XI={kernelName:qn,backendName:"cpu",kernelFunc:HI};function YI(t,e,n,i){const[r,s]=Wl(t,i),o=kr(e,"int32"),a=Nt(nt(r),o),c=nt(s);for(let l=0;l<a.length;++l){const t=l*c;let e=1;for(let i=0;i<c;++i)e*=n[t+i];a[l]=e}return{outVals:a,outShape:r,outDtype:o}}const KI={kernelName:Xn,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;xE(r,"prod");const a=r.shape.length,c=dt(s,r.shape),l=Hl(c,a);let u=c,h=r;const d=[];null!=l&&(h=hC({inputs:{x:r},backend:n,attrs:{perm:l}}),d.push(h),u=Yl(u.length,a));const p=n.data.get(h.dataId).values,{outVals:f,outShape:m,outDtype:g}=YI(h.shape,h.dtype,p,u);let v=m;return o&&(v=Gl(m,c)),d.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(v,g,f)}};function QI(t,e,n,i){if(t===e||t<e&&n<0||e<t&&n>1)return Nt(0,i);const r=Nt(Math.abs(Math.ceil((e-t)/n)),i);e<t&&1===n&&(n=-1),r[0]=t;for(let s=1;s<r.length;s++)r[s]=r[s-1]+n;return r}const ZI={kernelName:Yn,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:i,stop:r,dtype:s,step:o}=n,a=QI(i,r,o,s);return e.makeTensorInfo([a.length],s,a)}},JI=SE(Qn,(t=>1/t)),$I={kernelName:Qn,backendName:"cpu",kernelFunc:JI};const tO={kernelName:ei,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r}=e,{alignCorners:s,halfPixelCenters:o,size:a}=i;xE(r,"resizeBilinear");const c=At(r.shape),[l,u]=a,[h,d,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(nt([h,l,u,f])),v=[s&&l>1?d-1:d,s&&u>1?p-1:p],y=[s&&l>1?l-1:l,s&&u>1?u-1:u];let x=0;const b=v[0]/y[0],w=v[1]/y[1];for(let S=0;S<h;S++)for(let t=0;t<l;t++){let e;e=o?b*(t+.5)-.5:b*t;const n=Math.max(0,Math.floor(e)),i=e-n,r=Math.min(d-1,Math.ceil(e)),s=S*c[0]+n*c[1],a=S*c[0]+r*c[1];for(let t=0;t<u;t++){let e;e=o?w*(t+.5)-.5:w*t;const n=Math.max(0,Math.floor(e)),r=e-n,l=Math.min(p-1,Math.ceil(e)),u=s+n*c[2],h=a+n*c[2],d=s+l*c[2],v=a+l*c[2];for(let t=0;t<f;t++){const e=m[u+t],n=m[h+t],s=e+(m[d+t]-e)*r,o=s+(n+(m[v+t]-n)*r-s)*i;g[x++]=o}}}return n.makeTensorInfo([h,l,u,f],"float32",g)}};const eO={kernelName:ni,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r,dy:s}=e,{alignCorners:o}=i;xE([s,r],"resizeBilinearGrad");const a=At(r.shape),[c,l,u,h]=r.shape,[,d,p]=s.shape,f=new Float32Array(c*l*u*h),m=[o&&d>1?l-1:l,o&&p>1?u-1:u],g=[o&&d>1?d-1:d,o&&p>1?p-1:p],v=m[0]/g[0],y=m[1]/g[1],x=n.data.get(s.dataId).values;let b=0;for(let w=0;w<c;w++){const t=w*a[0];for(let e=0;e<d;e++){const n=e*v,i=Math.floor(n),r=Math.min(Math.ceil(n),l-1),s=t+i*a[1],o=t+r*a[1],c=n-i,d=1-c;for(let t=0;t<p;t++){const e=t*y,n=Math.floor(e),i=Math.min(Math.ceil(e),u-1),r=e-n,l=1-r,p=s+n*a[2],m=s+i*a[2],g=o+n*a[2],v=o+i*a[2],w=d*l,S=d*r,_=c*l,T=c*r;for(let t=0;t<h;t++){const e=x[b++];f[p+t]+=e*w,f[m+t]+=e*S,f[g+t]+=e*_,f[v+t]+=e*T}}}}return n.makeTensorInfo([c,u,l,h],"float32",f)}};const nO={kernelName:$n,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r}=e,{alignCorners:s,halfPixelCenters:o,size:a}=i;xE(r,"resizeNearestNeighbor");const c=At(r.shape),[l,u]=a,[h,d,p,f]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(h*l*u*f),v=[s&&l>1?d-1:d,s&&u>1?p-1:p],y=[s&&l>1?l-1:l,s&&u>1?u-1:u],x=v[0]/y[0],b=v[1]/y[1];let w=0;for(let S=0;S<h;S++){const t=S*c[0];for(let e=0;e<l;e++){const n=o?x*(e+.5):x*e;let i=Math.min(d-1,s?Math.round(n):Math.floor(n));o&&(i=Math.max(0,i));const r=t+i*c[1];for(let t=0;t<u;t++){const e=o?b*(t+.5):b*t;let n=Math.min(p-1,s?Math.round(e):Math.floor(e));o&&(n=Math.max(0,n));const i=r+n*c[2];for(let t=0;t<f;t++){const e=m[i+t];g[w++]=e}}}}return n.makeTensorInfo([h,l,u,f],r.dtype,g)}};const iO={kernelName:ti,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r,dy:s}=e,{alignCorners:o}=i;xE([s,r],"resizeNearestNeighborGrad");const a=At(r.shape),c=At(s.shape),[l,u,h,d]=r.shape,[,p,f]=s.shape,m=new Float32Array(l*u*h*d),g=n.data.get(s.dataId).values,v=[o&&p>1?u-1:u,o&&f>1?h-1:h],y=[o&&p>1?p-1:p,o&&f>1?f-1:f],x=v[0]/y[0],b=v[1]/y[1],w=1/x,S=1/b,_=2*Math.ceil(w)+2,T=2*Math.ceil(S)+2;for(let E=0;E<l;E++){const t=E*a[0];for(let e=0;e<u;e++){const n=t+e*a[1],i=Math.floor(e*w),r=Math.floor(i-_/2);for(let s=0;s<h;s++){const i=n+s*a[2],l=Math.floor(s*S),v=Math.floor(l-T/2);for(let n=0;n<d;n++){let a=0;for(let i=0;i<_;i++){const l=i+r;if(l<0||l>=p)continue;const d=t+l*c[1],m=l*x;if(e===Math.min(u-1,o?Math.round(m):Math.floor(m)))for(let t=0;t<T;t++){const e=t+v;if(e<0||e>=f)continue;const i=d+e*c[2],r=e*b;s===Math.min(h-1,o?Math.round(r):Math.floor(r))&&(a+=g[i+n])}}m[i+n]=a}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}};const rO={kernelName:ri,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{dims:s}=i;xE(r,"reverse");const o=r.shape.length,a=dt(s,r.shape);if(0===o)return CE({inputs:{x:r},backend:n});const c=new mr(r.shape,r.dtype),l=n.bufferSync(r);for(let u=0;u<c.size;u++){const t=c.indexToLoc(u),e=t.slice();a.forEach((t=>e[t]=r.shape[t]-1-e[t])),c.set(l.get(...e),...t)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}},sO={kernelName:Li,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:r}=e,{radians:s,fillValue:o,center:a}=n,c=i,l=ft(r.dtype,nt(r.shape)),[u,h,d,p]=r.shape,[f,m]=op(a,h,d),g=Math.sin(s),v=Math.cos(s),y=c.data.get(r.dataId).values;for(let x=0;x<u;x++){const t=x*d*h*p;for(let e=0;e<h;e++){const n=e*(d*p);for(let i=0;i<d;i++){const r=i*p;for(let s=0;s<p;s++){const a=[u,e,i,s],c=a[2],x=a[1];let b=(c-f)*v-(x-m)*g,w=(c-f)*g+(x-m)*v;b=Math.round(b+f),w=Math.round(w+m);let S=o;if("number"!==typeof o&&(S=3===s?255:o[s]),b>=0&&b<d&&w>=0&&w<h){S=y[t+w*(d*p)+b*p+s]}l[t+n+r+s]=S}}}}return{dataId:c.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},oO=SE(si,(t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1})),aO={kernelName:si,backendName:"cpu",kernelFunc:oO},cO=WC((t=>1/Math.sqrt(t))),lO=_E(oi,cO),uO={kernelName:oi,backendName:"cpu",kernelFunc:lO};function hO(t,e,n,i,r,s,o,a,c,l){const u=[i/r,r],h=t.values,d=e.values;if(0===i)return Hs(n,e.dtype);const p=Hs(u,e.dtype);p.values.fill(c);for(let f=0;f<s;f++){const t=[];let s=0;for(let e=0;e<o;e++){const n=h[f*o+e];t.push(n),s+=n*a[e]}if(s<0||s>=i/r)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(n));for(let n=0;n<r;n++)l?p.values[s*r+n]+=d[f*r+n]:p.values[s*r+n]=0===e.rank?d[0]:d[f*r+n]}return p}const dO={kernelName:ai,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{indices:r,updates:s}=e,{shape:o}=i,{sliceRank:a,numUpdates:c,sliceSize:l,strides:u,outputSize:h}=Eo(0,r,o),d=hO(n.bufferSync(r),n.bufferSync(s),o,h,l,c,a,u,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};const pO={kernelName:ci,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:i,t:r,e:s}=e;xE([i,r,s],"select");const o=i.shape.length,a=n.data.get(i.dataId).values,c=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,u=kr(r.dtype,s.dtype),h=Nt(nt(r.shape),u);let d=0;const p=0===o||o>1||1===r.shape.length?1:nt(r.shape.slice(1));for(let f=0;f<a.length;f++)for(let t=0;t<p;t++)1===a[f]?h[d++]=c[f]:h[d++]=l[f];return n.makeTensorInfo(r.shape,u,h)}},fO=dp,mO=pp,gO=SE(li,(t=>t>=0?mO*t:fO*(Math.exp(t)-1))),vO={kernelName:li,backendName:"cpu",kernelFunc:gO},yO=SE(fi,(t=>1/(1+Math.exp(-t)))),xO={kernelName:fi,backendName:"cpu",kernelFunc:yO},bO=SE(pi,(t=>t<0?-1:t>0?1:0)),wO={kernelName:pi,backendName:"cpu",kernelFunc:bO},SO=SE(hi,(t=>Math.sin(t))),_O={kernelName:hi,backendName:"cpu",kernelFunc:SO},TO=SE(di,(t=>Math.sinh(t))),EO={kernelName:di,backendName:"cpu",kernelFunc:TO},CO=Math.log(1.1920928955078125e-7)+2,kO=SE(mi,(t=>{const e=t>-CO,n=t<CO,i=Math.exp(t);let r;return r=n?i:e?t:Math.log(1+i),r})),AO={kernelName:mi,backendName:"cpu",kernelFunc:kO};const IO={kernelName:yi,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockShape:s,paddings:o}=i;xE([r],"spaceToBatchND");const a=nt(s),c=[[0,0]];c.push(...o);for(let g=1+s.length;g<r.shape.length;++g)c.push([0,0]);const l=GI.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),u=ap(l.shape,s,a,!1),h=cp(u.length,s.length,!1),d=lp(l.shape,s,a,!1),p=JE({inputs:{x:l},backend:n,attrs:{shape:u}}),f=hC({inputs:{x:p},backend:n,attrs:{perm:h}}),m=JE({inputs:{x:f},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}};const OO={kernelName:Ti,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{sparseIndices:r,sparseValues:s,defaultValue:o}=e,{outputShape:a}=i,{sliceRank:c,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Eo(0,r,a),p=hO(n.bufferSync(r),n.bufferSync(s),a,d,u,l,c,h,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(a,p.dtype,p.values)}};const RO={kernelName:xi,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{numOrSizeSplits:s,axis:o}=i,a=dt(o,r.shape)[0],c=Op(r,s,a),l=new Array(r.shape.length).fill(0),u=r.shape.slice();return c.map((t=>{const e=[...u];e[a]=t;const i=LC({inputs:{x:r},backend:n,attrs:{begin:l,size:e}});return l[a]+=t,i}))}},NO=SE(gi,(t=>Math.sqrt(t))),MO={kernelName:gi,backendName:"cpu",kernelFunc:NO},DO={kernelName:Si,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{x:i}=e,r=n;xE(i,"square");const s=r.data.get(i.dataId).values,o=new Float32Array(s.length);for(let a=0;a<s.length;++a){const t=s[a];o[a]=t*t}return{dataId:r.write(o,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},PO=OE(((t,e)=>{const n=t-e;return n*n})),FO=HE(wi,PO),LO={kernelName:wi,backendName:"cpu",kernelFunc:FO},BO=SE(Pi,((t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),zO={kernelName:Pi,backendName:"cpu",kernelFunc:BO};function UO(t,e,n,i){const r=Hs(t,e.dtype);for(let s=0;s<r.size;s++){const t=r.indexToLoc(s),o=new Array(t.length);for(let e=0;e<o.length;e++)o[e]=t[e]*n[e]+i[e];r.set(e.get(...o),...t)}return r}const jO={kernelName:Ei,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{begin:s,end:o,strides:a,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=i;xE(r,"stridedSlice");const{nonStrided:p,$begin:f,$strides:m,size:g,newShape:v,outShape:y}=jo(r.shape,s,o,a,c,l,u,h,d),x=JE({inputs:{x:r},backend:n,attrs:{shape:v}});let b;if(p){const t=LC({inputs:{x:x},backend:n,attrs:{begin:f,size:g}});b=JE({inputs:{x:t},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(t)}else if(y.some((t=>0===t)))b=n.makeTensorInfo(y,r.dtype,[]);else{const t=UO(y,n.bufferSync(x),m,f);b=n.makeTensorInfo(t.shape,t.dtype,t.values)}const w=JE({inputs:{x:b},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),w}},VO=SE(Ci,(t=>Math.tan(t))),WO={kernelName:Ci,backendName:"cpu",kernelFunc:VO},GO=SE(ki,(t=>Math.tanh(t)));function qO(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const i=Hs(n,t.dtype);for(let r=0;r<i.values.length;++r){const e=i.indexToLoc(r),n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=e[i]%t.shape[i];const s=t.locToIndex(n);i.values[r]=t.values[s]}return i}const HO={kernelName:Ai,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{reps:s}=i;xE(r,"tile");const o=qO(n.bufferSync(r),s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function XO(t,e,n,i,r){const s=e[e.length-1],[o,a]=[t.length/s,s],c=ft(n,o*i),l=ft("int32",o*i);for(let h=0;h<o;h++){const e=h*a,n=t.subarray(e,e+a),r=[];for(let t=0;t<n.length;t++)r.push({value:n[t],index:t});r.sort(((t,e)=>e.value-t.value));const s=h*i,o=c.subarray(s,s+i),u=l.subarray(s,s+i);for(let t=0;t<i;t++)o[t]=r[t].value,u[t]=r[t].index}const u=e.slice();return u[u.length-1]=i,[Hs(u,n,c),Hs(u,"int32",l)]}const YO={kernelName:Ii,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{k:s,sorted:o}=i;xE(r,"topk");const a=n.data.get(r.dataId).values,[c,l]=XO(a,r.shape,r.dtype,s);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};function KO(t,e,n,i){const r=dt(e,n)[0],s=[1,n[0],1];for(let f=0;f<r;f++)s[0]*=n[f];s[1]=n[r];for(let f=r+1;f<n.length;f++)s[2]*=n[f];const o={},a=new Int32Array(n[r]),c=new mr(s,i,t),l=[],u=1===s[0]&&1===s[2];for(let f=0;f<n[r];f++){let e;if(u)e=t[f].toString();else{const t=[];for(let e=0;e<s[0];e++)for(let n=0;n<s[2];n++)t.push(c.get(e,f,n));e=t.join(",")}if(void 0!==o[e])a[f]=o[e];else{const t=Object.keys(o).length;o[e]=t,a[f]=t,l.push(f)}}const h=s.slice();h[1]=Object.keys(o).length;const d=new mr(h,i);l.forEach(((t,e)=>{for(let n=0;n<s[0];n++)for(let i=0;i<s[2];i++)d.set(c.get(n,t,i),n,e,i)}));const p=n.slice();return p[r]=h[1],{outputValues:d.values,outputShape:p,indices:a}}const QO={kernelName:Ri,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:i}=t,{axis:r}=n,{x:s}=e;xE(s,"unique");const o=i.data.get(s.dataId).values,{outputValues:a,outputShape:c,indices:l}=KO(o,r,s.shape,s.dtype);return[i.makeTensorInfo(c,s.dtype,a),i.makeTensorInfo([l.length],"int32",l)]}};const ZO={kernelName:Ni,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{value:r}=e;let{axis:s}=i;s<0&&(s+=r.shape.length);const o=r.shape.length,a=r.shape[s],c=new Array(o-1);let l=0;for(let p=0;p<o;p++)p!==s&&(c[l++]=r.shape[p]);const u=new Array(o).fill(0),h=r.shape.slice();h[s]=1;const d=new Array(a);for(let p=0;p<d.length;p++){u[s]=p;const t=LC({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[p]=JE({inputs:{x:t},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(t)}return d}};const JO={kernelName:Mi,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,segmentIds:s}=e,{numSegments:o}=i;xE(r,"unsortedSegmentSum");const a=[],c=[],l=r.shape.length-s.shape.length;let u=s;for(let d=0;d<l;++d){const t=zk({inputs:{input:u},backend:n,attrs:{dim:d+1}});u=t,c.push(t)}for(let d=0;d<o;++d){const t=lr(d,"int32"),e=n.makeTensorInfo([],"int32",t),i=Ck({inputs:{a:e,b:u},backend:n}),s=GE({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),o=Hk({inputs:{a:s,b:r},backend:n}),l=dI({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});a.push(l),c.push(e),c.push(i),c.push(s),c.push(o),c.push(l)}const h=VI({inputs:a,backend:n,attrs:{axis:0}});return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),h}},$O=[nC,rC,oC,cC,ZE,lC,pC,fC,mC,gC,yC,bC,SC,EC,kC,RC,NC,MC,DC,eC,PC,zC,VC,qE,HC,YC,UE,KC,tk,ik,rk,nk,ok,ak,sk,lk,hk,dk,pk,fk,mk,vk,yk,xk,bk,wk,_k,Sk,Qk,EE,Tk,kk,Pk,Bk,Uk,Wk,rA,oA,aA,uA,pA,fA,mA,gA,yA,wA,TA,kE,EA,JC,kA,IA,RA,IE,DA,LA,zA,VA,GA,XA,KA,JA,$A,tI,oI,aI,cI,lI,uI,hI,iI,fI,mI,yI,xI,SI,CI,Xk,AI,OI,NI,DI,LI,BI,jI,WI,GI,XI,ME,KI,ZI,WE,$I,PE,LE,$E,tO,eO,nO,iO,rO,sO,aO,uO,dO,pO,vO,xO,wO,_O,EO,BC,EI,AO,IO,OO,RO,MO,DO,LO,zO,jO,tA,pI,WO,{kernelName:ki,backendName:"cpu",kernelFunc:GO},HO,YO,dC,QO,ZO,JO,UI];for(const Dz of $O)Hi(Dz);const tR={},eR={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function nR(t){if(!(t in tR)){const e=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!==typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);if(e.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete tR[t]}),!1),1===t)return e.getContext("webgl",eR)||e.getContext("experimental-webgl",eR);return e.getContext("webgl2",eR)}(t);if(null===e)return console.log("Could not get context for WebGL version",t),null;tR[t]=e}const e=tR[t];return e.isContextLost()?(delete tR[t],nR(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),tR[t])}var iR,rR,sR;function oR(t,e){return[e,t]}function aR(t){const e=nt(t);return at(Math.ceil(e/4))}function cR(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function lR(t,e){const n=t;let i,r,s,o,a,c,l,u,h,d;return 2===Ut().getNumber("WEBGL_VERSION")?(i=n.R32F,r=n.R16F,s=n.RGBA16F,o=n.RGBA32F,a=n.RED,l=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT):(i=t.RGBA,r=t.RGBA,s=t.RGBA,o=n.RGBA,a=t.RGBA,l=4,u=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT),c=t.RGBA,{internalFormatFloat:i,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}function uR(t,e){const n=e();return Ut().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(iR||(iR={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(rR||(rR={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(sR||(sR={}));function hR(t){return!!(Ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function dR(t,e){return wR(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}function pR(t,e){const n=wR(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(uR(t,(()=>t.shaderSource(n,e))),uR(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){const n=fR.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);const i=+n[1],r=t.split("\n"),s=r.length.toString().length+2,o=r.map(((t,e)=>lt((e+1).toString(),s)+t));let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const c=o.slice(0,i-1),l=o.slice(i-1,i),u=o.slice(i);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(lt(l[0],a)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const fR=/ERROR: [0-9]+:([0-9]+):/g;function mR(t,e){if(uR(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function gR(t,e,n,i,r,s,o){const a=t.getAttribLocation(e,n);return-1!==a&&(uR(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,i))),uR(t,(()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,s,o))),uR(t,(()=>t.enableVertexAttribArray(a))),!0)}function vR(t,e,n,i){uR(t,(()=>function(t,e,n){SR(t,n),uR(t,(()=>t.activeTexture(t.TEXTURE0+n))),uR(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}(t,e,i))),uR(t,(()=>t.uniform1i(n,i)))}function yR(t,e,n){uR(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),uR(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function xR(t,e){uR(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),uR(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function bR(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function wR(t,e,n){const i=uR(t,(()=>e()));if(null==i)throw new Error(n);return i}function SR(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,i=e+t.TEXTURE0;if(i<t.TEXTURE0||i>n){const t="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(t,"."))}}function _R(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return nt(t.slice(0,t.length-e))}function TR(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function ER(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[_R(t),...TR(t)]),e}function CR(t){return t%2===0}function kR(t,e){if(rt(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],i=e.slice(-1)[0];if(n===i)return!0;if(CR(n)&&CR(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&CR(t[0])&&CR(e[0])}let AR,IR;function OR(t,e){return null!=t.getExtension(e)}function RR(t){try{if(null!=nR(t))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function NR(t){if(0===t)return!1;const e=nR(t);if(1!==t){if(OR(e,"EXT_color_buffer_float"))return MR(e);const t="EXT_color_buffer_half_float";if(OR(e,t)){const n=e.getExtension(t);return function(t,e){const n=lR(t,e),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const r=1,s=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,r,s,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(i),t.deleteFramebuffer(o),a}(e,n)}return!1}if(!OR(e,"OES_texture_float"))return!1;if(!OR(e,"WEBGL_color_buffer_float"))return!1;return MR(e)}function MR(t){const e=lR(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const r=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),r}function DR(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&J("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."))}))}const PR=Ut();function FR(){let t,e,n,i,r,s,o,a,c,l;return 2===Ut().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",i="in",r="texture",s="outputColor",o="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",i="varying",r="texture2D",s="gl_FragColor",o="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:i,texture2D:r,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:c,defineRound:l}}function LR(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const i=At(e);return i.map(((e,r)=>{const s="int ".concat(t[r]," = ").concat(n," / ").concat(e),o=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(e):"index -= ".concat(t[r]," * ").concat(e);return"".concat(s,"; ").concat(o,";")})).join("")}function BR(t){const e=At(t).map((t=>t.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}PR.registerFlag("HAS_WEBGL",(()=>PR.getNumber("WEBGL_VERSION")>0)),PR.registerFlag("WEBGL_VERSION",(()=>RR(2)?2:RR(1)?1:0)),PR.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),PR.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===PR.get("WEBGL_VERSION"))),PR.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),PR.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),PR.registerFlag("WEBGL_PACK",(()=>PR.getBool("HAS_WEBGL"))),PR.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_CLIP",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>!1)),PR.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_PACK_REDUCE",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_LAZILY_UNPACK",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_CONV_IM2COL",(()=>PR.getBool("WEBGL_PACK"))),PR.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(t){if(null==AR){const e=nR(t);AR=e.getParameter(e.MAX_TEXTURE_SIZE)}return AR}(PR.getNumber("WEBGL_VERSION")))),PR.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(t){if(null==IR){const e=nR(t);IR=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,IR)}(PR.getNumber("WEBGL_VERSION")))),PR.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=PR.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=nR(t);return e=OR(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:OR(n,"EXT_disjoint_timer_query")?1:0,e}(t)})),PR.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>PR.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!zr())),PR.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(t){if(0===t)return!1;const e=nR(t);if(1===t){if(!OR(e,"OES_texture_float"))return!1}else if(!OR(e,"EXT_color_buffer_float"))return!1;return MR(e)}(PR.getNumber("WEBGL_VERSION")))),PR.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!PR.getBool("WEBGL_FORCE_F16_TEXTURES")&&PR.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),PR.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>NR(PR.getNumber("WEBGL_VERSION")))),PR.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(t=PR.getNumber("WEBGL_VERSION"))&&null!=nR(t).fenceSync;var t})),PR.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>PR.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),PR.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))}));const zR="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";class UR{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=iR.DENSE;const e=aR(t),n=FR();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(LR(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(e[0],", ").concat(e[1],"));\n        int index = 4 * (resTexRC.x * ").concat(e[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")}}class jR{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=iR.DENSE;const e=aR(t),n=FR();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(LR(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(e[0],", ").concat(e[1],"));\n        int index = 4 * (resTexRC.x * ").concat(e[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")}}class VR{constructor(t){this.variableNames=["A"],this.outTexUsage=rR.DOWNLOAD;const e=FR();this.outputShape=t,this.userCode="\n      ".concat(zR,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class WR{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=rR.DOWNLOAD;const e=FR();this.outputShape=t,this.userCode="\n      ".concat(zR,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class GR{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.variableNames=["A"];const i=FR(),[r,s]=e;this.outputShape=t;let o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(BR(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(r,".0);\n        vec4 values = ").concat(i.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(i.output," = vec4(").concat(o,", 0., 0., 0.);\n      }\n    ")}}class qR{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const i=FR(),[r,s]=e;this.outputShape=t;let o="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let c=0;c<=1;c++)for(let e=0;e<=1;e++){const n=2*c+e;o+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(t[2],") {\n            localCoords[2] += ").concat(e,";\n            if(localCoords[1] + ").concat(c," < ").concat(t[1],") {\n              localCoords[1] += ").concat(c,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(r,".0);\n              values = ").concat(i.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(n,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(n,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(n,"] = values[2];\n              } else {\n                result[").concat(n,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(BR(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(o,"\n\n        ").concat(i.output," = ").concat(a,";\n      }\n    ")}}function HR(t){const e=FR();return function(t,e){const n=wR(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(uR(t,(()=>t.shaderSource(n,e))),uR(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function XR(t){return function(t,e){const n=wR(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return uR(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),uR(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function YR(t){return function(t,e){const n=wR(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return uR(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),uR(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Uint16Array([0,1,2,2,1,3]))}function KR(t,e,n,i,r,s){!function(t,e){const n=Ut().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const i="[".concat(t,"x").concat(e,"]"),r="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+i+" greater than WebGL maximum on this browser / GPU "+r+".")}}(e,n);const o=function(t){return wR(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}(t),a=t.TEXTURE_2D;return uR(t,(()=>t.bindTexture(a,o))),uR(t,(()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),uR(t,(()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),uR(t,(()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST))),uR(t,(()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST))),uR(t,(()=>t.texImage2D(a,0,i,e,n,0,r,s,null))),uR(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),o}function QR(t){return t.internalFormatFloat}function ZR(t){return t.internalFormatHalfFloat}function JR(t){return t.downloadTextureFormat}function $R(t){return t.internalFormatPackedFloat}function tN(t){return t.internalFormatPackedHalfFloat}function eN(t,e,n,i,r,s,o,a){const c=t,l=new Float32Array(function(t,e){const[n,i]=cR(t,e);return n*i*4}(s,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}class nN{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Ut().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){tR[t]=e}(e,t)):this.gl=nR(e);let n="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(1===Ut().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=dR(this.gl,t),OR(this.gl,e))this.textureHalfFloatExtension=dR(this.gl,e);else if(Ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),OR(this.gl,i))this.colorBufferHalfFloatExtension=dR(this.gl,i);else if(Ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",OR(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!OR(this.gl,i))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(i)}this.vertexBuffer=XR(this.gl),this.indexBuffer=YR(this.gl),this.framebuffer=function(t){return wR(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=lR(this.gl,this.textureHalfFloatExtension)}get debug(){return Ut().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;uR(t,(()=>t.finish())),uR(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),uR(t,(()=>t.deleteFramebuffer(this.framebuffer))),uR(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),uR(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),uR(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=oR(e,n);return KR(t,r,s,QR(i),i.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=oR(e,n);return KR(t,r,s,ZR(i),i.textureFormatFloat,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=oR(e,n);return KR(t,r,s,JR(i),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){uR(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?uR(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):uR(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),uR(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,i){this.throwIfDisposed(),function(t,e,n,i,r,s){let o,a,c;uR(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),r instanceof Uint8Array?(o=new Uint8Array(n*i*4),a=t.UNSIGNED_BYTE,c=t.RGBA):(o=new Float32Array(n*i*4),a=t.FLOAT,c=s.internalFormatPackedFloat),o.set(r),uR(t,(()=>t.texImage2D(t.TEXTURE_2D,0,c,n,i,0,t.RGBA,a,o))),uR(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e,n,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=cR(e,n);return KR(t,r,s,tN(i),t.RGBA,i.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,i){const[r,s]=cR(e,n);return KR(t,r,s,$R(i),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(xR(this.gl,this.framebuffer),this.outputTexture=null),uR(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n,i){const[r,s]=oR(e,n),o=new Uint8Array(e*n*4);return uR(t,(()=>t.readPixels(0,0,r,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,o))),new Float32Array(o.buffer)}(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,i,r,s){return eN(this.gl,t,0,0,0,r,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const i=t,r=new Float32Array(n);return i.bindBuffer(i.PIXEL_PACK_BUFFER,e),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,r),i.bindBuffer(i.PIXEL_PACK_BUFFER,null),r}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const i=function(t,e,n,i){const r=t.createBuffer();uR(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r)));const s=16*e*n;return uR(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ))),uR(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),uR(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),r}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Ut().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,r=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=i.clientWaitSync(r,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=r}else Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n){const i=new Float32Array(e*n*4);return uR(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,i))),i}(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=pR(e,t),i=HR(e),r=function(t){return wR(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}(e);return uR(e,(()=>e.attachShader(r,i))),uR(e,(()=>e.attachShader(r,n))),function(t,e){if(uR(t,(()=>t.linkProgram(e))),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,r),this.debug&&mR(e,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=function(t,e,n){return uR(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),gR(t,e,"clipSpacePos",n,3,20,0)&&gR(t,e,"uv",n,2,20,12)}(e,this.program,this.vertexBuffer)),r}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&uR(this.gl,(()=>this.gl.deleteProgram(t)))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&mR(this.gl,this.program),uR(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n){return wR(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),uR(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),vR(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[i,r]=cR(e,n);this.setOutputMatrixTextureDriver(t,i,r)}setOutputMatrixWriteRegion(t,e,n,i){this.setOutputMatrixWriteRegionDriver(n,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,n,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&mR(this.gl,this.program),bR(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),uR(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),uR(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=dR(this.gl,2===Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await ut((()=>this.disposed||this.isQueryAvailable(t,Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),i=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),i&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||ut((()=>(this.pollItems(),0===this.itemsToPoll.length)))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),yR(this.gl,t,this.framebuffer),this.debug&&bR(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(yR(this.gl,this.outputTexture,this.framebuffer),this.debug&&bR(this.gl)):xR(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const i=this.gl;yR(i,t,this.framebuffer),this.debug&&bR(i),this.outputTexture=t,uR(i,(()=>i.viewport(0,0,e,n))),uR(i,(()=>i.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,i){this.throwIfDisposed(),uR(this.gl,(()=>this.gl.scissor(t,e,n,i)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{getBroadcastDims:iN}=g;function rN(t,e,n,i){const r=[];t.forEach((t=>{const e=nt(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?r.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(r.push("uniform sampler2D ".concat(t.name,";")),r.push("uniform int offset".concat(t.name,";")))}));const s=r.join("\n"),o=t.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="";i+=n?oN(t):sN(t);const r=t.shapeInfo.logicalShape,s=e.logicalShape;r.length<=s.length&&(i+=n?function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),r="get"+i+"AtOutCoords",s=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=iN(t.shapeInfo.logicalShape,e.logicalShape),c=pN(o),l=o-s;let u;const h=["x","y","z","w","u","v"];u=0===s?"":o<2&&a.length>=1?"coords = 0;":a.map((t=>"coords.".concat(h[t+l]," = 0;"))).join("\n");let d="";d=o<2&&s>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(h[e+l]))).join(", ");let p="return outputValue;";const f=1===nt(t.shapeInfo.logicalShape),m=nt(e.logicalShape),g=1===m;if(1!==s||f||g){if(f&&!g)p=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const t=s-2,e=s-1;a.indexOf(t)>-1&&a.indexOf(e)>-1?p="return vec4(outputValue.x);":a.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(r,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(i,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),r="get"+i+"AtOutCoords",s=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===c&&null==t.shapeInfo.flatOffset&&rt(o,s))return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const l=pN(c),u=iN(t.shapeInfo.logicalShape,e.logicalShape),h=c-a;let d;const p=["x","y","z","w","u","v"];d=0===a?"":c<2&&u.length>=1?"coords = 0;":u.map((t=>"coords.".concat(p[t+h]," = 0;"))).join("\n");let f="";f=c<2&&a>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(p[e+h]))).join(", ");return"\n    float ".concat(r,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(d,"\n      return get").concat(i,"(").concat(f,");\n    }\n  ")}(t,e));return i}(t,e,i))).join("\n"),a=e.texShape,c=FR(),l=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c);let u,h,d=function(t){const e="".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(aN,"\n    ").concat(cN,"\n    ").concat(lN,"\n  ");return e}(c);e.isPacked?(u=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(rt(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");const i=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),r=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),r=i*Math.ceil(t[t.length-2]/2);let s=r,o="",a="b, r, c";for(let c=2;c<t.length-1;c++)s*=t[t.length-c-1],o="\n      int b".concat(c," = index / ").concat(s,";\n      index -= b").concat(c," * ").concat(s,";\n    ")+o,a="b".concat(c,", ")+a;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(a,");\n    }\n  ")}(t,e)}}(e.logicalShape,a),h=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(c)):(u=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){if(1===e[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e);case 2:return function(t,e){if(rt(t,e))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=LR(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e);case 4:return function(t,e){const n=LR(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e);case 5:return function(t,e){const n=LR(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=LR(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,a),h=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),i&&(d+=uN);return[d,l,h,s,u,o,n].join("\n")}function sN(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(e,";}");const[i,r]=t.shapeInfo.texShape;if(1===i&&1===r)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");const[s,o]=t.shapeInfo.texShape,a=hN(e);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(o,", ").concat(a,");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(dN(t),"\n      }\n    ");const i=t.shapeInfo.texShape,r=i[0],s=i[1];if(1===s&&1===r)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");const o=hN(e);if(1===s)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(r,".0);\n        return sampleTexture(").concat(e,", uv);\n      }\n    ");if(1===r)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(s,".0, 0.5);\n        return sampleTexture(").concat(e,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(r,", ").concat(s,", index + ").concat(o,");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape;if(null!=r&&rt(e,r)){const t=r[0],e=r[1];return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(e,".0, ").concat(t,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}const{newShape:s,keptDims:o}=pt(e),a=s;if(a.length<e.length){const e=fN(t,a),n=["row","col"];return"\n      ".concat(sN(e),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(mN(n,o),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(e[1],", 1)));\n        ").concat(dN(t),"\n      }\n    ");const c=r[0],l=r[1],u=hN(n);if(1===l)return"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(u,"), vec3(").concat(e[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===c)return"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(u,"), vec3(").concat(e[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(l,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(e[1]," + col + ").concat(u,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[1]*e[2],s=e[2],{newShape:o,keptDims:a}=pt(e),c=o;if(c.length<e.length){const e=fN(t,c),n=["row","col","depth"];return"\n        ".concat(sN(e),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(mN(n,a),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(r,", ").concat(s,", 1)));\n        ").concat(dN(t),"\n      }\n    ");const l=t.shapeInfo.texShape,u=l[0],h=l[1],d=t.shapeInfo.flatOffset;if(h===r&&null==d)return"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(u,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(h===s&&null==d)return"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(e[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(u,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const p=hN(n);return"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r," + col * ").concat(s," + depth + ").concat(p,";\n        vec2 uv = uvFromFlat(").concat(u,", ").concat(h,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[3],s=e[2]*r,o=e[1]*s,{newShape:a,keptDims:c}=pt(e);if(a.length<e.length){const e=fN(t,a),n=["row","col","depth","depth2"];return"\n      ".concat(sN(e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(mN(n,c),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(s,", ").concat(r,", 1)));\n        ").concat(dN(t),"\n      }\n    ");const l=t.shapeInfo.flatOffset,u=t.shapeInfo.texShape,h=u[0],d=u[1];if(d===o&&null==l)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(r,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(d===r&&null==l)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(e[1]*e[2],", ").concat(e[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const p=hN(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(s," +\n          depth * ").concat(r," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index + ").concat(p,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],s=e[3]*r,o=e[2]*s,a=e[1]*o,{newShape:c,keptDims:l}=pt(e);if(c.length<e.length){const e=fN(t,c),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(sN(e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(i,"(").concat(mN(n,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(a,", ").concat(o,", ").concat(s,", ").concat(r,")) +\n          depth3;\n        ").concat(dN(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];if(p===a&&null==u)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(s,", ").concat(r,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===r&&null==u)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=hN(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(a," + col * ").concat(o," + depth * ").concat(s," +\n          depth2 * ").concat(r," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:s}=pt(e);if(r.length<e.length){const e=fN(t,r),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(sN(e),"\n      float ").concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(i,"(").concat(mN(n,s),");\n      }\n    ")}const o=e[5],a=e[4]*o,c=e[3]*a,l=e[2]*c,u=e[1]*l;if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(l,", ").concat(c,", ").concat(a,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(o,", 1)));\n        ").concat(dN(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===u&&null==h)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(l,", ").concat(c,", ").concat(a,", ").concat(o,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===o&&null==h)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=hN(n);return"\n    float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(l," + depth * ").concat(c," +\n          depth2 * ").concat(a," + depth3 * ").concat(o," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(e.length,"-D input sampling")+" is not yet supported")}}function oN(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),i=FR();return"\n    vec4 ".concat(n,"() {\n      return ").concat(i.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t.shapeInfo.texShape,r=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=FR();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(r[0],", ").concat(r[1],", index);\n      return ").concat(s.texture2D,"(").concat(e,", uv);\n    }\n  ")}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,s=r[0],o=r[1],a=FR();if(null!=r&&rt(e,r))return"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(s,".0);\n\n        return ").concat(a.texture2D,"(").concat(n,", uv);\n      }\n    ");const c=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],l=Math.ceil(e[1]/2);return"\n    vec4 ".concat(i,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(1===e[0]){const n=[1,2],r=fN(t,e.slice(1)),s=["b","row","col"];return"\n        ".concat(oN(r),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(mN(s,n),");\n        }\n      ")}const o=s[0],a=s[1],c=Math.ceil(e[2]/2),l=c*Math.ceil(e[1]/2),u=FR();return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(o,", ").concat(a,", ").concat(l,", ").concat(c,", b, row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,i=t.name,r="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],a=o[0],c=o[1],l=Math.ceil(e[n-1]/2);let u=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",d="b * ".concat(u," + (row / 2) * ").concat(l," + (col / 2)");for(let f=2;f<n-1;f++)h="int b".concat(f,", ")+h,u*=e[n-f-1],d="b".concat(f," * ").concat(u," + ")+d;const p=FR();return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(a,");\n      return ").concat(p.texture2D,"(").concat(i,", uv);\n    }\n  ")}(t)}}const aN="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",cN="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",lN="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",uN="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function hN(t){return"offset".concat(t)}function dN(t){const e=t.name,n=nt(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function pN(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function fN(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function mN(t,e){return e.map((e=>t[e])).join(", ")}function gN(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach(((t,n)=>{const i=t.logicalShape,r=e[n],s=r.shape;if(!rt(i,s))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(i," and ").concat(s," must match"));if(t.isUniform&&r.isUniform)return;const o=t.texShape,a=r.isUniform?null:r.texData.texShape;if(!rt(o,a))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(a," must match"))}))}const{addImpl:vN,bincountImpl:yN,bincountReduceImpl:xN,ceilImpl:bN,concatImpl:wN,expImpl:SN,expm1Impl:_N,floorImpl:TN,gatherV2Impl:EN,greaterImpl:CN,lessImpl:kN,linSpaceImpl:AN,logImpl:IN,maxImpl:ON,maximumImpl:RN,minimumImpl:NN,multiplyImpl:MN,negImpl:DN,prodImpl:PN,rangeImpl:FN,rsqrtImpl:LN,simpleAbsImpl:BN,sliceImpl:zN,stridedSliceImpl:UN,subImpl:jN,tileImpl:VN,topKImpl:WN,transposeImpl:GN,uniqueImpl:qN}=V;function HN(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>"".concat(t,".").concat(e)))}function XN(t,e){return 1===e?[t]:HN(t,e)}class YN{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=XN("rc",e),i=pN(e),r=function(t,e,n){if(1===t)return"rc > ".concat(e[0]);let i="";for(let r=t-2;r<t;r++)i+="".concat(n[r]," >= ").concat(e[r]),r<t-1&&(i+="||");return i}(e,t,n),s=function(t,e,n,i){if(1===t)return"";const r=i.slice(-2);return"\n    int r = ".concat(r[0],";\n    int c = ").concat(r[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(e,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){const n=t.length,i=function(t,e){const n=[];for(let i=0;i<=1;i++)for(let r=0;r<=1;r++){let s="".concat(0===i?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let n=2;n<t;n++)s="".concat(e[e.length-1-n],",")+s;n.push(s)}return n}(n,e);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(t[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(i[0],"),\n          cEdge ? 0. : getA(").concat(i[1],"),\n          rEdge ? 0. : getA(").concat(i[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(i[3],")")}(t,n);this.userCode="\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n\n          if(").concat(r,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(s,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}}class KN{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let i=0;i<4;i++){let t="thisRC = rc;";i%2===1&&(t+="thisRC.z += 1;"),i>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(i>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(i,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(i>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t){const e=LR(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(e,"\n      return ivec3(r, c, d);\n    }\n  ")}(e),"\n      ").concat(BR(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class QN{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const i=JN(e,n),r=$N(t,i,n);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const s=ZN(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const t=this.freeTextures[r].shift();return this.usedTextures[r].push(t),t}let o;return i===sR.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===sR.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===sR.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===sR.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===sR.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[r].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}releaseTexture(t,e,n,i){if(null==this.freeTextures)return;const r=JN(n,i),s=$N(e,r,i);s in this.freeTextures||(this.freeTextures[s]=[]);const o=ZN(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,i),a=Ut().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==a&&this._numBytesAllocated>a?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=o):(this.freeTextures[s].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[s],l=c.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(l,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function ZN(t,e,n,i,r){const s=function(t,e){switch(t){case sR.PACKED_2X2_FLOAT32:return $R(e);case sR.PACKED_2X2_FLOAT16:return tN(e);case sR.UNPACKED_FLOAT32:return QR(e);case sR.UNPACKED_FLOAT16:return ZR(e);case sR.PACKED_4X1_UNSIGNED_BYTE:return JR(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,i);let o;if(r){const[e,n]=cR(t[0],t[1]);o=e*n}else{const[e,n]=oR(t[0],t[1]);o=e*n}const a=function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(e))}(n,s);return o*a}function JN(t,e){if(t===rR.UPLOAD)return sR.PACKED_2X2_FLOAT32;if(t===rR.RENDER||null==t)return function(t){return Ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?sR.PACKED_2X2_FLOAT32:sR.UNPACKED_FLOAT32:t?sR.PACKED_2X2_FLOAT16:sR.UNPACKED_FLOAT16}(e);if(t===rR.DOWNLOAD||t===rR.PIXELS)return sR.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function $N(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}class tM{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const eM="if (isnan(x)) return x;",nM="return x;",iM="return abs(x);";const rM="return (x >= 0.0) ? x : (exp(x) - 1.0);",sM=eM+"\n  return (x < 0.0) ? 0.0 : x;\n",oM=eM+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",aM="return x;",cM="return x;",lM="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",uM="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",hM="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";class dM{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class pM{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=XN("rc",e),i=pN(e),r=function(t,e){if(1===t)return"rc";let n="";for(let i=0;i<t;i++)n+=e[i],i<t-1&&(n+=",");return n}(e,n),s=n.slice(-2),o=e<=1?"rc":"vec2(".concat(s.join(","),")");this.userCode="\n      void main() {\n        ".concat(i," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(r,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const fM=Th,mM={};class gM extends G{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!Ut().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=nR(Ut().getNumber("WEBGL_VERSION"));this.binaryCache=((e=Ut().getNumber("WEBGL_VERSION"))in mM||(mM[e]={}),mM[e]),this.gpgpu=new nN(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new QN(this.gpgpu),this.numMBBeforeWarning=null==Ut().global.screen?1024:Ut().global.screen.height*Ut().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new W(this,la())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if((Ut().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ut().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={};return this.texData.set(i,{shape:e,dtype:n,values:t,usage:rR.UPLOAD,refCount:1,complexParentRefCount:0}),i}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}decComplexRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.complexParentRefCount>0&&e.refCount--}}move(t,e,n,i){if(Ut().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:i,values:e,usage:rR.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const e=t.dataId;if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--,t.refCount<1&&this.disposeData(e)}}readSync(t){const e=this.texData.get(t),{values:n,dtype:i,complexTensorInfos:r,slice:s,shape:o,isPacked:a}=e;if(null!=s){let e;e=a?new dM(o,aM):new tM(o,aM);const n=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:i}],i),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;const c=null!=this.activeTimers;let l,u;if(c&&(l=hr()),"complex64"===i){u=Sp(this.readSync(r.real.dataId),this.readSync(r.imag.dataId))}else u=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=hr()-l),this.convertAndCacheOnCPU(t,u)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:i,slice:r,dtype:s,complexTensorInfos:o,isPacked:a}=e;if(null!=r){let e;e=a?new dM(i,aM):new tM(i,aM);const n=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:s}],s),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if(!Ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Ut().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,l,u=null;if("complex64"!==s&&Ut().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const e=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(e.texture,...aR(i))}if(this.pendingRead.set(t,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){const t=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);l=Sp(t[0],t[1])}else if(null==u)l=this.getValuesFromTexture(t);else{const t=nt(i);l=this.gpgpu.downloadFloat32MatrixFromBuffer(u,t)}null!=c&&this.disposeIntermediateTensorInfo(c);const h=this.convertAndCacheOnCPU(t,l),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach((t=>t(h))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),h}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map((t=>fr(t)))}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return Hs(t.shape,t.dtype,n)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!hR(n)){if(Ut().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:i}=this.texData.get(t),r=nt(e);if(Ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),i=this.texData.get(n.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(i.texture,...aR(e)).subarray(0,r);return this.disposeIntermediateTensorInfo(n),s}const s=Ut().getBool("WEBGL_PACK")&&!0===i,o=s?ER(e):e,a=s?new WR(o):new VR(o),c=this.runWebGLProgram(a,[{shape:o,dtype:n,dataId:t}],"float32"),l=this.texData.get(c.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture,l.texShape[0],l.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(c),u}async time(t){const e=this.activeTimers,n=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();const r=et(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),s=et(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(r);o.kernelMs=K(t),o.getExtraProfileInfo=()=>t.map(((t,e)=>({name:s[e],ms:t}))).map((t=>"".concat(t.name,": ").concat(t.ms))).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:hr(),endMs:null}}endTimer(t){return Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=hr(),t)}async getQueryTime(t){if(Ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0)return void this.texData.get(t).refCount--;this.releaseGPUData(t);const{complexTensorInfos:e}=this.texData.get(t);null!=e&&(this.texData.get(e.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.real),this.texData.get(e.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(e.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:i,usage:r,isPacked:s,slice:o}=this.texData.get(t),a=o&&o.origDataId||t,c=this.dataRefCount.get(a);c>1?this.dataRefCount.set(a,c-1):(this.dataRefCount.delete(a),null!=e&&(this.numBytesInGPU-=this.computeBytes(i,n),this.textureManager.releaseTexture(e,i,r,s)));const l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Ut().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=la().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;const n=this.getCPUBackend();return Ut().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=n||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=n&&t.every((t=>null==this.texData.get(t.dataId).texture&&nt(t.shape)<e))}getGPGPUContext(){return this.gpgpu}where(t){bp("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return fM(t.shape,e)}packedUnaryOp(t,e,n){const i=new dM(t.shape,e);return this.compileAndRun(i,[t],n)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=BN(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(Ut().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,iM,t.dtype);const e=new tM(t.shape,iM);return this.compileAndRun(e,[t])}makeTensorInfo(t,e,n){let i;if("string"===e&&null!=n&&n.length>0&&St(n[0])){const r=n.map((t=>pr(t)));i=this.write(r,t,e)}else i=this.write(n,t,e);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:e}}makeOutput(t,e,n){const{dataId:i}=this.makeTensorInfo(t,e,n);return la().makeTensorFromDataId(i,t,e,this)}unpackTensor(t){const e=new pM(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new YN(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[_R(t.shape),...TR(t.shape)],i={dtype:t.dtype,shape:n,dataId:t.dataId},r=[_R(e),...TR(e)],s=new KN(r,n),o=this.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:i,dtype:r}=e,s=ER(i);let o;o=n?new jR(s):new UR(s);return{dtype:r,shape:i,dataId:this.runWebGLProgram(o,[{shape:s,dtype:r,dataId:t}],r,null,!0).dataId}}runWebGLProgram(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=this.makeTensorInfo(t.outputShape,n),o=this.texData.get(s.dataId);if(t.packedOutput&&(o.isPacked=!0),t.outPackingScheme===iR.DENSE){const e=aR(t.outputShape);o.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(o.usage=t.outTexUsage),0===nt(s.shape))return o.values=ft(s.dtype,0),s;const a=[],c=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&nt(e.shape)<=Ut().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),a.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!kR(n.shape,e.shape)){const t=e,i=e.shape;e.shape=n.shape,e=this.packedReshape(e,i),a.push(e),n=this.texData.get(e.dataId),t.shape=i}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);const l={shape:s.shape,texData:o,isUniform:!1},u=function(t,e,n){let i="";e.concat(n).forEach((t=>{const e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;i+="".concat(t.shape,"_").concat(n,"_").concat(e)}));const r=t.userCode;let s=t.constructor.name;return s+="_"+i+"_"+r,s}(t,c,l),h=this.getAndSaveBinary(u,(()=>function(t,e,n,i){const r=e.userCode,s=n.map(((t,n)=>{const i={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(i.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:i}})),o=s.map((t=>t.shapeInfo)),a={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},c=rN(s,a,r,e.packedInputs),l=t.createProgram(c);let u=null;const h=t.getUniformLocation(l,"NAN",!1);1===Ut().getNumber("WEBGL_VERSION")&&(u=t.getUniformLocation(l,"INFINITY",!1));const d={};for(let p=0;p<e.variableNames.length;p++){const n=e.variableNames[p],i=!1;d[n]=t.getUniformLocation(l,n,i),d["offset".concat(n)]=t.getUniformLocation(l,"offset".concat(n),i)}return{program:e,source:c,webGLProgram:l,uniformLocations:d,inShapeInfos:o,outShapeInfo:a,infLoc:u,nanLoc:h}}(this.gpgpu,t,c,l))),d=null!=this.activeTimers;let p;if(d&&(p=this.startTimer()),function(t,e,n,i,r){gN(e.inShapeInfos,n),gN([e.outShapeInfo],[i]);const s=i.texData.texture,o=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(s,o[0],o[1]):t.setOutputMatrixTexture(s,o[0],o[1]),t.setProgram(e.webGLProgram),1===Ut().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach(((n,i)=>{const r=e.program.variableNames[i],s=e.uniformLocations[r],o=e.uniformLocations["offset".concat(r)];if(null!=s)if(n.isUniform)if(nt(n.shape)<2)t.gl.uniform1f(s,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(s,e)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,s,i)})),null!=r&&r(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,h,c,l,i),a.forEach((t=>this.disposeIntermediateTensorInfo(t))),d&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)})),!Ut().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===r){const t=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),t}return s}compileAndRun(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;const s=this.runWebGLProgram(t,e,n,i,r);return la().makeTensorFromDataId(s.dataId,s.shape,s.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!Ut().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=da((()=>{if(!Ut().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Ut().getBool("DEBUG");Ut().set("DEBUG",!1);const e=this.abs(za(1e-8)).dataSync()[0];if(Ut().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:i,values:r,texture:s,usage:o,isPacked:a}=e;if(null!=s)return;const c=null!=this.activeTimers;let l;c&&(l=hr());let u=e.texShape;if(null==u&&(u=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ut().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map(((e,n)=>n>=t.length-2?Y(t[n]):t[n]))).length&&(t=[2,t[0]])),2!==t.length){const e=pt(t);t=e.newShape}let i=nt(t);if(t.length<=1&&i<=n)return[1,i];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=_R(t);let n=2,r=2;return t.length&&([n,r]=TR(t)),i=e*(n/2)*(r/2),at(i).map((t=>2*t))}return at(i)}(n,a),e.texShape=u),null!=r){const t=ER(n);let s,o=u[1],h=u[0];const d=r instanceof Uint8Array;a?([o,h]=cR(u[0],u[1]),s=new qR(t,[h,o],d)):s=new GR(t,[h,o],d);const p=this.makeTensorInfo([h,o],i);this.texData.get(p.dataId).usage=d?rR.PIXELS:rR.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(p.dataId),o,h,r);const f=!0,m=this.runWebGLProgram(s,[p],i,null,f),g=this.texData.get(m.dataId);e.texture=g.texture,e.texShape=g.texShape,e.isPacked=g.isPacked,e.usage=g.usage,this.disposeIntermediateTensorInfo(p),this.texData.delete(m.dataId),e.values=null,c&&(this.uploadWaitMs+=hr()-l)}else{const t=this.acquireTexture(u,o,i,a);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:i}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype ".concat(e))}(e,i)),n.values}acquireTexture(t,e,n,i){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,i)}computeBytes(t,e){return t[0]*t[1]*bt(e)}}Ur()&&Sa("webgl",(()=>new gM),2);const vM="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class yM{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=Qa(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const xM="\n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n";class bM{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qa(e,n);const r=this.outputShape.length;let s="";if(i)if(0===r||1===nt(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=pN(r);if(s="\n          ".concat(t," coords = getOutputCoords();\n        "),1===r)s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=XN("coords",r);s+="\n            bool nextRowOutOfBounds =\n              (".concat(t[r-2]," + 1) >= ").concat(this.outputShape[r-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[r-1]," + 1) >= ").concat(this.outputShape[r-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")}}function wM(t){const{inputs:e,backend:n}=t,{x:i}=e;return n.incRef(i.dataId),{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}const SM={kernelName:nn,backendName:"webgl",kernelFunc:wM};function _M(t){const{inputs:e,backend:n}=t,{real:i,imag:r}=e,s=n.makeTensorInfo(i.shape,"complex64"),o=n.texData.get(s.dataId),a=wM({inputs:{x:i},backend:n});n.texData.get(a.dataId).complexParentRefCount++;const c=wM({inputs:{x:r},backend:n});return n.texData.get(c.dataId).complexParentRefCount++,o.complexTensorInfos={real:a,imag:c},s}const TM={kernelName:ge,backendName:"webgl",kernelFunc:_M},EM="return (a < 0.) ? b * a : a;",CM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const kM={kernelName:ln,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{alpha:s}=i,o=n.makeTensorInfo([],"float32",lr(s,"float32")),a=Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bM(CM,r.shape,o.shape):new yM(EM,r.shape,o.shape),c=n.runWebGLProgram(a,[r,o],r.dtype);return n.disposeIntermediateTensorInfo(o),c}},AM="return (a < 0.) ? b * a : a;",IM="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const OM={kernelName:Hn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i,alpha:r}=e,s=Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bM(IM,i.shape,r.shape):new yM(AM,i.shape,r.shape);return n.runWebGLProgram(s,[i,r],i.dtype)}},RM="if (isnan(x)) return x;";function NM(t){let{opSnippet:e,packedOpSnippet:n,cpuKernelImpl:i,dtype:r}=t;return t=>{let{inputs:s,backend:o}=t;const{x:a}=s,c=o,l=r||a.dtype;if(c.shouldExecuteOnCPU([a])&&null!=i){const t=c.texData.get(a.dataId),e=i(t.values,l);return c.makeTensorInfo(a.shape,l,e)}let u;return u=Ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new dM(a.shape,n):new tM(a.shape,e),c.runWebGLProgram(u,[a],l)}}function MM(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:i=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}=t;return t=>{let{inputs:a,backend:c}=t;const{a:l,b:u}=a,h=c;if(r&&"complex64"===l.dtype){const t=h.texData.get(l.dataId),n=h.texData.get(u.dataId),[i,r]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,i]=t,r={dataId:n.dataId,dtype:n.dtype,shape:l.shape},s={dataId:i.dataId,dtype:i.dtype,shape:u.shape},o=new yM(e,l.shape,u.shape);return h.runWebGLProgram(o,[r,s],kr(n.dtype,i.dtype))})),s=_M({inputs:{real:i,imag:r},backend:h});return h.disposeIntermediateTensorInfo(i),h.disposeIntermediateTensorInfo(r),s}const d=o||kr(l.dtype,u.dtype);if(h.shouldExecuteOnCPU([l,u])&&null!=s){const t=h.texData.get(l.dataId),e=h.texData.get(u.dataId),[n,i]=s(l.shape,u.shape,t.values,e.values,d),r=h.makeTensorInfo(i,d);return h.texData.get(r.dataId).values=n,r}let p;return p=Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new bM(n,l.shape,u.shape,i):new yM(e,l.shape,u.shape),h.runWebGLProgram(p,[l,u],d)}}function DM(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return e?cM:nM;if("relu"===t)return e?uM:sM;if("elu"===t)return e?lM:rM;if("relu6"===t)return e?hM:oM;if("prelu"===t)return e?IM:AM;if("leakyrelu"===t)return e?CM:EM;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}class PM{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;const l=i?t[1]:t[2],u=Math.ceil(l/2),h=i?"i * 2, rc.y":"rc.y, i * 2",d=r?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),g="result = activation(result);");const v=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let y="rc.x",x="rc.x";t[0]<e[0]?y="int(min(float(rc.x), ".concat(t[0]-1,".))"):e[0]<t[0]&&(x="int(min(float(rc.x), ".concat(e[0]-1,".))")),this.userCode="\n      ".concat(m,"\n\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(u,"; i++) {\n          int batchA = ").concat(y,";\n          int batchB = ").concat(x,";\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(f[0],");\n          result += (").concat(p[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const FM={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class LM{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qa(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const BM="return a * b;";function zM(t){const{inputs:e,backend:n}=t,{a:i,b:r}=e,s=kr(i.dtype,r.dtype);if("complex64"===i.dtype){const t=n.texData.get(i.dataId),e=n.texData.get(r.dataId),s=new LM(FM.REAL,i.shape,r.shape),o=new LM(FM.IMAG,i.shape,r.shape),a=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape}],c=n.runWebGLProgram(s,a,"float32"),l=n.runWebGLProgram(o,a,"float32"),u=_M({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([i,r])){const t=n.texData.get(i.dataId),e=n.texData.get(r.dataId),[o,a]=MN(i.shape,r.shape,t.values,e.values,s),c=n.makeTensorInfo(a,s);return n.texData.get(c.dataId).values=o,c}let o;return o=Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bM(BM,i.shape,r.shape):new yM(BM,i.shape,r.shape),n.runWebGLProgram(o,[i,r],s)}const UM={kernelName:Dn,backendName:"webgl",kernelFunc:zM};function jM(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{shape:s}=i,o=n,a=nt(r.shape),c=ht(s,a),l=nt(c);J(a===l,(()=>"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(r.shape,") has ").concat(a," elements. The new shape and old ")+"shape must have the same number of elements."));const u=o.texData.get(r.dataId);return!u.isPacked||kR(r.shape,c)||null!==u.texture&&kR(u.shape,c)?(o.incRef(r.dataId),{dataId:r.dataId,shape:c,dtype:r.dtype}):function(t,e,n){const i=[_R(t.shape),...TR(t.shape)],r={dtype:t.dtype,shape:i,dataId:t.dataId},s=[_R(e),...TR(e)],o=new KN(s,i),a=n.runWebGLProgram(o,[r],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}}(r,c,o)}const VM={kernelName:Jn,backendName:"webgl",kernelFunc:jM};class WM{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:i,inSize:r,outSize:s}=t;this.outputShape=[i,s];const o=4*Math.floor(n/4),a=n%4;let c="sumValue += dot(values, ones);";if(null!=e){const t=1/e;c="sumValue += dot(values * ".concat(st(t)?t.toPrecision(2):t,", ones);")}let l="";r%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===a,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===a,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===a,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class GM{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:i,inSize:r,outSize:s}=t;this.outputShape=[i,s];let o="0.0",a="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",a="min"):"max"===e&&(o="-1.0 / 1e-20",a="max");let c="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const l=4*Math.floor(n/4),u=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(a,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";r%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}function qM(t,e,n,i){const r=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],i=sp(n);e.push({inSize:n,windowSize:i,outSize:Math.ceil(n/i)})}return e}(t.shape);let s=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:c,outSize:l}=r[o];let u,h;u="mean"===n?0===o?new WM({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},a):new WM({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l}):new GM({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},n),h=s,s=i.runWebGLProgram(u,[s],e),h.dataId!==t.dataId&&i.disposeIntermediateTensorInfo(h)}return s}class HM{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[e[s]];this.outputShape=n,this.rank=n.length;const i=pN(this.rank),r=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],i=new Array(e);for(let r=0;r<t.length;r++)i[t[r]]=n[r];return i.join()}(e);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(r,"));\n    }\n    ")}}class XM{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let l=0;l<n.length;l++)n[l]=t[e[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const i=pN(this.rank),r=HN("rc",this.rank),s=new Array(this.rank);for(let l=0;l<e.length;l++)s[e[l]]=r[l];const o="vec2(".concat(s.slice(-2).join(),")"),a="++".concat(r[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(s.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(a,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(r[this.rank-1],";\n      if(++").concat(r[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(a,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function YM(t,e,n){const i=Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XM(t.shape,e):new HM(t.shape,e);return n.runWebGLProgram(i,[t],t.dtype)}function KM(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i;return function(t,e,n,i){const r=e,s=t.shape.length,o=dt(r,t.shape);let a=o;const c=Hl(a,s),l=null!=c;let u=t;l&&(u=YM(t,c,i),a=Yl(a.length,s)),ql("sum",a,s);const[h,d]=Wl(u.shape,a);let p=h;n&&(p=Gl(h,o));const f=nt(d),m=jM({inputs:{x:u},attrs:{shape:[nt(t.shape)/f,f]},backend:i}),g=qM(m,Ar(t.dtype),"sum",i),v=jM({inputs:{x:g},attrs:{shape:p},backend:i});return i.disposeIntermediateTensorInfo(m),i.disposeIntermediateTensorInfo(g),l&&i.disposeIntermediateTensorInfo(u),v}(r,s,o,n)}const QM={kernelName:vi,backendName:"webgl",kernelFunc:KM};function ZM(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{perm:s}=i,o=n,a=r.shape.length,c=new Array(a);for(let u=0;u<c.length;u++)c[u]=r.shape[s[u]];let l;if(o.shouldExecuteOnCPU([r])){const t=o.texData.get(r.dataId).values,e=GN(t,r.shape,r.dtype,s,c);l=o.makeTensorInfo(c,r.dtype);o.texData.get(l.dataId).values=e}else l=YM(r,s,o);return l}const JM={kernelName:Oi,backendName:"webgl",kernelFunc:ZM},$M=1e3;function tD(t){let{a:e,b:n,transposeA:i,transposeB:r,backend:s,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:c=0,activation:l=null}=t;const u=e.shape.length,h=n.shape.length,d=i?e.shape[u-2]:e.shape[u-1],p=r?n.shape[h-1]:n.shape[h-2],f=i?e.shape[u-1]:e.shape[u-2],m=r?n.shape[h-2]:n.shape[h-1],g=e.shape.slice(0,-2),v=n.shape.slice(0,-2),y=nt(g),x=nt(v);J(u>=2&&h>=2&&(y===x||1===y||1===x),(()=>"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(g,") and (").concat(v,").")));const b=(y>x?e.shape.slice(0,-2):n.shape.slice(0,-2)).concat([f,m]);J(d===p,(()=>"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(p,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(i)+" and transposeB=".concat(r," must match.")));const w=i?[y,d,f]:[y,f,d],S=r?[x,m,p]:[x,p,m],_=jM({inputs:{x:e},backend:s,attrs:{shape:w}}),T=jM({inputs:{x:n},backend:s,attrs:{shape:S}}),E=[_,T],C=Math.max(y,x),k=i?_.shape[1]:_.shape[2],A=null!=o,I=null!=a,O="leakyrelu"===l,R=null!=l?DM(l,!0):null;let N;if((1===f||1===m)&&k>$M&&!1===(A||I||O||null!=R)){let t=_,e=T;i&&(t=ZM({inputs:{x:_},backend:s,attrs:{perm:[0,2,1]}}),E.push(t)),r&&(e=ZM({inputs:{x:T},backend:s,attrs:{perm:[0,2,1]}}),E.push(e));const n=1===m;let o=t;1!==m&&(o=jM({inputs:{x:t},backend:s,attrs:{shape:[C,k,1]}}),E.push(o));const a=1===m?2:1;let c=e;n&&(c=jM({inputs:{x:e},backend:s,attrs:{shape:[C,1,k]}}),E.push(c));const l=zM({inputs:{a:o,b:c},backend:s});N=KM({inputs:{x:l},backend:s,attrs:{axis:a,keepDims:!0}}),E.push(l)}else{const t=kr(e.dtype,n.dtype),l=new PM(w,S,[C,f,m],i,r,A,R,I,O),u=[_,T];if(null!=o&&u.push(o),I&&u.push(a),O){const t=s.makeTensorInfo([],"float32",lr(c,"float32"));u.push(t),E.push(t)}N=s.runWebGLProgram(l,u,t)}const M=jM({inputs:{x:N},backend:s,attrs:{shape:b}});E.push(N);for(const D of E)s.disposeIntermediateTensorInfo(D);return M}const eD={kernelName:Bi,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{a:r,b:s,bias:o,preluActivationWeights:a}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:h}=i;return tD({a:r,b:s,transposeA:c,transposeB:l,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}},nD="return abs(x);";const iD={kernelName:qt,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e;if(n.shouldExecuteOnCPU([i])&&"complex64"!==i.dtype){const t=n.texData.get(i.dataId),e=BN(t.values);return n.makeTensorInfo(i.shape,i.dtype,e)}let r;return r=Ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new dM(i.shape,nD):new tM(i.shape,nD),n.runWebGLProgram(r,[i],i.dtype)}},rD=NM({opSnippet:eM+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),sD={kernelName:Ht,backendName:"webgl",kernelFunc:rD},oD=NM({opSnippet:eM+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),aD={kernelName:Xt,backendName:"webgl",kernelFunc:oD},cD="return a + b;",lD=MM({opSnippet:cD,packedOpSnippet:cD,supportsComplex:!0,cpuKernelImpl:vN}),uD={kernelName:Yt,backendName:"webgl",kernelFunc:lD};class hD{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));const i=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(i,";\n        setOutput(result);\n      }\n    ")}}class dD{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));const i=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(i,";\n        setOutput(result);\n      }\n    ")}}const pD={kernelName:Kt,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:i}=e,r=n;if(1===r.length)return wM({inputs:{x:r[0]},backend:i});if(r.length>Ut().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(r.length/2),n=t({inputs:r.slice(0,e),backend:i}),s=t({inputs:r.slice(e),backend:i});return t({inputs:[n,s],backend:i})}const s=r.map((t=>t.dtype)).reduce(((t,e)=>kr(t,e))),o=r.map((t=>t.shape)),a=Ut().getBool("WEBGL_PACK")?new dD(r[0].shape,o):new hD(r[0].shape,o);return i.runWebGLProgram(a,r,s)}};const fD={kernelName:Qt,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i,a=r.shape.length,c=dt(s,r.shape);let l=c;const u=Hl(l,a);let h=r;null!=u&&(h=ZM({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Yl(l.length,a)),ql("all",l,a);const[d,p]=Wl(h.shape,l),f=jM({inputs:{x:h},backend:n,attrs:{shape:[-1,nt(p)]}}),m=qM(f,f.dtype,"all",n);let g;if(o){g=jM({inputs:{x:m},backend:n,attrs:{shape:Gl(d,c)}})}else g=jM({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};const mD={kernelName:Zt,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i,a=r.shape.length,c=dt(s,r.shape);let l=c;const u=Hl(l,a);let h=r;null!=u&&(h=ZM({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Yl(l.length,a)),ql("any",l,a);const[d,p]=Wl(h.shape,l),f=jM({inputs:{x:h},backend:n,attrs:{shape:[-1,nt(p)]}}),m=qM(f,f.dtype,"any",n);let g;if(o){g=jM({inputs:{x:m},backend:n,attrs:{shape:Gl(d,c)}})}else g=jM({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};class gD{constructor(t,e,n){this.variableNames=["A"];const{windowSize:i,batchSize:r,outSize:s}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s];const o="max"===e?">":"<",a=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(i,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          int inIdx = ").concat(a,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class vD{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,J(t.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const r=t[t.length-1],s=Math.ceil(r/e);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,a=o.length,c=pN(a),l=XN("coords",a);let u,h;if(1===s){h=a+1;const t=pN(h);u="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[a-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[a-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[a-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[a-2],";")}else h=a,u="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(l[a-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(l[a-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(l[a-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(l[a-2],";");const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map((t=>"int "+t)),m=XN("sourceLocR",h-1).concat("inIdx.r"),g=XN("sourceLocG",h-1).concat("inIdx.g"),v=XN("sourceLocB",h-1).concat("inIdx.b"),y=XN("sourceLocA",h-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",b=i?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(y.join(),") : 0.)"),S=i?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(l[a-1]," < ").concat(o[a-1]-1,";\n        bool hasNextRow = ").concat(l[a-2]," < ").concat(o[a-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(b,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(x,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function yD(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.shape[0],s=e.shape[1];null!=i&&(r=i.shape[0],s=i.shape[1]);const o=sp(s),a={windowSize:o,inSize:s,batchSize:r,outSize:Math.ceil(s/o)},c=new gD(a,n,null==i),l=[e];null!=i&&l.push(i);const u=t.runWebGLProgram(c,l,"int32");if(1===u.shape[1])return u;const h=yD(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function xD(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=null!=i?i.shape:e.shape,s=sp(r[r.length-1]),o=new vD(r,s,n,null==i),a=null==i?[e]:[e,i],c=t.runWebGLProgram(o,a,"int32");if(c.shape.length===e.shape.length){const i=xD(t,e,n,c);return t.disposeIntermediateTensorInfo(c),i}return c}function bD(t,e,n,i){const r=[n];if(ql("arg"+i.charAt(0).toUpperCase()+i.slice(1),r,e.shape.length),!Ut().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],[s,o]=Wl(e.shape,r),a=nt(o),c=jM({inputs:{x:e},backend:t,attrs:{shape:[-1,a]}});n.push(c);const l=yD(t,c,i);n.push(l);const u=jM({inputs:{x:l},backend:t,attrs:{shape:s}});return n.forEach((e=>t.disposeIntermediateTensorInfo(e))),u}return xD(t,e,i)}const wD={kernelName:Jt,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s}=i;let o=dt(s,r.shape);const a=Hl(o,r.shape.length);let c=r;const l=[];null!=a&&(c=ZM({inputs:{x:r},backend:n,attrs:{perm:a}}),l.push(c),o=Yl(o.length,c.shape.length)),ql("argMax",[o[0]],c.shape.length);const u=bD(n,c,o[0],"max");return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}};const SD={kernelName:$t,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s}=i;let o=dt(s,r.shape);const a=Hl(o,r.shape.length);let c=r;const l=[];null!=a&&(c=ZM({inputs:{x:r},backend:n,attrs:{perm:a}}),l.push(c),o=Yl(o.length,c.shape.length)),ql("argMin",[o[0]],c.shape.length);const u=bD(n,c,o[0],"min");return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}},_D=NM({opSnippet:eM+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),TD={kernelName:te,backendName:"webgl",kernelFunc:_D},ED=NM({opSnippet:eM+"return log(x + sqrt(x * x + 1.0));"}),CD={kernelName:ee,backendName:"webgl",kernelFunc:ED},kD=NM({opSnippet:eM+"\n  return atan(x);\n"}),AD={kernelName:ne,backendName:"webgl",kernelFunc:kD},ID=MM({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),OD={kernelName:re,backendName:"webgl",kernelFunc:ID},RD=NM({opSnippet:eM+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),ND={kernelName:ie,backendName:"webgl",kernelFunc:RD};class MD{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideHeight,a=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let v="0.0";if(f||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(a,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(i?r?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");const x=4*Math.floor(s/4),b=s%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class DD{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideDepth,a=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let x="0.0";if(y||(x="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(a,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(i?r?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let b="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(b="avgValue / count");const w=4*Math.floor(s/4),S=s%4,_="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(a,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n          setOutput(").concat(b,");\n        }\n      }\n    ")}}const PD={kernelName:se,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e;DR(r,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:c}=i;J(Ec(o,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const l=mc(r.shape,s,o,1,a,c);if(1===l.filterWidth&&1===l.filterHeight&&rt(l.inShape,l.outShape))return wM({inputs:{x:r},backend:n});const u=new MD(l,"avg",!1);return n.runWebGLProgram(u,[r],"float32")}};const FD={kernelName:ae,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{filterSize:s,strides:o,pad:a,dimRoundingMode:c,dataFormat:l}=i,u=gc(r.shape,s,o,[1,1,1],a,c,l),h=new DD(u,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}};class LD{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=a-1-t.padInfo.top,u=c-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(u,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n            wR += ").concat(s,") {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class BD{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,i=t.filterWidth,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=u-1-t.padInfo.front,f=h-1-t.padInfo.top,m=d-1-t.padInfo.left,g=1/(e*n*i);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(r,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const zD={kernelName:ce,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,o=s,{filterSize:a,strides:c,pad:l,dimRoundingMode:u}=i,h=gc(o.shape,a,c,[1,1,1],l,u),d=new BD(h);return n.runWebGLProgram(d,[r],o.dtype)}};const UD={kernelName:oe,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,o=s;DR([r,s],"avgPoolGrad");const{filterSize:a,strides:c,pad:l}=i,u=mc(o.shape,a,c,1,l),h=new LD(u);return n.runWebGLProgram(h,[r],o.dtype)}};const jD={kernelName:le,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{a:r,b:s}=e,{transposeA:o,transposeB:a}=i;return tD({a:r,b:s,transposeA:o,transposeB:a,backend:n})}};class VD{constructor(t,e,n,i,r,s){this.outputShape=[],this.variableNames=["x","mean","variance"],Qa(t,e),Qa(t,n);let o="0.0";null!=i&&(Qa(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="1.0";null!=r&&(Qa(t,r),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(o,";\n        float scale = ").concat(a,";\n        float inv = scale * inversesqrt(variance + float(").concat(s,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class WD{constructor(t,e,n,i,r,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qa(t,e),Qa(t,n);let o="vec4(0.0)";null!=i&&(Qa(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let a="vec4(1.0)";null!=r&&(Qa(t,r),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(o,";\n        vec4 scale = ").concat(a,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(s,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const GD={kernelName:Ze,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:r,mean:s,variance:o,offset:a,scale:c}=e;J(s.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),J(null==a||s.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),J(null==c||s.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=i;null==l&&(l=.001);const u=[r,s,o];let h=null;null!=a&&(h=a.shape,u.push(a));let d=null;null!=c&&(d=c.shape,u.push(c));const p=Ut().getBool("WEBGL_PACK_NORMALIZATION")?new WD(r.shape,s.shape,o.shape,h,d,l):new VD(r.shape,s.shape,o.shape,h,d,l);return n.runWebGLProgram(p,u,u[0].dtype)}};class qD{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=pN(this.rank),n="uniform int start[".concat(this.rank,"];"),i=function(t){if(1===t)return"sourceLoc";if(t<=6)return HD.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let r;const s=t.map(((t,e)=>"sourceLoc.".concat(HD[e]," = start[").concat(e,"] + coords.").concat(HD[e],";")));r="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(s.join("\n"),"\n      "),this.userCode="\n      ".concat(n,"\n      void main() {\n        ").concat(r,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(t.length,")"));return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const HD=["x","y","z","w","u","v"];class XD{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=pN(this.rank),n=XN("coords",this.rank),i=XN("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":"vec2(".concat(i.slice(-2).join(),")"),s="getChannel(getSource(".concat(i.join(),"), ").concat(r,")"),o="\n      result.x = ".concat(s,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(i[this.rank-1],";\n        result.y = ").concat(s,";\n        --").concat(i[this.rank-1],";\n      }\n    "),a=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(i[this.rank-2],";\n        result.z = ").concat(s,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(i[this.rank-1],";\n          result.w = ").concat(s,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map(((t,e)=>"start[".concat(e,"]"))).join(),");"):t.map(((t,e)=>"".concat(i[e]," = ").concat(n[e]," + start[").concat(e,"];"))).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(a,"\n        setOutput(result);\n      }\n    ")}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(t.length,")"));return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}function YD(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{begin:s,size:o}=i,[a,c]=Uo(r,s,o);if(Co(r,a,c),0===nt(c))return n.makeTensorInfo(c,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||"string"===r.dtype){const t=n.texData.get(r.dataId),e=zN(t.values,a,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,e)}const{isPacked:l}=n.texData.get(r.dataId),u=Bo(r.shape,a,c);if(l||!u){const t=Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XD(c):new qD(c),e=t.getCustomSetupFunc(a);return n.runWebGLProgram(t,[r],r.dtype,e)}return n.uploadToGPU(r.dataId),function(t,e,n,i){const r=i.texData.get(t.dataId),s=i.makeTensorInfo(n,t.dtype),o=i.texData.get(s.dataId);Object.assign(o,r),o.complexParentRefCount=0,o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=zo(e,At(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const c=i.dataRefCount.get(o.slice.origDataId)||1;return i.dataRefCount.set(o.slice.origDataId,c+1),s}(r,a,c,n)}const KD={kernelName:ui,backendName:"webgl",kernelFunc:YD},QD={kernelName:ue,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockShape:s,crops:o}=i;J(r.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const a=s.reduce(((t,e)=>t*e)),c=ap(r.shape,s,a),l=cp(c.length,s.length),u=lp(r.shape,s,a),h=up(o,s.length),d=hp(u,o,s.length),p=[],f=jM({inputs:{x:r},backend:n,attrs:{shape:c}}),m=ZM({inputs:{x:f},backend:n,attrs:{perm:l}}),g=jM({inputs:{x:m},backend:n,attrs:{shape:u}}),v=YD({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return p.push(f),p.push(m),p.push(g),p.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}};const ZD={kernelName:he,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,weights:s}=e,{size:o}=i,a=n.readSync(r.dataId),c=n.readSync(s.dataId),l=yN(a,c,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,l)}},JD=MM({opSnippet:"return float(a != b);",dtype:"bool"}),$D={kernelName:Fn,backendName:"webgl",kernelFunc:JD};function tP(t){const{inputs:e,backend:n}=t,{input:i}=e;return wM({inputs:{x:n.texData.get(i.dataId).complexTensorInfos.real},backend:n})}const eP={kernelName:Kn,backendName:"webgl",kernelFunc:tP},nP="return float(int(x));";const iP={kernelName:pe,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:i,attrs:r}=e,{x:s}=n,{dtype:o}=r;if("complex64"===o){if("complex64"===s.dtype)return wM({inputs:{x:s},backend:i});const e=du(s.shape),n=t({inputs:{x:s},backend:i,attrs:{dtype:"float32"}}),r=_M({inputs:{real:n,imag:e},backend:i});return e.dispose(),i.disposeIntermediateTensorInfo(n),r}if("complex64"===s.dtype){const e=tP({inputs:{input:s},backend:i}),n=t({inputs:{x:e},backend:i,attrs:{dtype:o}});return i.disposeIntermediateTensorInfo(e),n}if(!yt(s.dtype,o)){const t=wM({inputs:{x:s},backend:i});return{dataId:t.dataId,shape:t.shape,dtype:o}}if("int32"===o)return function(t,e){const n=new tM(t.shape,nP),i=e.runWebGLProgram(n,[t],"int32");return{dataId:i.dataId,shape:i.shape,dtype:i.dtype}}(s,i);if("bool"===o){const t=i.makeTensorInfo([],"bool",ft("bool",1)),e=JD({inputs:{a:s,b:t},backend:i});return i.disposeIntermediateTensorInfo(t),e}throw new Error("Error in Cast: failed to cast ".concat(s.dtype," to ").concat(o))}},rP="return ceil(x);",sP=NM({opSnippet:rP,packedOpSnippet:rP,cpuKernelImpl:bN}),oP={kernelName:fe,backendName:"webgl",kernelFunc:sP};class aP{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class cP{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}const lP={kernelName:me,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{clipValueMin:s,clipValueMax:o}=i;let a;a=Ut().getBool("WEBGL_PACK_CLIP")?new cP(r.shape):new aP(r.shape);const c=a.getCustomSetupFunc(s,o);return n.runWebGLProgram(a,[r],r.dtype,c)}};class uP{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function hP(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const dP={kernelName:ve,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e,r=n.texData.get(i.dataId),s=new uP(i.shape),o=[hP(i,r.complexTensorInfos.real),hP(i,r.complexTensorInfos.imag)];return n.runWebGLProgram(s,o,o[0].dtype)}};class pP{constructor(t){this.outputShape=[],this.outputShape=ip(t,1),this.variableNames=t.map(((t,e)=>"T".concat(e)));const e=new Array(t.length-1);e[0]=t[0][1];for(let s=1;s<e.length;s++)e[s]=e[s-1]+t[s][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let s=1;s<e.length;s++){const t=e[s-1];n.push("else if (yC < ".concat(e[s],") ")+"setOutput(getT".concat(s,"(yR, yC-").concat(t,"));"))}const i=e.length,r=e[e.length-1];n.push("else setOutput(getT".concat(i,"(yR, yC-").concat(r,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class fP{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ip(t,e);const n=this.outputShape,i=n.length,r=pN(i),s=XN("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map(((t,e)=>"T".concat(e)));const a=new Array(t.length-1);a[0]=t[0][e];for(let f=1;f<a.length;f++)a[f]=a[f-1]+t[f][e];const c=o[e],l=o.slice(-2),u=o.join();let h="if (".concat(c," < ").concat(a[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(l.join(),"));\n        }");for(let f=1;f<a.length;f++){const t=a[f-1];h+="\n        if (".concat(c," < ").concat(a[f],"  && ").concat(c," >= ").concat(a[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(mP(o,c,t),"),\n            vec2(").concat(mP(l,c,t),"));\n        }")}const d=a.length,p=a[a.length-1];h+="\n        return getChannel(\n          getT".concat(d,"(").concat(mP(o,c,p),"),\n          vec2(").concat(mP(l,c,p),"));"),this.userCode="\n      float getValue(".concat(o.map((t=>"int "+t)),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(r," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(s,"), 0., 0., 0.);\n\n        ").concat(s[i-1]," = ").concat(s[i-1]," + 1;\n        if (").concat(s[i-1]," < ").concat(n[i-1],") {\n          result.g = getValue(").concat(s,");\n        }\n\n        ").concat(s[i-2]," = ").concat(s[i-2]," + 1;\n        if (").concat(s[i-2]," < ").concat(n[i-2],") {\n          result.a = getValue(").concat(s,");\n        }\n\n        ").concat(s[i-1]," = ").concat(s[i-1]," - 1;\n        if (").concat(s[i-2]," < ").concat(n[i-2]," &&\n            ").concat(s[i-1]," < ").concat(n[i-1],") {\n          result.b = getValue(").concat(s,");\n        }\n        setOutput(result);\n      }\n    ")}}function mP(t,e,n){const i=t.indexOf(e);return t.map(((t,e)=>e===i?"".concat(t," - ").concat(n):t)).join()}function gP(t){const{inputs:e,backend:n}=t,{input:i}=e;return wM({inputs:{x:n.texData.get(i.dataId).complexTensorInfos.imag},backend:n})}const vP={kernelName:sn,backendName:"webgl",kernelFunc:gP};function yP(t,e,n){const i=t[0].dtype;if("complex64"===i){const i=t.map((t=>tP({inputs:{input:t},backend:n}))),r=t.map((t=>gP({inputs:{input:t},backend:n}))),s=yP(i,e,n),o=yP(r,e,n),a=_M({inputs:{real:s,imag:o},backend:n});return i.forEach((t=>n.disposeIntermediateTensorInfo(t))),r.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),a}if("string"===i){const{tensors2D:r,outShape:s}=xP(t,e,n),o=r.map((t=>({vals:n.readSync(t.dataId),shape:t.shape}))),a=1===r[0].shape[0],c=wN(o,s,i,a),l=ip(t.map((t=>t.shape)),e),u=n.makeTensorInfo(l,i,c);return r.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}if(t.length>Ut().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const i=Math.floor(t.length/2),r=yP(t.slice(0,i),e,n),s=yP(t.slice(i),e,n),o=yP([r,s],e,n);return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),o}if(Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const r=new fP(t.map((t=>t.shape)),e);return n.runWebGLProgram(r,t,i)}const{tensors2D:r,outShape:s}=xP(t,e,n),o=new pP(r.map((t=>t.shape))),a=n.runWebGLProgram(o,r,i);r.forEach((t=>n.disposeIntermediateTensorInfo(t)));const c=jM({inputs:{x:a},attrs:{shape:s},backend:n});return n.disposeIntermediateTensorInfo(a),c}function xP(t,e,n){const i=ip(t.map((t=>t.shape)),e);return{tensors2D:t.map((t=>jM({inputs:{x:t},attrs:{shape:[-1,nt(t.shape.slice(e))]},backend:n}))),outShape:i}}function bP(t){const{inputs:e,backend:n,attrs:i}=t,{axis:r}=i,s=dt(r,e[0].shape)[0],o=ip(e.map((t=>t.shape)),s);if(0===nt(o))return n.makeTensorInfo(o,e[0].dtype,[]);const a=e.filter((t=>nt(t.shape)>0));if(1===a.length)return wM({inputs:{x:a[0]},backend:n});return np(a.map((t=>t.shape)),s),yP(a,s,n)}const wP={kernelName:ye,backendName:"webgl",kernelFunc:bP};class SP{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const s=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,v=m?2:3,y=m?3:1;let x="",b="";n&&(x=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),b="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(a,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(v,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")}}class _P{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,i=t.padInfo.left,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(r,", ").concat(s,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(i,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(a,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class TP{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:i,inChannels:r,strideWidth:s,strideHeight:o,padInfo:a,outWidth:c,dilationWidth:l,dilationHeight:u,dataFormat:h}=n,{left:d,top:p}=a,f=r*i,m=FR(),g="channelsLast"===h,v=g?0:1,y=g?1:2;let x="";for(let b=0;b<=1;b++)for(let n=0;n<=1;n++)x+="\n          blockIndex = rc.y + ".concat(n,";\n          pos = rc.x + ").concat(b,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(o," - ").concat(p,";\n            d0 = offsetY + ").concat(u," * (pos / ").concat(f,");\n\n            if(d0 < ").concat(e[v]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(s,". - ").concat(d,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(f,".) / ").concat(r,".));\n\n              if(d1 < ").concat(e[y]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(r,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*b+n,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*b+n,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(x,"\n\n        ").concat(m.output," = result;\n      }\n    ")}}function EP(t){let{x:e,filter:n,convInfo:i,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:c=null}=t;const l=e.shape,u=r.texData.get(e.dataId),h=i.inChannels,d=l[0]*l[1]*l[2],p=i.outChannels,f="channelsLast"===i.dataFormat;let m;const g=[],v=(1===d||1===p)&&h>$M,y=l[2]%2!==0&&!!u.isPacked;if(!v&&Ut().getBool("WEBGL_LAZILY_UNPACK")&&Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&y){const t=f?l[0]*l[1]*(l[2]+1):l[0]*l[2]*(l[3]+1),h={dataId:e.dataId,shape:[1,t,i.inChannels],dtype:e.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,J(kR(u.shape,h.shape),(()=>"packed reshape ".concat(u.shape," to ").concat(h.shape," isn't free")));const p=jM({inputs:{x:n},backend:r,attrs:{shape:[1,i.inChannels,i.outChannels]}});g.push(p);const v=tD({a:h,b:p,backend:r,transposeA:false,transposeB:false,bias:s,activation:c,preluActivationWeights:o,leakyreluAlpha:a}),y=r.texData.get(v.dataId);J(y.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=d,y.shape=i.outShape,m=wM({inputs:{x:v},backend:r}),m.shape=i.outShape,g.push(v)}else{const t=jM({inputs:{x:e},backend:r,attrs:{shape:[1,f?l[0]*l[1]*l[2]:l[0]*l[2]*l[3],i.inChannels]}}),u=jM({inputs:{x:n},backend:r,attrs:{shape:[1,i.inChannels,i.outChannels]}}),h=tD({a:t,b:u,transposeA:false,transposeB:false,backend:r,bias:s,activation:c,preluActivationWeights:o,leakyreluAlpha:a});m=jM({inputs:{x:h},backend:r,attrs:{shape:i.outShape}}),g.push(t),g.push(u),g.push(h)}for(const x of g)r.disposeIntermediateTensorInfo(x);return m}function CP(t){let{x:e,filter:n,convInfo:i,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:c=null}=t;const{filterWidth:l,filterHeight:u,inChannels:h,outWidth:d,outHeight:p,dataFormat:f}=i,m="channelsLast"===f,g=l*u*h,v=p*d,y=[g,v],x=[],b=jM({inputs:{x:e},backend:r,attrs:{shape:e.shape.slice(1)}}),w=jM({inputs:{x:n},backend:r,attrs:{shape:[1,g,nt(n.shape)/g]}});x.push(b),x.push(w);const S=new TP(y,b.shape,i),_=r.runWebGLProgram(S,[b],"float32"),T=jM({inputs:{x:_},backend:r,attrs:{shape:[1,y[0],y[1]]}});x.push(_),x.push(T);const E=null!=s,C=null!=o,k="leakyrelu"===c,A=c?DM(c,!0):null,I=new PM(T.shape,w.shape,[1,v,i.outChannels],!0,!1,E,A,C,k),O=[T,w];if(s&&O.push(s),C&&O.push(o),k){const t=r.makeTensorInfo([],"float32",lr(a,"float32"));O.push(t),x.push(t)}const R=r.runWebGLProgram(I,O,"float32"),N=jM({inputs:{x:R},backend:r,attrs:{shape:m?[1,p,d,i.outChannels]:[1,i.outChannels,p,d]}});x.push(R);for(const M of x)r.disposeIntermediateTensorInfo(M);return N}const kP={kernelName:xe,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dataFormat:c,dilations:l,dimRoundingMode:u}=i,h=Cc(c),d=vc(r.shape,s.shape,o,l,a,u,!1,h);let p;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(Ut().getBool("WEBGL_CONV_IM2COL")&&1===r.shape[0])p=CP({x:r,filter:s,convInfo:d,backend:n});else{const t=new SP(d);p=n.runWebGLProgram(t,[r,s],"float32")}else p=EP({x:r,filter:s,convInfo:d,backend:n});const f=jM({inputs:{x:p},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class AP{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,i=t.padInfo.top,r=t.padInfo.left,s="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(i,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(s,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class IP{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,a=n-1-t.padInfo.left,c=s?1:2,l=s?2:3,u=s?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(s,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class OP{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,i=t.strideWidth,r=t.padInfo.front,s=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(r,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(s,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(i," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class RP{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,i=t.filterWidth,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.front,c=n-1-t.padInfo.top,l=i-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(a,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(r,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(s,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(i,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(i," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const NP={kernelName:be,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:u}=i,h=Cc(c),d=vc(r.shape,u,o,1,a,l,!1,h),p=new AP(d);return n.runWebGLProgram(p,[r,s],"float32")}};const MP={kernelName:we,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{inputShape:o,strides:a,pad:c,dataFormat:l,dimRoundingMode:u}=i,h=Cc(l),d=vc(o,s.shape,a,1,c,u,!1,h),p=new IP(d);return n.runWebGLProgram(p,[r,s],"float32")}};const DP={kernelName:Se,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dilations:c}=i,l=yc(r.shape,s.shape,o,c,a),u=new _P(l);return n.runWebGLProgram(u,[r,s],"float32")}};const PP={kernelName:_e,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,pad:a,filterShape:c}=i,l=yc(r.shape,c,o,1,a),u=new OP(l);return n.runWebGLProgram(u,[r,s],"float32")}};const FP={kernelName:Te,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{pad:o,strides:a,inputShape:c}=i,l=yc(c,s.shape,a,1,o),u=new RP(l);return n.runWebGLProgram(u,[r,s],"float32")}},LP=NM({opSnippet:RM+"\n  return cos(x);\n"}),BP={kernelName:Ee,backendName:"webgl",kernelFunc:LP},zP=NM({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),UP={kernelName:Ce,backendName:"webgl",kernelFunc:zP};class jP{constructor(t,e,n,i,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,a,c]=t,[l]=e,[u,h]=n;this.outputShape=[l,u,h,c];const d="bilinear"===i?1:0,[p,f]=["".concat(o-1,".0"),"".concat(a-1,".0")],[m,g,v]=u>1?["".concat((o-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[y,x,b]=h>1?["".concat((a-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(y,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(x,";\n\n        float in_y = ").concat(v,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n        float in_x = ").concat(b,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(r,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const VP={kernelName:Ae,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{image:r,boxes:s,boxInd:o}=e,{cropSize:a,method:c,extrapolationValue:l}=i,u=new jP(r.shape,s.shape,a,c,l);return n.runWebGLProgram(u,[r,s,o],"float32")}};class WP{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const i=t.length,r=e?"0.0":"getX(".concat(GP(i,"coords"),")"),s=t[t.length-1];let o="",a="";e?(o=n?"end != ".concat(s-1):"end != 0",a=n?"end + 1":"end - 1"):(o=n?"end + pow2 < ".concat(s):"end >= pow2",a=n?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(pN(i)," coords = getOutputCoords();\n        int end = ").concat(qP(i,"coords"),";\n        float val = ").concat(r,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(o,") {\n          int idx = ").concat(a,";\n          ").concat(qP(i,"coords")," = idx;\n          val += getX(").concat(GP(i,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}getCustomSetupFunc(t){return(e,n)=>{null==this.index&&(this.index=e.getUniformLocation(n,"index")),e.gl.uniform1f(this.index,t)}}}function GP(t,e){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}function qP(t,e){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}const HP={kernelName:ke,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,exclusive:o,reverse:a}=i,c=r.shape.length,l=Hl([s],c);let u=r;null!=l&&(u=ZM({inputs:{x:r},backend:n,attrs:{perm:l}}));const h=Yl(1,c)[0];if(h!==c-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(r.shape.length-1," ")+"but got axis=".concat(s));const d=u.shape[h];let p=wM({inputs:{x:u},backend:n});for(let f=0;f<=Math.ceil(Math.log2(d))-1;f++){const t=new WP(u.shape,!1,a),e=t.getCustomSetupFunc(f),i=p;p=n.runWebGLProgram(t,[p],p.dtype,e),n.disposeIntermediateTensorInfo(i)}if(o){const t=new WP(u.shape,o,a),e=p;p=n.runWebGLProgram(t,[p],p.dtype),n.disposeIntermediateTensorInfo(e)}if(null!=l){const t=ZM({inputs:{x:p},backend:n,attrs:{perm:Xl(l)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(u),t}return p}};const XP={kernelName:Ie,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,weights:s}=e,{size:o,binaryOutput:a}=i;if(1===r.shape.length){const t=n.readSync(r.dataId),e=n.readSync(s.dataId),i=yN(t,e,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,i)}if(2===r.shape.length){const t=n.bufferSync(r),e=n.bufferSync(s),i=xN(t,e,o,a);return n.makeTensorInfo(i.shape,s.dtype,i.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(r.shape.length,"."))}};class YP{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const KP={kernelName:Oe,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockSize:s,dataFormat:o}=i;J(s>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(s)));const a=r.shape[0],c="NHWC"===o?r.shape[1]:r.shape[2],l="NHWC"===o?r.shape[2]:r.shape[3],u="NHWC"===o?r.shape[3]:r.shape[1],h=c*s,d=l*s,p=u/(s*s),f=new YP("NHWC"===o?[a,h,d,p]:[a,p,h,d],s,o);return n.runWebGLProgram(f,[r],r.dtype)}};class QP{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const s=t.inHeight,o=t.inWidth,a=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,m=t.outChannels/t.inChannels;let g="",v="";n&&(g=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),v="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(g,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(m,";\n        int q = d2 - d1 * ").concat(m,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(h,";\n\n          if (xR < 0 || xR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(o,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")}}class ZP{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const s=t.inHeight,o=t.inWidth,a=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,f=t.filterWidth,m=f;let g="int xR; int xC; int xCOffset;";for(let b=0;b<p;b++)for(let t=0;t<f;t++)g+="\n          vec4 xTexelR".concat(b,"C").concat(2*t," = vec4(0.);\n          vec4 wR").concat(b,"C").concat(t," = vec4(0.);\n          vec4 xR").concat(b,"C").concat(t," = vec4(0.);");for(let b=0;b<p;b++)for(let t=0;t<m;t++){const e=2*t;if(g+="\n          xR = xRCorner + ".concat(b*h,";\n          xC = xCCorner + ").concat(e*d,";\n        "),1===u){if(e<f&&(g+=c%2===1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(s," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(s," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(b,"C").concat(e," = vec4(previous.zw, xTexelR").concat(b,"C").concat(e,".xy);\n                } else {\n                  xR").concat(b,"C").concat(e," = vec4(0, 0, xTexelR").concat(b,"C").concat(e,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(s," && xC >= 0 && xC < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = xTexelR").concat(b,"C").concat(e,";\n              "),e+1<f)){const t=c%2===0?Y(d):d;d%2===0&&c%2===1||d%2!==0&&c%2!==1?(g+="\n                  xCOffset = xC + ".concat(c%2," + ").concat(t,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),d>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(s," &&\n                      xCOffset >= 0 && xCOffset < ").concat(o,") {\n                      xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                    }\n                  ")),g+="\n                  xR".concat(b,"C").concat(e+1," = vec4(\n                    xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".xy);\n                ")):g+="\n                  xCOffset = xC + ".concat(t,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(b,"C").concat(e+1," = xTexelR").concat(b,"C").concat(e+2,";\n                ")}}else e<f&&(g+="\n              if(xR >= 0 && xR < ".concat(s,") {\n            "),c%2===1?(g+="\n                xCOffset = xC + 1 - ".concat(u,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e+2," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = vec4(\n                  xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".zw);\n              "),e+1<f&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(u,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(b,"C").concat(e+1," = vec4(xTexelR").concat(b,"C").concat(e+2,".xy, final.xy);\n                "))):(g+="\n                if(xC >= 0 && xC < ".concat(o,") {\n                  xTexelR").concat(b,"C").concat(e," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(u,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(b,"C").concat(e+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(b,"C").concat(e+2," = vec4(0.);\n                }\n\n                xR").concat(b,"C").concat(e," = vec4(\n                  xTexelR").concat(b,"C").concat(e,".xy, xTexelR").concat(b,"C").concat(e+2,".xy);\n              "),e+1<f&&(g+="\n                  xR".concat(b,"C").concat(e+1," = vec4(\n                    xTexelR").concat(b,"C").concat(e,".zw, xTexelR").concat(b,"C").concat(e+2,".zw);\n                "))),g+="}");e<f&&(g+="\n            vec4 wTexelR".concat(b,"C").concat(e," = getW(").concat(b,", ").concat(e,", d1, q);\n            wR").concat(b,"C").concat(e," = vec4(wTexelR").concat(b,"C").concat(e,".xz, wTexelR").concat(b,"C").concat(e,".xz);\n          "),e+1<f&&(g+="\n              vec4 wTexelR".concat(b,"C").concat(e+1," = getW(").concat(b,", ").concat(e+1,", d1, q);\n              wR").concat(b,"C").concat(e+1," =\n                vec4(wTexelR").concat(b,"C").concat(e+1,".xz, wTexelR").concat(b,"C").concat(e+1,".xz);")))}for(let b=0;b<p;b++)for(let t=0;t<f;t++)g+="dotProd += xR".concat(b,"C").concat(t," * wR").concat(b,"C").concat(t,";");let v="",y="";n&&(v=i?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):r?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),y="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(c,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(g,"\n\n        vec4 result = dotProd;\n        ").concat(x,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")}}const JP={kernelName:Re,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dilations:c,dimRoundingMode:l}=i;let u=c;null==u&&(u=[1,1]),J(Ec(o,u),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(u,"'")));const h=vc(r.shape,s.shape,o,u,a,l,!0);let d;return d=Ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new ZP(h):new QP(h),n.runWebGLProgram(d,[r,s],"float32")}};class $P{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,i=t.padInfo.top,r=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(s," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(i,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(r,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class tF{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.strideHeight,r=t.strideWidth,s=e-1-t.padInfo.top,o=n-1-t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(a,"; dm++) {\n              int d2 = d1 * ").concat(a," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const eF={kernelName:Ne,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,dy:s}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,filterShape:u}=i,h=vc(r.shape,u,o,a,c,l,!0),d=new $P(h);return n.runWebGLProgram(d,[r,s],"float32")}};const nF={kernelName:Me,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,filter:s}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,inputShape:u}=i,h=vc(u,s.shape,o,a,c,l,!0),d=new tF(h);return n.runWebGLProgram(d,[r,s],"float32")}};class iF{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const rF={kernelName:De,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e,r=[...i.shape,...i.shape],s=nt(i.shape),o=jM({inputs:{x:i},backend:n,attrs:{shape:[s]}}),a=new iF(s),c=n.runWebGLProgram(a,[o],o.dtype),l=jM({inputs:{x:c},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),l}};class sF{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:i,strideHeight:r,strideWidth:s,filterHeight:o,filterWidth:a,dilationHeight:c,dilationWidth:l}=t,{top:u,left:h}=i;this.userCode="\n      const ivec2 strides = ivec2(".concat(r,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(a,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const oF={kernelName:Pe,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s}=e,{strides:o,pad:a,dilations:c}=i,l=fc(r.shape,s.shape,o,a,"NHWC",c);let u;const h=new sF(l);u=n.runWebGLProgram(h,[r,s],"float32");const d=jM({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),d}},aF=NM({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),cF={kernelName:ze,backendName:"webgl",kernelFunc:aF},lF={kernelName:Ue,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:i,y:r}=e,s=Ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bM("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",i.shape,r.shape):new yM("return (b >= 1.0) ? a : a * (b + 1.0);",i.shape,r.shape);return n.runWebGLProgram(s,[i,r],i.dtype)}},uF=MM({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),hF={kernelName:Ve,backendName:"webgl",kernelFunc:uF},dF=NM({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(fp,";\n  float a1 = ").concat(mp,";\n  float a2 = ").concat(gp,";\n  float a3 = ").concat(vp,";\n  float a4 = ").concat(yp,";\n  float a5 = ").concat(xp,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),pF={kernelName:je,backendName:"webgl",kernelFunc:dF},fF="return exp(x);",mF=NM({opSnippet:fF,packedOpSnippet:fF,cpuKernelImpl:SN}),gF={kernelName:We,backendName:"webgl",kernelFunc:mF};function vF(t){const{inputs:e,attrs:n,backend:i}=t,{dim:r}=n,{input:s}=e,o=s.shape.length,a=s.shape.slice();let c=r;return r<0&&(J(-(o+1)<=r,(()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]"))),c=o+r+1),a.splice(c,0,1),jM({inputs:{x:s},backend:i,attrs:{shape:a}})}const yF={kernelName:Ge,backendName:"webgl",kernelFunc:vF},xF="return exp(x) - 1.0;",bF=NM({opSnippet:xF,packedOpSnippet:xF,cpuKernelImpl:_N}),wF={kernelName:qe,backendName:"webgl",kernelFunc:bF};class SF{constructor(t,e,n){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const r=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=n?"".concat(i,".0"):"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(r,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(i,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function _F(t,e,n){const i=n.texData.get(t.dataId),r=nt(t.shape),s=t.shape[t.shape.length-1],o=jM({inputs:{x:t},backend:n,attrs:{shape:[r/s,s]}}),a=o.shape,c=new SF("real",a,e),l=new SF("imag",a,e),u=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:a},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:a}],h=n.runWebGLProgram(c,u,"float32"),d=n.runWebGLProgram(l,u,"float32"),p=_M({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const f=jM({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),f}const TF={kernelName:He,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e;return _F(i,!1,n)}};class EF{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}function CF(t){const{backend:e,attrs:n}=t,{shape:i,value:r}=n;let{dtype:s}=n;if(s=s||Et(r),"string"===s){const t=mt(s,nt(i));return t.fill(r),e.makeTensorInfo(i,s,t)}{const t=new EF(i,r),n=t.getCustomSetupFunc(r);return e.runWebGLProgram(t,[],s,n)}}const kF={kernelName:Xe,backendName:"webgl",kernelFunc:CF};class AF{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const IF={kernelName:Ye,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:i}=e,r=n,s=new AF(i.shape);return r.runWebGLProgram(s,[i],i.dtype)}},OF="return floor(x);",RF=NM({opSnippet:OF,packedOpSnippet:OF,cpuKernelImpl:TN}),NF={kernelName:Ke,backendName:"webgl",kernelFunc:RF},MF=MM({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),DF={kernelName:Qe,backendName:"webgl",kernelFunc:MF};class PF{constructor(t){this.variableNames=["A"];const e=FR(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class FF{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=FR(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}const LF={kernelName:Fi,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t;let{pixels:r}=e;const{numChannels:s}=i,o="undefined"!==typeof HTMLVideoElement&&r instanceof HTMLVideoElement,a="undefined"!==typeof HTMLImageElement&&r instanceof HTMLImageElement,c="undefined"!==typeof ImageBitmap&&r instanceof ImageBitmap,[l,u]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],h=[u,l],d=[u,l,s];(a||o||c)&&(null==BF&&(BF=document.createElement("canvas").getContext("2d")),BF.canvas.width=l,BF.canvas.height=u,BF.drawImage(r,0,0,l,u),r=BF.canvas);const p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=rR.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);const f=Ut().getBool("WEBGL_PACK")?new FF(d):new PF(d),m=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),m}};let BF;const zF={kernelName:zi,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=i,m=Cc(u),g=vc(r.shape,s.shape,c,h,l,d,!1,m);let v;const y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Ut().getBool("WEBGL_CONV_IM2COL")&&1===r.shape[0])v=CP({x:r,filter:s,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const t=null!=o,e=null!=a,i="leakyrelu"===p,c=p?DM(p,!1):null,l=new SP(g,t,c,e,i),u=[r,s];if(o&&u.push(o),a&&u.push(a),i){const t=n.makeTensorInfo([],"float32",lr(f,"float32"));u.push(t),y.push(t)}v=n.runWebGLProgram(l,u,"float32")}else v=EP({x:r,filter:s,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});const x=jM({inputs:{x:v},backend:n,attrs:{shape:g.outShape}});return y.push(v),y.forEach((t=>n.disposeIntermediateTensorInfo(t))),x}};const UF={kernelName:Ui,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,filter:s,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=i,f=[];let m=u;null==m&&(m=[1,1]),J(Ec(c,m),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(m,"'")));const g=vc(r.shape,s.shape,c,m,l,h,!0),v=Ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=d?DM(d,v):null,x=[r,s],b=null!=o,w=null!=a,S="leakyrelu"===d;if(b&&x.push(o),w&&x.push(a),S){const t=n.makeTensorInfo([],"float32",lr(p,"float32"));x.push(t),f.push(t)}let _;_=v?new ZP(g,b,y,w,S):new QP(g,b,y,w,S);const T=n.runWebGLProgram(_,x,"float32");return f.forEach((t=>n.disposeIntermediateTensorInfo(t))),T}};class jF{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const i=pN(e.length),r=pN(n.length),s=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(i," strides = ").concat(i,"(").concat(this.strides,");\n         void main() {\n          ").concat(r," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(s,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")}}const VF={kernelName:$e,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:i,indices:r}=e,s=r.shape,o=s[s.length-1],[a,c,l,u]=So(i,r),h=jM({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),d=jM({inputs:{x:i},backend:n,attrs:{shape:[nt(i.shape)/l,l]}}),p=new jF(o,u,[c,l]),f=n.runWebGLProgram(p,[d,h],d.dtype),m=jM({inputs:{x:f},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),m}};class WF{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=pN(this.rank),i=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[];for(let r=0;r<t.length;r++)2===r?i.push("int(getIndices(resRC.x, resRC.z))"):i.push("".concat(n[r]));return i.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")}}const GF={kernelName:Je,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,indices:s}=e,{axis:o,batchDims:a}=i,c=Mp(r,s,dt(o,r.shape)[0],a),l=nt(s.shape),u=[],h=jM({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),d=jM({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});u.push(h),u.push(d);const p=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,s])||"string"===r.dtype){const t=n.bufferSync(d),e=n.bufferSync(h),i=EN(e,t,p);return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(c.outputShape,i.dtype,i.values)}const f=new WF(h.shape,p),m=n.runWebGLProgram(f,[h,d],h.dtype);u.push(m);const g=jM({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}},qF=MM({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:CN,dtype:"bool"}),HF={kernelName:tn,backendName:"webgl",kernelFunc:qF},XF=MM({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),YF={kernelName:en,backendName:"webgl",kernelFunc:XF};const KF={kernelName:rn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:i}=e;return _F(i,!0,n)}},QF=NM({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),ZF={kernelName:on,backendName:"webgl",kernelFunc:QF},JF=NM({opSnippet:"return float(isinf(x));",dtype:"bool"}),$F={kernelName:an,backendName:"webgl",kernelFunc:JF},tL=NM({opSnippet:"return float(isnan(x));",dtype:"bool"}),eL={kernelName:cn,backendName:"webgl",kernelFunc:tL},nL=MM({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:kN,dtype:"bool"}),iL={kernelName:un,backendName:"webgl",kernelFunc:nL},rL=MM({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),sL={kernelName:hn,backendName:"webgl",kernelFunc:rL};const oL={kernelName:dn,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:i,stop:r,num:s}=n,o=AN(i,r,s);return e.makeTensorInfo([o.length],"float32",o)}},aL=NM({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:IN}),cL={kernelName:pn,backendName:"webgl",kernelFunc:aL},lL=NM({opSnippet:"return log(1.0 + x);"}),uL={kernelName:fn,backendName:"webgl",kernelFunc:lL},hL=MM({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),dL={kernelName:mn,backendName:"webgl",kernelFunc:hL},pL=NM({opSnippet:"return float(!(x >= 1.0));"}),fL={kernelName:gn,backendName:"webgl",kernelFunc:pL},mL=MM({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),gL={kernelName:vn,backendName:"webgl",kernelFunc:mL};class vL{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[];const s=e,o=t[3]-1;let a;this.outputShape=t;const c="float(".concat(n,") + float(").concat(i,") * sum");a=.5===r?"inversesqrt(".concat(c,")"):1===r?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(a,";\n        setOutput(val);\n      }\n    ")}}class yL{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=e,o=t[3]-1;let a;this.outputShape=t;const c="float(".concat(n,") + float(").concat(i,") * sum");a=.5===r?"inversesqrt(".concat(c,")"):1===r?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(r,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(a,";\n        setOutput(result);\n      }\n    ")}}const xL={kernelName:xn,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{depthRadius:s,bias:o,alpha:a,beta:c}=i,l=Ut().getBool("WEBGL_PACK_NORMALIZATION")?new yL(r.shape,s,o,a,c):new vL(r.shape,s,o,a,c);return n.runWebGLProgram(l,[r],r.dtype)}};class bL{constructor(t,e,n,i,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=i,this.beta=r,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(i,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(i,")\n                * float(").concat(r,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(r,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const wL={kernelName:bn,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{x:r,y:s,dy:o}=e,{depthRadius:a,bias:c,alpha:l,beta:u}=i,h=new bL(r.shape,a,c,l,u);return n.runWebGLProgram(h,[r,s,o],r.dtype)}};function SL(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{reductionIndices:s,keepDims:o}=i,a=r.shape.length,c=dt(s,r.shape);let l=c;const u=Hl(l,a),h=null!=u,d=n.shouldExecuteOnCPU([r]);let p=r;if(h){if(d){const t=n.texData.get(p.dataId).values,e=new Array(a);for(let n=0;n<e.length;n++)e[n]=r.shape[u[n]];const i=GN(t,r.shape,r.dtype,u,e);p=n.makeTensorInfo(e,r.dtype);n.texData.get(p.dataId).values=i}else p=YM(r,u,n);l=Yl(l.length,a)}ql("max",l,a);const[f,m]=Wl(p.shape,l);let g,v=f;if(o&&(v=Gl(f,c)),d){const t=n.texData.get(p.dataId).values,e=ON(t,nt(m),v,r.dtype);g=n.makeTensorInfo(v,r.dtype);n.texData.get(g.dataId).values=e}else g=function(t,e,n,i){const r=nt(e),s=jM({inputs:{x:t},attrs:{shape:[nt(t.shape)/r,r]},backend:i}),o=qM(s,t.dtype,"max",i),a=jM({inputs:{x:o},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(s),i.disposeIntermediateTensorInfo(o),a}(p,m,v,n);return h&&n.disposeIntermediateTensorInfo(p),g}const _L={kernelName:wn,backendName:"webgl",kernelFunc:SL},TL=MM({opSnippet:vM+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  "+xM+"\n  return result;\n",cpuKernelImpl:RN}),EL={kernelName:Sn,backendName:"webgl",kernelFunc:TL};const CL={kernelName:_n,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e;DR(r,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:c}=i;J(Ec(o,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const l=mc(r.shape,s,o,1,a,c);if(1===l.filterWidth&&1===l.filterHeight&&rt(l.inShape,l.outShape))return wM({inputs:{x:r},backend:n});const u=new MD(l,"max",!1);return n.runWebGLProgram(u,[r],r.dtype)}};const kL={kernelName:En,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{filterSize:s,strides:o,pad:a,dataFormat:c,dimRoundingMode:l}=i,u=gc(r.shape,s,o,[1,1,1],a,l,c),h=new DD(u,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}};class AL{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,i=t.dilationHeight,r=t.effectiveFilterHeight,s=t.effectiveFilterWidth,o=r-1-t.padInfo.top,a=s-1-t.padInfo.left,c=r*s-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(r,";\n          wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(s," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class IL{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,i=t.strideWidth,r=t.dilationDepth,s=t.dilationHeight,o=t.dilationWidth,a=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,u=a-1-t.padInfo.front,h=c-1-t.padInfo.top,d=l-1-t.padInfo.left,p=a*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(a,";\n           wD += ").concat(r,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(s,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const OL={kernelName:Cn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s}=e,o=s,{filterSize:a,strides:c,pad:l,dimRoundingMode:u}=i,h=gc(o.shape,a,c,[1,1,1],l,u),d=new DD(h,"max",!0),p=n.runWebGLProgram(d,[o],o.dtype),f=new IL(h),m=n.runWebGLProgram(f,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}};const RL={kernelName:Tn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{dy:r,input:s,output:o}=e,a=s;DR([s,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:h}=i,d=mc(a.shape,c,l,1,u,h),p=new MD(d,"max",!0),f=n.runWebGLProgram(p,[a],a.dtype),m=new AL(d),g=n.runWebGLProgram(m,[r,f],a.dtype);return n.disposeIntermediateTensorInfo(f),g}};const NL={kernelName:kn,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:r}=e,{filterSize:s,strides:o,pad:a,includeBatchInIndex:c}=n,l=i;J(4===r.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(r.shape.length,".")));const u=[1,1];J(Ec(o,u),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(u,"'")));const h=mc(r.shape,s,o,u,a),[d,p]=function(t,e,n,i){let r=new MD(n,"max",!1);const s=i.runWebGLProgram(r,[t],"float32");return r=new MD(n,"max",!0,!0,e),[s,i.runWebGLProgram(r,[t],"float32")]}(r,c,h,l);return[d,p]}};const ML={kernelName:An,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{x:r}=e,{keepDims:s,axis:o}=n,a=i,c=r.shape.length,l=dt(o,r.shape);let u=l;const h=Hl(u,c),d=null!=h,p=a.shouldExecuteOnCPU([r]),f=[];let m=r;if(d){if(p){const t=a.texData.get(m.dataId).values,e=new Array(c);for(let i=0;i<e.length;i++)e[i]=r.shape[h[i]];const n=GN(t,r.shape,r.dtype,h,e);m=a.makeTensorInfo(e,r.dtype);a.texData.get(m.dataId).values=n}else m=YM(r,h,a);f.push(m),u=Yl(u.length,c)}ql("sum",u,c);const[g,v]=Wl(m.shape,u);let y=g;s&&(y=Gl(g,l));const x=function(t,e,n,i){const r=nt(e),s=jM({inputs:{x:t},attrs:{shape:[nt(t.shape)/r,r]},backend:i}),o=qM(s,"float32","mean",i),a=jM({inputs:{x:o},attrs:{shape:n},backend:i});return i.disposeIntermediateTensorInfo(s),i.disposeIntermediateTensorInfo(o),a}(m,v,y,a);for(const b of f)a.disposeIntermediateTensorInfo(b);return x}};const DL={kernelName:In,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i,a=r.shape.length,c=dt(s,r.shape);let l=c;const u=Hl(l,a);let h=r;null!=u&&(h=ZM({inputs:{x:r},backend:n,attrs:{perm:u}}),l=Yl(l.length,r.shape.length)),ql("min",l,a);const[d,p]=Wl(h.shape,l),f=jM({inputs:{x:h},backend:n,attrs:{shape:[-1,nt(p)]}}),m=qM(f,f.dtype,"min",n);let g;if(o){g=jM({inputs:{x:m},backend:n,attrs:{shape:Gl(d,c)}})}else g=jM({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}},PL=MM({opSnippet:vM+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  "+xM+"\n  return result;\n",cpuKernelImpl:NN}),FL={kernelName:On,backendName:"webgl",kernelFunc:PL};class LL{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=pN(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c="reflect"===n?0:1;this.userCode=1!==i?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(i,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(r," coords = outC - start;\n        setOutput(getX(").concat(a,"));\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class BL{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=pN(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=XN("rc",i),c=XN("source",i),l="".concat(a[i-1]," < ").concat(this.outputShape[i-1]),u=1===i?"source":"vec2(".concat(c.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===i){const t="\n        ".concat(r," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(a[i-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ")}else{const t="\n        ".concat(r," source = rc;\n        ").concat(r," lt = ").concat(r,"(lessThan(source, start));\n        ").concat(r," gte = ").concat(r,"(greaterThanEqual(source, end));\n        ").concat(r," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(r," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(a[i-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(a[i-2]," += 1;\n        if(").concat(a[i-2]," < ").concat(this.outputShape[i-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          ").concat(a[i-1]," += 1;\n          if(").concat(l,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const zL={kernelName:Rn,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:r}=e,{paddings:s,mode:o}=i,a=Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BL(r.shape,s,o):new LL(r.shape,s,o);return n.runWebGLProgram(a,[r],r.dtype)}},UL=MM({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  "+xM+"\n  return result;\n"}),jL={kernelName:Nn,backendName:"webgl",kernelFunc:UL};class VL{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}const WL=MM({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),GL={kernelName:Be,backendName:"webgl",kernelFunc:WL},qL="return a - b;",HL=MM({opSnippet:qL,packedOpSnippet:qL,supportsComplex:!0,cpuKernelImpl:jN}),XL={kernelName:_i,backendName:"webgl",kernelFunc:HL};function YL(t){const{inputs:e,backend:n,attrs:i}=t,{logits:r}=e,{dim:s}=i,o=dt([s],r.shape),a=SL({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),c=Gl(a.shape,o),l=jM({inputs:{x:a},backend:n,attrs:{shape:c}}),u=HL({inputs:{a:r,b:l},backend:n}),h=mF({inputs:{x:u},backend:n}),d=KM({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),p=jM({inputs:{x:d},backend:n,attrs:{shape:c}}),f=WL({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}const KL={kernelName:bi,backendName:"webgl",kernelFunc:YL};const QL={kernelName:Mn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{logits:r}=e,{numSamples:s,seed:o,normalized:a}=i,c=a?r:YL({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),l=c.shape[0],u=c.shape[1],h=new VL(l,u,s),d=h.getCustomSetupFunc(o),p=n.runWebGLProgram(h,[c],"int32",d);return a||n.disposeIntermediateTensorInfo(c),p}},ZL="return -x;";const JL={kernelName:Pn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e;if(n.shouldExecuteOnCPU([i])){const t=n.texData.get(i.dataId),[e,r]=DN(t.values,i.shape,i.dtype);return n.makeTensorInfo(r,i.dtype,e)}let r;return r=Ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new dM(i.shape,ZL):new tM(i.shape,ZL),n.runWebGLProgram(r,[i],i.dtype)}},$L=xd;const tB={kernelName:Ln,backendName:"webgl",kernelFunc:function(t){bp("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c}=i,l=n.readSync(r.dataId),u=n.readSync(s.dataId),{selectedIndices:h}=$L(l,u,o,a,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},eB=bd;const nB={kernelName:Bn,backendName:"webgl",kernelFunc:function(t){bp("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=i,u=n.readSync(r.dataId),h=n.readSync(s.dataId),{selectedIndices:d,validOutputs:p}=eB(u,h,o,a,c,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},iB=wd;const rB={kernelName:zn,backendName:"webgl",kernelFunc:function(t){bp("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:i}=t,{boxes:r,scores:s}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=i,u=n.readSync(r.dataId),h=n.readSync(s.dataId),d=o,p=a,f=c,m=l,{selectedIndices:g,selectedScores:v}=iB(u,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}};class sB{constructor(t,e,n,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(i,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const oB={kernelName:jn,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{indices:r}=e,{depth:s,onValue:o,offValue:a}=i,c=nt(r.shape),l=new sB(c,s,o,a),u=jM({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(l,[u],r.dtype);n.disposeIntermediateTensorInfo(u);const d=jM({inputs:{x:h},backend:n,attrs:{shape:[...r.shape,s]}});return n.disposeIntermediateTensorInfo(h),d}};function aB(t){const{inputs:e,backend:n}=t,{x:i}=e;if("complex64"===i.dtype){const t=tP({inputs:{input:i},backend:n}),e=aB({inputs:{x:t},backend:n}),r=gP({inputs:{input:i},backend:n}),s=aB({inputs:{x:r},backend:n}),o=_M({inputs:{real:e,imag:s},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),o}return CF({attrs:{shape:i.shape,dtype:i.dtype,value:"string"===i.dtype?"":0},backend:n})}const cB={kernelName:Di,backendName:"webgl",kernelFunc:aB};const lB={kernelName:Un,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:i}=e,{x:r}=n;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){const e=tP({inputs:{input:r},backend:i}),n=t({inputs:{x:e},backend:i}),s=gP({inputs:{input:r},backend:i}),o=aB({inputs:{x:s},backend:i}),a=_M({inputs:{real:n,imag:o},backend:i});return i.disposeIntermediateTensorInfo(e),i.disposeIntermediateTensorInfo(n),i.disposeIntermediateTensorInfo(s),i.disposeIntermediateTensorInfo(o),a}return CF({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:i})}};const uB={kernelName:Vn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{axis:r}=i;if(1===e.length)return vF({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const s=e[0].shape,o=e[0].dtype;e.forEach((t=>{$(s,t.shape,"All tensors passed to stack must have matching shapes"),J(o===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],c=bP({inputs:e.map((t=>{const e=vF({inputs:{input:t},backend:n,attrs:{dim:r}});return a.push(e),e})),backend:n,attrs:{axis:r}});return a.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}};class hB{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=pN(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?"\n      ".concat(r," start = ").concat(r,"(").concat(s,");\n      ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(n,"));\n        } else {\n          ").concat(r," coords = outC - start;\n          setOutput(getX(").concat(a,"));\n        }\n      }\n    "):"\n        int start = ".concat(s,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(n,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class dB{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,r=pN(i),s=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),a=XN("rc",i),c=XN("source",i),l="".concat(a[i-1]," < ").concat(this.outputShape[i-1]),u=1===i?"source":"vec2(".concat(c.slice(-2).join(),")"),h=["".concat(r," rc = outputLoc;"),"".concat(a[i-1]," += 1;\n       if(").concat(l,") {\n      "),1===i?"":"}\n       rc = outputLoc;\n       ".concat(a[i-2]," += 1;\n       if(").concat(a[i-2]," < ").concat(this.outputShape[i-2],") {"),1===i?"":"  ".concat(a[i-1]," += 1;\n         if(").concat(l,") {")],d=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===i?2:4;f<m;f++)p+="\n        ".concat(h[f],"\n        if (").concat(d,") {\n          result[").concat(f,"] = float(").concat(n,");\n        } else {\n          ").concat(r," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ");p+=1===i?"} ":"}}",this.userCode="\n      const ".concat(r," start = ").concat(r,"(").concat(s,");\n      const ").concat(r," end = ").concat(r,"(").concat(o,");\n\n      void main() {\n        ").concat(r," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const pB=t=>{const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{paddings:s,constantValue:o}=i,a=Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dB(r.shape,s,o):new hB(r.shape,s,o);return n.runWebGLProgram(a,[r],r.dtype)},fB={kernelName:Wn,backendName:"webgl",kernelFunc:pB},mB=MM({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  "+xM+"\n  return result;\n"}),gB={kernelName:qn,backendName:"webgl",kernelFunc:mB};const vB={kernelName:Xn,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{axis:s,keepDims:o}=i,a=r.shape.length,c=[],l=dt(s,r.shape);let u=l;const h=Hl(u,a);let d,p=r;if(null!=h&&(p=ZM({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Yl(u.length,a),c.push(p)),ql("prod",u,a),n.shouldExecuteOnCPU([p])){const t=n.texData.get(p.dataId).values,{outVals:e,outShape:i,outDtype:r}=PN(p.shape,p.dtype,t,u);d=n.makeTensorInfo(i,r,e)}else{const[t,e]=Wl(p.shape,u),i=nt(e),s=jM({inputs:{x:p},backend:n,attrs:{shape:[-1,i]}}),o=qM(s,Ar(r.dtype),"prod",n);d=jM({inputs:{x:o},backend:n,attrs:{shape:t}}),c.push(s),c.push(o)}if(o){c.push(d);const t=Gl(d.shape,l);d=jM({inputs:{x:d},backend:n,attrs:{shape:t}})}return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}},yB=t=>{const{backend:e,attrs:n}=t,{start:i,stop:r,step:s,dtype:o}=n,a=FN(i,r,s,o);return e.makeTensorInfo([a.length],o,a)},xB={kernelName:Yn,backendName:"webgl",kernelFunc:yB},bB=NM({opSnippet:"return 1.0 / x;"}),wB={kernelName:Qn,backendName:"webgl",kernelFunc:bB},SB=NM({opSnippet:eM+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),_B={kernelName:Zn,backendName:"webgl",kernelFunc:SB},TB=NM({opSnippet:eM+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),EB={kernelName:ii,backendName:"webgl",kernelFunc:TB};class CB{constructor(t,e,n,i,r){this.variableNames=["A"],this.outputShape=[];const[s,o,a,c]=t;this.outputShape=[s,e,n,c];const l=[i&&e>1?o-1:o,i&&n>1?a-1:a],u=[i&&e>1?e-1:e,i&&n>1?n-1:n];let h;h=r?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(a,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class kB{constructor(t,e,n,i,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,a,c]=t;this.outputShape=[s,e,n,c];const l=[i&&e>1?o-1:o,i&&n>1?a-1:a],u=[i&&e>1?e-1:e,i&&n>1?n-1:n];let h;h=r?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(a,".0,\n                                     ").concat(a,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const AB={kernelName:ei,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r}=e,{alignCorners:s,halfPixelCenters:o,size:a}=i,[c,l]=a,u=Ut().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kB(r.shape,c,l,s,o):new CB(r.shape,c,l,s,o);return n.runWebGLProgram(u,[r],"float32")}};class IB{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,r]=e,[,s,o]=t,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],c=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/c[0],u=a[1]/c[1],h=1/l,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(r-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const OB={kernelName:ni,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r,dy:s}=e,{alignCorners:o}=i,a=new IB(s.shape,r.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}};class RB{constructor(t,e,n,i,r){this.variableNames=["A"],this.outputShape=[];const[s,o,a,c]=t;this.outputShape=[s,e,n,c];const l=[i&&e>1?o-1:o,i&&n>1?a-1:a],u=[i&&e>1?e-1:e,i&&n>1?n-1:n],h=i?"0.5":"0.0";let d;d=r?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(a,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}const NB={kernelName:$n,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r}=e,{alignCorners:s,halfPixelCenters:o,size:a}=i,[c,l]=a,u=new RB(r.shape,c,l,s,o);return n.runWebGLProgram(u,[r],r.dtype)}};class MB{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,r]=e,[,s,o]=t,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],c=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/c[0],u=a[1]/c[1],h=1/l,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(a[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(a[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const DB={kernelName:ti,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{images:r,dy:s}=e,{alignCorners:o}=i,a=new MB(s.shape,r.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}};class PB{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const i=t.map(((n,i)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(i))).join(","),r=pN(n);this.userCode="\n      void main() {\n        ".concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}class FB{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const i=XN("rc",n),r="".concat(i[n-1]," + 1 < ").concat(this.outputShape[n-1]),s="".concat(i[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=pN(n);function a(n){const i=t.map(((i,r)=>function(n,i){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(i[n]," - 1"):"".concat(i[n])}(r,n))),r=i.join(","),s=i.slice(-2).join(",");return"getChannel(getX(".concat(r,"), vec2(").concat(s,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(r,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return a(t)}(i.slice()),";\n          if(").concat(r,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(i.slice()),";\n          }\n          if(").concat(s,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice()),";\n            if(").concat(r,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const LB={kernelName:ri,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{dims:s}=i,o=r.shape.length,a=dt(s,r.shape);if(0===o)return wM({inputs:{x:r},backend:n});const c=Ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FB(r.shape,a):new PB(r.shape,a);return n.runWebGLProgram(c,[r],r.dtype)}};class BB{constructor(t,e,n,i){this.variableNames=["Image"],this.outputShape=[];const r=t[1],s=t[2],o=Math.sin(e).toFixed(3),a=Math.cos(e).toFixed(3);this.outputShape=t;const[c,l]=op(i,r,s),u=c.toFixed(3),h=l.toFixed(3);let d="";d="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(u,") * ").concat(a," - (float(y) - ").concat(h,") * ").concat(o,";\n          float coordYFloat = (float(x) - ").concat(u,") * ").concat(o," + (float(y) - ").concat(h,") * ").concat(a,";\n          int coordX = int(round(coordXFloat + ").concat(u,"));\n          int coordY = int(round(coordYFloat + ").concat(h,"));\n          ").concat(d,"\n          if(coordX >= 0 && coordX < ").concat(s," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const zB={kernelName:Li,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:r}=e,{radians:s,fillValue:o,center:a}=n,c=i,l=new BB(r.shape,s,o,a);return c.runWebGLProgram(l,[r],r.dtype)}},UB=NM({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),jB={kernelName:si,backendName:"webgl",kernelFunc:UB},VB=NM({opSnippet:"return inversesqrt(x);",cpuKernelImpl:LN}),WB={kernelName:oi,backendName:"webgl",kernelFunc:VB};class GB{constructor(t,e,n,i,r,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const o=pN(r.length),a=pN(s.length);let c="";1===n?c="i":2===n&&(c="i, j");const l="getIndices(".concat(c,")");let u="";1===i?u="i":2===i&&(u="i, coords[1]");const h="getUpdates(".concat(u,")"),d=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(r,");\n\n        void main() {\n          ").concat(a," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}}const qB={kernelName:ai,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{indices:r,updates:s}=e,{shape:o}=i,{sliceRank:a,numUpdates:c,sliceSize:l,strides:u,outputSize:h}=Eo(0,r,o),d=[h/l,l];if(0===h)return n.makeTensorInfo(o,r.dtype);const p=jM({inputs:{x:r},backend:n,attrs:{shape:[c,a]}}),f=jM({inputs:{x:s},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new GB(c,a,p.shape.length,f.shape.length,u,d),v=n.runWebGLProgram(g,[f,p,m],f.dtype),y=jM({inputs:{x:v},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),y}};class HB{constructor(t,e,n){let i,r;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)r="resRC",i="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let i=0;i<e.length;i++)o.push("".concat(n[i])),i<t&&s.push("".concat(n[i]));i=s.join(),r=o.join()}const s=pN(n);this.userCode="\n      void main() {\n        ".concat(s," resRC = getOutputCoords();\n        float cVal = getC(").concat(i,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(r,"));\n        } else {\n          setOutput(getB(").concat(r,"));\n        }\n      }\n    ")}}const XB={kernelName:ci,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:i,t:r,e:s}=e,o=new HB(i.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[i,r,s],kr(r.dtype,s.dtype))}},YB=NM({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(dp,";\n  float scale = ").concat(pp,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),KB={kernelName:li,backendName:"webgl",kernelFunc:YB},QB=NM({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),ZB={kernelName:fi,backendName:"webgl",kernelFunc:QB},JB=NM({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),$B={kernelName:pi,backendName:"webgl",kernelFunc:JB},tz=NM({opSnippet:RM+"\n  return sin(x);\n"}),ez={kernelName:hi,backendName:"webgl",kernelFunc:tz},nz=NM({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),iz={kernelName:di,backendName:"webgl",kernelFunc:nz},rz=NM({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),sz={kernelName:mi,backendName:"webgl",kernelFunc:rz},oz={kernelName:yi,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{blockShape:s,paddings:o}=i;J(r.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const a=s.reduce(((t,e)=>t*e)),c=[[0,0]];c.push(...o);for(let v=1+s.length;v<r.shape.length;++v)c.push([0,0]);const l=[],u=pB({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),h=ap(u.shape,s,a,!1),d=cp(h.length,s.length,!1),p=lp(u.shape,s,a,!1),f=jM({inputs:{x:u},backend:n,attrs:{shape:h}}),m=ZM({inputs:{x:f},backend:n,attrs:{perm:d}}),g=jM({inputs:{x:m},backend:n,attrs:{shape:p}});return l.push(u),l.push(f),l.push(m),l.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}};const az={kernelName:Ti,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{sparseIndices:r,sparseValues:s,defaultValue:o}=e,{outputShape:a}=i,{sliceRank:c,numUpdates:l,strides:u,outputSize:h}=Eo(0,r,a),d=new GB(l,c,r.shape.length,s.shape.length,u,[h,1],!1),p=n.runWebGLProgram(d,[s,r,o],s.dtype),f=jM({inputs:{x:p},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(p),f}};const cz={kernelName:xi,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{numOrSizeSplits:s,axis:o}=i,a=dt(o,r.shape)[0],c=Op(r,s,a),l=r.shape.length,u=new Array(l).fill(0),h=r.shape.slice();return c.map((t=>{const e=[...h];e[a]=t;const i=YD({inputs:{x:r},backend:n,attrs:{begin:u,size:e}});return u[a]+=t,i}))}},lz=NM({opSnippet:"return sqrt(x);"}),uz={kernelName:gi,backendName:"webgl",kernelFunc:lz},hz=NM({opSnippet:"return x * x;"}),dz={kernelName:Si,backendName:"webgl",kernelFunc:hz},pz="return (a - b) * (a - b);",fz=MM({opSnippet:pz,packedOpSnippet:pz}),mz={kernelName:wi,backendName:"webgl",kernelFunc:fz};const gz={kernelName:Pi,backendName:"webgl",kernelFunc:function(t){let{inputs:e,attrs:n,backend:i}=t;const{x:r}=e,s=eM+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new tM(r.shape,s);return i.runWebGLProgram(o,[r],r.dtype)}};class vz{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const i=n.length,r=pN(n.length),s=pN(n.length);let o="";if(1===i)o="coords * strides + begin";else{let t=0;o=n.map(((e,i)=>(t++,1===n.length?"coords * strides[".concat(i,"] + begin[").concat(i,"]"):"coords[".concat(t-1,"] * strides[").concat(i,"] + begin[").concat(i,"]")))).join(",")}this.userCode="\n      ".concat(r," begin = ").concat(r,"(").concat(t,");\n      ").concat(r," strides = ").concat(r,"(").concat(e,");\n\n      void main() {\n        ").concat(s," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}const yz={kernelName:Ei,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{begin:s,end:o,strides:a,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=i,{nonStrided:p,$begin:f,$strides:m,size:g,newShape:v,outShape:y}=jo(r.shape,s,o,a,c,l,u,h,d),x=jM({inputs:{x:r},backend:n,attrs:{shape:v}});let b;if(p){const t=YD({inputs:{x:x},backend:n,attrs:{begin:f,size:g}});b=jM({inputs:{x:t},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(t)}else if(y.some((t=>0===t)))b=n.makeTensorInfo(y,r.dtype,[]);else{if(n.shouldExecuteOnCPU([x])){const t=n.texData.get(x.dataId).values,e=Hs(x.shape,x.dtype,t),i=UN(y,e,m,f);b=n.makeTensorInfo(y,x.dtype,i.values)}else{const t=new vz(f,m,y);b=n.runWebGLProgram(t,[x],x.dtype)}}const w=jM({inputs:{x:b},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),w}},xz=NM({opSnippet:"return tan(x);"}),bz={kernelName:Ci,backendName:"webgl",kernelFunc:xz},wz=NM({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Sz={kernelName:ki,backendName:"webgl",kernelFunc:wz};class _z{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[s]*e[s];this.outputShape=n,this.rank=n.length;const i=pN(this.rank),r=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],i=[];for(let r=0;r<t.length;r++)i.push("imod(".concat(n[r],", ").concat(t[r],")"));return i.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(r,"));\n      }\n    ")}}function Tz(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{reps:s}=i;if("string"===r.dtype){const t=n.readSync(r.dataId).map((t=>fr(t))),e=Hs(r.shape,r.dtype,t),i=VN(e,s);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const o=new _z(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const Ez={kernelName:Ai,backendName:"webgl",kernelFunc:Tz};const Cz={kernelName:Ii,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r}=e,{k:s,sorted:o}=i,a=n.readSync(r.dataId),[c,l]=WN(a,r.shape,r.dtype,s,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};const kz={kernelName:Ri,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:i}=t,{axis:r}=n,{x:s}=e;DR(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=i.readSync(s.dataId),{outputValues:a,outputShape:c,indices:l}=qN(o,r,s.shape,s.dtype);return[i.makeTensorInfo(c,s.dtype,a),i.makeTensorInfo([l.length],"int32",l)]}};const Az={kernelName:Ni,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{value:r}=e;let{axis:s}=i;s<0&&(s+=r.shape.length);const o=r,a=o.shape.length,c=r.shape[s],l=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==s&&(l[u++]=o.shape[m]);const h=[],d=new Array(a).fill(0),p=o.shape.slice();p[s]=1;const f=new Array(c);for(let m=0;m<f.length;m++){d[s]=m;const t=YD({inputs:{x:o},backend:n,attrs:{begin:d,size:p}}),e=jM({inputs:{x:t},backend:n,attrs:{shape:l}});f[m]=e,h.push(t)}return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}};class Iz{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,i=t.batchSize,r=t.inSize,s=t.numSegments,o=s*Math.ceil(r/n);this.outputShape=[i,o];const a=4*Math.floor(n/4),c=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let u="";r%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return initializationValue;\n        }\n      "));let h="";r%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(r,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(s,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(s,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(a,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const Oz={kernelName:Mi,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:r,segmentIds:s}=e,{numSegments:o}=i,a=r.shape.length,c=[];let l=0;const u=Hl([l],a);let h=r;null!=u&&(h=ZM({inputs:{x:r},backend:n,attrs:{perm:u}}),c.push(h),l=Yl(1,a)[0]);const d=Np(h.shape,l,o),p=nt([h.shape[l]]),f=jM({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});c.push(f);const m=Ar(r.dtype),g=(t,e,i,r,s)=>{const o=t.shape[0],a=t.shape[1],l=Rp(a,s),u=new Iz({windowSize:l,inSize:a,batchSize:o,numSegments:s},e),h=n.compileAndRun(u,[t,i],r);if(c.push(h),h.shape[1]===s)return h;const d=yB({backend:n,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),p=Tz({inputs:{x:d},backend:n,attrs:{reps:[a/l]}});c.push(d),c.push(p);return g(h,e,p,r,s)},v=jM({inputs:{x:g(f,"unsortedSegmentSum",s,m,o)},backend:n,attrs:{shape:d}});let y=v;if(null!=u){c.push(v);const t=Xl(u);y=ZM({inputs:{x:y},backend:n,attrs:{perm:t}})}return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}},Rz=[xL,wL,eD,iD,sD,aD,uD,pD,fD,mD,wD,SD,TD,CD,OD,AD,ND,FD,PD,zD,UD,jD,GD,QD,ZD,iP,oP,lP,dP,TM,wP,NP,MP,kP,PP,FP,DP,BP,UP,VP,HP,XP,KP,eF,nF,JP,rF,oF,cF,lF,hF,pF,gF,yF,wF,TF,kF,IF,NF,DF,LF,zF,UF,VF,GF,HF,YF,SM,KF,vP,ZF,$F,eL,kM,iL,sL,oL,uL,cL,dL,fL,gL,_L,kL,CL,OL,RL,NL,EL,ML,DL,FL,zL,jL,QL,UM,JL,tB,nB,rB,$D,oB,lB,uB,fB,gB,OM,vB,xB,eP,GL,wB,EB,_B,VM,AB,OB,NB,DB,LB,zB,jB,WB,qB,XB,KB,ZB,$B,ez,iz,KD,KL,sz,oz,az,cz,uz,dz,mz,gz,yz,XL,QM,bz,Sz,Ez,Cz,JM,kz,Az,Oz,cB];for(const Dz of Rz)Hi(Dz);const Nz={"tfjs-core":ia,"tfjs-backend-cpu":"2.8.6","tfjs-backend-webgl":"2.8.6","tfjs-data":yE,"tfjs-layers":by,"tfjs-converter":aT,tfjs:"2.8.6"}},8667:function(t,e,n){!function(t,e,n,i){"use strict";var r=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},s=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},o=function(t,e){return{startTime:e,type:"setValue",value:t}},a=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},c=function(t,e,n){var i=n.startTime,r=n.target,s=n.timeConstant;return r+(e-r)*Math.exp((i-t)/s)},l=function(t){return"exponentialRampToValue"===t.type},u=function(t){return"linearRampToValue"===t.type},h=function(t){return l(t)||u(t)},d=function(t){return"setValue"===t.type},p=function(t){return"setValueCurve"===t.type},f=function t(e,n,i,r){var s=e[n];return void 0===s?r:h(s)||d(s)?s.value:p(s)?s.values[s.values.length-1]:c(i,t(e,n-1,s.startTime,r),s)},m=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:h(n)?[n.endTime,n.value]:d(n)?[n.startTime,n.value]:p(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,f(t,e-1,n.startTime,r)]},g=function(t){return"cancelAndHold"===t.type},v=function(t){return"cancelScheduledValues"===t.type},y=function(t){return g(t)||v(t)?t.cancelTime:l(t)||u(t)?t.endTime:t.startTime},x=function(t,e,n,i){var r=i.endTime,s=i.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(r-e)):0},b=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},w=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},S=function(t,e){var n=e.duration,i=e.startTime,r=e.values,s=(t-i)/n*(r.length-1);return w(r,s)},_=function(t){return"setTarget"===t.type},T=function(t){function w(t){n(this,w),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return i(w,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=y(t);if(g(t)||v(t)){var n=this._automationEvents.findIndex((function(n){return v(t)&&p(n)?n.startTime+n.duration>=e:y(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),g(t)){var c=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&h(i)){if(void 0!==c&&_(c))throw new Error("The internal list is malformed.");var d=void 0===c?i.insertTime:p(c)?c.startTime+c.duration:y(c),f=void 0===c?this._defaultValue:p(c)?c.values[c.values.length-1]:c.value,m=l(i)?x(e,d,f,i):b(e,d,f,i),w=l(i)?r(m,e,this._currenTime):s(m,e,this._currenTime);this._automationEvents.push(w)}if(void 0!==c&&_(c)&&this._automationEvents.push(o(this.getValue(e),e)),void 0!==c&&p(c)&&c.startTime+c.duration>e){var S=e-c.startTime,T=(c.values.length-1)/c.duration,E=Math.max(2,1+Math.ceil(S*T)),C=S/(E-1)*T,k=c.values.slice(0,E);if(C<1)for(var A=1;A<E;A+=1){var I=C*A%1;k[A]=c.values[A-1]*(1-I)+c.values[A]*I}this._automationEvents[this._automationEvents.length-1]=a(k,c.startTime,S)}}}else{var O=this._automationEvents.findIndex((function(t){return y(t)>e})),R=-1===O?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[O-1];if(void 0!==R&&p(R)&&y(R)+R.duration>e)return!1;var N=l(t)?r(t.value,t.endTime,this._currenTime):u(t)?s(t.value,e,this._currenTime):t;if(-1===O)this._automationEvents.push(N);else{if(p(t)&&e+t.duration>y(this._automationEvents[O]))return!1;this._automationEvents.splice(O,0,N)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return y(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];_(i)&&n.unshift(o(f(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var n=this._automationEvents.findIndex((function(e){return y(e)>t})),i=this._automationEvents[n],r=(-1===n?this._automationEvents.length:n)-1,s=this._automationEvents[r];if(void 0!==s&&_(s)&&(void 0===i||!h(i)||i.insertTime>t))return c(t,f(this._automationEvents,r-1,s.startTime,this._defaultValue),s);if(void 0!==s&&d(s)&&(void 0===i||!h(i)))return s.value;if(void 0!==s&&p(s)&&(void 0===i||!h(i)||s.startTime+s.duration>t))return t<s.startTime+s.duration?S(t,s):s.values[s.values.length-1];if(void 0!==s&&h(s)&&(void 0===i||!h(i)))return s.value;if(void 0!==i&&l(i)){var o=m(this._automationEvents,r,s,i,this._defaultValue),a=e(o,2),g=a[0],v=a[1];return x(t,g,v,i)}if(void 0!==i&&u(i)){var w=m(this._automationEvents,r,s,i,this._defaultValue),T=e(w,2),E=T[0],C=T[1];return b(t,E,C,i)}return this._defaultValue}}]),w}(Symbol.iterator),E=function(t){return{cancelTime:t,type:"cancelAndHold"}},C=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},k=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},A=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},I=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=T,t.createCancelAndHoldAutomationEvent=E,t.createCancelScheduledValuesAutomationEvent=C,t.createExponentialRampToValueAutomationEvent=k,t.createLinearRampToValueAutomationEvent=A,t.createSetTargetAutomationEvent=I,t.createSetValueAutomationEvent=o,t.createSetValueCurveAutomationEvent=a}(e,n(7424),n(6690),n(9728))},9702:(t,e)=>{"use strict";e.parse=function(t,e){if("string"!==typeof t)throw new TypeError("argument str must be a string");for(var i={},s=e||{},a=t.split(r),c=s.decode||n,l=0;l<a.length;l++){var u=a[l],h=u.indexOf("=");if(!(h<0)){var d=u.substr(0,h).trim(),p=u.substr(++h,u.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),void 0==i[d]&&(i[d]=o(p,c))}}return i},e.serialize=function(t,e,n){var r=n||{},o=r.encode||i;if("function"!==typeof o)throw new TypeError("option encode is invalid");if(!s.test(t))throw new TypeError("argument name is invalid");var a=o(e);if(a&&!s.test(a))throw new TypeError("argument val is invalid");var c=t+"="+a;if(null!=r.maxAge){var l=r.maxAge-0;if(isNaN(l))throw new Error("maxAge should be a Number");c+="; Max-Age="+Math.floor(l)}if(r.domain){if(!s.test(r.domain))throw new TypeError("option domain is invalid");c+="; Domain="+r.domain}if(r.path){if(!s.test(r.path))throw new TypeError("option path is invalid");c+="; Path="+r.path}if(r.expires){if("function"!==typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+r.expires.toUTCString()}r.httpOnly&&(c+="; HttpOnly");r.secure&&(c+="; Secure");if(r.sameSite){switch("string"===typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return c};var n=decodeURIComponent,i=encodeURIComponent,r=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function o(t,e){try{return e(t)}catch(n){return t}}},2618:(t,e,n)=>{var i;!function(){"use strict";var r=!("undefined"===typeof window||!window.document||!window.document.createElement),s={canUseDOM:r,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen};void 0===(i=function(){return s}.call(e,n,e,t))||(t.exports=i)}()},2110:(t,e,n)=>{"use strict";var i=n(7441),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(t){return i.isMemo(t)?o:a[t.$$typeof]||r}a[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[i.Memo]=o;var l=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;t.exports=function t(e,n,i){if("string"!==typeof n){if(f){var r=p(n);r&&r!==f&&t(e,r,i)}var o=u(n);h&&(o=o.concat(h(n)));for(var a=c(e),m=c(n),g=0;g<o.length;++g){var v=o[g];if(!s[v]&&(!i||!i[v])&&(!m||!m[v])&&(!a||!a[v])){var y=d(n,v);try{l(e,v,y)}catch(x){}}}}return e}},8861:t=>{!function(){"use strict";const e={debug:!1,parse:function(t,n){if(t instanceof Uint8Array)return e.Uint8(t);if("string"===typeof t)return e.Base64(t);if(t instanceof HTMLElement&&"file"===t.type)return e.addListener(t,n);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(t,n){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(void 0===t||!(t instanceof HTMLElement)||"INPUT"!==t.tagName||"file"!==t.type.toLowerCase())return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;n=n||function(){},t.addEventListener("change",(function(t){if(!t.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let i=new FileReader;i.readAsArrayBuffer(t.target.files[0]),i.onload=function(t){n(e.Uint8(new Uint8Array(t.target.result)))}}))},Base64:function(t){let n=function(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(t=t.replace(/^.*?base64,/,""),t=String(t).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(t))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");t+="==".slice(2-(3&t.length));let n,i,r,s="",o=0;for(;o<t.length;)n=e.indexOf(t.charAt(o++))<<18|e.indexOf(t.charAt(o++))<<12|(i=e.indexOf(t.charAt(o++)))<<6|(r=e.indexOf(t.charAt(o++))),s+=64===i?String.fromCharCode(n>>16&255):64===r?String.fromCharCode(n>>16&255,n>>8&255):String.fromCharCode(n>>16&255,n>>8&255,255&n);return s}(t=String(t)),i=n.length,r=new Uint8Array(new ArrayBuffer(i));for(let e=0;e<i;e++)r[e]=n.charCodeAt(e);return e.Uint8(r)},Uint8:function(t){let e={data:null,pointer:0,movePointer:function(t){return this.pointer+=t,this.pointer},readInt:function(t){if((t=Math.min(t,this.data.byteLength-this.pointer))<1)return-1;let e=0;if(t>1)for(let n=1;n<=t-1;n++)e+=this.data.getUint8(this.pointer)*Math.pow(256,t-n),this.pointer++;return e+=this.data.getUint8(this.pointer),this.pointer++,e},readStr:function(t){let e="";for(let n=1;n<=t;n++)e+=String.fromCharCode(this.readInt(1));return e},readIntVLV:function(){let t=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)t=this.readInt(1);else{let e=[];for(;this.data.getUint8(this.pointer)>=128;)e.push(this.readInt(1)-128);let n=this.readInt(1);for(let i=1;i<=e.length;i++)t+=e[e.length-i]*Math.pow(128,i);t+=n}return t}};if(e.data=new DataView(t.buffer,t.byteOffset,t.byteLength),1297377380!==e.readInt(4))return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;e.readInt(4);let n={};n.formatType=e.readInt(2),n.tracks=e.readInt(2),n.track=[];let i=e.readInt(1),r=e.readInt(1);i>=128?(n.timeDivision=[],n.timeDivision[0]=i-128,n.timeDivision[1]=r):n.timeDivision=256*i+r;for(let s=1;s<=n.tracks;s++){n.track[s-1]={event:[]};let t=e.readInt(4);if(-1===t)break;if(1297379947!==t)return!1;e.readInt(4);let i,r,o=0,a=!1;for(;!a&&(o++,n.track[s-1].event[o-1]={},n.track[s-1].event[o-1].deltaTime=e.readIntVLV(),i=e.readInt(1),-1!==i);)if(i>=128?r=i:(i=r,e.movePointer(-1)),255===i){n.track[s-1].event[o-1].type=255,n.track[s-1].event[o-1].metaType=e.readInt(1);let t=e.readIntVLV();switch(n.track[s-1].event[o-1].metaType){case 47:case-1:a=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:n.track[s-1].event[o-1].data=e.readStr(t);break;case 33:case 89:case 81:n.track[s-1].event[o-1].data=e.readInt(t);break;case 84:n.track[s-1].event[o-1].data=[],n.track[s-1].event[o-1].data[0]=e.readInt(1),n.track[s-1].event[o-1].data[1]=e.readInt(1),n.track[s-1].event[o-1].data[2]=e.readInt(1),n.track[s-1].event[o-1].data[3]=e.readInt(1),n.track[s-1].event[o-1].data[4]=e.readInt(1);break;case 88:n.track[s-1].event[o-1].data=[],n.track[s-1].event[o-1].data[0]=e.readInt(1),n.track[s-1].event[o-1].data[1]=e.readInt(1),n.track[s-1].event[o-1].data[2]=e.readInt(1),n.track[s-1].event[o-1].data[3]=e.readInt(1);break;default:null!==this.customInterpreter&&(n.track[s-1].event[o-1].data=this.customInterpreter(n.track[s-1].event[o-1].metaType,e,t)),null!==this.customInterpreter&&!1!==n.track[s-1].event[o-1].data||(e.readInt(t),n.track[s-1].event[o-1].data=e.readInt(t),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch(i=i.toString(16).split(""),i[1]||i.unshift("0"),n.track[s-1].event[o-1].type=parseInt(i[0],16),n.track[s-1].event[o-1].channel=parseInt(i[1],16),n.track[s-1].event[o-1].type){case 15:if(null!==this.customInterpreter&&(n.track[s-1].event[o-1].data=this.customInterpreter(n.track[s-1].event[o-1].type,e,!1)),null===this.customInterpreter||!1===n.track[s-1].event[o-1].data){let t=e.readIntVLV();n.track[s-1].event[o-1].data=e.readInt(t),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer")}break;case 10:case 11:case 14:case 8:case 9:n.track[s-1].event[o-1].data=[],n.track[s-1].event[o-1].data[0]=e.readInt(1),n.track[s-1].event[o-1].data[1]=e.readInt(1);break;case 12:case 13:n.track[s-1].event[o-1].data=e.readInt(1);break;case-1:a=!0;break;default:if(null!==this.customInterpreter&&(n.track[s-1].event[o-1].data=this.customInterpreter(n.track[s-1].event[o-1].metaType,e,!1)),null===this.customInterpreter||!1===n.track[s-1].event[o-1].data)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return n},customInterpreter:null};t.exports=e}()},1725:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(t,r){for(var s,o,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var l in s=Object(arguments[c]))n.call(s,l)&&(a[l]=s[l]);if(e){o=e(s);for(var u=0;u<o.length;u++)i.call(s,o[u])&&(a[o[u]]=s[o[u]])}}return a}},7744:function(t){var e;e=()=>(()=>{var t={6659:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,o){if("function"!==typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,o),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,i);break;case 4:u[l].fn.call(u[l].context,e,i,r);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==e||r&&!a[c].once||i&&a[c].context!==i)&&l.push(a[c]);l.length?this._events[s]=1===l.length?l[0]:l:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},62270:(t,e,n)=>{var i=n(82590);t.exports=function(t,e,n,r){for(var s=t[0],o=1;o<t.length;o++){var a=t[o];i(a,s,e,n,r),s=a}return t}},61148:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"angle",e,n,r,s)}},22015:t=>{t.exports=function(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];e.call(n,r)}return t}},31060:t=>{t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=n;i<t.length;i++){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},52367:t=>{t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=t.length-1;i>=n;i--){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},12673:(t,e,n)=>{var i=n(40327),r=n(84093),s=n(72632),o=n(72283),a=new(n(71030))({sys:{queueDepthSort:o,events:{once:o}}},0,0,1,1).setOrigin(0,0);t.exports=function(t,e){void 0===e&&(e={});var n=e.hasOwnProperty("width"),o=e.hasOwnProperty("height"),c=s(e,"width",-1),l=s(e,"height",-1),u=s(e,"cellWidth",1),h=s(e,"cellHeight",u),d=s(e,"position",r.TOP_LEFT),p=s(e,"x",0),f=s(e,"y",0),m=0,g=0,v=c*u,y=l*h;a.setPosition(p,f),a.setSize(u,h);for(var x=0;x<t.length;x++)if(i(t[x],a,d),n&&-1===c)a.x+=u;else if(o&&-1===l)a.y+=h;else if(o&&!n){if(g+=h,a.y+=h,g===y&&(g=0,m+=u,a.y=f,a.x+=u,m===v))break}else if(m+=u,a.x+=u,m===v&&(m=0,g+=h,a.x=p,a.y+=h,g===y))break;return t}},691:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},3877:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},71020:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},28970:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},82249:t=>{t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=e.x,a=e.y,c=e.radius,l=0;l<t.length;l++)t[l].x=o+c*Math.cos(r),t[l].y=a+c*Math.sin(r),r+=s;return t}},30285:t=>{t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=e.width/2,a=e.height/2,c=0;c<t.length;c++)t[c].x=e.x+o*Math.cos(r),t[c].y=e.y+a*Math.sin(r),r+=s;return t}},61557:(t,e,n)=>{var i=n(8570);t.exports=function(t,e){for(var n=i(e,t.length),r=0;r<t.length;r++){var s=t[r],o=n[r];s.x=o.x,s.y=o.y}return t}},63549:(t,e,n)=>{var i=n(40053),r=n(77640),s=n(38487);t.exports=function(t,e,n){void 0===n&&(n=0);var o=i(e,!1,t.length);n>0?r(o,n):n<0&&s(o,Math.abs(n));for(var a=0;a<t.length;a++)t[a].x=o[a].x,t[a].y=o[a].y;return t}},51629:(t,e,n)=>{var i=n(58813);t.exports=function(t,e,n){var r=i({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},n),s=i({x1:e.x2,y1:e.y2,x2:e.x3,y2:e.y3},n),o=i({x1:e.x3,y1:e.y3,x2:e.x1,y2:e.y1},n);r.pop(),s.pop(),o.pop();for(var a=(r=r.concat(s,o)).length/t.length,c=0,l=0;l<t.length;l++){var u=t[l],h=r[Math.floor(c)];u.x=h.x,u.y=h.y,c+=a}return t}},1045:t=>{t.exports=function(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];r.anims&&r.anims.play(e,n)}return t}},6124:t=>{t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,c=t.length;if(1===s)for(o=r;o<c;o++)t[o][e]+=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]+=n+a*i,a++;return t}},23646:t=>{t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,c=t.length;if(1===s)for(o=r;o<c;o++)t[o][e]=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]=n+a*i,a++;return t}},4392:(t,e,n)=>{var i=n(30977);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},94985:(t,e,n)=>{var i=n(72006);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},63305:(t,e,n)=>{var i=n(74077);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},90739:(t,e,n)=>{var i=n(30001);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},91417:(t,e,n)=>{var i=n(99761);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},26182:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},87299:(t,e,n)=>{var i=n(72395),r=n(53996);t.exports=function(t,e,n){for(var s=e.x,o=e.y,a=0;a<t.length;a++){var c=t[a];i(c,s,o,n,Math.max(1,r(c.x,c.y,s,o)))}return t}},92194:(t,e,n)=>{var i=n(72395);t.exports=function(t,e,n,r){var s=e.x,o=e.y;if(0===r)return t;for(var a=0;a<t.length;a++)i(t[a],s,o,n,r);return t}},30363:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},51449:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},64895:(t,e,n)=>{var i=n(6124);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},30329:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},43954:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r){return i(t,"blendMode",e,0,n,r)}},70688:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"depth",e,n,r,s)}},8314:t=>{t.exports=function(t,e,n){for(var i=0;i<t.length;i++)t[i].setInteractive(e,n);return t}},12894:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"originX",e,r,o,a),i(t,"originY",n,s,o,a),t.forEach((function(t){t.updateDisplayOrigin()})),t}},38767:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},18584:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},17381:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},74370:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},27773:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"scrollFactorX",e,r,o,a),i(t,"scrollFactorY",n,s,o,a)}},75257:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"scrollFactorX",e,n,r,s)}},54512:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"scrollFactorY",e,n,r,s)}},69423:t=>{t.exports=function(t,e,n,i,r){for(var s=0;s<t.length;s++)t[s].setTint(e,n,i,r);return t}},58291:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r){return i(t,"visible",e,0,n,r)}},94833:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},14284:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s,o,a){return void 0!==n&&null!==n||(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},96574:(t,e,n)=>{var i=n(23646);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},74086:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s){var o,a;void 0===r&&(r=0),void 0===s&&(s=new i);var c=t.length;if(1===c)o=t[0].x,a=t[0].y,t[0].x=e,t[0].y=n;else{var l=1,u=0;0===r&&(u=c-1,l=c-2),o=t[u].x,a=t[u].y,t[u].x=e,t[u].y=n;for(var h=0;h<c;h++)if(!(l>=c||-1===l)){var d=t[l],p=d.x,f=d.y;d.x=o,d.y=a,o=p,a=f,0===r?l--:l++}}return s.x=o,s.y=a,s}},86347:(t,e,n)=>{var i=n(18592);t.exports=function(t){return i(t)}},1558:(t,e,n)=>{var i=n(5514);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},9938:(t,e,n)=>{var i=n(87736);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},71060:t=>{t.exports=function(t,e,n,i,r){if(void 0===r&&(r=!1),0===t.length)return t;if(1===t.length)return r?t[0][e]+=(i+n)/2:t[0][e]=(i+n)/2,t;var s,o=Math.abs(i-n)/(t.length-1);if(r)for(s=0;s<t.length;s++)t[s][e]+=s*o+n;else for(s=0;s<t.length;s++)t[s][e]=s*o+n;return t}},11207:t=>{t.exports=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}},24404:(t,e,n)=>{var i=n(1071);t.exports=function(t,e,n){void 0===n&&(n=0);for(var r=0;r<t.length;r++){var s=t[r];s.x=i(s.x,e.left-n,e.right+n),s.y=i(s.y,e.top-n,e.bottom+n)}return t}},83979:(t,e,n)=>{t.exports={AlignTo:n(62270),Angle:n(61148),Call:n(22015),GetFirst:n(31060),GetLast:n(52367),GridAlign:n(12673),IncAlpha:n(691),IncX:n(3877),IncXY:n(71020),IncY:n(28970),PlaceOnCircle:n(82249),PlaceOnEllipse:n(30285),PlaceOnLine:n(61557),PlaceOnRectangle:n(63549),PlaceOnTriangle:n(51629),PlayAnimation:n(1045),PropertyValueInc:n(6124),PropertyValueSet:n(23646),RandomCircle:n(4392),RandomEllipse:n(94985),RandomLine:n(63305),RandomRectangle:n(90739),RandomTriangle:n(91417),Rotate:n(26182),RotateAround:n(87299),RotateAroundDistance:n(92194),ScaleX:n(30363),ScaleXY:n(51449),ScaleY:n(64895),SetAlpha:n(30329),SetBlendMode:n(43954),SetDepth:n(70688),SetHitArea:n(8314),SetOrigin:n(12894),SetRotation:n(38767),SetScale:n(18584),SetScaleX:n(17381),SetScaleY:n(74370),SetScrollFactor:n(27773),SetScrollFactorX:n(75257),SetScrollFactorY:n(54512),SetTint:n(69423),SetVisible:n(58291),SetX:n(94833),SetXY:n(14284),SetY:n(96574),ShiftPosition:n(74086),Shuffle:n(86347),SmootherStep:n(9938),SmoothStep:n(1558),Spread:n(71060),ToggleVisible:n(11207),WrapInRectangle:n(24404)}},85463:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(16938),o=n(2406),a=n(71519),c=n(10850),l=n(28834),u=new r({initialize:function(t,e,n){this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,c(n,"frames",[]),c(n,"defaultTextureKey",null),c(n,"sortFrames",!0)),this.frameRate=c(n,"frameRate",null),this.duration=c(n,"duration",null),this.msPerFrame,this.skipMissedFrames=c(n,"skipMissedFrames",!0),this.delay=c(n,"delay",0),this.repeat=c(n,"repeat",0),this.repeatDelay=c(n,"repeatDelay",0),this.yoyo=c(n,"yoyo",!1),this.showBeforeDelay=c(n,"showBeforeDelay",!1),this.showOnStart=c(n,"showOnStart",!1),this.hideOnComplete=c(n,"hideOnComplete",!1),this.randomFrame=c(n,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(s.PAUSE_ALL,this.pause,this),this.manager.on(s.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,n,i){null===n&&null===i?(t.frameRate=24,t.duration=24/e*1e3):n&&null===i?(t.duration=n,t.frameRate=e/(n/1e3)):(t.frameRate=i,t.duration=e/i*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var n=this.getFrames(this.manager.textureManager,e);if(n.length>0){if(0===t)this.frames=n.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(n);else{var i=this.frames.slice(0,t),r=this.frames.slice(t);this.frames=i.concat(n,r)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.msPerFrame+t.currentFrame.duration},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,n,i){void 0===i&&(i=!0);var r,s,o,u,h=[],d=1;if("string"===typeof e){if(u=e,!t.exists(u))return console.warn('Texture "%s" not found',u),h;var p=t.get(u).getFrameNames();i&&l(p),e=[],p.forEach((function(t){e.push({key:u,frame:t})}))}if(!Array.isArray(e)||0===e.length)return h;for(o=0;o<e.length;o++){var f=e[o],m=c(f,"key",n);if(m){var g=c(f,"frame",0),v=t.getFrame(m,g);v?((s=new a(m,g,d,v)).duration=c(f,"duration",0),s.isFirst=!r,r&&(r.nextFrame=s,s.prevFrame=r),h.push(s),r=s,d++):console.warn('Texture "%s" not found',m)}}if(h.length>0){s.isLast=!0,s.nextFrame=h[0],h[0].prevFrame=s;var y=1/(h.length-1);for(o=0;o<h.length;o++)h[o].progress=o*y}return h},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.msPerFrame+t.currentFrame.duration},getFrameByProgress:function(t){return t=i(t,0,1),o(t,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0)return(0===t.repeatDelay||t.pendingRepeat)&&(t.forward=e),void this.repeatAnimation(t);if(t.inReverse===e||0!==t.repeatCounter){t.forward=e;var n=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,n)}else t.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?(t.inReverse&&!t.forward||(t.forward=!0),this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop){if(0===t._pendingStopValue)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach((function(e){t.frames.push(e.toJSON())})),t},updateFrameSequence:function(){for(var t,e=this.frames.length,n=1/(e-1),i=0;i<e;i++)(t=this.frames[i]).index=i+1,t.isFirst=!1,t.isLast=!1,t.progress=i*n,0===i?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[i+1])):i===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[i-1],t.nextFrame=this.frames[i+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(s.PAUSE_ALL,this.pause,this),this.manager.off(s.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});t.exports=u},71519:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i,r){void 0===r&&(r=!1),this.textureKey=t,this.textureFrame=e,this.index=n,this.frame=i,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=r},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});t.exports=i},90249:(t,e,n)=>{var i=n(85463),r=n(56694),s=n(33885),o=n(6659),a=n(16938),c=n(97081),l=n(72632),u=n(10850),h=n(83392),d=n(13401),p=n(76400),f=new r({Extends:o,initialize:function(t){o.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new s,this.mixes=new s,this.paused=!1,this.name="AnimationManager",t.events.once(c.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(c.DESTROY,this.destroy,this)},addMix:function(t,e,n){var i=this.anims,r=this.mixes,s="string"===typeof t?t:t.key,o="string"===typeof e?e:e.key;if(i.has(s)&&i.has(o)){var a=r.get(s);a||(a={}),a[o]=n,r.set(s,a)}return this},removeMix:function(t,e){var n=this.mixes,i="string"===typeof t?t:t.key,r=n.get(i);if(r)if(e){var s="string"===typeof e?e:e.key;r.hasOwnProperty(s)&&delete r[s]}else e||n.delete(i);return this},getMix:function(t,e){var n=this.mixes,i="string"===typeof t?t:t.key,r="string"===typeof e?e:e.key,s=n.get(i);return s&&s.hasOwnProperty(r)?s[r]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(a.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e,n){var i=[],r=this.game.cache.json.get(t);if(!r)return console.warn("No Aseprite data found for: "+t),i;var s=this,o=u(r,"meta",null),a=u(r,"frames",null);return o&&a&&u(o,"frameTags",[]).forEach((function(r){var o=[],c=l(r,"name",null),u=l(r,"from",0),d=l(r,"to",0),p=l(r,"direction","forward");if(c&&(!e||e&&e.indexOf(c)>-1)){for(var f=0,m=u;m<=d;m++){var g=m.toString(),v=a[g];if(v){var y=l(v,"duration",h.MAX_SAFE_INTEGER);o.push({key:t,frame:g,duration:y}),f+=y}}var x=f/o.length;o.forEach((function(t){t.duration-=x})),"reverse"===p&&(o=o.reverse());var b,w={key:c,frames:o,duration:f,yoyo:"pingpong"===p};n?n.anims&&(b=n.anims.create(w)):b=s.create(w),b&&i.push(b)}})),i},create:function(t){var e=t.key,n=!1;return e&&((n=this.get(e))?console.warn("AnimationManager key already exists: "+e):(n=new i(this,e,t),this.anims.set(e,n),this.emit(a.ADD_ANIMATION,e,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"===typeof t&&(t=JSON.parse(t));var n=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var i=0;i<t.anims.length;i++)n.push(this.create(t.anims[i]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&n.push(this.create(t));return n},generateFrameNames:function(t,e){var n=u(e,"prefix",""),i=u(e,"start",0),r=u(e,"end",0),s=u(e,"suffix",""),o=u(e,"zeroPad",0),a=u(e,"outputArray",[]),c=u(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),a;var l,h=this.textureManager.get(t);if(!h)return a;if(e)for(c||(c=d(i,r)),l=0;l<c.length;l++){var f=n+p(c[l],o,"0",1)+s;h.has(f)?a.push({key:t,frame:f}):console.warn('Frame "%s" not found in texture "%s"',f,t)}else for(c=h.getFrameNames(),l=0;l<c.length;l++)a.push({key:t,frame:c[l]});return a},generateFrameNumbers:function(t,e){var n=u(e,"start",0),i=u(e,"end",-1),r=u(e,"first",!1),s=u(e,"outputArray",[]),o=u(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),s;var a=this.textureManager.get(t);if(!a)return s;r&&a.has(r)&&s.push({key:t,frame:r}),o||(-1===i&&(i=a.frameTotal-2),o=d(n,i));for(var c=0;c<o.length;c++){var l=o[c];a.has(l)?s.push({key:t,frame:l}):console.warn('Frame "%s" not found in texture "%s"',l,t)}return s},get:function(t){return this.anims.get(t)},getAnimsFromTexture:function(t){for(var e=this.textureManager.get(t).key,n=this.anims.getArray(),i=[],r=0;r<n.length;r++)for(var s=n[r],o=s.frames,a=0;a<o.length;a++)if(o[a].textureKey===e){i.push(s.key);break}return i},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(a.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)e[n].anims.play(t);return this},staggerPlay:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!0),Array.isArray(e)||(e=[e]);var r=e.length;i||r--;for(var s=0;s<e.length;s++){var o=n<0?Math.abs(n)*(r-s):n*s;e[s].anims.playAfterDelay(t,o)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(a.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(a.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==t&&""!==t?e.anims.push(this.anims.get(t).toJSON()):this.anims.each((function(t,n){e.anims.push(n.toJSON())})),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});t.exports=f},16569:(t,e,n)=>{var i=n(85463),r=n(17489),s=n(56694),o=n(33885),a=n(16938),c=n(72632),l=new s({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.on(a.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(void 0===t)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];this.nextAnim?this.nextAnimsQueue.push(i):this.nextAnim=i}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var e=this.animationManager,n="string"===typeof t?t:c(t,"key",null),i=this.exists(n)?this.get(n):e.get(n);if(i){this.currentAnim=i;var s=i.getTotalFrames(),o=c(t,"frameRate",i.frameRate),a=c(t,"duration",i.duration);i.calculateDuration(this,s,a,o),this.delay=c(t,"delay",i.delay),this.repeat=c(t,"repeat",i.repeat),this.repeatDelay=c(t,"repeatDelay",i.repeatDelay),this.yoyo=c(t,"yoyo",i.yoyo),this.showBeforeDelay=c(t,"showBeforeDelay",i.showBeforeDelay),this.showOnStart=c(t,"showOnStart",i.showOnStart),this.hideOnComplete=c(t,"hideOnComplete",i.hideOnComplete),this.skipMissedFrames=c(t,"skipMissedFrames",i.skipMissedFrames),this.randomFrame=c(t,"randomFrame",i.randomFrame),this.timeScale=c(t,"timeScale",this.timeScale);var l=c(t,"startFrame",0);l>s&&(l=0),this.randomFrame&&(l=r(0,s-1));var u=i.frames[l];0!==l||this.forward||(u=i.getLastFrame()),this.currentFrame=u}else console.warn("Missing animation: "+n);return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(this.isPlaying){var n=this.nextAnim,i=this.nextAnimsQueue;n&&i.unshift(n),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}else this.delayCounter=e,this.play(t,!0);return this.parent},playAfterRepeat:function(t,e){if(void 0===e&&(e=1),this.isPlaying){var n=this.nextAnim,i=this.nextAnimsQueue;n&&i.unshift(n),-1!==this.repeatCounter&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}else this.play(t);return this.parent},play:function(t,e){void 0===e&&(e=!1);var n=this.currentAnim,i=this.parent,r="string"===typeof t?t:t.key;if(e&&this.isPlaying&&n.key===r)return i;if(n&&this.isPlaying){var s=this.animationManager.getMix(n.key,t);if(s>0)return this.playAfterDelay(t,s)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){void 0===e&&(e=!1);var n="string"===typeof t?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===n?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,n=this.parent;return e?(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame),n):n},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(a.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(a.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(a.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(a.ANIMATION_COMPLETE,a.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var n=this.currentAnim;if(n){var i=this.currentFrame,r=this.parent,s=i.textureFrame;r.emit(t,n,i,r,s),e&&r.emit(e+n.key,n,i,r,s)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var n=this.currentAnim,i=this.parent;return n?(e&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),n.getFirstTick(this),this.emitEvents(a.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(n.frames[0]),this.parent):i},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return void 0===t&&(t=1),-1!==this.repeatCounter&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var n=this.currentAnim;if(this.isPlaying&&n&&!n.paused){if(this.accumulator+=e*this.timeScale*this.animationManager.globalTimeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?n.nextFrame(this):n.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var i=0;do{this.forward?n.nextFrame(this):n.previousFrame(this),i++}while(this.isPlaying&&this.accumulator>this.nextTick&&i<60)}}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(a.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return!!this.anims&&this.anims.has(t)},create:function(t){var e=t.key,n=!1;return e&&((n=this.get(e))?console.warn("Animation key already exists: "+e):(n=new i(this,e,t),this.anims||(this.anims=new o),this.anims.set(e,n))),n},createFromAseprite:function(t,e){return this.animationManager.createFromAseprite(t,e,this.parent)},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(a.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});t.exports=l},44509:t=>{t.exports="add"},84563:t=>{t.exports="animationcomplete"},61586:t=>{t.exports="animationcomplete-"},72175:t=>{t.exports="animationrepeat"},568:t=>{t.exports="animationrestart"},37690:t=>{t.exports="animationstart"},58525:t=>{t.exports="animationstop"},5243:t=>{t.exports="animationupdate"},10598:t=>{t.exports="pauseall"},4860:t=>{t.exports="remove"},31865:t=>{t.exports="resumeall"},16938:(t,e,n)=>{t.exports={ADD_ANIMATION:n(44509),ANIMATION_COMPLETE:n(84563),ANIMATION_COMPLETE_KEY:n(61586),ANIMATION_REPEAT:n(72175),ANIMATION_RESTART:n(568),ANIMATION_START:n(37690),ANIMATION_STOP:n(58525),ANIMATION_UPDATE:n(5243),PAUSE_ALL:n(10598),REMOVE_ANIMATION:n(4860),RESUME_ALL:n(31865)}},13517:(t,e,n)=>{t.exports={Animation:n(85463),AnimationFrame:n(71519),AnimationManager:n(90249),AnimationState:n(16569),Events:n(16938)}},23740:(t,e,n)=>{var i=n(56694),r=n(33885),s=n(6659),o=n(69773),a=new i({initialize:function(){this.entries=new r,this.events=new s},add:function(t,e){return this.entries.set(t,e),this.events.emit(o.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(o.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});t.exports=a},43474:(t,e,n)=>{var i=n(23740),r=n(56694),s=n(97081),o=new r({initialize:function(t){this.game=t,this.binary=new i,this.bitmapFont=new i,this.json=new i,this.physics=new i,this.shader=new i,this.audio=new i,this.video=new i,this.text=new i,this.html=new i,this.obj=new i,this.tilemap=new i,this.xml=new i,this.custom={},this.game.events.once(s.DESTROY,this.destroy,this)},addCustom:function(t){return this.custom.hasOwnProperty(t)||(this.custom[t]=new i),this.custom[t]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var n in this.custom)this.custom[n].destroy();this.custom=null,this.game=null}});t.exports=o},94762:t=>{t.exports="add"},75968:t=>{t.exports="remove"},69773:(t,e,n)=>{t.exports={ADD:n(94762),REMOVE:n(75968)}},45820:(t,e,n)=>{t.exports={BaseCache:n(23740),CacheManager:n(43474),Events:n(69773)}},51052:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(75606),o=n(6659),a=n(89787),c=n(74118),l=n(69360),u=n(93222),h=n(93736),d=new i({Extends:o,Mixins:[r.AlphaSingle,r.Visible],initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),o.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new c,this.dirty=!0,this._x=t,this._y=e,this._width=n,this._height=i,this._bounds=new c,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new l,this.transparent=!0,this.backgroundColor=u("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new h(n/2,i/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,n){void 0===n&&(n=new h);var i=.5*this.width,r=.5*this.height;return n.x=t-i,n.y=e-r,this.useBounds&&(n.x=this.clampX(n.x),n.y=this.clampY(n.y)),n},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,n=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-n}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(!o)return t;var a=e[4],c=e[5],l=this.scrollX,u=this.scrollY,h=this.width,d=this.height,p=this.y,f=p+d,m=this.x,g=m+h,v=this.culledObjects,y=t.length;o=1/o,v.length=0;for(var x=0;x<y;++x){var b=t[x];if(b.hasOwnProperty("width")&&!b.parentContainer){var w=b.width,S=b.height,_=b.x-l*b.scrollFactorX-w*b.originX,T=b.y-u*b.scrollFactorY-S*b.originY;(_+w)*n+(T+S)*r+a>m&&_*n+T*r+a<g&&(_+w)*i+(T+S)*s+c>p&&_*i+T*s+c<f&&v.push(b)}else v.push(b)}return v},getWorldPoint:function(t,e,n){void 0===n&&(n=new h);var i=this.matrix.matrix,r=i[0],s=i[1],o=i[2],a=i[3],c=i[4],l=i[5],u=r*a-s*o;if(!u)return n.x=t,n.y=e,n;var d=a*(u=1/u),p=-s*u,f=-o*u,m=r*u,g=(o*l-a*c)*u,v=(s*c-r*l)*u,y=Math.cos(this.rotation),x=Math.sin(this.rotation),b=this.zoomX,w=this.zoomY,S=this.scrollX,_=this.scrollY,T=t+(S*y-_*x)*b,E=e+(S*x+_*y)*w;return n.x=T*d+E*f+g,n.y=T*p+E*m+v,n},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?this.ignore(i):i.isParent?this.ignore(i.getChildren()):i.cameraFilter|=e}return this},preRender:function(){this.renderList.length=0;var t=this.width,e=this.height,n=.5*t,i=.5*e,r=this.zoomX,s=this.zoomY,o=this.matrix,a=t*this.originX,c=e*this.originY,l=this.scrollX,u=this.scrollY;this.useBounds&&(l=this.clampX(l),u=this.clampY(u)),this.scrollX=l,this.scrollY=u;var h=l+n,d=u+i;this.midPoint.set(h,d);var p=t/r,f=e/s;this.worldView.setTo(h-p/2,d-f/2,p,f),o.applyITRS(this.x+a,this.y+c,this.rotation,r,s),o.translate(-a,-c)},clampX:function(t){var e=this._bounds,n=this.displayWidth,i=e.x+(n-this.width)/2,r=Math.max(i,i+e.width-n);return t<i?t=i:t>r&&(t=r),t},clampY:function(t){var e=this._bounds,n=this.displayHeight,i=e.y+(n-this.height)/2,r=Math.max(i,i+e.height-n);return t<i?t=i:t>r&&(t=r),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=s(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=u(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,n,i,r){return void 0===r&&(r=!1),this._bounds.setTo(t,e,n,i),this.dirty=!0,this.useBounds=!0,r?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new c);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t,e){void 0===e&&(e=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t,this.isSceneCamera=e;var n=t.sys;return this.sceneManager=n.game.scene,this.scaleManager=n.scale,this.cameraManager=n.cameras,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setZoom:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),0===t&&(t=.001),0===e&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},setIsSceneCamera:function(t){return this.isSceneCamera=t,this},updateSystem:function(){if(this.scaleManager&&this.isSceneCamera){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(a.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){t!==this._scrollX&&(this._scrollX=t,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(t){t!==this._scrollY&&(this._scrollY=t,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});t.exports=d},47751:(t,e,n)=>{var i=n(51052),r=n(79993),s=n(82897),o=n(56694),a=n(64937),c=n(53030),l=n(89787),u=n(42798),h=n(74118),d=n(93736),p=new o({Extends:i,Mixins:[a.PostPipeline],initialize:function(t,e,n,r){i.call(this,t,e,n,r),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new c.Fade(this),this.flashEffect=new c.Flash(this),this.shakeEffect=new c.Shake(this),this.panEffect=new c.Pan(this),this.rotateToEffect=new c.RotateTo(this),this.zoomEffect=new c.Zoom(this),this.lerp=new d(1,1),this.followOffset=new d,this.deadzone=null,this._follow=null},setDeadzone:function(t,e){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=e):this.deadzone=new h(0,0,t,e),this._follow){var n=this.width/2,i=this.height/2,s=this._follow.x-this.followOffset.x,o=this._follow.y-this.followOffset.y;this.midPoint.set(s,o),this.scrollX=s-n,this.scrollY=o-i}r(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,n,i,r,s){return this.fadeEffect.start(!1,t,e,n,i,!0,r,s)},fadeOut:function(t,e,n,i,r,s){return this.fadeEffect.start(!0,t,e,n,i,!0,r,s)},fadeFrom:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!1,t,e,n,i,r,s,o)},fade:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!0,t,e,n,i,r,s,o)},flash:function(t,e,n,i,r,s,o){return this.flashEffect.start(t,e,n,i,r,s,o)},shake:function(t,e,n,i,r){return this.shakeEffect.start(t,e,n,i,r)},pan:function(t,e,n,i,r,s,o){return this.panEffect.start(t,e,n,i,r,s,o)},rotateTo:function(t,e,n,i,r,s,o){return this.rotateToEffect.start(t,e,n,i,r,s,o)},zoomTo:function(t,e,n,i,r,s){return this.zoomEffect.start(t,e,n,i,r,s)},preRender:function(){this.renderList.length=0;var t=this.width,e=this.height,n=.5*t,i=.5*e,s=this.zoom,o=this.matrix,a=t*this.originX,c=e*this.originY,h=this._follow,d=this.deadzone,p=this.scrollX,f=this.scrollY;d&&r(d,this.midPoint.x,this.midPoint.y);var m=!1;if(h&&!this.panEffect.isRunning){var g=this.lerp,v=h.x-this.followOffset.x,y=h.y-this.followOffset.y;d?(v<d.x?p=u(p,p-(d.x-v),g.x):v>d.right&&(p=u(p,p+(v-d.right),g.x)),y<d.y?f=u(f,f-(d.y-y),g.y):y>d.bottom&&(f=u(f,f+(y-d.bottom),g.y))):(p=u(p,v-a,g.x),f=u(f,y-c,g.y)),m=!0}this.useBounds&&(p=this.clampX(p),f=this.clampY(f)),this.scrollX=p,this.scrollY=f;var x=p+n,b=f+i;this.midPoint.set(x,b);var w=t/s,S=e/s,_=Math.floor(x-w/2),T=Math.floor(b-S/2);this.worldView.setTo(_,T,w,S),o.applyITRS(Math.floor(this.x+a),Math.floor(this.y+c),this.rotation,s,s),o.translate(-a,-c),this.shakeEffect.preRender(),m&&this.emit(l.FOLLOW_UPDATE,this,h)},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,i,r,o){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===i&&(i=n),void 0===r&&(r=0),void 0===o&&(o=r),this._follow=t,this.roundPixels=e,n=s(n,0,1),i=s(i,0,1),this.lerp.set(n,i),this.followOffset.set(r,o);var a=this.width/2,c=this.height/2,l=t.x-r,u=t.y-o;return this.midPoint.set(l,u),this.scrollX=l-a,this.scrollY=u-c,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.rotateToEffect.update(t,e),this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.resetFX(),i.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});t.exports=p},62382:(t,e,n)=>{var i=n(47751),r=n(56694),s=n(72632),o=n(91963),a=n(94287),c=n(40444),l=n(7599),u=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,t.sys.events.once(l.BOOT,this.boot,this),t.sys.events.on(l.START,this.start,this)},boot:function(){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new i(0,0,t.scale.width,t.scale.height).setScene(this.scene),t.game.scale.on(c.RESIZE,this.onResize,this),this.systems.events.once(l.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(l.UPDATE,this.update,this),e.once(l.SHUTDOWN,this.shutdown,this)},add:function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===r&&(r=this.scene.sys.scale.height),void 0===s&&(s=!1),void 0===o&&(o="");var a=new i(t,e,n,r);return a.setName(o),a.setScene(this.scene),a.setRoundPixels(this.roundPixels),a.id=this.getNextID(),this.cameras.push(a),s&&(this.main=a),a},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,n=0;n<32;n++){for(var i=!1,r=0;r<t.length;r++){var s=t[r];s&&s.id===e&&(i=!0)}if(!i)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,n=this.cameras,i=0;i<n.length;i++){var r=n[i];(!t||t&&r.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,i=0;i<t.length;i++){var r=t[i],o=s(r,"x",0),a=s(r,"y",0),c=s(r,"width",e),l=s(r,"height",n),u=this.add(o,a,c,l);u.name=s(r,"name",""),u.zoom=s(r,"zoom",1),u.rotation=s(r,"rotation",0),u.scrollX=s(r,"scrollX",0),u.scrollY=s(r,"scrollY",0),u.roundPixels=s(r,"roundPixels",!1),u.visible=s(r,"visible",!0);var h=s(r,"backgroundColor",!1);h&&u.setBackgroundColor(h);var d=s(r,"bounds",null);if(d){var p=s(d,"x",0),f=s(d,"y",0),m=s(d,"width",e),g=s(d,"height",n);u.setBounds(p,f,m,g)}}return this},getCamera:function(t){for(var e=this.cameras,n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,n=t.x,i=t.y,r=[],s=0;s<e.length;s++){var o=e[s];o.visible&&o.inputEnabled&&a(o,n,i)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0,i=this.cameras,r=0;r<t.length;r++){var s=i.indexOf(t[r]);-1!==s&&(e?i[s].destroy():i[s].renderList=[],i.splice(s,1),n++)}return!this.main&&i[0]&&(this.main=i[0]),n},render:function(t,e){for(var n=this.scene,i=this.cameras,r=0;r<i.length;r++){var s=i[r];if(s.visible&&s.alpha>0){s.preRender();var o=this.getVisibleChildren(e.getChildren(),s);t.render(n,o,s)}}},getVisibleChildren:function(t,e){return t.filter((function(t){return t.willRender(e)}))},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].update(t,e)},onResize:function(t,e,n,i,r){for(var s=0;s<this.cameras.length;s++){var o=this.cameras[s];0===o._x&&0===o._y&&o._width===i&&o._height===r&&o.setSize(e.width,e.height)}},resize:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(l.UPDATE,this.update,this),e.off(l.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(l.START,this.start,this),this.systems.events.off(l.DESTROY,this.destroy,this),this.systems.game.scale.off(c.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});o.register("CameraManager",u,"cameras"),t.exports=u},92522:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(89787),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,o,a,c){if(void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===c&&(c=this.camera.scene),!o&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=i,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=c;var l=t?s.FADE_OUT_START:s.FADE_IN_START;return this.camera.emit(l,this.camera,this,e,n,i,r),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var n=this.camera,i=this.red/255,r=this.green/255,s=this.blue/255;return t.drawFillRect(n.x,n.y,n.width,n.height,e(s,r,i,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?s.FADE_OUT_COMPLETE:s.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},22151:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(89787),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,o,a){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===i&&(i=255),void 0===r&&(r=!1),void 0===o&&(o=null),void 0===a&&(a=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=i,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=a,this.camera.emit(s.FLASH_START,this.camera,this,t,e,n,i)),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var n=this.camera,i=this.red/255,r=this.green/255,s=this.blue/255;return t.drawFillRect(n.x,n.y,n.width,n.height,e(s,r,i,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},37551:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(35060),o=n(89787),a=n(93736),c=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new a,this.current=new a,this.destination=new a,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,a,c){void 0===n&&(n=1e3),void 0===i&&(i=s.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===c&&(c=this.camera.scene);var l=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=n,this.progress=0,this.source.set(l.scrollX,l.scrollY),this.destination.set(t,e),l.getScroll(t,e,this.current),"string"===typeof i&&s.hasOwnProperty(i)?this.ease=s[i]:"function"===typeof i&&(this.ease=i),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=c,this.camera.emit(o.PAN_START,this.camera,this,n,t,e)),l},update:function(t,e){if(this.isRunning){this._elapsed+=e;var n=i(this._elapsed/this.duration,0,1);this.progress=n;var r=this.camera;if(this._elapsed<this.duration){var s=this.ease(n);r.getScroll(this.destination.x,this.destination.y,this.current);var o=this.source.x+(this.current.x-this.source.x)*s,a=this.source.y+(this.current.y-this.source.y)*s;r.setScroll(o,a),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,o,a)}else r.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,r.scrollX,r.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=c},1771:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(89787),o=n(35060),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,n,i,r,a,c){void 0===n&&(n=1e3),void 0===i&&(i=o.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===c&&(c=this.camera.scene),void 0===e&&(e=!1),this.shortestPath=e;var l=t;t<0?(l=-1*t,this.clockwise=!1):this.clockwise=!0;var u=360*Math.PI/180;l-=Math.floor(l/u)*u;var h=this.camera;if(!r&&this.isRunning)return h;if(this.isRunning=!0,this.duration=n,this.progress=0,this.source=h.rotation,this.destination=l,"string"===typeof i&&o.hasOwnProperty(i)?this.ease=o[i]:"function"===typeof i&&(this.ease=i),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=c,this.shortestPath){var d=0,p=0;(d=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+u)-this.source)<(p=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+u)-this.destination)?this.clockwise=!0:d>p&&(this.clockwise=!1)}return this.camera.emit(s.ROTATE_START,this.camera,this,n,l),h},update:function(t,e){if(this.isRunning){this._elapsed+=e;var n=i(this._elapsed/this.duration,0,1);this.progress=n;var r=this.camera;if(this._elapsed<this.duration){var s=this.ease(n);this.current=r.rotation;var o=0,a=360*Math.PI/180,c=this.destination,l=this.current;!1===this.clockwise&&(c=this.current,l=this.destination),o=c>=l?Math.abs(c-l):Math.abs(c+a)-l;var u=0;u=this.clockwise?r.rotation+o*s:r.rotation-o*s,r.rotation=u,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,u)}else r.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=a},3241:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(89787),o=n(93736),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new o,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"===typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=i,this._onUpdateScope=r,this.camera.emit(s.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(t,e){if(this.isRunning)if(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,r=this.camera.width,s=this.camera.height,o=this.camera.zoom;this._offsetX=(Math.random()*n.x*r*2-n.x*r)*o,this._offsetY=(Math.random()*n.y*s*2-n.y*s)*o,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});t.exports=a},13383:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(35060),o=n(89787),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,i,r,a){void 0===e&&(e=1e3),void 0===n&&(n=s.Linear),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===a&&(a=this.camera.scene);var c=this.camera;return!i&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=c.zoom,this.destination=t,"string"===typeof n&&s.hasOwnProperty(n)?this.ease=s[n]:"function"===typeof n&&(this.ease=n),this._elapsed=0,this._onUpdate=r,this._onUpdateScope=a,this.camera.emit(o.ZOOM_START,this.camera,this,e,t)),c},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=a},53030:(t,e,n)=>{t.exports={Fade:n(92522),Flash:n(22151),Pan:n(37551),Shake:n(3241),RotateTo:n(1771),Zoom:n(13383)}},39577:t=>{t.exports="cameradestroy"},85373:t=>{t.exports="camerafadeincomplete"},92057:t=>{t.exports="camerafadeinstart"},1903:t=>{t.exports="camerafadeoutcomplete"},96131:t=>{t.exports="camerafadeoutstart"},85409:t=>{t.exports="cameraflashcomplete"},25500:t=>{t.exports="cameraflashstart"},44071:t=>{t.exports="followupdate"},19818:t=>{t.exports="camerapancomplete"},80002:t=>{t.exports="camerapanstart"},87966:t=>{t.exports="postrender"},74217:t=>{t.exports="prerender"},34805:t=>{t.exports="camerarotatecomplete"},30408:t=>{t.exports="camerarotatestart"},49856:t=>{t.exports="camerashakecomplete"},69189:t=>{t.exports="camerashakestart"},67657:t=>{t.exports="camerazoomcomplete"},14229:t=>{t.exports="camerazoomstart"},89787:(t,e,n)=>{t.exports={DESTROY:n(39577),FADE_IN_COMPLETE:n(85373),FADE_IN_START:n(92057),FADE_OUT_COMPLETE:n(1903),FADE_OUT_START:n(96131),FLASH_COMPLETE:n(85409),FLASH_START:n(25500),FOLLOW_UPDATE:n(44071),PAN_COMPLETE:n(19818),PAN_START:n(80002),POST_RENDER:n(87966),PRE_RENDER:n(74217),ROTATE_COMPLETE:n(34805),ROTATE_START:n(30408),SHAKE_COMPLETE:n(49856),SHAKE_START:n(69189),ZOOM_COMPLETE:n(67657),ZOOM_START:n(14229)}},32356:(t,e,n)=>{t.exports={Camera:n(47751),BaseCamera:n(51052),CameraManager:n(62382),Effects:n(53030),Events:n(89787)}},84219:(t,e,n)=>{var i=n(56694),r=n(10850),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.minZoom=r(t,"minZoom",.001),this.maxZoom=r(t,"maxZoom",1e3),this.speedX=0,this.speedY=0;var e=r(t,"speed",null);"number"===typeof e?(this.speedX=e,this.speedY=e):(this.speedX=r(t,"speed.x",0),this.speedY=r(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<this.minZoom&&(e.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed,e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},69370:(t,e,n)=>{var i=n(56694),r=n(10850),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.minZoom=r(t,"minZoom",.001),this.maxZoom=r(t,"maxZoom",1e3),this.accelX=0,this.accelY=0;var e=r(t,"acceleration",null);"number"===typeof e?(this.accelX=e,this.accelY=e):(this.accelX=r(t,"acceleration.x",0),this.accelY=r(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=r(t,"drag",null);"number"===typeof n?(this.dragX=n,this.dragY=n):(this.dragX=r(t,"drag.x",0),this.dragY=r(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var i=r(t,"maxSpeed",null);"number"===typeof i?(this.maxSpeedX=i,this.maxSpeedY=i):(this.maxSpeedX=r(t,"maxSpeed.x",0),this.maxSpeedY=r(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<this.minZoom?e.zoom=this.minZoom:e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},6524:(t,e,n)=>{t.exports={FixedKeyControl:n(84219),SmoothedKeyControl:n(69370)}},44143:(t,e,n)=>{t.exports={Controls:n(6524),Scene2D:n(32356)}},86459:(t,e,n)=>{var i={VERSION:"3.70.0",BlendModes:n(95723),ScaleModes:n(27394),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};t.exports=i},14033:(t,e,n)=>{var i=n(56694),r=n(86459),s=n(18360),o=n(77290),a=n(72632),c=n(10850),l=n(42911),u=n(72283),h=n(5923),d=n(65641),p=n(93222),f=new i({initialize:function(t){void 0===t&&(t={});var e=c(t,"scale",null);this.width=c(e,"width",1024,t),this.height=c(e,"height",768,t),this.zoom=c(e,"zoom",1,t),this.parent=c(e,"parent",void 0,t),this.scaleMode=c(e,e?"mode":"scaleMode",0,t),this.expandParent=c(e,"expandParent",!0,t),this.autoRound=c(e,"autoRound",!1,t),this.autoCenter=c(e,"autoCenter",0,t),this.resizeInterval=c(e,"resizeInterval",500,t),this.fullscreenTarget=c(e,"fullscreenTarget",null,t),this.minWidth=c(e,"min.width",0,t),this.maxWidth=c(e,"max.width",0,t),this.minHeight=c(e,"min.height",0,t),this.maxHeight=c(e,"max.height",0,t),this.renderType=c(t,"type",r.AUTO),this.canvas=c(t,"canvas",null),this.context=c(t,"context",null),this.canvasStyle=c(t,"canvasStyle",null),this.customEnvironment=c(t,"customEnvironment",!1),this.sceneConfig=c(t,"scene",null),this.seed=c(t,"seed",[(Date.now()*Math.random()).toString()]),h.RND=new h.RandomDataGenerator(this.seed),this.gameTitle=c(t,"title",""),this.gameURL=c(t,"url","https://phaser.io"),this.gameVersion=c(t,"version",""),this.autoFocus=c(t,"autoFocus",!0),this.stableSort=c(t,"stableSort",-1),-1===this.stableSort&&(this.stableSort=o.browser.es2019?1:0),o.features.stableSort=this.stableSort,this.domCreateContainer=c(t,"dom.createContainer",!1),this.domPointerEvents=c(t,"dom.pointerEvents","none"),this.inputKeyboard=c(t,"input.keyboard",!0),this.inputKeyboardEventTarget=c(t,"input.keyboard.target",window),this.inputKeyboardCapture=c(t,"input.keyboard.capture",[]),this.inputMouse=c(t,"input.mouse",!0),this.inputMouseEventTarget=c(t,"input.mouse.target",null),this.inputMousePreventDefaultDown=c(t,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=c(t,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=c(t,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=c(t,"input.mouse.preventDefaultWheel",!0),this.inputTouch=c(t,"input.touch",o.input.touch),this.inputTouchEventTarget=c(t,"input.touch.target",null),this.inputTouchCapture=c(t,"input.touch.capture",!0),this.inputActivePointers=c(t,"input.activePointers",1),this.inputSmoothFactor=c(t,"input.smoothFactor",0),this.inputWindowEvents=c(t,"input.windowEvents",!0),this.inputGamepad=c(t,"input.gamepad",!1),this.inputGamepadEventTarget=c(t,"input.gamepad.target",window),this.disableContextMenu=c(t,"disableContextMenu",!1),this.audio=c(t,"audio",{}),this.hideBanner=!1===c(t,"banner",null),this.hidePhaser=c(t,"banner.hidePhaser",!1),this.bannerTextColor=c(t,"banner.text","#ffffff"),this.bannerBackgroundColor=c(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),""===this.gameTitle&&this.hidePhaser&&(this.hideBanner=!0),this.fps=c(t,"fps",null),this.disablePreFX=c(t,"disablePreFX",!1),this.disablePostFX=c(t,"disablePostFX",!1);var n=c(t,"render",null);this.pipeline=c(n,"pipeline",null,t),this.autoMobilePipeline=c(n,"autoMobilePipeline",!0,t),this.defaultPipeline=c(n,"defaultPipeline",d.MULTI_PIPELINE,t),this.antialias=c(n,"antialias",!0,t),this.antialiasGL=c(n,"antialiasGL",!0,t),this.mipmapFilter=c(n,"mipmapFilter","",t),this.desynchronized=c(n,"desynchronized",!1,t),this.roundPixels=c(n,"roundPixels",!0,t),this.pixelArt=c(n,"pixelArt",1!==this.zoom,t),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=c(n,"transparent",!1,t),this.clearBeforeRender=c(n,"clearBeforeRender",!0,t),this.preserveDrawingBuffer=c(n,"preserveDrawingBuffer",!1,t),this.premultipliedAlpha=c(n,"premultipliedAlpha",!0,t),this.failIfMajorPerformanceCaveat=c(n,"failIfMajorPerformanceCaveat",!1,t),this.powerPreference=c(n,"powerPreference","default",t),this.batchSize=c(n,"batchSize",4096,t),this.maxTextures=c(n,"maxTextures",-1,t),this.maxLights=c(n,"maxLights",10,t);var i=c(t,"backgroundColor",0);this.backgroundColor=p(i),this.transparent&&(this.backgroundColor=p(0),this.backgroundColor.alpha=0),this.preBoot=c(t,"callbacks.preBoot",u),this.postBoot=c(t,"callbacks.postBoot",u),this.physics=c(t,"physics",{}),this.defaultPhysicsSystem=c(this.physics,"default",!1),this.loaderBaseURL=c(t,"loader.baseURL",""),this.loaderPath=c(t,"loader.path",""),this.loaderMaxParallelDownloads=c(t,"loader.maxParallelDownloads",o.os.android?6:32),this.loaderCrossOrigin=c(t,"loader.crossOrigin",void 0),this.loaderResponseType=c(t,"loader.responseType",""),this.loaderAsync=c(t,"loader.async",!0),this.loaderUser=c(t,"loader.user",""),this.loaderPassword=c(t,"loader.password",""),this.loaderTimeout=c(t,"loader.timeout",0),this.loaderWithCredentials=c(t,"loader.withCredentials",!1),this.loaderImageLoadType=c(t,"loader.imageLoadType","XHR"),this.loaderLocalScheme=c(t,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=c(t,"fx.glow.quality",.1),this.glowFXDistance=c(t,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var f=c(t,"plugins",null),m=s.DefaultScene;f&&(Array.isArray(f)?this.defaultPlugins=f:l(f)&&(this.installGlobalPlugins=a(f,"global",[]),this.installScenePlugins=a(f,"scene",[]),Array.isArray(f.default)?m=f.default:Array.isArray(f.defaultMerge)&&(m=m.concat(f.defaultMerge)))),this.defaultPlugins=m;var g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=c(t,"images.default",g+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=c(t,"images.missing",g+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=c(t,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=r.WEBGL:window.FORCE_CANVAS&&(this.renderType=r.CANVAS))}});t.exports=f},50150:(t,e,n)=>{var i=n(70616),r=n(61068),s=n(86459),o=n(90185);t.exports=function(t){var e=t.config;if((e.customEnvironment||e.canvas)&&e.renderType===s.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!e.customEnvironment&&!e.canvas&&e.renderType!==s.HEADLESS)if(e.renderType===s.AUTO&&(e.renderType=o.webGL?s.WEBGL:s.CANVAS),e.renderType===s.WEBGL){if(!o.webGL)throw new Error("Cannot create WebGL context, aborting.")}else{if(e.renderType!==s.CANVAS)throw new Error("Unknown value for renderer type: "+e.renderType);if(!o.canvas)throw new Error("Cannot create Canvas context, aborting.")}e.antialias||r.disableSmoothing();var a,c,l=t.scale.baseSize,u=l.width,h=l.height;e.canvas?(t.canvas=e.canvas,t.canvas.width=u,t.canvas.height=h):t.canvas=r.create(t,u,h,e.renderType),e.canvasStyle&&(t.canvas.style=e.canvasStyle),e.antialias||i.setCrisp(t.canvas),e.renderType!==s.HEADLESS&&(a=n(91135),c=n(11857),e.renderType===s.WEBGL?t.renderer=new c(t):(t.renderer=new a(t),t.context=t.renderer.gameContext))}},77291:(t,e,n)=>{var i=n(86459);t.exports=function(t){var e=t.config;if(!e.hideBanner){var n="WebGL";e.renderType===i.CANVAS?n="Canvas":e.renderType===i.HEADLESS&&(n="Headless");var r,s=e.audio,o=t.device.audio;if(r=o.webAudio&&!s.disableWebAudio?"Web Audio":s.noAudio||!o.webAudio&&!o.audioData?"No Audio":"HTML5 Audio",t.device.browser.ie)window.console&&console.log("Phaser v"+i.VERSION+" / https://phaser.io");else{var a,c="",l=[c];Array.isArray(e.bannerBackgroundColor)?(e.bannerBackgroundColor.forEach((function(t){c=c.concat("%c "),l.push("background: "+t),a=t})),l[l.length-1]="color: "+e.bannerTextColor+"; background: "+a):(c=c.concat("%c "),l.push("color: "+e.bannerTextColor+"; background: "+e.bannerBackgroundColor)),l.push("background: transparent"),e.gameTitle&&(c=c.concat(e.gameTitle),e.gameVersion&&(c=c.concat(" v"+e.gameVersion)),e.hidePhaser||(c=c.concat(" / "))),e.hidePhaser||(c=c.concat("Phaser v"+i.VERSION+" ("+n+" | "+r+")")),c=c.concat(" %c "+e.gameURL),l[0]=c,console.log.apply(console,l)}}}},15213:(t,e,n)=>{var i=n(99584),r=n(90249),s=n(43474),o=n(61068),a=n(56694),c=n(14033),l=n(85178),u=n(50150),h=n(81078),d=n(77291),p=n(77290),f=n(21546),m=n(6659),g=n(97081),v=n(69898),y=n(91963),x=n(49274),b=n(756),w=n(13553),S=n(38203),_=n(6237),T=n(26617),E=n(26493),C=n(84191),k=new a({initialize:function(t){this.config=new c(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new m,this.anims=new r(this),this.textures=new _(this),this.cache=new s(this),this.registry=new h(this,new m),this.input=new v(this,this.config),this.scene=new w(this,this.config.sceneConfig),this.device=p,this.scale=new b(this,this.config),this.sound=null,this.sound=C.create(this),this.loop=new T(this,this.config.fps),this.plugins=new x(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,f(this.boot.bind(this))},boot:function(){y.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),u(this),l(this),d(this),i(this.canvas,this.config.parent),this.textures.once(S.READY,this.texturesReady,this),this.events.emit(g.BOOT)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(g.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),E(this);var t=this.events;t.on(g.HIDDEN,this.onHidden,this),t.on(g.VISIBLE,this.onVisible,this),t.on(g.BLUR,this.onBlur,this),t.on(g.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e);var i=this.renderer;i.preRender(),n.emit(g.PRE_RENDER,i,t,e),this.scene.render(i),i.postRender(),n.emit(g.POST_RENDER,i,t,e)}},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e),this.scene.isProcessing=!1,n.emit(g.PRE_RENDER,null,t,e),n.emit(g.POST_RENDER,null,t,e)}},onHidden:function(){this.loop.pause(),this.events.emit(g.PAUSE)},pause:function(){var t=this.isPaused;this.isPaused=!0,t||this.events.emit(g.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(g.RESUME)},resume:function(){var t=this.isPaused;this.isPaused=!1,t&&this.events.emit(g.RESUME)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(g.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(o.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});t.exports=k},26617:(t,e,n)=>{var i=n(56694),r=n(10850),s=n(72283),o=n(27385),a=new i({initialize:function(t,e){this.game=t,this.raf=new o,this.started=!1,this.running=!1,this.minFps=r(e,"min",5),this.targetFps=r(e,"target",60),this.fpsLimit=r(e,"limit",0),this.hasFpsLimit=this.fpsLimit>0,this._limitRate=this.hasFpsLimit?1e3/this.fpsLimit:0,this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=s,this.forceSetTimeOut=r(e,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=r(e,"deltaHistory",10),this.panicMax=r(e,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=r(e,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.startTime+=this.time-this._pauseTime},resetDelta:function(){var t=window.performance.now();this.time=t,this.lastTime=t,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=Math.min(this._target,this.deltaHistory[e]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(t){if(this.started)return this;this.started=!0,this.running=!0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=t;var n=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(n,this.forceSetTimeOut,this._target)},smoothDelta:function(t){var e=this.deltaIndex,n=this.deltaHistory,i=this.deltaSmoothingMax;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,t=Math.min(t,this._target)),t>this._min&&(t=n[e],t=Math.min(t,this._min)),n[e]=t,this.deltaIndex++,this.deltaIndex>=i&&(this.deltaIndex=0);for(var r=0,s=0;s<i;s++)r+=n[s];return r/=i},updateFPS:function(t){this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0},stepLimitFPS:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta+=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.delta>=this._limitRate&&(this.callback(t,this.delta),this.delta=0),this.lastTime=t,this.frame++},step:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.callback(t,e),this.lastTime=t,this.frame++},tick:function(){var t=window.performance.now();this.hasFpsLimit?this.stepLimitFPS(t):this.step(t)},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(t){void 0===t&&(t=!1);var e=window.performance.now();if(!this.running){t&&(this.startTime+=-this.lastTime+(this.lastTime+e));var n=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(n,this.forceSetTimeOut,this._target),this.running=!0,this.nextFpsUpdate=e+1e3,this.framesThisSecond=0,this.fpsLimitTriggered=!1,this.tick()}},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.raf.destroy(),this.raf=null,this.game=null,this.callback=null}});t.exports=a},26493:(t,e,n)=>{var i=n(97081);t.exports=function(t){var e,n=t.events;void 0!==document.hidden?e="visibilitychange":["webkit","moz","ms"].forEach((function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},e=t+"visibilitychange")})),e&&document.addEventListener(e,(function(t){document.hidden||"pause"===t.type?n.emit(i.HIDDEN):n.emit(i.VISIBLE)}),!1),window.onblur=function(){n.emit(i.BLUR)},window.onfocus=function(){n.emit(i.FOCUS)},window.focus&&t.config.autoFocus&&window.focus()}},41651:t=>{t.exports="blur"},5520:t=>{t.exports="boot"},51673:t=>{t.exports="contextlost"},25055:t=>{t.exports="destroy"},23767:t=>{t.exports="focus"},57564:t=>{t.exports="hidden"},38327:t=>{t.exports="pause"},43807:t=>{t.exports="postrender"},73652:t=>{t.exports="poststep"},780:t=>{t.exports="prerender"},13781:t=>{t.exports="prestep"},38247:t=>{t.exports="ready"},29129:t=>{t.exports="resume"},34994:t=>{t.exports="step"},55237:t=>{t.exports="systemready"},98704:t=>{t.exports="visible"},97081:(t,e,n)=>{t.exports={BLUR:n(41651),BOOT:n(5520),CONTEXT_LOST:n(51673),DESTROY:n(25055),FOCUS:n(23767),HIDDEN:n(57564),PAUSE:n(38327),POST_RENDER:n(43807),POST_STEP:n(73652),PRE_RENDER:n(780),PRE_STEP:n(13781),READY:n(38247),RESUME:n(29129),STEP:n(34994),SYSTEM_READY:n(55237),VISIBLE:n(98704)}},80293:(t,e,n)=>{t.exports={Config:n(14033),CreateRenderer:n(50150),DebugHeader:n(77291),Events:n(97081),TimeStep:n(26617),VisibilityHandler:n(26493)}},52780:(t,e,n)=>{var i=n(81543),r=n(61068),s=n(10850);t.exports=function(t){var e=s(t,"data",[]),n=s(t,"canvas",null),o=s(t,"palette",i),a=s(t,"pixelWidth",1),c=s(t,"pixelHeight",a),l=s(t,"resizeCanvas",!0),u=s(t,"clearCanvas",!0),h=s(t,"preRender",null),d=s(t,"postRender",null),p=Math.floor(Math.abs(e[0].length*a)),f=Math.floor(Math.abs(e.length*c));n||(n=r.create2D(this,p,f),l=!1,u=!1),l&&(n.width=p,n.height=f);var m=n.getContext("2d",{willReadFrequently:!0});u&&m.clearRect(0,0,p,f),h&&h(n,m);for(var g=0;g<e.length;g++)for(var v=e[g],y=0;y<v.length;y++){var x=v[y];"."!==x&&" "!==x&&(m.fillStyle=o[x],m.fillRect(y*a,g*c,a,c))}return d&&d(n,m),n}},84106:(t,e,n)=>{t.exports={GenerateTexture:n(52780),Palettes:n(25235)}},81543:t=>{t.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}},75846:t=>{t.exports={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}},83206:t=>{t.exports={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}},13194:t=>{t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}},50686:t=>{t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}},25235:(t,e,n)=>{t.exports={ARNE16:n(81543),C64:n(75846),CGA:n(83206),JMP:n(13194),MSX:n(50686)}},63120:(t,e,n)=>{var i=n(56694),r=n(34631),s=n(38517),o=n(93736),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,"CubicBezierCurve"),Array.isArray(t)&&(i=new o(t[6],t[7]),n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n,this.p3=i},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,s=this.p2,a=this.p3;return e.set(r(t,n.x,i.x,s.x,a.x),r(t,n.y,i.y,s.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]),s=new o(e[6],e[7]);return new a(n,i,r,s)},t.exports=a},38517:(t,e,n)=>{var i=n(56694),r=n(80222),s=n(74118),o=n(93736),a=new i({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new o,this._tmpVec2B=new o},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,e){t||(t=new s),void 0===e&&(e=16);var n=this.getLength();e>n&&(e=n/2);var i=Math.max(1,Math.round(n/e));return r(this.getSpacedPoints(i),t)},getDistancePoints:function(t){var e=this.getLength(),n=Math.max(1,e/t);return this.getSpacedPoints(n)},getEndPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],i=this.getPoint(0,this._tmpVec2A),r=0;n.push(0);for(var s=1;s<=t;s++)r+=(e=this.getPoint(s/t,this._tmpVec2B)).distance(i),n.push(r),i.copy(e);return this.cacheArcLengths=n,n},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t,e,n){void 0===n&&(n=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var i=0;i<=t;i++)n.push(this.getPoint(i/t));return n},getRandomPoint:function(t){return void 0===t&&(t=new o),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,n){void 0===n&&(n=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var i=0;i<=t;i++){var r=this.getUtoTmapping(i/t,null,t);n.push(this.getPoint(r))}return n},getStartPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new o);var n=1e-4,i=t-n,r=t+n;return i<0&&(i=0),r>1&&(r=1),this.getPoint(i,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,n){var i,r=this.getLengths(n),s=0,o=r.length;i=e?Math.min(e,r[o-1]):t*r[o-1];for(var a,c=0,l=o-1;c<=l;)if((a=r[s=Math.floor(c+(l-c)/2)]-i)<0)c=s+1;else{if(!(a>0)){l=s;break}l=s-1}if(r[s=l]===i)return s/(o-1);var u=r[s];return(s+(i-u)/(r[s+1]-u))/(o-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});t.exports=a},48835:(t,e,n)=>{var i=n(56694),r=n(38517),s=n(75606),o=n(10850),a=n(23701),c=n(93736),l=new i({Extends:r,initialize:function(t,e,n,i,a,l,u,h){if("object"===typeof t){var d=t;t=o(d,"x",0),e=o(d,"y",0),n=o(d,"xRadius",0),i=o(d,"yRadius",n),a=o(d,"startAngle",0),l=o(d,"endAngle",360),u=o(d,"clockwise",!1),h=o(d,"rotation",0)}else void 0===i&&(i=n),void 0===a&&(a=0),void 0===l&&(l=360),void 0===u&&(u=!1),void 0===h&&(h=0);r.call(this,"EllipseCurve"),this.p0=new c(t,e),this._xRadius=n,this._yRadius=i,this._startAngle=s(a),this._endAngle=s(l),this._clockwise=u,this._rotation=s(h)},getStartPoint:function(t){return void 0===t&&(t=new c),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new c);for(var n=2*Math.PI,i=this._endAngle-this._startAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),this._clockwise&&!r&&(i===n?i=-n:i-=n);var s=this._startAngle+t*i,o=this.p0.x+this._xRadius*Math.cos(s),a=this.p0.y+this._yRadius*Math.sin(s);if(0!==this._rotation){var l=Math.cos(this._rotation),u=Math.sin(this._rotation),h=o-this.p0.x,d=a-this.p0.y;o=h*l-d*u+this.p0.x,a=h*u+d*l+this.p0.y}return e.set(o,a)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return a(this._startAngle)},set:function(t){this._startAngle=s(t)}},endAngle:{get:function(){return a(this._endAngle)},set:function(t){this._endAngle=s(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return a(this._rotation)},set:function(t){this._rotation=s(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:a(this._startAngle),endAngle:a(this._endAngle),clockwise:this._clockwise,rotation:a(this._rotation)}}});l.fromJSON=function(t){return new l(t)},t.exports=l},58084:(t,e,n)=>{var i=n(56694),r=n(38517),s=n(80222),o=n(74118),a=n(93736),c=new i({Extends:r,initialize:function(t,e){r.call(this,"LineCurve"),Array.isArray(t)&&(e=new a(t[2],t[3]),t=new a(t[0],t[1])),this.p0=t,this.p1=e,this.arcLengthDivisions=1},getBounds:function(t){return void 0===t&&(t=new o),s([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new a),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new a),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(t,e){return void 0===e&&(e=new a),e.copy(this.p1).subtract(this.p0).normalize(),e},getUtoTmapping:function(t,e,n){var i;if(e){var r=this.getLengths(n),s=r[r.length-1];i=Math.min(e,s)/s}else i=t;return i},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});c.fromJSON=function(t){var e=t.points,n=new a(e[0],e[1]),i=new a(e[2],e[3]);return new c(n,i)},t.exports=c},64761:(t,e,n)=>{var i=n(56694),r=n(38517),s=n(16252),o=n(93736),a=new i({Extends:r,initialize:function(t,e,n){r.call(this,"QuadraticBezierCurve"),Array.isArray(t)&&(n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,r=this.p2;return e.set(s(t,n.x,i.x,r.x),s(t,n.y,i.y,r.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]);return new a(n,i,r)},t.exports=a},11956:(t,e,n)=>{var i=n(14976),r=n(56694),s=n(38517),o=n(93736),a=new r({Extends:s,initialize:function(t){void 0===t&&(t=[]),s.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var n=new o;"number"===typeof t[e]?(n.x=t[e],n.y=t[e+1],e++):Array.isArray(t[e])?(n.x=t[e][0],n.y=t[e][1]):(n.x=t[e].x,n.y=t[e].y),this.points.push(n)}return this},addPoint:function(t,e){var n=new o(t,e);return this.points.push(n),n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.points,r=(n.length-1)*t,s=Math.floor(r),a=r-s,c=n[0===s?s:s-1],l=n[s],u=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return e.set(i(a,c.x,l.x,u.x,h.x),i(a,c.y,l.y,u.y,h.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});a.fromJSON=function(t){return new a(t.points)},t.exports=a},73962:(t,e,n)=>{t.exports={Path:n(12822),MoveTo:n(53639),CubicBezier:n(63120),Curve:n(38517),Ellipse:n(48835),Line:n(58084),QuadraticBezier:n(64761),Spline:n(11956)}},53639:(t,e,n)=>{var i=n(56694),r=n(93736),s=new i({initialize:function(t,e){this.active=!1,this.p0=new r(t,e)},getPoint:function(t,e){return void 0===e&&(e=new r),e.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});t.exports=s},12822:(t,e,n)=>{var i=n(56694),r=n(63120),s=n(48835),o=n(61286),a=n(58084),c=n(53639),l=n(64761),u=n(74118),h=n(11956),d=n(93736),p=n(83392),f=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.defaultDivisions=12,this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new d,this._tmpVec2A=new d,this._tmpVec2B=new d,"object"===typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,n){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,n)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new a(e,t)),this},cubicBezierTo:function(t,e,n,i,s,o){var a,c,l,u=this.getEndPoint();return t instanceof d?(a=t,c=e,l=n):(a=new d(n,i),c=new d(s,o),l=new d(t,e)),this.add(new r(u,a,c,l))},quadraticBezierTo:function(t,e,n,i){var r,s,o=this.getEndPoint();return t instanceof d?(r=t,s=e):(r=new d(n,i),s=new d(t,e)),this.add(new l(o,r,s))},draw:function(t,e){for(var n=0;n<this.curves.length;n++){var i=this.curves[n];i.active&&i.draw(t,e)}return t},ellipseTo:function(t,e,n,i,r,o){var a=new s(0,0,t,e,n,i,r,o),c=this.getEndPoint(this._tmpVec2A),l=a.getStartPoint(this._tmpVec2B);return c.subtract(l),a.x=c.x,a.y=c.y,this.add(a)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var e=0;e<t.curves.length;e++){var n=t.curves[e];switch(n.type){case"LineCurve":this.add(a.fromJSON(n));break;case"EllipseCurve":this.add(s.fromJSON(n));break;case"SplineCurve":this.add(h.fromJSON(n));break;case"CubicBezierCurve":this.add(r.fromJSON(n));break;case"QuadraticBezierCurve":this.add(l.fromJSON(n))}}return this},getBounds:function(t,e){void 0===t&&(t=new u),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var n=new u,i=p.MIN_SAFE_INTEGER,r=p.MIN_SAFE_INTEGER,s=0;s<this.curves.length;s++){var o=this.curves[s];o.active&&(o.getBounds(n,e),t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),i=Math.max(i,n.right),r=Math.max(r,n.bottom))}return t.right=i,t.bottom=r,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0;n<this.curves.length;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getCurveAt:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e)return this.curves[i];i++}return null},getEndPoint:function(t){return void 0===t&&(t=new d),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new d);for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var s=i[r]-n,o=this.curves[r],a=o.getLength(),c=0===a?0:1-s/a;return o.getPointAt(c,e)}r++}return null},getPoints:function(t,e){t||e||(t=this.defaultDivisions);for(var n,i=[],r=0;r<this.curves.length;r++){var s=this.curves[r];if(s.active)for(var o=s.getResolution(t),a=s.getPoints(o,e),c=0;c<a.length;c++){var l=a[c];n&&n.equals(l)||(i.push(l),n=l)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},getRandomPoint:function(t){return void 0===t&&(t=new d),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new d),t.copy(this.startPoint)},getTangent:function(t,e){void 0===e&&(e=new d);for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var s=i[r]-n,o=this.curves[r],a=o.getLength(),c=0===a?0:1-s/a;return o.getTangentAt(c,e)}r++}return null},lineTo:function(t,e){t instanceof d?this._tmpVec2B.copy(t):this._tmpVec2B.set(t,e);var n=this.getEndPoint(this._tmpVec2A);return this.add(new a([n.x,n.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new h(t))},moveTo:function(t,e){return t instanceof d?this.add(new c(t.x,t.y)):this.add(new c(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});o.register("path",(function(t,e){return new f(t,e)})),t.exports=f},81078:(t,e,n)=>{var i=n(56694),r=n(35026),s=new i({initialize:function(t,e){this.parent=t,this.events=e,e||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(r.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"===typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var n=this.get(t);return void 0===n&&(n=0),this.set(t,n+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,e){if(this._frozen)return this;if(this.has(t))this.values[t]=e;else{var n=this,i=this.list,s=this.events,o=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){if(!n._frozen){var a=i[t];i[t]=e,s.emit(r.CHANGE_DATA,o,t,e,a),s.emit(r.CHANGE_DATA_KEY+t,o,e,a)}}}),i[t]=e,s.emit(r.SET_DATA,o,t,e)}return this},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[1]=r,n[2]=this.list[r],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var e=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)}return this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(r.CHANGE_DATA),this.events.off(r.SET_DATA),this.events.off(r.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=s},76508:(t,e,n)=>{var i=n(56694),r=n(81078),s=n(91963),o=n(7599),a=new i({Extends:r,initialize:function(t){r.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(o.DESTROY,this.destroy,this)},start:function(){this.events.once(o.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){r.prototype.destroy.call(this),this.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("DataManagerPlugin",a,"data"),t.exports=a},73569:t=>{t.exports="changedata"},15590:t=>{t.exports="changedata-"},37669:t=>{t.exports="destroy"},87090:t=>{t.exports="removedata"},90142:t=>{t.exports="setdata"},35026:(t,e,n)=>{t.exports={CHANGE_DATA:n(73569),CHANGE_DATA_KEY:n(15590),DESTROY:n(37669),REMOVE_DATA:n(87090),SET_DATA:n(90142)}},1999:(t,e,n)=>{t.exports={DataManager:n(81078),DataManagerPlugin:n(76508),Events:n(35026)}},10720:(t,e,n)=>{var i=n(1350),r={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};t.exports=function(){if("function"===typeof importScripts)return r;r.audioData=!!window.Audio,r.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var t=document.createElement("audio"),e=!!t.canPlayType;try{if(e){var n=function(e,n){var i=t.canPlayType("audio/"+e).replace(/^no$/,"");return n?Boolean(i||t.canPlayType("audio/"+n).replace(/^no$/,"")):Boolean(i)};if(r.ogg=n('ogg; codecs="vorbis"'),r.opus=n('ogg; codecs="opus"',"opus"),r.mp3=n("mpeg"),r.wav=n("wav"),r.m4a=n("x-m4a"),r.aac=n("aac"),r.flac=n("flac","x-flac"),r.webm=n('webm; codecs="vorbis"'),""!==t.canPlayType('audio/mp4; codecs="ec-3"'))if(i.edge)r.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var s=parseInt(RegExp.$1,10),o=parseInt(RegExp.$2,10);(10===s&&o>=11||s>10)&&(r.dolby=!0)}}}catch(a){}return r}()},1350:(t,e,n)=>{var i=n(36580),r={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};t.exports=function(){var t=navigator.userAgent;return/Edg\/\d+/.test(t)?(r.edge=!0,r.es2019=!0):/OPR/.test(t)?(r.opera=!0,r.es2019=!0):/Chrome\/(\d+)/.test(t)&&!i.windowsPhone?(r.chrome=!0,r.chromeVersion=parseInt(RegExp.$1,10),r.es2019=r.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(r.firefox=!0,r.firefoxVersion=parseInt(RegExp.$1,10),r.es2019=r.firefoxVersion>10):/AppleWebKit/.test(t)&&i.iOS?(r.mobileSafari=!0,r.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(r.ie=!0,r.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+) Safari/.test(t)&&!i.windowsPhone?(r.safari=!0,r.safariVersion=parseInt(RegExp.$1,10),r.es2019=r.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(r.ie=!0,r.trident=!0,r.tridentVersion=parseInt(RegExp.$1,10),r.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(r.silk=!0),r}()},98581:(t,e,n)=>{var i=n(61068),r={supportInverseAlpha:!1,supportNewBlendModes:!1};t.exports=("function"!==typeof importScripts&&void 0!==document&&(r.supportNewBlendModes=function(){var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",n=new Image;return n.onload=function(){var s=new Image;s.onload=function(){var t=i.create2D(s,6).getContext("2d",{willReadFrequently:!0});if(t.globalCompositeOperation="multiply",t.drawImage(n,0,0),t.drawImage(s,2,0),!t.getImageData(2,0,1,1))return!1;var e=t.getImageData(2,0,1,1).data;i.remove(s),r.supportNewBlendModes=255===e[0]&&0===e[1]&&0===e[2]},s.src=t+"/wCKxvRF"+e},n.src=t+"AP804Oa6"+e,!1}(),r.supportInverseAlpha=function(){var t=i.create2D(this,2).getContext("2d",{willReadFrequently:!0});t.fillStyle="rgba(10, 20, 30, 0.5)",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1);if(null===e)return!1;t.putImageData(e,1,0);var n=t.getImageData(1,0,1,1),r=n.data[0]===e.data[0]&&n.data[1]===e.data[1]&&n.data[2]===e.data[2]&&n.data[3]===e.data[3];return i.remove(this),r}()),r)},90185:(t,e,n)=>{var i=n(36580),r=n(1350),s=n(61068),o={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};t.exports=function(){if("function"===typeof importScripts)return o;o.canvas=!!window.CanvasRenderingContext2D;try{o.localStorage=!!localStorage.getItem}catch(e){o.localStorage=!1}o.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob,o.fileSystem=!!window.requestFileSystem;var t=!1;return o.webGL=function(){if(window.WebGLRenderingContext)try{var e=s.createWebGL(this),n=e.getContext("webgl")||e.getContext("experimental-webgl"),i=s.create2D(this),r=i.getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return t=r.data instanceof Uint8ClampedArray,s.remove(e),s.remove(i),!!n}catch(o){return!1}return!1}(),o.worker=!!window.Worker,o.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,o.getUserMedia=o.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,r.firefox&&r.firefoxVersion<21&&(o.getUserMedia=!1),!i.iOS&&(r.ie||r.firefox||r.chrome)&&(o.canvasBitBltShift=!0),(r.safari||r.mobileSafari)&&(o.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(o.vibration=!0),"undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint32Array&&(o.littleEndian=function(){var t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===n[0]||2712847316!==n[0]&&null}()),o.support32bit="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof Int32Array&&null!==o.littleEndian&&t,o}()},33553:t=>{var e={available:!1,cancel:"",keyboard:!1,request:""};t.exports=function(){if("function"===typeof importScripts)return e;var t,n="Fullscreen",i="FullScreen",r=["request"+n,"request"+i,"webkitRequest"+n,"webkitRequest"+i,"msRequest"+n,"msRequest"+i,"mozRequest"+i,"mozRequest"+n];for(t=0;t<r.length;t++)if(document.documentElement[r[t]]){e.available=!0,e.request=r[t];break}var s=["cancel"+i,"exit"+n,"webkitCancel"+i,"webkitExit"+n,"msCancel"+i,"msExit"+n,"mozCancel"+i,"mozExit"+n];if(e.available)for(t=0;t<s.length;t++)if(document[s[t]]){e.cancel=s[t];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(e.keyboard=!0),Object.defineProperty(e,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),e}()},95872:(t,e,n)=>{var i=n(1350),r={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};t.exports=("function"===typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(r.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(r.mspointer=!0),navigator.getGamepads&&(r.gamepads=!0),"onwheel"in window||i.ie&&"WheelEvent"in window?r.wheelEvent="wheel":"onmousewheel"in window?r.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(r.wheelEvent="DOMMouseScroll")),r)},36580:t=>{var e={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};t.exports=function(){if("function"===typeof importScripts)return e;var t=navigator.userAgent;/Windows/.test(t)?e.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(e.iOS=!0,e.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),e.iOSVersion=parseInt(RegExp.$1,10)):e.macOS=!0:/Android/.test(t)?e.android=!0:/Linux/.test(t)?e.linux=!0:/iP[ao]d|iPhone/i.test(t)?(e.iOS=!0,navigator.appVersion.match(/OS (\d+)/),e.iOSVersion=parseInt(RegExp.$1,10),e.iPhone=-1!==t.toLowerCase().indexOf("iphone"),e.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?e.kindle=!0:/CrOS/.test(t)&&(e.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(e.android=!1,e.iOS=!1,e.macOS=!1,e.windows=!0,e.windowsPhone=!0);var n=/Silk/.test(t);return(e.windows||e.macOS||e.linux&&!n||e.chromeOS)&&(e.desktop=!0),(e.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(e.desktop=!1),navigator.standalone&&(e.webApp=!0),"function"!==typeof importScripts&&(void 0!==window.cordova&&(e.cordova=!0),void 0!==window.ejecta&&(e.ejecta=!0)),"undefined"!==typeof process&&process.versions&&process.versions.node&&(e.node=!0),e.node&&"object"===typeof process.versions&&(e.nodeWebkit=!!process.versions["node-webkit"],e.electron=!!process.versions.electron),/Crosswalk/.test(t)&&(e.crosswalk=!0),e.pixelRatio=window.devicePixelRatio||1,e}()},53861:(t,e,n)=>{var i=n(72632),r={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};t.exports=function(){if("function"===typeof importScripts)return r;var t=document.createElement("video"),e=!!t.canPlayType,n=/^no$/;try{e&&(t.canPlayType('video/ogg; codecs="theora"').replace(n,"")&&(r.ogg=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(n,"")&&(r.h264=!0,r.mp4=!0),t.canPlayType("video/x-m4v").replace(n,"")&&(r.m4v=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(n,"")&&(r.webm=!0),t.canPlayType('video/webm; codecs="vp9"').replace(n,"")&&(r.vp9=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(n,"")&&(r.hls=!0))}catch(s){}return t.parentNode&&t.parentNode.removeChild(t),r.getVideoURL=function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n,s=i(t[e],"url",t[e]);if(0===s.indexOf("blob:"))return{url:s,type:""};if(n=0===s.indexOf("data:")?s.split(",")[0].match(/\/(.*?);/):s.match(/\.([a-zA-Z0-9]+)($|\?)/),n=i(t[e],"type",n?n[1]:"").toLowerCase(),r[n])return{url:s,type:n}}return null},r}()},77290:(t,e,n)=>{t.exports={os:n(36580),browser:n(1350),features:n(90185),input:n(95872),audio:n(10720),video:n(53861),fullscreen:n(33553),canvasFeatures:n(98581)}},65246:(t,e,n)=>{var i=n(56694),r=new Float32Array(20),s=new i({initialize:function(){this._matrix=new Float32Array(20),this.alpha=1,this._dirty=!0,this._data=new Float32Array(20),this.reset()},set:function(t){return this._matrix.set(t),this._dirty=!0,this},reset:function(){var t=this._matrix;return t.fill(0),t[0]=1,t[6]=1,t[12]=1,t[18]=1,this.alpha=1,this._dirty=!0,this},getData:function(){var t=this._data;return this._dirty&&(t.set(this._matrix),t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,this._dirty=!1),t},brightness:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=t;return this.multiply([n,0,0,0,0,0,n,0,0,0,0,0,n,0,0,0,0,0,1,0],e)},saturate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=2*t/3+1,i=-.5*(n-1);return this.multiply([n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0],e)},desaturate:function(t){return void 0===t&&(t=!1),this.saturate(-1,t)},hue:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),t=t/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=.213,s=.715,o=.072;return this.multiply([r+.787*n+i*-r,s+n*-s+i*-s,o+n*-o+.928*i,0,0,r+n*-r+.143*i,s+n*(1-s)+.14*i,o+n*-o+-.283*i,0,0,r+n*-r+-.787*i,s+n*-s+i*s,o+.928*n+i*o,0,0,0,0,0,1,0],e)},grayscale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!1),this.saturate(-t,e)},blackWhite:function(t){return void 0===t&&(t=!1),this.multiply(s.BLACK_WHITE,t)},contrast:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var n=t+1,i=-.5*(n-1);return this.multiply([n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0],e)},negative:function(t){return void 0===t&&(t=!1),this.multiply(s.NEGATIVE,t)},desaturateLuminance:function(t){return void 0===t&&(t=!1),this.multiply(s.DESATURATE_LUMINANCE,t)},sepia:function(t){return void 0===t&&(t=!1),this.multiply(s.SEPIA,t)},night:function(t,e){return void 0===t&&(t=.1),void 0===e&&(e=!1),this.multiply([-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},lsd:function(t){return void 0===t&&(t=!1),this.multiply(s.LSD,t)},brown:function(t){return void 0===t&&(t=!1),this.multiply(s.BROWN,t)},vintagePinhole:function(t){return void 0===t&&(t=!1),this.multiply(s.VINTAGE,t)},kodachrome:function(t){return void 0===t&&(t=!1),this.multiply(s.KODACHROME,t)},technicolor:function(t){return void 0===t&&(t=!1),this.multiply(s.TECHNICOLOR,t)},polaroid:function(t){return void 0===t&&(t=!1),this.multiply(s.POLAROID,t)},shiftToBGR:function(t){return void 0===t&&(t=!1),this.multiply(s.SHIFT_BGR,t)},multiply:function(t,e){void 0===e&&(e=!1),e||this.reset();var n=this._matrix,i=r;return i.set(n),n.set([i[0]*t[0]+i[1]*t[5]+i[2]*t[10]+i[3]*t[15],i[0]*t[1]+i[1]*t[6]+i[2]*t[11]+i[3]*t[16],i[0]*t[2]+i[1]*t[7]+i[2]*t[12]+i[3]*t[17],i[0]*t[3]+i[1]*t[8]+i[2]*t[13]+i[3]*t[18],i[0]*t[4]+i[1]*t[9]+i[2]*t[14]+i[3]*t[19]+i[4],i[5]*t[0]+i[6]*t[5]+i[7]*t[10]+i[8]*t[15],i[5]*t[1]+i[6]*t[6]+i[7]*t[11]+i[8]*t[16],i[5]*t[2]+i[6]*t[7]+i[7]*t[12]+i[8]*t[17],i[5]*t[3]+i[6]*t[8]+i[7]*t[13]+i[8]*t[18],i[5]*t[4]+i[6]*t[9]+i[7]*t[14]+i[8]*t[19]+i[9],i[10]*t[0]+i[11]*t[5]+i[12]*t[10]+i[13]*t[15],i[10]*t[1]+i[11]*t[6]+i[12]*t[11]+i[13]*t[16],i[10]*t[2]+i[11]*t[7]+i[12]*t[12]+i[13]*t[17],i[10]*t[3]+i[11]*t[8]+i[12]*t[13]+i[13]*t[18],i[10]*t[4]+i[11]*t[9]+i[12]*t[14]+i[13]*t[19]+i[14],i[15]*t[0]+i[16]*t[5]+i[17]*t[10]+i[18]*t[15],i[15]*t[1]+i[16]*t[6]+i[17]*t[11]+i[18]*t[16],i[15]*t[2]+i[16]*t[7]+i[17]*t[12]+i[18]*t[17],i[15]*t[3]+i[16]*t[8]+i[17]*t[13]+i[18]*t[18],i[15]*t[4]+i[16]*t[9]+i[17]*t[14]+i[18]*t[19]+i[19]]),this._dirty=!0,this}});s.BLACK_WHITE=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],s.NEGATIVE=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],s.DESATURATE_LUMINANCE=[.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],s.SEPIA=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],s.LSD=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],s.BROWN=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],s.VINTAGE=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],s.KODACHROME=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],s.TECHNICOLOR=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],s.POLAROID=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],s.SHIFT_BGR=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t.exports=s},39298:(t,e,n)=>{var i=n(56694),r=n(72283),s=new i({initialize:function(t,e,n){this._rgb=[0,0,0],this.onChangeCallback=r,this.dirty=!1,this.set(t,e,n)},set:function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._rgb=[t,e,n],this.onChange(),this},equals:function(t,e,n){var i=this._rgb;return i[0]===t&&i[1]===e&&i[2]===n},onChange:function(){this.dirty=!0;var t=this._rgb;this.onChangeCallback.call(this,t[0],t[1],t[2])},r:{get:function(){return this._rgb[0]},set:function(t){this._rgb[0]=t,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(t){this._rgb[1]=t,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(t){this._rgb[2]=t,this.onChange()}},destroy:function(){this.onChangeCallback=null}});t.exports=s},84093:t=>{t.exports={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12}},32058:(t,e,n)=>{var i=n(97328),r=n(59994),s=n(73174),o=n(28417);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},85535:(t,e,n)=>{var i=n(97328),r=n(40163),s=n(73174),o=n(74465);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},9605:(t,e,n)=>{var i=n(97328),r=n(70271),s=n(73174),o=n(19298);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},22529:(t,e,n)=>{var i=n(21843),r=n(59994),s=n(29568);t.exports=function(t,e,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),i(t,r(e)+n,s(e)+o),t}},5739:(t,e,n)=>{var i=n(29568),r=n(40163),s=n(81711),o=n(74465);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},40327:(t,e,n)=>{var i=n(84093),r=[];r[i.BOTTOM_CENTER]=n(32058),r[i.BOTTOM_LEFT]=n(85535),r[i.BOTTOM_RIGHT]=n(9605),r[i.CENTER]=n(22529),r[i.LEFT_CENTER]=n(5739),r[i.RIGHT_CENTER]=n(27683),r[i.TOP_CENTER]=n(96439),r[i.TOP_LEFT]=n(81447),r[i.TOP_RIGHT]=n(47888),r[i.LEFT_BOTTOM]=r[i.BOTTOM_LEFT],r[i.LEFT_TOP]=r[i.TOP_LEFT],r[i.RIGHT_BOTTOM]=r[i.BOTTOM_RIGHT],r[i.RIGHT_TOP]=r[i.TOP_RIGHT],t.exports=function(t,e,n,i,s){return r[n](t,e,i,s)}},27683:(t,e,n)=>{var i=n(29568),r=n(70271),s=n(81711),o=n(19298);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},96439:(t,e,n)=>{var i=n(59994),r=n(47196),s=n(28417),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},81447:(t,e,n)=>{var i=n(40163),r=n(47196),s=n(74465),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},47888:(t,e,n)=>{var i=n(70271),r=n(47196),s=n(19298),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},46997:(t,e,n)=>{t.exports={BottomCenter:n(32058),BottomLeft:n(85535),BottomRight:n(9605),Center:n(22529),LeftCenter:n(5739),QuickSet:n(40327),RightCenter:n(27683),TopCenter:n(96439),TopLeft:n(81447),TopRight:n(47888)}},93545:(t,e,n)=>{var i=n(84093),r=n(98611),s={In:n(46997),To:n(86639)};s=r(!1,s,i),t.exports=s},27118:(t,e,n)=>{var i=n(97328),r=n(59994),s=n(28417),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},84469:(t,e,n)=>{var i=n(97328),r=n(40163),s=n(74465),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)-n),o(t,i(e)+a),t}},51577:(t,e,n)=>{var i=n(97328),r=n(70271),s=n(19298),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},90271:(t,e,n)=>{var i=n(97328),r=n(40163),s=n(73174),o=n(19298);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},30466:(t,e,n)=>{var i=n(29568),r=n(40163),s=n(81711),o=n(19298);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},50087:(t,e,n)=>{var i=n(40163),r=n(47196),s=n(19298),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},82590:(t,e,n)=>{var i=n(84093),r=[];r[i.BOTTOM_CENTER]=n(27118),r[i.BOTTOM_LEFT]=n(84469),r[i.BOTTOM_RIGHT]=n(51577),r[i.LEFT_BOTTOM]=n(90271),r[i.LEFT_CENTER]=n(30466),r[i.LEFT_TOP]=n(50087),r[i.RIGHT_BOTTOM]=n(13555),r[i.RIGHT_CENTER]=n(99049),r[i.RIGHT_TOP]=n(67788),r[i.TOP_CENTER]=n(78170),r[i.TOP_LEFT]=n(54145),r[i.TOP_RIGHT]=n(75548),t.exports=function(t,e,n,i,s){return r[n](t,e,i,s)}},13555:(t,e,n)=>{var i=n(97328),r=n(70271),s=n(73174),o=n(74465);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},99049:(t,e,n)=>{var i=n(29568),r=n(70271),s=n(81711),o=n(74465);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},67788:(t,e,n)=>{var i=n(70271),r=n(47196),s=n(74465),o=n(84349);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},78170:(t,e,n)=>{var i=n(59994),r=n(47196),s=n(73174),o=n(28417);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},54145:(t,e,n)=>{var i=n(40163),r=n(47196),s=n(73174),o=n(74465);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)-n),s(t,r(e)-a),t}},75548:(t,e,n)=>{var i=n(70271),r=n(47196),s=n(73174),o=n(19298);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},86639:(t,e,n)=>{t.exports={BottomCenter:n(27118),BottomLeft:n(84469),BottomRight:n(51577),LeftBottom:n(90271),LeftCenter:n(30466),LeftTop:n(50087),QuickSet:n(82590),RightBottom:n(13555),RightCenter:n(99049),RightTop:n(67788),TopCenter:n(78170),TopLeft:n(54145),TopRight:n(75548)}},21843:(t,e,n)=>{var i=n(28417),r=n(81711);t.exports=function(t,e,n){return i(t,e),r(t,n)}},97328:t=>{t.exports=function(t){return t.y+t.height-t.height*t.originY}},7126:(t,e,n)=>{var i=n(97328),r=n(40163),s=n(70271),o=n(47196),a=n(74118);t.exports=function(t,e){void 0===e&&(e=new a);var n=r(t),c=o(t);return e.x=n,e.y=c,e.width=s(t)-n,e.height=i(t)-c,e}},59994:t=>{t.exports=function(t){return t.x-t.width*t.originX+.5*t.width}},29568:t=>{t.exports=function(t){return t.y-t.height*t.originY+.5*t.height}},40163:t=>{t.exports=function(t){return t.x-t.width*t.originX}},52088:t=>{t.exports=function(t){return t.width*t.originX}},23379:t=>{t.exports=function(t){return t.height*t.originY}},70271:t=>{t.exports=function(t){return t.x+t.width-t.width*t.originX}},47196:t=>{t.exports=function(t){return t.y-t.height*t.originY}},73174:t=>{t.exports=function(t,e){return t.y=e-t.height+t.height*t.originY,t}},28417:t=>{t.exports=function(t,e){var n=t.width*t.originX;return t.x=e+n-.5*t.width,t}},81711:t=>{t.exports=function(t,e){var n=t.height*t.originY;return t.y=e+n-.5*t.height,t}},74465:t=>{t.exports=function(t,e){return t.x=e+t.width*t.originX,t}},19298:t=>{t.exports=function(t,e){return t.x=e-t.width+t.width*t.originX,t}},84349:t=>{t.exports=function(t,e){return t.y=e+t.height*t.originY,t}},15252:(t,e,n)=>{t.exports={CenterOn:n(21843),GetBottom:n(97328),GetBounds:n(7126),GetCenterX:n(59994),GetCenterY:n(29568),GetLeft:n(40163),GetOffsetX:n(52088),GetOffsetY:n(23379),GetRight:n(70271),GetTop:n(47196),SetBottom:n(73174),SetCenterX:n(28417),SetCenterY:n(81711),SetLeft:n(74465),SetRight:n(19298),SetTop:n(84349)}},70616:t=>{t.exports={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach((function(e){t.style["image-rendering"]=e})),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}}},61068:(t,e,n)=>{var i=n(86459),r=n(8213),s=[],o=!1;t.exports=function(){var t=function(t,n,a,c,l){var u;void 0===n&&(n=1),void 0===a&&(a=1),void 0===c&&(c=i.CANVAS),void 0===l&&(l=!1);var h=e(c);return null===h?(h={parent:t,canvas:document.createElement("canvas"),type:c},c===i.CANVAS&&s.push(h),u=h.canvas):(h.parent=t,u=h.canvas),l&&(h.parent=u),u.width=n,u.height=a,o&&c===i.CANVAS&&r.disable(u.getContext("2d",{willReadFrequently:!1})),u},e=function(t){if(void 0===t&&(t=i.CANVAS),t===i.WEBGL)return null;for(var e=0;e<s.length;e++){var n=s[e];if(!n.parent&&n.type===t)return n}return null},n=function(){var t=0;return s.forEach((function(e){e.parent&&t++})),t};return{create2D:function(e,n,r){return t(e,n,r,i.CANVAS)},create:t,createWebGL:function(e,n,r){return t(e,n,r,i.WEBGL)},disableSmoothing:function(){o=!0},enableSmoothing:function(){o=!1},first:e,free:function(){return s.length-n()},pool:s,remove:function(t){var e=t instanceof HTMLCanvasElement;s.forEach((function(n){(e&&n.canvas===t||!e&&n.parent===t)&&(n.parent=null,n.canvas.width=1,n.canvas.height=1)}))},total:n}}()},8213:t=>{var e="";t.exports=function(){var t=function(t){for(var e=["i","webkitI","msI","mozI","oI"],n=0;n<e.length;n++){var i=e[n]+"mageSmoothingEnabled";if(i in t)return i}return null};return{disable:function(n){return""===e&&(e=t(n)),e&&(n[e]=!1),n},enable:function(n){return""===e&&(e=t(n)),e&&(n[e]=!0),n},getPrefix:t,isEnabled:function(t){return null!==e?t[e]:null}}}()},59271:t=>{t.exports=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t}},36505:t=>{t.exports=function(t,e){return void 0===e&&(e="none"),["-webkit-","-khtml-","-moz-","-ms-",""].forEach((function(n){t.style[n+"user-select"]=e})),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t}},23514:(t,e,n)=>{t.exports={CanvasInterpolation:n(70616),CanvasPool:n(61068),Smoothing:n(8213),TouchAction:n(59271),UserSelect:n(36505)}},27119:(t,e,n)=>{var i=n(56694),r=n(22946),s=n(5657),o=n(24650),a=n(68033),c=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,n,i)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,n,i,r){return void 0===i&&(i=255),void 0===r&&(r=!0),this._locked=!0,this.red=t,this.green=e,this.blue=n,this.alpha=i,this._locked=!1,this.update(r)},setGLTo:function(t,e,n,i){return void 0===i&&(i=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=n,this.alphaGL=i,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,n){return o(t,e,n,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var e=this.r,n=this.g,i=this.b,o=this.a;return this._color=r(e,n,i),this._color32=s(e,n,i,o),this._rgba="rgba("+e+","+n+","+i+","+o/255+")",t&&a(e,n,i,this),this},updateHSV:function(){var t=this.r,e=this.g,n=this.b;return a(t,e,n,this),this},clone:function(){return new c(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t)),i=Math.floor(t+Math.random()*(e-t)),r=Math.floor(t+Math.random()*(e-t));return this.setTo(n,i,r)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t));return this.setTo(n,n,n)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,n=this.g,i=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),this.setTo(e,n,i)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,o(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,o(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,o(this._h,this._s,t,this)}}});t.exports=c},30245:(t,e,n)=>{var i=n(22946);t.exports=function(t){void 0===t&&(t=1024);var e,n=[],r=255,s=255,o=0,a=0;for(e=0;e<=r;e++)n.push({r:s,g:e,b:a,color:i(s,e,a)});for(o=255,e=r;e>=0;e--)n.push({r:e,g:o,b:a,color:i(e,o,a)});for(s=0,e=0;e<=r;e++,o--)n.push({r:s,g:o,b:e,color:i(s,o,e)});for(o=0,a=255,e=0;e<=r;e++,a--,s++)n.push({r:s,g:o,b:a,color:i(s,o,a)});if(1024===t)return n;var c=[],l=0,u=1024/t;for(e=0;e<t;e++)c.push(n[Math.floor(l)]),l+=u;return c}},86672:t=>{t.exports=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}},25409:t=>{t.exports=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},22946:t=>{t.exports=function(t,e,n){return t<<16|e<<8|n}},5657:t=>{t.exports=function(t,e,n,i){return i<<24|t<<16|e<<8|n}},74777:(t,e,n)=>{var i=n(27119),r=n(59998);t.exports=function(t,e,n){var s=n,o=n,a=n;if(0!==e){var c=n<.5?n*(1+e):n+e-n*e,l=2*n-c;s=r(l,c,t+1/3),o=r(l,c,t),a=r(l,c,t-1/3)}return(new i).setGLTo(s,o,a,1)}},89263:(t,e,n)=>{var i=n(24650);t.exports=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var n=[],r=0;r<=359;r++)n.push(i(r/359,t,e));return n}},24650:(t,e,n)=>{var i=n(22946);function r(t,e,n,i){var r=(t+6*e)%6,s=Math.min(r,4-r,1);return Math.round(255*(i-i*n*Math.max(0,s)))}t.exports=function(t,e,n,s){void 0===e&&(e=1),void 0===n&&(n=1);var o=r(5,t,e,n),a=r(3,t,e,n),c=r(1,t,e,n);return s?s.setTo?s.setTo(o,a,c,s.alpha,!0):(s.r=o,s.g=a,s.b=c,s.color=i(o,a,c),s):{r:o,g:a,b:c,color:i(o,a,c)}}},91487:(t,e,n)=>{var i=n(27119);t.exports=function(t){var e=new i;t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,i){return e+e+n+n+i+i}));var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){var r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);e.setTo(r,s,o)}return e}},59998:t=>{t.exports=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},74853:(t,e,n)=>{var i=n(27119),r=n(15978);t.exports=function(t){var e=r(t);return new i(e.r,e.g,e.b,e.a)}},15978:t=>{t.exports=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}}},53756:(t,e,n)=>{var i=n(42798),r=function(t,e,n,r,s,o,a,c){void 0===a&&(a=100),void 0===c&&(c=0);var l=c/a;return{r:i(t,r,l),g:i(e,s,l),b:i(n,o,l)}};t.exports={RGBWithRGB:r,ColorWithRGB:function(t,e,n,i,s,o){return void 0===s&&(s=100),void 0===o&&(o=0),r(t.r,t.g,t.b,e,n,i,s,o)},ColorWithColor:function(t,e,n,i){return void 0===n&&(n=100),void 0===i&&(i=0),r(t.r,t.g,t.b,e.r,e.g,e.b,n,i)}}},73904:(t,e,n)=>{var i=n(27119);t.exports=function(t){return new i(t.r,t.g,t.b,t.a)}},26841:(t,e,n)=>{var i=n(27119);t.exports=function(t){var e=new i,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t.toLowerCase());if(n){var r=parseInt(n[1],10),s=parseInt(n[2],10),o=parseInt(n[3],10),a=void 0!==n[4]?parseFloat(n[4]):1;e.setTo(r,s,o,255*a)}return e}},68033:t=>{t.exports=function(t,e,n,i){void 0===i&&(i={h:0,s:0,v:0}),t/=255,e/=255,n/=255;var r=Math.min(t,e,n),s=Math.max(t,e,n),o=s-r,a=0,c=0===s?0:o/s,l=s;return s!==r&&(s===t?a=(e-n)/o+(e<n?6:0):s===e?a=(n-t)/o+2:s===n&&(a=(t-e)/o+4),a/=6),i.hasOwnProperty("_h")?(i._h=a,i._s=c,i._v=l):(i.h=a,i.s=c,i.v=l),i}},4880:(t,e,n)=>{var i=n(25409);t.exports=function(t,e,n,r,s){return void 0===r&&(r=255),void 0===s&&(s="#"),"#"===s?"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1,7):"0x"+i(r)+i(t)+i(e)+i(n)}},37243:(t,e,n)=>{var i=n(17489),r=n(27119);t.exports=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=255),new r(i(t,e),i(t,e),i(t,e))}},93222:(t,e,n)=>{var i=n(91487),r=n(74853),s=n(73904),o=n(26841);t.exports=function(t){switch(typeof t){case"string":return"rgb"===t.substr(0,3).toLowerCase()?o(t):i(t);case"number":return r(t);case"object":return s(t)}}},95509:(t,e,n)=>{var i=n(27119);i.ColorSpectrum=n(30245),i.ColorToRGBA=n(86672),i.ComponentToHex=n(25409),i.GetColor=n(22946),i.GetColor32=n(5657),i.HexStringToColor=n(91487),i.HSLToColor=n(74777),i.HSVColorWheel=n(89263),i.HSVToRGB=n(24650),i.HueToComponent=n(59998),i.IntegerToColor=n(74853),i.IntegerToRGB=n(15978),i.Interpolate=n(53756),i.ObjectToColor=n(73904),i.RandomRGB=n(37243),i.RGBStringToColor=n(26841),i.RGBToHSV=n(68033),i.RGBToString=n(4880),i.ValueToColor=n(93222),t.exports=i},24816:(t,e,n)=>{t.exports={Align:n(93545),BaseShader:n(31053),Bounds:n(15252),Canvas:n(23514),Color:n(95509),ColorMatrix:n(65246),Masks:n(93310),RGB:n(39298)}},76756:(t,e,n)=>{var i=n(56694),r=n(61286),s=new i({initialize:function(t,e,n,i,r,s){e||(e=t.sys.make.image({x:n,y:i,key:r,frame:s,add:!1})),this.bitmapMask=e,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,n)},postRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e,n)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});r.register("bitmapMask",(function(t,e,n,i,r){return new s(this.scene,t,e,n,i,r)})),t.exports=s},63037:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,r=this.geometryMask,s=t.maskCount,o=255;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,s,o),i.stencilOp(i.KEEP,i.KEEP,i.INCR),s++):(i.stencilFunc(i.EQUAL,s+1,o),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),this.level=s,r.renderWebGL(t,r,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s,o):i.stencilFunc(i.EQUAL,s,o)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var n=t.currentMask;if(0===t.maskStack.length)n.mask=null,e.disable(e.STENCIL_TEST);else{var i=t.maskStack[t.maskStack.length-1];i.mask.applyStencil(t,i.camera,!1),t.currentCameraMask.mask!==i.mask?(n.mask=i.mask,n.camera=i.camera):n.mask=null}},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},93310:(t,e,n)=>{t.exports={BitmapMask:n(76756),GeometryMask:n(63037)}},31053:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),n&&""!==n||(n=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===i&&(i=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=n,this.uniforms=i}});t.exports=i},99584:t=>{t.exports=function(t,e){var n;if(e)"string"===typeof e?n=document.getElementById(e):"object"===typeof e&&1===e.nodeType&&(n=e);else if(t.parentElement||null===e)return t;return n||(n=document.body),n.appendChild(t),t}},85178:(t,e,n)=>{var i=n(99584);t.exports=function(t){var e=t.config;if(e.parent&&e.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+t.scale.width+"px;","height: "+t.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+e.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),t.domContainer=n,i(n,e.parent)}}},21546:(t,e,n)=>{var i=n(36580);t.exports=function(t){if("complete"!==document.readyState&&"interactive"!==document.readyState){var e=function(){document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?i.cordova?document.addEventListener("deviceready",e,!1):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}else t()}},74181:t=>{t.exports=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),n={w:0,h:0},i=document.createElement("div");return i.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(i),n.w=90===e?i.offsetHeight:window.innerWidth,n.h=90===e?window.innerWidth:i.offsetHeight,document.documentElement.removeChild(i),i=null,90!==Math.abs(window.orientation)?n.h:n.w}},9229:(t,e,n)=>{var i=n(55301);t.exports=function(t,e){var n=window.screen,r=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);return r&&"string"===typeof r.type?r.type:"string"===typeof r?r:"number"===typeof window.orientation?0===window.orientation||180===window.orientation?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?i.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?i.ORIENTATION.LANDSCAPE:void 0:e>t?i.ORIENTATION.PORTRAIT:i.ORIENTATION.LANDSCAPE}},2893:t=>{t.exports=function(t){var e;return""!==t&&("string"===typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e}},89200:t=>{t.exports=function(t){var e="";try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(n){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}},55638:t=>{t.exports=function(t){t.parentNode&&t.parentNode.removeChild(t)}},27385:(t,e,n)=>{var i=n(56694),r=n(72283),s=new i({initialize:function(){this.isRunning=!1,this.callback=r,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var t=this;this.step=function e(n){t.callback(n),t.isRunning&&(t.timeOutID=window.requestAnimationFrame(e))},this.stepTimeout=function e(){t.isRunning&&(t.timeOutID=window.setTimeout(e,t.delay)),t.callback(window.performance.now())}},start:function(t,e,n){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.delay=n,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=r}});t.exports=s},3590:(t,e,n)=>{var i={AddToDOM:n(99584),DOMContentLoaded:n(21546),GetInnerHeight:n(74181),GetScreenOrientation:n(9229),GetTarget:n(2893),ParseXML:n(89200),RemoveFromDOM:n(55638),RequestAnimationFrame:n(27385)};t.exports=i},78491:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(91963),o=new i({Extends:r,initialize:function(){r.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});s.register("EventEmitter",o,"events"),t.exports=o},95146:(t,e,n)=>{t.exports={EventEmitter:n(78491)}},20170:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e){void 0===e&&(e=1),r.call(this,s.BARREL,t),this.amount=e}});t.exports=o},51182:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c){void 0===n&&(n=1),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),void 0===c&&(c=4),r.call(this,s.BLOOM,t),this.steps=c,this.offsetX=n,this.offsetY=i,this.blurStrength=o,this.strength=a,this.glcolor=[1,1,1],void 0!==e&&null!==e&&(this.color=e)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});t.exports=o},51498:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c){void 0===e&&(e=0),void 0===n&&(n=2),void 0===i&&(i=2),void 0===o&&(o=1),void 0===c&&(c=4),r.call(this,s.BLUR,t),this.quality=e,this.x=n,this.y=i,this.steps=c,this.strength=o,this.glcolor=[1,1,1],void 0!==a&&null!==a&&(this.color=a)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});t.exports=o},12042:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c,l){void 0===e&&(e=.5),void 0===n&&(n=1),void 0===i&&(i=.2),void 0===o&&(o=!1),void 0===a&&(a=1),void 0===c&&(c=1),void 0===l&&(l=1),r.call(this,s.BOKEH,t),this.radius=e,this.amount=n,this.contrast=i,this.isTiltShift=o,this.strength=l,this.blurX=a,this.blurY=c}});t.exports=o},69900:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a){void 0===e&&(e=8),void 0===o&&(o=1),void 0===a&&(a=.005),r.call(this,s.CIRCLE,t),this.scale=o,this.feather=a,this.thickness=e,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],void 0!==n&&null!==n&&(this.color=n),void 0!==i&&null!==i&&(this.backgroundColor=i)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundColor:{get:function(){var t=this.glcolor2;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor2;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundAlpha:{get:function(){return this.glcolor2[3]},set:function(t){this.glcolor2[3]=t}}});t.exports=o},48991:(t,e,n)=>{var i=n(56694),r=n(65246),s=n(47406),o=new i({Extends:r,initialize:function(t){r.call(this),this.type=s.COLOR_MATRIX,this.gameObject=t,this.active=!0},destroy:function(){this.gameObject=null,this._matrix=null,this._data=null}});t.exports=o},47551:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e){this.type=t,this.gameObject=e,this.active=!0},setActive:function(t){return this.active=t,this},destroy:function(){this.gameObject=null,this.active=!1}});t.exports=i},47909:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i){void 0===e&&(e="__WHITE"),void 0===n&&(n=.005),void 0===i&&(i=.005),r.call(this,s.DISPLACEMENT,t),this.x=n,this.y=i,this.glTexture,this.setTexture(e)},setTexture:function(t){var e=this.gameObject.scene.sys.textures.getFrame(t);return e&&(this.glTexture=e.glTexture),this}});t.exports=o},18919:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o){void 0===n&&(n=4),void 0===i&&(i=0),void 0===o&&(o=!1),r.call(this,s.GLOW,t),this.outerStrength=n,this.innerStrength=i,this.knockout=o,this.glcolor=[1,1,1,1],void 0!==e&&(this.color=e)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});t.exports=o},62494:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c,l,u){void 0===i&&(i=.2),void 0===o&&(o=0),void 0===a&&(a=0),void 0===c&&(c=0),void 0===l&&(l=1),void 0===u&&(u=0),r.call(this,s.GRADIENT,t),this.alpha=i,this.size=u,this.fromX=o,this.fromY=a,this.toX=c,this.toY=l,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],void 0!==e&&null!==e&&(this.color1=e),void 0!==n&&null!==n&&(this.color2=n)},color1:{get:function(){var t=this.glcolor1;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor1;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}},color2:{get:function(){var t=this.glcolor2;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor2;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}}});t.exports=o},68897:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e){void 0===e&&(e=1),r.call(this,s.PIXELATE,t),this.amount=e}});t.exports=o},58575:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=.1),void 0===o&&(o=1),void 0===c&&(c=6),void 0===l&&(l=1),r.call(this,s.SHADOW,t),this.x=e,this.y=n,this.decay=i,this.power=o,this.glcolor=[0,0,0,1],this.samples=c,this.intensity=l,void 0!==a&&(this.color=a)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});t.exports=o},33755:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o){void 0===e&&(e=.5),void 0===n&&(n=.5),void 0===i&&(i=3),void 0===o&&(o=!1),r.call(this,s.SHINE,t),this.speed=e,this.lineWidth=n,this.gradient=i,this.reveal=o}});t.exports=o},24949:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o){void 0===e&&(e=.5),void 0===n&&(n=.5),void 0===i&&(i=.5),void 0===o&&(o=.5),r.call(this,s.VIGNETTE,t),this.x=e,this.y=n,this.radius=i,this.strength=o}});t.exports=o},66241:(t,e,n)=>{var i=n(56694),r=n(47551),s=n(47406),o=new i({Extends:r,initialize:function(t,e,n,i,o){void 0===e&&(e=.1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=!1),r.call(this,s.WIPE,t),this.progress=0,this.wipeWidth=e,this.direction=n,this.axis=i,this.reveal=o}});t.exports=o},47406:t=>{t.exports={GLOW:4,SHADOW:5,PIXELATE:6,VIGNETTE:7,SHINE:8,BLUR:9,GRADIENT:12,BLOOM:13,COLOR_MATRIX:14,CIRCLE:15,BARREL:16,DISPLACEMENT:17,WIPE:18,BOKEH:19}},96910:(t,e,n)=>{var i=n(98611),r=n(47406),s={Barrel:n(20170),Controller:n(47551),Bloom:n(51182),Blur:n(51498),Bokeh:n(12042),Circle:n(69900),ColorMatrix:n(48991),Displacement:n(47909),Glow:n(18919),Gradient:n(62494),Pixelate:n(68897),Shadow:n(58575),Shine:n(33755),Vignette:n(24949),Wipe:n(66241)};s=i(!1,s,r),t.exports=s},88933:(t,e,n)=>{var i=n(95723),r=n(20494);t.exports=function(t,e,n){e.x=r(n,"x",0),e.y=r(n,"y",0),e.depth=r(n,"depth",0),e.flipX=r(n,"flipX",!1),e.flipY=r(n,"flipY",!1);var s=r(n,"scale",null);"number"===typeof s?e.setScale(s):null!==s&&(e.scaleX=r(s,"x",1),e.scaleY=r(s,"y",1));var o=r(n,"scrollFactor",null);"number"===typeof o?e.setScrollFactor(o):null!==o&&(e.scrollFactorX=r(o,"x",1),e.scrollFactorY=r(o,"y",1)),e.rotation=r(n,"rotation",0);var a=r(n,"angle",null);null!==a&&(e.angle=a),e.alpha=r(n,"alpha",1);var c=r(n,"origin",null);if("number"===typeof c)e.setOrigin(c);else if(null!==c){var l=r(c,"x",.5),u=r(c,"y",.5);e.setOrigin(l,u)}return e.blendMode=r(n,"blendMode",i.NORMAL),e.visible=r(n,"visible",!0),r(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},32291:(t,e,n)=>{var i=n(20494);t.exports=function(t,e){var n=i(e,"anims",null);if(null===n)return t;if("string"===typeof n)t.anims.play(n);else if("object"===typeof n){var r=t.anims,s=i(n,"key",void 0);if(s){var o=i(n,"startFrame",void 0),a=i(n,"delay",0),c=i(n,"repeat",0),l=i(n,"repeatDelay",0),u=i(n,"yoyo",!1),h=i(n,"play",!1),d=i(n,"delayedPlay",0),p={key:s,delay:a,repeat:c,repeatDelay:l,yoyo:u,startFrame:o};h?r.play(p):d>0?r.playAfterDelay(p,d):r.load(p)}}return t}},91713:(t,e,n)=>{var i=n(56694),r=n(71207),s=n(91963),o=n(56631),a=n(7599),c=n(17922),l=new i({Extends:r,initialize:function(t){r.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(a.BOOT,this.boot,this),this.events.on(a.START,this.start,this)},boot:function(){this.events.once(a.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(o.ADDED_TO_SCENE,t,this.scene),this.events.emit(a.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(o.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(a.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(a.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(c(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list;t.length;)t[0].destroy(!0);this.events.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(a.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});s.register("DisplayList",l,"displayList"),t.exports=l},89980:(t,e,n)=>{var i=n(56694),r=n(48129),s=n(81078),o=n(6659),a=n(56631),c=n(7599),l=new i({Extends:o,initialize:function(t,e){o.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(a.ADDED_TO_SCENE,this.addedToScene,this),this.on(a.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.scene.sys.input.disable(this),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return r(this)},willRender:function(t){return!(this.displayList&&this.displayList.active&&!this.displayList.willRender(t)||l.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?n.unshift(this.displayList.getIndex(t)):n.unshift(this.scene.sys.displayList.getIndex(t)),n},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(a.ADDED_TO_SCENE,this,this.scene),t.events.emit(c.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t&&t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(a.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(c.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(t){this.scene&&!this.ignoreDestroy&&(void 0===t&&(t=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(a.DESTROY,this,t),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});l.RENDER_MASK=15,t.exports=l},99325:(t,e,n)=>{var i=n(56694),r=n(91963),s=n(7599),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(s.DESTROY,this.destroy,this)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectCreator",o,"make"),t.exports=o},61286:(t,e,n)=>{var i=n(56694),r=n(91963),s=n(7599),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(s.DESTROY,this.destroy,this)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectFactory",o,"add"),t.exports=o},73329:(t,e,n)=>{var i=n(69360),r=new i,s=new i,o=new i,a={camera:r,sprite:s,calc:o};t.exports=function(t,e,n){var i=r,c=s,l=o;return c.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),c.e=t.x,c.f=t.y):(c.e-=e.scrollX*t.scrollFactorX,c.f-=e.scrollY*t.scrollFactorY),i.multiply(c,l),a}},92034:(t,e,n)=>{var i=n(56694),r=n(74623),s=n(91963),o=n(7599),a=new i({Extends:r,initialize:function(t){r.call(this),this.checkQueue=!0,this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.systems.events.once(o.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(o.PRE_UPDATE,this.update,this),t.on(o.UPDATE,this.sceneUpdate,this),t.once(o.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var n=this._active,i=n.length,r=0;r<i;r++){var s=n[r];s.active&&s.preUpdate.call(s,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(o.PRE_UPDATE,this.update,this),e.off(o.UPDATE,this.sceneUpdate,this),e.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("UpdateList",a,"updateList"),t.exports=a},8810:t=>{t.exports=function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f){var m=n.x-e.displayOriginX+r,g=n.y-e.displayOriginY+s,v=m+n.w,y=g+n.h,x=o.getXRound(m,g,a),b=o.getYRound(m,g,a),w=o.getXRound(m,y,a),S=o.getYRound(m,y,a),_=o.getXRound(v,y,a),T=o.getYRound(v,y,a),E=o.getXRound(v,g,a),C=o.getYRound(v,g,a);t.batchQuad(e,x,b,w,S,_,T,E,C,i.u0,i.v0,i.u1,i.v1,c,l,u,h,d,p,f)}},82173:t=>{t.exports=function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i)return i={local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var r,s,o,a,c=t.text,l=c.length,u=t.maxWidth,h=t.wordWrapCharCode,d=Number.MAX_VALUE,p=Number.MAX_VALUE,f=0,m=0,g=t.fontData.chars,v=t.fontData.lineHeight,y=t.letterSpacing,x=t.lineSpacing,b=0,w=0,S=0,_=null,T=t._align,E=0,C=0,k=t.fontSize/t.fontData.size,A=k*t.scaleX,I=k*t.scaleY,O=null,R=0,N=[],M=Number.MAX_VALUE,D=0,P=0,F=0,L=[],B=[],z=null;if(u>0){for(r=0;r<l;r++)if(10!==(S=c.charCodeAt(r))){if(_=g[S]){if(null!==O)var U=_.kerning[R];S===h?null!==z&&(L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I,cr:!1}),z=null):(null===z&&(z={word:"",i:r,x:b,y:w,w:0,h:v,cr:!1}),z.word=z.word.concat(c[r]),z.w+=_.xOffset+_.xAdvance+(void 0!==U?U:0)),b+=_.xAdvance+y,O=_,R=S}}else null!==z&&(L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I,cr:!0}),z=null),b=0,w+=v+x,O=null;var j;null!==z&&L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I,cr:!1}),b=0,w=0,O=null,R=0;var V=0,W=[];for(r=0;r<L.length;r++){var G=L[r],q=G.x,H=G.x+G.w;j&&(V=q-(q-(j.x+j.w)+j.w),j=null),q-V>u||H-V>u?(W.push(G.i-1),G.cr?(W.push(G.i+G.word.length),V=0,j=null):j=G):G.cr&&(W.push(G.i+G.word.length),V=0,j=null)}for(r=W.length-1;r>=0;r--)s=c,o=W[r],a="\n",c=s.substr(0,o)+a+s.substr(o+1);i.wrappedText=c,l=c.length,L=[],z=null}var X=0;for(r=0;r<l;r++)if(10!==(S=c.charCodeAt(r))){if(_=g[S]){if(E=b,C=w,null!==O){var Y=_.kerning[R];E+=void 0!==Y?Y:0}d>E&&(d=E),p>C&&(p=C);var K=E+_.xAdvance,Q=C+v;f<K&&(f=K),m<Q&&(m=Q);var Z=_.xOffset+_.xAdvance+(void 0!==Y?Y:0);S===h?null!==z&&(L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I}),z=null):(null===z&&(z={word:"",i:X,x:b,y:w,w:0,h:v}),z.word=z.word.concat(c[r]),z.w+=Z),B.push({i:X,idx:r,char:c[r],code:S,x:(_.xOffset+E)*k,y:(_.yOffset+w)*k,w:_.width*k,h:_.height*k,t:w*k,r:K*k,b:v*k,line:P,glyph:_}),b+=_.xAdvance+y+(void 0!==Y?Y:0),O=_,R=S,F=K*k,X++}}else null!==z&&(L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I}),z=null),b=0,w+=v+x,O=null,N[P]=F,F>D&&(D=F),F<M&&(M=F),P++,F=0;if(null!==z&&L.push({word:z.word,i:z.i,x:z.x*A,y:z.y*I,w:z.w*A,h:z.h*I}),N[P]=F,F>D&&(D=F),F<M&&(M=F),T>0)for(var J=0;J<B.length;J++){var $=B[J];if(1===T){var tt=(D-N[$.line])/2;$.x+=tt,$.r+=tt}else if(2===T){var et=D-N[$.line];$.x+=et,$.r+=et}}var nt=i.local,it=i.global,rt=i.lines;return nt.x=d*k,nt.y=p*k,nt.width=f*k,nt.height=m*k,it.x=t.x-t._displayOriginX+d*A,it.y=t.y-t._displayOriginY+p*I,it.width=f*A,it.height=m*I,rt.shortest=M,rt.longest=D,rt.lengths=N,e&&(nt.x=Math.ceil(nt.x),nt.y=Math.ceil(nt.y),nt.width=Math.ceil(nt.width),nt.height=Math.ceil(nt.height),it.x=Math.ceil(it.x),it.y=Math.ceil(it.y),it.width=Math.ceil(it.width),it.height=Math.ceil(it.height),rt.shortest=Math.ceil(M),rt.longest=Math.ceil(D)),n&&(t._displayOriginX=t.originX*nt.width,t._displayOriginY=t.originY*nt.height,it.x=t.x-t._displayOriginX*t.scaleX,it.y=t.y-t._displayOriginY*t.scaleY,e&&(it.x=Math.ceil(it.x),it.y=Math.ceil(it.y))),i.words=L,i.characters=B,i.lines.height=v,i.scale=k,i.scaleX=t.scaleX,i.scaleY=t.scaleY,i}},68298:(t,e,n)=>{var i=n(31476);t.exports=function(t,e,n,r,s,o,a){var c=t.sys.textures.get(n),l=c.get(r),u=t.sys.cache.xml.get(s);if(l&&u){var h=i(u,l,o,a,c);return t.sys.cache.bitmapFont.add(e,{data:h,texture:n,frame:r,fromAtlas:!0}),!0}return!1}},39860:(t,e,n)=>{var i=n(10850);t.exports=function(t,e){var n=e.width,r=e.height,s=Math.floor(n/2),o=Math.floor(r/2),a=i(e,"chars","");if(""!==a){var c=i(e,"image",""),l=t.sys.textures.getFrame(c),u=l.cutX,h=l.cutY,d=l.source.width,p=l.source.height,f=i(e,"offset.x",0),m=i(e,"offset.y",0),g=i(e,"spacing.x",0),v=i(e,"spacing.y",0),y=i(e,"lineSpacing",0),x=i(e,"charsPerRow",null);null===x&&(x=d/n)>a.length&&(x=a.length);for(var b=f,w=m,S={retroFont:!0,font:c,size:n,lineHeight:r+y,chars:{}},_=0,T=0;T<a.length;T++){var E=a.charCodeAt(T),C=(u+b)/d,k=(h+w)/p,A=(u+b+n)/d,I=(h+w+r)/p;S.chars[E]={x:b,y:w,width:n,height:r,centerX:s,centerY:o,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{},u0:C,v0:k,u1:A,v1:I},++_===x?(_=0,b=f,w+=r+v):b+=n+g}return{data:S,frame:null,texture:c}}}},31476:t=>{function e(t,e){return parseInt(t.getAttribute(e),10)}t.exports=function(t,n,i,r,s){void 0===i&&(i=0),void 0===r&&(r=0);var o=n.cutX,a=n.cutY,c=n.source.width,l=n.source.height,u=n.sourceIndex,h={},d=t.getElementsByTagName("info")[0],p=t.getElementsByTagName("common")[0];h.font=d.getAttribute("face"),h.size=e(d,"size"),h.lineHeight=e(p,"lineHeight")+r,h.chars={};var f=t.getElementsByTagName("char"),m=void 0!==n&&n.trimmed;if(m)var g=n.height,v=n.width;for(var y=0;y<f.length;y++){var x=f[y],b=e(x,"id"),w=String.fromCharCode(b),S=e(x,"x"),_=e(x,"y"),T=e(x,"width"),E=e(x,"height");m&&(S<v&&(v=S),_<g&&(g=_)),m&&0!==g&&0!==v&&(S-=n.x,_-=n.y);var C=(o+S)/c,k=(a+_)/l,A=(o+S+T)/c,I=(a+_+E)/l;if(h.chars[b]={x:S,y:_,width:T,height:E,centerX:Math.floor(T/2),centerY:Math.floor(E/2),xOffset:e(x,"xoffset"),yOffset:e(x,"yoffset"),xAdvance:e(x,"xadvance")+i,data:{},kerning:{},u0:C,v0:k,u1:A,v1:I},s&&0!==T&&0!==E){var O=s.add(w,u,S,_,T,E);O&&O.setUVs(T,E,C,k,A,I)}}var R=t.getElementsByTagName("kerning");for(y=0;y<R.length;y++){var N=R[y],M=e(N,"first"),D=e(N,"second"),P=e(N,"amount");h.chars[D].kerning[M]=P}return h}},55873:(t,e,n)=>{var i=n(66863),r=n(98611),s={Parse:n(39860)};s=r(!1,s,i),t.exports=s},66863:t=>{t.exports={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}},13468:(t,e,n)=>{var i=n(44616),r=n(56694),s=n(88899),o=new r({Extends:i,Mixins:[s],initialize:function(t,e,n,r,s,o,a){i.call(this,t,e,n,r,s,o,a),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});t.exports=o},93438:(t,e,n)=>{var i=n(49584);t.exports=function(t,e,n,r){var s=e._text,o=s.length,a=t.currentContext;if(0!==o&&i(t,a,e,n,r)){n.addToRenderList(e);var c=e.fromAtlas?e.frame:e.texture.frames.__BASE,l=e.displayCallback,u=e.callbackData,h=e.fontData.chars,d=e.fontData.lineHeight,p=e._letterSpacing,f=0,m=0,g=0,v=null,y=0,x=0,b=0,w=0,S=0,_=0,T=null,E=0,C=e.frame.source.image,k=c.cutX,A=c.cutY,I=0,O=0,R=e._fontSize/e.fontData.size,N=e._align,M=0,D=0;e.getTextBounds(!1);var P=e._bounds.lines;1===N?D=(P.longest-P.lengths[0])/2:2===N&&(D=P.longest-P.lengths[0]),a.translate(-e.displayOriginX,-e.displayOriginY);var F=n.roundPixels;e.cropWidth>0&&e.cropHeight>0&&(a.beginPath(),a.rect(0,0,e.cropWidth,e.cropHeight),a.clip());for(var L=0;L<o;L++)if(O=R,I=0,10!==(g=s.charCodeAt(L))){if(v=h[g]){if(y=k+v.x,x=A+v.y,b=v.width,w=v.height,S=v.xOffset+f-e.scrollX,_=v.yOffset+m-e.scrollY,null!==T){var B=v.kerning[E];S+=void 0!==B?B:0}if(l){u.index=L,u.charCode=g,u.x=S,u.y=_,u.scale=O,u.rotation=I,u.data=v.data;var z=l(u);S=z.x,_=z.y,O=z.scale,I=z.rotation}S*=O,_*=O,S+=D,f+=v.xAdvance+p+(void 0!==B?B:0),T=v,E=g,0!==b&&0!==w&&32!==g&&(F&&(S=Math.round(S),_=Math.round(_)),a.save(),a.translate(S,_),a.rotate(I),a.scale(O,O),a.drawImage(C,y,x,b,w,0,0,b,w),a.restore())}}else M++,1===N?D=(P.longest-P.lengths[M])/2:2===N&&(D=P.longest-P.lengths[M]),f=0,m+=d,T=null;a.restore()}}},67513:(t,e,n)=>{var i=n(13468),r=n(88933),s=n(99325),o=n(20494);s.register("dynamicBitmapText",(function(t,e){void 0===t&&(t={});var n=o(t,"font",""),s=o(t,"text",""),a=o(t,"size",!1),c=new i(this.scene,0,0,n,s,a);return void 0!==e&&(t.add=e),r(this.scene,c,t),c}))},94145:(t,e,n)=>{var i=n(13468);n(61286).register("dynamicBitmapText",(function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,r,s))}))},88899:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(16873),s=n(93438),t.exports={renderWebGL:r,renderCanvas:s}},16873:(t,e,n)=>{var i=n(73329),r=n(69360),s=n(75512),o=new r;t.exports=function(t,e,n,r){var a=e.text,c=a.length;if(0!==c){n.addToRenderList(e);var l=t.pipelines.set(e.pipeline,e),u=i(e,n,r);t.pipelines.preBatch(e);var h=u.sprite,d=u.calc,p=o,f=e.cropWidth>0||e.cropHeight>0;f&&(l.flush(),t.pushScissor(d.tx,d.ty,e.cropWidth*d.scaleX,e.cropHeight*d.scaleY));var m,g,v=e.frame.glTexture,y=e.tintFill,x=s.getTintAppendFloatAlpha(e.tintTopLeft,n.alpha*e._alphaTL),b=s.getTintAppendFloatAlpha(e.tintTopRight,n.alpha*e._alphaTR),w=s.getTintAppendFloatAlpha(e.tintBottomLeft,n.alpha*e._alphaBL),S=s.getTintAppendFloatAlpha(e.tintBottomRight,n.alpha*e._alphaBR),_=l.setGameObject(e),T=0,E=0,C=0,k=0,A=e.letterSpacing,I=0,O=0,R=e.scrollX,N=e.scrollY,M=e.fontData,D=M.chars,P=M.lineHeight,F=e.fontSize/M.size,L=0,B=e._align,z=0,U=0,j=e.getTextBounds(!1);e.maxWidth>0&&(c=(a=j.wrappedText).length);var V=e._bounds.lines;1===B?U=(V.longest-V.lengths[0])/2:2===B&&(U=V.longest-V.lengths[0]);for(var W=n.roundPixels,G=e.displayCallback,q=e.callbackData,H=0;H<c;H++)if(10!==(C=a.charCodeAt(H))){if(m=D[C]){I=m.width,O=m.height;var X=m.xOffset+T-R,Y=m.yOffset+E-N;if(null!==g){var K=m.kerning[k];X+=void 0!==K?K:0}if(T+=m.xAdvance+A,g=m,k=C,0!==I&&0!==O&&32!==C){if(F=e.fontSize/e.fontData.size,L=0,G){q.color=0,q.tint.topLeft=x,q.tint.topRight=b,q.tint.bottomLeft=w,q.tint.bottomRight=S,q.index=H,q.charCode=C,q.x=X,q.y=Y,q.scale=F,q.rotation=L,q.data=m.data;var Q=G(q);X=Q.x,Y=Q.y,F=Q.scale,L=Q.rotation,Q.color?(x=Q.color,b=Q.color,w=Q.color,S=Q.color):(x=Q.tint.topLeft,b=Q.tint.topRight,w=Q.tint.bottomLeft,S=Q.tint.bottomRight),x=s.getTintAppendFloatAlpha(x,n.alpha*e._alphaTL),b=s.getTintAppendFloatAlpha(b,n.alpha*e._alphaTR),w=s.getTintAppendFloatAlpha(w,n.alpha*e._alphaBL),S=s.getTintAppendFloatAlpha(S,n.alpha*e._alphaBR)}X*=F,Y*=F,X-=e.displayOriginX,Y-=e.displayOriginY,X+=U,p.applyITRS(X,Y,L,F,F),d.multiply(p,h);var Z=m.u0,J=m.v0,$=m.u1,tt=m.v1,et=I,nt=O,it=h.e,rt=h.f,st=nt*h.c+h.e,ot=nt*h.d+h.f,at=et*h.a+nt*h.c+h.e,ct=et*h.b+nt*h.d+h.f,lt=et*h.a+h.e,ut=et*h.b+h.f;W&&(it=Math.round(it),rt=Math.round(rt),st=Math.round(st),ot=Math.round(ot),at=Math.round(at),ct=Math.round(ct),lt=Math.round(lt),ut=Math.round(ut)),l.shouldFlush(6)&&(l.flush(),_=l.setGameObject(e)),l.batchQuad(e,it,rt,st,ot,at,ct,lt,ut,Z,J,$,tt,x,b,w,S,y,v,_)}}}else z++,1===B?U=(V.longest-V.lengths[z])/2:2===B&&(U=V.longest-V.lengths[z]),T=0,E+=P,g=null;f&&(l.flush(),t.popScissor()),t.pipelines.postBatch(e)}}},44616:(t,e,n)=>{var i=n(56694),r=n(82897),s=n(64937),o=n(89980),a=n(82173),c=n(68298),l=n(31476),u=n(74118),h=n(84557),d=new i({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Texture,s.Tint,s.Transform,s.Visible,h],initialize:function(t,e,n,i,r,s,c){void 0===r&&(r=""),void 0===c&&(c=0),o.call(this,t,"BitmapText"),this.font=i;var l=this.scene.sys.cache.bitmapFont.get(i);l||console.warn("Invalid BitmapText key: "+i),this.fontData=l.data,this._text="",this._fontSize=s||this.fontData.size,this._letterSpacing=0,this._lineSpacing=0,this._align=c,this._bounds=a(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.fromAtlas=l.fromAtlas,this.setTexture(l.texture,l.frame),this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(),this.setText(r)},setLeftAlign:function(){return this._align=d.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=d.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=d.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setLineSpacing:function(t){return void 0===t&&(t=0),this.lineSpacing=t,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=.5),this.dropShadowX=t,this.dropShadowY=e,this.dropShadowColor=n,this.dropShadowAlpha=i,this},setCharacterTint:function(t,e,n,i,s,o,a){void 0===t&&(t=0),void 0===e&&(e=1),void 0===n&&(n=!1),void 0===i&&(i=-1),void 0===s&&(s=i,o=i,a=i);var c=this.text.length;-1===e&&(e=c),t<0&&(t=c+t),t=r(t,0,c-1);for(var l=r(t+e,t,c),u=this.charColors,h=t;h<l;h++){var d=u[h];if(-1===i)u[h]=null;else{var p=n?1:0;d?(d.tintEffect=p,d.tintTL=i,d.tintTR=s,d.tintBL=o,d.tintBR=a):u[h]={tintEffect:p,tintTL:i,tintTR:s,tintBL:o,tintBR:a}}}return this},setWordTint:function(t,e,n,i,r,s,o){void 0===e&&(e=1);for(var a=this.getTextBounds().words,c="number"===typeof t,l=0,u=0;u<a.length;u++){var h=a[u];if((c&&u===t||!c&&h.word===t)&&(this.setCharacterTint(h.i,h.word.length,n,i,r,s,o),++l===e))return this}return this},getTextBounds:function(t){var e=this._bounds;return(this._dirty||t||this.scaleX!==e.scaleX||this.scaleY!==e.scaleY)&&(a(this,t,!0,e),this._dirty=!1),e},getCharacterAt:function(t,e,n){for(var i=this.getLocalPoint(t,e,null,n),r=this.getTextBounds().characters,s=new u,o=0;o<r.length;o++){var a=r[o];if(s.setTo(a.x,a.t,a.r-a.x,a.b),s.contains(i.x,i.y))return a}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(t,e,n){if(void 0===e&&(e=this._fontSize),void 0===n&&(n=this._align),t!==this.font){var i=this.scene.sys.cache.bitmapFont.get(t);i&&(this.font=t,this.fontData=i.data,this._fontSize=e,this._align=n,this.fromAtlas=!0===i.fromAtlas,this.setTexture(i.texture,i.frame),a(this,!1,!0,this._bounds))}return this},setMaxWidth:function(t,e){return this._maxWidth=t,this._dirty=!0,void 0!==e&&(this.wordWrapCharCode=e),this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},lineSpacing:{set:function(t){this._lineSpacing=t,this._dirty=!0},get:function(){return this._lineSpacing}},maxWidth:{set:function(t){this._maxWidth=t,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},displayWidth:{get:function(){return this.width}},displayHeight:{get:function(){return this.height}},toJSON:function(){var t=s.ToJSON(this),e={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineSpacing:this.lineSpacing,align:this.align};return t.data=e,t},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});d.ALIGN_LEFT=0,d.ALIGN_CENTER=1,d.ALIGN_RIGHT=2,d.ParseFromAtlas=c,d.ParseXMLBitmapFont=l,t.exports=d},97545:(t,e,n)=>{var i=n(49584);t.exports=function(t,e,n,r){var s=e._text,o=s.length,a=t.currentContext;if(0!==o&&i(t,a,e,n,r)){n.addToRenderList(e);var c=e.fromAtlas?e.frame:e.texture.frames.__BASE,l=e.fontData.chars,u=e.fontData.lineHeight,h=e._letterSpacing,d=e._lineSpacing,p=0,f=0,m=0,g=null,v=0,y=0,x=0,b=0,w=0,S=0,_=null,T=0,E=c.source.image,C=c.cutX,k=c.cutY,A=e._fontSize/e.fontData.size,I=e._align,O=0,R=0,N=e.getTextBounds(!1);e.maxWidth>0&&(o=(s=N.wrappedText).length);var M=e._bounds.lines;1===I?R=(M.longest-M.lengths[0])/2:2===I&&(R=M.longest-M.lengths[0]),a.translate(-e.displayOriginX,-e.displayOriginY);for(var D=n.roundPixels,P=0;P<o;P++)if(10!==(m=s.charCodeAt(P))){if(g=l[m]){if(v=C+g.x,y=k+g.y,x=g.width,b=g.height,w=g.xOffset+p,S=g.yOffset+f,null!==_){var F=g.kerning[T];w+=void 0!==F?F:0}w*=A,S*=A,w+=R,p+=g.xAdvance+h+(void 0!==F?F:0),_=g,T=m,0!==x&&0!==b&&32!==m&&(D&&(w=Math.round(w),S=Math.round(S)),a.save(),a.translate(w,S),a.scale(A,A),a.drawImage(E,v,y,x,b,0,0,x,b),a.restore())}}else O++,1===I?R=(M.longest-M.lengths[O])/2:2===I&&(R=M.longest-M.lengths[O]),p=0,f+=u+d,_=null;a.restore()}}},95499:(t,e,n)=>{var i=n(44616),r=n(88933),s=n(99325),o=n(20494),a=n(10850);s.register("bitmapText",(function(t,e){void 0===t&&(t={});var n=a(t,"font",""),s=o(t,"text",""),c=o(t,"size",!1),l=a(t,"align",0),u=new i(this.scene,0,0,n,s,c,l);return void 0!==e&&(t.add=e),r(this.scene,u,t),u}))},21797:(t,e,n)=>{var i=n(44616);n(61286).register("bitmapText",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},84557:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(26372),s=n(97545),t.exports={renderWebGL:r,renderCanvas:s}},26372:(t,e,n)=>{var i=n(8810),r=n(73329),s=n(75512);t.exports=function(t,e,n,o){if(0!==e._text.length){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline,e),c=r(e,n,o).calc;t.pipelines.preBatch(e);var l,u,h,d=n.roundPixels,p=n.alpha,f=e.charColors,m=e.tintFill,g=s.getTintAppendFloatAlpha,v=g(e.tintTopLeft,p*e._alphaTL),y=g(e.tintTopRight,p*e._alphaTR),x=g(e.tintBottomLeft,p*e._alphaBL),b=g(e.tintBottomRight,p*e._alphaBR),w=e.frame.glTexture,S=a.setGameObject(e),_=e.getTextBounds(!1).characters,T=e.dropShadowX,E=e.dropShadowY;if(0!==T||0!==E){var C=e.dropShadowColor,k=e.dropShadowAlpha,A=g(C,p*k*e._alphaTL),I=g(C,p*k*e._alphaTR),O=g(C,p*k*e._alphaBL),R=g(C,p*k*e._alphaBR);for(l=0;l<_.length;l++)h=(u=_[l]).glyph,32!==u.code&&0!==h.width&&0!==h.height&&i(a,e,u,h,T,E,c,d,A,I,O,R,1,w,S)}for(l=0;l<_.length;l++)if(h=(u=_[l]).glyph,32!==u.code&&0!==h.width&&0!==h.height)if(a.shouldFlush(6)&&(a.flush(),S=a.setGameObject(e)),f[u.i]){var N=f[u.i],M=N.tintEffect,D=g(N.tintTL,p*e._alphaTL),P=g(N.tintTR,p*e._alphaTR),F=g(N.tintBL,p*e._alphaBL),L=g(N.tintBR,p*e._alphaBR);i(a,e,u,h,0,0,c,d,D,P,F,L,M,w,S)}else i(a,e,u,h,0,0,c,d,v,y,x,b,m,w,S);t.pipelines.postBatch(e)}}},52816:(t,e,n)=>{var i=n(92246),r=n(41664),s=n(56694),o=n(64937),a=n(82047),c=n(89980),l=n(71207),u=new s({Extends:c,Mixins:[o.Alpha,o.BlendMode,o.Depth,o.Mask,o.Pipeline,o.PostPipeline,o.ScrollFactor,o.Size,o.Texture,o.Transform,o.Visible,i],initialize:function(t,e,n,i,r){c.call(this,t,"Blitter"),this.setTexture(i,r),this.setPosition(e,n),this.initPipeline(),this.initPostPipeline(),this.children=new l,this.renderList=[],this.dirty=!1},create:function(t,e,n,i,s){void 0===i&&(i=!0),void 0===s&&(s=this.children.length),void 0===n?n=this.frame:n instanceof a||(n=this.texture.get(n));var o=new r(this,t,e,n,i);return this.children.addAt(o,s,!1),this.dirty=!0,o},createFromCallback:function(t,e,n,i){for(var r=this.createMultiple(e,n,i),s=0;s<r.length;s++){var o=r[s];t.call(this,o,s)}return r},createMultiple:function(t,e,n){void 0===e&&(e=this.frame.name),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var i=[],r=this;return e.forEach((function(e){for(var s=0;s<t;s++)i.push(r.create(0,0,e,n))})),i},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});t.exports=u},33177:t=>{t.exports=function(t,e,n,i){var r=e.getRenderList();if(0!==r.length){var s=t.currentContext,o=n.alpha*e.alpha;if(0!==o){n.addToRenderList(e),s.globalCompositeOperation=t.blendModes[e.blendMode],s.imageSmoothingEnabled=!e.frame.source.scaleMode;var a=e.x-n.scrollX*e.scrollFactorX,c=e.y-n.scrollY*e.scrollFactorY;s.save(),i&&i.copyToContext(s);for(var l=n.roundPixels,u=0;u<r.length;u++){var h=r[u],d=h.flipX||h.flipY,p=h.frame,f=p.canvasData,m=p.x,g=p.y,v=1,y=1,x=h.alpha*o;0!==x&&(s.globalAlpha=x,d?(h.flipX&&(v=-1,m-=f.width),h.flipY&&(y=-1,g-=f.height),f.width>0&&f.height>0&&(s.save(),s.translate(h.x+a,h.y+c),s.scale(v,y),s.drawImage(p.source.image,f.x,f.y,f.width,f.height,m,g,f.width,f.height),s.restore())):(l&&(m=Math.round(m),g=Math.round(g)),f.width>0&&f.height>0&&s.drawImage(p.source.image,f.x,f.y,f.width,f.height,m+h.x+a,g+h.y+c,f.width,f.height)))}s.restore()}}}},68452:(t,e,n)=>{var i=n(52816),r=n(88933),s=n(99325),o=n(20494);s.register("blitter",(function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),a=new i(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),r(this.scene,a,t),a}))},38906:(t,e,n)=>{var i=n(52816);n(61286).register("blitter",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},92246:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(89165),s=n(33177),t.exports={renderWebGL:r,renderCanvas:s}},89165:(t,e,n)=>{var i=n(69360),r=n(75512),s=new i;t.exports=function(t,e,n,i){var o=e.getRenderList(),a=n.alpha*e.alpha;if(0!==o.length&&0!==a){n.addToRenderList(e);var c=t.pipelines.set(this.pipeline,e),l=n.scrollX*e.scrollFactorX,u=n.scrollY*e.scrollFactorY,h=s.copyFrom(n.matrix);i&&(h.multiplyWithOffset(i,-l,-u),l=0,u=0);var d=e.x-l,p=e.y-u,f=-1;t.pipelines.preBatch(e);for(var m=0;m<o.length;m++){var g=o[m],v=g.frame,y=g.alpha*a;if(0!==y){var x=v.width,b=v.height,w=d+g.x+v.x,S=p+g.y+v.y;g.flipX&&(x*=-1,w+=v.width),g.flipY&&(b*=-1,S+=v.height);var _=h.setQuad(w,S,w+x,S+b),T=r.getTintAppendFloatAlpha(g.tint,y);if(v.sourceIndex!==f){var E=c.setGameObject(e,v);f=v.sourceIndex}c.batchQuad(e,_[0],_[1],_[2],_[3],_[4],_[5],_[6],_[7],v.u0,v.v0,v.u1,v.v1,T,T,T,T,!1,v.glTexture,E)&&(f=-1)}}t.pipelines.postBatch(e)}}},41664:(t,e,n)=>{var i=n(56694),r=n(82047),s=new i({initialize:function(t,e,n,i,r){this.parent=t,this.x=e,this.y=n,this.frame=i,this.data={},this.tint=16777215,this._visible=r,this._alpha=1,this.flipX=!1,this.flipY=!1,this.hasTransformComponent=!0},setFrame:function(t){return void 0===t?this.frame=this.parent.frame:t instanceof r&&t.texture===this.parent.texture?this.frame=t:this.frame=this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,n){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,n&&this.setFrame(n),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!==t>0,this._alpha=t}}});t.exports=s},97123:(t,e,n)=>{var i=n(82897),r={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,r){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(r,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,this._alphaBR=e,0===e?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);this._alphaTL=e,0!==e&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);this._alphaTR=e,0!==e&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);this._alphaBL=e,0!==e&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);this._alphaBR=e,0!==e&&(this.renderFlags|=2)}}};t.exports=r},15720:(t,e,n)=>{var i=n(82897),r={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,0===e?this.renderFlags&=-3:this.renderFlags|=2}}};t.exports=r},69732:(t,e,n)=>{var i=n(95723),r={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"===typeof t&&(t=i[t]),(t|=0)>=-1&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=r},28284:t=>{t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},85293:t=>{var e={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"===typeof t)this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=e},14975:t=>{var e={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}};t.exports=e},88677:(t,e,n)=>{var i=n(56694),r=n(96910),s=n(72677),o=new i({initialize:function(t,e){this.gameObject=t,this.isPost=e,this.enabled=!1,this.list=[],this.padding=0},setPadding:function(t){return void 0===t&&(t=0),this.padding=t,this.gameObject},onFXCopy:function(){},onFX:function(){},enable:function(t){if(!this.isPost){var e=this.gameObject.scene.sys.renderer;e&&e.pipelines?(this.gameObject.pipeline=e.pipelines.FX_PIPELINE,void 0!==t&&(this.padding=t),this.enabled=!0):this.enabled=!1}},clear:function(){if(this.isPost)this.gameObject.resetPostPipeline(!0);else{for(var t=this.list,e=0;e<t.length;e++)t[e].destroy();this.list=[]}return this.enabled=!1,this.gameObject},remove:function(t){var e;if(this.isPost){var n=this.gameObject.getPostPipeline(String(t.type));for(Array.isArray(n)||(n=[n]),e=0;e<n.length;e++){var i=n[e];if(i.controller===t){this.gameObject.removePostPipeline(i),t.destroy();break}}}else{var r=this.list;for(e=0;e<r.length;e++)r[e]===t&&(s(r,e),t.destroy())}return this.gameObject},disable:function(t){return void 0===t&&(t=!1),this.isPost||this.gameObject.resetPipeline(),this.enabled=!1,t&&this.clear(),this.gameObject},add:function(t,e){if(!this.isPost)return this.enabled||this.enable(),this.list.push(t),t;var n=String(t.type);this.gameObject.setPostPipeline(n,e);var i=this.gameObject.getPostPipeline(n);return i?(Array.isArray(i)&&(i=i.pop()),i.controller=t,t):void 0},addGlow:function(t,e,n,i,s,o){return this.add(new r.Glow(this.gameObject,t,e,n,i),{quality:s,distance:o})},addShadow:function(t,e,n,i,s,o,a){return this.add(new r.Shadow(this.gameObject,t,e,n,i,s,o,a))},addPixelate:function(t){return this.add(new r.Pixelate(this.gameObject,t))},addVignette:function(t,e,n,i){return this.add(new r.Vignette(this.gameObject,t,e,n,i))},addShine:function(t,e,n,i){return this.add(new r.Shine(this.gameObject,t,e,n,i))},addBlur:function(t,e,n,i,s,o){return this.add(new r.Blur(this.gameObject,t,e,n,i,s,o))},addGradient:function(t,e,n,i,s,o,a,c){return this.add(new r.Gradient(this.gameObject,t,e,n,i,s,o,a,c))},addBloom:function(t,e,n,i,s,o){return this.add(new r.Bloom(this.gameObject,t,e,n,i,s,o))},addColorMatrix:function(){return this.add(new r.ColorMatrix(this.gameObject))},addCircle:function(t,e,n,i,s){return this.add(new r.Circle(this.gameObject,t,e,n,i,s))},addBarrel:function(t){return this.add(new r.Barrel(this.gameObject,t))},addDisplacement:function(t,e,n){return this.add(new r.Displacement(this.gameObject,t,e,n))},addWipe:function(t,e,n){return this.add(new r.Wipe(this.gameObject,t,e,n))},addReveal:function(t,e,n){return this.add(new r.Wipe(this.gameObject,t,e,n,!0))},addBokeh:function(t,e,n){return this.add(new r.Bokeh(this.gameObject,t,e,n))},addTiltShift:function(t,e,n,i,s,o){return this.add(new r.Bokeh(this.gameObject,t,e,n,!0,i,s,o))},destroy:function(){this.clear(),this.gameObject=null}});t.exports=o},92972:t=>{t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},80693:(t,e,n)=>{var i=n(74118),r=n(2386),s=n(93736),o={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&r(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t,e){return void 0===t&&(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getTopLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,r,s,o,a,c,l;if(void 0===t&&(t=new i),this.parentContainer){var u=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(t),u.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),u.transformPoint(t.x,t.y,t),r=t.x,s=t.y,this.getBottomLeft(t),u.transformPoint(t.x,t.y,t),o=t.x,a=t.y,this.getBottomRight(t),u.transformPoint(t.x,t.y,t),c=t.x,l=t.y}else this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),r=t.x,s=t.y,this.getBottomLeft(t),o=t.x,a=t.y,this.getBottomRight(t),c=t.x,l=t.y;return t.x=Math.min(e,r,o,c),t.y=Math.min(n,s,a,l),t.width=Math.max(e,r,o,c)-t.x,t.height=Math.max(n,s,a,l)-t.y,t}};t.exports=o},39171:(t,e,n)=>{var i=n(76756),r=n(63037),s={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t,e,n,r,s){return void 0===t&&(this.texture||this.shader||this.geom)&&(t=this),new i(this.scene,t,e,n,r,s)},createGeometryMask:function(t){return void 0!==t||"Graphics"!==this.type&&!this.geom||(t=this),new r(this.scene,t)}};t.exports=s},28072:t=>{var e={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}};t.exports=e},54211:(t,e,n)=>{var i=n(75606),r=n(63130),s=n(10850),o=n(55303),a=n(93736),c={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:o.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"===typeof t&&(t={duration:t}),t.from=s(t,"from",0),t.to=s(t,"to",1);var c=r(t,"positionOnPath",!1);this.rotateToPath=r(t,"rotateToPath",!1),this.pathRotationOffset=s(t,"rotationOffset",0);var l=s(t,"startAt",e);if(l&&(t.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.setTargetValue()}),this.pathOffset||(this.pathOffset=new a(this.x,this.y)),this.pathVector||(this.pathVector=new a),this.pathDelta||(this.pathDelta=new a),this.pathDelta.reset(),t.persist=!0,this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),c&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=o.PLAYING_FORWARD,this.rotateToPath){var u=this.path.getPoint(.1);this.rotation=Math.atan2(u.y-this.y,u.x-this.x)+i(this.pathRotationOffset)}return this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t&&t.data){var e=t.data[0],n=this.pathDelta,r=this.pathVector;if(n.copy(r).negate(),e.state===o.COMPLETE)return this.path.getPoint(e.end,r),n.add(r),r.add(this.pathOffset),void this.setPosition(r.x,r.y);if(e.state!==o.PLAYING_FORWARD&&e.state!==o.PLAYING_BACKWARD)return;this.path.getPoint(t.getValue(),r),n.add(r),r.add(this.pathOffset);var s=this.x,a=this.y;this.setPosition(r.x,r.y);var c=this.x-s,l=this.y-a;if(0===c&&0===l)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(l,c)+i(this.pathRotationOffset))}}};t.exports=c},58210:(t,e,n)=>{var i=n(28699),r={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(t){this.pipelineData={};var e=this.scene.sys.renderer;if(!e)return!1;var n=e.pipelines;if(n){void 0===t&&(t=n.default);var i=n.get(t);if(i)return this.defaultPipeline=i,this.pipeline=i,!0}return!1},setPipeline:function(t,e,n){var r=this.scene.sys.renderer;if(!r)return this;var s=r.pipelines;if(s){var o=s.get(t);o&&(this.pipeline=o),e&&(this.pipelineData=n?i(e):e)}return this},setPipelineData:function(t,e){var n=this.pipelineData;return void 0===e?delete n[t]:n[t]=e,this},resetPipeline:function(t){return void 0===t&&(t=!1),this.pipeline=this.defaultPipeline,t&&(this.pipelineData={}),null!==this.pipeline},getPipelineName:function(){return this.pipeline.name}};t.exports=r},44086:(t,e,n)=>{var i=n(28699),r=n(88677),s=n(72677),o={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(t){this.postPipelines=[],this.postPipelineData={},this.postFX=new r(this,!0),t&&(this.preFX=new r(this,!1))},setPostPipeline:function(t,e,n){var r=this.scene.sys.renderer;if(!r)return this;var s=r.pipelines;if(s){Array.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++){var a=s.getPostPipeline(t[o],this,e);a&&this.postPipelines.push(a)}e&&(this.postPipelineData=n?i(e):e)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(t,e){var n=this.postPipelineData;return void 0===e?delete n[t]:n[t]=e,this},getPostPipeline:function(t){for(var e="string"===typeof t,n=this.postPipelines,i=[],r=0;r<n.length;r++){var s=n[r];(e&&s.name===t||!e&&s instanceof t)&&i.push(s)}return 1===i.length?i[0]:i},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,n=0;n<e.length;n++)e[n].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.postPipelineData={})},removePostPipeline:function(t){for(var e="string"===typeof t,n=this.postPipelines,i=n.length-1;i>=0;i--){var r=n[i];(e&&r.name===t||!e&&r===t)&&(r.destroy(),s(n,i))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};t.exports=o},45900:t=>{var e={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}};t.exports=e},31654:t=>{var e={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight;var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=e},82081:(t,e,n)=>{var i=n(82047),r={texture:null,frame:null,isCropped:!1,setTexture:function(t,e,n,i){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e,n,i)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),t instanceof i?(this.texture=this.scene.sys.textures.get(t.texture.key),this.frame=t):this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}};t.exports=r},21850:(t,e,n)=>{var i=n(82047),r={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"===typeof t)this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY);else{var r=t;this.frame.setCropUVs(this._crop,r.x,r.y,r.width,r.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),t instanceof i?(this.texture=this.scene.sys.textures.get(t.texture.key),this.frame=t):this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}};t.exports=r},58072:t=>{var e={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,n,i){return void 0===t&&(t=16777215),void 0===e&&(e=t,n=t,i=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=n,this.tintBottomRight=i,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}};t.exports=e},48129:t=>{t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},56584:(t,e,n)=>{var i=n(83392),r=n(69360),s=n(64462),o=n(35786),a=n(62138),c=n(93736),l={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:0!==this._scaleY&&(this.renderFlags|=4)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:0!==this._scaleX&&(this.renderFlags|=4)}},angle:{get:function(){return a(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=a(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=o(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new r),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new r);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(e||(e=new r),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getLocalPoint:function(t,e,n,i){n||(n=new c),i||(i=this.scene.sys.cameras.main);var r=i.scrollX,o=i.scrollY,a=t+r*this.scrollFactorX-r,l=e+o*this.scrollFactorY-o;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(a,l,n):s(a,l,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=l},69360:(t,e,n)=>{var i=n(56694),r=n(83392),s=n(93736),o=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),this.matrix=new Float32Array([t,e,n,i,r,s,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],s=t[3];return e||n?n>0?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||s?r.TAU-(s>0?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,r=i[0],s=i[1],o=i[2],a=i[3];return i[0]=r*n+o*e,i[1]=s*n+a*e,i[2]=r*-e+o*n,i[3]=s*-e+a*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,r=n[0],s=n[1],o=n[2],a=n[3],c=n[4],l=n[5],u=i[0],h=i[1],d=i[2],p=i[3],f=i[4],m=i[5],g=void 0===e?n:e.matrix;return g[0]=u*r+h*o,g[1]=u*s+h*a,g[2]=d*r+p*o,g[3]=d*s+p*a,g[4]=f*r+m*o+c,g[5]=f*s+m*a+l,g},multiplyWithOffset:function(t,e,n){var i=this.matrix,r=t.matrix,s=i[0],o=i[1],a=i[2],c=i[3],l=e*s+n*a+i[4],u=e*o+n*c+i[5],h=r[0],d=r[1],p=r[2],f=r[3],m=r[4],g=r[5];return i[0]=h*s+d*a,i[1]=h*o+d*c,i[2]=p*s+f*a,i[3]=p*o+f*c,i[4]=m*s+g*a+l,i[5]=m*o+g*c+u,this},transform:function(t,e,n,i,r,s){var o=this.matrix,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5];return o[0]=t*a+e*l,o[1]=t*c+e*u,o[2]=n*a+i*l,o[3]=n*c+i*u,o[4]=r*a+s*l+h,o[5]=r*c+s*u+d,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,r=i[0],s=i[1],o=i[2],a=i[3],c=i[4],l=i[5];return n.x=t*r+e*o+c,n.y=t*s+e*a+l,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=e*r-n*i;return t[0]=r/a,t[1]=-n/a,t[2]=-i/a,t[3]=e/a,t[4]=(i*o-r*s)/a,t[5]=-(e*o-n*s)/a,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){return t.setTransform(this),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,r,s){var o=this.matrix;return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o[4]=r,o[5]=s,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(t.translateX=e[4],t.translateY=e[5],n||i){var a=Math.sqrt(n*n+i*i);t.rotation=i>0?Math.acos(n/a):-Math.acos(n/a),t.scaleX=a,t.scaleY=o/a}else if(r||s){var c=Math.sqrt(r*r+s*s);t.rotation=.5*Math.PI-(s>0?Math.acos(-r/c):-Math.acos(r/c)),t.scaleX=o/c,t.scaleY=c}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,n,i,r){var s=this.matrix,o=Math.sin(n),a=Math.cos(n);return s[4]=t,s[5]=e,s[0]=a*i,s[1]=o*i,s[2]=-o*r,s[3]=a*r,this},applyInverse:function(t,e,n){void 0===n&&(n=new s);var i=this.matrix,r=i[0],o=i[1],a=i[2],c=i[3],l=i[4],u=i[5],h=1/(r*c+a*-o);return n.x=c*h*t+-a*h*e+(u*a-l*c)*h,n.y=r*h*e+-o*h*t+(-u*r+l*o)*h,n},setQuad:function(t,e,n,i,r,s){void 0===r&&(r=!1),void 0===s&&(s=this.quad);var o=this.matrix,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5];return r?(s[0]=Math.round(t*a+e*l+h),s[1]=Math.round(t*c+e*u+d),s[2]=Math.round(t*a+i*l+h),s[3]=Math.round(t*c+i*u+d),s[4]=Math.round(n*a+i*l+h),s[5]=Math.round(n*c+i*u+d),s[6]=Math.round(n*a+e*l+h),s[7]=Math.round(n*c+e*u+d)):(s[0]=t*a+e*l+h,s[1]=t*c+e*u+d,s[2]=t*a+i*l+h,s[3]=t*c+i*u+d,s[4]=n*a+i*l+h,s[5]=n*c+i*u+d,s[6]=n*a+e*l+h,s[7]=n*c+e*u+d),s},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,n){var i=this.getX(t,e);return n&&(i=Math.round(i)),i},getYRound:function(t,e,n){var i=this.getY(t,e);return n&&(i=Math.round(i)),i},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});t.exports=o},59694:t=>{var e={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}};t.exports=e},64937:(t,e,n)=>{t.exports={Alpha:n(97123),AlphaSingle:n(15720),BlendMode:n(69732),ComputedSize:n(28284),Crop:n(85293),Depth:n(14975),Flip:n(92972),FX:n(88677),GetBounds:n(80693),Mask:n(39171),Origin:n(28072),PathFollower:n(54211),Pipeline:n(58210),PostPipeline:n(44086),ScrollFactor:n(45900),Size:n(31654),Texture:n(82081),TextureCrop:n(21850),Tint:n(58072),ToJSON:n(48129),Transform:n(56584),TransformMatrix:n(69360),Visible:n(59694)}},70339:(t,e,n)=>{var i=n(59959),r=n(95723),s=n(56694),o=n(64937),a=n(56631),c=n(89980),l=n(74118),u=n(98524),h=n(58795),d=n(93736),p=new s({Extends:c,Mixins:[o.AlphaSingle,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.PostPipeline,o.Transform,o.Visible,u],initialize:function(t,e,n,i){c.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(e,n),this.setBlendMode(r.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new l),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);t.setTo(e.x,e.y,0,0)}if(this.list.length>0){var n=this.list,i=new l,r=!1;t.setEmpty();for(var s=0;s<n.length;s++){var o=n[s];o.getBounds&&(o.getBounds(i),r?h(i,t,t):(t.setTo(i.x,i.y,i.width,i.height),r=!0))}}return t},addHandler:function(t){t.once(a.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this,t.removeFromDisplayList(),t.addedToScene())},removeHandler:function(t){t.off(a.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer=null,t.removedFromScene(),t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new d),this.parentContainer?this.parentContainer.pointToContainer(t,e):(e.x=t.x,e.y=t.y);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e,n,r){return i.CountAllMatching(this.list,t,e,n,r)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},moveAbove:function(t,e){return i.MoveAbove(this.list,t,e),this},moveBelow:function(t,e){return i.MoveBelow(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++)n[r].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var r=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var s=0;s<r.length;s++)r[s].destroy();return this},removeAll:function(t){var e=this.list;if(t){for(var n=0;n<e.length;n++)e[n]&&e[n].scene&&(e[n].off(a.DESTROY,this.remove,this),e[n].destroy());this.list=[]}else i.RemoveBetween(e,0,e.length,this.removeHandler,this);return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){var n,i=[null],r=this.list.slice(),s=r.length;for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<s;n++)i[0]=r[n],t.apply(e,i);return this},iterate:function(t,e){var n,i=[null];for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}});t.exports=p},13916:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e);var r=e.list;if(0!==r.length){var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var o=-1!==e.blendMode;o||t.setBlendMode(0);var a=e._alpha,c=e.scrollFactorX,l=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var u=0;u<r.length;u++){var h=r[u];if(h.willRender(n)){var d=h.alpha,p=h.scrollFactorX,f=h.scrollFactorY;o||h.blendMode===t.currentBlendMode||t.setBlendMode(h.blendMode),h.setScrollFactor(p*c,f*l),h.setAlpha(d*a),h.renderCanvas(t,h,n,s),h.setAlpha(d),h.setScrollFactor(p,f)}}e.mask&&e.mask.postRenderCanvas(t)}}},44516:(t,e,n)=>{var i=n(88933),r=n(70339),s=n(99325),o=n(20494);s.register("container",(function(t,e){void 0===t&&(t={});var n=o(t,"x",0),s=o(t,"y",0),a=o(t,"children",null),c=new r(this.scene,n,s,a);return void 0!==e&&(t.add=e),i(this.scene,c,t),c}))},23400:(t,e,n)=>{var i=n(70339);n(61286).register("container",(function(t,e,n){return this.displayList.add(new i(this.scene,t,e,n))}))},98524:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(36934),s=n(13916),t.exports={renderWebGL:r,renderCanvas:s}},36934:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e);var r=e.list,s=r.length;if(0!==s){var o=e.localTransform;i?(o.loadIdentity(),o.multiply(i),o.translate(e.x,e.y),o.rotate(e.rotation),o.scale(e.scaleX,e.scaleY)):o.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var a=-1!==e.blendMode;a||t.setBlendMode(0);for(var c=e.alpha,l=e.scrollFactorX,u=e.scrollFactorY,h=0;h<s;h++){var d=r[h];if(d.willRender(n)){var p,f,m,g;if(void 0!==d.alphaTopLeft)p=d.alphaTopLeft,f=d.alphaTopRight,m=d.alphaBottomLeft,g=d.alphaBottomRight;else{var v=d.alpha;p=v,f=v,m=v,g=v}var y=d.scrollFactorX,x=d.scrollFactorY;a||d.blendMode===t.currentBlendMode||t.setBlendMode(d.blendMode);var b=d.mask;b&&b.preRenderWebGL(t,d,n);var w=d.type;w!==t.currentType&&(t.newType=!0,t.currentType=w),t.nextTypeMatch=h<s-1&&r[h+1].type===t.currentType,d.setScrollFactor(y*l,x*u),d.setAlpha(p*c,f*c,m*c,g*c),d.renderWebGL(t,d,n,o,e),d.setAlpha(p,f,m,g),d.setScrollFactor(y,x),b&&b.postRenderWebGL(t,n),t.newType=!1}}t.pipelines.postBatch(e)}}},2452:t=>{t.exports=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]},38943:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(11603),o=n(89980),a=n(42911),c=n(55638),l=n(7599),u=n(51729),h=new i({Extends:o,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Origin,r.ScrollFactor,r.Transform,r.Visible,s],initialize:function(t,e,n,i,r,s){o.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,this.cache=t.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new u,this.rotate3dAngle="deg",this.pointerEvents="auto",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,n),"string"===typeof i?"#"===i[0]?this.setElement(i.substr(1),r,s):this.createElement(i,r,s):i&&this.setElement(i,r,s),t.sys.events.on(l.SLEEP,this.handleSceneEvent,this),t.sys.events.on(l.WAKE,this.handleSceneEvent,this),t.sys.events.on(l.PRE_RENDER,this.preRender,this)},handleSceneEvent:function(t){var e=this.node,n=e.style;e&&(n.display=t.settings.visible?"block":"none")},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,n){return this.setElement(document.createElement(t),e,n)},setElement:function(t,e,n){var i;if(this.removeElement(),"string"===typeof t?("#"===t[0]&&(t=t.substr(1)),i=document.getElementById(t)):"object"===typeof t&&1===t.nodeType&&(i=t),!i)return this;if(this.node=i,e&&a(e))for(var r in e)i.style[r]=e[r];else"string"===typeof e&&(i.style=e);return i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent&&this.parent.appendChild(i),n&&(i.innerText=n),this.updateSize()},createFromCache:function(t,e){var n=this.cache.get(t);return n&&this.createFromHTML(n,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var n=document.createElement(e);return this.node=n,n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent&&this.parent.appendChild(n),n.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(c(this.node),this.node=null),this},updateSize:function(){var t=this.node,e=t.getBoundingClientRect();return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=e.width||0,this.displayHeight=e.height||0,this},getChildByProperty:function(t,e){if(this.node)for(var n=this.node.querySelectorAll("*"),i=0;i<n.length;i++)if(n[i][t]===e)return n[i];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preRender:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(l.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(l.WAKE,this.handleSceneEvent,this),this.scene.sys.events.off(l.PRE_RENDER,this.preRender,this)}});t.exports=h},66070:(t,e,n)=>{var i=n(2452),r=n(89980),s=n(69360),o=new s,a=new s,c=new s;t.exports=function(t,e,n,s){if(e.node){var l=e.node.style,u=e.scene.sys.settings;if(!l||!u.visible||r.RENDER_MASK!==e.renderFlags||0!==e.cameraFilter&&e.cameraFilter&n.id||e.parentContainer&&!e.parentContainer.willRender())l.display="none";else{var h=e.parentContainer,d=n.alpha*e.alpha;h&&(d*=h.alpha);var p=o,f=a,m=c,g=0,v=0,y="0%",x="0%";s?(g=e.width*e.scaleX*e.originX,v=e.height*e.scaleY*e.originY,f.applyITRS(e.x-g,e.y-v,e.rotation,e.scaleX,e.scaleY),p.copyFrom(n.matrix),p.multiplyWithOffset(s,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),f.e=e.x-g,f.f=e.y-v,p.multiply(f,m)):(g=e.width*e.originX,v=e.height*e.originY,f.applyITRS(e.x-g,e.y-v,e.rotation,e.scaleX,e.scaleY),p.copyFrom(n.matrix),y=100*e.originX+"%",x=100*e.originY+"%",f.e-=n.scrollX*e.scrollFactorX,f.f-=n.scrollY*e.scrollFactorY,p.multiply(f,m)),e.transformOnly||(l.display="block",l.opacity=d,l.zIndex=e._depth,l.pointerEvents=e.pointerEvents,l.mixBlendMode=i[e._blendMode]),l.transform=m.getCSSMatrix()+" skew("+e.skewX+"rad, "+e.skewY+"rad) rotate3d("+e.rotate3d.x+","+e.rotate3d.y+","+e.rotate3d.z+","+e.rotate3d.w+e.rotate3dAngle+")",l.transformOrigin=y+" "+x}}}},66788:(t,e,n)=>{var i=n(38943);n(61286).register("dom",(function(t,e,n,r,s){var o=new i(this.scene,t,e,n,r,s);return this.displayList.add(o),o}))},11603:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(66070),s=n(66070),t.exports={renderWebGL:r,renderCanvas:s}},65492:t=>{t.exports="addedtoscene"},98398:t=>{t.exports="destroy"},40239:t=>{t.exports="removedfromscene"},17286:t=>{t.exports="complete"},31496:t=>{t.exports="created"},89587:t=>{t.exports="error"},59792:t=>{t.exports="locked"},96342:t=>{t.exports="loop"},6017:t=>{t.exports="playing"},49614:t=>{t.exports="play"},24418:t=>{t.exports="seeked"},87318:t=>{t.exports="seeking"},50009:t=>{t.exports="stalled"},61922:t=>{t.exports="stop"},79501:t=>{t.exports="textureready"},4052:t=>{t.exports="unlocked"},54857:t=>{t.exports="unsupported"},56631:(t,e,n)=>{t.exports={ADDED_TO_SCENE:n(65492),DESTROY:n(98398),REMOVED_FROM_SCENE:n(40239),VIDEO_COMPLETE:n(17286),VIDEO_CREATED:n(31496),VIDEO_ERROR:n(89587),VIDEO_LOCKED:n(59792),VIDEO_LOOP:n(96342),VIDEO_PLAY:n(49614),VIDEO_PLAYING:n(6017),VIDEO_SEEKED:n(24418),VIDEO_SEEKING:n(87318),VIDEO_STALLED:n(50009),VIDEO_STOP:n(61922),VIDEO_TEXTURE:n(79501),VIDEO_UNLOCKED:n(4052),VIDEO_UNSUPPORTED:n(54857)}},39419:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(79394),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.Origin,r.ScrollFactor,r.Size,r.Texture,r.Tint,r.Transform,r.Visible,o],initialize:function(t){s.call(this,t,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});t.exports=a},96699:()=>{},41155:(t,e,n)=>{var i=n(39419);n(61286).register("extern",(function(){var t=new i(this.scene);return this.displayList.add(t),t}))},79394:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(81410),s=n(96699),t.exports={renderWebGL:r,renderCanvas:s}},81410:(t,e,n)=>{var i=n(73329);t.exports=function(t,e,n,r){t.pipelines.clear();var s=i(e,n,r).calc;e.render.call(e,t,n,s),t.pipelines.rebind()}},36266:t=>{t.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}},33182:(t,e,n)=>{var i=n(51052),r=n(56694),s=n(36266),o=n(64937),a=n(95669),c=n(89980),l=n(72632),u=n(10850),h=n(83392),d=n(60898),p=new r({Extends:c,Mixins:[o.AlphaSingle,o.BlendMode,o.Depth,o.Mask,o.Pipeline,o.PostPipeline,o.Transform,o.Visible,o.ScrollFactor,d],initialize:function(t,e){var n=u(e,"x",0),i=u(e,"y",0);c.call(this,t,"Graphics"),this.setPosition(n,i),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(e)},setDefaultStyles:function(t){return u(t,"lineStyle",null)&&(this.defaultStrokeWidth=u(t,"lineStyle.width",1),this.defaultStrokeColor=u(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=u(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),u(t,"fillStyle",null)&&(this.defaultFillColor=u(t,"fillStyle.color",16777215),this.defaultFillAlpha=u(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(s.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(s.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,i,r,o,a,c){return void 0===r&&(r=1),void 0===o&&(o=r),void 0===a&&(a=r),void 0===c&&(c=r),this.commandBuffer.push(s.GRADIENT_FILL_STYLE,r,o,a,c,t,e,n,i),this},lineGradientStyle:function(t,e,n,i,r,o){return void 0===o&&(o=1),this.commandBuffer.push(s.GRADIENT_LINE_STYLE,t,o,e,n,i,r),this},beginPath:function(){return this.commandBuffer.push(s.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(s.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(s.FILL_PATH),this},fill:function(){return this.commandBuffer.push(s.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(s.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(s.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,h.PI2),this.fillPath(),this},strokeCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,h.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,i){return this.commandBuffer.push(s.FILL_RECT,t,e,n,i),this},strokeRect:function(t,e,n,i){var r=this._lineWidth/2,s=t-r,o=t+r;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+i),this.strokePath(),this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+n,e+i),this.strokePath(),this.beginPath(),this.moveTo(s,e),this.lineTo(o+n,e),this.strokePath(),this.beginPath(),this.moveTo(s,e+i),this.lineTo(o+n,e+i),this.strokePath(),this},fillRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,c=r;"number"!==typeof r&&(s=l(r,"tl",20),o=l(r,"tr",20),a=l(r,"bl",20),c=l(r,"br",20));var u=s>=0,d=o>=0,p=a>=0,f=c>=0;return s=Math.abs(s),o=Math.abs(o),a=Math.abs(a),c=Math.abs(c),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),d?this.arc(t+n-o,e+o,o,-h.TAU,0):this.arc(t+n,e,o,Math.PI,h.TAU,!0),this.lineTo(t+n,e+i-c),f?this.arc(t+n-c,e+i-c,c,0,h.TAU):this.arc(t+n,e+i,c,-h.TAU,Math.PI,!0),this.lineTo(t+a,e+i),p?this.arc(t+a,e+i-a,a,h.TAU,Math.PI):this.arc(t,e+i,a,0,-h.TAU,!0),this.lineTo(t,e+s),u?this.arc(t+s,e+s,s,-Math.PI,-h.TAU):this.arc(t,e,s,h.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,c=r,u=Math.min(n,i)/2;"number"!==typeof r&&(s=l(r,"tl",20),o=l(r,"tr",20),a=l(r,"bl",20),c=l(r,"br",20));var d=s>=0,p=o>=0,f=a>=0,m=c>=0;return s=Math.min(Math.abs(s),u),o=Math.min(Math.abs(o),u),a=Math.min(Math.abs(a),u),c=Math.min(Math.abs(c),u),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),this.moveTo(t+n-o,e),p?this.arc(t+n-o,e+o,o,-h.TAU,0):this.arc(t+n,e,o,Math.PI,h.TAU,!0),this.lineTo(t+n,e+i-c),this.moveTo(t+n,e+i-c),m?this.arc(t+n-c,e+i-c,c,0,h.TAU):this.arc(t+n,e+i,c,-h.TAU,Math.PI,!0),this.lineTo(t+a,e+i),this.moveTo(t+a,e+i),f?this.arc(t+a,e+i-a,a,h.TAU,Math.PI):this.arc(t,e+i,a,0,-h.TAU,!0),this.lineTo(t,e+s),this.moveTo(t,e+s),d?this.arc(t+s,e+s,s,-Math.PI,-h.TAU):this.arc(t,e,s,h.TAU,0,!0),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(s.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.FILL_TRIANGLE,t,e,n,i,r,o),this},strokeTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.STROKE_TRIANGLE,t,e,n,i,r,o),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,n,i){return this.beginPath(),this.moveTo(t,e),this.lineTo(n,i),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(s.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(s.MOVE_TO,t,e),this},strokePoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.strokePoints(n,!0)},strokeEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new a(t,e,n,i).getPoints(r);return this.strokePoints(s,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.fillPoints(n,!0)},fillEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new a(t,e,n,i).getPoints(r);return this.fillPoints(s,!0)},arc:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this},slice:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.BEGIN_PATH),this.commandBuffer.push(s.MOVE_TO,t,e),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this.commandBuffer.push(s.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(s.SAVE),this},restore:function(){return this.commandBuffer.push(s.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(s.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(s.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(s.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,n){var i,r,s=this.scene.sys,o=s.game.renderer;void 0===e&&(e=s.scale.width),void 0===n&&(n=s.scale.height),p.TargetCamera.setScene(this.scene),p.TargetCamera.setViewport(0,0,e,n),p.TargetCamera.scrollX=this.x,p.TargetCamera.scrollY=this.y;var a={willReadFrequently:!0};if("string"===typeof t)if(s.textures.exists(t)){var c=(i=s.textures.get(t)).getSourceImage();c instanceof HTMLCanvasElement&&(r=c.getContext("2d",a))}else r=(i=s.textures.createCanvas(t,e,n)).getSourceImage().getContext("2d",a);else t instanceof HTMLCanvasElement&&(r=t.getContext("2d",a));return r&&(this.renderCanvas(o,this,p.TargetCamera,null,r,!1),i&&i.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});p.TargetCamera=new i,t.exports=p},91543:(t,e,n)=>{var i=n(36266),r=n(49584);t.exports=function(t,e,n,s,o,a){var c=e.commandBuffer,l=c.length,u=o||t.currentContext;if(0!==l&&r(t,u,e,n,s)){n.addToRenderList(e);var h=1,d=1,p=0,f=0,m=1,g=0,v=0,y=0;u.beginPath();for(var x=0;x<l;++x)switch(c[x]){case i.ARC:u.arc(c[x+1],c[x+2],c[x+3],c[x+4],c[x+5],c[x+6]),x+=7;break;case i.LINE_STYLE:m=c[x+1],p=c[x+2],h=c[x+3],g=(16711680&p)>>>16,v=(65280&p)>>>8,y=255&p,u.strokeStyle="rgba("+g+","+v+","+y+","+h+")",u.lineWidth=m,x+=3;break;case i.FILL_STYLE:f=c[x+1],d=c[x+2],g=(16711680&f)>>>16,v=(65280&f)>>>8,y=255&f,u.fillStyle="rgba("+g+","+v+","+y+","+d+")",x+=2;break;case i.BEGIN_PATH:u.beginPath();break;case i.CLOSE_PATH:u.closePath();break;case i.FILL_PATH:a||u.fill();break;case i.STROKE_PATH:a||u.stroke();break;case i.FILL_RECT:a?u.rect(c[x+1],c[x+2],c[x+3],c[x+4]):u.fillRect(c[x+1],c[x+2],c[x+3],c[x+4]),x+=4;break;case i.FILL_TRIANGLE:u.beginPath(),u.moveTo(c[x+1],c[x+2]),u.lineTo(c[x+3],c[x+4]),u.lineTo(c[x+5],c[x+6]),u.closePath(),a||u.fill(),x+=6;break;case i.STROKE_TRIANGLE:u.beginPath(),u.moveTo(c[x+1],c[x+2]),u.lineTo(c[x+3],c[x+4]),u.lineTo(c[x+5],c[x+6]),u.closePath(),a||u.stroke(),x+=6;break;case i.LINE_TO:u.lineTo(c[x+1],c[x+2]),x+=2;break;case i.MOVE_TO:u.moveTo(c[x+1],c[x+2]),x+=2;break;case i.LINE_FX_TO:u.lineTo(c[x+1],c[x+2]),x+=5;break;case i.MOVE_FX_TO:u.moveTo(c[x+1],c[x+2]),x+=5;break;case i.SAVE:u.save();break;case i.RESTORE:u.restore();break;case i.TRANSLATE:u.translate(c[x+1],c[x+2]),x+=2;break;case i.SCALE:u.scale(c[x+1],c[x+2]),x+=2;break;case i.ROTATE:u.rotate(c[x+1]),x+=1;break;case i.GRADIENT_FILL_STYLE:x+=5;break;case i.GRADIENT_LINE_STYLE:x+=6}u.restore()}}},41286:(t,e,n)=>{var i=n(99325),r=n(33182);i.register("graphics",(function(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var n=new r(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n}))},13122:(t,e,n)=>{var i=n(33182);n(61286).register("graphics",(function(t){return this.displayList.add(new i(this.scene,t))}))},60898:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(34429),s=n(91543),s=n(91543),t.exports={renderWebGL:r,renderCanvas:s}},34429:(t,e,n)=>{var i=n(36266),r=n(73329),s=n(69360),o=n(75512),a=function(t,e,n){this.x=t,this.y=e,this.width=n},c=function(t,e,n){this.points=[],this.pointsLength=1,this.points[0]=new a(t,e,n)},l=[],u=new s;t.exports=function(t,e,n,s){if(0!==e.commandBuffer.length){n.addToRenderList(e);var h=t.pipelines.set(e.pipeline,e);t.pipelines.preBatch(e);for(var d=r(e,n,s).calc,p=u.loadIdentity(),f=e.commandBuffer,m=n.alpha*e.alpha,g=1,v=h.fillTint,y=h.strokeTint,x=0,b=0,w=0,S=2*Math.PI,_=[],T=0,E=!0,C=null,k=o.getTintAppendFloatAlpha,A=0;A<f.length;A++)switch(f[A]){case i.BEGIN_PATH:_.length=0,C=null,E=!0;break;case i.CLOSE_PATH:E=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case i.FILL_PATH:for(T=0;T<_.length;T++)h.batchFillPath(_[T].points,p,d);break;case i.STROKE_PATH:for(T=0;T<_.length;T++)h.batchStrokePath(_[T].points,g,E,p,d);break;case i.LINE_STYLE:g=f[++A];var I=k(f[++A],f[++A]*m);y.TL=I,y.TR=I,y.BL=I,y.BR=I;break;case i.FILL_STYLE:var O=k(f[++A],f[++A]*m);v.TL=O,v.TR=O,v.BL=O,v.BR=O;break;case i.GRADIENT_FILL_STYLE:var R=f[++A]*m,N=f[++A]*m,M=f[++A]*m,D=f[++A]*m;v.TL=k(f[++A],R),v.TR=k(f[++A],N),v.BL=k(f[++A],M),v.BR=k(f[++A],D);break;case i.GRADIENT_LINE_STYLE:g=f[++A];var P=f[++A]*m;y.TL=k(f[++A],P),y.TR=k(f[++A],P),y.BL=k(f[++A],P),y.BR=k(f[++A],P);break;case i.ARC:var F=0,L=f[++A],B=f[++A],z=f[++A],U=f[++A],j=f[++A],V=f[++A],W=f[++A];for(j-=U,V?j<-S?j=-S:j>0&&(j=j%S-S):j>S?j=S:j<0&&(j=S+j%S),null===C&&(C=new c(L+Math.cos(U)*z,B+Math.sin(U)*z,g),_.push(C),F+=.01);F<1+W;)w=j*F+U,x=L+Math.cos(w)*z,b=B+Math.sin(w)*z,C.points.push(new a(x,b,g)),F+=.01;w=j+U,x=L+Math.cos(w)*z,b=B+Math.sin(w)*z,C.points.push(new a(x,b,g));break;case i.FILL_RECT:h.batchFillRect(f[++A],f[++A],f[++A],f[++A],p,d);break;case i.FILL_TRIANGLE:h.batchFillTriangle(f[++A],f[++A],f[++A],f[++A],f[++A],f[++A],p,d);break;case i.STROKE_TRIANGLE:h.batchStrokeTriangle(f[++A],f[++A],f[++A],f[++A],f[++A],f[++A],g,p,d);break;case i.LINE_TO:null!==C?C.points.push(new a(f[++A],f[++A],g)):(C=new c(f[++A],f[++A],g),_.push(C));break;case i.MOVE_TO:C=new c(f[++A],f[++A],g),_.push(C);break;case i.SAVE:l.push(p.copyToArray());break;case i.RESTORE:p.copyFromArray(l.pop());break;case i.TRANSLATE:L=f[++A],B=f[++A],p.translate(L,B);break;case i.SCALE:L=f[++A],B=f[++A],p.scale(L,B);break;case i.ROTATE:p.rotate(f[++A])}t.pipelines.postBatch(e)}}},59192:(t,e,n)=>{var i=n(83979),r=n(56694),s=n(56631),o=n(6659),a=n(71608),c=n(72632),l=n(10850),u=n(19256),h=n(42911),d=n(75757),p=n(58403),f=n(13747),m=new r({Extends:o,initialize:function(t,e,n){o.call(this),n?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?h(e[0])&&(n=e,e=null):h(e)&&(n=e,e=null),this.scene=t,this.children=new p,this.isParent=!0,this.type="Group",this.classType=c(n,"classType",f),this.name=c(n,"name",""),this.active=c(n,"active",!0),this.maxSize=c(n,"maxSize",-1),this.defaultKey=c(n,"defaultKey",null),this.defaultFrame=c(n,"defaultFrame",null),this.runChildUpdate=c(n,"runChildUpdate",!1),this.createCallback=c(n,"createCallback",null),this.removeCallback=c(n,"removeCallback",null),this.createMultipleCallback=c(n,"createMultipleCallback",null),this.internalCreateCallback=c(n,"internalCreateCallback",null),this.internalRemoveCallback=c(n,"internalRemoveCallback",null),e&&this.addMultiple(e),n&&this.createMultiple(n),this.on(s.ADDED_TO_SCENE,this.addedToScene,this),this.on(s.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,n,i,r,s){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultKey),void 0===i&&(i=this.defaultFrame),void 0===r&&(r=!0),void 0===s&&(s=!0),this.isFull())return null;var o=new this.classType(this.scene,t,e,n,i);return o.addToDisplayList(this.scene.sys.displayList),o.addToUpdateList(),o.visible=r,o.setActive(s),this.add(o),o},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var n=0;n<t.length;n++){var i=this.createFromConfig(t[n]);e=e.concat(i)}return e},createFromConfig:function(t){if(this.isFull())return[];this.classType=c(t,"classType",this.classType);var e=c(t,"key",void 0),n=c(t,"frame",null),r=c(t,"visible",!0),s=c(t,"active",!0),o=[];if(void 0===e)return o;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var a=c(t,"repeat",0),h=c(t,"randomKey",!1),p=c(t,"randomFrame",!1),f=c(t,"yoyo",!1),m=c(t,"quantity",!1),g=c(t,"frameQuantity",1),v=c(t,"max",0),y=d(e,n,{max:v,qty:m||g,random:h,randomB:p,repeat:a,yoyo:f});t.createCallback&&(this.createCallback=t.createCallback),t.removeCallback&&(this.removeCallback=t.removeCallback),t.internalCreateCallback&&(this.internalCreateCallback=t.internalCreateCallback),t.internalRemoveCallback&&(this.internalRemoveCallback=t.internalRemoveCallback);for(var x=0;x<y.length;x++){var b=this.create(0,0,y[x].a,y[x].b,r,s);if(!b)break;o.push(b)}if(u(t,"setXY")){var w=l(t,"setXY.x",0),S=l(t,"setXY.y",0),_=l(t,"setXY.stepX",0),T=l(t,"setXY.stepY",0);i.SetXY(o,w,S,_,T)}if(u(t,"setRotation")){var E=l(t,"setRotation.value",0),C=l(t,"setRotation.step",0);i.SetRotation(o,E,C)}if(u(t,"setScale")){var k=l(t,"setScale.x",1),A=l(t,"setScale.y",k),I=l(t,"setScale.stepX",0),O=l(t,"setScale.stepY",0);i.SetScale(o,k,A,I,O)}if(u(t,"setOrigin")){var R=l(t,"setOrigin.x",.5),N=l(t,"setOrigin.y",R),M=l(t,"setOrigin.stepX",0),D=l(t,"setOrigin.stepY",0);i.SetOrigin(o,R,N,M,D)}if(u(t,"setAlpha")){var P=l(t,"setAlpha.value",1),F=l(t,"setAlpha.step",0);i.SetAlpha(o,P,F)}if(u(t,"setDepth")){var L=l(t,"setDepth.value",0),B=l(t,"setDepth.step",0);i.SetDepth(o,L,B)}if(u(t,"setScrollFactor")){var z=l(t,"setScrollFactor.x",1),U=l(t,"setScrollFactor.y",z),j=l(t,"setScrollFactor.stepX",0),V=l(t,"setScrollFactor.stepY",0);i.SetScrollFactor(o,z,U,j,V)}var W=c(t,"hitArea",null),G=c(t,"hitAreaCallback",null);W&&i.SetHitArea(o,W,G);var q=c(t,"gridAlign",!1);return q&&i.GridAlign(o,q),this.createMultipleCallback&&this.createMultipleCallback.call(this,o),o},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var n=this.children.entries.slice(),i=0;i<n.length;i++){var r=n[i];r.active&&r.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(s.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var n=0;n<t.length;n++)this.add(t[n],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(s.DESTROY,this.remove,this),n?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,i=0;i<n.size;i++){var r=n.entries[i];r.off(s.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,n,i){return a(this.children.entries,t,e,n,i)},getFirst:function(t,e,n,i,r,s,o){return this.getHandler(!0,1,t,e,n,i,r,s,o)},getFirstNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!0,t,e,n,i,r,s,o,a)},getLast:function(t,e,n,i,r,s,o){return this.getHandler(!1,1,t,e,n,i,r,s,o)},getLastNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!1,t,e,n,i,r,s,o,a)},getHandler:function(t,e,n,i,r,s,o,a,c){var l,u;void 0===n&&(n=!1),void 0===i&&(i=!1);var h=0,d=this.children.entries;if(t)for(u=0;u<d.length;u++)if((l=d[u]).active===n){if(++h===e)break}else l=null;else for(u=d.length-1;u>=0;u--)if((l=d[u]).active===n){if(++h===e)break}else l=null;return l?("number"===typeof r&&(l.x=r),"number"===typeof s&&(l.y=s),l):i?this.create(r,s,o,a,c):null},get:function(t,e,n,i,r){return this.getFirst(!1,!0,t,e,n,i,r)},getFirstAlive:function(t,e,n,i,r,s){return this.getFirst(!0,t,e,n,i,r,s)},getFirstDead:function(t,e,n,i,r,s){return this.getFirst(!1,t,e,n,i,r,s)},playAnimation:function(t,e){return i.PlayAnimation(this.children.entries,t,e),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,n=0;n<this.children.size;n++)this.children.entries[n].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(t,e,n,r,s){return i.PropertyValueSet(this.children.entries,t,e,n,r,s),this},propertyValueInc:function(t,e,n,r,s){return i.PropertyValueInc(this.children.entries,t,e,n,r,s),this},setX:function(t,e){return i.SetX(this.children.entries,t,e),this},setY:function(t,e){return i.SetY(this.children.entries,t,e),this},setXY:function(t,e,n,r){return i.SetXY(this.children.entries,t,e,n,r),this},incX:function(t,e){return i.IncX(this.children.entries,t,e),this},incY:function(t,e){return i.IncY(this.children.entries,t,e),this},incXY:function(t,e,n,r){return i.IncXY(this.children.entries,t,e,n,r),this},shiftPosition:function(t,e,n){return i.ShiftPosition(this.children.entries,t,e,n),this},angle:function(t,e){return i.Angle(this.children.entries,t,e),this},rotate:function(t,e){return i.Rotate(this.children.entries,t,e),this},rotateAround:function(t,e){return i.RotateAround(this.children.entries,t,e),this},rotateAroundDistance:function(t,e,n){return i.RotateAroundDistance(this.children.entries,t,e,n),this},setAlpha:function(t,e){return i.SetAlpha(this.children.entries,t,e),this},setTint:function(t,e,n,r){return i.SetTint(this.children.entries,t,e,n,r),this},setOrigin:function(t,e,n,r){return i.SetOrigin(this.children.entries,t,e,n,r),this},scaleX:function(t,e){return i.ScaleX(this.children.entries,t,e),this},scaleY:function(t,e){return i.ScaleY(this.children.entries,t,e),this},scaleXY:function(t,e,n,r){return i.ScaleXY(this.children.entries,t,e,n,r),this},setDepth:function(t,e){return i.SetDepth(this.children.entries,t,e),this},setBlendMode:function(t){return i.SetBlendMode(this.children.entries,t),this},setHitArea:function(t,e){return i.SetHitArea(this.children.entries,t,e),this},shuffle:function(){return i.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(t,e,n){return i.SetVisible(this.children.entries,t,e,n),this},toggleVisible:function(){return i.ToggleVisible(this.children.entries),this},destroy:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.scene&&!this.ignoreDestroy&&(this.emit(s.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});t.exports=m},61295:(t,e,n)=>{var i=n(99325),r=n(59192);i.register("group",(function(t){return new r(this.scene,null,t)}))},62598:(t,e,n)=>{var i=n(59192);n(61286).register("group",(function(t,e){return this.updateList.add(new i(this.scene,t,e))}))},1539:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(57322),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Size,r.TextureCrop,r.Tint,r.Transform,r.Visible,o],initialize:function(t,e,n,i,r){s.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(i,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});t.exports=a},57786:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},83556:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(1539);r.register("image",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),a=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,a,t),a}))},20927:(t,e,n)=>{var i=n(1539);n(61286).register("image",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},57322:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(59390),s=n(57786),t.exports={renderWebGL:r,renderCanvas:s}},59390:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e),this.pipeline.batchSprite(e,n,i)}},48013:(t,e,n)=>{var i={Events:n(56631),DisplayList:n(91713),GameObjectCreator:n(99325),GameObjectFactory:n(61286),UpdateList:n(92034),Components:n(64937),GetCalcMatrix:n(73329),BuildGameObject:n(88933),BuildGameObjectAnimation:n(32291),GameObject:n(89980),BitmapText:n(44616),Blitter:n(52816),Bob:n(41664),Container:n(70339),DOMElement:n(38943),DynamicBitmapText:n(13468),Extern:n(39419),Graphics:n(33182),Group:n(59192),Image:n(1539),Layer:n(85305),Particles:n(27684),PathFollower:n(29598),RenderTexture:n(15996),RetroFont:n(55873),Rope:n(79968),Sprite:n(13747),Text:n(76555),GetTextSize:n(32979),MeasureText:n(27030),TextStyle:n(74744),TileSprite:n(35856),Zone:n(71030),Video:n(8630),Shape:n(91461),Arc:n(28593),Curve:n(15220),Ellipse:n(28591),Grid:n(39169),IsoBox:n(4415),IsoTriangle:n(65159),Line:n(579),Polygon:n(91249),Rectangle:n(517),Star:n(77843),Triangle:n(21873),Factories:{Blitter:n(38906),Container:n(23400),DOMElement:n(66788),DynamicBitmapText:n(94145),Extern:n(41155),Graphics:n(13122),Group:n(62598),Image:n(20927),Layer:n(17676),Particles:n(81212),PathFollower:n(19626),RenderTexture:n(29599),Rope:n(31982),Sprite:n(66135),StaticBitmapText:n(21797),Text:n(94627),TileSprite:n(20509),Zone:n(34546),Video:n(215),Arc:n(10369),Curve:n(10147),Ellipse:n(99869),Grid:n(9326),IsoBox:n(88154),IsoTriangle:n(67765),Line:n(85665),Polygon:n(88203),Rectangle:n(94355),Star:n(23962),Triangle:n(79296)},Creators:{Blitter:n(68452),Container:n(44516),DynamicBitmapText:n(67513),Graphics:n(41286),Group:n(61295),Image:n(83556),Layer:n(56378),Particles:n(765),RenderTexture:n(85692),Rope:n(96027),Sprite:n(89219),StaticBitmapText:n(95499),Text:n(75397),TileSprite:n(63950),Zone:n(24067),Video:n(65601)}};i.Shader=n(27902),i.Mesh=n(83321),i.NineSlice=n(44139),i.PointLight=n(13171),i.Plane=n(33412),i.Factories.Shader=n(51979),i.Factories.Mesh=n(8767),i.Factories.NineSlice=n(53778),i.Factories.PointLight=n(91201),i.Factories.Plane=n(58322),i.Creators.Shader=n(13908),i.Creators.Mesh=n(41839),i.Creators.NineSlice=n(40964),i.Creators.PointLight=n(162),i.Creators.Plane=n(10912),i.Light=n(14455),i.LightsManager=n(26193),i.LightsPlugin=n(50296),t.exports=i},85305:(t,e,n)=>{var i=n(95723),r=n(56694),s=n(64937),o=n(48129),a=n(81078),c=n(6659),l=n(56631),u=n(71207),h=n(47427),d=n(58010),p=n(7599),f=n(17922),m=new r({Extends:u,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Mask,s.PostPipeline,s.Visible,c,d],initialize:function(t,e){u.call(this,t),c.call(this),this.scene=t,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=t.sys,this.events=t.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPostPipeline(),this.clearAlpha(),this.setBlendMode(i.SKIP_CHECK),e&&this.add(e),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new a(this)),this},setData:function(t,e){return this.data||(this.data=new a(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new a(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new a(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new a(this)),this.data.get(t)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},add:function(t){return u.prototype.add.call(this,t),this},remove:function(t,e){var n=u.prototype.remove.call(this,t);if(e&&n){Array.isArray(n)||(n=[n]);for(var i=0;i<n.length;i++)n[i].destroy()}return this},removeAll:function(t){var e=this.list;if(t){for(var n=0;n<e.length;n++)e[n]&&e[n].scene&&(e[n].off(l.DESTROY,this.remove,this),e[n].destroy());this.list=[]}else h(e,0,e.length,this.removeChildCallback,this);return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return o(this)},willRender:function(t){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return n.unshift(this.displayList.getIndex(t)),n},addChildCallback:function(t){t.once(l.DESTROY,this.remove,this),t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(l.ADDED_TO_SCENE,t,this.scene),this.events.emit(p.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){t.off(l.DESTROY,this.remove,this),this.queueDepthSort(),t.displayList=null,t.emit(l.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(p.REMOVED_FROM_SCENE,t,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(f(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(l.ADDED_TO_SCENE,this,this.scene),t.events.emit(p.ADDED_TO_SCENE,this,this.scene)),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(l.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(p.REMOVED_FROM_SCENE,this,this.scene)),this},destroy:function(t){if(this.scene&&!this.ignoreDestroy){this.emit(l.DESTROY,this);for(var e=this.list;e.length;)e[0].destroy(t);this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}});t.exports=m},834:t=>{t.exports=function(t,e,n){var i=e.list;if(0!==i.length){e.depthSort();var r=-1!==e.blendMode;r||t.setBlendMode(0);var s=e._alpha;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var o=0;o<i.length;o++){var a=i[o];if(a.willRender(n)){var c=a.alpha;r||a.blendMode===t.currentBlendMode||t.setBlendMode(a.blendMode),a.setAlpha(c*s),a.renderCanvas(t,a,n),a.setAlpha(c)}}e.mask&&e.mask.postRenderCanvas(t)}}},56378:(t,e,n)=>{var i=n(88933),r=n(85305),s=n(99325),o=n(20494);s.register("layer",(function(t,e){void 0===t&&(t={});var n=o(t,"children",null),s=new r(this.scene,n);return void 0!==e&&(t.add=e),i(this.scene,s,t),s}))},17676:(t,e,n)=>{var i=n(85305);n(61286).register("layer",(function(t){return this.displayList.add(new i(this.scene,t))}))},58010:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(17576),s=n(834),t.exports={renderWebGL:r,renderCanvas:s}},17576:t=>{t.exports=function(t,e,n){var i=e.list,r=i.length;if(0!==r){e.depthSort(),t.pipelines.preBatch(e);var s=-1!==e.blendMode;s||t.setBlendMode(0);for(var o=e.alpha,a=0;a<r;a++){var c=i[a];if(c.willRender(n)){var l,u,h,d;if(void 0!==c.alphaTopLeft)l=c.alphaTopLeft,u=c.alphaTopRight,h=c.alphaBottomLeft,d=c.alphaBottomRight;else{var p=c.alpha;l=p,u=p,h=p,d=p}s||c.blendMode===t.currentBlendMode||t.setBlendMode(c.blendMode);var f=c.mask;f&&f.preRenderWebGL(t,c,n);var m=c.type;m!==t.currentType&&(t.newType=!0,t.currentType=m),t.nextTypeMatch=a<r-1&&i[a+1].type===t.currentType,c.setAlpha(l*o,u*o,h*o,d*o),c.renderWebGL(t,c,n),c.setAlpha(l,u,h,d),f&&f.postRenderWebGL(t,n),t.newType=!1}}t.pipelines.postBatch(e)}}},14455:(t,e,n)=>{var i=n(26673),r=n(56694),s=n(64937),o=n(39298),a=n(75512),c=new r({Extends:i,Mixins:[s.Origin,s.ScrollFactor,s.Transform,s.Visible],initialize:function(t,e,n,r,s,a,c){i.call(this,t,e,n),this.color=new o(r,s,a),this.intensity=c,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1),this.setOrigin(),this.setDisplayOrigin(n)},displayWidth:{get:function(){return this.diameter},set:function(t){this.diameter=t}},displayHeight:{get:function(){return this.diameter},set:function(t){this.diameter=t}},width:{get:function(){return this.diameter},set:function(t){this.diameter=t}},height:{get:function(){return this.diameter},set:function(t){this.diameter=t}},willRender:function(t){return!(c.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setColor:function(t){var e=a.getFloatsFromUintRGB(t);return this.color.set(e[0],e[1],e[2]),this},setIntensity:function(t){return this.intensity=t,this},setRadius:function(t){return this.radius=t,this}});c.RENDER_MASK=15,t.exports=c},26193:(t,e,n)=>{var i=n(26535),r=n(56694),s=n(53996),o=n(14455),a=n(13171),c=n(39298),l=n(72677),u=n(17922),h=n(75512),d=new r({initialize:function(){this.lights=[],this.ambientColor=new c(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(t,e,n,i,r,s){return this.systems.displayList.add(new a(this.scene,t,e,n,i,r,s))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(t){for(var e=this.lights,n=t.worldView,r=[],o=0;o<e.length;o++){var a=e[o];a.willRender(t)&&i(a,n)&&r.push({light:a,distance:s(a.x,a.y,n.centerX,n.centerY)})}return r.length>this.maxLights&&(u(r,this.sortByDistance),r=r.slice(0,this.maxLights)),this.visibleLights=r.length,r},sortByDistance:function(t,e){return t.distance>=e.distance},setAmbientColor:function(t){var e=h.getFloatsFromUintRGB(t);return this.ambientColor.set(e[0],e[1],e[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=128),void 0===i&&(i=16777215),void 0===r&&(r=1);var s=h.getFloatsFromUintRGB(i),a=new o(t,e,n,s[0],s[1],s[2],r);return this.lights.push(a),a},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&l(this.lights,e),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}});t.exports=d},50296:(t,e,n)=>{var i=n(56694),r=n(26193),s=n(91963),o=n(7599),a=new i({Extends:r,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(o.BOOT,this.boot,this),r.call(this)},boot:function(){var t=this.systems.events;t.on(o.SHUTDOWN,this.shutdown,this),t.on(o.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});s.register("LightsPlugin",a,"lights"),t.exports=a},83321:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(75606),o=n(18693),a=n(89980),c=n(53267),l=n(67623),u=n(73329),h=n(16650),d=n(23464),p=n(23701),f=n(17922),m=n(70015),g=n(85769),v=new i({Extends:a,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Size,r.Texture,r.Transform,r.Visible,d],initialize:function(t,e,n,i,r,s,o,c,l,u,d,p){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i="__WHITE"),a.call(this,t,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new m,this.modelScale=new m(1,1,1),this.modelRotation=new m,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new h,this.viewPosition=new m,this.viewMatrix=new h,this.projectionMatrix=new h,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1,this.fov,this.displayOriginX=0,this.displayOriginY=0;var f=t.sys.renderer;this.setPosition(e,n),this.setTexture(i,r),this.setSize(f.width,f.height),this.initPipeline(),this.initPostPipeline(),this.setPerspective(f.width,f.height),s&&this.addVertices(s,o,c,l,u,d,p)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(t){return this.viewPosition.addScale(m.LEFT,t),this.dirtyCache[10]=1,this},panY:function(t){return this.viewPosition.y+=m.DOWN.y*t,this.dirtyCache[10]=1,this},panZ:function(t){return this.viewPosition.z+=t,this.dirtyCache[10]=1,this},setPerspective:function(t,e,n,i,r){return void 0===n&&(n=45),void 0===i&&(i=.01),void 0===r&&(r=1e3),this.fov=n,this.projectionMatrix.perspective(s(n),t/e,i,r),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(t,e,n,i){return void 0===t&&(t=this.scene.sys.renderer.getAspectRatio()),void 0===e&&(e=1),void 0===n&&(n=-1e3),void 0===i&&(i=1e3),this.fov=0,this.projectionMatrix.ortho(-t,t,-e,e,n,i),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach((function(t){t.destroy()})),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(t,e,n,i,r,s,o,a,l){var u,h=this.scene.sys.cache.obj.get(t);return h&&(u=c(h,this,e,n,i,r,s,o,a,l)),u&&0!==u.verts.length||console.warn("Mesh.addVerticesFromObj data empty:",t),this},sortByDepth:function(t,e){return t.depth-e.depth},depthSort:function(){return f(this.faces,this.sortByDepth),this},addVertex:function(t,e,n,i,r,s,o){var a=new g(t,e,n,i,r,s,o);return this.vertices.push(a),a},addFace:function(t,e,n){var i=new o(t,e,n);return this.faces.push(i),this.dirtyCache[9]=-1,i},addVertices:function(t,e,n,i,r,s,o){var a=l(t,e,n,i,r,s,o);return a?(this.faces=this.faces.concat(a.faces),this.vertices=this.vertices.concat(a.vertices)):console.warn("Mesh.addVertices data empty or invalid"),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(t){return this.faces[t]},hasFaceAt:function(t,e,n){void 0===n&&(n=this.scene.sys.cameras.main);for(var i=u(this,n).calc,r=this.faces,s=0;s<r.length;s++)if(r[s].contains(t,e,i))return!0;return!1},getFaceAt:function(t,e,n){void 0===n&&(n=this.scene.sys.cameras.main);for(var i=u(this,n).calc,r=this.faces,s=[],o=0;o<r.length;o++){var a=r[o];a.contains(t,e,i)&&s.push(a)}return f(s,this.sortByDepth)},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebug:null,this},isDirty:function(){var t=this.modelPosition,e=this.modelRotation,n=this.modelScale,i=this.dirtyCache,r=t.x,s=t.y,o=t.z,a=e.x,c=e.y,l=e.z,u=n.x,h=n.y,d=n.z,p=this.getFaceCount(),f=i[0],m=i[1],g=i[2],v=i[3],y=i[4],x=i[5],b=i[6],w=i[7],S=i[8],_=i[9];return i[0]=r,i[1]=s,i[2]=o,i[3]=a,i[4]=c,i[5]=l,i[6]=u,i[7]=h,i[8]=d,i[9]=p,f!==r||m!==s||g!==o||v!==a||y!==c||x!==l||b!==u||w!==h||S!==d||_!==p},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var t=this.dirtyCache;if(this.ignoreDirtyCache||t[10]||this.isDirty()){var e=this.width,n=this.height,i=this.viewMatrix,r=this.viewPosition;t[10]&&(i.identity(),i.translate(r),i.invert(),t[10]=0);var s=this.transformMatrix;s.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var o=r.z,a=this.faces,c=0;c<a.length;c++)a[c].transformCoordinatesLocal(s,e,n,o);this.depthSort()}},renderDebug:function(t,e){for(var n=t.debugGraphic,i=0;i<e.length;i++){var r=e[i],s=r.vertex1.tx,o=r.vertex1.ty,a=r.vertex2.tx,c=r.vertex2.ty,l=r.vertex3.tx,u=r.vertex3.ty;n.strokeTriangle(s,o,a,c,l,u)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null},clearTint:function(){return this.setTint()},setInteractive:function(){var t=function(t,e,n){for(var i=this.faces,r=0;r<i.length;r++)if(i[r].contains(e,n))return!0;return!1}.bind(this);return this.scene.sys.input.enable(this,t),this},setTint:function(t){void 0===t&&(t=16777215);for(var e=this.vertices,n=0;n<e.length;n++)e[n].color=t;return this},uvScroll:function(t,e){for(var n=this.faces,i=0;i<n.length;i++)n[i].scrollUV(t,e);return this},uvScale:function(t,e){for(var n=this.faces,i=0;i<n.length;i++)n[i].scaleUV(t,e);return this},tint:{set:function(t){this.setTint(t)}},rotateX:{get:function(){return p(this.modelRotation.x)},set:function(t){this.modelRotation.x=s(t)}},rotateY:{get:function(){return p(this.modelRotation.y)},set:function(t){this.modelRotation.y=s(t)}},rotateZ:{get:function(){return p(this.modelRotation.z)},set:function(t){this.modelRotation.z=s(t)}}});t.exports=v},6317:t=>{t.exports=function(){}},41839:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(10850),a=n(83321);r.register("mesh",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),c=o(t,"vertices",[]),l=o(t,"uvs",[]),u=o(t,"indicies",[]),h=o(t,"containsZ",!1),d=o(t,"normals",[]),p=o(t,"colors",16777215),f=o(t,"alphas",1),m=new a(this.scene,0,0,n,r,c,l,u,h,d,p,f);return void 0!==e&&(t.add=e),i(this.scene,m,t),m}))},8767:(t,e,n)=>{var i=n(83321);n(61286).register("mesh",(function(t,e,n,r,s,o,a,c,l,u,h){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,c,l,u,h))}))},23464:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(57410),s=n(6317),t.exports={renderWebGL:r,renderCanvas:s}},57410:(t,e,n)=>{var i=n(73329);t.exports=function(t,e,n,r){var s=e.faces,o=s.length;if(0!==o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline,e),c=i(e,n,r).calc;t.pipelines.preBatch(e);for(var l=a.setGameObject(e),u=a.vertexViewF32,h=a.vertexViewU32,d=a.vertexCount*a.currentShader.vertexComponentCount-1,p=e.tintFill,f=[],m=e.debugCallback,g=c.a,v=c.b,y=c.c,x=c.d,b=c.e,w=c.f,S=e.viewPosition.z,_=e.hideCCW,T=n.roundPixels,E=n.alpha*e.alpha,C=0,k=0;k<o;k++){var A=s[k];A.isInView(n,_,S,E,g,v,y,x,b,w,T)&&(a.shouldFlush(3)&&(a.flush(),l=a.setGameObject(e),d=0),d=A.load(u,h,d,l,p),C++,a.vertexCount+=3,a.currentBatch.count=a.vertexCount-a.currentBatch.start,m&&f.push(A))}e.totalFrame+=C,m&&m.call(e,e,f),t.pipelines.postBatch(e)}}},44139:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(94456),a=n(85769),c=new i({Extends:s,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Texture,r.Transform,r.Visible,o],initialize:function(t,e,n,i,r,o,c,l,u,h,d){s.call(this,t,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var p=t.textures.getFrame(i,r);this.is3Slice=!h&&!d,p.scale9&&(this.is3Slice=p.is3Slice);for(var f=this.is3Slice?18:54,m=0;m<f;m++)this.vertices.push(new a);this.setPosition(e,n),this.setTexture(i,r),this.setSlices(o,c,l,u,h,d,!1),this.setOrigin(.5,.5),this.initPipeline(),this.initPostPipeline()},setSlices:function(t,e,n,i,r,s,o){void 0===n&&(n=10),void 0===i&&(i=10),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=!1);var a=this.frame,c=!1;if(this.is3Slice&&o&&0!==r&&0!==s&&(c=!0),c)console.warn("Cannot change 9 slice to 3 slice");else{if(a.scale9&&!o){var l=a.data.scale9Borders,u=l.x,h=l.y;n=u,i=a.width-l.w-u,r=h,s=a.height-l.h-h,void 0===t&&(t=a.width),void 0===e&&(e=a.height)}else void 0===t&&(t=256),void 0===e&&(e=256);this._width=t,this._height=e,this.leftWidth=n,this.rightWidth=i,this.topHeight=r,this.bottomHeight=s,this.is3Slice&&(e=a.height,this._height=e,this.topHeight=e,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var t=this.leftWidth,e=this.rightWidth,n=this.topHeight,i=this.bottomHeight,r=this.frame.width,s=this.frame.height;this.updateQuadUVs(0,0,0,t/r,n/s),this.updateQuadUVs(6,t/r,0,1-e/r,n/s),this.updateQuadUVs(12,1-e/r,0,1,n/s),this.is3Slice||(this.updateQuadUVs(18,0,n/s,t/r,1-i/s),this.updateQuadUVs(24,t/r,n/s,1-e/r,1-i/s),this.updateQuadUVs(30,1-e/r,n/s,1,1-i/s),this.updateQuadUVs(36,0,1-i/s,t/r,1),this.updateQuadUVs(42,t/r,1-i/s,1-e/r,1),this.updateQuadUVs(48,1-e/r,1-i/s,1,1))},updateVertices:function(){var t=this.leftWidth,e=this.rightWidth,n=this.topHeight,i=this.bottomHeight,r=this.width,s=this.height;this.updateQuad(0,-.5,.5,t/r-.5,.5-n/s),this.updateQuad(6,t/r-.5,.5,.5-e/r,.5-n/s),this.updateQuad(12,.5-e/r,.5,.5,.5-n/s),this.is3Slice||(this.updateQuad(18,-.5,.5-n/s,t/r-.5,i/s-.5),this.updateQuad(24,t/r-.5,.5-n/s,.5-e/r,i/s-.5),this.updateQuad(30,.5-e/r,.5-n/s,.5,i/s-.5),this.updateQuad(36,-.5,i/s-.5,t/r-.5,-.5),this.updateQuad(42,t/r-.5,i/s-.5,.5-e/r,-.5),this.updateQuad(48,.5-e/r,i/s-.5,.5,-.5))},updateQuad:function(t,e,n,i,r){var s=this.width,o=this.height,a=this.originX,c=this.originY,l=this.vertices;l[t+0].resize(e,n,s,o,a,c),l[t+1].resize(e,r,s,o,a,c),l[t+2].resize(i,n,s,o,a,c),l[t+3].resize(e,r,s,o,a,c),l[t+4].resize(i,r,s,o,a,c),l[t+5].resize(i,n,s,o,a,c)},updateQuadUVs:function(t,e,n,i,r){var s=this.vertices,o=this.frame,a=o.u0,c=o.v0,l=o.u1,u=o.v1;if(0!==a||1!==l){var h=l-a;e=a+e*h,i=a+i*h}if(0!==c||1!==u){var d=u-c;n=c+n*d,r=c+r*d}s[t+0].setUVs(e,n),s[t+1].setUVs(e,r),s[t+2].setUVs(i,n),s[t+3].setUVs(e,r),s[t+4].setUVs(i,r),s[t+5].setUVs(i,n)},clearTint:function(){return this.setTint(16777215),this},setTint:function(t){return void 0===t&&(t=16777215),this.tint=t,this.tintFill=!1,this},setTintFill:function(t){return this.setTint(t),this.tintFill=!0,this},isTinted:{get:function(){return 16777215!==this.tint}},width:{get:function(){return this._width},set:function(t){this._width=Math.max(t,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(t){this.is3Slice||(this._height=Math.max(t,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){this.width=t,this.height=e;var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=this.width,n.hitArea.height=this.height),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},originX:{get:function(){return this._originX},set:function(t){this._originX=t,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(t){this._originY=t,this.updateVertices()}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this._originX=t,this._originY=e,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var t=this.frame.height;this._height=t,this.topHeight=t,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});t.exports=c},40964:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(10850),a=n(44139);r.register("nineslice",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),c=o(t,"width",256),l=o(t,"height",256),u=o(t,"leftWidth",10),h=o(t,"rightWidth",10),d=o(t,"topHeight",0),p=o(t,"bottomHeight",0),f=new a(this.scene,0,0,n,r,c,l,u,h,d,p);return void 0!==e&&(t.add=e),i(this.scene,f,t),f}))},53778:(t,e,n)=>{var i=n(44139);n(61286).register("nineslice",(function(t,e,n,r,s,o,a,c,l,u){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,c,l,u))}))},94456:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(27420),t.exports={renderWebGL:r,renderCanvas:s}},27420:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){var o=e.vertices,a=o.length;if(0!==a){n.addToRenderList(e);var c=t.pipelines.set(e.pipeline,e),l=i(e,n,s,!1).calc;t.pipelines.preBatch(e);var u=c.setGameObject(e),h=c.vertexViewF32,d=c.vertexViewU32,p=c.vertexCount*c.currentShader.vertexComponentCount-1,f=n.roundPixels,m=e.tintFill,g=n.alpha*e.alpha,v=r.getTintAppendFloatAlpha(e.tint,g),y=c.vertexAvailable(),x=-1;y<a&&(x=y);for(var b=0;b<a;b++){var w=o[b];b===x&&(c.flush(),u=c.setGameObject(e),p=0),h[++p]=l.getXRound(w.vx,w.vy,f),h[++p]=l.getYRound(w.vx,w.vy,f),h[++p]=w.u,h[++p]=w.v,h[++p]=u,h[++p]=m,d[++p]=v,c.vertexCount++,c.currentBatch.count=c.vertexCount-c.currentBatch.start}t.pipelines.postBatch(e)}}},19737:(t,e,n)=>{var i=n(56694),r=n(93025),s=n(22946),o=n(21902),a=n(4840),c=n(15978),l=new i({Extends:r,initialize:function(t){r.call(this,t,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return null===this.propertyValue?0:9},setMethods:function(){var t=this.propertyValue,e=t,n=this.defaultEmit,i=this.defaultUpdate;if(9===this.method){this.start=t[0],this.ease=o("Linear"),this.interpolation=a("linear"),n=this.easedValueEmit,i=this.easeValueUpdate,e=t[0],this.active=!0;for(var r=0;r<t.length;r++){var s=c(t[r]);this.r.push(s.r),this.g.push(s.g),this.b.push(s.b)}}return this.onEmit=n,this.onUpdate=i,this.current=e,this},setEase:function(t){this.easeName=t,this.ease=o(t)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(t,e,n){var i=this.ease(n),r=this.interpolation(this.r,i),o=this.interpolation(this.g,i),a=this.interpolation(this.b,i),c=s(r,o,a);return this.current=c,c}});t.exports=l},93025:(t,e,n)=>{var i=n(17489),r=n(82897),s=n(56694),o=n(61616),a=n(21902),c=n(72632),l=n(4840),u=n(88462),h=n(1071),d=new s({initialize:function(t,e,n){void 0===n&&(n=!1),this.propertyKey=t,this.propertyValue=e,this.defaultValue=e,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=n,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=c(t,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(t){var e;switch(this.method){case 1:case 3:case 8:e=t;break;case 2:this.propertyValue.indexOf(t)>=0&&(e=t);break;case 4:var n=(this.end-this.start)/this.steps;e=u(t,n),this.counter=e;break;case 5:case 6:case 7:e=r(t,this.start,this.end);break;case 9:e=this.start[0]}return this.current=e,this},getMethod:function(){var t=this.propertyValue;if(null===t)return 0;var e=typeof t;if("number"===e)return 1;if(Array.isArray(t))return 2;if("function"===e)return 3;if("object"===e){if(this.hasBoth(t,"start","end"))return this.has(t,"steps")?4:5;if(this.hasBoth(t,"min","max"))return 6;if(this.has(t,"random"))return 7;if(this.hasEither(t,"onEmit","onUpdate"))return 8;if(this.hasEither(t,"values","interpolation"))return 9}return 0},setMethods:function(){var t=this.propertyValue,e=t,n=this.defaultEmit,i=this.defaultUpdate;switch(this.method){case 1:n=this.staticValueEmit;break;case 2:n=this.randomStaticValueEmit,e=t[0];break;case 3:this._onEmit=t,n=this.proxyEmit;break;case 4:this.start=t.start,this.end=t.end,this.steps=t.steps,this.counter=this.start,this.yoyo=!!this.has(t,"yoyo")&&t.yoyo,this.direction=0,n=this.steppedEmit,e=this.start;break;case 5:this.start=t.start,this.end=t.end;var r=this.has(t,"ease")?t.ease:"Linear";this.ease=a(r,t.easeParams),n=this.has(t,"random")&&t.random?this.randomRangedValueEmit:this.easedValueEmit,i=this.easeValueUpdate,e=this.start;break;case 6:this.start=t.min,this.end=t.max,n=this.has(t,"int")&&t.int?this.randomRangedIntEmit:this.randomRangedValueEmit,e=this.start;break;case 7:var s=t.random;Array.isArray(s)&&(this.start=s[0],this.end=s[1]),n=this.randomRangedIntEmit,e=this.start;break;case 8:this._onEmit=this.has(t,"onEmit")?t.onEmit:this.defaultEmit,this._onUpdate=this.has(t,"onUpdate")?t.onUpdate:this.defaultUpdate,n=this.proxyEmit,i=this.proxyUpdate;break;case 9:this.start=t.values;var o=this.has(t,"ease")?t.ease:"Linear";this.ease=a(o,t.easeParams),this.interpolation=l(t.interpolation),n=this.easedValueEmit,i=this.easeValueUpdate,e=this.start[0]}return this.onEmit=n,this.onUpdate=i,this.current=e,this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,n){return t.hasOwnProperty(e)&&t.hasOwnProperty(n)},hasEither:function(t,e,n){return t.hasOwnProperty(e)||t.hasOwnProperty(n)},defaultEmit:function(t,e,n){return n},defaultUpdate:function(t,e,n,i){return i},proxyEmit:function(t,e,n){var i=this._onEmit(t,e,n);return this.current=i,i},proxyUpdate:function(t,e,n,i){var r=this._onUpdate(t,e,n,i);return this.current=r,r},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[t],this.current},randomRangedValueEmit:function(t,e){var n=o(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=n,t.data[e].max=this.end),this.current=n,n},randomRangedIntEmit:function(t,e){var n=i(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=n,t.data[e].max=this.end),this.current=n,n},steppedEmit:function(){var t,e=this.counter,n=e,i=(this.end-this.start)/this.steps;return this.yoyo?(0===this.direction?(n+=i)>=this.end&&(t=n-this.end,n=this.end-t,this.direction=1):(n-=i)<=this.start&&(t=this.start-n,n=this.start+t,this.direction=0),this.counter=n):this.counter=h(n+i,this.start,this.end),this.current=e,e},easedValueEmit:function(t,e){if(t&&t.data[e]){var n=t.data[e];n.min=this.start,n.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(t,e,n){var i,r=t.data[e],s=this.ease(n);return i=this.interpolation?this.interpolation(this.start,s):(r.max-r.min)*s+r.min,this.current=i,i},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});t.exports=d},87811:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(30891),o=new i({Extends:s,initialize:function(t,e,n,i,o){if("object"===typeof t){var a=t;t=r(a,"x",0),e=r(a,"y",0),n=r(a,"power",0),i=r(a,"epsilon",100),o=r(a,"gravity",50)}else void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=100),void 0===o&&(o=50);s.call(this,t,e,!0),this._gravity=o,this._power=n*o,this._epsilon=i*i},update:function(t,e){var n=this.x-t.x,i=this.y-t.y,r=n*n+i*i;if(0!==r){var s=Math.sqrt(r);r<this._epsilon&&(r=this._epsilon);var o=this._power*e/(r*s)*100;t.velocityX+=n*o,t.velocityY+=i*o}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});t.exports=o},14909:(t,e,n)=>{var i=n(16569),r=n(82897),s=n(56694),o=n(75606),a=n(74118),c=n(2386),l=n(93736),u=new s({initialize:function(t){this.emitter=t,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new l,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=t.scene,this.anims=new i(this),this.bounds=new a},emit:function(t,e,n,i,r,s){return this.emitter.emit(t,e,n,i,r,s)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},fire:function(t,e){var n=this.emitter,i=n.ops,r=n.getAnim();if(r?this.anims.play(r):(this.frame=n.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(n.getEmitZone(this),void 0===t?this.x+=i.x.onEmit(this,"x"):i.x.steps>0?this.x+=t+i.x.onEmit(this,"x"):this.x+=t,void 0===e?this.y+=i.y.onEmit(this,"y"):i.y.steps>0?this.y+=e+i.y.onEmit(this,"y"):this.y+=e,this.life=i.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=i.delay.onEmit(this,"delay"),this.holdCurrent=i.hold.onEmit(this,"hold"),this.scaleX=i.scaleX.onEmit(this,"scaleX"),this.scaleY=i.scaleY.active?i.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=i.rotate.onEmit(this,"rotate"),this.rotation=o(this.angle),n.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),0===this.delayCurrent&&n.getDeathZone(this))return this.lifeCurrent=0,!1;var s=i.speedX.onEmit(this,"speedX"),a=i.speedY.active?i.speedY.onEmit(this,"speedY"):s;if(n.radial){var c=o(i.angle.onEmit(this,"angle"));this.velocityX=Math.cos(c)*Math.abs(s),this.velocityY=Math.sin(c)*Math.abs(a)}else if(n.moveTo){var l=i.moveToX.onEmit(this,"moveToX"),u=i.moveToY.onEmit(this,"moveToY"),h=this.life/1e3;this.velocityX=(l-this.x)/h,this.velocityY=(u-this.y)/h}else this.velocityX=s,this.velocityY=a;return n.acceleration&&(this.accelerationX=i.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=i.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=i.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=i.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=i.bounce.onEmit(this,"bounce"),this.alpha=i.alpha.onEmit(this,"alpha"),i.color.active?this.tint=i.color.onEmit(this,"tint"):this.tint=i.tint.onEmit(this,"tint"),!0},update:function(t,e,n){if(this.lifeCurrent<=0)return!(this.holdCurrent>0)||(this.holdCurrent-=t,this.holdCurrent<=0);if(this.delayCurrent>0)return this.delayCurrent-=t,!1;this.anims.update(0,t);var i=this.emitter,s=i.ops,a=1-this.lifeCurrent/this.life;if(this.lifeT=a,this.x=s.x.onUpdate(this,"x",a,this.x),this.y=s.y.onUpdate(this,"y",a,this.y),i.moveTo){var c=s.moveToX.onUpdate(this,"moveToX",a,i.moveToX),l=s.moveToY.onUpdate(this,"moveToY",a,i.moveToY),u=this.lifeCurrent/1e3;this.velocityX=(c-this.x)/u,this.velocityY=(l-this.y)/u}return this.computeVelocity(i,t,e,n,a),this.scaleX=s.scaleX.onUpdate(this,"scaleX",a,this.scaleX),s.scaleY.active?this.scaleY=s.scaleY.onUpdate(this,"scaleY",a,this.scaleY):this.scaleY=this.scaleX,this.angle=s.rotate.onUpdate(this,"rotate",a,this.angle),this.rotation=o(this.angle),i.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=r(s.alpha.onUpdate(this,"alpha",a,this.alpha),0,1),s.color.active?this.tint=s.color.onUpdate(this,"color",a,this.tint):this.tint=s.tint.onUpdate(this,"tint",a,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(t,e,n,i,s){var o=t.ops,a=this.velocityX,c=this.velocityY,l=o.accelerationX.onUpdate(this,"accelerationX",s,this.accelerationX),u=o.accelerationY.onUpdate(this,"accelerationY",s,this.accelerationY),h=o.maxVelocityX.onUpdate(this,"maxVelocityX",s,this.maxVelocityX),d=o.maxVelocityY.onUpdate(this,"maxVelocityY",s,this.maxVelocityY);this.bounce=o.bounce.onUpdate(this,"bounce",s,this.bounce),a+=t.gravityX*n+l*n,c+=t.gravityY*n+u*n,a=r(a,-h,h),c=r(c,-d,d),this.velocityX=a,this.velocityY=c,this.x+=a*n,this.y+=c*n,t.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var p=0;p<i.length;p++){var f=i[p];f.active&&f.update(this,e,n,s)}},setSizeToFrame:function(){},getBounds:function(t){void 0===t&&(t=this.emitter.getWorldTransformMatrix());var e=Math.abs(t.scaleX)*this.scaleX,n=Math.abs(t.scaleY)*this.scaleY,i=this.x,r=this.y,s=this.rotation,o=this.frame.width*e/2,a=this.frame.height*n/2,u=this.bounds,h=new l(i-o,r-a),d=new l(i+o,r-a),p=new l(i-o,r+a),f=new l(i+o,r+a);return 0!==s&&(c(h,i,r,s),c(d,i,r,s),c(p,i,r,s),c(f,i,r,s)),t.transformPoint(h.x,h.y,h),t.transformPoint(d.x,d.y,d),t.transformPoint(p.x,p.y,p),t.transformPoint(f.x,f.y,f),u.x=Math.min(h.x,d.x,p.x,f.x),u.y=Math.min(h.y,d.y,p.y,f.y),u.width=Math.max(h.x,d.x,p.x,f.x)-u.x,u.height=Math.max(h.y,d.y,p.y,f.y)-u.y,u},destroy:function(){this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});t.exports=u},73106:(t,e,n)=>{var i=n(56694),r=n(30891),s=n(74118),o=new i({Extends:r,initialize:function(t,e,n,i,o,a,c,l){void 0===o&&(o=!0),void 0===a&&(a=!0),void 0===c&&(c=!0),void 0===l&&(l=!0),r.call(this,t,e,!0),this.bounds=new s(t,e,n,i),this.collideLeft=o,this.collideRight=a,this.collideTop=c,this.collideBottom=l},update:function(t){var e=this.bounds,n=-t.bounce,i=t.worldPosition;i.x<e.x&&this.collideLeft?(t.x+=e.x-i.x,t.velocityX*=n):i.x>e.right&&this.collideRight&&(t.x-=i.x-e.right,t.velocityX*=n),i.y<e.y&&this.collideTop?(t.y+=e.y-i.y,t.velocityY*=n):i.y>e.bottom&&this.collideBottom&&(t.y-=i.y-e.bottom,t.velocityY*=n)}});t.exports=o},9216:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(48129),o=n(29538),a=n(69361),c=n(54213),l=n(19737),u=n(93025),h=n(40629),d=n(89980),p=n(72632),f=n(72861),m=n(87811),g=n(53523),v=n(19256),y=n(7782),x=n(71207),b=n(14655),w=n(14909),S=n(68433),_=n(74118),T=n(90205),E=n(66458),C=n(69116),k=n(17922),A=n(69360),I=n(93736),O=n(1071),R=n(73106),N=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],M=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],D=new i({Extends:d,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Texture,r.Transform,r.Visible,C],initialize:function(t,e,n,i,r){d.call(this,t,"ParticleEmitter"),this.particleClass=w,this.ops={accelerationX:new u("accelerationX",0),accelerationY:new u("accelerationY",0),alpha:new u("alpha",1),angle:new u("angle",{min:0,max:360},!0),bounce:new u("bounce",0),color:new l("color"),delay:new u("delay",0,!0),hold:new u("hold",0,!0),lifespan:new u("lifespan",1e3,!0),maxVelocityX:new u("maxVelocityX",1e4),maxVelocityY:new u("maxVelocityY",1e4),moveToX:new u("moveToX",0),moveToY:new u("moveToY",0),quantity:new u("quantity",1,!0),rotate:new u("rotate",0),scaleX:new u("scaleX",1),scaleY:new u("scaleY",1),speedX:new u("speedX",0,!0),speedY:new u("speedY",0,!0),tint:new u("tint",16777215),x:new u("x",0),y:new u("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new I,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new A,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new x(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(e,n),this.setTexture(i),r&&this.setConfig(r)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(t){if(!t)return this;var e=0,n="",i=this.ops;for(e=0;e<M.length;e++)i[n=M[e]].loadConfig(t);for(e=0;e<N.length;e++)v(t,n=N[e])&&(this[n]=p(t,n));if(this.acceleration=0!==this.accelerationX||0!==this.accelerationY,this.moveTo=0!==this.moveToX&&0!==this.moveToY,v(t,"speed")&&(i.speedX.loadConfig(t,"speed"),i.speedY.active=!1),(g(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),v(t,"scale")&&(i.scaleX.loadConfig(t,"scale"),i.scaleY.active=!1),v(t,"callbackScope")){var r=p(t,"callbackScope",null);this.emitCallbackScope=r,this.deathCallbackScope=r}if(v(t,"emitZone")&&this.addEmitZone(t.emitZone),v(t,"deathZone")&&this.addDeathZone(t.deathZone),v(t,"bounds")){var s=this.addParticleBounds(t.bounds);s.collideLeft=p(t,"collideLeft",!0),s.collideRight=p(t,"collideRight",!0),s.collideTop=p(t,"collideTop",!0),s.collideBottom=p(t,"collideBottom",!0)}return v(t,"followOffset")&&this.followOffset.setFromObject(p(t,"followOffset",0)),v(t,"texture")&&this.setTexture(t.texture),v(t,"frame")?this.setEmitterFrame(t.frame):v(t,"anim")&&this.setAnim(t.anim),v(t,"reserve")&&this.reserve(t.reserve),v(t,"advance")&&this.fastForward(t.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(h.START,this),this},toJSON:function(){var t=s(this),e=0,n="";for(e=0;e<N.length;e++)t[n=N[e]]=this[n];var i=this.ops;for(e=0;e<M.length;e++)i[n=M[e]]&&(t[n]=i[n].toJSON());return i.speedY.active||(delete t.speedX,t.speed=i.speedX.toJSON()),this.scaleX===this.scaleY&&(delete t.scaleX,delete t.scaleY,t.scale=i.scaleX.toJSON()),t},resetCounters:function(t,e){var n=this.counters;n.fill(0),n[0]=t,e&&(n[5]=1)},startFollow:function(t,e,n,i){return void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=!1),this.follow=t,this.followOffset.set(e,n),this.trackVisible=i,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var t,e=this.frames,n=e.length;return 1===n?t=e[0]:this.randomFrame?t=f(e):(t=e[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===n&&(this.currentFrame=0))),this.texture.get(t)},setEmitterFrame:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),this.randomFrame=e,this.frameQuantity=n,this.currentFrame=0;var i=typeof t;if(this.frames.length=0,Array.isArray(t))this.frames=this.frames.concat(t);else if("string"===i||"number"===i)this.frames.push(t);else if("object"===i){var r=t;(t=p(r,"frames",null))&&(this.frames=this.frames.concat(t));var s=p(r,"cycle",!1);this.randomFrame=!s,this.frameQuantity=p(r,"quantity",n)}return 1===this.frames.length&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var t=this.anims,e=t.length;if(0===e)return null;if(1===e)return t[0];if(this.randomAnim)return f(t);var n=t[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=O(this.currentAnim+1,0,e)),n},setAnim:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),this.randomAnim=e,this.animQuantity=n,this.currentAnim=0;var i=typeof t;if(this.anims.length=0,Array.isArray(t))this.anims=this.anims.concat(t);else if("string"===i)this.anims.push(t);else if("object"===i){var r=t;(t=p(r,"anims",null))&&(this.anims=this.anims.concat(t));var s=p(r,"cycle",!1);this.randomAnim=!s,this.animQuantity=p(r,"quantity",n)}return 1===this.anims.length&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},addParticleBounds:function(t,e,n,i,r,s,o,a){if("object"===typeof t){var c=t;t=c.x,e=c.y,n=v(c,"w")?c.w:c.width,i=v(c,"h")?c.h:c.height}return this.addParticleProcessor(new R(t,e,n,i,r,s,o,a))},setParticleSpeed:function(t,e){return void 0===e&&(e=t),this.ops.speedX.onChange(t),t===e?this.ops.speedY.active=!1:this.ops.speedY.onChange(e),this.radial=!0,this},setParticleScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.ops.scaleX.onChange(t),this.ops.scaleY.onChange(e),this},setParticleGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setParticleAlpha:function(t){return this.ops.alpha.onChange(t),this},setParticleTint:function(t){return this.ops.tint.onChange(t),this},setEmitterAngle:function(t){return this.ops.angle.onChange(t),this},setParticleLifespan:function(t){return this.ops.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity=t,this},setFrequency:function(t,e){return this.frequency=t,this.flowCounter=t>0?t:0,e&&(this.quantity=e),this},addDeathZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var n=[],i=0;i<t.length;i++)if((e=t[i])instanceof a)n.push(e);else if("function"===typeof e.contains)e=new a(e,!0),n.push(e);else{var r=p(e,"type","onEnter"),s=p(e,"source",null);s&&"function"===typeof s.contains&&(e=new a(s,"onEnter"===r),n.push(e))}return this.deathZones=this.deathZones.concat(n),n},removeDeathZone:function(t){return E(this.deathZones,t),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var n=[],i=0;i<t.length;i++)if((e=t[i])instanceof S||e instanceof c)n.push(e);else{var r=p(e,"source",null);if(r){var s=p(e,"type","random");if("random"===s&&"function"===typeof r.getRandomPoint)e=new S(r),n.push(e);else if("edge"===s&&"function"===typeof r.getPoints){var o=p(e,"quantity",1),a=p(e,"stepRate",0),l=p(e,"yoyo",!1),u=p(e,"seamless",!0),h=p(e,"total",-1);e=new c(r,o,a,l,u,h),n.push(e)}}}return this.emitZones=this.emitZones.concat(n),n},removeEmitZone:function(t){return E(this.emitZones,t),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(t){var e=this.emitZones,n=e.length;if(0!==n){var i=e[this.zoneIndex];i.getPoint(t),i.total>-1&&(this.zoneTotal++,this.zoneTotal===i.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===n&&(this.zoneIndex=0)))}},getDeathZone:function(t){for(var e=this.deathZones,n=0;n<e.length;n++){var i=e[n];if(i.willKill(t))return this.emit(h.DEATH_ZONE,this,t,i),!0}return!1},setEmitZone:function(t){var e;return(e=isFinite(t)?t:this.emitZones.indexOf(t))>=0&&(this.zoneIndex=e),this},addParticleProcessor:function(t){return this.processors.exists(t)||(t.emitter&&t.emitter.removeParticleProcessor(t),this.processors.add(t),t.emitter=this),t},removeParticleProcessor:function(t){return this.processors.exists(t)&&(this.processors.remove(t,!0),t.emitter=null),t},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(t){return this.addParticleProcessor(new m(t))},reserve:function(t){var e=this.dead;if(this.maxParticles>0){var n=this.getParticleCount();n+t>this.maxParticles&&(t=this.maxParticles-(n+t))}for(var i=0;i<t;i++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles||this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"===typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"===typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var n=this.alive,i=n.length,r=0;r<i;r++)t.call(e,n[r],this);return this},forEachDead:function(t,e){for(var n=this.dead,i=n.length,r=0;r<i;r++)t.call(e,n[r],this);return this},start:function(t,e){return void 0===t&&(t=0),this.emitting||(t>0&&this.fastForward(t),this.emitting=!0,this.resetCounters(this.frequency,!0),void 0!==e&&(this.duration=Math.abs(e)),this.emit(h.START,this)),this},stop:function(t){return void 0===t&&(t=!1),this.emitting&&(this.emitting=!1,t&&this.killAll(),this.emit(h.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(t,e){return void 0===t&&(t=""),void 0===e&&(e=this.true),this.sortProperty=t,this.sortOrderAsc=e,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(t){return t=""!==this.sortProperty?this.depthSortCallback:null,this.sortCallback=t,this},depthSort:function(){return k(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(t,e){var n=this.sortProperty;return this.sortOrderAsc?t[n]-e[n]:e[n]-t[n]},flow:function(t,e,n){return void 0===e&&(e=1),this.emitting=!1,this.frequency=t,this.quantity=e,void 0!==n&&(this.stopAfter=n),this.start()},explode:function(t,e,n){this.frequency=-1,this.resetCounters(-1,!0);var i=this.emitParticle(t,e,n);return this.emit(h.EXPLODE,this,i),i},emitParticleAt:function(t,e,n){return this.emitParticle(n,t,e)},emitParticle:function(t,e,n){if(!this.atLimit()){void 0===t&&(t=this.ops.quantity.onEmit());for(var i=this.dead,r=this.stopAfter,s=this.follow?this.follow.x+this.followOffset.x:e,o=this.follow?this.follow.y+this.followOffset.y:n,a=0;a<t;a++){var c=i.pop();if(c||(c=new this.particleClass(this)),c.fire(s,o)?(this.particleBringToTop?this.alive.push(c):this.alive.unshift(c),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,c,this)):this.dead.push(c),r>0&&(this.stopCounter++,this.stopCounter>=r))break;if(this.atLimit())break}return c}},fastForward:function(t,e){void 0===e&&(e=1e3/60);var n=0;for(this.skipping=!0;n<Math.abs(t);)this.preUpdate(0,e),n+=e;return this.skipping=!1,this},preUpdate:function(t,e){var n=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var i=this.getProcessors(),r=this.alive,s=this.dead,o=0,a=[],c=r.length;for(o=0;o<c;o++){var l=r[o];l.update(e,n,i)&&a.push({index:o,particle:l})}if((c=a.length)>0){var u=this.deathCallback,d=this.deathCallbackScope;for(o=c-1;o>=0;o--){var p=a[o];r.splice(p.index,1),s.push(p.particle),u&&u.call(d,p.particle),p.particle.setPosition()}}if(this.emitting||this.skipping){if(0===this.frequency)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=e;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())}else 1===this.completeFlag&&0===r.length&&(this.completeFlag=0,this.emit(h.COMPLETE,this))},overlap:function(t){for(var e=this.getWorldTransformMatrix(),n=this.alive,i=n.length,r=[],s=0;s<i;s++){var o=n[s];T(t,o.getBounds(e))&&r.push(o)}return r},getBounds:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1e3/60),void 0===i&&(i=new _);var r,s,a=this.getWorldTransformMatrix(),c=this.alive,l=!1;if(i.setTo(0,0,0,0),e>0){var u=0;for(this.skipping=!0;u<Math.abs(e);){for(this.preUpdate(0,n),r=0;r<c.length;r++)s=c[r].getBounds(a),l?b(i,s):(l=!0,o(s,i));u+=n}this.skipping=!1}else for(r=0;r<c.length;r++)s=c[r].getBounds(a),l?b(i,s):(l=!0,o(s,i));return t>0&&y(i,t,t),i},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(t){this.ops.x.onChange(t)}},particleY:{get:function(){return this.ops.y.current},set:function(t){this.ops.y.onChange(t)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(t){this.ops.accelerationX.onChange(t)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(t){this.ops.accelerationY.onChange(t)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(t){this.ops.maxVelocityX.onChange(t)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(t){this.ops.maxVelocityY.onChange(t)}},speed:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t),this.ops.speedY.onChange(t)}},speedX:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t)}},speedY:{get:function(){return this.ops.speedY.current},set:function(t){this.ops.speedY.onChange(t)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(t){this.ops.moveToX.onChange(t)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(t){this.ops.moveToY.onChange(t)}},bounce:{get:function(){return this.ops.bounce.current},set:function(t){this.ops.bounce.onChange(t)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(t){this.ops.scaleX.onChange(t)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(t){this.ops.scaleY.onChange(t)}},particleColor:{get:function(){return this.ops.color.current},set:function(t){this.ops.color.onChange(t)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(t){this.ops.color.setEase(t)}},particleTint:{get:function(){return this.ops.tint.current},set:function(t){this.ops.tint.onChange(t)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(t){this.ops.alpha.onChange(t)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(t){this.ops.lifespan.onChange(t)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(t){this.ops.angle.onChange(t)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(t){this.ops.rotate.onChange(t)}},quantity:{get:function(){return this.ops.quantity.current},set:function(t){this.ops.quantity.onChange(t)}},delay:{get:function(){return this.ops.delay.current},set:function(t){this.ops.delay.onChange(t)}},hold:{get:function(){return this.ops.hold.current},set:function(t){this.ops.hold.onChange(t)}},flowCounter:{get:function(){return this.counters[0]},set:function(t){this.counters[0]=t}},frameCounter:{get:function(){return this.counters[1]},set:function(t){this.counters[1]=t}},animCounter:{get:function(){return this.counters[2]},set:function(t){this.counters[2]=t}},elapsed:{get:function(){return this.counters[3]},set:function(t){this.counters[3]=t}},stopCounter:{get:function(){return this.counters[4]},set:function(t){this.counters[4]=t}},completeFlag:{get:function(){return this.counters[5]},set:function(t){this.counters[5]=t}},zoneIndex:{get:function(){return this.counters[6]},set:function(t){this.counters[6]=t}},zoneTotal:{get:function(){return this.counters[7]},set:function(t){this.counters[7]=t}},currentFrame:{get:function(){return this.counters[8]},set:function(t){this.counters[8]=t}},currentAnim:{get:function(){return this.counters[9]},set:function(t){this.counters[9]=t}},preDestroy:function(){var t;this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var e=this.ops;for(t=0;t<M.length;t++)e[M[t]].destroy();for(t=0;t<this.alive.length;t++)this.alive[t].destroy();for(t=0;t<this.dead.length;t++)this.dead[t].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});t.exports=D},10456:(t,e,n)=>{var i=n(90205),r=n(69360),s=new r,o=new r,a=new r,c=new r;t.exports=function(t,e,n,r){var l=s,u=o,h=a,d=c;r?(d.loadIdentity(),d.multiply(r),d.translate(e.x,e.y),d.rotate(e.rotation),d.scale(e.scaleX,e.scaleY)):d.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var p=t.currentContext,f=n.roundPixels,m=n.alpha,g=e.alpha,v=e.alive,y=v.length,x=e.viewBounds;if(e.visible&&0!==y&&(!x||i(x,n.worldView))){e.sortCallback&&e.depthSort(),n.addToRenderList(e);var b=e.scrollFactorX,w=e.scrollFactorY;p.save(),p.globalCompositeOperation=t.blendModes[e.blendMode];for(var S=0;S<y;S++){var _=v[S],T=_.alpha*g*m;if(!(T<=0||0===_.scaleX||0===_.scaleY)){h.applyITRS(_.x,_.y,_.rotation,_.scaleX,_.scaleY),l.copyFrom(n.matrix),l.multiplyWithOffset(d,-n.scrollX*b,-n.scrollY*w),h.e=_.x,h.f=_.y,l.multiply(h,u);var E=_.frame,C=E.canvasData;if(C.width>0&&C.height>0){var k=-E.halfWidth,A=-E.halfHeight;p.globalAlpha=T,p.save(),u.setToContext(p),f&&(k=Math.round(k),A=Math.round(A)),p.imageSmoothingEnabled=!E.source.scaleMode,p.drawImage(E.source.image,C.x,C.y,C.width,C.height,k,A,C.width,C.height),p.restore()}}}p.restore()}}},765:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(72632),a=n(9216);r.register("particles",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=o(t,"config",null),c=new a(this.scene,0,0,n);return void 0!==e&&(t.add=e),i(this.scene,c,t),r&&c.setConfig(r),c}))},81212:(t,e,n)=>{var i=n(61286),r=n(9216);i.register("particles",(function(t,e,n,i){return void 0!==t&&"string"===typeof t&&console.warn("ParticleEmitterManager was removed in Phaser 3.60. See documentation for details"),this.displayList.add(new r(this.scene,t,e,n,i))}))},69116:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(10275),s=n(10456),t.exports={renderWebGL:r,renderCanvas:s}},10275:(t,e,n)=>{var i=n(90205),r=n(69360),s=n(75512),o=new r,a=new r,c=new r,l=new r;t.exports=function(t,e,n,r){var u=t.pipelines.set(e.pipeline),h=o,d=a,p=c,f=l;r?(f.loadIdentity(),f.multiply(r),f.translate(e.x,e.y),f.rotate(e.rotation),f.scale(e.scaleX,e.scaleY)):f.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var m=s.getTintAppendFloatAlpha,g=n.alpha,v=e.alpha;t.pipelines.preBatch(e);var y=e.alive,x=y.length,b=e.viewBounds;if(0!==x&&(!b||i(b,n.worldView))){e.sortCallback&&e.depthSort(),n.addToRenderList(e),h.copyFrom(n.matrix),h.multiplyWithOffset(f,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),t.setBlendMode(e.blendMode),e.mask&&(e.mask.preRenderWebGL(t,e,n),t.pipelines.set(e.pipeline));for(var w,S,_=e.tintFill,T=0;T<x;T++){var E=y[T],C=E.alpha*v*g;if(!(C<=0||0===E.scaleX||0===E.scaleY)){p.applyITRS(E.x,E.y,E.rotation,E.scaleX,E.scaleY),p.e=E.x,p.f=E.y,h.multiply(p,d);var k=E.frame;k.glTexture!==S&&(S=k.glTexture,w=u.setGameObject(e,k));var A=-k.halfWidth,I=-k.halfHeight,O=d.setQuad(A,I,A+k.width,I+k.height),R=m(E.tint,C);u.shouldFlush(6)&&(u.flush(),w=u.setGameObject(e,k)),u.batchQuad(e,O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],k.u0,k.v0,k.u1,k.v1,R,R,R,R,_,S,w)}}e.mask&&e.mask.postRenderWebGL(t,n),t.pipelines.postBatch(e)}}},30891:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=!0),this.emitter,this.x=t,this.y=e,this.active=n},update:function(){},destroy:function(){this.emitter=null}});t.exports=i},76100:t=>{t.exports="complete"},26677:t=>{t.exports="deathzone"},62736:t=>{t.exports="explode"},56490:t=>{t.exports="start"},85715:t=>{t.exports="stop"},40629:(t,e,n)=>{t.exports={COMPLETE:n(76100),DEATH_ZONE:n(26677),EXPLODE:n(62736),START:n(56490),STOP:n(85715)}},27684:(t,e,n)=>{t.exports={EmitterColorOp:n(19737),EmitterOp:n(93025),Events:n(40629),GravityWell:n(87811),Particle:n(14909),ParticleBounds:n(73106),ParticleEmitter:n(9216),ParticleProcessor:n(30891),Zones:n(25962)}},69361:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=t.worldPosition,n=this.source.contains(e.x,e.y);return n&&this.killOnEnter||!n&&!this.killOnEnter}});t.exports=i},54213:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i,r,s){void 0===i&&(i=!1),void 0===r&&(r=!0),void 0===s&&(s=-1),this.source=t,this.points=[],this.quantity=e,this.stepRate=n,this.yoyo=i,this.counter=-1,this.seamless=r,this._length=0,this._direction=0,this.total=s,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var n=this._length;return this._length=this.points.length,this._length<n&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});t.exports=i},68433:(t,e,n)=>{var i=n(56694),r=n(93736),s=new i({initialize:function(t){this.source=t,this._tempVec=new r,this.total=-1},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});t.exports=s},25962:(t,e,n)=>{t.exports={DeathZone:n(69361),EdgeZone:n(54213),RandomZone:n(68433)}},29598:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(13747),o=new i({Extends:s,Mixins:[r.PathFollower],initialize:function(t,e,n,i,r,o){s.call(this,t,n,i,r,o),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});t.exports=o},19626:(t,e,n)=>{var i=n(61286),r=n(29598);i.register("follower",(function(t,e,n,i,s){var o=new r(this.scene,t,e,n,i,s);return this.displayList.add(o),this.updateList.add(o),o}))},33412:(t,e,n)=>{var i=n(16569),r=n(56694),s=n(99425),o=n(15978),a=n(83321),c=n(76583),l=new r({Extends:a,initialize:function(t,e,n,r,s,o,c,l){r||(r="__DEFAULT"),a.call(this,t,e,n,r,s),this.type="Plane",this.anims=new i(this),this.gridWidth,this.gridHeight,this.isTiled,this._checkerboard=null,this.hideCCW=!1,this.setGridSize(o,c,l),this.setSizeToFrame(!1),this.setViewHeight()},originX:{get:function(){return.5}},originY:{get:function(){return.5}},setGridSize:function(t,e,n){void 0===t&&(t=8),void 0===e&&(e=8),void 0===n&&(n=!1);var i=!1;return n&&(i=!0),this.gridWidth=t,this.gridHeight=e,this.isTiled=n,this.clear(),s({mesh:this,widthSegments:t,heightSegments:e,isOrtho:!1,tile:n,flipY:i}),this},setSizeToFrame:function(t){void 0===t&&(t=!0);var e=this.frame;if(this.setPerspective(this.width/e.width,this.height/e.height),this._checkerboard&&this._checkerboard!==this.texture&&this.removeCheckerboard(),!t)return this;var n,i,r=this.gridWidth,s=this.gridHeight,o=this.vertices,a=e.u0,c=e.u1,l=e.v0,u=e.v1,h=0;if(this.isTiled)for(l=e.v1,u=e.v0,i=0;i<s;i++)for(n=0;n<r;n++)o[h++].setUVs(a,u),o[h++].setUVs(a,l),o[h++].setUVs(c,u),o[h++].setUVs(a,l),o[h++].setUVs(c,l),o[h++].setUVs(c,u);else{var d=r+1,p=s+1,f=c-a,m=u-l,g=[];for(i=0;i<p;i++)for(n=0;n<d;n++){var v=a+f*(n/r),y=l+m*(i/s);g.push(v,y)}for(i=0;i<s;i++)for(n=0;n<r;n++){var x=2*(n+d*i),b=2*(n+d*(i+1)),w=2*(n+1+d*(i+1)),S=2*(n+1+d*i);o[h++].setUVs(g[x],g[x+1]),o[h++].setUVs(g[b],g[b+1]),o[h++].setUVs(g[S],g[S+1]),o[h++].setUVs(g[b],g[b+1]),o[h++].setUVs(g[w],g[w+1]),o[h++].setUVs(g[S],g[S+1])}}return this},setViewHeight:function(t){void 0===t&&(t=this.frame.height);var e=this.fov*(Math.PI/180);this.viewPosition.z=this.height/t/Math.tan(e/2),this.dirtyCache[10]=1},createCheckerboard:function(t,e,n,i,r){void 0===t&&(t=16777215),void 0===e&&(e=255),void 0===n&&(n=255),void 0===i&&(i=255),void 0===r&&(r=128);var s=this.scene.sys.renderer.gl,a=s.createTexture();s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST);for(var l=o(t),u=o(e),h=[],d=0;d<16;d++)for(var p=0;p<16;p++)d<8&&p<8||d>7&&p>7?h.push(l.r,l.g,l.b,n):h.push(u.r,u.g,u.b,i);s.texImage2D(s.TEXTURE_2D,0,s.RGBA,16,16,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array(h)),a.isAlphaPremultiplied=!0,a.isRenderTexture=!1,a.width=16,a.height=16;var f=this.scene.sys.textures.addGLTexture(c(),a,16,16);return this.removeCheckerboard(),this._checkerboard=f,s.bindTexture(s.TEXTURE_2D,null),this.setTexture(f),this.setSizeToFrame(),this.setViewHeight(r),this},removeCheckerboard:function(){this._checkerboard&&(this._checkerboard.destroy(),this._checkerboard=null)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},preUpdate:function(t,e){a.prototype.preUpdate.call(this,t,e),this.anims.update(t,e)},preDestroy:function(){this.clear(),this.removeCheckerboard(),this.anims.destroy(),this.anims=void 0,this.debugCallback=null,this.debugGraphic=null}});t.exports=l},10912:(t,e,n)=>{var i=n(88933),r=n(32291),s=n(99325),o=n(20494),a=n(10850),c=n(33412);s.register("plane",(function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),l=a(t,"width",8),u=a(t,"height",8),h=a(t,"tile",!1),d=new c(this.scene,0,0,n,s,l,u,h);void 0!==e&&(t.add=e);var p=a(t,"checkerboard",null);if(p){var f=a(p,"color1",16777215),m=a(p,"color2",255),g=a(p,"alpha1",255),v=a(p,"alpha2",255),y=a(p,"height",128);d.createCheckerboard(f,m,g,v,y)}return i(this.scene,d,t),r(d,t),d}))},58322:(t,e,n)=>{var i=n(33412);n(61286).register("plane",(function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))}))},13171:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(74853),a=n(65641),c=n(71606),l=new i({Extends:s,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.Mask,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Transform,r.Visible,c],initialize:function(t,e,n,i,r,c,l){void 0===i&&(i=16777215),void 0===r&&(r=128),void 0===c&&(c=1),void 0===l&&(l=.1),s.call(this,t,"PointLight"),this.initPipeline(a.POINTLIGHT_PIPELINE),this.initPostPipeline(),this.setPosition(e,n),this.color=o(i),this.intensity=c,this.attenuation=l,this.width=2*r,this.height=2*r,this._radius=r},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*t,this.height=2*t}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}});t.exports=l},162:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(13171);r.register("pointlight",(function(t,e){void 0===t&&(t={});var n=s(t,"color",16777215),r=s(t,"radius",128),a=s(t,"intensity",1),c=s(t,"attenuation",.1),l=new o(this.scene,0,0,n,r,a,c);return void 0!==e&&(t.add=e),i(this.scene,l,t),l}))},91201:(t,e,n)=>{var i=n(61286),r=n(13171);i.register("pointlight",(function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))}))},71606:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(80590),t.exports={renderWebGL:r,renderCanvas:s}},80590:(t,e,n)=>{var i=n(73329);t.exports=function(t,e,n,r){n.addToRenderList(e);var s=t.pipelines.set(e.pipeline),o=i(e,n,r).calc,a=e.width,c=e.height,l=-e._radius,u=-e._radius,h=l+a,d=u+c,p=o.getX(0,0),f=o.getY(0,0),m=o.getX(l,u),g=o.getY(l,u),v=o.getX(l,d),y=o.getY(l,d),x=o.getX(h,d),b=o.getY(h,d),w=o.getX(h,u),S=o.getY(h,u);t.pipelines.preBatch(e),s.batchPointLight(e,n,m,g,v,y,x,b,w,S,p,f),t.pipelines.postBatch(e)}},15996:(t,e,n)=>{var i=n(56694),r=n(845),s=n(1539),o=new i({Extends:s,initialize:function(t,e,n,i,o){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=32),void 0===o&&(o=32);var a=new r(t.sys.textures,"",i,o);s.call(this,t,e,n,a),this.type="RenderTexture",this.camera=this.texture.camera,this._saved=!1},setSize:function(t,e){this.width=t,this.height=e,this.texture.setSize(t,e),this.updateDisplayOrigin();var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this},resize:function(t,e){return this.setSize(t,e),this},saveTexture:function(t){var e=this.texture;return e.key=t,e.manager.addDynamicTexture(e)&&(this._saved=!0),e},fill:function(t,e,n,i,r,s){return this.texture.fill(t,e,n,i,r,s),this},clear:function(){return this.texture.clear(),this},stamp:function(t,e,n,i,r){return this.texture.stamp(t,e,n,i,r),this},erase:function(t,e,n){return this.texture.erase(t,e,n),this},draw:function(t,e,n,i,r){return this.texture.draw(t,e,n,i,r),this},drawFrame:function(t,e,n,i,r,s){return this.texture.drawFrame(t,e,n,i,r,s),this},repeat:function(t,e,n,i,r,s,o,a,c){return this.texture.repeat(t,e,n,i,r,s,o,a,c),this},beginDraw:function(){return this.texture.beginDraw(),this},batchDraw:function(t,e,n,i,r){return this.texture.batchDraw(t,e,n,i,r),this},batchDrawFrame:function(t,e,n,i,r,s){return this.texture.batchDrawFrame(t,e,n,i,r,s),this},endDraw:function(t){return this.texture.endDraw(t),this},snapshotArea:function(t,e,n,i,r,s,o){return this.texture.snapshotArea(t,e,n,i,r,s,o),this},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.width,this.height,t,e,n)},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n,"pixel")},preDestroy:function(){this.camera=null,this._saved||this.texture.destroy()}});t.exports=o},85692:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(15996);r.register("renderTexture",(function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",32),c=s(t,"height",32),l=new o(this.scene,n,r,a,c);return void 0!==e&&(t.add=e),i(this.scene,l,t),l}))},29599:(t,e,n)=>{var i=n(61286),r=n(15996);i.register("renderTexture",(function(t,e,n,i){return this.displayList.add(new r(this.scene,t,e,n,i))}))},79968:(t,e,n)=>{var i=n(16569),r=n(56694),s=n(64937),o=n(89980),a=n(65641),c=n(58912),l=n(93736),u=new r({Extends:o,Mixins:[s.AlphaSingle,s.BlendMode,s.Depth,s.Flip,s.Mask,s.Pipeline,s.PostPipeline,s.Size,s.Texture,s.Transform,s.Visible,s.ScrollFactor,c],initialize:function(t,e,n,r,s,c,u,h,d){void 0===r&&(r="__DEFAULT"),void 0===c&&(c=2),void 0===u&&(u=!0),o.call(this,t,"Rope"),this.anims=new i(this),this.points=c,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===r,this.dirty=!1,this.horizontal=u,this._flipX=!1,this._flipY=!1,this._perp=new l,this.debugCallback=null,this.debugGraphic=null,this.setTexture(r,s),this.setPosition(e,n),this.setSizeToFrame(),this.initPipeline(a.ROPE_PIPELINE),this.initPostPipeline(),Array.isArray(c)&&this.resizeArrays(c.length),this.setPoints(c,h,d),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){var n=this.anims.currentFrame;this.anims.update(t,e),this.anims.currentFrame!==n&&(this.updateUVs(),this.updateVertices())},play:function(t,e,n){return this.anims.play(t,e,n),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(t,e,n){return void 0===t&&(t=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(t,e,n))},setVertical:function(t,e,n){return void 0===t&&(t=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(t,e,n)):this},setTintFill:function(t){return void 0===t&&(t=!1),this.tintFill=t,this},setAlphas:function(t,e){var n=this.points.length;if(n<1)return this;var i,r=this.alphas;void 0===t?t=[1]:Array.isArray(t)||void 0!==e||(t=[t]);var s=0;if(void 0!==e)for(i=0;i<n;i++)r[s=2*i]=t,r[s+1]=e;else if(t.length===n)for(i=0;i<n;i++)r[s=2*i]=t[i],r[s+1]=t[i];else{var o=t[0];for(i=0;i<n;i++)s=2*i,t.length>s&&(o=t[s]),r[s]=o,t.length>s+1&&(o=t[s+1]),r[s+1]=o}return this},setColors:function(t){var e=this.points.length;if(e<1)return this;var n,i=this.colors;void 0===t?t=[16777215]:Array.isArray(t)||(t=[t]);var r=0;if(t.length===e)for(n=0;n<e;n++)i[r=2*n]=t[n],i[r+1]=t[n];else{var s=t[0];for(n=0;n<e;n++)r=2*n,t.length>r&&(s=t[r]),i[r]=s,t.length>r+1&&(s=t[r+1]),i[r+1]=s}return this},setPoints:function(t,e,n){if(void 0===t&&(t=2),"number"===typeof t){var i,r,s,o=t;if(o<2&&(o=2),t=[],this.horizontal)for(s=-this.frame.halfWidth,r=this.frame.width/(o-1),i=0;i<o;i++)t.push({x:s+i*r,y:0});else for(s=-this.frame.halfHeight,r=this.frame.height/(o-1),i=0;i<o;i++)t.push({x:0,y:s+i*r})}var a=t.length,c=this.points.length;return a<1?(console.warn("Rope: Not enough points given"),this):(1===a&&(t.unshift({x:0,y:0}),a++),c!==a&&this.resizeArrays(a),this.dirty=!0,this.points=t,this.updateUVs(),void 0!==e&&null!==e&&this.setColors(e),void 0!==n&&null!==n&&this.setAlphas(n),this)},updateUVs:function(){for(var t=this.uv,e=this.points.length,n=this.frame.u0,i=this.frame.v0,r=this.frame.u1,s=this.frame.v1,o=(r-n)/(e-1),a=(s-i)/(e-1),c=0;c<e;c++){var l,u,h,d,p=4*c;this.horizontal?(this._flipX?(l=r-c*o,h=r-c*o):(l=n+c*o,h=n+c*o),this._flipY?(u=s,d=i):(u=i,d=s)):(this._flipX?(l=n,h=r):(l=r,h=n),this._flipY?(u=s-c*a,d=s-c*a):(u=i+c*a,d=i+c*a)),t[p+0]=l,t[p+1]=u,t[p+2]=h,t[p+3]=d}return this},resizeArrays:function(t){var e=this.colors,n=this.alphas;this.vertices=new Float32Array(4*t),this.uv=new Float32Array(4*t),e=new Uint32Array(2*t),n=new Float32Array(2*t);for(var i=0;i<2*t;i++)e[i]=16777215,n[i]=1;return this.colors=e,this.alphas=n,this.dirty=!0,this},updateVertices:function(){var t=this._perp,e=this.points,n=this.vertices,i=e.length;if(this.dirty=!1,!(i<1)){for(var r,s=e[0],o=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,a=0;a<i;a++){var c=e[a],l=4*a;r=a<i-1?e[a+1]:c,t.x=r.y-s.y,t.y=-(r.x-s.x);var u=t.length();t.x/=u,t.y/=u,t.x*=o,t.y*=o,n[l]=c.x+t.x,n[l+1]=c.y+t.y,n[l+2]=c.x-t.x,n[l+3]=c.y-t.y,s=c}return this}},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts:function(t,e,n){var i=t.debugGraphic,r=n[0],s=n[1],o=n[2],a=n[3];i.lineBetween(r,s,o,a);for(var c=4;c<e;c+=4){var l=n[c+0],u=n[c+1],h=n[c+2],d=n[c+3];i.lineBetween(r,s,l,u),i.lineBetween(o,a,h,d),i.lineBetween(o,a,l,u),i.lineBetween(l,u,h,d),r=l,s=u,o=h,a=d}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(t){return this._flipX=t,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(t){return this._flipY=t,this.updateUVs()}}});t.exports=u},44598:t=>{t.exports=function(){}},96027:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(10850),a=n(79968);r.register("rope",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),c=s(t,"horizontal",!0),l=o(t,"points",void 0),u=o(t,"colors",void 0),h=o(t,"alphas",void 0),d=new a(this.scene,0,0,n,r,l,c,u,h);return void 0!==e&&(t.add=e),i(this.scene,d,t),d}))},31982:(t,e,n)=>{var i=n(79968);n(61286).register("rope",(function(t,e,n,r,s,o,a,c){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,c))}))},58912:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(49489),s=n(44598),t.exports={renderWebGL:r,renderCanvas:s}},49489:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline,e),a=i(e,n,s).calc,c=e.vertices,l=e.uv,u=e.colors,h=e.alphas,d=e.alpha,p=r.getTintAppendFloatAlpha,f=n.roundPixels,m=c.length,g=Math.floor(.5*m);o.flush(),t.pipelines.preBatch(e);var v=o.setGameObject(e),y=o.vertexViewF32,x=o.vertexViewU32,b=o.vertexCount*o.currentShader.vertexComponentCount-1,w=0,S=e.tintFill;e.dirty&&e.updateVertices();for(var _=e.debugCallback,T=[],E=0;E<m;E+=2){var C=c[E+0],k=c[E+1],A=C*a.a+k*a.c+a.e,I=C*a.b+k*a.d+a.f;f&&(A=Math.round(A),I=Math.round(I)),y[++b]=A,y[++b]=I,y[++b]=l[E+0],y[++b]=l[E+1],y[++b]=v,y[++b]=S,x[++b]=p(u[w],n.alpha*(h[w]*d)),w++,_&&(T[E+0]=A,T[E+1]=I)}_&&_.call(e,e,m,T),o.vertexCount+=g,o.currentBatch.count=o.vertexCount-o.currentBatch.start,t.pipelines.postBatch(e)}},27902:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(72632),a=n(98611),c=n(22440),l=n(24252),u=n(69360),h=new i({Extends:s,Mixins:[r.ComputedSize,r.Depth,r.GetBounds,r.Mask,r.Origin,r.ScrollFactor,r.Transform,r.Visible,l],initialize:function(t,e,n,i,r,o,a,c){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===o&&(o=128),s.call(this,t,"Shader"),this.blendMode=-1,this.shader;var l=t.sys.renderer;this.renderer=l,this.gl=l.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=l.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new u,this._tempMatrix2=new u,this._tempMatrix3=new u,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=l.width,this._rendererHeight=l.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,i),this.setSize(r,o),this.setOrigin(.5,.5),this.setShader(e,a,c)},willRender:function(t){return!!this.renderToTexture||!(s.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(void 0===e&&(e=!1),!this.renderToTexture){var n=this.width,i=this.height,r=this.renderer;this.glTexture=r.createTextureFromSource(null,n,i,0),this.glTexture.flipY=e,this.framebuffer=r.createFramebuffer(n,i,this.glTexture,!1),this._rendererWidth=n,this._rendererHeight=i,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture,n,i))}return this.shader&&(r.pipelines.clear(),this.load(),this.flush(),r.pipelines.rebind()),this},setShader:function(t,e,n){if(void 0===e&&(e=[]),"string"===typeof t){var i=this.scene.sys.cache.shader;if(!i.has(t))return console.warn("Shader missing: "+t),this;this.shader=i.get(t)}else this.shader=t;var r=this.gl,s=this.renderer;this.program&&r.deleteProgram(this.program);var o=s.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.uniformMatrix4fv(r.getUniformLocation(o,"uViewMatrix"),!1,this.viewMatrix),r.uniformMatrix4fv(r.getUniformLocation(o,"uProjectionMatrix"),!1,this.projectionMatrix),r.uniform2f(r.getUniformLocation(o,"uResolution"),this.width,this.height),this.program=o;var c=new Date,l={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[c.getFullYear(),c.getMonth(),c.getDate(),60*c.getHours()*60+60*c.getMinutes()+c.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=a(!0,{},this.shader.uniforms,l):this.uniforms=l;for(var u=0;u<4;u++)e[u]&&this.setSampler2D("iChannel"+u,e[u],u,n);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,n,i){var r=1/(t-e),s=1/(n-i),o=this.projectionMatrix;o[0]=-2*r,o[5]=-2*s,o[10]=-.001,o[12]=(t+e)*r,o[13]=(i+n)*s,o[14]=-0;var a=this.program,c=this.gl;this.renderer.setProgram(a),c.uniformMatrix4fv(c.getUniformLocation(a,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=n},initUniforms:function(){var t=this.gl,e=this.renderer.glFuncMap,n=this.program;for(var i in this._textureCount=0,this.uniforms){var r=this.uniforms[i],s=r.type,o=e[s];r.uniformLocation=t.getUniformLocation(n,i),"sampler2D"!==s&&(r.glMatrix=o.matrix,r.glValueLength=o.length,r.glFunc=o.func)}},setSampler2DBuffer:function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s={});var o=this.uniforms[t];return o.value=e,s.width=n,s.height=i,o.textureData=s,this._textureCount=r,this.initSampler2D(o),this},setSampler2D:function(t,e,n,i){void 0===n&&(n=0);var r=this.scene.sys.textures;if(r.exists(e)){var s=r.getFrame(e);if(s.glTexture&&s.glTexture.isRenderTexture)return this.setSampler2DBuffer(t,s.glTexture,s.width,s.height,n,i);var o=this.uniforms[t],a=s.source;o.textureKey=e,o.source=a.image,o.value=s.glTexture,a.isGLTexture&&(i||(i={}),i.width=a.width,i.height=a.height),i&&(o.textureData=i),this._textureCount=n,this.initSampler2D(o)}return this},setUniform:function(t,e){return c(this.uniforms,t,e),this},getUniform:function(t){return o(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=this.gl;e.activeTexture(e.TEXTURE0+this._textureCount),e.bindTexture(e.TEXTURE_2D,t.value);var n=t.textureData;if(n&&!t.value.isRenderTexture){var i=e[o(n,"magFilter","linear").toUpperCase()],r=e[o(n,"minFilter","linear").toUpperCase()],s=e[o(n,"wrapS","repeat").toUpperCase()],a=e[o(n,"wrapT","repeat").toUpperCase()],c=e[o(n,"format","rgba").toUpperCase()];if(n.repeat&&(s=e.REPEAT,a=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var l=o(n,"width",512),u=o(n,"height",2),h=o(n,"border",0);e.texImage2D(e.TEXTURE_2D,0,c,l,u,h,c,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,c,e.RGBA,e.UNSIGNED_BYTE,t.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a)}this.renderer.setProgram(this.program),e.uniform1i(t.uniformLocation,this._textureCount),this._textureCount++}},syncUniforms:function(){var t,e,n,i,r,s=this.gl,o=this.uniforms,a=0;for(var c in o)n=(t=o[c]).glFunc,e=t.glValueLength,i=t.uniformLocation,null!==(r=t.value)&&(1===e?t.glMatrix?n.call(s,i,t.transpose,r):n.call(s,i,r):2===e?n.call(s,i,r.x,r.y):3===e?n.call(s,i,r.x,r.y,r.z):4===e?n.call(s,i,r.x,r.y,r.z,r.w):"sampler2D"===t.type&&(s.activeTexture(s.TEXTURE0+a),s.bindTexture(s.TEXTURE_2D,r),s.uniform1i(i,a),a++))},load:function(t){var e=this.gl,n=this.width,i=this.height,r=this.renderer,s=this.program,o=this.viewMatrix;if(!this.renderToTexture){var a=-this._displayOriginX,c=-this._displayOriginY;o[0]=t[0],o[1]=t[1],o[4]=t[2],o[5]=t[3],o[8]=t[4],o[9]=t[5],o[12]=o[0]*a+o[4]*c,o[13]=o[1]*a+o[5]*c}e.useProgram(s),e.uniformMatrix4fv(e.getUniformLocation(s,"uViewMatrix"),!1,o),e.uniform2f(e.getUniformLocation(s,"uResolution"),this.width,this.height);var l=this.uniforms,u=l.resolution;u.value.x=n,u.value.y=i,l.time.value=r.game.loop.getDuration();var h=this.pointer;if(h){var d=l.mouse,p=h.x/n,f=1-h.y/i;d.value.x=p.toFixed(2),d.value.y=f.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,n=this.program,i=this.gl,r=this.vertexBuffer,s=this.renderer,o=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(s.setFramebuffer(this.framebuffer),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)),i.bindBuffer(i.ARRAY_BUFFER,r);var a=i.getAttribLocation(n,"inPosition");-1!==a&&(i.enableVertexAttribArray(a),i.vertexAttribPointer(a,2,i.FLOAT,!1,o,0));var c=this.vertexViewF32;c[3]=e,c[4]=t,c[5]=e,c[8]=t,c[9]=e,c[10]=t,i.bufferSubData(i.ARRAY_BUFFER,0,this.bytes.subarray(0,6*o)),i.drawArrays(i.TRIANGLES,0,6),this.renderToTexture&&s.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},preDestroy:function(){var t=this.gl;t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(this.renderer.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null)}});t.exports=h},10612:t=>{t.exports=function(){}},13908:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(27902);r.register("shader",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"x",0),a=s(t,"y",0),c=s(t,"width",128),l=s(t,"height",128),u=new o(this.scene,n,r,a,c,l);return void 0!==e&&(t.add=e),i(this.scene,u,t),u}))},51979:(t,e,n)=>{var i=n(27902);n(61286).register("shader",(function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))}))},24252:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(19782),s=n(10612),t.exports={renderWebGL:r,renderCanvas:s}},19782:(t,e,n)=>{var i=n(73329);t.exports=function(t,e,n,r){if(e.shader){if(n.addToRenderList(e),t.pipelines.clear(),e.renderToTexture)e.load(),e.flush();else{var s=i(e,n,r).calc;t.width===e._rendererWidth&&t.height===e._rendererHeight||e.projOrtho(0,t.width,t.height,0),e.load(s.matrix),e.flush()}t.pipelines.rebind()}}},19543:(t,e,n)=>{var i=n(75512);t.exports=function(t,e,n,r,s,o){for(var a=i.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*r),c=n.pathData,l=n.pathIndexes,u=0;u<l.length;u+=3){var h=2*l[u],d=2*l[u+1],p=2*l[u+2],f=c[h+0]-s,m=c[h+1]-o,g=c[d+0]-s,v=c[d+1]-o,y=c[p+0]-s,x=c[p+1]-o,b=e.getX(f,m),w=e.getY(f,m),S=e.getX(g,v),_=e.getY(g,v),T=e.getX(y,x),E=e.getY(y,x);t.batchTri(n,b,w,S,_,T,E,0,0,1,1,a,a,a,2)}}},15608:t=>{t.exports=function(t,e,n,i){var r=n||e.fillColor,s=i||e.fillAlpha,o=(16711680&r)>>>16,a=(65280&r)>>>8,c=255&r;t.fillStyle="rgba("+o+","+a+","+c+","+s+")"}},17876:t=>{t.exports=function(t,e,n,i){var r=n||e.strokeColor,s=i||e.strokeAlpha,o=(16711680&r)>>>16,a=(65280&r)>>>8,c=255&r;t.strokeStyle="rgba("+o+","+a+","+c+","+s+")",t.lineWidth=e.lineWidth}},91461:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(89980),o=n(88829),a=new i({Extends:s,Mixins:[r.AlphaSingle,r.BlendMode,r.Depth,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.PostPipeline,r.ScrollFactor,r.Transform,r.Visible],initialize:function(t,e,n){void 0===e&&(e="Shape"),s.call(this,t,e),this.geom=n,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new o,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,n){return void 0===n&&(n=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=n,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});t.exports=a},50262:(t,e,n)=>{var i=n(75512);t.exports=function(t,e,n,r,s){var o=t.strokeTint,a=i.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*n);o.TL=a,o.TR=a,o.BL=a,o.BR=a;var c=e.pathData,l=c.length-1,u=e.lineWidth,h=u/2,d=c[0]-r,p=c[1]-s;e.closePath||(l-=2);for(var f=2;f<l;f+=2){var m=c[f]-r,g=c[f+1]-s;t.batchLine(d,p,m,g,h,h,u,f-2,!!e.closePath&&f===l-1),d=m,p=g}}},28593:(t,e,n)=>{var i=n(2213),r=n(56694),s=n(75606),o=n(11117),a=n(26673),c=n(83392),l=n(91461),u=new r({Extends:l,Mixins:[i],initialize:function(t,e,n,i,r,s,o,c,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=0),void 0===s&&(s=360),void 0===o&&(o=!1),l.call(this,t,"Arc",new a(0,0,i)),this._startAngle=r,this._endAngle=s,this._anticlockwise=o,this._iterations=.01,this.setPosition(e,n);var h=2*this.geom.radius;this.setSize(h,h),void 0!==c&&this.setFillStyle(c,u),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,n=this.geom.radius,i=s(this._startAngle),r=s(this._endAngle),a=n,l=n;r-=i,this._anticlockwise?r<-c.PI2?r=-c.PI2:r>0&&(r=-c.PI2+r%c.PI2):r>c.PI2?r=c.PI2:r<0&&(r=c.PI2+r%c.PI2);for(var u,h=[a+Math.cos(i)*n,l+Math.sin(i)*n];e<1;)u=r*e+i,h.push(a+Math.cos(u)*n,l+Math.sin(u)*n),e+=t;return u=r+i,h.push(a+Math.cos(u)*n,l+Math.sin(u)*n),h.push(a+Math.cos(i)*n,l+Math.sin(i)*n),this.pathIndexes=o(h),this.pathData=h,this}});t.exports=u},23560:(t,e,n)=>{var i=n(75606),r=n(15608),s=n(17876),o=n(49584);t.exports=function(t,e,n,a){n.addToRenderList(e);var c=t.currentContext;if(o(t,c,e,n,a)){var l=e.radius;c.beginPath(),c.arc(l-e.originX*(2*l),l-e.originY*(2*l),l,i(e._startAngle),i(e._endAngle),e.anticlockwise),e.closePath&&c.closePath(),e.isFilled&&(r(c,e),c.fill()),e.isStroked&&(s(c,e),c.stroke()),c.restore()}}},10369:(t,e,n)=>{var i=n(28593),r=n(61286);r.register("arc",(function(t,e,n,r,s,o,a,c){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,c))})),r.register("circle",(function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,0,360,!1,r,s))}))},2213:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(58356),s=n(23560),t.exports={renderWebGL:r,renderCanvas:s}},58356:(t,e,n)=>{var i=n(73329),r=n(19543),s=n(50262);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=i(e,n,o),l=a.calcMatrix.copyFrom(c.calc),u=e._displayOriginX,h=e._displayOriginY,d=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&r(a,l,e,d,u,h),e.isStroked&&s(a,e,d,u,h),t.pipelines.postBatch(e)}},15220:(t,e,n)=>{var i=n(56694),r=n(87203),s=n(11117),o=n(74118),a=n(91461),c=new i({Extends:a,Mixins:[r],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),a.call(this,t,"Curve",i),this._smoothness=32,this._curveBounds=new o,this.closePath=!1,this.setPosition(e,n),void 0!==r&&this.setFillStyle(r,s),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],i=this.geom.getPoints(e),r=0;r<i.length;r++)n.push(i[r].x,i[r].y);return n.push(i[0].x,i[0].y),this.pathIndexes=s(n),this.pathData=n,this}});t.exports=c},4024:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX+e._curveBounds.x,l=e._displayOriginY+e._curveBounds.y,u=e.pathData,h=u.length-1,d=u[0]-c,p=u[1]-l;a.beginPath(),a.moveTo(d,p),e.closePath||(h-=2);for(var f=2;f<h;f+=2){var m=u[f]-c,g=u[f+1]-l;a.lineTo(m,g)}e.closePath&&a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},10147:(t,e,n)=>{var i=n(61286),r=n(15220);i.register("curve",(function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))}))},87203:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(82958),s=n(4024),t.exports={renderWebGL:r,renderCanvas:s}},82958:(t,e,n)=>{var i=n(19543),r=n(73329),s=n(50262);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=r(e,n,o),l=a.calcMatrix.copyFrom(c.calc),u=e._displayOriginX+e._curveBounds.x,h=e._displayOriginY+e._curveBounds.y,d=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,l,e,d,u,h),e.isStroked&&s(a,e,d,u,h),t.pipelines.postBatch(e)}},28591:(t,e,n)=>{var i=n(56694),r=n(11117),s=n(84171),o=n(95669),a=n(91461),c=new i({Extends:a,Mixins:[s],initialize:function(t,e,n,i,r,s,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=128),a.call(this,t,"Ellipse",new o(i/2,r/2,i,r)),this._smoothness=64,this.setPosition(e,n),this.width=i,this.height=r,void 0!==s&&this.setFillStyle(s,c),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setPosition(t/2,e/2),this.geom.setSize(t,e),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],e=this.geom.getPoints(this._smoothness),n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=r(t),this.pathData=t,this}});t.exports=c},55881:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX,l=e._displayOriginY,u=e.pathData,h=u.length-1,d=u[0]-c,p=u[1]-l;a.beginPath(),a.moveTo(d,p),e.closePath||(h-=2);for(var f=2;f<h;f+=2){var m=u[f]-c,g=u[f+1]-l;a.lineTo(m,g)}a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},99869:(t,e,n)=>{var i=n(28591);n(61286).register("ellipse",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},84171:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(17554),s=n(55881),t.exports={renderWebGL:r,renderCanvas:s}},17554:(t,e,n)=>{var i=n(19543),r=n(73329),s=n(50262);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=r(e,n,o),l=a.calcMatrix.copyFrom(c.calc),u=e._displayOriginX,h=e._displayOriginY,d=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,l,e,d,u,h),e.isStroked&&s(a,e,d,u,h),t.pipelines.postBatch(e)}},39169:(t,e,n)=>{var i=n(56694),r=n(91461),s=n(88059),o=new i({Extends:r,Mixins:[s],initialize:function(t,e,n,i,s,o,a,c,l,u,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===s&&(s=128),void 0===o&&(o=32),void 0===a&&(a=32),r.call(this,t,"Grid",null),this.cellWidth=o,this.cellHeight=a,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(e,n),this.setSize(i,s),this.setFillStyle(c,l),void 0!==u&&this.setOutlineStyle(u,h),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});t.exports=o},95525:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=-e._displayOriginX,l=-e._displayOriginY,u=n.alpha*e.alpha,h=e.width,d=e.height,p=e.cellWidth,f=e.cellHeight,m=Math.ceil(h/p),g=Math.ceil(d/f),v=p,y=f,x=p-(m*p-h),b=f-(g*f-d),w=e.showCells,S=e.showAltCells,_=e.showOutline,T=0,E=0,C=0,k=0,A=0;if(_&&(v--,y--,x===p&&x--,b===f&&b--),w&&e.fillAlpha>0)for(i(a,e),E=0;E<g;E++)for(S&&(C=E%2),T=0;T<m;T++)S&&C?C=0:(C++,k=T<m-1?v:x,A=E<g-1?y:b,a.fillRect(c+T*p,l+E*f,k,A));if(S&&e.altFillAlpha>0)for(i(a,e,e.altFillColor,e.altFillAlpha*u),E=0;E<g;E++)for(S&&(C=E%2),T=0;T<m;T++)!S||C?(C=0,k=T<m-1?v:x,A=E<g-1?y:b,a.fillRect(c+T*p,l+E*f,k,A)):C=1;if(_&&e.outlineFillAlpha>0){for(r(a,e,e.outlineFillColor,e.outlineFillAlpha*u),T=1;T<m;T++){var I=T*p;a.beginPath(),a.moveTo(I+c,l),a.lineTo(I+c,d+l),a.stroke()}for(E=1;E<g;E++){var O=E*f;a.beginPath(),a.moveTo(c,O+l),a.lineTo(c+h,O+l),a.stroke()}}a.restore()}}},9326:(t,e,n)=>{var i=n(61286),r=n(39169);i.register("grid",(function(t,e,n,i,s,o,a,c,l,u){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,c,l,u))}))},88059:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(50639),s=n(95525),t.exports={renderWebGL:r,renderCanvas:s}},50639:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s);o.calcMatrix.copyFrom(a.calc).translate(-e._displayOriginX,-e._displayOriginY);var c,l,u=n.alpha*e.alpha,h=e.width,d=e.height,p=e.cellWidth,f=e.cellHeight,m=Math.ceil(h/p),g=Math.ceil(d/f),v=p,y=f,x=p-(m*p-h),b=f-(g*f-d),w=e.showCells,S=e.showAltCells,_=e.showOutline,T=0,E=0,C=0,k=0,A=0;if(_&&(v--,y--,x===p&&x--,b===f&&b--),t.pipelines.preBatch(e),w&&e.fillAlpha>0)for(c=o.fillTint,l=r.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*u),c.TL=l,c.TR=l,c.BL=l,c.BR=l,E=0;E<g;E++)for(S&&(C=E%2),T=0;T<m;T++)S&&C?C=0:(C++,k=T<m-1?v:x,A=E<g-1?y:b,o.batchFillRect(T*p,E*f,k,A));if(S&&e.altFillAlpha>0)for(c=o.fillTint,l=r.getTintAppendFloatAlpha(e.altFillColor,e.altFillAlpha*u),c.TL=l,c.TR=l,c.BL=l,c.BR=l,E=0;E<g;E++)for(S&&(C=E%2),T=0;T<m;T++)!S||C?(C=0,k=T<m-1?v:x,A=E<g-1?y:b,o.batchFillRect(T*p,E*f,k,A)):C=1;if(_&&e.outlineFillAlpha>0){var I=o.strokeTint,O=r.getTintAppendFloatAlpha(e.outlineFillColor,e.outlineFillAlpha*u);for(I.TL=O,I.TR=O,I.BL=O,I.BR=O,T=1;T<m;T++){var R=T*p;o.batchLine(R,0,R,d,1,1,1,0,!1)}for(E=1;E<g;E++){var N=E*f;o.batchLine(0,N,h,N,1,1,1,0,!1)}}t.pipelines.postBatch(e)}},4415:(t,e,n)=>{var i=n(72296),r=n(56694),s=n(91461),o=new r({Extends:s,Mixins:[i],initialize:function(t,e,n,i,r,o,a,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=15658734),void 0===a&&(a=10066329),void 0===c&&(c=13421772),s.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=o,this.fillLeft=a,this.fillRight=c,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},32884:(t,e,n)=>{var i=n(15608),r=n(49584);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)&&e.isFilled){var a=e.width,c=e.height,l=a/2,u=a/e.projection;e.showTop&&(i(o,e,e.fillTop),o.beginPath(),o.moveTo(-l,-c),o.lineTo(0,-u-c),o.lineTo(l,-c),o.lineTo(l,-1),o.lineTo(0,u-1),o.lineTo(-l,-1),o.lineTo(-l,-c),o.fill()),e.showLeft&&(i(o,e,e.fillLeft),o.beginPath(),o.moveTo(-l,0),o.lineTo(0,u),o.lineTo(0,u-c),o.lineTo(-l,-c),o.lineTo(-l,0),o.fill()),e.showRight&&(i(o,e,e.fillRight),o.beginPath(),o.moveTo(l,0),o.lineTo(0,u),o.lineTo(0,u-c),o.lineTo(l,-c),o.lineTo(l,0),o.fill()),o.restore()}}},88154:(t,e,n)=>{var i=n(61286),r=n(4415);i.register("isobox",(function(t,e,n,i,s,o,a){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a))}))},72296:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(33101),s=n(32884),t.exports={renderWebGL:r,renderCanvas:s}},33101:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){n.addToRenderList(e);var o,a,c,l,u,h,d,p,f,m=t.pipelines.set(e.pipeline),g=i(e,n,s),v=m.calcMatrix.copyFrom(g.calc),y=e.width,x=e.height,b=y/2,w=y/e.projection,S=n.alpha*e.alpha;e.isFilled&&(t.pipelines.preBatch(e),e.showTop&&(o=r.getTintAppendFloatAlpha(e.fillTop,S),a=v.getX(-b,-x),c=v.getY(-b,-x),l=v.getX(0,-w-x),u=v.getY(0,-w-x),h=v.getX(b,-x),d=v.getY(b,-x),p=v.getX(0,w-x),f=v.getY(0,w-x),m.batchQuad(e,a,c,l,u,h,d,p,f,0,0,1,1,o,o,o,o,2)),e.showLeft&&(o=r.getTintAppendFloatAlpha(e.fillLeft,S),a=v.getX(-b,0),c=v.getY(-b,0),l=v.getX(0,w),u=v.getY(0,w),h=v.getX(0,w-x),d=v.getY(0,w-x),p=v.getX(-b,-x),f=v.getY(-b,-x),m.batchQuad(e,a,c,l,u,h,d,p,f,0,0,1,1,o,o,o,o,2)),e.showRight&&(o=r.getTintAppendFloatAlpha(e.fillRight,S),a=v.getX(b,0),c=v.getY(b,0),l=v.getX(0,w),u=v.getY(0,w),h=v.getX(0,w-x),d=v.getY(0,w-x),p=v.getX(b,-x),f=v.getY(b,-x),m.batchQuad(e,a,c,l,u,h,d,p,f,0,0,1,1,o,o,o,o,2)),t.pipelines.postBatch(e))}},65159:(t,e,n)=>{var i=n(56694),r=n(93387),s=n(91461),o=new i({Extends:s,Mixins:[r],initialize:function(t,e,n,i,r,o,a,c,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=!1),void 0===a&&(a=15658734),void 0===c&&(c=10066329),void 0===l&&(l=13421772),s.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=a,this.fillLeft=c,this.fillRight=l,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=o,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},9923:(t,e,n)=>{var i=n(15608),r=n(49584);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)&&e.isFilled){var a=e.width,c=e.height,l=a/2,u=a/e.projection,h=e.isReversed;e.showTop&&h&&(i(o,e,e.fillTop),o.beginPath(),o.moveTo(-l,-c),o.lineTo(0,-u-c),o.lineTo(l,-c),o.lineTo(0,u-c),o.fill()),e.showLeft&&(i(o,e,e.fillLeft),o.beginPath(),h?(o.moveTo(-l,-c),o.lineTo(0,u),o.lineTo(0,u-c)):(o.moveTo(-l,0),o.lineTo(0,u),o.lineTo(0,u-c)),o.fill()),e.showRight&&(i(o,e,e.fillRight),o.beginPath(),h?(o.moveTo(l,-c),o.lineTo(0,u),o.lineTo(0,u-c)):(o.moveTo(l,0),o.lineTo(0,u),o.lineTo(0,u-c)),o.fill()),o.restore()}}},67765:(t,e,n)=>{var i=n(61286),r=n(65159);i.register("isotriangle",(function(t,e,n,i,s,o,a,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,c))}))},93387:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(54946),s=n(9923),t.exports={renderWebGL:r,renderCanvas:s}},54946:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s),c=o.calcMatrix.copyFrom(a.calc),l=e.width,u=e.height,h=l/2,d=l/e.projection,p=e.isReversed,f=n.alpha*e.alpha;if(e.isFilled){var m,g,v,y,x,b,w;if(t.pipelines.preBatch(e),e.showTop&&p){m=r.getTintAppendFloatAlpha(e.fillTop,f),g=c.getX(-h,-u),v=c.getY(-h,-u),y=c.getX(0,-d-u),x=c.getY(0,-d-u),b=c.getX(h,-u),w=c.getY(h,-u);var S=c.getX(0,d-u),_=c.getY(0,d-u);o.batchQuad(e,g,v,y,x,b,w,S,_,0,0,1,1,m,m,m,m,2)}e.showLeft&&(m=r.getTintAppendFloatAlpha(e.fillLeft,f),p?(g=c.getX(-h,-u),v=c.getY(-h,-u),y=c.getX(0,d),x=c.getY(0,d),b=c.getX(0,d-u),w=c.getY(0,d-u)):(g=c.getX(-h,0),v=c.getY(-h,0),y=c.getX(0,d),x=c.getY(0,d),b=c.getX(0,d-u),w=c.getY(0,d-u)),o.batchTri(e,g,v,y,x,b,w,0,0,1,1,m,m,m,2)),e.showRight&&(m=r.getTintAppendFloatAlpha(e.fillRight,f),p?(g=c.getX(h,-u),v=c.getY(h,-u),y=c.getX(0,d),x=c.getY(0,d),b=c.getX(0,d-u),w=c.getY(0,d-u)):(g=c.getX(h,0),v=c.getY(h,0),y=c.getX(0,d),x=c.getY(0,d),b=c.getX(0,d-u),w=c.getY(0,d-u)),o.batchTri(e,g,v,y,x,b,w,0,0,1,1,m,m,m,2)),t.pipelines.postBatch(e)}}},579:(t,e,n)=>{var i=n(56694),r=n(91461),s=n(88829),o=n(52660),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,c,l,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=128),void 0===c&&(c=0),r.call(this,t,"Line",new s(i,o,a,c));var h=Math.max(1,this.geom.right-this.geom.left),d=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(e,n),this.setSize(h,d),void 0!==l&&this.setStrokeStyle(1,l,u),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,n,i){return this.geom.setTo(t,e,n,i),this}});t.exports=a},52044:(t,e,n)=>{var i=n(17876),r=n(49584);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.currentContext;if(r(t,o,e,n,s)){var a=e._displayOriginX,c=e._displayOriginY;e.isStroked&&(i(o,e),o.beginPath(),o.moveTo(e.geom.x1-a,e.geom.y1-c),o.lineTo(e.geom.x2-a,e.geom.y2-c),o.stroke()),o.restore()}}},85665:(t,e,n)=>{var i=n(61286),r=n(579);i.register("line",(function(t,e,n,i,s,o,a,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,c))}))},52660:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(46952),s=n(52044),t.exports={renderWebGL:r,renderCanvas:s}},46952:(t,e,n)=>{var i=n(73329),r=n(75512);t.exports=function(t,e,n,s){n.addToRenderList(e);var o=t.pipelines.set(e.pipeline),a=i(e,n,s);o.calcMatrix.copyFrom(a.calc);var c=e._displayOriginX,l=e._displayOriginY,u=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isStroked){var h=o.strokeTint,d=r.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*u);h.TL=d,h.TR=d,h.BL=d,h.BR=d,o.batchLine(e.geom.x1-c,e.geom.y1-l,e.geom.x2-c,e.geom.y2-l,e._startWidth/2,e._endWidth/2,1,0,!1,a.sprite,a.camera)}t.pipelines.postBatch(e)}},91249:(t,e,n)=>{var i=n(70573),r=n(56694),s=n(11117),o=n(14045),a=n(8580),c=n(91461),l=n(18974),u=new r({Extends:c,Mixins:[i],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),c.call(this,t,"Polygon",new a(i));var l=o(this.geom);this.setPosition(e,n),this.setSize(l.width,l.height),void 0!==r&&this.setFillStyle(r,s),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)l(this.geom);return this.updateData()},setTo:function(t){this.geom.setTo(t);var e=o(this.geom);return this.setSize(e.width,e.height),this.updateDisplayOrigin(),this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=u},40834:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX,l=e._displayOriginY,u=e.pathData,h=u.length-1,d=u[0]-c,p=u[1]-l;a.beginPath(),a.moveTo(d,p),e.closePath||(h-=2);for(var f=2;f<h;f+=2){var m=u[f]-c,g=u[f+1]-l;a.lineTo(m,g)}e.closePath&&a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},88203:(t,e,n)=>{var i=n(61286),r=n(91249);i.register("polygon",(function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))}))},70573:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(72841),s=n(40834),t.exports={renderWebGL:r,renderCanvas:s}},72841:(t,e,n)=>{var i=n(19543),r=n(73329),s=n(50262);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=r(e,n,o),l=a.calcMatrix.copyFrom(c.calc),u=e._displayOriginX,h=e._displayOriginY,d=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,l,e,d,u,h),e.isStroked&&s(a,e,d,u,h),t.pipelines.postBatch(e)}},517:(t,e,n)=>{var i=n(56694),r=n(74118),s=n(91461),o=n(37673),a=new i({Extends:s,Mixins:[o],initialize:function(t,e,n,i,o,a,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===o&&(o=128),s.call(this,t,"Rectangle",new r(0,0,i,o)),this.setPosition(e,n),this.setSize(i,o),void 0!==a&&this.setFillStyle(a,c),this.updateDisplayOrigin(),this.updateData()},setSize:function(t,e){this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this.updateDisplayOrigin();var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),e.getLineD(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},4091:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX,l=e._displayOriginY;e.isFilled&&(i(a,e),a.fillRect(-c,-l,e.width,e.height)),e.isStroked&&(r(a,e),a.beginPath(),a.rect(-c,-l,e.width,e.height),a.stroke()),a.restore()}}},94355:(t,e,n)=>{var i=n(61286),r=n(517);i.register("rectangle",(function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))}))},37673:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(43532),s=n(4091),t.exports={renderWebGL:r,renderCanvas:s}},43532:(t,e,n)=>{var i=n(73329),r=n(50262),s=n(75512);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=i(e,n,o);a.calcMatrix.copyFrom(c.calc);var l=e._displayOriginX,u=e._displayOriginY,h=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isFilled){var d=a.fillTint,p=s.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*h);d.TL=p,d.TR=p,d.BL=p,d.BR=p,a.batchFillRect(-l,-u,e.width,e.height)}e.isStroked&&r(a,e,h,l,u),t.pipelines.postBatch(e)}},77843:(t,e,n)=>{var i=n(87956),r=n(56694),s=n(11117),o=n(91461),a=new r({Extends:o,Mixins:[i],initialize:function(t,e,n,i,r,s,a,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=5),void 0===r&&(r=32),void 0===s&&(s=64),o.call(this,t,"Star",null),this._points=i,this._innerRadius=r,this._outerRadius=s,this.setPosition(e,n),this.setSize(2*s,2*s),void 0!==a&&this.setFillStyle(a,c),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,i=this._outerRadius,r=Math.PI/2*3,o=Math.PI/e,a=i,c=i;t.push(a,c+-i);for(var l=0;l<e;l++)t.push(a+Math.cos(r)*i,c+Math.sin(r)*i),r+=o,t.push(a+Math.cos(r)*n,c+Math.sin(r)*n),r+=o;return t.push(a,c+-i),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=a},11401:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX,l=e._displayOriginY,u=e.pathData,h=u.length-1,d=u[0]-c,p=u[1]-l;a.beginPath(),a.moveTo(d,p),e.closePath||(h-=2);for(var f=2;f<h;f+=2){var m=u[f]-c,g=u[f+1]-l;a.lineTo(m,g)}a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},23962:(t,e,n)=>{var i=n(77843);n(61286).register("star",(function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))}))},87956:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(12037),s=n(11401),t.exports={renderWebGL:r,renderCanvas:s}},12037:(t,e,n)=>{var i=n(19543),r=n(73329),s=n(50262);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=r(e,n,o),l=a.calcMatrix.copyFrom(c.calc),u=e._displayOriginX,h=e._displayOriginY,d=n.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&i(a,l,e,d,u,h),e.isStroked&&s(a,e,d,u,h),t.pipelines.postBatch(e)}},21873:(t,e,n)=>{var i=n(56694),r=n(91461),s=n(66349),o=n(70498),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,c,l,u,h,d){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=128),void 0===a&&(a=64),void 0===c&&(c=0),void 0===l&&(l=128),void 0===u&&(u=128),r.call(this,t,"Triangle",new s(i,o,a,c,l,u));var p=this.geom.right-this.geom.left,f=this.geom.bottom-this.geom.top;this.setPosition(e,n),this.setSize(p,f),void 0!==h&&this.setFillStyle(h,d),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,n,i,r,s){return this.geom.setTo(t,e,n,i,r,s),this.updateData()},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},60213:(t,e,n)=>{var i=n(15608),r=n(17876),s=n(49584);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.currentContext;if(s(t,a,e,n,o)){var c=e._displayOriginX,l=e._displayOriginY,u=e.geom.x1-c,h=e.geom.y1-l,d=e.geom.x2-c,p=e.geom.y2-l,f=e.geom.x3-c,m=e.geom.y3-l;a.beginPath(),a.moveTo(u,h),a.lineTo(d,p),a.lineTo(f,m),a.closePath(),e.isFilled&&(i(a,e),a.fill()),e.isStroked&&(r(a,e),a.stroke()),a.restore()}}},79296:(t,e,n)=>{var i=n(61286),r=n(21873);i.register("triangle",(function(t,e,n,i,s,o,a,c,l,u){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,c,l,u))}))},70498:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(72291),s=n(60213),t.exports={renderWebGL:r,renderCanvas:s}},72291:(t,e,n)=>{var i=n(73329),r=n(50262),s=n(75512);t.exports=function(t,e,n,o){n.addToRenderList(e);var a=t.pipelines.set(e.pipeline),c=i(e,n,o);a.calcMatrix.copyFrom(c.calc);var l=e._displayOriginX,u=e._displayOriginY,h=n.alpha*e.alpha;if(t.pipelines.preBatch(e),e.isFilled){var d=a.fillTint,p=s.getTintAppendFloatAlpha(e.fillColor,e.fillAlpha*h);d.TL=p,d.TR=p,d.BL=p,d.BR=p;var f=e.geom.x1-l,m=e.geom.y1-u,g=e.geom.x2-l,v=e.geom.y2-u,y=e.geom.x3-l,x=e.geom.y3-u;a.batchFillTriangle(f,m,g,v,y,x,c.sprite,c.camera)}e.isStroked&&r(a,e,h,l,u),t.pipelines.postBatch(e)}},13747:(t,e,n)=>{var i=n(16569),r=n(56694),s=n(64937),o=n(89980),a=n(20791),c=new r({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,a],initialize:function(t,e,n,r,s){o.call(this,t,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(r,s),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return s.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});t.exports=c},27573:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},89219:(t,e,n)=>{var i=n(88933),r=n(32291),s=n(99325),o=n(20494),a=n(13747);s.register("sprite",(function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),c=new a(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),i(this.scene,c,t),r(c,t),c}))},66135:(t,e,n)=>{var i=n(61286),r=n(13747);i.register("sprite",(function(t,e,n,i){return this.displayList.add(new r(this.scene,t,e,n,i))}))},20791:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(21034),s=n(27573),t.exports={renderWebGL:r,renderCanvas:s}},21034:t=>{t.exports=function(t,e,n,i){n.addToRenderList(e),e.pipeline.batchSprite(e,n,i)}},32979:t=>{t.exports=function(t,e,n){var i=t.canvas,r=t.context,s=t.style,o=[],a=0,c=n.length;s.maxLines>0&&s.maxLines<n.length&&(c=s.maxLines),s.syncFont(i,r);for(var l=0;l<c;l++){var u=s.strokeThickness;u+=r.measureText(n[l]).width,n[l].length>1&&(u+=t.letterSpacing*(n[l].length-1)),s.wordWrap&&(u-=r.measureText(" ").width),o[l]=Math.ceil(u),a=Math.max(a,o[l])}var h=e.fontSize+s.strokeThickness,d=h*c,p=t.lineSpacing;return c>1&&(d+=p*(c-1)),{width:a,height:d,lines:c,lineWidths:o,lineSpacing:p,lineHeight:h}}},27030:(t,e,n)=>{var i=n(61068);t.exports=function(t){var e=i.create(this),n=e.getContext("2d",{willReadFrequently:!0});t.syncFont(e,n);var r=n.measureText(t.testString);if("actualBoundingBoxAscent"in r){var s=r.actualBoundingBoxAscent,o=r.actualBoundingBoxDescent;return i.remove(e),{ascent:s,descent:o,fontSize:s+o}}var a=Math.ceil(r.width*t.baselineX),c=a,l=2*c;c=c*t.baselineY|0,e.width=a,e.height=l,n.fillStyle="#f00",n.fillRect(0,0,a,l),n.font=t._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(t.testString,0,c);var u={ascent:0,descent:0,fontSize:0},h=n.getImageData(0,0,a,l);if(!h)return u.ascent=c,u.descent=c+6,u.fontSize=u.ascent+u.descent,i.remove(e),u;var d,p,f=h.data,m=f.length,g=4*a,v=0,y=!1;for(d=0;d<c;d++){for(p=0;p<g;p+=4)if(255!==f[v+p]){y=!0;break}if(y)break;v+=g}for(u.ascent=c-d,v=m-g,y=!1,d=l;d>c;d--){for(p=0;p<g;p+=4)if(255!==f[v+p]){y=!0;break}if(y)break;v-=g}return u.descent=d-c,u.fontSize=u.ascent+u.descent,i.remove(e),u}},76555:(t,e,n)=>{var i=n(99584),r=n(61068),s=n(56694),o=n(64937),a=n(89980),c=n(32979),l=n(10850),u=n(55638),h=n(80032),d=n(74744),p=new s({Extends:a,Mixins:[o.Alpha,o.BlendMode,o.ComputedSize,o.Crop,o.Depth,o.Flip,o.GetBounds,o.Mask,o.Origin,o.Pipeline,o.PostPipeline,o.ScrollFactor,o.Tint,o.Transform,o.Visible,h],initialize:function(t,e,n,i,s){void 0===e&&(e=0),void 0===n&&(n=0),a.call(this,t,"Text"),this.renderer=t.sys.renderer,this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=r.create(this),this.context,this.style=new d(this,s),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.context=this.texture.context,this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(i),s&&s.padding&&this.setPadding(s.padding),s&&s.lineSpacing&&this.setLineSpacing(s.lineSpacing)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var n=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(n)&&(n=n.join("\n")),n}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,n){for(var i="",r=t.replace(/ +/gi," ").split(this.splitRegExp),s=r.length,o=0;o<s;o++){var a=r[o],c="";if(a=a.replace(/^ *|\s*$/gi,""),e.measureText(a).width<n)i+=a+"\n";else{for(var l=n,u=a.split(" "),h=0;h<u.length;h++){var d=u[h],p=d+" ",f=e.measureText(p).width;if(f>l){if(0===h){for(var m=p;m.length&&(m=m.slice(0,-1),!((f=e.measureText(m).width)<=l)););if(!m.length)throw new Error("wordWrapWidth < a single character");var g=d.substr(m.length);u[h]=g,c+=m}var v=u[h].length?h:h+1,y=u.slice(v).join(" ").replace(/[ \n]*$/gi,"");r.splice(o+1,0,y),s=r.length;break}c+=p,l-=f}i+=c.replace(/[ \n]*$/gi,"")+"\n"}}return i=i.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,n){for(var i="",r=t.split(this.splitRegExp),s=r.length-1,o=e.measureText(" ").width,a=0;a<=s;a++){for(var c=n,l=r[a].split(" "),u=l.length-1,h=0;h<=u;h++){var d=l[h],p=e.measureText(d).width,f=p;h<u&&(f+=o),f>c&&h>0&&(i+="\n",c=n),i+=d,h<u?(i+=" ",c-=f):c-=p}a<s&&(i+="\n")}return i},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},appendText:function(t,e){void 0===e&&(e=!0),t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t=t.toString();var n=this._text.concat(e?"\n"+t:t);return n!==this._text&&(this._text=n,this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,n,i,r,s){return this.style.setShadow(t,e,n,i,r,s)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setLetterSpacing:function(t){return this.letterSpacing=t,this.updateText()},setPadding:function(t,e,n,i){if("object"===typeof t){var r=t,s=l(r,"x",null);null!==s?(t=s,n=s):(t=l(r,"left",0),n=l(r,"right",t));var o=l(r,"y",null);null!==o?(e=o,i=o):(e=l(r,"top",0),i=l(r,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=e);return this.padding.left=t,this.padding.top=e,this.padding.right=n,this.padding.bottom=i,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},setRTL:function(t){void 0===t&&(t=!0);var e=this.style;return e.rtl===t||(e.rtl=t,t?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),"left"===e.align?e.align="right":"right"===e.align&&(e.align="left")),this},updateText:function(){var t=this.canvas,e=this.context,n=this.style,i=n.resolution,r=n.metrics;n.syncFont(t,e);var s=this._text;(n.wordWrapWidth||n.wordWrapCallback)&&(s=this.runWordWrap(this._text));var o,a=s.split(this.splitRegExp),l=c(this,r,a),u=this.padding;0===n.fixedWidth?(this.width=l.width+u.left+u.right,o=l.width):(this.width=n.fixedWidth,(o=this.width-u.left-u.right)<l.width&&(o=l.width)),0===n.fixedHeight?this.height=l.height+u.top+u.bottom:this.height=n.fixedHeight;var h,d,p=this.width,f=this.height;this.updateDisplayOrigin(),p*=i,f*=i,p=Math.max(p,1),f=Math.max(f,1),t.width!==p||t.height!==f?(t.width=p,t.height=f,this.frame.setSize(p,f),n.syncFont(t,e),n.rtl&&(e.direction="rtl")):e.clearRect(0,0,p,f),e.save(),e.scale(i,i),n.backgroundColor&&(e.fillStyle=n.backgroundColor,e.fillRect(0,0,p,f)),n.syncStyle(t,e),e.translate(u.left,u.top);for(var m=0;m<l.lines;m++){if(h=n.strokeThickness/2,d=n.strokeThickness/2+m*l.lineHeight+r.ascent,m>0&&(d+=l.lineSpacing*m),n.rtl)h=p-h-u.left-u.right;else if("right"===n.align)h+=o-l.lineWidths[m];else if("center"===n.align)h+=(o-l.lineWidths[m])/2;else if("justify"===n.align&&l.lineWidths[m]/l.width>=.85){var g=l.width-l.lineWidths[m],v=e.measureText(" ").width,y=a[m].trim(),x=y.split(" ");g+=(a[m].length-y.length)*v;for(var b=Math.floor(g/v),w=0;b>0;)x[w]+=" ",w=(w+1)%(x.length-1||1),--b;a[m]=x.join(" ")}if(this.autoRound&&(h=Math.round(h),d=Math.round(d)),n.strokeThickness&&(n.syncShadow(e,n.shadowStroke),e.strokeText(a[m],h,d)),n.color){n.syncShadow(e,n.shadowFill);var S=this.letterSpacing;if(0!==S)for(var _=0,T=a[m].split(""),E=0;E<T.length;E++)e.fillText(T[E],h+_,d),_+=e.measureText(T[E]).width+S;else e.fillText(a[m],h,d)}}e.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture);var C=this.input;return C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=o.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){u(this.canvas),r.remove(this.canvas),this.texture.destroy()}});t.exports=p},71649:t=>{t.exports=function(t,e,n,i){0!==e.width&&0!==e.height&&(n.addToRenderList(e),t.batchSprite(e,e.frame,n,i))}},75397:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(76555);r.register("text",(function(t,e){void 0===t&&(t={});var n=s(t,"text",""),r=s(t,"style",null),a=s(t,"padding",null);null!==a&&(r.padding=a);var c=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,c,t),c.autoRound=s(t,"autoRound",!0),c.resolution=s(t,"resolution",1),c}))},94627:(t,e,n)=>{var i=n(76555);n(61286).register("text",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},80032:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(76128),s=n(71649),t.exports={renderWebGL:r,renderCanvas:s}},74744:(t,e,n)=>{var i=n(56694),r=n(20494),s=n(10850),o=n(27030),a={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|M\xc3\u2030qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},c=new i({initialize:function(t,e){this.parent=t,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(e,!1,!0)},setStyle:function(t,e,n){for(var i in void 0===e&&(e=!0),void 0===n&&(n=!1),t&&t.hasOwnProperty("fontSize")&&"number"===typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),a){var c=n?a[i][1]:this[i];this[i]="wordWrapCallback"===i||"wordWrapCallbackScope"===i?s(t,a[i][0],c):r(t,a[i][0],c)}var l=s(t,"font",null);null!==l&&this.setFont(l,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var u=s(t,"fill",null);null!==u&&(this.color=u);var h=s(t,"metrics",!1);return h?this.metrics={ascent:s(h,"ascent",0),descent:s(h,"descent",0),fontSize:s(h,"fontSize",0)}:!e&&this.metrics||(this.metrics=o(this)),e?this.parent.updateText():this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=o(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,i="",r="";if("string"!==typeof t)n=s(t,"fontFamily","Courier"),i=s(t,"fontSize","16px"),r=s(t,"fontStyle","");else{var o=t.split(" "),a=0;r=o.length>2?o[a++]:"",i=o[a++]||"16px",n=o[a++]||"Courier"}return n===this.fontFamily&&i===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=i,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"===typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n="#000"),void 0===i&&(i=0),void 0===r&&(r=!1),void 0===s&&(s=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=n,this.shadowBlur=i,this.shadowStroke=r,this.shadowFill=s,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in a)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});t.exports=c},76128:(t,e,n)=>{var i=n(75512);t.exports=function(t,e,n,r){if(0!==e.width&&0!==e.height){n.addToRenderList(e);var s=e.frame,o=s.width,a=s.height,c=i.getTintAppendFloatAlpha,l=t.pipelines.set(e.pipeline,e),u=l.setTexture2D(s.glTexture,e);l.batchTexture(e,s.glTexture,o,a,e.x,e.y,o/e.style.resolution,a/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,o,a,c(e.tintTopLeft,n.alpha*e._alphaTL),c(e.tintTopRight,n.alpha*e._alphaTR),c(e.tintBottomLeft,n.alpha*e._alphaBL),c(e.tintBottomRight,n.alpha*e._alphaBR),e.tintFill,0,0,n,r,!1,u)}}},35856:(t,e,n)=>{var i=n(61068),r=n(56694),s=n(64937),o=n(89980),a=n(3504),c=n(8213),l=n(9271),u=n(93736),h=new r({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.ComputedSize,s.Crop,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Tint,s.Transform,s.Visible,l],initialize:function(t,e,n,r,s,c,l){var h=t.sys.renderer;o.call(this,t,"TileSprite");var d=t.sys.textures.get(c),p=d.get(l);p.source.compressionAlgorithm&&(console.warn("TileSprite cannot use compressed texture"),p=(d=t.sys.textures.get("__MISSING")).get()),"DynamicTexture"===d.type&&(console.warn("TileSprite cannot use Dynamic Texture"),p=(d=t.sys.textures.get("__MISSING")).get()),r&&s?(r=Math.floor(r),s=Math.floor(s)):(r=p.width,s=p.height),this._tilePosition=new u,this._tileScale=new u(1,1),this.dirty=!1,this.renderer=h,this.canvas=i.create(this,r,s),this.context=this.canvas.getContext("2d",{willReadFrequently:!1}),this.displayTexture=d,this.displayFrame=p,this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.potWidth=a(p.width),this.potHeight=a(p.height),this.fillCanvas=i.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d",{willReadFrequently:!1}),this.fillPattern=null,this.setPosition(e,n),this.setSize(r,s),this.setFrame(l),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){var e=this.displayTexture.get(t);return this.potWidth=a(e.width),this.potHeight=a(e.height),this.canvas.width=0,e.cutWidth&&e.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=e,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,n=this.fillCanvas,i=this.potWidth,r=this.potHeight;this.renderer&&this.renderer.gl||(i=t.cutWidth,r=t.cutHeight),e.clearRect(0,0,i,r),n.width=i,n.height=r,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,i,r),this.renderer&&this.renderer.gl?this.fillPattern=this.renderer.canvasToTexture(n,this.fillPattern):this.fillPattern=e.createPattern(n,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||c.disable(e);var n=this._tileScale.x,i=this._tileScale.y,r=this._tilePosition.x,s=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(n,i),e.translate(-r,-s),e.fillStyle=this.fillPattern,e.fillRect(r,s,this.width/n,this.height/i),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),i.remove(this.canvas),i.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null,this.texture.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});t.exports=h},93305:t=>{t.exports=function(t,e,n,i){e.updateCanvas(),n.addToRenderList(e),t.batchSprite(e,e.frame,n,i)}},63950:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(35856);r.register("tileSprite",(function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",512),c=s(t,"height",512),l=s(t,"key",""),u=s(t,"frame",""),h=new o(this.scene,n,r,a,c,l,u);return void 0!==e&&(t.add=e),i(this.scene,h,t),h}))},20509:(t,e,n)=>{var i=n(35856);n(61286).register("tileSprite",(function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))}))},9271:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(74287),s=n(93305),t.exports={renderWebGL:r,renderCanvas:s}},74287:(t,e,n)=>{var i=n(75512);t.exports=function(t,e,n,r){e.updateCanvas();var s=e.width,o=e.height;if(0!==s&&0!==o){n.addToRenderList(e);var a=i.getTintAppendFloatAlpha,c=t.pipelines.set(e.pipeline,e),l=c.setTexture2D(e.fillPattern,e);c.batchTexture(e,e.fillPattern,e.displayFrame.width*e.tileScaleX,e.displayFrame.height*e.tileScaleY,e.x,e.y,s,o,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.originX*s,e.originY*o,0,0,s,o,a(e.tintTopLeft,n.alpha*e._alphaTL),a(e.tintTopRight,n.alpha*e._alphaTR),a(e.tintBottomLeft,n.alpha*e._alphaBL),a(e.tintBottomRight,n.alpha*e._alphaBR),e.tintFill,e.tilePositionX%e.displayFrame.width/e.displayFrame.width,e.tilePositionY%e.displayFrame.height/e.displayFrame.height,n,r,!1,l)}}},8630:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(64937),o=n(56631),a=n(97081),c=n(89980),l=n(83392),u=n(76038),h=n(76583),d=n(77974),p=new r({Extends:c,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,d],initialize:function(t,e,n,i){c.call(this,t,"Video"),this.video,this.videoTexture,this.videoTextureSource,this.snapshotTexture,this.flipY=!1,this._key=h(),this.touchLocked=!1,this.playWhenUnlocked=!1,this.frameReady=!1,this.isStalled=!1,this.failedPlayAttempts=0,this.metadata,this.retry=0,this.retryInterval=500,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={ended:this.completeHandler.bind(this),legacy:this.legacyPlayHandler.bind(this),playing:this.playingHandler.bind(this),seeked:this.seekedHandler.bind(this),seeking:this.seekingHandler.bind(this),stalled:this.stalledHandler.bind(this),suspend:this.stalledHandler.bind(this),waiting:this.stalledHandler.bind(this)},this._loadCallbackHandler=this.loadErrorHandler.bind(this),this._crop=this.resetCropObject(),this.markers={},this._markerIn=0,this._markerOut=0,this._playingMarker=!1,this._lastUpdate=0,this.cacheKey="",this.isSeeking=!1,this._playCalled=!1,this._rfvCallbackId=0;var r=t.sys.game;this._device=r.device.video,this.setPosition(e,n),this.setSize(256,256),this.initPipeline(),this.initPostPipeline(!0),r.events.on(a.PAUSE,this.globalPause,this),r.events.on(a.RESUME,this.globalResume,this);var s=t.sys.sound;s&&s.on(u.GLOBAL_MUTE,this.globalMute,this),i&&this.load(i)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},load:function(t){var e=this.scene.sys.cache.video.get(t);return e?(this.cacheKey=t,this.loadHandler(e.url,e.noAudio,e.crossOrigin)):console.warn("No video in cache for key: "+t),this},changeSource:function(t,e,n,i,r){void 0===e&&(e=!0),void 0===n&&(n=!1),this.cacheKey!==t&&(this.load(t),e&&this.play(n,i,r))},getVideoKey:function(){return this.cacheKey},loadURL:function(t,e,n){void 0===e&&(e=!1);var i=this._device.getVideoURL(t);return i?(this.cacheKey="",this.loadHandler(i.url,e,n)):console.warn("No supported video format found for "+t),this},loadMediaStream:function(t,e,n){return this.loadHandler(null,e,n,t)},loadHandler:function(t,e,n,i){e||(e=!1);var r=this.video;if(r?(this.removeLoadEventHandlers(),this.stop()):((r=document.createElement("video")).controls=!1,r.setAttribute("playsinline","playsinline"),r.setAttribute("preload","auto"),r.setAttribute("disablePictureInPicture","true")),e?(r.muted=!0,r.defaultMuted=!0,r.setAttribute("autoplay","autoplay")):(r.muted=!1,r.defaultMuted=!1,r.removeAttribute("autoplay")),n?r.setAttribute("crossorigin",n):r.removeAttribute("crossorigin"),i)if("srcObject"in r)try{r.srcObject=i}catch(s){if("TypeError"!==s.name)throw s;r.src=URL.createObjectURL(i)}else r.src=URL.createObjectURL(i);else r.src=t;return this.addLoadEventHandlers(),this.retry=0,this.video=r,this._playCalled=!1,r.load(),this},requestVideoFrame:function(t,e){var n=this.video;if(n){var i=e.width,r=e.height,s=this.videoTexture,a=this.videoTextureSource,c=!s||a.source!==n;c?(this._codePaused=n.paused,this._codeMuted=n.muted,s?(a.source=n,a.width=i,a.height=r,s.get().setSize(i,r)):((s=this.scene.sys.textures.create(this._key,n,i,r)).add("__BASE",0,0,0,i,r),this.setTexture(s),this.videoTexture=s,this.videoTextureSource=s.source[0],this.videoTextureSource.setFlipY(this.flipY),this.emit(o.VIDEO_TEXTURE,this,s)),this.setSizeToFrame(),this.updateDisplayOrigin()):a.update(),this.isStalled=!1,this.metadata=e;var l=e.mediaTime;c&&(this._lastUpdate=l,this.emit(o.VIDEO_CREATED,this,i,r),this.frameReady||(this.frameReady=!0,this.emit(o.VIDEO_PLAY,this))),this._playingMarker?l>=this._markerOut&&(n.loop?(n.currentTime=this._markerIn,this.emit(o.VIDEO_LOOP,this)):(this.stop(!1),this.emit(o.VIDEO_COMPLETE,this))):l<this._lastUpdate&&this.emit(o.VIDEO_LOOP,this),this._lastUpdate=l,this._rfvCallbackId=this.video.requestVideoFrameCallback(this.requestVideoFrame.bind(this))}},play:function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=l.MAX_SAFE_INTEGER);var i=this.video;return!i||this.isPlaying()?(i||console.warn("Video not loaded"),this):(void 0===t&&(t=i.loop),i.loop=t,this._markerIn=e,this._markerOut=n,this._playingMarker=e>-1&&n>e&&n<l.MAX_SAFE_INTEGER,this._playCalled||(this._rfvCallbackId=i.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this._playCalled=!0,this.createPlayPromise()),this)},addLoadEventHandlers:function(){var t=this.video;t&&(t.addEventListener("error",this._loadCallbackHandler),t.addEventListener("abort",this._loadCallbackHandler))},removeLoadEventHandlers:function(){var t=this.video;t&&(t.removeEventListener("error",this._loadCallbackHandler),t.removeEventListener("abort",this._loadCallbackHandler))},addEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var n in e)t.addEventListener(n,e[n])}},removeEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var n in e)t.removeEventListener(n,e[n])}},createPlayPromise:function(t){void 0===t&&(t=!0);var e=this.video,n=e.play();if(void 0!==n){var i=this.playSuccess.bind(this),r=this.playError.bind(this);if(!t){var s=this;r=function(){s.failedPlayAttempts++}}n.then(i).catch(r)}else e.addEventListener("playing",this._callbacks.legacy),t||this.failedPlayAttempts++},addMarker:function(t,e,n){return!isNaN(e)&&e>=0&&!isNaN(n)&&n>e&&(this.markers[t]=[e,n]),this},playMarker:function(t,e){var n=this.markers[t];return n&&this.play(e,n[0],n[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),void 0===r&&(r=n),void 0===s&&(s=i);var o=this.video,a=this.snapshotTexture;return a?(a.setSize(r,s),o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)):(a=this.scene.sys.textures.createCanvas(h(),r,s),this.snapshotTexture=a,o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)),a.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},playSuccess:function(){if(this._playCalled){this.addEventHandlers(),this._codePaused=!1,this.touchLocked&&(this.touchLocked=!1,this.emit(o.VIDEO_UNLOCKED,this));var t=this.scene.sys.sound;t&&t.mute&&this.setMute(!0),this._markerIn>-1&&(this.video.currentTime=this._markerIn)}},playError:function(t){var e=t.name;"NotAllowedError"===e?(this.touchLocked=!0,this.playWhenUnlocked=!0,this.failedPlayAttempts=1,this.emit(o.VIDEO_LOCKED,this)):"NotSupportedError"===e?(this.stop(!1),this.emit(o.VIDEO_UNSUPPORTED,this,t)):(this.stop(!1),this.emit(o.VIDEO_ERROR,this,t))},legacyPlayHandler:function(){var t=this.video;t&&(this.playSuccess(),t.removeEventListener("playing",this._callbacks.legacy))},playingHandler:function(){this.isStalled=!1,this.emit(o.VIDEO_PLAYING,this)},loadErrorHandler:function(t){this.stop(!1),this.emit(o.VIDEO_ERROR,this,t)},stalledHandler:function(t){this.isStalled=!0,this.emit(o.VIDEO_STALLED,this,t)},completeHandler:function(){this._playCalled=!1,this.emit(o.VIDEO_COMPLETE,this)},preUpdate:function(t,e){this.video&&this._playCalled&&this.touchLocked&&this.playWhenUnlocked&&(this.retry+=e,this.retry>=this.retryInterval&&(this.createPlayPromise(!1),this.retry=0))},seekTo:function(t){var e=this.video;if(e){var n=e.duration;if(n!==1/0&&!isNaN(n)){var i=n*t;this.setCurrentTime(i)}}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"===typeof t){var n=t[0],i=parseFloat(t.substr(1));"+"===n?t=e.currentTime+i:"-"===n&&(t=e.currentTime-i)}e.currentTime=t}return this},seekingHandler:function(){this.isSeeking=!0,this.emit(o.VIDEO_SEEKING,this)},seekedHandler:function(){this.isSeeking=!1,this.emit(o.VIDEO_SEEKED,this)},getProgress:function(){var t=this.video;if(t){var e=t.duration;if(e!==1/0&&!isNaN(e))return t.currentTime/e}return-1},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var n=this.video;n&&(n.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&!this.video.ended&&(this.removeEventHandlers(),this.video.pause())},globalResume:function(){this._systemPaused=!1,!this.video||this._codePaused||this.video.ended||this.createPlayPromise()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&!e.ended&&(t?e.paused||(this.removeEventHandlers(),e.pause()):t||(this._playCalled?e.paused&&!this._systemPaused&&this.createPlayPromise():this.play())),this},pause:function(){return this.setPaused(!0)},resume:function(){return this.setPaused(!1)},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(t){return void 0===t&&(t=1),this.video&&(this.video.volume=i(t,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this._playCalled&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&(this.scene.sys.textures.renameTexture(this._key,t),this.videoTextureSource.setFlipY(e)),this._key=t,this.flipY=e,!!this.videoTexture},stop:function(t){void 0===t&&(t=!0);var e=this.video;return e&&(this.removeEventHandlers(),e.cancelVideoFrameCallback(this._rfvCallbackId),e.pause()),this.retry=0,this._playCalled=!1,t&&this.emit(o.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(!1),this.removeLoadEventHandlers(),this.removeVideoElement();var t=this.scene.sys.game.events;t.off(a.PAUSE,this.globalPause,this),t.off(a.RESUME,this.globalResume,this);var e=this.scene.sys.sound;e&&e.off(u.GLOBAL_MUTE,this.globalMute,this)}});t.exports=p},56933:t=>{t.exports=function(t,e,n,i){e.videoTexture&&(n.addToRenderList(e),t.batchSprite(e,e.frame,n,i))}},65601:(t,e,n)=>{var i=n(88933),r=n(99325),s=n(20494),o=n(8630);r.register("video",(function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=new o(this.scene,0,0,n);return void 0!==e&&(t.add=e),i(this.scene,r,t),r}))},215:(t,e,n)=>{var i=n(8630);n(61286).register("video",(function(t,e,n){return this.displayList.add(new i(this.scene,t,e,n))}))},77974:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(83572),s=n(56933),t.exports={renderWebGL:r,renderCanvas:s}},83572:t=>{t.exports=function(t,e,n,i){e.videoTexture&&(n.addToRenderList(e),e.pipeline.batchSprite(e,n,i))}},71030:(t,e,n)=>{var i=n(95723),r=n(26673),s=n(65650),o=n(56694),a=n(64937),c=n(89980),l=n(74118),u=n(94287),h=new o({Extends:c,Mixins:[a.Depth,a.GetBounds,a.Origin,a.Transform,a.ScrollFactor,a.Visible],initialize:function(t,e,n,r,s){void 0===r&&(r=1),void 0===s&&(s=r),c.call(this,t,"Zone"),this.setPosition(e,n),this.width=r,this.height=s,this.blendMode=i.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,n){void 0===n&&(n=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return n&&i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new r(0,0,t),s)},setRectangleDropZone:function(t,e){return this.setDropZone(new l(0,0,t,e),u)},setDropZone:function(t,e){return this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,n){n.addToRenderList(e)},renderWebGL:function(t,e,n){n.addToRenderList(e)}});t.exports=h},24067:(t,e,n)=>{var i=n(99325),r=n(20494),s=n(71030);i.register("zone",(function(t){var e=r(t,"x",0),n=r(t,"y",0),i=r(t,"width",1),o=r(t,"height",i);return new s(this.scene,e,n,i,o)}))},34546:(t,e,n)=>{var i=n(71030);n(61286).register("zone",(function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))}))},95847:t=>{t.exports=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}},26673:(t,e,n)=>{var i=n(56694),r=n(65650),s=n(94026),o=n(62941),a=n(52394),c=n(30977),l=new i({initialize:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.type=a.CIRCLE,this.x=t,this.y=e,this._radius=n,this._diameter=2*n},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return c(this,t)},setTo:function(t,e,n){return this.x=t,this.y=e,this._radius=n,this._diameter=2*n,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});t.exports=l},37964:t=>{t.exports=function(t){return Math.PI*t.radius*2}},72233:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x+t.radius*Math.cos(e),n.y=t.y+t.radius*Math.sin(e),n}},61761:(t,e,n)=>{var i=n(26673);t.exports=function(t){return new i(t.x,t.y,t.radius)}},65650:t=>{t.exports=function(t,e,n){return t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-n)*(t.y-n)<=t.radius*t.radius}},39187:(t,e,n)=>{var i=n(65650);t.exports=function(t,e){return i(t,e.x,e.y)}},58672:(t,e,n)=>{var i=n(65650);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},42997:t=>{t.exports=function(t,e){return e.setTo(t.x,t.y,t.radius)}},94894:t=>{t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}},48027:(t,e,n)=>{var i=n(74118);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.diameter,e.height=t.diameter,e}},94026:(t,e,n)=>{var i=n(72233),r=n(91806),s=n(83392),o=n(79967);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},62941:(t,e,n)=>{var i=n(37964),r=n(72233),s=n(91806),o=n(83392);t.exports=function(t,e,n,a){void 0===a&&(a=[]),!e&&n>0&&(e=i(t)/n);for(var c=0;c<e;c++){var l=s(c/e,0,o.PI2);a.push(r(t,l))}return a}},34585:t=>{t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},88665:t=>{t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},30977:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){void 0===e&&(e=new i);var n=2*Math.PI*Math.random(),r=Math.random()+Math.random(),s=r>1?2-r:r,o=s*Math.cos(n),a=s*Math.sin(n);return e.x=t.x+o*t.radius,e.y=t.y+a*t.radius,e}},6112:(t,e,n)=>{var i=n(26673);i.Area=n(95847),i.Circumference=n(37964),i.CircumferencePoint=n(72233),i.Clone=n(61761),i.Contains=n(65650),i.ContainsPoint=n(39187),i.ContainsRect=n(58672),i.CopyFrom=n(42997),i.Equals=n(94894),i.GetBounds=n(48027),i.GetPoint=n(94026),i.GetPoints=n(62941),i.Offset=n(34585),i.OffsetPoint=n(88665),i.Random=n(30977),t.exports=i},52394:t=>{t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},58605:t=>{t.exports=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}},39507:t=>{t.exports=function(t){var e=t.width/2,n=t.height/2,i=Math.pow(e-n,2)/Math.pow(e+n,2);return Math.PI*(e+n)*(1+3*i/(10+Math.sqrt(4-3*i)))}},86998:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.width/2,s=t.height/2;return n.x=t.x+r*Math.cos(e),n.y=t.y+s*Math.sin(e),n}},81773:(t,e,n)=>{var i=n(95669);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},72313:t=>{t.exports=function(t,e,n){if(t.width<=0||t.height<=0)return!1;var i=(e-t.x)/t.width,r=(n-t.y)/t.height;return(i*=i)+(r*=r)<.25}},34368:(t,e,n)=>{var i=n(72313);t.exports=function(t,e){return i(t,e.x,e.y)}},71431:(t,e,n)=>{var i=n(72313);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},75459:t=>{t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},95669:(t,e,n)=>{var i=n(56694),r=n(72313),s=n(95340),o=n(54978),a=n(52394),c=n(72006),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.ELLIPSE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return c(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=l},98068:t=>{t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},72897:(t,e,n)=>{var i=n(74118);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.width,e.height=t.height,e}},95340:(t,e,n)=>{var i=n(86998),r=n(91806),s=n(83392),o=n(79967);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},54978:(t,e,n)=>{var i=n(39507),r=n(86998),s=n(91806),o=n(83392);t.exports=function(t,e,n,a){void 0===a&&(a=[]),!e&&n>0&&(e=i(t)/n);for(var c=0;c<e;c++){var l=s(c/e,0,o.PI2);a.push(r(t,l))}return a}},77951:t=>{t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},36233:t=>{t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},72006:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());return e.x=t.x+r*Math.cos(n)*t.width/2,e.y=t.y+r*Math.sin(n)*t.height/2,e}},40652:(t,e,n)=>{var i=n(95669);i.Area=n(58605),i.Circumference=n(39507),i.CircumferencePoint=n(86998),i.Clone=n(81773),i.Contains=n(72313),i.ContainsPoint=n(34368),i.ContainsRect=n(71431),i.CopyFrom=n(75459),i.Equals=n(98068),i.GetBounds=n(72897),i.GetPoint=n(95340),i.GetPoints=n(54978),i.Offset=n(77951),i.OffsetPoint=n(36233),i.Random=n(72006),t.exports=i},84068:(t,e,n)=>{var i=n(52394),r=n(98611),s={Circle:n(6112),Ellipse:n(40652),Intersects:n(7563),Line:n(28482),Mesh:n(14293),Point:n(63472),Polygon:n(44359),Rectangle:n(66658),Triangle:n(87619)};s=r(!1,s,i),t.exports=s},22184:(t,e,n)=>{var i=n(53996);t.exports=function(t,e){return i(t.x,t.y,e.x,e.y)<=t.radius+e.radius}},26535:t=>{t.exports=function(t,e){var n=e.width/2,i=e.height/2,r=Math.abs(t.x-e.x-n),s=Math.abs(t.y-e.y-i),o=n+t.radius,a=i+t.radius;if(r>o||s>a)return!1;if(r<=n||s<=i)return!0;var c=r-n,l=s-i;return c*c+l*l<=t.radius*t.radius}},71145:(t,e,n)=>{var i=n(79967),r=n(22184);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a,c,l=t.x,u=t.y,h=t.radius,d=e.x,p=e.y,f=e.radius;if(u===p)0===(a=(o=-2*p)*o-4*(s=1)*(d*d+(c=(f*f-h*h-d*d+l*l)/(2*(l-d)))*c-2*d*c+p*p-f*f))?n.push(new i(c,-o/(2*s))):a>0&&(n.push(new i(c,(-o+Math.sqrt(a))/(2*s))),n.push(new i(c,(-o-Math.sqrt(a))/(2*s))));else{var m=(l-d)/(u-p),g=(f*f-h*h-d*d+l*l-p*p+u*u)/(2*(u-p));0===(a=(o=2*u*m-2*g*m-2*l)*o-4*(s=m*m+1)*(l*l+u*u+g*g-h*h-2*u*g))?(c=-o/(2*s),n.push(new i(c,g-c*m))):a>0&&(c=(-o+Math.sqrt(a))/(2*s),n.push(new i(c,g-c*m)),c=(-o-Math.sqrt(a))/(2*s),n.push(new i(c,g-c*m)))}}return n}},62508:(t,e,n)=>{var i=n(26111),r=n(26535);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC(),c=e.getLineD();i(s,t,n),i(o,t,n),i(a,t,n),i(c,t,n)}return n}},26111:(t,e,n)=>{var i=n(79967),r=n(61472);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a=t.x1,c=t.y1,l=t.x2,u=t.y2,h=e.x,d=e.y,p=e.radius,f=l-a,m=u-c,g=a-h,v=c-d,y=f*f+m*m,x=2*(f*g+m*v),b=x*x-4*y*(g*g+v*v-p*p);if(0===b){var w=-x/(2*y);s=a+w*f,o=c+w*m,w>=0&&w<=1&&n.push(new i(s,o))}else if(b>0){var S=(-x-Math.sqrt(b))/(2*y);s=a+S*f,o=c+S*m,S>=0&&S<=1&&n.push(new i(s,o));var _=(-x+Math.sqrt(b))/(2*y);s=a+_*f,o=c+_*m,_>=0&&_<=1&&n.push(new i(s,o))}}return n}},96537:(t,e,n)=>{var i=n(70015);t.exports=function(t,e,n,r){void 0===n&&(n=!1);var s,o,a,c=t.x1,l=t.y1,u=t.x2,h=t.y2,d=e.x1,p=e.y1,f=u-c,m=h-l,g=e.x2-d,v=e.y2-p,y=f*v-m*g;if(0===y)return null;if(n){if((o=(d+g*(s=(f*(p-l)+m*(c-d))/(g*m-v*f))-c)/f)<0||s<0||s>1)return null;a=o}else{if(o=((l-p)*f-(c-d)*m)/y,(s=((d-c)*v-(p-l)*g)/y)<0||s>1||o<0||o>1)return null;a=s}return void 0===r&&(r=new i),r.set(c+f*a,l+m*a,a)}},17647:(t,e,n)=>{var i=n(96537),r=n(88829),s=n(70015),o=new r,a=new s;t.exports=function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=new s);var c=!1;r.set(),a.set();for(var l=e[e.length-1],u=0;u<e.length;u++){var h=e[u];o.setTo(l.x,l.y,h.x,h.y),l=h,i(t,o,n,a)&&(!c||a.z<r.z)&&(r.copy(a),c=!0)}return c?r:null}},68439:(t,e,n)=>{var i=n(70015),r=n(51729),s=n(17647),o=new i;t.exports=function(t,e,n,i){void 0===i&&(i=new r),Array.isArray(e)||(e=[e]);var a=!1;i.set(),o.set();for(var c=0;c<e.length;c++)s(t,e[c].points,n,o)&&(!a||o.z<i.z)&&(i.set(o.x,o.y,o.z,c),a=!0);return a?i:null}},9569:(t,e,n)=>{var i=n(79967),r=n(25227),s=n(47910);t.exports=function(t,e,n){if(void 0===n&&(n=[]),s(t,e))for(var o=e.getLineA(),a=e.getLineB(),c=e.getLineC(),l=e.getLineD(),u=[new i,new i,new i,new i],h=[r(o,t,u[0]),r(a,t,u[1]),r(c,t,u[2]),r(l,t,u[3])],d=0;d<4;d++)h[d]&&n.push(u[d]);return n}},7449:(t,e,n)=>{var i=n(51729),r=n(68439),s=new(n(88829));function o(t,e,n,o,a){var c=Math.cos(t),l=Math.sin(t);s.setTo(e,n,e+c,n+l);var u=r(s,o,!0);u&&a.push(new i(u.x,u.y,t,u.w))}function a(t,e){return t.z-e.z}t.exports=function(t,e,n){Array.isArray(n)||(n=[n]);for(var i=[],r=[],s=0;s<n.length;s++)for(var c=n[s].points,l=0;l<c.length;l++){var u=Math.atan2(c[l].y-e,c[l].x-t);-1===r.indexOf(u)&&(o(u,t,e,n,i),o(u-1e-5,t,e,n,i),o(u+1e-5,t,e,n,i),r.push(u))}return i.sort(a)}},82931:(t,e,n)=>{var i=n(74118),r=n(90205);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)&&(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y),n}},1946:(t,e,n)=>{var i=n(9569),r=n(90205);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC(),c=t.getLineD();i(s,e,n),i(o,e,n),i(a,e,n),i(c,e,n)}return n}},34211:(t,e,n)=>{var i=n(20370),r=n(9569);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(s,t,n),r(o,t,n),r(a,t,n)}return n}},80511:(t,e,n)=>{var i=n(26111),r=n(48411);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();i(s,e,n),i(o,e,n),i(a,e,n)}return n}},31343:(t,e,n)=>{var i=n(79967),r=n(86117),s=n(25227);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e))for(var o=t.getLineA(),a=t.getLineB(),c=t.getLineC(),l=[new i,new i,new i],u=[s(o,e,l[0]),s(a,e,l[1]),s(c,e,l[2])],h=0;h<3;h++)u[h]&&n.push(l[h]);return n}},70534:(t,e,n)=>{var i=n(23589),r=n(31343);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(t,s,n),r(t,o,n),r(t,a,n)}return n}},61472:(t,e,n)=>{var i=n(65650),r=new(n(79967));t.exports=function(t,e,n){if(void 0===n&&(n=r),i(e,t.x1,t.y1))return n.x=t.x1,n.y=t.y1,!0;if(i(e,t.x2,t.y2))return n.x=t.x2,n.y=t.y2,!0;var s=t.x2-t.x1,o=t.y2-t.y1,a=e.x-t.x1,c=e.y-t.y1,l=s*s+o*o,u=s,h=o;if(l>0){var d=(a*s+c*o)/l;u*=d,h*=d}return n.x=t.x1+u,n.y=t.y1+h,u*u+h*h<=l&&u*s+h*o>=0&&i(e,n.x,n.y)}},25227:t=>{t.exports=function(t,e,n){var i=t.x1,r=t.y1,s=t.x2,o=t.y2,a=e.x1,c=e.y1,l=e.x2,u=e.y2;if(i===s&&r===o||a===l&&c===u)return!1;var h=(u-c)*(s-i)-(l-a)*(o-r);if(0===h)return!1;var d=((l-a)*(r-c)-(u-c)*(i-a))/h,p=((s-i)*(r-c)-(o-r)*(i-a))/h;return!(d<0||d>1||p<0||p>1)&&(n&&(n.x=i+d*(s-i),n.y=r+d*(o-r)),!0)}},47910:t=>{t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=e.x,a=e.y,c=e.right,l=e.bottom,u=0;if(n>=o&&n<=c&&i>=a&&i<=l||r>=o&&r<=c&&s>=a&&s<=l)return!0;if(n<o&&r>=o){if((u=i+(s-i)*(o-n)/(r-n))>a&&u<=l)return!0}else if(n>c&&r<=c&&(u=i+(s-i)*(c-n)/(r-n))>=a&&u<=l)return!0;if(i<a&&s>=a){if((u=n+(r-n)*(a-i)/(s-i))>=o&&u<=c)return!0}else if(i>l&&s<=l&&(u=n+(r-n)*(l-i)/(s-i))>=o&&u<=c)return!0;return!1}},34426:t=>{t.exports=function(t,e,n){void 0===n&&(n=1);var i=e.x1,r=e.y1,s=e.x2,o=e.y2,a=t.x,c=t.y,l=(s-i)*(s-i)+(o-r)*(o-r);if(0===l)return!1;var u=((a-i)*(s-i)+(c-r)*(o-r))/l;if(u<0)return Math.sqrt((i-a)*(i-a)+(r-c)*(r-c))<=n;if(u>=0&&u<=1){var h=((r-c)*(s-i)-(i-a)*(o-r))/l;return Math.abs(h)*Math.sqrt(l)<=n}return Math.sqrt((s-a)*(s-a)+(o-c)*(o-c))<=n}},81414:(t,e,n)=>{var i=n(34426);t.exports=function(t,e){if(!i(t,e))return!1;var n=Math.min(e.x1,e.x2),r=Math.max(e.x1,e.x2),s=Math.min(e.y1,e.y2),o=Math.max(e.y1,e.y2);return t.x>=n&&t.x<=r&&t.y>=s&&t.y<=o}},90205:t=>{t.exports=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}},20370:(t,e,n)=>{var i=n(25227),r=n(94287),s=n(86875),o=n(87279);t.exports=function(t,e){if(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)return!1;var n=e.getLineA(),a=e.getLineB(),c=e.getLineC();if(r(t,n.x1,n.y1)||r(t,n.x2,n.y2))return!0;if(r(t,a.x1,a.y1)||r(t,a.x2,a.y2))return!0;if(r(t,c.x1,c.y1)||r(t,c.x2,c.y2))return!0;var l=t.getLineA(),u=t.getLineB(),h=t.getLineC(),d=t.getLineD();if(i(n,l)||i(n,u)||i(n,h)||i(n,d))return!0;if(i(a,l)||i(a,u)||i(a,h)||i(a,d))return!0;if(i(c,l)||i(c,u)||i(c,h)||i(c,d))return!0;var p=o(t);return s(e,p,!0).length>0}},8786:t=>{t.exports=function(t,e,n,i,r,s){return void 0===s&&(s=0),!(e>t.right+s||n<t.left-s||i>t.bottom+s||r<t.top-s)}},48411:(t,e,n)=>{var i=n(61472),r=n(60689);t.exports=function(t,e){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)&&(!!r(t,e.x,e.y)||!!i(t.getLineA(),e)||!!i(t.getLineB(),e)||!!i(t.getLineC(),e))}},86117:(t,e,n)=>{var i=n(25227);t.exports=function(t,e){return!(!t.contains(e.x1,e.y1)&&!t.contains(e.x2,e.y2))||!!i(t.getLineA(),e)||!!i(t.getLineB(),e)||!!i(t.getLineC(),e)}},23589:(t,e,n)=>{var i=n(86875),r=n(18680),s=n(25227);t.exports=function(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;var n=t.getLineA(),o=t.getLineB(),a=t.getLineC(),c=e.getLineA(),l=e.getLineB(),u=e.getLineC();if(s(n,c)||s(n,l)||s(n,u))return!0;if(s(o,c)||s(o,l)||s(o,u))return!0;if(s(a,c)||s(a,l)||s(a,u))return!0;var h=r(t),d=i(e,h,!0);return d.length>0||(h=r(e),(d=i(t,h,!0)).length>0)}},7563:(t,e,n)=>{t.exports={CircleToCircle:n(22184),CircleToRectangle:n(26535),GetCircleToCircle:n(71145),GetCircleToRectangle:n(62508),GetLineToCircle:n(26111),GetLineToLine:n(96537),GetLineToPoints:n(17647),GetLineToPolygon:n(68439),GetLineToRectangle:n(9569),GetRaysFromPointToPolygon:n(7449),GetRectangleIntersection:n(82931),GetRectangleToRectangle:n(1946),GetRectangleToTriangle:n(34211),GetTriangleToCircle:n(80511),GetTriangleToLine:n(31343),GetTriangleToTriangle:n(70534),LineToCircle:n(61472),LineToLine:n(25227),LineToRectangle:n(47910),PointToLine:n(34426),PointToLineSegment:n(81414),RectangleToRectangle:n(90205),RectangleToTriangle:n(20370),RectangleToValues:n(8786),TriangleToCircle:n(48411),TriangleToLine:n(86117),TriangleToTriangle:n(23589)}},50599:t=>{t.exports=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}},58813:t=>{t.exports=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=[]);var i=Math.round(t.x1),r=Math.round(t.y1),s=Math.round(t.x2),o=Math.round(t.y2),a=Math.abs(s-i),c=Math.abs(o-r),l=i<s?1:-1,u=r<o?1:-1,h=a-c;n.push({x:i,y:r});for(var d=1;i!==s||r!==o;){var p=h<<1;p>-c&&(h-=c,i+=l),p<a&&(h+=a,r+=u),d%e===0&&n.push({x:i,y:r}),d++}return n}},88513:t=>{t.exports=function(t,e,n){var i=e-(t.x1+t.x2)/2,r=n-(t.y1+t.y2)/2;return t.x1+=i,t.y1+=r,t.x2+=i,t.y2+=r,t}},26718:(t,e,n)=>{var i=n(88829);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2)}},88930:t=>{t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}},90656:t=>{t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}},30897:(t,e,n)=>{var i=n(16028);t.exports=function(t,e,n){void 0===n&&(n=e);var r=i(t),s=t.x2-t.x1,o=t.y2-t.y1;return e&&(t.x1=t.x1-s/r*e,t.y1=t.y1-o/r*e),n&&(t.x2=t.x2+s/r*n,t.y2=t.y2+o/r*n),t}},30684:(t,e,n)=>{var i=n(92951),r=n(21902),s=n(79967);t.exports=function(t,e,n,o,a){void 0===o&&(o=0),void 0===a&&(a=[]);var c,l,u=[],h=t.x1,d=t.y1,p=t.x2-h,f=t.y2-d,m=r(e,a),g=n-1;for(c=0;c<g;c++)l=m(c/g),u.push(new s(h+p*l,d+f*l));if(l=m(1),u.push(new s(h+p*l,d+f*l)),o>0){var v=u[0],y=[v];for(c=1;c<u.length-1;c++){var x=u[c];i(v,x)>=o&&(y.push(x),v=x)}var b=u[u.length-1];return i(v,b)<o&&y.pop(),y.push(b),y}return u}},20487:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2)/2,e.y=(t.y1+t.y2)/2,e}},11222:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x1,s=t.y1,o=t.x2,a=t.y2,c=(o-r)*(o-r)+(a-s)*(a-s);if(0===c)return n;var l=((e.x-r)*(o-r)+(e.y-s)*(a-s))/c;return n.x=r+l*(o-r),n.y=s+l*(a-s),n}},7377:(t,e,n)=>{var i=n(83392),r=n(50599),s=n(79967);t.exports=function(t,e){void 0===e&&(e=new s);var n=r(t)-i.TAU;return e.x=Math.cos(n),e.y=Math.sin(n),e}},66464:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},8570:(t,e,n)=>{var i=n(16028),r=n(79967);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&n>0&&(e=i(t)/n);for(var o=t.x1,a=t.y1,c=t.x2,l=t.y2,u=0;u<e;u++){var h=u/e,d=o+(c-o)*h,p=a+(l-a)*h;s.push(new r(d,p))}return s}},65269:t=>{t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=(r-n)*(r-n)+(s-i)*(s-i);if(0===o)return!1;var a=((i-e.y)*(r-n)-(n-e.x)*(s-i))/o;return Math.abs(a)*Math.sqrt(o)}},82996:t=>{t.exports=function(t){return Math.abs(t.y1-t.y2)}},16028:t=>{t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},88829:(t,e,n)=>{var i=n(56694),r=n(66464),s=n(8570),o=n(52394),a=n(74077),c=n(93736),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return r(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},setFromObjects:function(t,e){return this.x1=t.x,this.y1=t.y,this.x2=e.x,this.y2=e.y,this},getPointA:function(t){return void 0===t&&(t=new c),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new c),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=l},73273:(t,e,n)=>{var i=n(83392),r=n(1071),s=n(50599);t.exports=function(t){var e=s(t)-i.TAU;return r(e,-Math.PI,Math.PI)}},96936:(t,e,n)=>{var i=n(83392),r=n(50599);t.exports=function(t){return Math.cos(r(t)-i.TAU)}},43581:(t,e,n)=>{var i=n(83392),r=n(50599);t.exports=function(t){return Math.sin(r(t)-i.TAU)}},13990:t=>{t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t}},1298:t=>{t.exports=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}},74077:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},30473:(t,e,n)=>{var i=n(50599),r=n(73273);t.exports=function(t,e){return 2*r(e)-Math.PI-i(t)}},25968:(t,e,n)=>{var i=n(1809);t.exports=function(t,e){var n=(t.x1+t.x2)/2,r=(t.y1+t.y2)/2;return i(t,n,r,e)}},24296:(t,e,n)=>{var i=n(1809);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},1809:t=>{t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,o=t.x2-e,a=t.y2-n,t.x2=o*r-a*s+e,t.y2=o*s+a*r+n,t}},88171:t=>{t.exports=function(t,e,n,i,r){return t.x1=e,t.y1=n,t.x2=e+Math.cos(i)*r,t.y2=n+Math.sin(i)*r,t}},82797:t=>{t.exports=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}},41067:t=>{t.exports=function(t){return Math.abs(t.x1-t.x2)}},28482:(t,e,n)=>{var i=n(88829);i.Angle=n(50599),i.BresenhamPoints=n(58813),i.CenterOn=n(88513),i.Clone=n(26718),i.CopyFrom=n(88930),i.Equals=n(90656),i.Extend=n(30897),i.GetEasedPoints=n(30684),i.GetMidPoint=n(20487),i.GetNearestPoint=n(11222),i.GetNormal=n(7377),i.GetPoint=n(66464),i.GetPoints=n(8570),i.GetShortestDistance=n(65269),i.Height=n(82996),i.Length=n(16028),i.NormalAngle=n(73273),i.NormalX=n(96936),i.NormalY=n(43581),i.Offset=n(13990),i.PerpSlope=n(1298),i.Random=n(74077),i.ReflectAngle=n(30473),i.Rotate=n(25968),i.RotateAroundPoint=n(24296),i.RotateAroundXY=n(1809),i.SetToAngle=n(88171),i.Slope=n(82797),i.Width=n(41067),t.exports=i},18693:(t,e,n)=>{var i=n(56694),r=n(74118),s=n(93736);function o(t,e,n,i){var r=t-n,s=e-i,o=r*r+s*s;return Math.sqrt(o)}var a=new i({initialize:function(t,e,n){this.vertex1=t,this.vertex2=e,this.vertex3=n,this.bounds=new r,this._inCenter=new s},getInCenter:function(t){void 0===t&&(t=!0);var e,n,i,r,s,a,c=this.vertex1,l=this.vertex2,u=this.vertex3;t?(e=c.x,n=c.y,i=l.x,r=l.y,s=u.x,a=u.y):(e=c.vx,n=c.vy,i=l.vx,r=l.vy,s=u.vx,a=u.vy);var h=o(s,a,i,r),d=o(e,n,s,a),p=o(i,r,e,n),f=h+d+p;return this._inCenter.set((e*h+i*d+s*p)/f,(n*h+r*d+a*p)/f)},contains:function(t,e,n){var i=this.vertex1,r=this.vertex2,s=this.vertex3,o=i.vx,a=i.vy,c=r.vx,l=r.vy,u=s.vx,h=s.vy;if(n){var d=n.a,p=n.b,f=n.c,m=n.d,g=n.e,v=n.f;o=i.vx*d+i.vy*f+g,a=i.vx*p+i.vy*m+v,c=r.vx*d+r.vy*f+g,l=r.vx*p+r.vy*m+v,u=s.vx*d+s.vy*f+g,h=s.vx*p+s.vy*m+v}var y=u-o,x=h-a,b=c-o,w=l-a,S=t-o,_=e-a,T=y*y+x*x,E=y*b+x*w,C=y*S+x*_,k=b*b+w*w,A=b*S+w*_,I=T*k-E*E,O=0===I?0:1/I,R=(k*C-E*A)*O,N=(T*A-E*C)*O;return R>=0&&N>=0&&R+N<1},isCounterClockwise:function(t){var e=this.vertex1,n=this.vertex2,i=this.vertex3,r=(n.vx-e.vx)*(i.vy-e.vy)-(n.vy-e.vy)*(i.vx-e.vx);return t<=0?r>=0:r<0},load:function(t,e,n,i,r){return n=this.vertex1.load(t,e,n,i,r),n=this.vertex2.load(t,e,n,i,r),n=this.vertex3.load(t,e,n,i,r)},transformCoordinatesLocal:function(t,e,n,i){return this.vertex1.transformCoordinatesLocal(t,e,n,i),this.vertex2.transformCoordinatesLocal(t,e,n,i),this.vertex3.transformCoordinatesLocal(t,e,n,i),this},updateBounds:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3,i=this.bounds;return i.x=Math.min(t.vx,e.vx,n.vx),i.y=Math.min(t.vy,e.vy,n.vy),i.width=Math.max(t.vx,e.vx,n.vx)-i.x,i.height=Math.max(t.vy,e.vy,n.vy)-i.y,this},isInView:function(t,e,n,i,r,s,o,a,c,l,u){this.update(i,r,s,o,a,c,l,u);var h=this.vertex1,d=this.vertex2,p=this.vertex3;if(h.ta<=0&&d.ta<=0&&p.ta<=0)return!1;if(e&&!this.isCounterClockwise(n))return!1;var f=this.bounds;f.x=Math.min(h.tx,d.tx,p.tx),f.y=Math.min(h.ty,d.ty,p.ty),f.width=Math.max(h.tx,d.tx,p.tx)-f.x,f.height=Math.max(h.ty,d.ty,p.ty)-f.y;var m=t.x+t.width,g=t.y+t.height;return!(f.width<=0||f.height<=0||t.width<=0||t.height<=0)&&!(f.right<t.x||f.bottom<t.y||f.x>m||f.y>g)},scrollUV:function(t,e){return this.vertex1.scrollUV(t,e),this.vertex2.scrollUV(t,e),this.vertex3.scrollUV(t,e),this},scaleUV:function(t,e){return this.vertex1.scaleUV(t,e),this.vertex2.scaleUV(t,e),this.vertex3.scaleUV(t,e),this},setColor:function(t){return this.vertex1.color=t,this.vertex2.color=t,this.vertex3.color=t,this},update:function(t,e,n,i,r,s,o,a){return this.vertex1.update(e,n,i,r,s,o,a,t),this.vertex2.update(e,n,i,r,s,o,a,t),this.vertex3.update(e,n,i,r,s,o,a,t),this},translate:function(t,e){void 0===e&&(e=0);var n=this.vertex1,i=this.vertex2,r=this.vertex3;return n.x+=t,n.y+=e,i.x+=t,i.y+=e,r.x+=t,r.y+=e,this},x:{get:function(){return this.getInCenter().x},set:function(t){var e=this.getInCenter();this.translate(t-e.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(t){var e=this.getInCenter();this.translate(0,t-e.y)}},alpha:{get:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3;return(t.alpha+e.alpha+n.alpha)/3},set:function(t){this.vertex1.alpha=t,this.vertex2.alpha=t,this.vertex3.alpha=t}},depth:{get:function(){var t=this.vertex1,e=this.vertex2,n=this.vertex3;return(t.vz+e.vz+n.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}});t.exports=a},99425:(t,e,n)=>{var i=n(18693),r=n(72632),s=n(16650),o=n(70015),a=n(85769),c=new o,l=new o,u=new s;t.exports=function(t){var e,n=r(t,"mesh"),s=r(t,"texture",null),o=r(t,"frame"),h=r(t,"width",1),d=r(t,"height",h),p=r(t,"widthSegments",1),f=r(t,"heightSegments",p),m=r(t,"x",0),g=r(t,"y",0),v=r(t,"z",0),y=r(t,"rotateX",0),x=r(t,"rotateY",0),b=r(t,"rotateZ",0),w=r(t,"zIsUp",!0),S=r(t,"isOrtho",!!n&&n.dirtyCache[11]),_=r(t,"colors",[16777215]),T=r(t,"alphas",[1]),E=r(t,"tile",!1),C=r(t,"flipY",!1),k=r(t,"width",null),A={faces:[],verts:[]};if(c.set(m,g,v),l.set(y,x,b),u.fromRotationXYTranslation(l,c,w),!s&&n)s=n.texture,o||(e=n.frame);else if(n&&"string"===typeof s)s=n.scene.sys.textures.get(s);else if(!s)return A;e||(e=s.get(o)),!k&&S&&s&&n&&(h=e.width/n.height,d=e.height/n.height);var I,O,R=h/2,N=d/2,M=Math.floor(p),D=Math.floor(f),P=M+1,F=D+1,L=h/M,B=d/D,z=[],U=[],j=0,V=1,W=0,G=1;e&&(j=e.u0,V=e.u1,C?(W=e.v1,G=e.v0):(W=e.v0,G=e.v1));var q=V-j,H=G-W;for(O=0;O<F;O++){var X=O*B-N;for(I=0;I<P;I++){var Y=I*L-R;U.push(Y,-X);var K=j+q*(I/M),Q=W+H*(O/D);z.push(K,Q)}}Array.isArray(_)||(_=[_]),Array.isArray(T)||(T=[T]);var Z=0,J=0;for(O=0;O<D;O++)for(I=0;I<M;I++){var $=2*(I+P*O),tt=2*(I+P*(O+1)),et=2*(I+1+P*(O+1)),nt=2*(I+1+P*O),it=_[J],rt=T[Z],st=new a(U[$],U[$+1],0,z[$],z[$+1],it,rt).transformMat4(u),ot=new a(U[tt],U[tt+1],0,z[tt],z[tt+1],it,rt).transformMat4(u),at=new a(U[nt],U[nt+1],0,z[nt],z[nt+1],it,rt).transformMat4(u),ct=new a(U[tt],U[tt+1],0,z[tt],z[tt+1],it,rt).transformMat4(u),lt=new a(U[et],U[et+1],0,z[et],z[et+1],it,rt).transformMat4(u),ut=new a(U[nt],U[nt+1],0,z[nt],z[nt+1],it,rt).transformMat4(u);E&&(st.setUVs(j,G),ot.setUVs(j,W),at.setUVs(V,G),ct.setUVs(j,W),lt.setUVs(V,W),ut.setUVs(V,G)),++J===_.length&&(J=0),++Z===T.length&&(Z=0),A.verts.push(st,ot,at,ct,lt,ut),A.faces.push(new i(st,ot,at),new i(ct,lt,ut))}return n&&(n.faces=n.faces.concat(A.faces),n.vertices=n.vertices.concat(A.verts)),A}},53267:(t,e,n)=>{var i=n(18693),r=n(16650),s=n(70015),o=n(85769),a=new s,c=new s,l=new r;t.exports=function(t,e,n,r,s,u,h,d,p,f){void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===d&&(d=0),void 0===p&&(p=0),void 0===f&&(f=!0);var m={faces:[],verts:[]},g=t.materials;a.set(r,s,u),c.set(h,d,p),l.fromRotationXYTranslation(c,a,f);for(var v=0;v<t.models.length;v++)for(var y=t.models[v],x=y.vertices,b=y.textureCoords,w=y.faces,S=0;S<w.length;S++){var _=w[S],T=_.vertices[0],E=_.vertices[1],C=_.vertices[2],k=x[T.vertexIndex],A=x[E.vertexIndex],I=x[C.vertexIndex],O=T.textureCoordsIndex,R=E.textureCoordsIndex,N=C.textureCoordsIndex,M=-1===O?{u:0,v:1}:b[O],D=-1===R?{u:0,v:0}:b[R],P=-1===N?{u:1,v:1}:b[N],F=16777215;""!==_.material&&g[_.material]&&(F=g[_.material]);var L=new o(k.x*n,k.y*n,k.z*n,M.u,M.v,F).transformMat4(l),B=new o(A.x*n,A.y*n,A.z*n,D.u,D.v,F).transformMat4(l),z=new o(I.x*n,I.y*n,I.z*n,P.u,P.v,F).transformMat4(l);m.verts.push(L,B,z),m.faces.push(new i(L,B,z))}return e&&(e.faces=e.faces.concat(m.faces),e.vertices=e.vertices.concat(m.verts)),m}},67623:(t,e,n)=>{var i=n(18693),r=n(85769);t.exports=function(t,e,n,s,o,a,c,l){if(void 0===s&&(s=!1),void 0===a&&(a=16777215),void 0===c&&(c=1),void 0===l&&(l=!1),t.length===e.length||s){var u,h,d,p,f,m,g,v,y,x,b,w={faces:[],vertices:[]},S=s?3:2,_=Array.isArray(a),T=Array.isArray(c);if(Array.isArray(n)&&n.length>0)for(u=0;u<n.length;u++){var E=n[u],C=2*n[u],k=n[u]*S;h=t[k],d=t[k+1],p=s?t[k+2]:0,f=e[C],m=e[C+1],l&&(m=1-m),g=_?a[E]:a,v=T?c[E]:c,y=0,x=0,b=0,o&&(y=o[k],x=o[k+1],b=s?o[k+2]:0),w.vertices.push(new r(h,d,p,f,m,g,v,y,x,b))}else{var A=0,I=0;for(u=0;u<t.length;u+=S)h=t[u],d=t[u+1],p=s?t[u+2]:0,f=e[A],m=e[A+1],g=_?a[I]:a,v=T?c[I]:c,y=0,x=0,b=0,o&&(y=o[u],x=o[u+1],b=s?o[u+2]:0),w.vertices.push(new r(h,d,p,f,m,g,v,y,x,b)),A+=2,I++}for(u=0;u<w.vertices.length;u+=3){var O=w.vertices[u],R=w.vertices[u+1],N=w.vertices[u+2];w.faces.push(new i(O,R,N))}return w}console.warn("GenerateVerts: vertices and uvs count not equal")}},27291:t=>{var e=!0,n="untitled",i="",r="";function s(t){var e=t.indexOf("#");return e>-1?t.substring(0,e):t}function o(t){return 0===t.models.length&&t.models.push({faces:[],name:n,textureCoords:[],vertexNormals:[],vertices:[]}),i="",t.models[t.models.length-1]}function a(t,e){var r=t.length>=2?t[1]:n;e.models.push({faces:[],name:r,textureCoords:[],vertexNormals:[],vertices:[]}),i=""}function c(t){2===t.length&&(i=t[1])}function l(t,e){var n=t.length,i=n>=2?parseFloat(t[1]):0,r=n>=3?parseFloat(t[2]):0,s=n>=4?parseFloat(t[3]):0;o(e).vertices.push({x:i,y:r,z:s})}function u(t,n){var i=t.length,r=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;isNaN(r)&&(r=0),isNaN(s)&&(s=0),isNaN(a)&&(a=0),e&&(s=1-s),o(n).textureCoords.push({u:r,v:s,w:a})}function h(t,e){var n=t.length,i=n>=2?parseFloat(t[1]):0,r=n>=3?parseFloat(t[2]):0,s=n>=4?parseFloat(t[3]):0;o(e).vertexNormals.push({x:i,y:r,z:s})}function d(t,e){var n=t.length-1;if(!(n<3)){for(var s={group:i,material:r,vertices:[]},a=0;a<n;a++){var c=t[a+1].split("/"),l=c.length;if(!(l<1||l>3)){var u=0,h=0,d=0;u=parseInt(c[0],10),l>1&&""!==c[1]&&(h=parseInt(c[1],10)),l>2&&(d=parseInt(c[2],10)),0!==u&&(u<0&&(u=o(e).vertices.length+1+u),h-=1,u-=1,d-=1,s.vertices.push({textureCoordsIndex:h,vertexIndex:u,vertexNormalIndex:d}))}}o(e).faces.push(s)}}function p(t,e){t.length>=2&&e.materialLibraries.push(t[1])}function f(t){t.length>=2&&(r=t[1])}t.exports=function(t,n){void 0===n&&(n=!0),e=n;var o={materials:{},materialLibraries:[],models:[]};i="",r="";for(var m=t.split("\n"),g=0;g<m.length;g++){var v=s(m[g]).replace(/\s\s+/g," ").trim().split(" ");switch(v[0].toLowerCase()){case"o":a(v,o);break;case"g":c(v);break;case"v":l(v,o);break;case"vt":u(v,o);break;case"vn":h(v,o);break;case"f":d(v,o);break;case"mtllib":p(v,o);break;case"usemtl":f(v)}}return o}},76799:(t,e,n)=>{var i=n(22946);t.exports=function(t){for(var e={},n=t.split("\n"),r="",s=0;s<n.length;s++){var o=n[s].trim();if(0!==o.indexOf("#")&&""!==o){var a=o.replace(/\s\s+/g," ").trim().split(" ");switch(a[0].toLowerCase()){case"newmtl":r=a[1];break;case"kd":var c=Math.floor(255*a[1]),l=a.length>=2?Math.floor(255*a[2]):c,u=a.length>=3?Math.floor(255*a[3]):c;e[r]=i(c,l,u)}}}return e}},15313:t=>{t.exports=function(t,e,n,i){var r,s;if(void 0===n&&void 0===i){var o=t.getInCenter();r=o.x,s=o.y}var a=Math.cos(e),c=Math.sin(e),l=t.vertex1,u=t.vertex2,h=t.vertex3,d=l.x-r,p=l.y-s;l.set(d*a-p*c+r,d*c+p*a+s),d=u.x-r,p=u.y-s,u.set(d*a-p*c+r,d*c+p*a+s),d=h.x-r,p=h.y-s,h.set(d*a-p*c+r,d*c+p*a+s)}},85769:(t,e,n)=>{var i=n(56694),r=n(75512),s=n(70015),o=new i({Extends:s,initialize:function(t,e,n,i,r,o,a,c,l,u){void 0===o&&(o=16777215),void 0===a&&(a=1),void 0===c&&(c=0),void 0===l&&(l=0),void 0===u&&(u=0),s.call(this,t,e,n),this.vx=0,this.vy=0,this.vz=0,this.nx=c,this.ny=l,this.nz=u,this.u=i,this.v=r,this.color=o,this.alpha=a,this.tx=0,this.ty=0,this.ta=0,this.tu=i,this.tv=r},setUVs:function(t,e){return this.u=t,this.v=e,this.tu=t,this.tv=e,this},scrollUV:function(t,e){return this.tu+=t,this.tv+=e,this},scaleUV:function(t,e){return this.tu=this.u*t,this.tv=this.v*e,this},transformCoordinatesLocal:function(t,e,n,i){var r=this.x,s=this.y,o=this.z,a=t.val,c=r*a[0]+s*a[4]+o*a[8]+a[12],l=r*a[1]+s*a[5]+o*a[9]+a[13],u=r*a[2]+s*a[6]+o*a[10]+a[14],h=r*a[3]+s*a[7]+o*a[11]+a[15];this.vx=c/h*e,this.vy=-l/h*n,this.vz=i<=0?u/h:-u/h},resize:function(t,e,n,i,r,s){return this.x=t,this.y=e,this.vx=this.x*n,this.vy=-this.y*i,this.vz=0,r<.5?this.vx+=n*(.5-r):r>.5&&(this.vx-=n*(r-.5)),s<.5?this.vy+=i*(.5-s):s>.5&&(this.vy-=i*(s-.5)),this},update:function(t,e,n,i,r,s,o,a){var c=this.vx*t+this.vy*n+r,l=this.vx*e+this.vy*i+s;return o&&(c=Math.round(c),l=Math.round(l)),this.tx=c,this.ty=l,this.ta=this.alpha*a,this},load:function(t,e,n,i,s){return t[++n]=this.tx,t[++n]=this.ty,t[++n]=this.tu,t[++n]=this.tv,t[++n]=i,t[++n]=s,e[++n]=r.getTintAppendFloatAlpha(this.color,this.ta),n}});t.exports=o},14293:(t,e,n)=>{var i={Face:n(18693),GenerateGridVerts:n(99425),GenerateObjVerts:n(53267),GenerateVerts:n(67623),ParseObj:n(27291),ParseObjMaterial:n(76799),RotateFace:n(15313),Vertex:n(85769)};t.exports=i},77601:t=>{t.exports=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}},38933:(t,e,n)=>{var i=n(79967);t.exports=function(t){return new i(t.x,t.y)}},47103:t=>{t.exports=function(t,e){return e.setTo(t.x,t.y)}},13625:t=>{t.exports=function(t,e){return t.x===e.x&&t.y===e.y}},12536:t=>{t.exports=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}},54205:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){if(void 0===e&&(e=new i),!Array.isArray(t))throw new Error("GetCentroid points argument must be an array");var n=t.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)e.x=t[0].x,e.y=t[0].y;else{for(var r=0;r<n;r++)e.x+=t[r].x,e.y+=t[r].y;e.x/=n,e.y/=n}return e}},50083:t=>{t.exports=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},82712:t=>{t.exports=function(t){return t.x*t.x+t.y*t.y}},20052:(t,e,n)=>{var i=n(74118);t.exports=function(t,e){void 0===e&&(e=new i);for(var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=0;a<t.length;a++){var c=t[a];c.x>n&&(n=c.x),c.x<r&&(r=c.x),c.y>s&&(s=c.y),c.y<o&&(o=c.y)}return e.x=r,e.y=o,e.width=n-r,e.height=s-o,e}},77154:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=new i),r.x=t.x+(e.x-t.x)*n,r.y=t.y+(e.y-t.y)*n,r}},42397:t=>{t.exports=function(t){return t.setTo(t.y,t.x)}},59464:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.setTo(-t.x,-t.y)}},79967:(t,e,n)=>{var i=n(56694),r=n(52394),s=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=r.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=s},53581:(t,e,n)=>{var i=n(79967),r=n(82712);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=(t.x*e.x+t.y*e.y)/r(e);return 0!==s&&(n.x=s*e.x,n.y=s*e.y),n}},50817:(t,e,n)=>{var i=n(79967);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x*e.x+t.y*e.y;return 0!==r&&(n.x=r*e.x,n.y=r*e.y),n}},40525:(t,e,n)=>{var i=n(50083);t.exports=function(t,e){if(0!==t.x||0!==t.y){var n=i(t);t.x/=n,t.y/=n}return t.x*=e,t.y*=e,t}},63472:(t,e,n)=>{var i=n(79967);i.Ceil=n(77601),i.Clone=n(38933),i.CopyFrom=n(47103),i.Equals=n(13625),i.Floor=n(12536),i.GetCentroid=n(54205),i.GetMagnitude=n(50083),i.GetMagnitudeSq=n(82712),i.GetRectangleFromPoints=n(20052),i.Interpolate=n(77154),i.Invert=n(42397),i.Negative=n(59464),i.Project=n(53581),i.ProjectUnit=n(50817),i.SetMagnitude=n(40525),t.exports=i},19631:(t,e,n)=>{var i=n(8580);t.exports=function(t){return new i(t.points)}},45604:t=>{t.exports=function(t,e,n){for(var i=!1,r=-1,s=t.points.length-1;++r<t.points.length;s=r){var o=t.points[r].x,a=t.points[r].y,c=t.points[s].x,l=t.points[s].y;(a<=n&&n<l||l<=n&&n<a)&&e<(c-o)*(n-a)/(l-a)+o&&(i=!i)}return i}},87289:(t,e,n)=>{var i=n(45604);t.exports=function(t,e){return i(t,e.x,e.y)}},11117:t=>{"use strict";function e(t,e,i){i=i||2;var s,o,a,c,h,d,f,m=e&&e.length,g=m?e[0]*i:t.length,v=n(t,0,g,i,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,i,r){var s,o,a,c=[];for(s=0,o=e.length;s<o;s++)(a=n(t,e[s]*r,s<o-1?e[s+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),c.push(p(a));for(c.sort(l),s=0;s<c.length;s++)i=u(c[s],i);return i}(t,e,v,i)),t.length>80*i){s=a=t[0],o=c=t[1];for(var x=i;x<g;x+=i)(h=t[x])<s&&(s=h),(d=t[x+1])<o&&(o=d),h>a&&(a=h),d>c&&(c=d);f=0!==(f=Math.max(a-s,c-o))?32767/f:0}return r(v,y,i,s,o,f,0),y}function n(t,e,n,i,r){var s,o;if(r===C(t,e,n,i)>0)for(s=e;s<n;s+=i)o=_(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=_(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(T(o),o=o.next),o}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(T(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,l,u,h,p){if(t){!p&&h&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,c,l=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(c=l;a>0||c>0&&i;)0!==a&&(0===c||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,l*=2}while(o>1)}(r)}(t,l,u,h);for(var f,m,g=t;t.prev!==t.next;)if(f=t.prev,m=t.next,h?o(t,l,u,h):s(t))e.push(f.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),T(t),t=m.next,g=m.next;else if((t=m)===g){p?1===p?r(t=a(i(t),e,n),e,n,l,u,h,2):2===p&&c(t,e,n,l,u,h):r(i(t),e,n,l,u,h,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(g(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,o=i.x,a=e.y,c=n.y,l=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<c?a<l?a:l:c<l?c:l,d=r>s?r>o?r:o:s>o?s:o,p=a>c?a>l?a:l:c>l?c:l,m=i.next;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=h&&m.y<=p&&f(r,a,s,c,o,l,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function o(t,e,n,i){var r=t.prev,s=t,o=t.next;if(g(r,s,o)>=0)return!1;for(var a=r.x,c=s.x,l=o.x,u=r.y,h=s.y,p=o.y,m=a<c?a<l?a:l:c<l?c:l,v=u<h?u<p?u:p:h<p?h:p,y=a>c?a>l?a:l:c>l?c:l,x=u>h?u>p?u:p:h>p?h:p,b=d(m,v,e,n,i),w=d(y,x,e,n,i),S=t.prevZ,_=t.nextZ;S&&S.z>=b&&_&&_.z<=w;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==r&&S!==o&&f(a,u,c,h,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;if(S=S.prevZ,_.x>=m&&_.x<=y&&_.y>=v&&_.y<=x&&_!==r&&_!==o&&f(a,u,c,h,l,p,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;S&&S.z>=b;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==r&&S!==o&&f(a,u,c,h,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;_&&_.z<=w;){if(_.x>=m&&_.x<=y&&_.y>=v&&_.y<=x&&_!==r&&_!==o&&f(a,u,c,h,l,p,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function a(t,e,n){var r=t;do{var s=r.prev,o=r.next.next;!v(s,o)&&y(s,r,r.next,o)&&w(s,o)&&w(o,s)&&(e.push(s.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),T(r),T(r.next),r=t=o),r=r.next}while(r!==t);return i(r)}function c(t,e,n,s,o,a){var c=t;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&m(c,l)){var u=S(c,l);return c=i(c,c.next),u=i(u,u.next),r(c,e,n,s,o,a,0),void r(u,e,n,s,o,a,0)}l=l.next}c=c.next}while(c!==t)}function l(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o&&(o=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var c,l=n,u=n.x,d=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&f(s<d?r:o,s,u,d,s<d?o:r,s,i.x,i.y)&&(c=Math.abs(s-i.y)/(r-i.x),w(i,t)&&(c<p||c===p&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,p=c)),i=i.next}while(i!==l);return n}(t,e);if(!n)return e;var r=S(n,t);return i(r,r.next),i(n,n.next)}function h(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,i){var r=b(g(t,e,n)),s=b(g(t,e,i)),o=b(g(n,i,t)),a=b(g(n,i,e));return r!==s&&o!==a||!(0!==r||!x(t,n,e))||!(0!==s||!x(t,i,e))||!(0!==o||!x(n,t,i))||!(0!==a||!x(n,e,i))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function S(t,e){var n=new E(t.i,t.x,t.y),i=new E(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function _(t,e,n,i){var r=new E(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}e.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(C(t,0,s,n));if(r)for(var a=0,c=e.length;a<c;a++){var l=e[a]*n,u=a<c-1?e[a+1]*n:t.length;o-=Math.abs(C(t,l,u,n))}var h=0;for(a=0;a<i.length;a+=3){var d=i[a]*n,p=i[a+1]*n,f=i[a+2]*n;h+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},t.exports=e},14045:(t,e,n)=>{var i=n(74118);t.exports=function(t,e){void 0===e&&(e=new i);for(var n,r=1/0,s=1/0,o=-r,a=-s,c=0;c<t.points.length;c++)n=t.points[c],r=Math.min(r,n.x),s=Math.min(s,n.y),o=Math.max(o,n.x),a=Math.max(a,n.y);return e.x=r,e.y=s,e.width=o-r,e.height=a-s,e}},98286:t=>{t.exports=function(t,e){void 0===e&&(e=[]);for(var n=0;n<t.points.length;n++)e.push(t.points[n].x),e.push(t.points[n].y);return e}},89294:(t,e,n)=>{var i=n(16028),r=n(88829),s=n(5159);t.exports=function(t,e,n,o){void 0===o&&(o=[]);var a=t.points,c=s(t);!e&&n>0&&(e=c/n);for(var l=0;l<e;l++)for(var u=c*(l/e),h=0,d=0;d<a.length;d++){var p=a[d],f=a[(d+1)%a.length],m=new r(p.x,p.y,f.x,f.y),g=i(m);if(!(u<h||u>h+g)){var v=m.getPoint((u-h)/g);o.push(v);break}h+=g}return o}},5159:(t,e,n)=>{var i=n(16028),r=n(88829);t.exports=function(t){for(var e=t.points,n=0,s=0;s<e.length;s++){var o=e[s],a=e[(s+1)%e.length],c=new r(o.x,o.y,a.x,a.y);n+=i(c)}return n}},8580:(t,e,n)=>{var i=n(56694),r=n(45604),s=n(89294),o=n(52394),a=new i({initialize:function(t){this.type=o.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,e){return r(this,t,e)},setTo:function(t){if(this.area=0,this.points=[],"string"===typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,n=0;n<t.length;n++)e={x:0,y:0},"number"===typeof t[n]||"string"===typeof t[n]?(e.x=parseFloat(t[n]),e.y=parseFloat(t[n+1]),n++):Array.isArray(t[n])?(e.x=t[n][0],e.y=t[n][1]):(e.x=t[n].x,e.y=t[n].y),this.points.push(e);return this.calculateArea(),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,n=0,i=0;i<this.points.length-1;i++)t=this.points[i],n+=((e=this.points[i+1]).x-t.x)*(t.y+e.y);return t=this.points[0],e=this.points[this.points.length-1],n+=(t.x-e.x)*(e.y+t.y),this.area=.5*-n,this.area},getPoints:function(t,e,n){return s(this,t,e,n)}});t.exports=a},32244:t=>{t.exports=function(t){return t.points.reverse(),t}},95874:t=>{function e(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function n(t,e,n){var i=e.x,r=e.y,s=n.x-i,o=n.y-r;if(0!==s||0!==o){var a=((t.x-i)*s+(t.y-r)*o)/(s*s+o*o);a>1?(i=n.x,r=n.y):a>0&&(i+=s*a,r+=o*a)}return(s=t.x-i)*s+(o=t.y-r)*o}function i(t,e,r,s,o){for(var a,c=s,l=e+1;l<r;l++){var u=n(t[l],t[e],t[r]);u>c&&(a=l,c=u)}c>s&&(a-e>1&&i(t,e,a,s,o),o.push(t[a]),r-a>1&&i(t,a,r,s,o))}function r(t,e){var n=t.length-1,r=[t[0]];return i(t,0,n,e,r),r.push(t[n]),r}t.exports=function(t,n,i){void 0===n&&(n=1),void 0===i&&(i=!1);var s=t.points;if(s.length>2){var o=n*n;i||(s=function(t,n){for(var i,r=t[0],s=[r],o=1,a=t.length;o<a;o++)e(i=t[o],r)>n&&(s.push(i),r=i);return r!==i&&s.push(i),s}(s,o)),t.setTo(r(s,o))}return t}},18974:t=>{var e=function(t,e){return t[0]=e[0],t[1]=e[1],t};t.exports=function(t){var n,i=[],r=t.points;for(n=0;n<r.length;n++)i.push([r[n].x,r[n].y]);var s=[];for(i.length>0&&s.push(e([0,0],i[0])),n=0;n<i.length-1;n++){var o=i[n],a=i[n+1],c=o[0],l=o[1],u=a[0],h=a[1];s.push([.85*c+.15*u,.85*l+.15*h]),s.push([.15*c+.85*u,.15*l+.85*h])}return i.length>1&&s.push(e([0,0],i[i.length-1])),t.setTo(s)}},23490:t=>{t.exports=function(t,e,n){for(var i=t.points,r=0;r<i.length;r++)i[r].x+=e,i[r].y+=n;return t}},44359:(t,e,n)=>{var i=n(8580);i.Clone=n(19631),i.Contains=n(45604),i.ContainsPoint=n(87289),i.Earcut=n(11117),i.GetAABB=n(14045),i.GetNumberArray=n(98286),i.GetPoints=n(89294),i.Perimeter=n(5159),i.Reverse=n(32244),i.Simplify=n(95874),i.Smooth=n(18974),i.Translate=n(23490),t.exports=i},1653:t=>{t.exports=function(t){return t.width*t.height}},33943:t=>{t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}},58662:t=>{t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}},79993:t=>{t.exports=function(t,e,n){return t.x=e-t.width/2,t.y=n-t.height/2,t}},81572:(t,e,n)=>{var i=n(74118);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},94287:t=>{t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},28687:(t,e,n)=>{var i=n(94287);t.exports=function(t,e){return i(t,e.x,e.y)}},73222:t=>{t.exports=function(t,e){return!(e.width*e.height>t.width*t.height)&&e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom}},29538:t=>{t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},87279:t=>{t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e}},19989:t=>{t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},92628:(t,e,n)=>{var i=n(6700);t.exports=function(t,e){var n=i(t);return n<i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},85028:(t,e,n)=>{var i=n(6700);t.exports=function(t,e){var n=i(t);return n>i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},71356:t=>{t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}},21687:t=>{t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}},80222:(t,e,n)=>{var i=n(74118),r=n(83392);t.exports=function(t,e){if(void 0===e&&(e=new i),0===t.length)return e;for(var n,s,o,a=Number.MAX_VALUE,c=Number.MAX_VALUE,l=r.MIN_SAFE_INTEGER,u=r.MIN_SAFE_INTEGER,h=0;h<t.length;h++)n=t[h],Array.isArray(n)?(s=n[0],o=n[1]):(s=n.x,o=n.y),a=Math.min(a,s),c=Math.min(c,o),l=Math.max(l,s),u=Math.max(u,o);return e.x=a,e.y=c,e.width=l-a,e.height=u-c,e}},75785:(t,e,n)=>{var i=n(74118);t.exports=function(t,e,n,r,s){return void 0===s&&(s=new i),s.setTo(Math.min(t,n),Math.min(e,r),Math.abs(t-n),Math.abs(e-r))}},6700:t=>{t.exports=function(t){return 0===t.height?NaN:t.width/t.height}},35242:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.centerX,e.y=t.centerY,e}},47698:(t,e,n)=>{var i=n(85876),r=n(79967);t.exports=function(t,e,n){if(void 0===n&&(n=new r),e<=0||e>=1)return n.x=t.x,n.y=t.y,n;var s=i(t)*e;return e>.5?(s-=t.width+t.height)<=t.width?(n.x=t.right-s,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(s-t.width)):s<=t.width?(n.x=t.x+s,n.y=t.y):(n.x=t.right,n.y=t.y+(s-t.width)),n}},54932:(t,e,n)=>{var i=n(47698),r=n(85876);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&n>0&&(e=r(t)/n);for(var o=0;o<e;o++){var a=o/e;s.push(i(t,a))}return s}},31591:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.width,e.y=t.height,e}},7782:(t,e,n)=>{var i=n(79993);t.exports=function(t,e,n){var r=t.centerX,s=t.centerY;return t.setSize(t.width+2*e,t.height+2*n),i(t,r,s)}},66217:(t,e,n)=>{var i=n(74118),r=n(90205);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)?(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y):n.setEmpty(),n}},40053:(t,e,n)=>{var i=n(85876),r=n(79967);t.exports=function(t,e,n,s){if(void 0===s&&(s=[]),!e&&!n)return s;e?n=Math.round(i(t)/e):e=i(t)/n;for(var o=t.x,a=t.y,c=0,l=0;l<n;l++)switch(s.push(new r(o,a)),c){case 0:(o+=e)>=t.right&&(c=1,a+=o-t.right,o=t.right);break;case 1:(a+=e)>=t.bottom&&(c=2,o-=a-t.bottom,a=t.bottom);break;case 2:(o-=e)<=t.left&&(c=3,a-=t.left-o,o=t.left);break;case 3:(a-=e)<=t.top&&(c=0,a=t.top)}return s}},86673:t=>{t.exports=function(t,e){for(var n=t.x,i=t.right,r=t.y,s=t.bottom,o=0;o<e.length;o++)n=Math.min(n,e[o].x),i=Math.max(i,e[o].x),r=Math.min(r,e[o].y),s=Math.max(s,e[o].y);return t.x=n,t.y=r,t.width=i-n,t.height=s-r,t}},14655:t=>{t.exports=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.right,e.right);t.x=n,t.width=i-n;var r=Math.min(t.y,e.y),s=Math.max(t.bottom,e.bottom);return t.y=r,t.height=s-r,t}},44755:t=>{t.exports=function(t,e,n){var i=Math.min(t.x,e),r=Math.max(t.right,e);t.x=i,t.width=r-i;var s=Math.min(t.y,n),o=Math.max(t.bottom,n);return t.y=s,t.height=o-s,t}},74466:t=>{t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},55946:t=>{t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},97474:t=>{t.exports=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}},85876:t=>{t.exports=function(t){return 2*(t.width+t.height)}},20243:(t,e,n)=>{var i=n(79967),r=n(75606);t.exports=function(t,e,n){void 0===n&&(n=new i),e=r(e);var s=Math.sin(e),o=Math.cos(e),a=o>0?t.width/2:t.width/-2,c=s>0?t.height/2:t.height/-2;return Math.abs(a*s)<Math.abs(c*o)?c=a*s/o:a=c*o/s,n.x=a+t.centerX,n.y=c+t.centerY,n}},30001:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},97691:(t,e,n)=>{var i=n(17489),r=n(73222),s=n(79967);t.exports=function(t,e,n){if(void 0===n&&(n=new s),r(t,e))switch(i(0,3)){case 0:n.x=t.x+Math.random()*(e.right-t.x),n.y=t.y+Math.random()*(e.top-t.y);break;case 1:n.x=e.x+Math.random()*(t.right-e.x),n.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:n.x=t.x+Math.random()*(e.x-t.x),n.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:n.x=e.right+Math.random()*(t.right-e.right),n.y=t.y+Math.random()*(e.bottom-t.y)}return n}},74118:(t,e,n)=>{var i=n(56694),r=n(94287),s=n(47698),o=n(54932),a=n(52394),c=n(88829),l=n(30001),u=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return l(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new c),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new c),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new c),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new c),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=u},51828:t=>{t.exports=function(t,e){return t.width===e.width&&t.height===e.height}},5691:t=>{t.exports=function(t,e,n){return void 0===n&&(n=e),t.width*=e,t.height*=n,t}},58795:(t,e,n)=>{var i=n(74118);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=Math.min(t.x,e.x),s=Math.min(t.y,e.y),o=Math.max(t.right,e.right)-r,a=Math.max(t.bottom,e.bottom)-s;return n.setTo(r,s,o,a)}},66658:(t,e,n)=>{var i=n(74118);i.Area=n(1653),i.Ceil=n(33943),i.CeilAll=n(58662),i.CenterOn=n(79993),i.Clone=n(81572),i.Contains=n(94287),i.ContainsPoint=n(28687),i.ContainsRect=n(73222),i.CopyFrom=n(29538),i.Decompose=n(87279),i.Equals=n(19989),i.FitInside=n(92628),i.FitOutside=n(85028),i.Floor=n(71356),i.FloorAll=n(21687),i.FromPoints=n(80222),i.FromXY=n(75785),i.GetAspectRatio=n(6700),i.GetCenter=n(35242),i.GetPoint=n(47698),i.GetPoints=n(54932),i.GetSize=n(31591),i.Inflate=n(7782),i.Intersection=n(66217),i.MarchingAnts=n(40053),i.MergePoints=n(86673),i.MergeRect=n(14655),i.MergeXY=n(44755),i.Offset=n(74466),i.OffsetPoint=n(55946),i.Overlaps=n(97474),i.Perimeter=n(85876),i.PerimeterPoint=n(20243),i.Random=n(30001),i.RandomOutside=n(97691),i.SameDimensions=n(51828),i.Scale=n(5691),i.Union=n(58795),t.exports=i},19108:t=>{t.exports=function(t){var e=t.x1,n=t.y1,i=t.x2,r=t.y2,s=t.x3,o=t.y3;return Math.abs(((s-e)*(r-n)-(i-e)*(o-n))/2)}},41199:(t,e,n)=>{var i=n(66349);t.exports=function(t,e,n){var r=n*(Math.sqrt(3)/2);return new i(t,e,t+n/2,e+r,t-n/2,e+r)}},88730:(t,e,n)=>{var i=n(11117),r=n(66349);t.exports=function(t,e,n,s,o){void 0===e&&(e=null),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o=[]);for(var a,c,l,u,h,d,p,f,m,g=i(t,e),v=0;v<g.length;v+=3)a=g[v],c=g[v+1],l=g[v+2],u=t[2*a]*n,h=t[2*a+1]*s,d=t[2*c]*n,p=t[2*c+1]*s,f=t[2*l]*n,m=t[2*l+1]*s,o.push(new r(u,h,d,p,f,m));return o}},3635:(t,e,n)=>{var i=n(66349);t.exports=function(t,e,n,r){return void 0===r&&(r=n),new i(t,e,t,e-r,t+n,e)}},1882:(t,e,n)=>{var i=n(56595),r=n(9640);t.exports=function(t,e,n,s){void 0===s&&(s=i);var o=s(t),a=e-o.x,c=n-o.y;return r(t,a,c)}},56595:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2+t.x3)/3,e.y=(t.y1+t.y2+t.y3)/3,e}},91835:(t,e,n)=>{var i=n(93736);function r(t,e,n,i){return t*i-e*n}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x3,s=t.y3,o=t.x1-n,a=t.y1-s,c=t.x2-n,l=t.y2-s,u=2*r(o,a,c,l),h=r(a,o*o+a*a,l,c*c+l*l),d=r(o,o*o+a*a,c,c*c+l*l);return e.x=n-h/u,e.y=s+d/u,e}},97073:(t,e,n)=>{var i=n(26673);t.exports=function(t,e){void 0===e&&(e=new i);var n,r,s=t.x1,o=t.y1,a=t.x2,c=t.y2,l=t.x3,u=t.y3,h=a-s,d=c-o,p=l-s,f=u-o,m=h*(s+a)+d*(o+c),g=p*(s+l)+f*(o+u),v=2*(h*(u-c)-d*(l-a));if(Math.abs(v)<1e-6){var y=Math.min(s,a,l),x=Math.min(o,c,u);n=.5*(Math.max(s,a,l)-y),r=.5*(Math.max(o,c,u)-x),e.x=y+n,e.y=x+r,e.radius=Math.sqrt(n*n+r*r)}else e.x=(f*m-d*g)/v,e.y=(h*g-p*m)/v,n=e.x-s,r=e.y-o,e.radius=Math.sqrt(n*n+r*r);return e}},75974:(t,e,n)=>{var i=n(66349);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},60689:t=>{t.exports=function(t,e,n){var i=t.x3-t.x1,r=t.y3-t.y1,s=t.x2-t.x1,o=t.y2-t.y1,a=e-t.x1,c=n-t.y1,l=i*i+r*r,u=i*s+r*o,h=i*a+r*c,d=s*s+o*o,p=s*a+o*c,f=l*d-u*u,m=0===f?0:1/f,g=(d*h-u*p)*m,v=(l*p-u*h)*m;return g>=0&&v>=0&&g+v<1}},86875:t=>{t.exports=function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=[]);for(var r,s,o,a,c,l,u=t.x3-t.x1,h=t.y3-t.y1,d=t.x2-t.x1,p=t.y2-t.y1,f=u*u+h*h,m=u*d+h*p,g=d*d+p*p,v=f*g-m*m,y=0===v?0:1/v,x=t.x1,b=t.y1,w=0;w<e.length&&(s=(f*(l=d*(o=e[w].x-x)+p*(a=e[w].y-b))-m*(c=u*o+h*a))*y,!((r=(g*c-m*l)*y)>=0&&s>=0&&r+s<1&&(i.push({x:e[w].x,y:e[w].y}),n)));w++);return i}},51532:(t,e,n)=>{var i=n(60689);t.exports=function(t,e){return i(t,e.x,e.y)}},42538:t=>{t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},18680:t=>{t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e}},29977:t=>{t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}},56088:(t,e,n)=>{var i=n(79967),r=n(16028);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();if(e<=0||e>=1)return n.x=s.x1,n.y=s.y1,n;var c=r(s),l=r(o),u=r(a),h=(c+l+u)*e,d=0;return h<c?(d=h/c,n.x=s.x1+(s.x2-s.x1)*d,n.y=s.y1+(s.y2-s.y1)*d):h>c+l?(d=(h-=c+l)/u,n.x=a.x1+(a.x2-a.x1)*d,n.y=a.y1+(a.y2-a.y1)*d):(d=(h-=c)/l,n.x=o.x1+(o.x2-o.x1)*d,n.y=o.y1+(o.y2-o.y1)*d),n}},24402:(t,e,n)=>{var i=n(16028),r=n(79967);t.exports=function(t,e,n,s){void 0===s&&(s=[]);var o=t.getLineA(),a=t.getLineB(),c=t.getLineC(),l=i(o),u=i(a),h=i(c),d=l+u+h;!e&&n>0&&(e=d/n);for(var p=0;p<e;p++){var f=d*(p/e),m=0,g=new r;f<l?(m=f/l,g.x=o.x1+(o.x2-o.x1)*m,g.y=o.y1+(o.y2-o.y1)*m):f>l+u?(m=(f-=l+u)/h,g.x=c.x1+(c.x2-c.x1)*m,g.y=c.y1+(c.y2-c.y1)*m):(m=(f-=l)/u,g.x=a.x1+(a.x2-a.x1)*m,g.y=a.y1+(a.y2-a.y1)*m),s.push(g)}return s}},83648:(t,e,n)=>{var i=n(79967);function r(t,e,n,i){var r=t-n,s=e-i,o=r*r+s*s;return Math.sqrt(o)}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x1,s=t.y1,o=t.x2,a=t.y2,c=t.x3,l=t.y3,u=r(c,l,o,a),h=r(n,s,c,l),d=r(o,a,n,s),p=u+h+d;return e.x=(n*u+o*h+c*d)/p,e.y=(s*u+a*h+l*d)/p,e}},9640:t=>{t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t.x3+=e,t.y3+=n,t}},95290:(t,e,n)=>{var i=n(16028);t.exports=function(t){var e=t.getLineA(),n=t.getLineB(),r=t.getLineC();return i(e)+i(n)+i(r)}},99761:(t,e,n)=>{var i=n(79967);t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x2-t.x1,r=t.y2-t.y1,s=t.x3-t.x1,o=t.y3-t.y1,a=Math.random(),c=Math.random();return a+c>=1&&(a=1-a,c=1-c),e.x=t.x1+(n*a+s*c),e.y=t.y1+(r*a+o*c),e}},21934:(t,e,n)=>{var i=n(19211),r=n(83648);t.exports=function(t,e){var n=r(t);return i(t,n.x,n.y,e)}},68454:(t,e,n)=>{var i=n(19211);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},19211:t=>{t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,o=t.x2-e,a=t.y2-n,t.x2=o*r-a*s+e,t.y2=o*s+a*r+n,o=t.x3-e,a=t.y3-n,t.x3=o*r-a*s+e,t.y3=o*s+a*r+n,t}},66349:(t,e,n)=>{var i=n(56694),r=n(60689),s=n(56088),o=n(24402),a=n(52394),c=n(88829),l=n(99761),u=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.type=a.TRIANGLE,this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return l(this,t)},setTo:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s,this},getLineA:function(t){return void 0===t&&(t=new c),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new c),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new c),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}}});t.exports=u},87619:(t,e,n)=>{var i=n(66349);i.Area=n(19108),i.BuildEquilateral=n(41199),i.BuildFromPolygon=n(88730),i.BuildRight=n(3635),i.CenterOn=n(1882),i.Centroid=n(56595),i.CircumCenter=n(91835),i.CircumCircle=n(97073),i.Clone=n(75974),i.Contains=n(60689),i.ContainsArray=n(86875),i.ContainsPoint=n(51532),i.CopyFrom=n(42538),i.Decompose=n(18680),i.Equals=n(29977),i.GetPoint=n(56088),i.GetPoints=n(24402),i.InCenter=n(83648),i.Perimeter=n(95290),i.Offset=n(9640),i.Random=n(99761),i.Rotate=n(21934),i.RotateAroundPoint=n(68454),i.RotateAroundXY=n(19211),t.exports=i},27395:t=>{t.exports=function(t,e,n){return{gameObject:t,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:n,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragX:0,dragY:0}}},18104:t=>{t.exports=function(t,e){return function(n,i,r,s){var o=t.getPixelAlpha(i,r,s.texture.key,s.frame.name);return o&&o>=e}}},69898:(t,e,n)=>{var i=n(56694),r=n(72687),s=n(6659),o=n(33963),a=n(97081),c=n(71064),l=n(7905),u=n(40398),h=n(37579),d=n(69360),p=n(64462),f=new i({initialize:function(t,e){this.game=t,this.scaleManager,this.canvas,this.config=e,this.enabled=!0,this.events=new s,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new c(this):null,this.mouse=e.inputMouse?new l(this):null,this.touch=e.inputTouch?new h(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers,e.inputTouch&&1===this.pointersTotal&&(this.pointersTotal=2);for(var n=0;n<=this.pointersTotal;n++){var i=new u(this,n);i.smoothFactor=e.inputSmoothFactor,this.pointers.push(i)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new d,this._tempMatrix2=new d,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(a.BOOT,this.boot,this)},boot:function(){var t=this.game,e=t.events;this.canvas=t.canvas,this.scaleManager=t.scale,this.events.emit(o.MANAGER_BOOT),e.on(a.PRE_RENDER,this.preRender,this),e.once(a.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(o.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(o.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,n=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(o.MANAGER_UPDATE);for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t){t.cursor&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var n=0;n<t;n++){var i=this.pointers.length,r=new u(this,i);r.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(r),this.pointersTotal++,e.push(r)}return e},updateInputPlugins:function(t,e){var n=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&(r.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip))return}},onTouchStart:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(!a.active){a.touchstart(s,t),this.activePointer=a,n.push(a);break}}this.updateInputPlugins(r.TOUCH_START,n)},onTouchMove:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){var c=document.elementFromPoint(s.pageX,s.pageY)===this.canvas;!this.isOver&&c?this.setCanvasOver(t):this.isOver&&!c&&this.setCanvasOut(t),this.isOver&&(a.touchmove(s,t),this.activePointer=a,n.push(a));break}}this.updateInputPlugins(r.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchend(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_END,n)},onTouchCancel:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchcancel(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_CANCEL,n)},onMouseDown:function(t){var e=this.mousePointer;e.down(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var e=this.mousePointer;e.move(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var e=this.mousePointer;e.up(t),e.updateMotion(),this.activePointer=e,this.updateInputPlugins(r.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var e=this.mousePointer;e.wheel(t),this.activePointer=e,this.updateInputPlugins(r.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(o.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var n=t.input;if(!n||!n.enabled||!t.willRender(e))return!1;var i=!0,r=t.parentContainer;if(r)do{if(!r.willRender(e)){i=!1;break}r=r.parentContainer}while(r);return i},hitTest:function(t,e,n,i){void 0===i&&(i=this._tempHitTest);var r=this._tempPoint,s=n.scrollX,o=n.scrollY;i.length=0;var a=t.x,c=t.y;n.getWorldPoint(a,c,r),t.worldX=r.x,t.worldY=r.y;for(var l={x:0,y:0},u=this._tempMatrix,h=this._tempMatrix2,d=0;d<e.length;d++){var f=e[d];if(this.inputCandidate(f,n)){var m=r.x+s*f.scrollFactorX-s,g=r.y+o*f.scrollFactorY-o;f.parentContainer?(f.getWorldTransformMatrix(u,h),u.applyInverse(m,g,l)):p(m,g,f.x,f.y,f.rotation,f.scaleX,f.scaleY,l),this.pointWithinHitArea(f,l.x,l.y)&&i.push(f)}}return i},pointWithinHitArea:function(t,e,n){e+=t.displayOriginX,n+=t.displayOriginY;var i=t.input;return!(!i||!i.hitAreaCallback(i.hitArea,e,n,t))&&(i.localX=e,i.localY=n,!0)},pointWithinInteractiveObject:function(t,e,n){return!!t.hitArea&&(e+=t.gameObject.displayOriginX,n+=t.gameObject.displayOriginY,t.localX=e,t.localY=n,t.hitAreaCallback(t.hitArea,e,n,t))},transformPointer:function(t,e,n,i){var r=t.position,s=t.prevPosition;s.x=r.x,s.y=r.y;var o=this.scaleManager.transformX(e),a=this.scaleManager.transformY(n),c=t.smoothFactor;i&&0!==c?(r.x=o*c+s.x*(1-c),r.y=a*c+s.y*(1-c)):(r.x=o,r.y=a)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(a.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});t.exports=f},12499:(t,e,n)=>{var i=n(26673),r=n(65650),s=n(56694),o=n(72687),a=n(27395),c=n(18104),l=n(53996),u=n(95669),h=n(72313),d=n(33963),p=n(6659),f=n(72632),m=n(52394),g=n(63399),v=n(42911),y=n(91963),x=n(74118),b=n(94287),w=n(7599),S=n(66349),_=n(60689),T=new s({Extends:p,initialize:function(t){p.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new p,this.enabled=!0,this.displayList,this.cameras,g.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(w.BOOT,this.boot,this),t.sys.events.on(w.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(w.DESTROY,this.destroy,this),this.pluginEvents.emit(d.BOOT)},start:function(){var t=this.systems.events;t.on(w.TRANSITION_START,this.transitionIn,this),t.on(w.TRANSITION_OUT,this.transitionOut,this),t.on(w.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(w.PRE_UPDATE,this.preUpdate,this),t.once(w.SHUTDOWN,this.shutdown,this),this.manager.events.on(d.GAME_OUT,this.onGameOut,this),this.manager.events.on(d.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(d.START)},onGameOver:function(t){this.isActive()&&this.emit(d.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(d.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(d.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,n=t.length,i=e.length;if(0!==n||0!==i){for(var r=this._list,s=0;s<n;s++){var o=t[s],a=r.indexOf(o);a>-1&&(r.splice(a,1),this.clear(o,!0))}this._pendingRemoval.length=0,this._list=r.concat(e.splice(0))}},isActive:function(){return this.enabled&&this.scene.sys.canInput()},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(d.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var n,i=this.manager,r=i.pointers,s=i.pointersTotal;for(n=0;n<s;n++)r[n].updateMotion();if(0===this._list.length)return!1;var o=this.pollRate;if(-1===o)return!1;if(o>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var a=!1;for(n=0;n<s;n++){var c=0,l=r[n];this._tempZones=[],this._temp=this.hitTestPointer(l),this.sortGameObjects(this._temp,l),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),c+=this.processOverOutEvents(l),2===this.getDragState(l)&&this.processDragThresholdEvent(l,t),c>0&&(a=!0)}return a},update:function(t,e){if(!this.isActive())return!1;for(var n=e.length,i=!1,r=0;r<n;r++){var s=0,a=e[r];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp,a),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case o.MOUSE_DOWN:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_UP:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOverOutEvents(a);break;case o.TOUCH_START:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverEvents(a);break;case o.TOUCH_END:case o.TOUCH_CANCEL:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOutEvents(a);break;case o.MOUSE_MOVE:case o.TOUCH_MOVE:s+=this.processDragMoveEvent(a),s+=this.processMoveEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_WHEEL:s+=this.processWheelEvent(a)}s>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1),this.disable(t);var n=t.input;n&&(this.removeDebug(t),n.gameObject=void 0,n.target=void 0,n.hitArea=void 0,n.hitAreaCallback=void 0,n.callbackContext=void 0,t.input=null),e||this.queueForRemoval(t);var i=this._draggable.indexOf(t);return i>-1&&this._draggable.splice(i,1),t},disable:function(t){var e=t.input;e&&(e.enabled=!1,e.dragState=0);var n=this._temp,i=this._drag,r=this._over,s=this.manager,o=n.indexOf(t);o>-1&&n.splice(o,1);for(var a=0;a<s.pointersTotal;a++)(o=i[a].indexOf(t))>-1&&i[a].splice(o,1),(o=r[a].indexOf(t))>-1&&(r[a].splice(o,1),s.resetCursor(e));return this},enable:function(t,e,n,i){return void 0===i&&(i=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,n),t.input&&i&&!t.input.dropZone&&(t.input.dropZone=i),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),n=0;n<e.length;n++){for(var i=e[n],r=this.manager.hitTest(t,this._list,i),s=0;s<r.length;s++){var o=r[s];o.input.dropZone&&this._tempZones.push(o)}if(r.length>0)return t.camera=i,r}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input&&a.input.enabled){if(e++,a.emit(d.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input||!a.input.enabled){s=!0;break}if(this.emit(d.GAMEOBJECT_DOWN,t,a,r),i.cancelled||!a.input){s=!0;break}}}return!s&&this.manager&&(t.downElement===this.manager.game.canvas?this.emit(d.POINTER_DOWN,t,n):this.emit(d.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var n=!1,i=this.dragTimeThreshold,r=this.dragDistanceThreshold;if((r>0&&l(t.x,t.y,t.downX,t.downY)>=r||i>0&&e>=t.downTime+i)&&(n=!0),n)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;r.dragState=2,r.dragStartX=i.x,r.dragStartY=i.y,r.dragStartXGlobal=t.worldX,r.dragStartYGlobal=t.worldY,r.dragX=r.dragStartXGlobal-r.dragStartX,r.dragY=r.dragStartYGlobal-r.dragStartY,i.emit(d.GAMEOBJECT_DRAG_START,t,r.dragX,r.dragY),this.emit(d.DRAG_START,t,i)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var n=[],i=0;i<e.length;i++){var r=e[i];r.input.draggable&&0===r.input.dragState&&n.push(r)}return 0===n.length?(this.setDragState(t,0),0):(n.length>1&&(this.sortGameObjects(n,t),this.topOnly&&n.splice(1)),this._drag[t.id]=n,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(2===this.getDragState(t)&&this.processDragThresholdEvent(t,this.manager.game.loop.now),4!==this.getDragState(t))return 0;for(var e=this._tempZones,n=this._drag[t.id],i=0;i<n.length;i++){var r,s,o=n[i],a=o.input,c=a.target;if(c){var l=e.indexOf(c);0===l?(o.emit(d.GAMEOBJECT_DRAG_OVER,t,c),this.emit(d.DRAG_OVER,t,o,c)):l>0?(o.emit(d.GAMEOBJECT_DRAG_LEAVE,t,c),this.emit(d.DRAG_LEAVE,t,o,c),a.target=e[0],c=a.target,o.emit(d.GAMEOBJECT_DRAG_ENTER,t,c),this.emit(d.DRAG_ENTER,t,o,c)):(o.emit(d.GAMEOBJECT_DRAG_LEAVE,t,c),this.emit(d.DRAG_LEAVE,t,o,c),e[0]?(a.target=e[0],c=a.target,o.emit(d.GAMEOBJECT_DRAG_ENTER,t,c),this.emit(d.DRAG_ENTER,t,o,c)):a.target=null)}else!c&&e[0]&&(a.target=e[0],c=a.target,o.emit(d.GAMEOBJECT_DRAG_ENTER,t,c),this.emit(d.DRAG_ENTER,t,o,c));if(o.parentContainer){var u=t.worldX-a.dragStartXGlobal,h=t.worldY-a.dragStartYGlobal,p=o.getParentRotation(),f=u*Math.cos(p)+h*Math.sin(p),m=h*Math.cos(p)-u*Math.sin(p);f*=1/o.parentContainer.scaleX,m*=1/o.parentContainer.scaleY,r=f+a.dragStartX,s=m+a.dragStartY}else r=t.worldX-a.dragX,s=t.worldY-a.dragY;o.emit(d.GAMEOBJECT_DRAG,t,r,s),this.emit(d.DRAG,t,o,r,s)}return n.length},processDragUpEvent:function(t){for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;if(r&&2===r.dragState){r.dragState=0,r.dragX=r.localX-i.displayOriginX,r.dragY=r.localY-i.displayOriginY;var s=!1,o=r.target;o&&(i.emit(d.GAMEOBJECT_DROP,t,o),this.emit(d.DROP,t,i,o),r.target=null,s=!0),i.input&&i.input.enabled&&(i.emit(d.GAMEOBJECT_DRAG_END,t,r.dragX,r.dragY,s),this.emit(d.DRAG_END,t,i,s))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input&&a.input.enabled){if(e++,a.emit(d.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input||!a.input.enabled){s=!0;break}if(this.emit(d.GAMEOBJECT_MOVE,t,a,r),i.cancelled||!a.input||!a.input.enabled){s=!0;break}if(this.topOnly)break}}return s||this.emit(d.POINTER_MOVE,t,n),e},processWheelEvent:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=t.deltaX,a=t.deltaY,c=t.deltaZ,l=0;l<n.length;l++){var u=n[l];if(u.input&&u.input.enabled){if(e++,u.emit(d.GAMEOBJECT_POINTER_WHEEL,t,o,a,c,r),i.cancelled||!u.input||!u.input.enabled){s=!0;break}if(this.emit(d.GAMEOBJECT_WHEEL,t,u,o,a,c,r),i.cancelled||!u.input||!u.input.enabled){s=!0;break}}}return s||this.emit(d.POINTER_WHEEL,t,n,o,a,c),e},processOverEvents:function(t){var e=this._temp,n=0,i=e.length,r=[];if(i>0){var s=this.manager,o=this._eventData,a=this._eventContainer;o.cancelled=!1;for(var c=!1,l=0;l<i;l++){var u=e[l];if(u.input&&u.input.enabled){if(r.push(u),s.setCursor(u.input),u.emit(d.GAMEOBJECT_POINTER_OVER,t,u.input.localX,u.input.localY,a),n++,o.cancelled||!u.input||!u.input.enabled){c=!0;break}if(this.emit(d.GAMEOBJECT_OVER,t,u,a),o.cancelled||!u.input||!u.input.enabled){c=!0;break}}}c||this.emit(d.POINTER_OVER,t,r)}return this._over[t.id]=r,n},processOutEvents:function(t){var e=this._over[t.id],n=0,i=e.length;if(i>0){var r=this.manager,s=this._eventData,o=this._eventContainer;s.cancelled=!1;var a=!1;this.sortGameObjects(e,t);for(var c=0;c<i;c++){var l=e[c];if((l=e[c]).input&&l.input.enabled){if(r.resetCursor(l.input),l.emit(d.GAMEOBJECT_POINTER_OUT,t,o),n++,s.cancelled||!l.input||!l.input.enabled){a=!0;break}if(this.emit(d.GAMEOBJECT_OUT,t,l,o),s.cancelled||!l.input||!l.input.enabled){a=!0;break}a||this.emit(d.POINTER_OUT,t,e)}}this._over[t.id]=[]}return n},processOverOutEvents:function(t){var e,n,i=this._temp,r=[],s=[],o=[],a=this._over[t.id],c=this._drag[t.id],l=this.manager;for(e=0;e<a.length;e++)n=a[e],-1===i.indexOf(n)&&-1===c.indexOf(n)?r.push(n):o.push(n);for(e=0;e<i.length;e++)n=i[e],-1===a.indexOf(n)&&s.push(n);var u=r.length,h=0,p=this._eventData,f=this._eventContainer;p.cancelled=!1;var m=!1;if(u>0){for(this.sortGameObjects(r,t),e=0;e<u;e++)if((n=r[e]).input&&n.input.enabled){if(l.resetCursor(n.input),n.emit(d.GAMEOBJECT_POINTER_OUT,t,f),h++,p.cancelled||!n.input||!n.input.enabled){m=!0;break}if(this.emit(d.GAMEOBJECT_OUT,t,n,f),p.cancelled||!n.input||!n.input.enabled){m=!0;break}}m||this.emit(d.POINTER_OUT,t,r)}if(u=s.length,p.cancelled=!1,m=!1,u>0){for(this.sortGameObjects(s,t),e=0;e<u;e++)if((n=s[e]).input&&n.input.enabled){if(l.setCursor(n.input),n.emit(d.GAMEOBJECT_POINTER_OVER,t,n.input.localX,n.input.localY,f),h++,p.cancelled||!n.input||!n.input.enabled){m=!0;break}if(this.emit(d.GAMEOBJECT_OVER,t,n,f),p.cancelled||!n.input||!n.input.enabled){m=!0;break}}m||this.emit(d.POINTER_OVER,t,s)}return a=o.concat(s),this._over[t.id]=this.sortGameObjects(a,t),h},processUpEvents:function(t){var e=this._temp,n=this._eventData,i=this._eventContainer;n.cancelled=!1;for(var r=!1,s=0;s<e.length;s++){var o=e[s];if(o.input&&o.input.enabled){if(o.emit(d.GAMEOBJECT_POINTER_UP,t,o.input.localX,o.input.localY,i),n.cancelled||!o.input||!o.input.enabled){r=!0;break}if(this.emit(d.GAMEOBJECT_UP,t,o,i),n.cancelled||!o.input||!o.input.enabled){r=!0;break}}}return!r&&this.manager&&(t.upElement===this.manager.game.canvas?this.emit(d.POINTER_UP,t,e):this.emit(d.POINTER_UP_OUTSIDE,t)),e.length},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];i.input.draggable=e;var r=this._draggable.indexOf(i);e&&-1===r?this._draggable.push(i):!e&&r>-1&&this._draggable.splice(r,1)}return this},makePixelPerfect:function(t){void 0===t&&(t=1);var e=this.systems.textures;return c(e,t)},setHitArea:function(t,e,n){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var i=!1,r=!1,s=!1,o=!1,c=!1,l=!0;if(v(e)){var u=e;e=f(u,"hitArea",null),n=f(u,"hitAreaCallback",null),i=f(u,"draggable",!1),r=f(u,"dropZone",!1),s=f(u,"cursor",!1),o=f(u,"useHandCursor",!1),c=f(u,"pixelPerfect",!1);var h=f(u,"alphaTolerance",1);c&&(e={},n=this.makePixelPerfect(h)),e&&n||(this.setHitAreaFromTexture(t),l=!1)}else"function"!==typeof e||n||(n=e,e={});for(var d=0;d<t.length;d++){var p=t[d];if(c&&"Container"===p.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var m=p.input?p.input:a(p,e,n);m.customHitArea=l,m.dropZone=r,m.cursor=o?"pointer":s,p.input=m,i&&this.setDraggable(p),this.queueForInsertion(p)}}return this},setHitAreaCircle:function(t,e,n,s,o){void 0===o&&(o=r);var a=new i(e,n,s);return this.setHitArea(t,a,o)},setHitAreaEllipse:function(t,e,n,i,r,s){void 0===s&&(s=h);var o=new u(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=b),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n],r=i.frame,s=0,o=0;i.width?(s=i.width,o=i.height):r&&(s=r.realWidth,o=r.realHeight),"Container"!==i.type||0!==s&&0!==o?0!==s&&0!==o&&(i.input=a(i,new x(0,0,s,o),e),this.queueForInsertion(i)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,n,i,r,s){void 0===s&&(s=b);var o=new x(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaTriangle:function(t,e,n,i,r,s,o,a){void 0===a&&(a=_);var c=new S(e,n,i,r,s,o);return this.setHitArea(t,c,a)},enableDebug:function(t,e){void 0===e&&(e=65280);var n=t.input;if(!n||!n.hitArea)return this;var i=n.hitArea,r=i.type,s=n.hitAreaDebug,o=this.systems.add,a=this.systems.updateList;s&&(a.remove(s),s.destroy(),s=null);var c=0,l=0;switch(r){case m.CIRCLE:s=o.arc(0,0,i.radius),c=i.x-i.radius,l=i.y-i.radius;break;case m.ELLIPSE:s=o.ellipse(0,0,i.width,i.height),c=i.x-i.width/2,l=i.y-i.height/2;break;case m.LINE:s=o.line(0,0,i.x1,i.y1,i.x2,i.y2);break;case m.POLYGON:s=o.polygon(0,0,i.points);break;case m.RECTANGLE:s=o.rectangle(0,0,i.width,i.height),c=i.x,l=i.y;break;case m.TRIANGLE:s=o.triangle(0,0,i.x1,i.y1,i.x2,i.y2,i.x3,i.y3)}return s&&(s.isFilled=!1,s.strokeColor=e,s.preUpdate=function(){s.setStrokeStyle(1/t.scale,s.strokeColor),s.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var e=t.x,n=t.y,i=t.rotation,r=t.scaleX,o=t.scaleY;if(t.parentContainer){var a=t.getWorldTransformMatrix();e=a.tx,n=a.ty,i=a.rotation,r=a.scaleX,o=a.scaleY}s.setRotation(i),s.setScale(r,o),s.setPosition(e+c*r,n+l*o),s.setScrollFactor(t.scrollFactorX,t.scrollFactorY),s.setDepth(t.depth)},a.add(s),n.hitAreaDebug=s),this},removeDebug:function(t){var e=t.input;if(e&&e.hitAreaDebug){var n=e.hitAreaDebug;this.systems.updateList.remove(n),n.destroy(),e.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2||!e.camera)return t;var n=e.camera.renderList;return t.sort((function(t,e){var i=Math.max(n.indexOf(t),0);return Math.max(n.indexOf(e),0)-i}))},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(t.parentContainer||e.parentContainer){if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var n=t.getIndexList(),i=e.getIndexList(),r=Math.min(n.length,i.length),s=0;s<r;s++){var o=n[s],a=i[s];if(o!==a)return a-o}return i.length-n.length}return this.displayList.getIndex(e)-this.displayList.getIndex(t)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(d.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var n=this.systems.events;n.off(w.TRANSITION_START,this.transitionIn,this),n.off(w.TRANSITION_OUT,this.transitionOut,this),n.off(w.TRANSITION_COMPLETE,this.transitionComplete,this),n.off(w.PRE_UPDATE,this.preUpdate,this),e.events.off(d.GAME_OUT,this.onGameOut,this),e.events.off(d.GAME_OVER,this.onGameOver,this),n.off(w.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var t=this.manager.pointers,e=0;e<t.length;e++)t[e].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(d.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(w.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});y.register("InputPlugin",T,"input"),t.exports=T},63399:(t,e,n)=>{var i=n(10850),r={},s={register:function(t,e,n,i,s){r[t]={plugin:e,mapping:n,settingsKey:i,configKey:s}},getPlugin:function(t){return r[t]},install:function(t){var e=t.scene.sys,n=e.settings.input,s=e.game.config;for(var o in r){var a=r[o].plugin,c=r[o].mapping,l=r[o].settingsKey,u=r[o].configKey;i(n,l,s[u])&&(t[c]=new a(t))}},remove:function(t){r.hasOwnProperty(t)&&delete r[t]}};t.exports=s},40398:(t,e,n)=>{var i=n(90447),r=n(56694),s=n(53996),o=n(88456),a=n(44521),c=n(93736),l=n(36580),u=new r({initialize:function(t,e){this.manager=t,this.id=e,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new c,this.prevPosition=new c,this.midPoint=new c(-1,-1),this.velocity=new c,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var t=this.position.x,e=this.position.y,n=this.midPoint.x,r=this.midPoint.y;if(t!==n||e!==r){var s=a(this.motionFactor,n,t),c=a(this.motionFactor,r,e);o(s,t,.1)&&(s=t),o(c,e,.1)&&(c=e),this.midPoint.set(s,c);var l=t-s,u=e-c;this.velocity.set(l,u),this.angle=i(s,c,t,e),this.distance=Math.sqrt(l*l+u*u)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),l.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.button&&!this.isDown},rightButtonReleased:function(){return 2===this.button&&!this.isDown},middleButtonReleased:function(){return 1===this.button&&!this.isDown},backButtonReleased:function(){return 3===this.button&&!this.isDown},forwardButtonReleased:function(){return 4===this.button&&!this.isDown},getDistance:function(){return this.isDown?s(this.downX,this.downY,this.x,this.y):s(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var n=this.prevPosition.x,i=this.prevPosition.y,r=this.position.x,s=this.position.y,o=0;o<t;o++){var c=1/t*o;e[o]={x:a(c,n,r),y:a(c,i,s)}}return e},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=0===this.id},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});t.exports=u},72687:t=>{t.exports={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8}},14874:t=>{t.exports="boot"},54168:t=>{t.exports="destroy"},526:t=>{t.exports="dragend"},81623:t=>{t.exports="dragenter"},94472:t=>{t.exports="drag"},9304:t=>{t.exports="dragleave"},34265:t=>{t.exports="dragover"},50151:t=>{t.exports="dragstart"},98134:t=>{t.exports="drop"},56773:t=>{t.exports="gameobjectdown"},45824:t=>{t.exports="dragend"},39578:t=>{t.exports="dragenter"},72072:t=>{t.exports="drag"},82569:t=>{t.exports="dragleave"},70833:t=>{t.exports="dragover"},81442:t=>{t.exports="dragstart"},32936:t=>{t.exports="drop"},99658:t=>{t.exports="gameobjectmove"},60515:t=>{t.exports="gameobjectout"},55254:t=>{t.exports="gameobjectover"},34782:t=>{t.exports="pointerdown"},41769:t=>{t.exports="pointermove"},65588:t=>{t.exports="pointerout"},61640:t=>{t.exports="pointerover"},49342:t=>{t.exports="pointerup"},82662:t=>{t.exports="wheel"},13058:t=>{t.exports="gameobjectup"},52426:t=>{t.exports="gameobjectwheel"},78072:t=>{t.exports="gameout"},1545:t=>{t.exports="gameover"},67137:t=>{t.exports="boot"},27678:t=>{t.exports="process"},22257:t=>{t.exports="update"},90379:t=>{t.exports="pointerlockchange"},88909:t=>{t.exports="pointerdown"},36548:t=>{t.exports="pointerdownoutside"},18483:t=>{t.exports="pointermove"},22355:t=>{t.exports="pointerout"},7997:t=>{t.exports="pointerover"},66318:t=>{t.exports="pointerup"},94812:t=>{t.exports="pointerupoutside"},37310:t=>{t.exports="wheel"},24196:t=>{t.exports="preupdate"},27053:t=>{t.exports="shutdown"},29413:t=>{t.exports="start"},25165:t=>{t.exports="update"},33963:(t,e,n)=>{t.exports={BOOT:n(14874),DESTROY:n(54168),DRAG_END:n(526),DRAG_ENTER:n(81623),DRAG:n(94472),DRAG_LEAVE:n(9304),DRAG_OVER:n(34265),DRAG_START:n(50151),DROP:n(98134),GAME_OUT:n(78072),GAME_OVER:n(1545),GAMEOBJECT_DOWN:n(56773),GAMEOBJECT_DRAG_END:n(45824),GAMEOBJECT_DRAG_ENTER:n(39578),GAMEOBJECT_DRAG:n(72072),GAMEOBJECT_DRAG_LEAVE:n(82569),GAMEOBJECT_DRAG_OVER:n(70833),GAMEOBJECT_DRAG_START:n(81442),GAMEOBJECT_DROP:n(32936),GAMEOBJECT_MOVE:n(99658),GAMEOBJECT_OUT:n(60515),GAMEOBJECT_OVER:n(55254),GAMEOBJECT_POINTER_DOWN:n(34782),GAMEOBJECT_POINTER_MOVE:n(41769),GAMEOBJECT_POINTER_OUT:n(65588),GAMEOBJECT_POINTER_OVER:n(61640),GAMEOBJECT_POINTER_UP:n(49342),GAMEOBJECT_POINTER_WHEEL:n(82662),GAMEOBJECT_UP:n(13058),GAMEOBJECT_WHEEL:n(52426),MANAGER_BOOT:n(67137),MANAGER_PROCESS:n(27678),MANAGER_UPDATE:n(22257),POINTER_DOWN:n(88909),POINTER_DOWN_OUTSIDE:n(36548),POINTER_MOVE:n(18483),POINTER_OUT:n(22355),POINTER_OVER:n(7997),POINTER_UP:n(66318),POINTER_UP_OUTSIDE:n(94812),POINTER_WHEEL:n(37310),POINTERLOCK_CHANGE:n(90379),PRE_UPDATE:n(24196),SHUTDOWN:n(27053),START:n(29413),UPDATE:n(25165)}},70848:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});t.exports=i},21274:(t,e,n)=>{var i=n(56694),r=n(43200),s=new i({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var e=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(r.BUTTON_DOWN,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(r.BUTTON_UP,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});t.exports=s},75956:(t,e,n)=>{var i=n(70848),r=n(21274),s=n(56694),o=n(6659),a=n(93736),c=new s({Extends:o,initialize:function(t,e){o.call(this),this.manager=t,this.pad=e,this.id=e.id,this.index=e.index;for(var n=[],s=0;s<e.buttons.length;s++)n.push(new r(this,s));this.buttons=n;var c=[];for(s=0;s<e.axes.length;s++)c.push(new i(this,s));this.axes=c,this.vibration=e.vibrationActuator;var l={value:0,pressed:!1};this._LCLeft=n[14]?n[14]:l,this._LCRight=n[15]?n[15]:l,this._LCTop=n[12]?n[12]:l,this._LCBottom=n[13]?n[13]:l,this._RCLeft=n[2]?n[2]:l,this._RCRight=n[1]?n[1]:l,this._RCTop=n[3]?n[3]:l,this._RCBottom=n[0]?n[0]:l,this._FBLeftTop=n[4]?n[4]:l,this._FBLeftBottom=n[6]?n[6]:l,this._FBRightTop=n[5]?n[5]:l,this._FBRightBottom=n[7]?n[7]:l;var u={value:0};this._HAxisLeft=c[0]?c[0]:u,this._VAxisLeft=c[1]?c[1]:u,this._HAxisRight=c[2]?c[2]:u,this._VAxisRight=c[3]?c[3]:u,this.leftStick=new a,this.rightStick=new a,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){if(!(t.timestamp<this._created)){var e,n=this.buttons,i=t.buttons,r=n.length;for(e=0;e<r;e++)n[e].update(i[e].value);var s=this.axes,o=t.axes;for(r=s.length,e=0;e<r;e++)s[e].update(o[e]);r>=2&&(this.leftStick.set(s[0].getValue(),s[1].getValue()),r>=4&&this.rightStick.set(s[2].getValue(),s[3].getValue()))}},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});t.exports=c},1379:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(43200),o=n(75956),a=n(10850),c=n(63399),l=n(33963),u=new i({Extends:r,initialize:function(t){r.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,t.pluginEvents.once(l.BOOT,this.boot,this),t.pluginEvents.on(l.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,n=t.config;this.enabled=a(e,"gamepad",n.inputGamepad)&&t.device.input.gamepads,this.target=a(e,"gamepad.target",n.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(l.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(l.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,n=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=n,e.addEventListener("gamepadconnected",n,!1),e.addEventListener("gamepaddisconnected",n,!1),this.sceneInputPlugin.pluginEvents.on(l.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(l.UPDATE,this.update);for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].removeAllListeners()},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].pad.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,n=0;n<t.length;n++){var i=t[n];if(i){var r=i.id,s=i.index,a=e[s];if(a)a.id!==r?(a.destroy(),e[s]=new o(this,i)):a.update(i);else{var c=new o(this,i);e[s]=c,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=c):this._pad3=c:this._pad2=c:this._pad1=c}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},getPad:function(t){for(var e=this.gamepads,n=0;n<e.length;n++)if(e[n]&&e[n].index===t)return e[n]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var i=e[n],r=this.getPad(i.gamepad.index);"gamepadconnected"===i.type?this.emit(s.CONNECTED,r,i):"gamepaddisconnected"===i.type&&this.emit(s.DISCONNECTED,r,i)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});c.register("GamepadPlugin",u,"gamepad","gamepad","inputGamepad"),t.exports=u},33171:t=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}},74982:t=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},43247:t=>{t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},4898:(t,e,n)=>{t.exports={DUALSHOCK_4:n(74982),SNES_USB:n(33171),XBOX_360:n(43247)}},17344:t=>{t.exports="down"},36635:t=>{t.exports="up"},85724:t=>{t.exports="connected"},55832:t=>{t.exports="disconnected"},772:t=>{t.exports="down"},33608:t=>{t.exports="up"},43200:(t,e,n)=>{t.exports={BUTTON_DOWN:n(17344),BUTTON_UP:n(36635),CONNECTED:n(85724),DISCONNECTED:n(55832),GAMEPAD_BUTTON_DOWN:n(772),GAMEPAD_BUTTON_UP:n(33608)}},92636:(t,e,n)=>{t.exports={Axis:n(70848),Button:n(21274),Events:n(43200),Gamepad:n(75956),GamepadPlugin:n(1379),Configs:n(4898)}},20873:(t,e,n)=>{var i=n(72687),r=n(98611),s={CreatePixelPerfectHandler:n(18104),CreateInteractiveObject:n(27395),Events:n(33963),Gamepad:n(92636),InputManager:n(69898),InputPlugin:n(12499),InputPluginCache:n(63399),Keyboard:n(28388),Mouse:n(11343),Pointer:n(40398),Touch:n(77423)};s=r(!1,s,i),t.exports=s},71064:(t,e,n)=>{var i=n(66458),r=n(56694),s=n(97081),o=n(33963),a=n(11873),c=n(72283),l=new r({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=c,this.onKeyUp=c,t.events.once(o.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(s.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(o.MANAGER_PROCESS);var n=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!n&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}},this.onKeyUp=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(o.MANAGER_PROCESS);var n=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!n&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"===typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var i=t[n];"string"===typeof i&&(i=a[i.trim().toUpperCase()]),-1===e.indexOf(i)&&e.push(i)}this.preventDefault=e.length>0},removeCapture:function(t){"string"===typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var r=t[n];"string"===typeof r&&(r=a[r.toUpperCase()]),i(e,r)}this.preventDefault=e.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(s.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});t.exports=l},89666:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(94030),o=n(97081),a=n(10850),c=n(33963),l=n(63399),u=n(50165),h=n(11873),d=n(95625),p=n(48044),f=n(7599),m=n(84314),g=new i({Extends:r,initialize:function(t){r.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,t.pluginEvents.once(c.BOOT,this.boot,this),t.pluginEvents.on(c.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=a(t,"keyboard",!0);var e=a(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(c.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(c.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(c.SHUTDOWN,this.shutdown,this),this.game.events.on(o.BLUR,this.resetKeys,this),this.scene.sys.events.on(f.PAUSE,this.resetKeys,this),this.scene.sys.events.on(f.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.canInput()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:h.UP,down:h.DOWN,left:h.LEFT,right:h.RIGHT,space:h.SPACE,shift:h.SHIFT})},addKeys:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i={};if("string"===typeof t){t=t.split(",");for(var r=0;r<t.length;r++){var s=t[r].trim();s&&(i[s]=this.addKey(s,e,n))}}else for(var o in t)i[o]=this.addKey(t[o],e,n);return i},addKey:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i=this.keys;if(t instanceof u){var r=i.indexOf(t);return r>-1?i[r]=t:i[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(n),t}return"string"===typeof t&&(t=h[t.toUpperCase()]),i[t]||(i[t]=new u(this,t),e&&this.addCapture(t),i[t].setEmitOnRepeat(n)),i[t]},removeKey:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i,r=this.keys;if(t instanceof u){var s=r.indexOf(t);s>-1&&(i=this.keys[s],this.keys[s]=void 0)}else"string"===typeof t&&(t=h[t.toUpperCase()]);return r[t]&&(i=r[t],r[t]=void 0),i&&(i.plugin=null,n&&this.removeCapture(i.keyCode),e&&i.destroy()),this},removeAllKeys:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.keys,i=0;i<n.length;i++){var r=n[i];r&&(n[i]=void 0,e&&this.removeCapture(r.keyCode),t&&r.destroy())}return this},createCombo:function(t,e){return new d(this,t,e)},checkDown:function(t,e){if(void 0===e&&(e=0),this.enabled&&t.isDown){var n=m(this.time-t.timeDown,e);if(n>t._tick)return t._tick=n,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,i=0;i<e;i++){var r=t[i],o=r.keyCode,a=n[o],c=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&(o===this.prevCode&&r.timeStamp===this.prevTime&&r.type===this.prevType||(this.prevCode=o,this.prevTime=r.timeStamp,this.prevType=r.type,"keydown"===r.type?(a&&(c=a.isDown,a.onDown(r)),r.cancelled||a&&c||(p[o]&&this.emit(s.KEY_DOWN+p[o],r),r.cancelled||this.emit(s.ANY_KEY_DOWN,r))):(a&&a.onUp(r),r.cancelled||(p[o]&&this.emit(s.KEY_UP+p[o],r),r.cancelled||this.emit(s.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0)))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(c.MANAGER_PROCESS,this.update,this),this.game.events.off(o.BLUR,this.resetKeys),this.scene.sys.events.off(f.PAUSE,this.resetKeys,this),this.scene.sys.events.off(f.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});l.register("KeyboardPlugin",g,"keyboard","keyboard","inputKeyboard"),t.exports=g},60258:t=>{t.exports=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)}},95625:(t,e,n)=>{var i=n(56694),r=n(94030),s=n(72632),o=n(2544),a=n(88754),c=new i({initialize:function(t,e,n){if(void 0===n&&(n={}),e.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var i=0;i<e.length;i++){var c=e[i];"string"===typeof c?this.keyCodes.push(c.toUpperCase().charCodeAt(0)):"number"===typeof c?this.keyCodes.push(c):c.hasOwnProperty("keyCode")&&this.keyCodes.push(c.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=s(n,"resetOnWrongKey",!0),this.maxKeyDelay=s(n,"maxKeyDelay",0),this.resetOnMatch=s(n,"resetOnMatch",!1),this.deleteOnMatch=s(n,"deleteOnMatch",!1);var l=this;this.onKeyDown=function(t){!l.matched&&l.enabled&&o(t,l)&&(l.manager.emit(r.COMBO_MATCH,l,t),l.resetOnMatch?a(l):l.deleteOnMatch&&l.destroy())},this.manager.on(r.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(r.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});t.exports=c},2544:(t,e,n)=>{var i=n(60258);t.exports=function(t,e){if(e.matched)return!0;var n=!1,r=!1;if(t.keyCode===e.current)if(e.index>0&&e.maxKeyDelay>0){var s=e.timeLastMatched+e.maxKeyDelay;t.timeStamp<=s&&(r=!0,n=i(t,e))}else r=!0,n=i(t,e);return!r&&e.resetOnWrongKey&&(e.index=0,e.current=e.keyCodes[0]),n&&(e.timeLastMatched=t.timeStamp,e.matched=!0,e.timeMatched=t.timeStamp),n}},88754:t=>{t.exports=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t}},5044:t=>{t.exports="keydown"},40813:t=>{t.exports="keyup"},89319:t=>{t.exports="keycombomatch"},43267:t=>{t.exports="down"},78595:t=>{t.exports="keydown-"},30056:t=>{t.exports="keyup-"},81939:t=>{t.exports="up"},94030:(t,e,n)=>{t.exports={ANY_KEY_DOWN:n(5044),ANY_KEY_UP:n(40813),COMBO_MATCH:n(89319),DOWN:n(43267),KEY_DOWN:n(78595),KEY_UP:n(30056),UP:n(81939)}},28388:(t,e,n)=>{t.exports={Events:n(94030),KeyboardManager:n(71064),KeyboardPlugin:n(89666),Key:n(50165),KeyCodes:n(11873),KeyCombo:n(95625),AdvanceKeyCombo:n(60258),ProcessKeyCombo:n(2544),ResetKeyCombo:n(88754),JustDown:n(42460),JustUp:n(53162),DownDuration:n(64964),UpDuration:n(70331)}},64964:t=>{t.exports=function(t,e){void 0===e&&(e=50);var n=t.plugin.game.loop.time-t.timeDown;return t.isDown&&n<e}},42460:t=>{t.exports=function(t){return!!t._justDown&&(t._justDown=!1,!0)}},53162:t=>{t.exports=function(t){return!!t._justUp&&(t._justUp=!1,!0)}},50165:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(94030),o=new i({Extends:r,initialize:function(t,e){r.call(this),this.plugin=t,this.keyCode=e,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(s.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(s.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(s.UP,this,t))},reset:function(){return this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});t.exports=o},11873:t=>{t.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175}},48044:(t,e,n)=>{var i=n(11873),r={};for(var s in i)r[i[s]]=s;t.exports=r},70331:t=>{t.exports=function(t,e){void 0===e&&(e=50);var n=t.plugin.game.loop.time-t.timeUp;return t.isUp&&n<e}},7905:(t,e,n)=>{var i=n(56694),r=n(90185),s=n(33963),o=n(72283),a=new i({initialize:function(t){this.manager=t,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=o,this.onMouseDown=o,this.onMouseUp=o,this.onMouseDownWindow=o,this.onMouseUpWindow=o,this.onMouseOver=o,this.onMouseOut=o,this.onMouseWheel=o,this.pointerLockChange=o,this.isTop=!0,t.events.once(s.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?"string"===typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1})),this},requestPointerLock:function(){if(r.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){r.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var e=this,n=this.manager,i=n.canvas,s=window&&window.focus&&n.game.config.autoFocus;this.onMouseMove=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseMove(t),e.preventDefaultMove&&t.preventDefault())},this.onMouseDown=function(t){s&&window.focus(),!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseDown(t),e.preventDefaultDown&&t.target===i&&t.preventDefault())},this.onMouseDownWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onMouseDown(t)},this.onMouseUp=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onMouseUp(t),e.preventDefaultUp&&t.target===i&&t.preventDefault())},this.onMouseUpWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onMouseUp(t)},this.onMouseOver=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.setCanvasOver(t)},this.onMouseOut=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.setCanvasOut(t)},this.onMouseWheel=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.onMouseWheel(t),e.preventDefaultWheel&&t.target===i&&t.preventDefault()};var o={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,o),t.addEventListener("mouseout",this.onMouseOut,o),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,o),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,o),window.top.addEventListener("mouseup",this.onMouseUpWindow,o)}catch(a){window.addEventListener("mousedown",this.onMouseDownWindow,o),window.addEventListener("mouseup",this.onMouseUpWindow,o),this.isTop=!1}r.pointerLock&&(this.pointerLockChange=function(t){var i=e.target;e.locked=document.pointerLockElement===i||document.mozPointerLockElement===i||document.webkitPointerLockElement===i,n.onPointerLockChange(t)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&((t=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),r.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=a},11343:(t,e,n)=>{t.exports={MouseManager:n(7905)}},37579:(t,e,n)=>{var i=n(56694),r=n(33963),s=n(72283),o=new i({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=s,this.onTouchStartWindow=s,this.onTouchMove=s,this.onTouchEnd=s,this.onTouchEndWindow=s,this.onTouchCancel=s,this.onTouchCancelWindow=s,this.isTop=!0,t.events.once(r.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target?"string"===typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1})),this},startListeners:function(){var t=this.target;if(t){var e=this,n=this.manager,i=n.canvas,r=window&&window.focus&&n.game.config.autoFocus;this.onTouchMove=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onTouchMove(t),e.capture&&t.cancelable&&t.preventDefault())},this.onTouchStart=function(t){r&&window.focus(),!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onTouchStart(t),e.capture&&t.cancelable&&t.target===i&&t.preventDefault())},this.onTouchStartWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onTouchStart(t)},this.onTouchEnd=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onTouchEnd(t),e.capture&&t.cancelable&&t.target===i&&t.preventDefault())},this.onTouchEndWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&t.target!==i&&n.onTouchEnd(t)},this.onTouchCancel=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&(n.onTouchCancel(t),e.capture&&t.preventDefault())},this.onTouchCancelWindow=function(t){!t.defaultPrevented&&e.enabled&&n&&n.enabled&&n.onTouchCancel(t)};var s=this.capture,o={passive:!0},a={passive:!1};if(t.addEventListener("touchstart",this.onTouchStart,s?a:o),t.addEventListener("touchmove",this.onTouchMove,s?a:o),t.addEventListener("touchend",this.onTouchEnd,s?a:o),t.addEventListener("touchcancel",this.onTouchCancel,s?a:o),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,a),window.top.addEventListener("touchend",this.onTouchEndWindow,a),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,a)}catch(c){window.addEventListener("touchstart",this.onTouchStartWindow,a),window.addEventListener("touchend",this.onTouchEndWindow,a),window.addEventListener("touchcancel",this.onTouchCancelWindow,a),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),window&&((t=this.isTop?window.top:window).removeEventListener("touchstart",this.onTouchStartWindow),t.removeEventListener("touchend",this.onTouchEndWindow),t.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=o},77423:(t,e,n)=>{t.exports={TouchManager:n(37579)}},98035:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(683),o=n(72632),a=n(30750),c=n(43531),l=n(88490),u=n(33868),h=new i({initialize:function(t,e){if(this.loader=t,this.cache=o(e,"cache",!1),this.type=o(e,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=o(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.key)throw new Error("Invalid File key: "+this.key);var i=o(e,"url");void 0===i?i=t.path+n+"."+o(e,"extension",""):"string"!==typeof i||i.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)||(i=t.path+i),this.url=i,this.src="",this.xhrSettings=u(o(e,"responseType",void 0)),o(e,"xhrSettings",!1)&&(this.xhrSettings=c(this.xhrSettings,o(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"===typeof this.url?r.FILE_POPULATED:r.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=o(e,"config",{}),this.multiFile,this.linkFile},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){this.state===r.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=r.FILE_LOADING,this.src=a(this,this.loader.baseURL),0===this.src.indexOf("data:")?console.warn("Local data URIs are not supported: "+this.key):this.xhrLoader=l(this,this.loader.xhr))},onLoad:function(t,e){var n=t.responseURL&&this.loader.localSchemes.some((function(e){return 0===t.responseURL.indexOf(e)}))&&0===e.target.status,i=!(e.target&&200!==e.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(i=!1),this.state=r.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,i)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=r.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=r.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){console.error('Failed to process file: %s "%s"',this.type,this.key),this.state=r.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(t){if(this.state!==r.FILE_PENDING_DESTROY){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(s.FILE_COMPLETE,e,n,t),this.loader.emit(s.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this),this.state=r.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});h.createObjectURL=function(t,e,n){if("function"===typeof URL)t.src=URL.createObjectURL(e);else{var i=new FileReader;i.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e)}},h.revokeObjectURL=function(t){"function"===typeof URL&&URL.revokeObjectURL(t.src)},t.exports=h},76846:t=>{var e={},n={install:function(t){for(var n in e)t[n]=e[n]},register:function(t,n){e[t]=n},destroy:function(){e={}}};t.exports=n},30750:t=>{t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},67285:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(58403),o=n(6659),a=n(683),c=n(76846),l=n(72632),u=n(10850),h=n(91963),d=n(7599),p=n(33868),f=new i({Extends:o,initialize:function(t){o.call(this);var e=t.sys.game.config,n=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,c.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(l(n,"baseURL",e.loaderBaseURL)),this.setPath(l(n,"path",e.loaderPath)),this.setPrefix(l(n,"prefix",e.loaderPrefix)),this.maxParallelDownloads=l(n,"maxParallelDownloads",e.loaderMaxParallelDownloads),this.xhr=p(l(n,"responseType",e.loaderResponseType),l(n,"async",e.loaderAsync),l(n,"user",e.loaderUser),l(n,"password",e.loaderPassword),l(n,"timeout",e.loaderTimeout),l(n,"withCredentials",e.loaderWithCredentials)),this.crossOrigin=l(n,"crossOrigin",e.loaderCrossOrigin),this.imageLoadType=l(n,"imageLoadType",e.loaderImageLoadType),this.localSchemes=l(n,"localScheme",e.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new s,this.inflight=new s,this.queue=new s,this._deleteQueue=new s,this.totalFailed=0,this.totalComplete=0,this.state=r.LOADER_IDLE,this.multiKeyIndex=0,t.sys.events.once(d.BOOT,this.boot,this),t.sys.events.on(d.START,this.pluginStart,this)},boot:function(){this.systems.events.once(d.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(d.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];this.keyExists(n)||(this.list.set(n),this.emit(a.ADD,n.key,n.type,this,n),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1})),!e&&this.isLoading()&&(this.inflight.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1})),this.queue.iterate((function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1}))),e},addPack:function(t,e){if("string"===typeof e){var n=u(t,e);n&&(t={packKey:n})}var i=0,r=this.baseURL,s=this.path,o=this.prefix;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var c=t[a],h=l(c,"baseURL",r),d=l(c,"path",s),p=l(c,"prefix",o),f=l(c,"files",null),m=l(c,"defaultType","void");if(Array.isArray(f)){this.setBaseURL(h),this.setPath(d),this.setPrefix(p);for(var g=0;g<f.length;g++){var v=f[g],y=v.hasOwnProperty("type")?v.type:m;this[y]&&(this[y](v),i++)}}}return this.setBaseURL(r),this.setPath(s),this.setPrefix(o),i>0},isLoading:function(){return this.state===r.LOADER_LOADING||this.state===r.LOADER_PROCESSING},isReady:function(){return this.state===r.LOADER_IDLE||this.state===r.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(a.START,this),0===this.list.size?this.loadComplete():(this.state=r.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(d.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(a.PROGRESS,this.progress)},update:function(){this.state===r.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each((function(t){if((t.state===r.FILE_POPULATED||t.state===r.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1}),this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(a.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(a.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===r.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===r.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&(t.multiFile.addToCache(),t.multiFile.pendingDestroy()):(t.addToCache(),t.pendingDestroy())),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(a.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=r.LOADER_COMPLETE,this.systems.events.off(d.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(a.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,n){void 0===e&&(e="file.json"),void 0===n&&(n="application/json");var i=new Blob([t],{type:n}),r=URL.createObjectURL(i),s=document.createElement("a");return s.download=e,s.textContent="Download "+e,s.href=r,s.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,e=this.systems.settings.loader;this.setBaseURL(l(e,"baseURL",t.loaderBaseURL)),this.setPath(l(e,"path",t.loaderPath)),this.setPrefix(l(e,"prefix",t.loaderPrefix)),this.state=r.LOADER_IDLE},shutdown:function(){this.reset(),this.state=r.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(d.UPDATE,this.update,this),this.systems.events.off(d.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=r.LOADER_DESTROYED,this.systems.events.off(d.UPDATE,this.update,this),this.systems.events.off(d.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});h.register("Loader",f,"load"),t.exports=f},43531:(t,e,n)=>{var i=n(98611),r=n(33868);t.exports=function(t,e){var n=void 0===t?r():i({},t);if(e)for(var s in e)void 0!==e[s]&&(n[s]=e[s]);return n}},45176:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(683),o=new i({initialize:function(t,e,n,i){var s=[];i.forEach((function(t){t&&s.push(t)})),this.loader=t,this.type=e,this.key=n;var o=this.key;t.prefix&&""!==t.prefix&&(this.key=t.prefix+o),this.multiKeyIndex=t.multiKeyIndex++,this.files=s,this.state=r.FILE_PENDING,this.complete=!1,this.pending=s.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var a=0;a<s.length;a++)s[a].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&(this.failed++,console.error('File failed: %s "%s" (via %s "%s")',this.type,this.key,t.type,t.key))},pendingDestroy:function(){if(this.state!==r.FILE_PENDING_DESTROY){var t=this.key,e=this.type;this.loader.emit(s.FILE_COMPLETE,t,e),this.loader.emit(s.FILE_KEY_COMPLETE+e+"-"+t,t,e),this.loader.flagForRemoval(this);for(var n=0;n<this.files.length;n++)this.files[n].pendingDestroy();this.state=r.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});t.exports=o},88490:(t,e,n)=>{var i=n(43531);t.exports=function(t,e){var n=i(e,t.xhrSettings),r=new XMLHttpRequest;if(r.open("GET",t.src,n.async,n.user,n.password),r.responseType=t.xhrSettings.responseType,r.timeout=n.timeout,n.headers)for(var s in n.headers)r.setRequestHeader(s,n.headers[s]);return n.header&&n.headerValue&&r.setRequestHeader(n.header,n.headerValue),n.requestedWith&&r.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&r.overrideMimeType(n.overrideMimeType),n.withCredentials&&(r.withCredentials=!0),r.onload=t.onLoad.bind(t,r),r.onerror=t.onError.bind(t,r),r.onprogress=t.onProgress.bind(t),r.send(),r}},33868:t=>{t.exports=function(t,e,n,i,r,s){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===r&&(r=0),void 0===s&&(s=!1),{responseType:t,async:e,user:n,password:i,timeout:r,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:s}}},12117:t=>{t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20}},7398:t=>{t.exports="addfile"},52187:t=>{t.exports="complete"},36627:t=>{t.exports="filecomplete"},81925:t=>{t.exports="filecomplete-"},29774:t=>{t.exports="loaderror"},20943:t=>{t.exports="load"},74693:t=>{t.exports="fileprogress"},71176:t=>{t.exports="postprocess"},88984:t=>{t.exports="progress"},72753:t=>{t.exports="start"},683:(t,e,n)=>{t.exports={ADD:n(7398),COMPLETE:n(52187),FILE_COMPLETE:n(36627),FILE_KEY_COMPLETE:n(81925),FILE_LOAD_ERROR:n(29774),FILE_LOAD:n(20943),FILE_PROGRESS:n(74693),POST_PROCESS:n(71176),PROGRESS:n(88984),START:n(72753)}},46468:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(70806),o=n(683),a=new i({Extends:s,initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.type="animationJSON"},onProcess:function(){this.loader.once(o.POST_PROCESS,this.onLoadComplete,this),s.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});r.register("animation",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this})),t.exports=a},31648:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(70806),l=n(45176),u=new i({Extends:l,initialize:function(t,e,n,i,r,u){var h,d;if(a(e)){var p=e;e=s(p,"key"),h=new o(t,{key:e,url:s(p,"textureURL"),extension:s(p,"textureExtension","png"),normalMap:s(p,"normalMap"),xhrSettings:s(p,"textureXhrSettings")}),d=new c(t,{key:e,url:s(p,"atlasURL"),extension:s(p,"atlasExtension","json"),xhrSettings:s(p,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new c(t,e,i,u);h.linkFile?l.call(this,t,"atlasjson",e,[h,d,h.linkFile]):l.call(this,t,"atlasjson",e,[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,n),e.addToCache(),this.complete=!0}}});r.register("aseprite",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new u(this,t[o]),this.addFile(s.files);else s=new u(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=u},73152:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(70806),l=n(45176),u=new i({Extends:l,initialize:function(t,e,n,i,r,u){var h,d;if(a(e)){var p=e;e=s(p,"key"),h=new o(t,{key:e,url:s(p,"textureURL"),extension:s(p,"textureExtension","png"),normalMap:s(p,"normalMap"),xhrSettings:s(p,"textureXhrSettings")}),d=new c(t,{key:e,url:s(p,"atlasURL"),extension:s(p,"atlasExtension","json"),xhrSettings:s(p,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new c(t,e,i,u);h.linkFile?l.call(this,t,"atlasjson",e,[h,d,h.linkFile]):l.call(this,t,"atlasjson",e,[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,n),this.complete=!0}}});r.register("atlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new u(this,t[o]),this.addFile(s.files);else s=new u(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=u},24616:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(45176),l=n(15297),u=new i({Extends:c,initialize:function(t,e,n,i,r,u){var h,d;if(a(e)){var p=e;e=s(p,"key"),h=new o(t,{key:e,url:s(p,"textureURL"),extension:s(p,"textureExtension","png"),normalMap:s(p,"normalMap"),xhrSettings:s(p,"textureXhrSettings")}),d=new l(t,{key:e,url:s(p,"atlasURL"),extension:s(p,"atlasExtension","xml"),xhrSettings:s(p,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new l(t,e,i,u);h.linkFile?c.call(this,t,"atlasxml",e,[h,d,h.linkFile]):c.call(this,t,"atlasxml",e,[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,n),this.complete=!0}}});r.register("atlasXML",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new u(this,t[o]),this.addFile(s.files);else s=new u(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=u},67448:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(30929),l=n(42911),u=new i({Extends:s,initialize:function(t,e,n,i,r){if(l(e)){var o=e;e=a(o,"key"),i=a(o,"xhrSettings"),r=a(o,"context",r)}var c={type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:i,config:{context:r}};s.call(this,t,c)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,(function(e){t.data=e,t.onProcessComplete()}),(function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()})),this.config.context=null}});u.create=function(t,e,n,i,r){var s=t.systems.game,o=s.config.audio,h=s.device.audio;l(e)&&(n=a(e,"url",[]),i=a(e,"config",{}));var d=u.getAudioURL(s,n);return d?h.webAudio&&!o.disableWebAudio?new u(t,e,d,r,s.sound.context):new c(t,e,d,i):(console.warn('No audio URLs for "%s" matched this device',e),null)},u.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=a(e[n],"url",e[n]);if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return{url:i,type:""};var r=i.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=a(e[n],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:i,type:r}}return null},o.register("audio",(function(t,e,n,i){var r,s=this.systems.game,o=s.config.audio,a=s.device.audio;if(o.noAudio||!a.webAudio&&!a.audioData)return this;if(Array.isArray(t))for(var c=0;c<t.length;c++)(r=u.create(this,t[c]))&&this.addFile(r);else(r=u.create(this,t,e,n,i))&&this.addFile(r);return this})),t.exports=u},66109:(t,e,n)=>{var i=n(67448),r=n(56694),s=n(76846),o=n(72632),a=n(42911),c=n(70806),l=n(45176),u=new r({Extends:l,initialize:function(t,e,n,r,s,u,h){if(a(e)){var d=e;e=o(d,"key"),n=o(d,"jsonURL"),r=o(d,"audioURL"),s=o(d,"audioConfig"),u=o(d,"audioXhrSettings"),h=o(d,"jsonXhrSettings")}var p;if(r){var f=i.create(t,e,r,s,u);f&&(p=new c(t,e,n,h),l.call(this,t,"audiosprite",e,[f,p]),this.config.resourceLoad=!1)}else p=new c(t,e,n,h),l.call(this,t,"audiosprite",e,[p]),this.config.resourceLoad=!0,this.config.audioConfig=s,this.config.audioXhrSettings=u},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,this.config.resourceLoad&&"json"===t.type&&t.data.hasOwnProperty("resources"))){var e=t.data.resources,n=o(this.config,"audioConfig"),r=o(this.config,"audioXhrSettings"),s=i.create(this.loader,t.key,e,n,r);s&&(this.addToMultiFile(s),this.loader.addFile(s))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.complete=!0}}});s.register("audioSprite",(function(t,e,n,i,r,s){var o,a=this.systems.game,c=a.config.audio,l=a.device.audio;if(c&&c.noAudio||!l.webAudio&&!l.audioData)return this;if(Array.isArray(t))for(var h=0;h<t.length;h++)(o=new u(this,t[h])).files&&this.addFile(o.files);else(o=new u(this,t,e,n,i,r,s)).files&&this.addFile(o.files);return this}))},40612:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,r){var o="bin";if(c(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"xhrSettings"),o=a(l,"extension",o),r=a(l,"dataType",r)}var u={type:"binary",cache:t.cacheManager.binary,extension:o,responseType:"arraybuffer",key:e,url:n,xhrSettings:i,config:{dataType:r}};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});o.register("binary",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new l(this,t[r]));else this.addFile(new l(this,t,e,i,n));return this})),t.exports=l},54565:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(45176),l=n(31476),u=n(15297),h=new i({Extends:c,initialize:function(t,e,n,i,r,l){var h,d;if(a(e)){var p=e;e=s(p,"key"),h=new o(t,{key:e,url:s(p,"textureURL"),extension:s(p,"textureExtension","png"),normalMap:s(p,"normalMap"),xhrSettings:s(p,"textureXhrSettings")}),d=new u(t,{key:e,url:s(p,"fontDataURL"),extension:s(p,"fontDataExtension","xml"),xhrSettings:s(p,"fontDataXhrSettings")})}else h=new o(t,e,n,r),d=new u(t,e,i,l);h.linkFile?c.call(this,t,"bitmapfont",e,[h,d,h.linkFile]):c.call(this,t,"bitmapfont",e,[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache();var n=t.cache.get(t.key),i=l(e.data,t.cache.getFrame(t.key),0,0,n);this.loader.cacheManager.bitmapFont.add(t.key,{data:i,texture:t.key,frame:null}),this.complete=!0}}});r.register("bitmapFont",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new h(this,t[o]),this.addFile(s.files);else s=new h(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=h},99898:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i){var r="css";if(c(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var l={type:"script",cache:!1,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("css",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this})),t.exports=l},47375:(t,e,n)=>{var i=n(73152),r=n(40612),s=n(56694),o=n(76846),a=n(72632),c=n(42927),l=n(42911),u=n(70806),h=n(67409),d=n(30657),p=n(80802),f=n(45176),m=n(24904),g=new s({Extends:f,initialize:function(t,e,n,i){if(n.multiAtlasURL){var s=new u(t,{key:e,url:n.multiAtlasURL,xhrSettings:i,config:n});f.call(this,t,"texture",e,[s])}else{var o=n.textureURL.substr(n.textureURL.length-3);n.type||(n.type="ktx"===o.toLowerCase()?"KTX":"PVR");var a=new r(t,{key:e,url:n.textureURL,extension:o,xhrSettings:i,config:n});if(n.atlasURL){var c=new u(t,{key:e,url:n.atlasURL,xhrSettings:i,config:n});f.call(this,t,"texture",e,[a,c])}else f.call(this,t,"texture",e,[a])}this.config=n},onFileComplete:function(t){if(-1!==this.files.indexOf(t)){if(this.pending--,!this.config.multiAtlasURL)return;if("json"===t.type&&t.data.hasOwnProperty("textures")){var e=t.data.textures,n=this.config,i=this.loader,s=i.baseURL,o=i.path,c=i.prefix,l=a(n,"multiBaseURL",this.baseURL),u=a(n,"multiPath",this.path),h=a(n,"prefix",this.prefix),d=a(n,"textureXhrSettings");l&&i.setBaseURL(l),u&&i.setPath(u),h&&i.setPrefix(h);for(var p=0;p<e.length;p++){var f=e[p].image,m="CMA"+this.multiKeyIndex+"_"+f,g=new r(i,m,f,d);if(this.addToMultiFile(g),i.addFile(g),e[p].normalMap){var v=new r(i,m,e[p].normalMap,d);v.type="normalMap",g.setLink(v),this.addToMultiFile(v),i.addFile(v)}}i.setBaseURL(s),i.setPath(o),i.setPrefix(c)}}},addToCache:function(){if(this.isReadyToProcess()){var t=this.config;if(t.multiAtlasURL)this.addMultiToCache();else{var e,n=this.loader.systems.renderer,i=this.loader.textureManager,r=this.files[0],s=this.files[1];if("PVR"===t.type?e=m(r.data):"KTX"===t.type&&(e=h(r.data)),e&&n.supportsCompressedTexture(t.format,e.internalFormat)){e.format=n.getCompressedTextureName(t.format,e.internalFormat);var o=s&&s.data?s.data:null;i.addCompressedTexture(r.key,e,o)}}this.complete=!0}},addMultiToCache:function(){for(var t,e=this.config,n=this.files[0],i=[],r=[],s=[],o=this.loader.systems.renderer,a=this.loader.textureManager,c=1;c<this.files.length;c++){var l=this.files[c];if("normalMap"!==l.type)for(var u=l.key.indexOf("_"),d=l.key.substr(u+1),p=l.data,f=0;f<n.data.textures.length;f++){var g=n.data.textures[f];if(g.image===d){"PVR"===e.type?t=m(p):"KTX"===e.type&&(t=h(p)),t&&o.supportsCompressedTexture(e.format,t.internalFormat)&&(t.format=o.getCompressedTextureName(e.format,t.internalFormat),r.push(t),i.push(g),l.linkFile&&s.push(l.linkFile.data));break}}}0===s.length&&(s=void 0),a.addAtlasJSONArray(this.key,r,i,s),this.complete=!0}});o.register("texture",(function(t,e,n){var r=this.systems.renderer,s=function(t,e,n,s){var o={format:null,type:null,textureURL:void 0,atlasURL:void 0,multiAtlasURL:void 0,multiPath:void 0,multiBaseURL:void 0};if(l(e)){var u=e;e=a(u,"key"),n=a(u,"url"),s=a(u,"xhrSettings")}var h=!1;for(var f in n)if(r.supportsCompressedTexture(f)){var m=n[f];"string"===typeof m?o.textureURL=m:o=d(m,o),o.format=f.toUpperCase(),h=!0;break}if(h)if("IMG"===o.format){var v;v=o.multiAtlasURL?new p(t,e,o.multiAtlasURL,o.multiPath,o.multiBaseURL,s).files:o.atlasURL?new i(t,e,o.textureURL,o.atlasURL,s).files:new c(t,e,o.textureURL,s),t.addFile(v)}else{var y=new g(t,e,o,s);t.addFile(y.files)}else console.warn("No supported compressed texture format or IMG fallback",e)};if(Array.isArray(t))for(var o=0;o<t.length;o++)s(this,t[o]);else s(this,t,e,n);return this})),t.exports=g},46568:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=n(31053),u=new i({Extends:s,initialize:function(t,e,n,i,r){var o="glsl";if(c(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"shaderType","fragment"),r=a(l,"xhrSettings"),o=a(l,"extension",o)}else void 0===i&&(i="fragment");var u={type:"glsl",cache:t.cacheManager.shader,extension:o,responseType:"text",key:e,url:n,config:{shaderType:i},xhrSettings:r};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var n=this.getShaderName(e.header),i=this.getShaderType(e.header),r=this.getShaderUniforms(e.header),s=e.shader;if(this.cache.has(n)){var o=this.cache.get(n);"fragment"===i?o.fragmentSrc=s:o.vertexSrc=s,o.uniforms||(o.uniforms=r)}else"fragment"===i?this.cache.add(n,new l(n,s,"",r)):this.cache.add(n,new l(n,"",s,r));e=this.extractBlock(t,e.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new l(this.key,this.data)):this.cache.add(this.key,new l(this.key,"",this.data))},getShaderName:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("name:"===n.substring(0,5))return n.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("type:"===n.substring(0,5))return n.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},n=0;n<t.length;n++){var i=t[n].trim();if("uniform."===i.substring(0,8)){var r=i.indexOf(":");if(r){var s=i.substring(8,r);try{e[s]=JSON.parse(i.substring(r+1))}catch(o){console.warn("Invalid uniform JSON: "+s)}}}}return e},extractBlock:function(t,e){for(var n=-1,i=-1,r=-1,s=!1,o=!1,a=[],c=[],l=e;l<t.length;l++){var u=t[l].trim();if("---"===u)if(-1===n)n=l,s=!0;else{if(!s){o=!1;break}i=l,s=!1,o=!0}else s?a.push(u):o&&(c.push(u),r=l)}return s||-1===i?null:{header:a,shader:c.join("\n"),offset:r}}});o.register("glsl",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new u(this,t[r]));else this.addFile(new u(this,t,e,n,i));return this})),t.exports=u},30929:(t,e,n)=>{var i=n(56694),r=n(683),s=n(98035),o=n(72632),a=n(30750),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i){if(c(e)){var r=e;e=o(r,"key"),i=o(r,"config",i)}var a={type:"audio",cache:t.cacheManager.audio,extension:n.type,key:e,url:n.url,config:i};s.call(this,t,a),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var e=t.target;e.oncanplaythrough=null,e.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(r.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var n=new Audio;n.dataset||(n.dataset={}),n.dataset.name=this.key+("0"+e).slice(-2),n.dataset.used="false",this.locked?n.dataset.locked="true":(n.dataset.locked="false",n.preload="auto",n.oncanplaythrough=this.onProgress.bind(this),n.onerror=this.onError.bind(this)),this.data.push(n)}for(e=0;e<this.data.length;e++)(n=this.data[e]).src=a(this,this.loader.baseURL),this.locked||n.load();this.locked&&setTimeout(this.onLoad.bind(this))}});t.exports=l},77459:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i){var r="html";if(c(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var l={type:"text",cache:t.cacheManager.html,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("html",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this})),t.exports=l},9755:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,r,o){void 0===i&&(i=512),void 0===r&&(r=512);var l="html";if(c(e)){var u=e;e=a(u,"key"),n=a(u,"url"),o=a(u,"xhrSettings"),l=a(u,"extension",l),i=a(u,"width",i),r=a(u,"height",r)}var h={type:"html",cache:t.textureManager,extension:l,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:i,height:r}};s.call(this,t,h)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.width,e=this.config.height,n=[];n.push('<svg width="'+t+'px" height="'+e+'px" viewBox="0 0 '+t+" "+e+'" xmlns="http://www.w3.org/2000/svg">'),n.push('<foreignObject width="100%" height="100%">'),n.push('<body xmlns="http://www.w3.org/1999/xhtml">'),n.push(this.xhrLoader.responseText),n.push("</body>"),n.push("</foreignObject>"),n.push("</svg>");var i=[n.join("\n")],o=this;try{var a=new window.Blob(i,{type:"image/svg+xml;charset=utf-8"})}catch(c){return o.state=r.FILE_ERRORED,void o.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){s.revokeObjectURL(o.data),o.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(o.data),o.onProcessError()},s.createObjectURL(this.data,a,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});o.register("htmlTexture",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this})),t.exports=l},42927:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=n(30750),u=new i({Extends:s,initialize:function t(e,n,i,r,o){var l,u="png";if(c(n)){var h=n;n=a(h,"key"),i=a(h,"url"),l=a(h,"normalMap"),r=a(h,"xhrSettings"),u=a(h,"extension",u),o=a(h,"frameConfig")}Array.isArray(i)&&(l=i[1],i=i[0]);var d={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:i,xhrSettings:r,config:o};if(s.call(this,e,d),l){var p=new t(e,this.key,l,r,o);p.type="normalMap",this.setLink(p),e.addFile(p)}this.useImageElementLoad="HTMLImageElement"===e.imageLoadType,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){s.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(t.data),t.onProcessError()},s.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var t=this.state;this.state=r.FILE_PROCESSING,t===r.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){if(this.state=r.FILE_LOADING,this.src=l(this,this.loader.baseURL),0===this.src.indexOf("data:"))console.warn("Local data URIs are not supported: "+this.key);else{this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){t.state=r.FILE_LOADED,t.loader.nextFile(t,!0)},this.data.onerror=function(){t.loader.nextFile(t,!1)},this.data.src=this.src}},addToCache:function(){var t=this.linkFile;t?t.state>=r.FILE_COMPLETE&&("spritesheet"===t.type?t.addToCache():"normalMap"===this.type?this.cache.addImage(this.key,t.data,this.data):this.cache.addImage(this.key,this.data,t.data)):this.cache.addImage(this.key,this.data)}});o.register("image",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},70806:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(10850),l=n(42911),u=new i({Extends:s,initialize:function(t,e,n,i,o){var u="json";if(l(e)){var h=e;e=a(h,"key"),n=a(h,"url"),i=a(h,"xhrSettings"),u=a(h,"extension",u),o=a(h,"dataKey",o)}var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:e,url:n,xhrSettings:i,config:o};s.call(this,t,d),l(n)&&(this.data=o?c(n,o):n,this.state=r.FILE_POPULATED)},onProcess:function(){if(this.state!==r.FILE_POPULATED){this.state=r.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(n){throw this.onProcessError(),n}var e=this.config;this.data="string"===typeof e?c(t,e,t):t}this.onProcessComplete()}});o.register("json",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new u(this,t[r]));else this.addFile(new u(this,t,e,i,n));return this})),t.exports=u},80802:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(70806),l=n(45176),u=new i({Extends:l,initialize:function(t,e,n,i,r,o,u){if(a(e)){var h=e;e=s(h,"key"),n=s(h,"url",!1)?s(h,"url"):s(h,"atlasURL"),o=s(h,"xhrSettings"),i=s(h,"path"),r=s(h,"baseURL"),u=s(h,"textureXhrSettings")}var d=new c(t,e,n,o);l.call(this,t,"multiatlas",e,[d]),this.config.path=i,this.config.baseURL=r,this.config.textureXhrSettings=u},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,n=this.config,i=this.loader,r=i.baseURL,a=i.path,c=i.prefix,l=s(n,"baseURL",this.baseURL),u=s(n,"path",this.path),h=s(n,"prefix",this.prefix),d=s(n,"textureXhrSettings");i.setBaseURL(l),i.setPath(u),i.setPrefix(h);for(var p=0;p<e.length;p++){var f=e[p].image,m="MA"+this.multiKeyIndex+"_"+f,g=new o(i,m,f,d);if(this.addToMultiFile(g),i.addFile(g),e[p].normalMap){var v=new o(i,m,e[p].normalMap,d);v.type="normalMap",g.setLink(v),this.addToMultiFile(v),i.addFile(v)}}i.setBaseURL(r),i.setPath(a),i.setPrefix(c)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],n=[],i=[],r=1;r<this.files.length;r++){var s=this.files[r];if("normalMap"!==s.type)for(var o=s.key.indexOf("_"),a=s.key.substr(o+1),c=s.data,l=0;l<t.data.textures.length;l++){var u=t.data.textures[l];if(u.image===a){n.push(c),e.push(u),s.linkFile&&i.push(s.linkFile.data);break}}}0===i.length&&(i=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,n,e,i),this.complete=!0}}});r.register("multiatlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new u(this,t[o]),this.addFile(s.files);else s=new u(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=u},39034:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42911),a=n(45176),c=n(55188),l=new i({Extends:a,initialize:function(t,e,n,i){var r="js",l=[];if(o(e)){var u=e;e=s(u,"key"),n=s(u,"url"),i=s(u,"xhrSettings"),r=s(u,"extension",r)}Array.isArray(n)||(n=[n]);for(var h=0;h<n.length;h++){var d=new c(t,{key:e+"_"+h.toString(),url:n[h],extension:r,xhrSettings:i});d.onProcess=function(){this.onProcessComplete()},l.push(d)}a.call(this,t,"scripts",e,l)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});r.register("scripts",(function(t,e,n){var i;if(Array.isArray(t))for(var r=0;r<t.length;r++)i=new l(this,t[r]),this.addFile(i.files);else i=new l(this,t,e,n),this.addFile(i.files);return this})),t.exports=l},85527:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42911),a=n(45176),c=n(27291),l=n(76799),u=n(86897),h=new i({Extends:a,initialize:function(t,e,n,i,r,c){var l,h,d=t.cacheManager.obj;if(o(e)){var p=e;e=s(p,"key"),l=new u(t,{key:e,type:"obj",cache:d,url:s(p,"url"),extension:s(p,"extension","obj"),xhrSettings:s(p,"xhrSettings"),config:{flipUV:s(p,"flipUV",r)}}),(i=s(p,"matURL"))&&(h=new u(t,{key:e,type:"mat",cache:d,url:i,extension:s(p,"matExtension","mat"),xhrSettings:s(p,"xhrSettings")}))}else l=new u(t,{key:e,url:n,type:"obj",cache:d,extension:"obj",xhrSettings:c,config:{flipUV:r}}),i&&(h=new u(t,{key:e,url:i,type:"mat",cache:d,extension:"mat",xhrSettings:c}));a.call(this,t,"obj",e,[l,h])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=c(t.data,t.config.flipUV);e&&(n.materials=l(e.data)),t.cache.add(t.key,n),this.complete=!0}}});r.register("obj",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new h(this,t[o]),this.addFile(s.files);else s=new h(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=h},3616:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(76846),o=n(70806),a=new i({Extends:o,initialize:function(t,e,n,i,r){o.call(this,t,e,n,i,r),this.type="packfile"},onProcess:function(){if(this.state!==r.FILE_POPULATED&&(this.state=r.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.data.hasOwnProperty("files")&&this.config){var t={};t[this.config]=this.data,this.data=t}this.loader.addPack(this.data,this.config),this.onProcessComplete()}});s.register("pack",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this})),t.exports=a},12217:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,o,l){var u="js";if(c(e)){var h=e;e=a(h,"key"),n=a(h,"url"),l=a(h,"xhrSettings"),u=a(h,"extension",u),i=a(h,"start"),o=a(h,"mapping")}var d={type:"plugin",cache:!1,extension:u,responseType:"text",key:e,url:n,xhrSettings:l,config:{start:i,mapping:o}};s.call(this,t,d),"function"===typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=a(e,"start",!1),i=a(e,"mapping",null);if(this.state===r.FILE_POPULATED)t.install(this.key,this.data,n,i);else{this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var s=t.install(this.key,window[this.key],n,i);(n||i)&&(this.loader.systems[i]=s,this.loader.scene[i]=s)}this.onProcessComplete()}});o.register("plugin",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this})),t.exports=l},4474:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,r){var o="svg";if(c(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"svgConfig",{}),r=a(l,"xhrSettings"),o=a(l,"extension",o)}var u={type:"svg",cache:t.textureManager,extension:o,responseType:"text",key:e,url:n,xhrSettings:r,config:{width:a(i,"width"),height:a(i,"height"),scale:a(i,"scale")}};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.xhrLoader.responseText,e=[t],n=this.config.width,i=this.config.height,o=this.config.scale;t:if(n&&i||o){var a=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],c=a.hasAttribute("viewBox"),l=parseFloat(a.getAttribute("width")),u=parseFloat(a.getAttribute("height"));if(!c&&l&&u)a.setAttribute("viewBox","0  0 "+l+" "+u);else if(c&&!l&&!u){var h=a.getAttribute("viewBox").split(/\s+|,/);l=h[2],u=h[3]}if(o){if(!l||!u)break t;n=l*o,i=u*o}a.setAttribute("width",n.toString()+"px"),a.setAttribute("height",i.toString()+"px"),e=[(new XMLSerializer).serializeToString(a)]}try{var d=new window.Blob(e,{type:"image/svg+xml;charset=utf-8"})}catch(m){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var p=this,f=!1;this.data.onload=function(){f||s.revokeObjectURL(p.data),p.onProcessComplete()},this.data.onerror=function(){f?p.onProcessError():(f=!0,s.revokeObjectURL(p.data),p.data.src="data:image/svg+xml,"+encodeURIComponent(e.join("")))},s.createObjectURL(this.data,d,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});o.register("svg",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new l(this,t[r]));else this.addFile(new l(this,t,e,n,i));return this})),t.exports=l},95171:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i){var r="js";if(c(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var l={type:"text",extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),e=eval;this.loader.sceneManager.add(this.key,e(t)),this.complete=!0}});o.register("sceneFile",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this})),t.exports=l},82458:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,o,l){var u="js";if(c(e)){var h=e;e=a(h,"key"),n=a(h,"url"),l=a(h,"xhrSettings"),u=a(h,"extension",u),i=a(h,"systemKey"),o=a(h,"sceneKey")}var d={type:"scenePlugin",cache:!1,extension:u,responseType:"text",key:e,url:n,xhrSettings:l,config:{systemKey:i,sceneKey:o}};s.call(this,t,d),"function"===typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=this.key,i=a(e,"systemKey",n),s=a(e,"sceneKey",n);this.state===r.FILE_POPULATED?t.installScenePlugin(i,this.data,s,this.loader.scene,!0):(this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(i,window[this.key],s,this.loader.scene,!0)),this.onProcessComplete()}});o.register("scenePlugin",(function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this})),t.exports=l},55188:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i,r){var o="js";if(c(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"type","script"),r=a(l,"xhrSettings"),o=a(l,"extension",o)}else void 0===i&&(i="script");var u={type:i,cache:!1,extension:o,responseType:"text",key:e,url:n,xhrSettings:r};s.call(this,t,u)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("script",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new l(this,t[r]));else this.addFile(new l(this,t,e,n,i));return this})),t.exports=l},33536:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(76846),o=n(42927),a=new i({Extends:o,initialize:function(t,e,n,i,r){o.call(this,t,e,n,r,i),this.type="spritesheet"},addToCache:function(){var t=this.linkFile;t?t.state>=r.FILE_COMPLETE&&("normalMap"===this.type?this.cache.addSpriteSheet(this.key,t.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,t.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});s.register("spritesheet",(function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,n,i));return this})),t.exports=a},86897:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=new i({Extends:s,initialize:function(t,e,n,i){var r="text",o="txt",l=t.cacheManager.text;if(c(e)){var u=e;e=a(u,"key"),n=a(u,"url"),i=a(u,"xhrSettings"),o=a(u,"extension",o),r=a(u,"type",r),l=a(u,"cache",l)}var h={type:r,cache:l,extension:o,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,h)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("text",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this})),t.exports=l},58673:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=n(93560),u=new i({Extends:s,initialize:function(t,e,n,i){var r="csv";if(c(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var u={type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u),this.tilemapFormat=l.CSV},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t)}});o.register("tilemapCSV",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},98896:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(70806),o=n(93560),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.WELTMEISTER,data:this.data};this.cache.add(this.key,t)}});r.register("tilemapImpact",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this})),t.exports=a},50563:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(70806),o=n(93560),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.TILED_JSON,data:this.data};this.cache.add(this.key,t)}});r.register("tilemapTiledJSON",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this})),t.exports=a},82857:(t,e,n)=>{var i=n(56694),r=n(76846),s=n(72632),o=n(42927),a=n(42911),c=n(45176),l=n(86897),u=new i({Extends:c,initialize:function(t,e,n,i,r,u){var h,d;if(a(e)){var p=e;e=s(p,"key"),h=new o(t,{key:e,url:s(p,"textureURL"),extension:s(p,"textureExtension","png"),normalMap:s(p,"normalMap"),xhrSettings:s(p,"textureXhrSettings")}),d=new l(t,{key:e,url:s(p,"atlasURL"),extension:s(p,"atlasExtension","txt"),xhrSettings:s(p,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new l(t,e,i,u);h.linkFile?c.call(this,t,"unityatlas",e,[h,d,h.linkFile]):c.call(this,t,"unityatlas",e,[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],n=this.files[2]?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,n),this.complete=!0}}});r.register("unityAtlas",(function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new u(this,t[o]),this.addFile(s.files);else s=new u(this,t,e,n,i,r),this.addFile(s.files);return this})),t.exports=u},22833:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(30750),c=n(72632),l=n(42911),u=new i({Extends:s,initialize:function(t,e,n,i){if(void 0===i&&(i=!1),l(e)){var r=e;e=c(r,"key"),n=c(r,"url",[]),i=c(r,"noAudio",!1)}var o=t.systems.game.device.video.getVideoURL(n);o||console.warn("VideoFile: No supported format for "+e);var a={type:"video",cache:t.cacheManager.video,extension:o.type,key:e,url:o.url,config:{noAudio:i}};s.call(this,t,a)},onProcess:function(){this.data={url:this.src,noAudio:this.config.noAudio,crossOrigin:this.crossOrigin},this.onProcessComplete()},load:function(){this.src=a(this,this.loader.baseURL),this.state=r.FILE_LOADED,this.loader.nextFile(this,!0)}});o.register("video",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},15297:(t,e,n)=>{var i=n(56694),r=n(12117),s=n(98035),o=n(76846),a=n(72632),c=n(42911),l=n(89200),u=new i({Extends:s,initialize:function(t,e,n,i){var r="xml";if(c(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}var l={type:"xml",cache:t.cacheManager.xml,extension:r,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,l)},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=l(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});o.register("xml",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new u(this,t[i]));else this.addFile(new u(this,t,e,n));return this})),t.exports=u},34034:(t,e,n)=>{t.exports={AnimationJSONFile:n(46468),AsepriteFile:n(31648),AtlasJSONFile:n(73152),AtlasXMLFile:n(24616),AudioFile:n(67448),AudioSpriteFile:n(66109),BinaryFile:n(40612),BitmapFontFile:n(54565),CompressedTextureFile:n(47375),CSSFile:n(99898),GLSLFile:n(46568),HTML5AudioFile:n(30929),HTMLFile:n(77459),HTMLTextureFile:n(9755),ImageFile:n(42927),JSONFile:n(70806),MultiAtlasFile:n(80802),MultiScriptFile:n(39034),OBJFile:n(85527),PackFile:n(3616),PluginFile:n(12217),SceneFile:n(95171),ScenePluginFile:n(82458),ScriptFile:n(55188),SpriteSheetFile:n(33536),SVGFile:n(4474),TextFile:n(86897),TilemapCSVFile:n(58673),TilemapImpactFile:n(98896),TilemapJSONFile:n(50563),UnityAtlasFile:n(82857),VideoFile:n(22833),XMLFile:n(15297)}},95695:(t,e,n)=>{var i=n(12117),r=n(98611),s={Events:n(683),FileTypes:n(34034),File:n(98035),FileTypesManager:n(76846),GetURL:n(30750),LoaderPlugin:n(67285),MergeXHRSettings:n(43531),MultiFile:n(45176),XHRLoader:n(88490),XHRSettings:n(33868)};s=r(!1,s,i),t.exports=s},26042:t=>{t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},22824:(t,e,n)=>{var i=n(8034);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},17489:t=>{t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},14976:t=>{t.exports=function(t,e,n,i,r){var s=.5*(i-e),o=.5*(r-n),a=t*t;return(2*n-2*i+s+o)*(t*a)+(-3*n+3*i-2*s-o)*a+s*t+n}},89129:t=>{t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},82897:t=>{t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},75606:(t,e,n)=>{var i=n(83392);t.exports=function(t){return t*i.DEG_TO_RAD}},767:t=>{t.exports=function(t,e){return Math.abs(t-e)}},9849:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(16650),o=n(72283),a=new s,c=new r({initialize:function t(e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=t.DefaultOrder),this._x=e,this._y=n,this._z=i,this._order=r,this.onChangeCallback=o},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,n,i){return void 0===i&&(i=this._order),this._x=t,this._y=e,this._z=n,this._order=i,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,n){return void 0===e&&(e=this._order),void 0===n&&(n=!1),a.fromQuat(t),this.setFromRotationMatrix(a,e,n)},setFromRotationMatrix:function(t,e,n){void 0===e&&(e=this._order),void 0===n&&(n=!1);var r=t.val,s=r[0],o=r[4],a=r[8],c=r[1],l=r[5],u=r[9],h=r[2],d=r[6],p=r[10],f=0,m=0,g=0,v=.99999;switch(e){case"XYZ":m=Math.asin(i(a,-1,1)),Math.abs(a)<v?(f=Math.atan2(-u,p),g=Math.atan2(-o,s)):f=Math.atan2(d,l);break;case"YXZ":f=Math.asin(-i(u,-1,1)),Math.abs(u)<v?(m=Math.atan2(a,p),g=Math.atan2(c,l)):m=Math.atan2(-h,s);break;case"ZXY":f=Math.asin(i(d,-1,1)),Math.abs(d)<v?(m=Math.atan2(-h,p),g=Math.atan2(-o,l)):g=Math.atan2(c,s);break;case"ZYX":m=Math.asin(-i(h,-1,1)),Math.abs(h)<v?(f=Math.atan2(d,p),g=Math.atan2(c,s)):g=Math.atan2(-o,l);break;case"YZX":g=Math.asin(i(c,-1,1)),Math.abs(c)<v?(f=Math.atan2(-u,l),m=Math.atan2(-h,s)):m=Math.atan2(a,p);break;case"XZY":g=Math.asin(-i(o,-1,1)),Math.abs(o)<v?(f=Math.atan2(d,l),m=Math.atan2(a,s)):f=Math.atan2(-u,p)}return this._x=f,this._y=m,this._z=g,this._order=e,n&&this.onChangeCallback(this),this}});c.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],c.DefaultOrder="XYZ",t.exports=c},8034:t=>{t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},61616:t=>{t.exports=function(t,e){return Math.random()*(e-t)+t}},60679:t=>{t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},91806:(t,e,n)=>{var i=n(82897);t.exports=function(t,e,n){return(n-e)*(t=i(t,0,1))+e}},79366:t=>{t.exports=function(t,e){return t/e/1e3}},43776:t=>{t.exports=function(t){return t==parseFloat(t)?!(t%2):void 0}},58442:t=>{t.exports=function(t){return t===parseFloat(t)?!(t%2):void 0}},42798:t=>{t.exports=function(t,e,n){return(e-t)*n+t}},61072:t=>{t.exports=function(t,e,n){return void 0===n&&(n=0),t.clone().lerp(e,n)}},5341:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=l*s-o*c,h=-l*r+o*a,d=c*r-s*a,p=e*u+n*h+i*d;return p?(p=1/p,t[0]=u*p,t[1]=(-l*n+i*c)*p,t[2]=(o*n-i*s)*p,t[3]=h*p,t[4]=(l*e-i*a)*p,t[5]=(-o*e+i*r)*p,t[6]=d*p,t[7]=(-c*e+n*a)*p,t[8]=(s*e-n*r)*p,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8];return t[0]=s*l-o*c,t[1]=i*c-n*l,t[2]=n*o-i*s,t[3]=o*a-r*l,t[4]=e*l-i*a,t[5]=i*r-e*o,t[6]=r*c-s*a,t[7]=n*a-e*c,t[8]=e*s-n*r,this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8];return e*(l*s-o*c)+n*(-l*r+o*a)+i*(c*r-s*a)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=t.val,d=h[0],p=h[1],f=h[2],m=h[3],g=h[4],v=h[5],y=h[6],x=h[7],b=h[8];return e[0]=d*n+p*s+f*c,e[1]=d*i+p*o+f*l,e[2]=d*r+p*a+f*u,e[3]=m*n+g*s+v*c,e[4]=m*i+g*o+v*l,e[5]=m*r+g*a+v*u,e[6]=y*n+x*s+b*c,e[7]=y*i+x*o+b*l,e[8]=y*r+x*a+b*u,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=Math.sin(t),l=Math.cos(t);return e[0]=l*n+c*s,e[1]=l*i+c*o,e[2]=l*r+c*a,e[3]=l*s-c*n,e[4]=l*o-c*i,e[5]=l*a-c*r,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,o=n+n,a=i+i,c=e*s,l=e*o,u=e*a,h=n*o,d=n*a,p=i*a,f=r*s,m=r*o,g=r*a,v=this.val;return v[0]=1-(h+p),v[3]=l+g,v[6]=u-m,v[1]=l-g,v[4]=1-(c+p),v[7]=d+f,v[2]=u+m,v[5]=d-f,v[8]=1-(c+h),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],x=i*c-r*a,b=i*l-s*a,w=i*u-o*a,S=r*l-s*c,_=r*u-o*c,T=s*u-o*l,E=h*g-d*m,C=h*v-p*m,k=h*y-f*m,A=d*v-p*g,I=d*y-f*g,O=p*y-f*v,R=x*O-b*I+w*A+S*k-_*C+T*E;return R?(R=1/R,n[0]=(c*O-l*I+u*A)*R,n[1]=(l*k-a*O-u*C)*R,n[2]=(a*I-c*k+u*E)*R,n[3]=(s*I-r*O-o*A)*R,n[4]=(i*O-s*k+o*C)*R,n[5]=(r*k-i*I-o*E)*R,n[6]=(g*T-v*_+y*S)*R,n[7]=(v*w-m*T-y*b)*R,n[8]=(m*_-g*w+y*x)*R,this):null}});t.exports=i},16650:(t,e,n)=>{var i=n(56694),r=n(70015),s=1e-6,o=new i({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new o(this)},set:function(t){return this.copy(t)},setValues:function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m){var g=this.val;return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=r,g[5]=s,g[6]=o,g[7]=a,g[8]=c,g[9]=l,g[10]=u,g[11]=h,g[12]=d,g[13]=p,g[14]=f,g[15]=m,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,n){var i=a.fromQuat(n).val,r=e.x,s=e.y,o=e.z;return this.setValues(i[0]*r,i[1]*r,i[2]*r,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],r=t[6],s=t[7],o=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=r,t[11]=t[14],t[12]=i,t[13]=s,t[14]=o,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=e*o-n*s,y=e*a-i*s,x=e*c-r*s,b=n*a-i*o,w=n*c-r*o,S=i*c-r*a,_=l*f-u*p,T=l*m-h*p,E=l*g-d*p,C=u*m-h*f,k=u*g-d*f,A=h*g-d*m,I=v*A-y*k+x*C+b*E-w*T+S*_;return I?(I=1/I,this.setValues((o*A-a*k+c*C)*I,(i*k-n*A-r*C)*I,(f*S-m*w+g*b)*I,(h*w-u*S-d*b)*I,(a*E-s*A-c*T)*I,(e*A-i*E+r*T)*I,(m*x-p*S-g*y)*I,(l*S-h*x+d*y)*I,(s*k-o*E+c*_)*I,(n*E-e*k-r*_)*I,(p*w-f*x+g*v)*I,(u*x-l*w-d*v)*I,(o*T-s*C-a*_)*I,(e*C-n*T+i*_)*I,(f*y-p*b-m*v)*I,(l*b-u*y+h*v)*I)):this},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15];return this.setValues(o*(h*g-d*m)-u*(a*g-c*m)+f*(a*d-c*h),-(n*(h*g-d*m)-u*(i*g-r*m)+f*(i*d-r*h)),n*(a*g-c*m)-o*(i*g-r*m)+f*(i*c-r*a),-(n*(a*d-c*h)-o*(i*d-r*h)+u*(i*c-r*a)),-(s*(h*g-d*m)-l*(a*g-c*m)+p*(a*d-c*h)),e*(h*g-d*m)-l*(i*g-r*m)+p*(i*d-r*h),-(e*(a*g-c*m)-s*(i*g-r*m)+p*(i*c-r*a)),e*(a*d-c*h)-s*(i*d-r*h)+l*(i*c-r*a),s*(u*g-d*f)-l*(o*g-c*f)+p*(o*d-c*u),-(e*(u*g-d*f)-l*(n*g-r*f)+p*(n*d-r*u)),e*(o*g-c*f)-s*(n*g-r*f)+p*(n*c-r*o),-(e*(o*d-c*u)-s*(n*d-r*u)+l*(n*c-r*o)),-(s*(u*m-h*f)-l*(o*m-a*f)+p*(o*h-a*u)),e*(u*m-h*f)-l*(n*m-i*f)+p*(n*h-i*u),-(e*(o*m-a*f)-s*(n*m-i*f)+p*(n*a-i*o)),e*(o*h-a*u)-s*(n*h-i*u)+l*(n*a-i*o))},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15];return(e*o-n*s)*(h*g-d*m)-(e*a-i*s)*(u*g-d*f)+(e*c-r*s)*(u*m-h*f)+(n*a-i*o)*(l*g-d*p)-(n*c-r*o)*(l*m-h*p)+(i*c-r*a)*(l*f-u*p)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=t.val,x=y[0],b=y[1],w=y[2],S=y[3];return e[0]=x*n+b*o+w*u+S*f,e[1]=x*i+b*a+w*h+S*m,e[2]=x*r+b*c+w*d+S*g,e[3]=x*s+b*l+w*p+S*v,x=y[4],b=y[5],w=y[6],S=y[7],e[4]=x*n+b*o+w*u+S*f,e[5]=x*i+b*a+w*h+S*m,e[6]=x*r+b*c+w*d+S*g,e[7]=x*s+b*l+w*p+S*v,x=y[8],b=y[9],w=y[10],S=y[11],e[8]=x*n+b*o+w*u+S*f,e[9]=x*i+b*a+w*h+S*m,e[10]=x*r+b*c+w*d+S*g,e[11]=x*s+b*l+w*p+S*v,x=y[12],b=y[13],w=y[14],S=y[15],e[12]=x*n+b*o+w*u+S*f,e[13]=x*i+b*a+w*h+S*m,e[14]=x*r+b*c+w*d+S*g,e[15]=x*s+b*l+w*p+S*v,this},multiplyLocal:function(t){var e=this.val,n=t.val;return this.setValues(e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.val,i=e.val,r=n[0],s=n[4],o=n[8],a=n[12],c=n[1],l=n[5],u=n[9],h=n[13],d=n[2],p=n[6],f=n[10],m=n[14],g=n[3],v=n[7],y=n[11],x=n[15],b=i[0],w=i[4],S=i[8],_=i[12],T=i[1],E=i[5],C=i[9],k=i[13],A=i[2],I=i[6],O=i[10],R=i[14],N=i[3],M=i[7],D=i[11],P=i[15];return this.setValues(r*b+s*T+o*A+a*N,c*b+l*T+u*A+h*N,d*b+p*T+f*A+m*N,g*b+v*T+y*A+x*N,r*w+s*E+o*I+a*M,c*w+l*E+u*I+h*M,d*w+p*E+f*I+m*M,g*w+v*E+y*I+x*M,r*S+s*C+o*O+a*D,c*S+l*C+u*O+h*D,d*S+p*C+f*O+m*D,g*S+v*C+y*O+x*D,r*_+s*k+o*R+a*P,c*_+l*k+u*R+h*P,d*_+p*k+f*R+m*P,g*_+v*k+y*R+x*P)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,o=t.y,a=t.z,c=r*s,l=r*o;return this.setValues(c*s+n,c*o-i*a,c*a+i*o,0,c*o+i*a,l*o+n,l*a-i*s,0,c*a-i*o,l*a+i*s,r*a*a+n,0,0,0,0,1)},rotate:function(t,e){var n=this.val,i=e.x,r=e.y,o=e.z,a=Math.sqrt(i*i+r*r+o*o);if(Math.abs(a)<s)return this;i*=a=1/a,r*=a,o*=a;var c=Math.sin(t),l=Math.cos(t),u=1-l,h=n[0],d=n[1],p=n[2],f=n[3],m=n[4],g=n[5],v=n[6],y=n[7],x=n[8],b=n[9],w=n[10],S=n[11],_=n[12],T=n[13],E=n[14],C=n[15],k=i*i*u+l,A=r*i*u+o*c,I=o*i*u-r*c,O=i*r*u-o*c,R=r*r*u+l,N=o*r*u+i*c,M=i*o*u+r*c,D=r*o*u-i*c,P=o*o*u+l;return this.setValues(h*k+m*A+x*I,d*k+g*A+b*I,p*k+v*A+w*I,f*k+y*A+S*I,h*O+m*R+x*N,d*O+g*R+b*N,p*O+v*R+w*N,f*O+y*R+S*N,h*M+m*D+x*P,d*M+g*D+b*P,p*M+v*D+w*P,f*M+y*D+S*P,_,T,E,C)},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[4],s=e[5],o=e[6],a=e[7],c=e[8],l=e[9],u=e[10],h=e[11];return e[4]=r*i+c*n,e[5]=s*i+l*n,e[6]=o*i+u*n,e[7]=a*i+h*n,e[8]=c*i-r*n,e[9]=l*i-s*n,e[10]=u*i-o*n,e[11]=h*i-a*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],c=e[8],l=e[9],u=e[10],h=e[11];return e[0]=r*i-c*n,e[1]=s*i-l*n,e[2]=o*i-u*n,e[3]=a*i-h*n,e[8]=r*n+c*i,e[9]=s*n+l*i,e[10]=o*n+u*i,e[11]=a*n+h*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],c=e[4],l=e[5],u=e[6],h=e[7];return e[0]=r*i+c*n,e[1]=s*i+l*n,e[2]=o*i+u*n,e[3]=a*i+h*n,e[4]=c*i-r*n,e[5]=l*i-s*n,e[6]=u*i-o*n,e[7]=h*i-a*n,this},fromRotationTranslation:function(t,e){var n=t.x,i=t.y,r=t.z,s=t.w,o=n+n,a=i+i,c=r+r,l=n*o,u=n*a,h=n*c,d=i*a,p=i*c,f=r*c,m=s*o,g=s*a,v=s*c;return this.setValues(1-(d+f),u+v,h-g,0,u-v,1-(l+f),p+m,0,h+g,p-m,1-(l+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,o=n+n,a=i+i,c=e*s,l=e*o,u=e*a,h=n*o,d=n*a,p=i*a,f=r*s,m=r*o,g=r*a;return this.setValues(1-(h+p),l+g,u-m,0,l-g,1-(c+p),d+f,0,u+m,d-f,1-(c+h),0,0,0,0,1)},frustum:function(t,e,n,i,r,s){var o=1/(e-t),a=1/(i-n),c=1/(r-s);return this.setValues(2*r*o,0,0,0,0,2*r*a,0,0,(e+t)*o,(i+n)*a,(s+r)*c,-1,0,0,s*r*2*c,0)},perspective:function(t,e,n,i){var r=1/Math.tan(t/2),s=1/(n-i);return this.setValues(r/e,0,0,0,0,r,0,0,0,0,(i+n)*s,-1,0,0,2*i*n*s,0)},perspectiveLH:function(t,e,n,i){return this.setValues(2*n/t,0,0,0,0,2*n/e,0,0,0,0,-i/(n-i),1,0,0,n*i/(n-i),0)},ortho:function(t,e,n,i,r,s){var o=t-e,a=n-i,c=r-s;return o=0===o?o:1/o,a=0===a?a:1/a,c=0===c?c:1/c,this.setValues(-2*o,0,0,0,0,-2*a,0,0,0,0,2*c,0,(t+e)*o,(i+n)*a,(s+r)*c,1)},lookAtRH:function(t,e,n){var i=this.val;return h.subVectors(t,e),0===h.getLengthSquared()&&(h.z=1),h.normalize(),l.crossVectors(n,h),0===l.getLengthSquared()&&(1===Math.abs(n.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),l.crossVectors(n,h)),l.normalize(),u.crossVectors(h,l),i[0]=l.x,i[1]=l.y,i[2]=l.z,i[4]=u.x,i[5]=u.y,i[6]=u.z,i[8]=h.x,i[9]=h.y,i[10]=h.z,this},lookAt:function(t,e,n){var i=t.x,r=t.y,o=t.z,a=n.x,c=n.y,l=n.z,u=e.x,h=e.y,d=e.z;if(Math.abs(i-u)<s&&Math.abs(r-h)<s&&Math.abs(o-d)<s)return this.identity();var p=i-u,f=r-h,m=o-d,g=1/Math.sqrt(p*p+f*f+m*m),v=c*(m*=g)-l*(f*=g),y=l*(p*=g)-a*m,x=a*f-c*p;(g=Math.sqrt(v*v+y*y+x*x))?(v*=g=1/g,y*=g,x*=g):(v=0,y=0,x=0);var b=f*x-m*y,w=m*v-p*x,S=p*y-f*v;return(g=Math.sqrt(b*b+w*w+S*S))?(b*=g=1/g,w*=g,S*=g):(b=0,w=0,S=0),this.setValues(v,b,p,0,y,w,f,0,x,S,m,0,-(v*i+y*r+x*o),-(b*i+w*r+S*o),-(p*i+f*r+m*o),1)},yawPitchRoll:function(t,e,n){this.zero(),a.zero(),c.zero();var i=this.val,r=a.val,s=c.val,o=Math.sin(n),l=Math.cos(n);return i[10]=1,i[15]=1,i[0]=l,i[1]=o,i[4]=-o,i[5]=l,o=Math.sin(e),l=Math.cos(e),r[0]=1,r[15]=1,r[5]=l,r[10]=l,r[9]=-o,r[6]=o,o=Math.sin(t),l=Math.cos(t),s[5]=1,s[15]=1,s[0]=l,s[2]=-o,s[8]=o,s[10]=l,this.multiplyLocal(a),this.multiplyLocal(c),this},setWorldMatrix:function(t,e,n,i,r){return this.yawPitchRoll(t.y,t.x,t.z),a.scaling(n.x,n.y,n.z),c.xyz(e.x,e.y,e.z),this.multiplyLocal(a),this.multiplyLocal(c),i&&this.multiplyLocal(i),r&&this.multiplyLocal(r),this},multiplyToMat4:function(t,e){var n=this.val,i=t.val,r=n[0],s=n[1],o=n[2],a=n[3],c=n[4],l=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=i[0],w=i[1],S=i[2],_=i[3],T=i[4],E=i[5],C=i[6],k=i[7],A=i[8],I=i[9],O=i[10],R=i[11],N=i[12],M=i[13],D=i[14],P=i[15];return e.setValues(b*r+w*c+S*d+_*g,w*s+w*l+S*p+_*v,S*o+w*u+S*f+_*y,_*a+w*h+S*m+_*x,T*r+E*c+C*d+k*g,T*s+E*l+C*p+k*v,T*o+E*u+C*f+k*y,T*a+E*h+C*m+k*x,A*r+I*c+O*d+R*g,A*s+I*l+O*p+R*v,A*o+I*u+O*f+R*y,A*a+I*h+O*m+R*x,N*r+M*c+D*d+P*g,N*s+M*l+D*p+P*v,N*o+M*u+D*f+P*y,N*a+M*h+D*m+P*x)},fromRotationXYTranslation:function(t,e,n){var i=e.x,r=e.y,s=e.z,o=Math.sin(t.x),a=Math.cos(t.x),c=Math.sin(t.y),l=Math.cos(t.y),u=i,h=r,d=s,p=-o,f=0-p*c,m=0-a*c,g=p*l,v=a*l;return n||(u=l*i+c*s,h=f*i+a*r+g*s,d=m*i+o*r+v*s),this.setValues(l,f,m,0,0,a,o,0,c,g,v,0,u,h,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}}),a=new o,c=new o,l=new r,u=new r,h=new r;t.exports=o},69635:t=>{t.exports=function(t,e,n){return Math.min(t+e,n)}},37394:t=>{t.exports=function(t){var e=t.length;if(0===e)return 0;t.sort((function(t,e){return t-e}));var n=Math.floor(e/2);return e%2===0?(t[n]+t[n-1])/2:t[n]}},17259:t=>{t.exports=function(t,e,n){return Math.max(t-e,n)}},61820:t=>{t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var r=(t-e)/(n-e);return r>1?void 0!==i?(r=(i-t)/(i-n))<0&&(r=0):r=1:r<0&&(r=0),r}},75003:(t,e,n)=>{var i=n(56694),r=n(5341),s=n(72283),o=n(70015),a=1e-6,c=new Int8Array([1,2,0]),l=new Float32Array([0,0,0]),u=new o(1,0,0),h=new o(0,1,0),d=new o,p=new r,f=new i({initialize:function(t,e,n,i){this.onChangeCallback=s,this.set(t,e,n,i)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,n,i,r){return void 0===r&&(r=!0),"object"===typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=n||0,this._w=i||0),r&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this._x=t*r,this._y=e*r,this._z=n*r,this._w=i*r),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.set(n+e*(t.x-n),i+e*(t.y-i),r+e*(t.z-r),s+e*(t.w-s))},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(d.copy(u).cross(t).length()<a&&d.copy(h).cross(t),d.normalize(),this.setAxisAngle(d,Math.PI)):n>.999999?this.set(0,0,0,1):(d.copy(t).cross(e),this._x=d.x,this._y=d.y,this._z=d.z,this._w=1+n,this.normalize())},setAxes:function(t,e,n){var i=p.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(p).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.set(n*t.x,n*t.y,n*t.z,Math.cos(e))},multiply:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.x,o=t.y,a=t.z,c=t.w;return this.set(e*c+r*s+n*a-i*o,n*c+r*o+i*s-e*a,i*c+r*a+e*o-n*s,r*c-e*s-n*o-i*a)},slerp:function(t,e){var n=this.x,i=this.y,r=this.z,s=this.w,o=t.x,c=t.y,l=t.z,u=t.w,h=n*o+i*c+r*l+s*u;h<0&&(h=-h,o=-o,c=-c,l=-l,u=-u);var d=1-e,p=e;if(1-h>a){var f=Math.acos(h),m=Math.sin(f);d=Math.sin((1-e)*f)/m,p=Math.sin(e*f)/m}return this.set(d*n+p*o,d*i+p*c,d*r+p*l,d*s+p*u)},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i,s=r?1/r:0;return this.set(-t*s,-e*s,-n*s,i*s)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o+r*s,n*o+i*s,i*o-n*s,r*o-e*s)},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o-i*s,n*o+r*s,i*o+e*s,r*o-n*s)},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.set(e*o+n*s,n*o-e*s,i*o+r*s,r*o-i*s)},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},setFromEuler:function(t,e){var n=t.x/2,i=t.y/2,r=t.z/2,s=Math.cos(n),o=Math.cos(i),a=Math.cos(r),c=Math.sin(n),l=Math.sin(i),u=Math.sin(r);switch(t.order){case"XYZ":this.set(c*o*a+s*l*u,s*l*a-c*o*u,s*o*u+c*l*a,s*o*a-c*l*u,e);break;case"YXZ":this.set(c*o*a+s*l*u,s*l*a-c*o*u,s*o*u-c*l*a,s*o*a+c*l*u,e);break;case"ZXY":this.set(c*o*a-s*l*u,s*l*a+c*o*u,s*o*u+c*l*a,s*o*a-c*l*u,e);break;case"ZYX":this.set(c*o*a-s*l*u,s*l*a+c*o*u,s*o*u-c*l*a,s*o*a+c*l*u,e);break;case"YZX":this.set(c*o*a+s*l*u,s*l*a+c*o*u,s*o*u-c*l*a,s*o*a-c*l*u,e);break;case"XZY":this.set(c*o*a-s*l*u,s*l*a-c*o*u,s*o*u+c*l*a,s*o*a+c*l*u,e)}return this},setFromRotationMatrix:function(t){var e,n=t.val,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],c=n[9],l=n[2],u=n[6],h=n[10],d=i+a+h;return d>0?(e=.5/Math.sqrt(d+1),this.set((u-c)*e,(s-l)*e,(o-r)*e,.25/e)):i>a&&i>h?(e=2*Math.sqrt(1+i-a-h),this.set(.25*e,(r+o)/e,(s+l)/e,(u-c)/e)):a>h?(e=2*Math.sqrt(1+a-i-h),this.set((r+o)/e,.25*e,(c+u)/e,(s-l)/e)):(e=2*Math.sqrt(1+h-i-a),this.set((s+l)/e,(c+u)/e,.25*e,(o-r)/e)),this},fromMat3:function(t){var e,n=t.val,i=n[0]+n[4]+n[8];if(i>0)e=Math.sqrt(i+1),this.w=.5*e,e=.5/e,this._x=(n[7]-n[5])*e,this._y=(n[2]-n[6])*e,this._z=(n[3]-n[1])*e;else{var r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);var s=c[r],o=c[s];e=Math.sqrt(n[3*r+r]-n[3*s+s]-n[3*o+o]+1),l[r]=.5*e,e=.5/e,l[s]=(n[3*s+r]+n[3*r+s])*e,l[o]=(n[3*o+r]+n[3*r+o])*e,this._x=l[0],this._y=l[1],this._z=l[2],this._w=(n[3*o+s]-n[3*s+o])*e}return this.onChangeCallback(this),this}});t.exports=f},23701:(t,e,n)=>{var i=n(83392);t.exports=function(t){return t*i.RAD_TO_DEG}},16906:t=>{t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},52417:t=>{t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,r=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*r,t.y=Math.sin(n)*r,t.z=i*e,t}},17915:t=>{t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},52257:t=>{t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},2386:t=>{t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x-e,a=t.y-n;return t.x=o*r-a*s+e,t.y=o*s+a*r+n,t}},72395:t=>{t.exports=function(t,e,n,i,r){var s=i+Math.atan2(t.y-n,t.x-e);return t.x=e+r*Math.cos(s),t.y=n+r*Math.sin(s),t}},41061:t=>{t.exports=function(t,e,n,i,r){return t.x=e+r*Math.cos(i),t.y=n+r*Math.sin(i),t}},93709:(t,e,n)=>{var i=n(70015),r=n(16650),s=n(75003),o=new r,a=new s,c=new i;t.exports=function(t,e,n){return a.setAxisAngle(e,n),o.fromRotationTranslation(a,c.set(0,0,0)),t.transformMat4(o)}},67233:t=>{t.exports=function(t){return t>0?Math.ceil(t):Math.floor(t)}},64333:t=>{t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},59533:t=>{t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var r=[],s=[],o=0;o<t;o++)e+=(n-=e*i)*i,r[o]=n,s[o]=e;return{sin:s,cos:r,length:t}}},5514:t=>{t.exports=function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)}},87736:t=>{t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},55805:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r){void 0===r&&(r=new i);var s=0,o=0;return t>0&&t<=e*n&&(s=t>e-1?t-(o=Math.floor(t/e))*e:t),r.set(s,o)}},64462:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s,o,a,c){void 0===c&&(c=new i);var l=Math.sin(s),u=Math.cos(s),h=u*o,d=l*o,p=-l*a,f=u*a,m=1/(h*f+p*-d);return c.x=f*m*t+-p*m*e+(r*p-n*f)*m,c.y=h*m*e+-d*m*t+(-r*h+n*d)*m,c}},93736:(t,e,n)=>{var i=n(56694),r=n(88456),s=new i({initialize:function(t,e){this.x=0,this.y=0,"object"===typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new s(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return r(this.x,t.x,e)&&r(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e*this.x-n*this.y,n*this.x+e*this.y)},project:function(t){var e=this.dot(t)/t.dot(t);return this.copy(t).scale(e)}});s.ZERO=new s,s.RIGHT=new s(1,0),s.LEFT=new s(-1,0),s.UP=new s(0,-1),s.DOWN=new s(0,1),s.ONE=new s(1,1),t.exports=s},70015:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"===typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new i(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"===typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z;return this.x=n*o-i*s,this.y=i*r-e*o,this.z=e*s-n*r,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=e*r[0]+n*r[3]+i*r[6],this.y=e*r[1]+n*r[4]+i*r[7],this.z=e*r[2]+n*r[5]+i*r[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=e*r[0]+n*r[4]+i*r[8]+r[12],o=e*r[1]+n*r[5]+i*r[9]+r[13],a=e*r[2]+n*r[6]+i*r[10]+r[14],c=e*r[3]+n*r[7]+i*r[11]+r[15];return this.x=s/c,this.y=o/c,this.z=a/c,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,c=a*e+s*i-o*n,l=a*n+o*e-r*i,u=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=c*a+h*-r+l*-o-u*-s,this.y=l*a+h*-s+u*-r-c*-o,this.z=u*a+h*-o+c*-s-l*-r,this},project:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],p=r[8],f=r[9],m=r[10],g=r[11],v=r[12],y=r[13],x=r[14],b=1/(e*c+n*d+i*g+r[15]);return this.x=(e*s+n*l+i*p+v)*b,this.y=(e*o+n*u+i*f+y)*b,this.z=(e*a+n*h+i*m+x)*b,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var n=t.x,i=t.y,r=t.z,s=t.w,o=this.x-n,a=s-this.y-1-i,c=this.z;return this.x=2*o/r-1,this.y=2*a/s-1,this.z=2*c-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},51729:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"===typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"===typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this.x=t*r,this.y=e*r,this.z=n*r,this.w=i*r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this.w=s+e*(t.w-s),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+r*r)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return e*e+n*n+i*i+r*r},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.val;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,c=a*e+s*i-o*n,l=a*n+o*e-r*i,u=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=c*a+h*-r+l*-o-u*-s,this.y=l*a+h*-s+u*-r-c*-o,this.z=u*a+h*-o+c*-s-l*-r,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},9557:t=>{t.exports=function(t,e,n){return Math.abs(t-e)<=n}},1071:t=>{t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},90447:t=>{t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},94240:t=>{t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},84066:t=>{t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},9678:t=>{t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},76861:(t,e,n)=>{var i=n(83392);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},37570:t=>{t.exports=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI}},87597:(t,e,n)=>{var i=n(61616);t.exports=function(){return i(-Math.PI,Math.PI)}},74493:(t,e,n)=>{var i=n(61616);t.exports=function(){return i(-180,180)}},19049:(t,e,n)=>{var i=n(37570);t.exports=function(t){return i(t+Math.PI)}},90612:(t,e,n)=>{var i=n(83392);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),e>t?t+=n:e<t&&(t-=n))),t}},93954:t=>{t.exports=function(t,e){var n=e-t;return 0===n?0:n-360*Math.floor((n- -180)/360)}},35786:(t,e,n)=>{var i=n(1071);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},62138:(t,e,n)=>{var i=n(1071);t.exports=function(t){return i(t,-180,180)}},22153:(t,e,n)=>{t.exports={Between:n(90447),BetweenPoints:n(94240),BetweenPointsY:n(84066),BetweenY:n(9678),CounterClockwise:n(76861),Normalize:n(37570),Random:n(87597),RandomDegrees:n(74493),Reverse:n(19049),RotateTo:n(90612),ShortestBetween:n(93954),Wrap:n(35786),WrapDegrees:n(62138)}},83392:t=>{var e={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};t.exports=e},53996:t=>{t.exports=function(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)}},92951:t=>{t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},12161:t=>{t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},38057:t=>{t.exports=function(t,e,n,i){return Math.max(Math.abs(t-n),Math.abs(e-i))}},33297:t=>{t.exports=function(t,e,n,i,r){return void 0===r&&(r=2),Math.sqrt(Math.pow(n-t,r)+Math.pow(i-e,r))}},90366:t=>{t.exports=function(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}},35032:t=>{t.exports=function(t,e,n,i){var r=t-n,s=e-i;return r*r+s*s}},10130:(t,e,n)=>{t.exports={Between:n(53996),BetweenPoints:n(92951),BetweenPointsSquared:n(12161),Chebyshev:n(38057),Power:n(33297),Snake:n(90366),Squared:n(35032)}},35060:(t,e,n)=>{var i=n(25265),r=n(57428),s=n(73214),o=n(71778),a=n(36468),c=n(88258),l=n(52910),u=n(67799),h=n(74083),d=n(92284),p=n(28035),f=n(8754);t.exports={Power0:l,Power1:u.Out,Power2:o.Out,Power3:h.Out,Power4:d.Out,Linear:l,Quad:u.Out,Cubic:o.Out,Quart:h.Out,Quint:d.Out,Sine:p.Out,Expo:c.Out,Circ:s.Out,Elastic:a.Out,Back:i.Out,Bounce:r.Out,Stepped:f,"Quad.easeIn":u.In,"Cubic.easeIn":o.In,"Quart.easeIn":h.In,"Quint.easeIn":d.In,"Sine.easeIn":p.In,"Expo.easeIn":c.In,"Circ.easeIn":s.In,"Elastic.easeIn":a.In,"Back.easeIn":i.In,"Bounce.easeIn":r.In,"Quad.easeOut":u.Out,"Cubic.easeOut":o.Out,"Quart.easeOut":h.Out,"Quint.easeOut":d.Out,"Sine.easeOut":p.Out,"Expo.easeOut":c.Out,"Circ.easeOut":s.Out,"Elastic.easeOut":a.Out,"Back.easeOut":i.Out,"Bounce.easeOut":r.Out,"Quad.easeInOut":u.InOut,"Cubic.easeInOut":o.InOut,"Quart.easeInOut":h.InOut,"Quint.easeInOut":d.InOut,"Sine.easeInOut":p.InOut,"Expo.easeInOut":c.InOut,"Circ.easeInOut":s.InOut,"Elastic.easeInOut":a.InOut,"Back.easeInOut":i.InOut,"Bounce.easeInOut":r.InOut}},25860:t=>{t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},45264:t=>{t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}},36699:t=>{t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},25265:(t,e,n)=>{t.exports={In:n(25860),Out:n(36699),InOut:n(45264)}},62191:t=>{t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},24799:t=>{t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},60819:t=>{t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},57428:(t,e,n)=>{t.exports={In:n(62191),Out:n(60819),InOut:n(24799)}},86855:t=>{t.exports=function(t){return 1-Math.sqrt(1-t*t)}},7280:t=>{t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},18058:t=>{t.exports=function(t){return Math.sqrt(1- --t*t)}},73214:(t,e,n)=>{t.exports={In:n(86855),Out:n(18058),InOut:n(7280)}},91532:t=>{t.exports=function(t){return t*t*t}},63180:t=>{t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},16518:t=>{t.exports=function(t){return--t*t*t+1}},71778:(t,e,n)=>{t.exports={In:n(91532),Out:n(16518),InOut:n(63180)}},24729:t=>{t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)}},50325:t=>{t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},84074:t=>{t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},36468:(t,e,n)=>{t.exports={In:n(24729),Out:n(84074),InOut:n(50325)}},95638:t=>{t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},10357:t=>{t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},14894:t=>{t.exports=function(t){return 1-Math.pow(2,-10*t)}},88258:(t,e,n)=>{t.exports={In:n(95638),Out:n(14894),InOut:n(10357)}},33063:(t,e,n)=>{t.exports={Back:n(25265),Bounce:n(57428),Circular:n(73214),Cubic:n(71778),Elastic:n(36468),Expo:n(88258),Linear:n(52910),Quadratic:n(67799),Quartic:n(74083),Quintic:n(92284),Sine:n(28035),Stepped:n(8754)}},43927:t=>{t.exports=function(t){return t}},52910:(t,e,n)=>{t.exports=n(43927)},77471:t=>{t.exports=function(t){return t*t}},83863:t=>{t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},44383:t=>{t.exports=function(t){return t*(2-t)}},67799:(t,e,n)=>{t.exports={In:n(77471),Out:n(44383),InOut:n(83863)}},48311:t=>{t.exports=function(t){return t*t*t*t}},55248:t=>{t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},23135:t=>{t.exports=function(t){return 1- --t*t*t*t}},74083:(t,e,n)=>{t.exports={In:n(48311),Out:n(23135),InOut:n(55248)}},7313:t=>{t.exports=function(t){return t*t*t*t*t}},98759:t=>{t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},26670:t=>{t.exports=function(t){return--t*t*t*t*t+1}},92284:(t,e,n)=>{t.exports={In:n(7313),Out:n(26670),InOut:n(98759)}},52929:t=>{t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},66333:t=>{t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},37255:t=>{t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},28035:(t,e,n)=>{t.exports={In:n(52929),Out:n(37255),InOut:n(66333)}},52770:t=>{t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}},8754:(t,e,n)=>{t.exports=n(52770)},17247:t=>{t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},88456:t=>{t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},61824:t=>{t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},41935:t=>{t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t>e-n}},54726:t=>{t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},52778:(t,e,n)=>{t.exports={Ceil:n(17247),Equal:n(88456),Floor:n(61824),GreaterThan:n(41935),LessThan:n(54726)}},5923:(t,e,n)=>{var i=n(83392),r=n(98611),s={Angle:n(22153),Distance:n(10130),Easing:n(33063),Fuzzy:n(52778),Interpolation:n(48528),Pow2:n(73773),Snap:n(23679),RandomDataGenerator:n(81429),Average:n(26042),Bernstein:n(22824),Between:n(17489),CatmullRom:n(14976),CeilTo:n(89129),Clamp:n(82897),DegToRad:n(75606),Difference:n(767),Euler:n(9849),Factorial:n(8034),FloatBetween:n(61616),FloorTo:n(60679),FromPercent:n(91806),GetSpeed:n(79366),IsEven:n(43776),IsEvenStrict:n(58442),Linear:n(42798),LinearXY:n(61072),MaxAdd:n(69635),Median:n(37394),MinSub:n(17259),Percent:n(61820),RadToDeg:n(23701),RandomXY:n(16906),RandomXYZ:n(52417),RandomXYZW:n(17915),Rotate:n(52257),RotateAround:n(2386),RotateAroundDistance:n(72395),RotateTo:n(41061),RoundAwayFromZero:n(67233),RoundTo:n(64333),SinCosTableGenerator:n(59533),SmootherStep:n(87736),SmoothStep:n(5514),ToXY:n(55805),TransformXY:n(64462),Within:n(9557),Wrap:n(1071),Vector2:n(93736),Vector3:n(70015),Vector4:n(51729),Matrix3:n(5341),Matrix4:n(16650),Quaternion:n(75003),RotateVec3:n(93709)};s=r(!1,s,i),t.exports=s},63210:(t,e,n)=>{var i=n(22824);t.exports=function(t,e){for(var n=0,r=t.length-1,s=0;s<=r;s++)n+=Math.pow(1-e,r-s)*Math.pow(e,s)*t[s]*i(r,s);return n}},88332:(t,e,n)=>{var i=n(14976);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return t[0]===t[n]?(e<0&&(s=Math.floor(r=n*(1+e))),i(r-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(i(-r,t[0],t[0],t[1],t[1])-t[0]):e>1?t[n]-(i(r-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(r-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}},34631:t=>{t.exports=function(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}},47614:(t,e,n)=>{var i=n(42798);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return e<0?i(t[0],t[1],r):e>1?i(t[n],t[n-1],n-r):i(t[s],t[s+1>n?n:s+1],r-s)}},16252:t=>{t.exports=function(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}},44521:(t,e,n)=>{var i=n(5514);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},45507:(t,e,n)=>{var i=n(87736);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},48528:(t,e,n)=>{t.exports={Bezier:n(63210),CatmullRom:n(88332),CubicBezier:n(34631),Linear:n(47614),QuadraticBezier:n(16252),SmoothStep:n(44521),SmootherStep:n(45507)}},3504:t=>{t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},28621:t=>{t.exports=function(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)}},2018:t=>{t.exports=function(t){return t>0&&0===(t&t-1)}},73773:(t,e,n)=>{t.exports={GetNext:n(3504),IsSize:n(28621),IsValue:n(2018)}},81429:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return this.n=n,2.3283064365386963e-10*(n>>>0)},init:function(t){"string"===typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*t.length+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"===typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},82127:t=>{t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},84314:t=>{t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},88462:t=>{t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},23679:(t,e,n)=>{t.exports={Ceil:n(82127),Floor:n(84314),To:n(88462)}},92491:(t,e,n)=>{n(75205);var i=n(86459),r=n(98611),s={Actions:n(83979),Animations:n(13517),BlendModes:n(95723),Cache:n(45820),Cameras:n(44143),Core:n(80293),Class:n(56694),Create:n(84106),Curves:n(73962),Data:n(1999),Display:n(24816),DOM:n(3590),Events:n(95146),FX:n(96910),Game:n(15213),GameObjects:n(48013),Geom:n(84068),Input:n(20873),Loader:n(95695),Math:n(5923),Physics:n(53954),Plugins:n(45615),Renderer:n(42069),Scale:n(86754),ScaleModes:n(27394),Scene:n(87157),Scenes:n(20436),Structs:n(20010),Textures:n(87499),Tilemaps:n(52678),Time:n(97121),Tweens:n(75193),Utils:n(22178)};s.Sound=n(56751),s=r(!1,s,i),t.exports=s,n.g.Phaser=s},62832:(t,e,n)=>{var i=n(56694),r=n(7864),s=n(1539),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Collision,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Pushable,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},66150:(t,e,n)=>{var i=n(56694),r=n(75606),s=n(53996),o=n(35032),a=n(99523),c=n(72632),l=n(30657),u=n(2732),h=n(15147),d=n(91963),p=n(7599),f=n(93736),m=n(85233),g=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this._category=1,t.sys.events.once(p.BOOT,this.boot,this),t.sys.events.on(p.START,this.start,this)},boot:function(){this.world=new m(this.scene,this.config),this.add=new a(this.world),this.systems.events.once(p.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new m(this.scene,this.config),this.add=new a(this.world));var t=this.systems.events;c(this.config,"customUpdate",!1)||t.on(p.UPDATE,this.world.update,this.world),t.on(p.POST_UPDATE,this.world.postUpdate,this.world),t.once(p.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(p.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(p.UPDATE,this.world.update,this.world)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return l(c(e,"arcade",{}),c(t,"arcade",{}))},nextCategory:function(){return this._category=this._category<<1,this._category},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!1)},collideTiles:function(t,e,n,i,r){return this.world.collideTiles(t,e,n,i,r)},overlapTiles:function(t,e,n,i,r){return this.world.overlapTiles(t,e,n,i,r)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,n,i,r,s){void 0===i&&(i=60);var o=Math.atan2(n-t.y,e-t.x);return t.body.acceleration.setToPolar(o,i),void 0!==r&&void 0!==s&&t.body.maxVelocity.set(r,s),o},accelerateToObject:function(t,e,n,i,r){return this.accelerateTo(t,e.x,e.y,n,i,r)},closest:function(t,e){e||(e=this.world.bodies.entries);for(var n=Number.MAX_VALUE,i=null,r=t.x,s=t.y,a=e.length,c=0;c<a;c++){var l=e[c],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var h=o(r,s,u.center.x,u.center.y);h<n&&(i=l,n=h)}}return i},furthest:function(t,e){e||(e=this.world.bodies.entries);for(var n=-1,i=null,r=t.x,s=t.y,a=e.length,c=0;c<a;c++){var l=e[c],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var h=o(r,s,u.center.x,u.center.y);h>n&&(i=l,n=h)}}return i},moveTo:function(t,e,n,i,r){void 0===i&&(i=60),void 0===r&&(r=0);var o=Math.atan2(n-t.y,e-t.x);return r>0&&(i=s(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(o,i),o},moveToObject:function(t,e,n,i){return this.moveTo(t,e.x,e.y,n,i)},velocityFromAngle:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new f),n.setToPolar(r(t),e)},velocityFromRotation:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new f),n.setToPolar(t,e)},overlapRect:function(t,e,n,i,r,s){return h(this.world,t,e,n,i,r,s)},overlapCirc:function(t,e,n,i,r){return u(this.world,t,e,n,i,r)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(p.UPDATE,this.world.update,this.world),t.off(p.POST_UPDATE,this.world.postUpdate,this.world),t.off(p.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null,this._category=1}},destroy:function(){this.shutdown(),this.scene.sys.events.off(p.START,this.start,this),this.scene=null,this.systems=null}});d.register("ArcadePhysics",g,"arcadePhysics"),t.exports=g},25084:(t,e,n)=>{var i=n(56694),r=n(7864),s=n(13747),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Collision,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Pushable,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},97602:(t,e,n)=>{var i=n(56694),r=n(95239),s=n(47401),o=n(27037),a=n(23701),c=n(74118),l=n(94287),u=n(15084),h=n(93736),d=new i({Mixins:[r],initialize:function(t,e){var n=64,i=64,r=void 0!==e;r&&e.displayWidth&&(n=e.displayWidth,i=e.displayHeight),r||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=r?e:void 0,this.isBody=!0,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new h,this.position=new h(e.x-e.scaleX*e.displayOriginX,e.y-e.scaleY*e.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=i,this.sourceWidth=n,this.sourceHeight=i,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(i/2),this.center=new h(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new h,this.newVelocity=new h,this.deltaMax=new h,this.acceleration=new h,this.allowDrag=!0,this.drag=new h,this.allowGravity=!0,this.gravity=new h,this.bounce=new h,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new h(1e4,1e4),this.maxSpeed=-1,this.friction=new h(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=s.FACING_NONE,this.immovable=!1,this.pushable=!0,this.slideFactor=new h(1,1),this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=u(!1),this.touching=u(!0),this.wasTouching=u(!0),this.blocked=u(!0),this.syncBounds=!1,this.physicsType=s.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new c,this.directControl=!1,this.autoFrame=this.position.clone()},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var n=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=n.tx,e.y=n.ty,e.rotation=a(n.rotation),e.scaleX=n.scaleX,e.scaleY=n.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var i=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,i=!0}else{var s=Math.abs(e.scaleX),o=Math.abs(e.scaleY);this._sx===s&&this._sy===o||(this.width=this.sourceWidth*s,this.height=this.sourceHeight*o,this._sx=s,this._sy=o,i=!0)}i&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var t=this.transform;this.position.x=t.x+t.scaleX*(this.offset.x-t.displayOriginX),this.position.y=t.y+t.scaleY*(this.offset.y-t.displayOriginY),this.updateCenter()},resetFlags:function(t){void 0===t&&(t=!1);var e=this.wasTouching,n=this.touching,i=this.blocked;t?u(!0,e):(e.none=n.none,e.up=n.up,e.down=n.down,e.left=n.left,e.right=n.right),u(!0,n),u(!0,i),this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){if(t&&this.resetFlags(),this.gameObject&&this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves){var n=this.position;this.prev.x=n.x,this.prev.y=n.y,this.prevFrame.x=n.x,this.prevFrame.y=n.y}t&&this.update(e)},update:function(t){var e=this.prev,n=this.position,i=this.velocity;if(e.set(n.x,n.y),!this.moves)return this._dx=n.x-e.x,void(this._dy=n.y-e.y);if(this.directControl){var r=this.autoFrame;i.set((n.x-r.x)/t,(n.y-r.y)/t),this.world.updateMotion(this,t),this._dx=n.x-r.x,this._dy=n.y-r.y}else this.world.updateMotion(this,t),this.newVelocity.set(i.x*t,i.y*t),n.add(this.newVelocity),this._dx=n.x-e.x,this._dy=n.y-e.y;var s=i.x,a=i.y;if(this.updateCenter(),this.angle=Math.atan2(a,s),this.speed=Math.sqrt(s*s+a*a),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds){var c=this.blocked;this.world.emit(o.WORLD_BOUNDS,this,c.up,c.down,c.left,c.right)}},postUpdate:function(){var t=this.position,e=t.x-this.prevFrame.x,n=t.y-this.prevFrame.y,i=this.gameObject;if(this.moves){var r=this.deltaMax.x,o=this.deltaMax.y;0!==r&&0!==e&&(e<0&&e<-r?e=-r:e>0&&e>r&&(e=r)),0!==o&&0!==n&&(n<0&&n<-o?n=-o:n>0&&n>o&&(n=o)),i&&(i.x+=e,i.y+=n)}e<0?this.facing=s.FACING_LEFT:e>0&&(this.facing=s.FACING_RIGHT),n<0?this.facing=s.FACING_UP:n>0&&(this.facing=s.FACING_DOWN),this.allowRotation&&i&&(i.angle+=this.deltaZ()),this._tx=e,this._ty=n,this.autoFrame.set(t.x,t.y)},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.velocity,n=this.blocked,i=this.customBoundsRectangle,r=this.world.checkCollision,s=this.worldBounce?-this.worldBounce.x:-this.bounce.x,o=this.worldBounce?-this.worldBounce.y:-this.bounce.y,a=!1;return t.x<i.x&&r.left?(t.x=i.x,e.x*=s,n.left=!0,a=!0):this.right>i.right&&r.right&&(t.x=i.right-this.width,e.x*=s,n.right=!0,a=!0),t.y<i.y&&r.up?(t.y=i.y,e.y*=o,n.up=!0,a=!0):this.bottom>i.bottom&&r.down&&(t.y=i.bottom-this.height,e.y*=o,n.down=!0,a=!0),a&&(this.blocked.none=!1,this.updateCenter()),a},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this},setGameObject:function(t,e){return void 0===e&&(e=!0),this.world.remove(this),this.gameObject&&this.gameObject.body&&(this.gameObject.body=null),this.gameObject=t,t.body&&(t.body=this),this.setSize(),this.world.add(this),this.enable=e,this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;if(i&&(!t&&i.frame&&(t=i.frame.realWidth),!e&&i.frame&&(e=i.frame.realHeight)),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),n&&i&&i.getCenter){var r=(i.width-t)/2,s=(i.height-e)/2;this.offset.set(r,s)}return this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var n=this.gameObject;n&&(n.setPosition(t,e),this.rotation=n.angle,this.preRotation=n.angle);var i=this.position;n&&n.getTopLeft?n.getTopLeft(i):i.set(t,e),this.prev.copy(i),this.prevFrame.copy(i),this.autoFrame.copy(i),n&&this.updateBounds(),this.updateCenter(),this.collideWorldBounds&&this.checkWorldBounds(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:l(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(n,i,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(n,i,n+this.velocity.x/2,i+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setDirectControl:function(t){return void 0===t&&(t=!0),this.directControl=t,this},setCollideWorldBounds:function(t,e,n,i){void 0===t&&(t=!0),this.collideWorldBounds=t;var r=void 0!==e,s=void 0!==n;return(r||s)&&(this.worldBounce||(this.worldBounce=new h),r&&(this.worldBounce.x=e),s&&(this.worldBounce.y=n)),void 0!==i&&(this.onWorldBounds=i),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){return this.setVelocity(t,this.velocity.y)},setVelocityY:function(t){return this.setVelocity(this.velocity.x,t)},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxVelocityX:function(t){return this.maxVelocity.x=t,this},setMaxVelocityY:function(t){return this.maxVelocity.y=t,this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setSlideFactor:function(t,e){return this.slideFactor.set(t,e),this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDamping:function(t){return this.useDamping=t,this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},processX:function(t,e,n,i){this.x+=t,this.updateCenter(),null!==e&&(this.velocity.x=e*this.slideFactor.x);var r=this.blocked;n&&(r.left=!0,r.none=!1),i&&(r.right=!0,r.none=!1)},processY:function(t,e,n,i){this.y+=t,this.updateCenter(),null!==e&&(this.velocity.y=e*this.slideFactor.y);var r=this.blocked;n&&(r.up=!0,r.none=!1),i&&(r.down=!0,r.none=!1)},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=d},3909:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i,r,s,o){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=n,this.object2=i,this.collideCallback=r,this.processCallback=s,this.callbackContext=o},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});t.exports=i},99523:(t,e,n)=>{var i=n(62832),r=n(25084),s=n(97602),o=n(56694),a=n(47401),c=n(10481),l=n(66634),u=n(46346),h=new o({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,n,i,r){return this.world.addCollider(t,e,n,i,r)},overlap:function(t,e,n,i,r){return this.world.addOverlap(t,e,n,i,r)},existing:function(t,e){var n=e?a.STATIC_BODY:a.DYNAMIC_BODY;return this.world.enableBody(t,n),t},staticImage:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,a.STATIC_BODY),s},image:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,a.DYNAMIC_BODY),s},staticSprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,a.STATIC_BODY),s},sprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,a.DYNAMIC_BODY),s},staticGroup:function(t,e){return this.sys.updateList.add(new u(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new c(this.world,this.world.scene,t,e))},body:function(t,e,n,i){var r=new s(this.world);return r.position.set(t,e),n&&i&&r.setSize(n,i),this.world.add(r,a.DYNAMIC_BODY),r},staticBody:function(t,e,n,i){var r=new l(this.world);return r.position.set(t,e),n&&i&&r.setSize(n,i),this.world.add(r,a.STATIC_BODY),r},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=h},44880:t=>{t.exports=function(t){var e=0;if(Array.isArray(t))for(var n=0;n<t.length;n++)e|=t[n];else e=t;return e}},75671:(t,e,n)=>{var i=n(47401);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsX()+e.deltaAbsX()+r;return 0===t._dx&&0===e._dx?(t.embedded=!0,e.embedded=!0):t._dx>e._dx?(s=t.right-e.x)>o&&!n||!1===t.checkCollision.right||!1===e.checkCollision.left?s=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.right=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.left=!0)):t._dx<e._dx&&(-(s=t.x-e.width-e.x)>o&&!n||!1===t.checkCollision.left||!1===e.checkCollision.right?s=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.left=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.right=!0))),t.overlapX=s,e.overlapX=s,s}},66185:(t,e,n)=>{var i=n(47401);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsY()+e.deltaAbsY()+r;return 0===t._dy&&0===e._dy?(t.embedded=!0,e.embedded=!0):t._dy>e._dy?(s=t.bottom-e.y)>o&&!n||!1===t.checkCollision.down||!1===e.checkCollision.up?s=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.down=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.up=!0)):t._dy<e._dy&&(-(s=t.y-e.bottom)>o&&!n||!1===t.checkCollision.up||!1===e.checkCollision.down?s=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0,e.physicsType!==i.STATIC_BODY||n||(t.blocked.none=!1,t.blocked.up=!0),t.physicsType!==i.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.down=!0))),t.overlapY=s,e.overlapY=s,s}},10481:(t,e,n)=>{var i=n(25084),r=n(56694),s=n(95239),o=n(47401),a=n(72632),c=n(59192),l=n(42911),u=new r({Extends:c,Mixins:[s],initialize:function(t,e,n,r){if(n||r)if(l(n))r=n,n=null,r.internalCreateCallback=this.createCallbackHandler,r.internalRemoveCallback=this.removeCallbackHandler;else if(Array.isArray(n)&&l(n[0])){var s=this;n.forEach((function(t){t.internalCreateCallback=s.createCallbackHandler,t.internalRemoveCallback=s.removeCallbackHandler,t.classType=a(t,"classType",i)})),r=null}else r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};else r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};this.world=t,r&&(r.classType=a(r,"classType",i)),this.physicsType=o.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=1,this.defaults={setCollideWorldBounds:a(r,"collideWorldBounds",!1),setBoundsRectangle:a(r,"customBoundsRectangle",null),setAccelerationX:a(r,"accelerationX",0),setAccelerationY:a(r,"accelerationY",0),setAllowDrag:a(r,"allowDrag",!0),setAllowGravity:a(r,"allowGravity",!0),setAllowRotation:a(r,"allowRotation",!0),setDamping:a(r,"useDamping",!1),setBounceX:a(r,"bounceX",0),setBounceY:a(r,"bounceY",0),setDragX:a(r,"dragX",0),setDragY:a(r,"dragY",0),setEnable:a(r,"enable",!0),setGravityX:a(r,"gravityX",0),setGravityY:a(r,"gravityY",0),setFrictionX:a(r,"frictionX",0),setFrictionY:a(r,"frictionY",0),setMaxSpeed:a(r,"maxSpeed",-1),setMaxVelocityX:a(r,"maxVelocityX",1e4),setMaxVelocityY:a(r,"maxVelocityY",1e4),setVelocityX:a(r,"velocityX",0),setVelocityY:a(r,"velocityY",0),setAngularVelocity:a(r,"angularVelocity",0),setAngularAcceleration:a(r,"angularAcceleration",0),setAngularDrag:a(r,"angularDrag",0),setMass:a(r,"mass",1),setImmovable:a(r,"immovable",!1)},c.call(this,e,n,r),this.type="PhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,o.DYNAMIC_BODY);var e=t.body;for(var n in this.defaults)e[n](this.defaults[n])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,n){void 0===n&&(n=0);for(var i=this.getChildren(),r=0;r<i.length;r++)i[r].body.velocity.set(t+r*n,e+r*n);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.x=t+i*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.y=t+i*e;return this}});t.exports=u},22916:t=>{var e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y=function(){return u&&m&&n.blocked.right?(e.processX(-v,a,!1,!0),1):l&&g&&n.blocked.left?(e.processX(v,a,!0),1):p&&g&&e.blocked.right?(n.processX(-v,c,!1,!0),2):d&&m&&e.blocked.left?(n.processX(v,c,!0),2):0},x=function(t){if(i&&r)v*=.5,0===t||3===t?(e.processX(v,s),n.processX(-v,o)):(e.processX(-v,s),n.processX(v,o));else if(i&&!r)0===t||3===t?e.processX(v,a,!0):e.processX(-v,a,!1,!0);else if(!i&&r)0===t||3===t?n.processX(-v,c,!1,!0):n.processX(v,c,!0);else{var m=.5*v;0===t?f?(e.processX(v,0,!0),n.processX(0,null,!1,!0)):p?(e.processX(m,0,!0),n.processX(-m,0,!1,!0)):(e.processX(m,n.velocity.x,!0),n.processX(-m,null,!1,!0)):1===t?h?(e.processX(0,null,!1,!0),n.processX(v,0,!0)):u?(e.processX(-m,0,!1,!0),n.processX(m,0,!0)):(e.processX(-m,null,!1,!0),n.processX(m,e.velocity.x,!0)):2===t?f?(e.processX(-v,0,!1,!0),n.processX(0,null,!0)):d?(e.processX(-m,0,!1,!0),n.processX(m,0,!0)):(e.processX(-m,n.velocity.x,!1,!0),n.processX(m,null,!0)):3===t&&(h?(e.processX(0,null,!0),n.processX(-v,0,!1,!0)):l?(e.processX(m,0,!0),n.processX(-m,0,!1,!0)):(e.processX(m,n.velocity.y,!0),n.processX(-m,null,!1,!0)))}return!0};t.exports={BlockCheck:y,Check:function(){var t=e.velocity.x,i=n.velocity.x,r=Math.sqrt(i*i*n.mass/e.mass)*(i>0?1:-1),a=Math.sqrt(t*t*e.mass/n.mass)*(t>0?1:-1),c=.5*(r+a);return a-=c,s=c+(r-=c)*e.bounce.x,o=c+a*n.bounce.x,l&&g?x(0):d&&m?x(1):u&&m?x(2):!(!p||!g)&&x(3)},Set:function(t,s,o){n=s;var x=(e=t).velocity.x,b=n.velocity.x;return i=e.pushable,l=e._dx<0,u=e._dx>0,h=0===e._dx,m=Math.abs(e.right-n.x)<=Math.abs(n.right-e.x),a=b-x*e.bounce.x,r=n.pushable,d=n._dx<0,p=n._dx>0,f=0===n._dx,g=!m,c=x-b*n.bounce.x,v=Math.abs(o),y()},Run:x,RunImmovableBody1:function(t){1===t?n.velocity.x=0:m?n.processX(v,c,!0):n.processX(-v,c,!1,!0),e.moves&&(n.y+=(e.y-e.prev.y)*e.friction.y,n._dy=n.y-n.prev.y)},RunImmovableBody2:function(t){2===t?e.velocity.x=0:g?e.processX(v,a,!0):e.processX(-v,a,!1,!0),n.moves&&(e.y+=(n.y-n.prev.y)*n.friction.y,e._dy=e.y-e.prev.y)}}},67050:t=>{var e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y=function(){return u&&m&&n.blocked.down?(e.processY(-v,a,!1,!0),1):l&&g&&n.blocked.up?(e.processY(v,a,!0),1):p&&g&&e.blocked.down?(n.processY(-v,c,!1,!0),2):d&&m&&e.blocked.up?(n.processY(v,c,!0),2):0},x=function(t){if(i&&r)v*=.5,0===t||3===t?(e.processY(v,s),n.processY(-v,o)):(e.processY(-v,s),n.processY(v,o));else if(i&&!r)0===t||3===t?e.processY(v,a,!0):e.processY(-v,a,!1,!0);else if(!i&&r)0===t||3===t?n.processY(-v,c,!1,!0):n.processY(v,c,!0);else{var m=.5*v;0===t?f?(e.processY(v,0,!0),n.processY(0,null,!1,!0)):p?(e.processY(m,0,!0),n.processY(-m,0,!1,!0)):(e.processY(m,n.velocity.y,!0),n.processY(-m,null,!1,!0)):1===t?h?(e.processY(0,null,!1,!0),n.processY(v,0,!0)):u?(e.processY(-m,0,!1,!0),n.processY(m,0,!0)):(e.processY(-m,null,!1,!0),n.processY(m,e.velocity.y,!0)):2===t?f?(e.processY(-v,0,!1,!0),n.processY(0,null,!0)):d?(e.processY(-m,0,!1,!0),n.processY(m,0,!0)):(e.processY(-m,n.velocity.y,!1,!0),n.processY(m,null,!0)):3===t&&(h?(e.processY(0,null,!0),n.processY(-v,0,!1,!0)):l?(e.processY(m,0,!0),n.processY(-m,0,!1,!0)):(e.processY(m,n.velocity.y,!0),n.processY(-m,null,!1,!0)))}return!0};t.exports={BlockCheck:y,Check:function(){var t=e.velocity.y,i=n.velocity.y,r=Math.sqrt(i*i*n.mass/e.mass)*(i>0?1:-1),a=Math.sqrt(t*t*e.mass/n.mass)*(t>0?1:-1),c=.5*(r+a);return a-=c,s=c+(r-=c)*e.bounce.y,o=c+a*n.bounce.y,l&&g?x(0):d&&m?x(1):u&&m?x(2):!(!p||!g)&&x(3)},Set:function(t,s,o){n=s;var x=(e=t).velocity.y,b=n.velocity.y;return i=e.pushable,l=e._dy<0,u=e._dy>0,h=0===e._dy,m=Math.abs(e.bottom-n.y)<=Math.abs(n.bottom-e.y),a=b-x*e.bounce.y,r=n.pushable,d=n._dy<0,p=n._dy>0,f=0===n._dy,g=!m,c=x-b*n.bounce.y,v=Math.abs(o),y()},Run:x,RunImmovableBody1:function(t){1===t?n.velocity.y=0:m?n.processY(v,c,!0):n.processY(-v,c,!1,!0),e.moves&&(n.x+=(e.x-e.prev.x)*e.friction.x,n._dx=n.x-n.prev.x)},RunImmovableBody2:function(t){2===t?e.velocity.y=0:g?e.processY(v,a,!0):e.processY(-v,a,!1,!0),n.moves&&(e.x+=(n.x-n.prev.x)*n.friction.x,e._dx=e.x-e.prev.x)}}},61777:(t,e,n)=>{var i=n(75671),r=n(22916);t.exports=function(t,e,n,s,o){void 0===o&&(o=i(t,e,n,s));var a=t.immovable,c=e.immovable;if(n||0===o||a&&c||t.customSeparateX||e.customSeparateX)return 0!==o||t.embedded&&e.embedded;var l=r.Set(t,e,o);return a||c?(a?r.RunImmovableBody1(l):c&&r.RunImmovableBody2(l),!0):l>0||r.Check()}},25299:(t,e,n)=>{var i=n(66185),r=n(67050);t.exports=function(t,e,n,s,o){void 0===o&&(o=i(t,e,n,s));var a=t.immovable,c=e.immovable;if(n||0===o||a&&c||t.customSeparateY||e.customSeparateY)return 0!==o||t.embedded&&e.embedded;var l=r.Set(t,e,o);return a||c?(a?r.RunImmovableBody1(l):c&&r.RunImmovableBody2(l),!0):l>0||r.Check()}},15084:t=>{t.exports=function(t,e){return void 0===e&&(e={}),e.none=t,e.up=!1,e.down=!1,e.left=!1,e.right=!1,t||(e.up=!0,e.down=!0,e.left=!0,e.right=!0),e}},66634:(t,e,n)=>{var i=n(65650),r=n(56694),s=n(95239),o=n(47401),a=n(94287),c=n(15084),l=n(93736),u=new r({Mixins:[s],initialize:function(t,e){var n=64,i=64,r=void 0!==e;r&&e.displayWidth&&(n=e.displayWidth,i=e.displayHeight),r||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=r?e:void 0,this.isBody=!0,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new l,this.position=new l(e.x-n*e.originX,e.y-i*e.originY),this.width=n,this.height=i,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new l(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=l.ZERO,this.allowGravity=!1,this.gravity=l.ZERO,this.bounce=l.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=c(!1),this.touching=c(!0),this.wasTouching=c(!0),this.blocked=c(!0),this.physicsType=o.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._dx=0,this._dy=0},setGameObject:function(t,e){return t&&t!==this.gameObject&&(this.gameObject.body=null,t.body=this,this.gameObject=t),e&&this.updateFromGameObject(),this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;if(i&&i.frame&&(t||(t=i.frame.realWidth),e||(e=i.frame.realHeight)),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),n&&i&&i.getCenter){var r=i.displayWidth/2,s=i.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(r-this.halfWidth,s-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var n=this.gameObject;void 0===t&&(t=n.x),void 0===e&&(e=n.y),this.world.staticTree.remove(this),n.setPosition(t,e),n.getTopLeft(this.position),this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?i(this,t,e):a(this,t,e)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(n,i,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=u},46346:(t,e,n)=>{var i=n(25084),r=n(56694),s=n(95239),o=n(47401),a=n(72632),c=n(59192),l=n(42911),u=new r({Extends:c,Mixins:[s],initialize:function(t,e,n,r){n||r?l(n)?(r=n,n=null,r.internalCreateCallback=this.createCallbackHandler,r.internalRemoveCallback=this.removeCallbackHandler,r.createMultipleCallback=this.createMultipleCallbackHandler,r.classType=a(r,"classType",i)):Array.isArray(n)&&l(n[0])?(r=n,n=null,r.forEach((function(t){t.internalCreateCallback=this.createCallbackHandler,t.internalRemoveCallback=this.removeCallbackHandler,t.createMultipleCallback=this.createMultipleCallbackHandler,t.classType=a(t,"classType",i)}))):r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:r={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:i},this.world=t,this.physicsType=o.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,c.call(this,e,n,r),this.type="StaticPhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,o.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});t.exports=u},85233:(t,e,n)=>{var i=n(94240),r=n(97602),s=n(82897),o=n(56694),a=n(3909),c=n(47401),l=n(53996),u=n(92951),h=n(6659),d=n(27037),p=n(88456),f=n(41935),m=n(54726),g=n(75671),v=n(66185),y=n(44662),x=n(10850),b=n(83392),w=n(74623),S=n(25163),_=n(74118),T=n(68687),E=n(27354),C=n(61777),k=n(25299),A=n(58403),I=n(66634),O=n(28808),R=n(69360),N=n(93736),M=n(1071),D=new o({Extends:h,initialize:function(t,e){h.call(this),this.scene=t,this.bodies=new A,this.staticBodies=new A,this.pendingDestroy=new A,this.colliders=new w,this.gravity=new N(x(e,"gravity.x",0),x(e,"gravity.y",0)),this.bounds=new _(x(e,"x",0),x(e,"y",0),x(e,"width",t.sys.scale.width),x(e,"height",t.sys.scale.height)),this.checkCollision={up:x(e,"checkCollision.up",!0),down:x(e,"checkCollision.down",!0),left:x(e,"checkCollision.left",!0),right:x(e,"checkCollision.right",!0)},this.fps=x(e,"fps",60),this.fixedStep=x(e,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=x(e,"timeScale",1),this.OVERLAP_BIAS=x(e,"overlapBias",4),this.TILE_BIAS=x(e,"tileBias",16),this.forceX=x(e,"forceX",!1),this.isPaused=x(e,"isPaused",!1),this._total=0,this.drawDebug=x(e,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:x(e,"debugShowBody",!0),debugShowStaticBody:x(e,"debugShowStaticBody",!0),debugShowVelocity:x(e,"debugShowVelocity",!0),bodyDebugColor:x(e,"debugBodyColor",16711935),staticBodyDebugColor:x(e,"debugStaticBodyColor",255),velocityDebugColor:x(e,"debugVelocityColor",65280)},this.maxEntries=x(e,"maxEntries",16),this.useTree=x(e,"useTree",!0),this.tree=new T(this.maxEntries),this.staticTree=new T(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new R,this._tempMatrix2=new R,this.tileFilterOptions={isColliding:!0,isNotEmpty:!0,hasInterestingFace:!0},this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=c.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.isParent)for(var r=i.getChildren(),s=0;s<r.length;s++){var o=r[s];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(i,e)}},enableBody:function(t,e){return void 0===e&&(e=c.DYNAMIC_BODY),t.hasTransformComponent&&(t.body||(e===c.DYNAMIC_BODY?t.body=new r(this,t):e===c.STATIC_BODY&&(t.body=new I(this,t))),this.add(t.body)),t},add:function(t){return t.physicsType===c.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===c.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];if(n.isParent)for(var i=n.getChildren(),r=0;r<i.length;r++){var s=i[r];s.isParent?this.disable(s):this.disableBody(s.body)}else this.disableBody(n.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===c.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===c.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,n,i,r,s,o,a){return this.bounds.setTo(t,e,n,i),void 0!==r&&this.setBoundsCollision(r,s,o,a),this},setBoundsCollision:function(t,e,n,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=n,this.checkCollision.down=i,this},pause:function(){return this.isPaused=!0,this.emit(d.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(d.RESUME),this},addCollider:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new a(this,!1,t,e,n,i,r);return this.colliders.add(s),s},addOverlap:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new a(this,!0,t,e,n,i,r);return this.colliders.add(s),s},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var n,i,r=this._frameTime,s=this._frameTimeMS*this.timeScale;this._elapsed+=e;var o=this.bodies.entries,a=this._elapsed>=s;for(this.fixedStep||(r=.001*e,a=!0,this._elapsed=0),n=0;n<o.length;n++)(i=o[n]).enable&&i.preUpdate(a,r);if(a){this._elapsed-=s,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(o));var c=this.colliders.update();for(n=0;n<c.length;n++){var l=c[n];l.active&&l.update()}this.emit(d.WORLD_STEP,r)}for(;this._elapsed>=s;)this._elapsed-=s,this.step(r)}},step:function(t){var e,n,i=this.bodies.entries,r=i.length;for(e=0;e<r;e++)(n=i[e]).enable&&n.update(t);this.useTree&&(this.tree.clear(),this.tree.load(i));var s=this.colliders.update();for(e=0;e<s.length;e++){var o=s[e];o.active&&o.update()}this.emit(d.WORLD_STEP,t),this.stepsLastFrame++},singleStep:function(){this.update(0,this._frameTimeMS),this.postUpdate()},postUpdate:function(){var t,e,n=this.bodies.entries,i=n.length,r=this.bodies,s=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<i;t++)(e=n[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o);for(i=(n=s.entries).length,t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o)}var a=this.pendingDestroy;if(a.size>0){var l=this.tree,u=this.staticTree;for(i=(n=a.entries).length,t=0;t<i;t++)(e=n[t]).physicsType===c.DYNAMIC_BODY?(l.remove(e),r.delete(e)):e.physicsType===c.STATIC_BODY&&(u.remove(e),s.delete(e)),e.world=void 0,e.gameObject=void 0;a.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,i=t.angularAcceleration,r=t.angularDrag,o=t.maxAngular;i?n+=i*e:t.allowDrag&&r&&(f(n-(r*=e),0,.1)?n-=r:m(n+r,0,.1)?n+=r:n=0);var a=(n=s(n,-o,o))-t.angularVelocity;t.angularVelocity+=a,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,i=t.acceleration.x,r=t.drag.x,o=t.maxVelocity.x,a=t.velocity.y,c=t.acceleration.y,l=t.drag.y,u=t.maxVelocity.y,h=t.speed,d=t.maxSpeed,g=t.allowDrag,v=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,a+=(this.gravity.y+t.gravity.y)*e),i?n+=i*e:g&&r&&(v?(n*=r=Math.pow(r,e),h=Math.sqrt(n*n+a*a),p(h,0,.001)&&(n=0)):f(n-(r*=e),0,.01)?n-=r:m(n+r,0,.01)?n+=r:n=0),c?a+=c*e:g&&l&&(v?(a*=l=Math.pow(l,e),h=Math.sqrt(n*n+a*a),p(h,0,.001)&&(a=0)):f(a-(l*=e),0,.01)?a-=l:m(a+l,0,.01)?a+=l:a=0),n=s(n,-o,o),a=s(a,-u,u),t.velocity.set(n,a),d>-1&&t.velocity.length()>d&&(t.velocity.normalize().scale(d),h=d),t.speed=h},separate:function(t,e,n,i,r){var s,o,a=!1,c=!0;if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e))return a;if(n&&!1===n.call(i,t.gameObject,e.gameObject))return a;if(t.isCircle||e.isCircle){var l=this.separateCircle(t,e,r);l.result?(a=!0,c=!1):(s=l.x,o=l.y,c=!0)}if(c){var u=!1,h=!1,p=this.OVERLAP_BIAS;r?(u=C(t,e,r,p,s),h=k(t,e,r,p,o)):this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(u=C(t,e,r,p,s),this.intersects(t,e)&&(h=k(t,e,r,p,o))):(h=k(t,e,r,p,o),this.intersects(t,e)&&(u=C(t,e,r,p,s))),a=u||h}return a&&(r?(t.onOverlap||e.onOverlap)&&this.emit(d.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(d.COLLIDE,t.gameObject,e.gameObject,t,e)),a},separateCircle:function(t,e,n){g(t,e,!1,0),v(t,e,!1,0);var r=t.isCircle,s=e.isCircle,o=t.center,a=e.center,c=t.immovable,h=e.immovable,d=t.velocity,p=e.velocity,f=0,m=!0;if(r!==s){m=!1;var y=o.x,x=o.y,w=t.halfWidth,S=e.position.x,_=e.position.y,T=e.right,E=e.bottom;s&&(y=a.x,x=a.y,w=e.halfWidth,S=t.position.x,_=t.position.y,T=t.right,E=t.bottom),x<_?y<S?f=l(y,x,S,_)-w:y>T&&(f=l(y,x,T,_)-w):x>E&&(y<S?f=l(y,x,S,E)-w:y>T&&(f=l(y,x,T,E)-w)),f*=-1}else f=t.halfWidth+e.halfWidth-u(o,a);t.overlapR=f,e.overlapR=f;var C=i(o,a),k=(f+b.EPSILON)*Math.cos(C),A=(f+b.EPSILON)*Math.sin(C),I={overlap:f,result:!1,x:k,y:A};if(n&&(!m||m&&0!==f))return I.result=!0,I;if(!m&&0===f||c&&h||t.customSeparateX||e.customSeparateX)return I.x=void 0,I.y=void 0,I;var O=!t.pushable&&!e.pushable;if(m){var R=o.x-a.x,N=o.y-a.y,M=Math.sqrt(Math.pow(R,2)+Math.pow(N,2)),D=(a.x-o.x)/M||0,P=(a.y-o.y)/M||0,F=2*(d.x*D+d.y*P-p.x*D-p.y*P)/(t.mass+e.mass);(c||h)&&(F*=2),c||(d.x=d.x-F/t.mass*D,d.y=d.y-F/t.mass*P,d.multiply(t.bounce)),h||(p.x=p.x+F/e.mass*D,p.y=p.y+F/e.mass*P,p.multiply(e.bounce)),c||h||(k*=.5,A*=.5),c||(t.x-=k,t.y-=A,t.updateCenter()),h||(e.x+=k,e.y+=A,e.updateCenter()),I.result=!0}else!c||t.pushable||O?(t.x-=k,t.y-=A,t.updateCenter()):(!h||e.pushable||O)&&(e.x+=k,e.y+=A,e.updateCenter()),I.x=void 0,I.y=void 0;return I},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?u(t.center,e.center)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.left||t.bottom<=e.top||t.left>=e.right||t.top>=e.bottom))},circleBodyIntersects:function(t,e){var n=s(t.center.x,e.left,e.right),i=s(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-i)*(t.center.y-i)<=t.halfWidth*t.halfWidth},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!1)},collideObjects:function(t,e,n,i,r,s){var o,a;!t.isParent||void 0!==t.physicsType&&void 0!==e&&t!==e||(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var c=Array.isArray(t),l=Array.isArray(e);if(this._total=0,c||l)if(!c&&l)for(o=0;o<e.length;o++)this.collideHandler(t,e[o],n,i,r,s);else if(c&&!l)if(e)for(o=0;o<t.length;o++)this.collideHandler(t[o],e,n,i,r,s);else for(o=0;o<t.length;o++){var u=t[o];for(a=o+1;a<t.length;a++)o!==a&&this.collideHandler(u,t[a],n,i,r,s)}else for(o=0;o<t.length;o++)for(a=0;a<e.length;a++)this.collideHandler(t[o],e[a],n,i,r,s);else this.collideHandler(t,e,n,i,r,s);return this._total>0},collideHandler:function(t,e,n,i,r,s){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,n,i,r,s);if(!t||!e)return!1;if(t.body||t.isBody){if(e.body||e.isBody)return this.collideSpriteVsSprite(t,e,n,i,r,s);if(e.isParent)return this.collideSpriteVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,n,i,r,s)}else if(t.isParent){if(e.body||e.isBody)return this.collideSpriteVsGroup(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,n,i,r,s)}else if(t.isTilemap){if(e.body||e.isBody)return this.collideSpriteVsTilemapLayer(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,n,i,r,s)}},canCollide:function(t,e){return t&&e&&0!==(t.collisionMask&e.collisionCategory)&&0!==(e.collisionMask&t.collisionCategory)},collideSpriteVsSprite:function(t,e,n,i,r,s){var o=t.isBody?t:t.body,a=e.isBody?e:e.body;return!!this.canCollide(o,a)&&(this.separate(o,a,i,r,s)&&(n&&n.call(r,t,e),this._total++),!0)},collideSpriteVsGroup:function(t,e,n,i,r,s){var o,a,l,u=t.isBody?t:t.body;if(0!==e.length&&u&&u.enable&&!u.checkCollision.none&&this.canCollide(u,e))if(this.useTree||e.physicsType===c.STATIC_BODY){var h=this.treeMinMax;h.minX=u.left,h.minY=u.top,h.maxX=u.right,h.maxY=u.bottom;var d=e.physicsType===c.DYNAMIC_BODY?this.tree.search(h):this.staticTree.search(h);for(a=d.length,o=0;o<a;o++)u!==(l=d[o])&&l.enable&&!l.checkCollision.none&&e.contains(l.gameObject)&&this.separate(u,l,i,r,s)&&(n&&n.call(r,u.gameObject,l.gameObject),this._total++)}else{var p=e.getChildren(),f=e.children.entries.indexOf(t);for(a=p.length,o=0;o<a;o++)(l=p[o].body)&&o!==f&&l.enable&&this.separate(u,l,i,r,s)&&(n&&n.call(r,u.gameObject,l.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,n,i,r,s){if(!this.canCollide(t,e))return!1;var o=t.getChildren();if(0===o.length)return!1;for(var a=!1,c=0;c<o.length;c++)(o[c].body||o[c].isBody)&&this.collideSpriteVsTilemapLayer(o[c],e,n,i,r,s)&&(a=!0);return a},collideTiles:function(t,e,n,i,r){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!1,!1)},overlapTiles:function(t,e,n,i,r){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,n,i,r,s){var o=t.isBody?t:t.body;if(!o.enable||o.checkCollision.none||!this.canCollide(o,e))return!1;var a=o.x,c=o.y,l=o.width,u=o.height,h=e.layer;if(h.tileWidth>h.baseTileWidth){var d=(h.tileWidth-h.baseTileWidth)*e.scaleX;a-=d,l+=d}h.tileHeight>h.baseTileHeight&&(u+=(h.tileHeight-h.baseTileHeight)*e.scaleY);var p=s?null:this.tileFilterOptions,f=y(a,c,l,u,p,e.scene.cameras.main,e.layer);return 0!==f.length&&this.collideSpriteVsTilesHandler(t,f,n,i,r,s,!0)},collideSpriteVsTilesHandler:function(t,e,n,i,r,s,o){for(var a,c,l=t.isBody?t:t.body,u={left:0,right:0,top:0,bottom:0},h=!1,p=0;p<e.length;p++){var f=(c=(a=e[p]).tilemapLayer).tileToWorldXY(a.x,a.y);u.left=f.x,u.top=f.y,a.baseHeight!==a.height&&(u.top-=(a.height-a.baseHeight)*c.scaleY),u.right=u.left+a.width*c.scaleX,u.bottom=u.top+a.height*c.scaleY,O(u,l)&&(!i||i.call(r,t,a))&&S(a,t)&&(s||E(p,l,a,u,c,this.TILE_BIAS,o))&&(this._total++,h=!0,n&&n.call(r,t,a),s&&l.onOverlap?this.emit(d.TILE_OVERLAP,t,a,l):l.onCollide&&this.emit(d.TILE_COLLIDE,t,a,l))}return h},collideGroupVsGroup:function(t,e,n,i,r,s){if(0!==t.length&&0!==e.length&&this.canCollide(t,e))for(var o=t.getChildren(),a=0;a<o.length;a++)this.collideSpriteVsGroup(o[a],e,n,i,r,s)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var n=0;n<t.length;n++)this.wrapObject(t[n],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=M(t.x,this.bounds.left-e,this.bounds.right+e),t.y=M(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null,this.debugGraphic&&(this.debugGraphic.destroy(),this.debugGraphic=null)}});t.exports=D},5321:t=>{t.exports={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}},29257:t=>{t.exports={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}},62122:t=>{t.exports={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,n,i){return this.body.setCollideWorldBounds(t,e,n,i),this}}},95239:(t,e,n)=>{var i=n(44880),r={setCollisionCategory:function(t){return(this.body?this.body:this).collisionCategory=t,this},willCollideWith:function(t){return 0!==((this.body?this.body:this).collisionMask&t)},addCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask|t,this},removeCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask&~t,this},setCollidesWith:function(t){return(this.body?this.body:this).collisionMask=i(t),this},resetCollisionCategory:function(){var t=this.body?this.body:this;return t.collisionCategory=1,t.collisionMask=1,this}};t.exports=r},99803:t=>{t.exports={setDebug:function(t,e,n){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=n,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}},87145:t=>{t.exports={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}},96174:t=>{var e={setDirectControl:function(t){return this.body.setDirectControl(t),this},enableBody:function(t,e,n,i,r){return t&&this.body.reset(e,n),i&&(this.body.gameObject.active=!0),r&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}};t.exports=e},51702:t=>{t.exports={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}},25578:t=>{t.exports={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}},72029:t=>{var e={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}};t.exports=e},34566:t=>{t.exports={setMass:function(t){return this.body.mass=t,this}}},2732:(t,e,n)=>{var i=n(15147),r=n(26673),s=n(22184),o=n(26535);t.exports=function(t,e,n,a,c,l){var u=i(t,e-a,n-a,2*a,2*a,c,l);if(0===u.length)return u;for(var h=new r(e,n,a),d=new r,p=[],f=0;f<u.length;f++){var m=u[f];m.isCircle?(d.setTo(m.center.x,m.center.y,m.halfWidth),s(h,d)&&p.push(m)):o(h,m)&&p.push(m)}return p}},15147:t=>{t.exports=function(t,e,n,i,r,s,o){void 0===s&&(s=!0),void 0===o&&(o=!1);var a=[],c=[],l=t.treeMinMax;if(l.minX=e,l.minY=n,l.maxX=e+i,l.maxY=n+r,o&&(c=t.staticTree.search(l)),s&&t.useTree)a=t.tree.search(l);else if(s){var u=t.bodies,h={position:{x:e,y:n},left:e,top:n,right:e+i,bottom:n+r,isCircle:!1},d=t.intersects;u.iterate((function(t){d(t,h)&&a.push(t)}))}return c.concat(a)}},57527:t=>{var e={setPushable:function(t){return void 0===t&&(t=!0),this.body.pushable=t,this}};t.exports=e},77687:t=>{t.exports={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,n){return this.body.setSize(t,e,n),this},setBodySize:function(t,e,n){return this.body.setSize(t,e,n),this},setCircle:function(t,e,n){return this.body.setCircle(t,e,n),this}}},66536:t=>{t.exports={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}}},7864:(t,e,n)=>{t.exports={Acceleration:n(5321),Angular:n(29257),Bounce:n(62122),Collision:n(95239),Debug:n(99803),Drag:n(87145),Enable:n(96174),Friction:n(51702),Gravity:n(25578),Immovable:n(72029),Mass:n(34566),OverlapCirc:n(2732),OverlapRect:n(15147),Pushable:n(57527),Size:n(77687),Velocity:n(66536)}},47401:t=>{t.exports={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14}},22346:t=>{t.exports="collide"},95092:t=>{t.exports="overlap"},15775:t=>{t.exports="pause"},74142:t=>{t.exports="resume"},22825:t=>{t.exports="tilecollide"},10851:t=>{t.exports="tileoverlap"},7543:t=>{t.exports="worldbounds"},1487:t=>{t.exports="worldstep"},27037:(t,e,n)=>{t.exports={COLLIDE:n(22346),OVERLAP:n(95092),PAUSE:n(15775),RESUME:n(74142),TILE_COLLIDE:n(22825),TILE_OVERLAP:n(10851),WORLD_BOUNDS:n(7543),WORLD_STEP:n(1487)}},39977:(t,e,n)=>{var i=n(47401),r=n(98611),s={ArcadePhysics:n(66150),Body:n(97602),Collider:n(3909),Components:n(7864),Events:n(27037),Factory:n(99523),GetCollidesWith:n(44880),GetOverlapX:n(75671),GetOverlapY:n(66185),SeparateX:n(61777),SeparateY:n(25299),Group:n(10481),Image:n(62832),Sprite:n(25084),StaticBody:n(66634),StaticGroup:n(46346),Tilemap:n(8413),World:n(85233)};s=r(!1,s,i),t.exports=s},25163:t=>{t.exports=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)}},98209:t=>{t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,t.updateCenter(),0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x}},72792:t=>{t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,t.updateCenter(),0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y}},27354:(t,e,n)=>{var i=n(14405),r=n(52926),s=n(28808);t.exports=function(t,e,n,o,a,c,l){var u=o.left,h=o.top,d=o.right,p=o.bottom,f=n.faceLeft||n.faceRight,m=n.faceTop||n.faceBottom;if(l||(f=!0,m=!0),!f&&!m)return!1;var g=0,v=0,y=0,x=1;if(e.deltaAbsX()>e.deltaAbsY()?y=-1:e.deltaAbsX()<e.deltaAbsY()&&(x=-1),0!==e.deltaX()&&0!==e.deltaY()&&f&&m&&(y=Math.min(Math.abs(e.position.x-d),Math.abs(e.right-u)),x=Math.min(Math.abs(e.position.y-p),Math.abs(e.bottom-h))),y<x){if(f&&0!==(g=i(e,n,u,d,c,l))&&!s(o,e))return!0;m&&(v=r(e,n,h,p,c,l))}else{if(m&&0!==(v=r(e,n,h,p,c,l))&&!s(o,e))return!0;f&&(g=i(e,n,u,d,c,l))}return 0!==g||0!==v}},14405:(t,e,n)=>{var i=n(98209);t.exports=function(t,e,n,r,s,o){var a=0,c=e.faceLeft,l=e.faceRight,u=e.collideLeft,h=e.collideRight;return o||(c=!0,l=!0,u=!0,h=!0),t.deltaX()<0&&h&&t.checkCollision.left?l&&t.x<r&&(a=t.x-r)<-s&&(a=0):t.deltaX()>0&&u&&t.checkCollision.right&&c&&t.right>n&&(a=t.right-n)>s&&(a=0),0!==a&&(t.customSeparateX?t.overlapX=a:i(t,a)),a}},52926:(t,e,n)=>{var i=n(72792);t.exports=function(t,e,n,r,s,o){var a=0,c=e.faceTop,l=e.faceBottom,u=e.collideUp,h=e.collideDown;return o||(c=!0,l=!0,u=!0,h=!0),t.deltaY()<0&&h&&t.checkCollision.up?l&&t.y<r&&(a=t.y-r)<-s&&(a=0):t.deltaY()>0&&u&&t.checkCollision.down&&c&&t.bottom>n&&(a=t.bottom-n)>s&&(a=0),0!==a&&(t.customSeparateY?t.overlapY=a:i(t,a)),a}},28808:t=>{t.exports=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)}},8413:(t,e,n)=>{var i={ProcessTileCallbacks:n(25163),ProcessTileSeparationX:n(98209),ProcessTileSeparationY:n(72792),SeparateTile:n(27354),TileCheckX:n(14405),TileCheckY:n(52926),TileIntersectsBody:n(28808)};t.exports=i},53954:(t,e,n)=>{t.exports={Arcade:n(39977),Matter:n(45949)}},63568:(t,e,n)=>{var i=n(56694),r=n(93736),s=new i({initialize:function(){this.boundsCenter=new r,this.centerDiff=new r},parseBody:function(t){if(!(t=t.hasOwnProperty("body")?t.body:t).hasOwnProperty("bounds")||!t.hasOwnProperty("centerOfMass"))return!1;var e=this.boundsCenter,n=this.centerDiff,i=t.bounds.max.x-t.bounds.min.x,r=t.bounds.max.y-t.bounds.min.y,s=i*t.centerOfMass.x,o=r*t.centerOfMass.y;return e.set(i/2,r/2),n.set(s-e.x,o-e.y),!0},getTopLeft:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n+i.y+s.y)}return!1},getTopCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+s.x,n+i.y+s.y)}return!1},getTopRight:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n+i.y+s.y)}return!1},getLeftCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n+s.y)}return!1},getCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.centerDiff;return new r(e+i.x,n+i.y)}return!1},getRightCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n+s.y)}return!1},getBottomLeft:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+i.x+s.x,n-(i.y-s.y))}return!1},getBottomCenter:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e+s.x,n-(i.y-s.y))}return!1},getBottomRight:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),this.parseBody(t)){var i=this.boundsCenter,s=this.centerDiff;return new r(e-(i.x-s.x),n-(i.y-s.y))}return!1}});t.exports=s},18171:(t,e,n)=>{var i=n(16929);i.Body=n(84125),i.Composite=n(11299),i.World=n(72005),i.Collision=n(63454),i.Detector=n(13657),i.Pairs=n(91327),i.Pair=n(70584),i.Query=n(13390),i.Resolver=n(44272),i.Constraint=n(52838),i.Common=n(68758),i.Engine=n(45775),i.Events=n(39073),i.Sleeping=n(22806),i.Plugin=n(84474),i.Bodies=n(68516),i.Composites=n(56643),i.Axes=n(50658),i.Bounds=n(84091),i.Svg=n(92765),i.Vector=n(10438),i.Vertices=n(39745),i.World.add=i.Composite.add,i.World.remove=i.Composite.remove,i.World.addComposite=i.Composite.addComposite,i.World.addBody=i.Composite.addBody,i.World.addConstraint=i.Composite.addConstraint,i.World.clear=i.Composite.clear,t.exports=i},72653:(t,e,n)=>{var i=n(68516),r=n(56694),s=n(56643),o=n(52838),a=n(92765),c=n(3860),l=n(7030),u=n(73658),h=n(84720),d=n(10998),p=n(72829),f=n(88596),m=n(39745),g=new r({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},rectangle:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return this.world.add(o),o},trapezoid:function(t,e,n,r,s,o){var a=i.trapezoid(t,e,n,r,s,o);return this.world.add(a),a},circle:function(t,e,n,r,s){var o=i.circle(t,e,n,r,s);return this.world.add(o),o},polygon:function(t,e,n,r,s){var o=i.polygon(t,e,n,r,s);return this.world.add(o),o},fromVertices:function(t,e,n,r,s,o,a){"string"===typeof n&&(n=m.fromPath(n));var c=i.fromVertices(t,e,n,r,s,o,a);return this.world.add(c),c},fromPhysicsEditor:function(t,e,n,i,r){void 0===r&&(r=!0);var s=d.parseBody(t,e,n,i);return r&&!this.world.has(s)&&this.world.add(s),s},fromSVG:function(t,e,n,r,s,o){void 0===r&&(r=1),void 0===s&&(s={}),void 0===o&&(o=!0);for(var c=n.getElementsByTagName("path"),l=[],u=0;u<c.length;u++){var h=a.pathToVertices(c[u],30);1!==r&&m.scale(h,r,r),l.push(h)}var d=i.fromVertices(t,e,l,s);return o&&this.world.add(d),d},fromJSON:function(t,e,n,i,r){void 0===i&&(i={}),void 0===r&&(r=!0);var s=p.parseBody(t,e,n,i);return s&&r&&this.world.add(s),s},imageStack:function(t,e,n,i,r,o,a,c,u){void 0===a&&(a=0),void 0===c&&(c=0),void 0===u&&(u={});var h=this.world,d=this.sys.displayList;u.addToWorld=!1;var p=s.stack(n,i,r,o,a,c,(function(n,i){var r=new l(h,n,i,t,e,u);return d.add(r),r.body}));return h.add(p),p},stack:function(t,e,n,i,r,o,a){var c=s.stack(t,e,n,i,r,o,a);return this.world.add(c),c},pyramid:function(t,e,n,i,r,o,a){var c=s.pyramid(t,e,n,i,r,o,a);return this.world.add(c),c},chain:function(t,e,n,i,r,o){return s.chain(t,e,n,i,r,o)},mesh:function(t,e,n,i,r){return s.mesh(t,e,n,i,r)},newtonsCradle:function(t,e,n,i,r){var o=s.newtonsCradle(t,e,n,i,r);return this.world.add(o),o},car:function(t,e,n,i,r){var o=s.car(t,e,n,i,r);return this.world.add(o),o},softBody:function(t,e,n,i,r,o,a,c,l,u){var h=s.softBody(t,e,n,i,r,o,a,c,l,u);return this.world.add(h),h},joint:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},spring:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},constraint:function(t,e,n,i,r){void 0===i&&(i=1),void 0===r&&(r={}),r.bodyA="body"===t.type?t:t.body,r.bodyB="body"===e.type?e:e.body,isNaN(n)||(r.length=n),r.stiffness=i;var s=o.create(r);return this.world.add(s),s},worldConstraint:function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i={}),i.bodyB="body"===t.type?t:t.body,isNaN(e)||(i.length=e),i.stiffness=n;var r=o.create(i);return this.world.add(r),r},mouseSpring:function(t){return this.pointerConstraint(t)},pointerConstraint:function(t){void 0===t&&(t={}),t.hasOwnProperty("render")||(t.render={visible:!1});var e=new f(this.scene,this.world,t);return this.world.add(e.constraint),e},image:function(t,e,n,i,r){var s=new l(this.world,t,e,n,i,r);return this.sys.displayList.add(s),s},tileBody:function(t,e){return new h(this.world,t,e)},sprite:function(t,e,n,i,r){var s=new u(this.world,t,e,n,i,r);return this.sys.displayList.add(s),this.sys.updateList.add(s),s},gameObject:function(t,e,n){return c(this.world,t,e,n)},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=g},3860:(t,e,n)=>{var i=n(74527),r=n(72632),s=n(93736);t.exports=function(t,e,n,o){void 0===n&&(n={}),void 0===o&&(o=!0);var a=e.x,c=e.y;if(e.body={temp:!0,position:{x:a,y:c}},[i.Bounce,i.Collision,i.Force,i.Friction,i.Gravity,i.Mass,i.Sensor,i.SetBody,i.Sleep,i.Static,i.Transform,i.Velocity].forEach((function(t){for(var n in t)(i=t[n]).get&&"function"===typeof i.get||i.set&&"function"===typeof i.set?Object.defineProperty(e,n,{get:t[n].get,set:t[n].set}):Object.defineProperty(e,n,{value:t[n]});var i})),e.world=t,e._tempVec2=new s(a,c),n.hasOwnProperty("type")&&"body"===n.type)e.setExistingBody(n,o);else{var l=r(n,"shape",null);l||(l="rectangle"),n.addToWorld=o,e.setBody(l,n)}return e}},7030:(t,e,n)=>{var i=n(56694),r=n(74527),s=n(89980),o=n(72632),a=n(1539),c=n(58210),l=n(93736),u=new i({Extends:a,Mixins:[r.Bounce,r.Collision,r.Force,r.Friction,r.Gravity,r.Mass,r.Sensor,r.SetBody,r.Sleep,r.Static,r.Transform,r.Velocity,c],initialize:function(t,e,n,i,r,a){s.call(this,t.scene,"Image"),this._crop=this.resetCropObject(),this.setTexture(i,r),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new l(e,n);var c=o(a,"shape",null);c?this.setBody(c,a):this.setRectangle(this.width,this.height,a),this.setPosition(e,n),this.initPipeline(),this.initPostPipeline(!0)}});t.exports=u},50583:(t,e,n)=>{var i=n(84093),r=n(50658),s=n(68516),o=n(84125),a=n(63568),c=n(84091),l=n(56694),u=n(63454),h=n(68758),d=n(11299),p=n(56643),f=n(52838),m=n(13657),g=n(53996),v=n(72653),y=n(72632),x=n(10850),b=n(1675),w=n(80391),S=n(16929),_=n(44097),T=n(30657),E=n(70584),C=n(91327),k=n(84474),A=n(91963),I=n(13390),O=n(44272),R=n(7599),N=n(92765),M=n(10438),D=n(39745),P=n(31468);h.setDecomp(n(81084));var F=new l({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this.bodyBounds,this.body=o,this.composite=d,this.collision=u,this.detector=m,this.pair=E,this.pairs=C,this.query=I,this.resolver=O,this.constraint=f,this.bodies=s,this.composites=p,this.axes=r,this.bounds=c,this.svg=N,this.vector=M,this.vertices=D,this.verts=D,this._tempVec2=M.create(),x(this.config,"plugins.collisionevents",!0)&&this.enableCollisionEventsPlugin(),x(this.config,"plugins.attractors",!1)&&this.enableAttractorPlugin(),x(this.config,"plugins.wrap",!1)&&this.enableWrapPlugin(),O._restingThresh=x(this.config,"restingThresh",4),O._restingThreshTangent=x(this.config,"restingThreshTangent",6),O._positionDampen=x(this.config,"positionDampen",.9),O._positionWarming=x(this.config,"positionWarming",.8),O._frictionNormalMultiplier=x(this.config,"frictionNormalMultiplier",5),t.sys.events.once(R.BOOT,this.boot,this),t.sys.events.on(R.START,this.start,this)},boot:function(){this.world=new P(this.scene,this.config),this.add=new v(this.world),this.bodyBounds=new a,this.systems.events.once(R.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new P(this.scene,this.config),this.add=new v(this.world));var t=this.systems.events;t.on(R.UPDATE,this.world.update,this.world),t.on(R.POST_UPDATE,this.world.postUpdate,this.world),t.once(R.SHUTDOWN,this.shutdown,this)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return T(y(e,"matter",{}),y(t,"matter",{}))},enableAttractorPlugin:function(){return k.register(b),k.use(S,b),this},enableWrapPlugin:function(){return k.register(_),k.use(S,_),this},enableCollisionEventsPlugin:function(){return k.register(w),k.use(S,w),this},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},set60Hz:function(){return this.world.getDelta=this.world.update60Hz,this.world.autoUpdate=!0,this},set30Hz:function(){return this.world.getDelta=this.world.update30Hz,this.world.autoUpdate=!0,this},step:function(t,e){this.world.step(t,e)},containsPoint:function(t,e,n){t=this.getMatterBodies(t);var i=M.create(e,n);return I.point(t,i).length>0},intersectPoint:function(t,e,n){n=this.getMatterBodies(n);var i=M.create(t,e),r=[];return I.point(n,i).forEach((function(t){-1===r.indexOf(t)&&r.push(t)})),r},intersectRect:function(t,e,n,i,r,s){void 0===r&&(r=!1),s=this.getMatterBodies(s);var o={min:{x:t,y:e},max:{x:t+n,y:e+i}},a=[];return I.region(s,o,r).forEach((function(t){-1===a.indexOf(t)&&a.push(t)})),a},intersectRay:function(t,e,n,i,r,s){void 0===r&&(r=1),s=this.getMatterBodies(s);for(var o=[],a=I.ray(s,M.create(t,e),M.create(n,i),r),c=0;c<a.length;c++)o.push(a[c].body);return o},intersectBody:function(t,e){e=this.getMatterBodies(e);for(var n=[],i=I.collides(t,e),r=0;r<i.length;r++){var s=i[r];s.bodyA===t?n.push(s.bodyB):n.push(s.bodyA)}return n},overlap:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),Array.isArray(t)||(t=[t]),t=this.getMatterBodies(t),e=this.getMatterBodies(e);for(var s=!1,o=0;o<t.length;o++)for(var a=t[o],c=I.collides(a,e),l=0;l<c.length;l++){var u=c[l],h=u.bodyA.id===a.id?u.bodyB:u.bodyA;if(!i||i.call(r,a,h,u))if(s=!0,n)n.call(r,a,h,u);else if(!i)return!0}return s},setCollisionCategory:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){t.collisionFilter.category=e})),this},setCollisionGroup:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){t.collisionFilter.group=e})),this},setCollidesWith:function(t,e){t=this.getMatterBodies(t);var n=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)n|=e[i];else n=e;return t.forEach((function(t){t.collisionFilter.mask=n})),this},getMatterBodies:function(t){if(!t)return this.world.getAllBodies();Array.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++){var i=t[n].hasOwnProperty("body")?t[n].body:t[n];e.push(i)}return e},setVelocity:function(t,e,n){t=this.getMatterBodies(t);var i=this._tempVec2;return i.x=e,i.y=n,t.forEach((function(t){o.setVelocity(t,i)})),this},setVelocityX:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return n.x=e,t.forEach((function(t){n.y=t.velocity.y,o.setVelocity(t,n)})),this},setVelocityY:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return n.y=e,t.forEach((function(t){n.x=t.velocity.x,o.setVelocity(t,n)})),this},setAngularVelocity:function(t,e){return(t=this.getMatterBodies(t)).forEach((function(t){o.setAngularVelocity(t,e)})),this},applyForce:function(t,e){t=this.getMatterBodies(t);var n=this._tempVec2;return t.forEach((function(t){n.x=t.position.x,n.y=t.position.y,o.applyForce(t,n,e)})),this},applyForceFromPosition:function(t,e,n,i){t=this.getMatterBodies(t);var r=this._tempVec2;return t.forEach((function(t){void 0===i&&(i=t.angle),r.x=n*Math.cos(i),r.y=n*Math.sin(i),o.applyForce(t,e,r)})),this},applyForceFromAngle:function(t,e,n){t=this.getMatterBodies(t);var i=this._tempVec2;return t.forEach((function(t){void 0===n&&(n=t.angle),i.x=e*Math.cos(n),i.y=e*Math.sin(n),o.applyForce(t,{x:t.position.x,y:t.position.y},i)})),this},getConstraintLength:function(t){var e=t.pointA.x,n=t.pointA.y,i=t.pointB.x,r=t.pointB.y;return t.bodyA&&(e+=t.bodyA.position.x,n+=t.bodyA.position.y),t.bodyB&&(i+=t.bodyB.position.x,r+=t.bodyB.position.y),g(e,n,i,r)},alignBody:function(t,e,n,r){var s;switch(t=t.hasOwnProperty("body")?t.body:t,r){case i.TOP_LEFT:case i.LEFT_TOP:s=this.bodyBounds.getTopLeft(t,e,n);break;case i.TOP_CENTER:s=this.bodyBounds.getTopCenter(t,e,n);break;case i.TOP_RIGHT:case i.RIGHT_TOP:s=this.bodyBounds.getTopRight(t,e,n);break;case i.LEFT_CENTER:s=this.bodyBounds.getLeftCenter(t,e,n);break;case i.CENTER:s=this.bodyBounds.getCenter(t,e,n);break;case i.RIGHT_CENTER:s=this.bodyBounds.getRightCenter(t,e,n);break;case i.LEFT_BOTTOM:case i.BOTTOM_LEFT:s=this.bodyBounds.getBottomLeft(t,e,n);break;case i.BOTTOM_CENTER:s=this.bodyBounds.getBottomCenter(t,e,n);break;case i.BOTTOM_RIGHT:case i.RIGHT_BOTTOM:s=this.bodyBounds.getBottomRight(t,e,n)}return s&&o.setPosition(t,s),this},shutdown:function(){var t=this.systems.events;this.world&&(t.off(R.UPDATE,this.world.update,this.world),t.off(R.POST_UPDATE,this.world.postUpdate,this.world)),t.off(R.SHUTDOWN,this.shutdown,this),this.add&&this.add.destroy(),this.world&&this.world.destroy(),this.add=null,this.world=null},destroy:function(){this.shutdown(),this.scene.sys.events.off(R.START,this.start,this),this.scene=null,this.systems=null}});A.register("MatterPhysics",F,"matterPhysics"),t.exports=F},73658:(t,e,n)=>{var i=n(16569),r=n(56694),s=n(74527),o=n(89980),a=n(72632),c=n(58210),l=n(13747),u=n(93736),h=new r({Extends:l,Mixins:[s.Bounce,s.Collision,s.Force,s.Friction,s.Gravity,s.Mass,s.Sensor,s.SetBody,s.Sleep,s.Static,s.Transform,s.Velocity,c],initialize:function(t,e,n,r,s,c){o.call(this,t.scene,"Sprite"),this._crop=this.resetCropObject(),this.anims=new i(this),this.setTexture(r,s),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new u(e,n);var l=a(c,"shape",null);l?this.setBody(l,c):this.setRectangle(this.width,this.height,c),this.setPosition(e,n),this.initPipeline(),this.initPostPipeline(!0)}});t.exports=h},84720:(t,e,n)=>{var i=n(68516),r=n(84125),s=n(56694),o=n(74527),a=n(28699),c=n(6659),l=n(72632),u=n(19256),h=n(39745),d=new s({Extends:c,Mixins:[o.Bounce,o.Collision,o.Friction,o.Gravity,o.Mass,o.Sensor,o.Sleep,o.Static],initialize:function(t,e,n){c.call(this),this.tile=e,this.world=t,e.physics.matterBody&&e.physics.matterBody.destroy(),e.physics.matterBody=this;var i=l(n,"body",null),s=l(n,"addToWorld",!0);if(i)this.setBody(i,s);else{var o=e.getCollisionGroup();l(o,"objects",[]).length>0?this.setFromTileCollision(n):this.setFromTileRectangle(n)}if(e.flipX||e.flipY){var a={x:e.getCenterX(),y:e.getCenterY()},u=e.flipX?-1:1,h=e.flipY?-1:1;r.scale(i,u,h,a)}},setFromTileRectangle:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);var e=this.tile.getBounds(),n=e.x+e.width/2,r=e.y+e.height/2,s=i.rectangle(n,r,e.width,e.height,t);return this.setBody(s,t.addToWorld),this},setFromTileCollision:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);for(var e=this.tile.tilemapLayer.scaleX,n=this.tile.tilemapLayer.scaleY,s=this.tile.getLeft(),o=this.tile.getTop(),c=this.tile.getCollisionGroup(),d=l(c,"objects",[]),p=[],f=0;f<d.length;f++){var m=d[f],g=s+m.x*e,v=o+m.y*n,y=m.width*e,x=m.height*n,b=null;if(m.rectangle)b=i.rectangle(g+y/2,v+x/2,y,x,t);else if(m.ellipse)b=i.circle(g+y/2,v+x/2,y/2,t);else if(m.polygon||m.polyline){var w=(m.polygon?m.polygon:m.polyline).map((function(t){return{x:t.x*e,y:t.y*n}})),S=h.create(w),_=h.centre(S);g+=_.x,v+=_.y,b=i.fromVertices(g,v,S,t)}b&&p.push(b)}if(1===p.length)this.setBody(p[0],t.addToWorld);else if(p.length>1){var T=a(t);T.parts=p,this.setBody(r.create(T),T.addToWorld)}return this},setBody:function(t,e){return void 0===e&&(e=!0),this.body&&this.removeBody(),this.body=t,this.body.gameObject=this,e&&this.world.add(this.body),this},removeBody:function(){return this.body&&(this.world.remove(this.body),this.body.gameObject=void 0,this.body=void 0),this},destroy:function(){this.removeBody(),this.tile.physics.matterBody=void 0,this.removeAllListeners()}});t.exports=d},10998:(t,e,n)=>{var i=n(68516),r=n(84125),s=n(68758),o=n(72632),a=n(39745),c={parseBody:function(t,e,n,i){void 0===i&&(i={});for(var a=o(n,"fixtures",[]),c=[],l=0;l<a.length;l++)for(var u=this.parseFixture(a[l]),h=0;h<u.length;h++)c.push(u[h]);var d=s.clone(n,!0);s.extend(d,i,!0),delete d.fixtures,delete d.type;var p=r.create(d);return r.setParts(p,c),r.setPosition(p,{x:t,y:e}),p},parseFixture:function(t){var e,n=s.extend({},!1,t);if(delete n.circle,delete n.vertices,t.circle){var r=o(t.circle,"x"),a=o(t.circle,"y"),c=o(t.circle,"radius");e=[i.circle(r,a,c,n)]}else t.vertices&&(e=this.parseVertices(t.vertices,n));return e},parseVertices:function(t,e){void 0===e&&(e={});for(var n=[],o=0;o<t.length;o++)a.clockwiseSort(t[o]),n.push(r.create(s.extend({position:a.centre(t[o]),vertices:t[o]},e)));return i.flagCoincidentParts(n)}};t.exports=c},72829:(t,e,n)=>{var i=n(68516),r=n(84125),s={parseBody:function(t,e,n,s){var o;void 0===s&&(s={});var a=n.vertices;if(1===a.length)s.vertices=a[0],o=r.create(s),i.flagCoincidentParts(o.parts);else{for(var c=[],l=0;l<a.length;l++){var u=r.create({vertices:a[l]});c.push(u)}i.flagCoincidentParts(c),s.parts=c,o=r.create(s)}return o.label=n.label,r.setPosition(o,{x:t,y:e}),o}};t.exports=s},88596:(t,e,n)=>{var i=n(84091),r=n(56694),s=n(11299),o=n(52838),a=n(13657),c=n(35416),l=n(33963),u=n(30657),h=n(22806),d=n(93736),p=n(39745),f=new r({initialize:function(t,e,n){void 0===n&&(n={}),this.scene=t,this.world=e,this.camera=null,this.pointer=null,this.active=!0,this.position=new d,this.body=null,this.part=null,this.constraint=o.create(u(n,{label:"Pointer Constraint",pointA:{x:0,y:0},pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,collisionFilter:{category:1,mask:4294967295,group:0}})),this.world.on(c.BEFORE_UPDATE,this.update,this),t.sys.input.on(l.POINTER_DOWN,this.onDown,this),t.sys.input.on(l.POINTER_UP,this.onUp,this)},onDown:function(t){this.pointer||(this.pointer=t,this.camera=t.camera)},onUp:function(t){t===this.pointer&&(this.pointer=null)},getBody:function(t){var e=this.position,n=this.constraint;this.camera.getWorldPoint(t.x,t.y,e);for(var r=s.allBodies(this.world.localWorld),o=0;o<r.length;o++){var l=r[o];if(!l.ignorePointer&&i.contains(l.bounds,e)&&a.canCollide(l.collisionFilter,n.collisionFilter)&&this.hitTestBody(l,e))return this.world.emit(c.DRAG_START,l,this.part,this),!0}return!1},hitTestBody:function(t,e){for(var n=this.constraint,i=t.parts.length,r=i>1?1:0;r<i;r++){var s=t.parts[r];if(p.contains(s.vertices,e))return n.pointA=e,n.pointB={x:e.x-t.position.x,y:e.y-t.position.y},n.bodyB=t,n.angleB=t.angle,h.set(t,!1),this.part=s,this.body=t,!0}return!1},update:function(){var t=this.pointer,e=this.body;if(this.active&&t)if(t.isDown||!e){if(t.isDown){if(!e&&!this.getBody(t))return;e=this.body;var n=this.position,i=this.constraint;this.camera.getWorldPoint(t.x,t.y,n),i.pointA.x=n.x,i.pointA.y=n.y,h.set(e,!1),this.world.emit(c.DRAG,e,this)}}else this.stopDrag();else e&&this.stopDrag()},stopDrag:function(){var t=this.body,e=this.constraint;e.bodyB=null,e.pointB=null,this.pointer=null,this.body=null,this.part=null,t&&this.world.emit(c.DRAG_END,t,this)},destroy:function(){this.world.removeConstraint(this.constraint),this.pointer=null,this.constraint=null,this.body=null,this.part=null,this.world.off(c.BEFORE_UPDATE,this.update),this.scene.sys.input.off(l.POINTER_DOWN,this.onDown,this),this.scene.sys.input.off(l.POINTER_UP,this.onUp,this)}});t.exports=f},31468:(t,e,n)=>{var i=n(68516),r=n(84125),s=n(56694),o=n(68758),a=n(11299),c=n(45775),l=n(6659),u=n(35416),h=n(72632),d=n(10850),p=n(84125),f=n(39073),m=n(84720),g=n(72005),v=n(10438),y=new s({Extends:l,initialize:function(t,e){l.call(this),this.scene=t,this.engine=c.create(e),this.localWorld=this.engine.world;var n=d(e,"gravity",null);n?this.setGravity(n.x,n.y,n.scale):!1===n&&this.setGravity(0,0,0),this.walls={left:null,right:null,top:null,bottom:null},this.enabled=d(e,"enabled",!0),this.getDelta=d(e,"getDelta",this.update60Hz);var i=h(e,"runner",{}),r=h(i,"fps",!1),s=h(i,"fps",60),o=h(i,"delta",1e3/s),a=h(i,"deltaMin",1e3/s),u=h(i,"deltaMax",1e3/(.5*s));r||(s=1e3/o),this.runner={fps:s,deltaSampleSize:h(i,"deltaSampleSize",60),counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:h(i,"isFixed",!1),delta:o,deltaMin:a,deltaMax:u},this.autoUpdate=d(e,"autoUpdate",!0);var p=d(e,"debug",!1);if(this.drawDebug="object"===typeof p||p,this.debugGraphic,this.debugConfig={showAxes:h(p,"showAxes",!1),showAngleIndicator:h(p,"showAngleIndicator",!1),angleColor:h(p,"angleColor",15208787),showBroadphase:h(p,"showBroadphase",!1),broadphaseColor:h(p,"broadphaseColor",16757760),showBounds:h(p,"showBounds",!1),boundsColor:h(p,"boundsColor",16777215),showVelocity:h(p,"showVelocity",!1),velocityColor:h(p,"velocityColor",44783),showCollisions:h(p,"showCollisions",!1),collisionColor:h(p,"collisionColor",16094476),showSeparations:h(p,"showSeparations",!1),separationColor:h(p,"separationColor",16753920),showBody:h(p,"showBody",!0),showStaticBody:h(p,"showStaticBody",!0),showInternalEdges:h(p,"showInternalEdges",!1),renderFill:h(p,"renderFill",!1),renderLine:h(p,"renderLine",!0),fillColor:h(p,"fillColor",1075465),fillOpacity:h(p,"fillOpacity",1),lineColor:h(p,"lineColor",2678297),lineOpacity:h(p,"lineOpacity",1),lineThickness:h(p,"lineThickness",1),staticFillColor:h(p,"staticFillColor",857979),staticLineColor:h(p,"staticLineColor",1255396),showSleeping:h(p,"showSleeping",!1),staticBodySleepOpacity:h(p,"staticBodySleepOpacity",.7),sleepFillColor:h(p,"sleepFillColor",4605510),sleepLineColor:h(p,"sleepLineColor",10066585),showSensors:h(p,"showSensors",!0),sensorFillColor:h(p,"sensorFillColor",857979),sensorLineColor:h(p,"sensorLineColor",1255396),showPositions:h(p,"showPositions",!0),positionSize:h(p,"positionSize",4),positionColor:h(p,"positionColor",14697178),showJoint:h(p,"showJoint",!0),jointColor:h(p,"jointColor",14737474),jointLineOpacity:h(p,"jointLineOpacity",1),jointLineThickness:h(p,"jointLineThickness",2),pinSize:h(p,"pinSize",4),pinColor:h(p,"pinColor",4382944),springColor:h(p,"springColor",14697184),anchorColor:h(p,"anchorColor",15724527),anchorSize:h(p,"anchorSize",4),showConvexHulls:h(p,"showConvexHulls",!1),hullColor:h(p,"hullColor",14091216)},this.drawDebug&&this.createDebugGraphic(),this.setEventsProxy(),h(e,"setBounds",!1)){var f=e.setBounds;if("boolean"===typeof f)this.setBounds();else{var m=h(f,"x",0),g=h(f,"y",0),v=h(f,"width",t.sys.scale.width),y=h(f,"height",t.sys.scale.height),x=h(f,"thickness",64),b=h(f,"left",!0),w=h(f,"right",!0),S=h(f,"top",!0),_=h(f,"bottom",!0);this.setBounds(m,g,v,y,x,b,w,S,_)}}},setCompositeRenderStyle:function(t){var e,n,i,r=t.bodies,s=t.constraints,o=t.composites;for(e=0;e<r.length;e++)i=(n=r[e]).render,this.setBodyRenderStyle(n,i.lineColor,i.lineOpacity,i.lineThickness,i.fillColor,i.fillOpacity);for(e=0;e<s.length;e++)i=(n=s[e]).render,this.setConstraintRenderStyle(n,i.lineColor,i.lineOpacity,i.lineThickness,i.pinSize,i.anchorColor,i.anchorSize);for(e=0;e<o.length;e++)n=o[e],this.setCompositeRenderStyle(n);return this},setBodyRenderStyle:function(t,e,n,i,r,s){var o=t.render,a=this.debugConfig;return o?(void 0!==e&&null!==e||(e=t.isStatic?a.staticLineColor:a.lineColor),void 0!==n&&null!==n||(n=a.lineOpacity),void 0!==i&&null!==i||(i=a.lineThickness),void 0!==r&&null!==r||(r=t.isStatic?a.staticFillColor:a.fillColor),void 0!==s&&null!==s||(s=a.fillOpacity),!1!==e&&(o.lineColor=e),!1!==n&&(o.lineOpacity=n),!1!==i&&(o.lineThickness=i),!1!==r&&(o.fillColor=r),!1!==s&&(o.fillOpacity=s),this):this},setConstraintRenderStyle:function(t,e,n,i,r,s,o){var a=t.render,c=this.debugConfig;if(!a)return this;if(void 0===e||null===e){var l=a.type;"line"===l?e=c.jointColor:"pin"===l?e=c.pinColor:"spring"===l&&(e=c.springColor)}return void 0!==n&&null!==n||(n=c.jointLineOpacity),void 0!==i&&null!==i||(i=c.jointLineThickness),void 0!==r&&null!==r||(r=c.pinSize),void 0!==s&&null!==s||(s=c.anchorColor),void 0!==o&&null!==o||(o=c.anchorSize),!1!==e&&(a.lineColor=e),!1!==n&&(a.lineOpacity=n),!1!==i&&(a.lineThickness=i),!1!==r&&(a.pinSize=r),!1!==s&&(a.anchorColor=s),!1!==o&&(a.anchorSize=o),this},setEventsProxy:function(){var t=this,e=this.engine,n=this.localWorld;this.drawDebug&&(f.on(n,"compositeModified",(function(e){t.setCompositeRenderStyle(e)})),f.on(n,"beforeAdd",(function(e){for(var n=[].concat(e.object),i=0;i<n.length;i++){var r=n[i],s=r.render;"body"===r.type?t.setBodyRenderStyle(r,s.lineColor,s.lineOpacity,s.lineThickness,s.fillColor,s.fillOpacity):"composite"===r.type?t.setCompositeRenderStyle(r):"constraint"===r.type&&t.setConstraintRenderStyle(r,s.lineColor,s.lineOpacity,s.lineThickness,s.pinSize,s.anchorColor,s.anchorSize)}}))),f.on(n,"beforeAdd",(function(e){t.emit(u.BEFORE_ADD,e)})),f.on(n,"afterAdd",(function(e){t.emit(u.AFTER_ADD,e)})),f.on(n,"beforeRemove",(function(e){t.emit(u.BEFORE_REMOVE,e)})),f.on(n,"afterRemove",(function(e){t.emit(u.AFTER_REMOVE,e)})),f.on(e,"beforeUpdate",(function(e){t.emit(u.BEFORE_UPDATE,e)})),f.on(e,"afterUpdate",(function(e){t.emit(u.AFTER_UPDATE,e)})),f.on(e,"collisionStart",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(u.COLLISION_START,e,n,i)})),f.on(e,"collisionActive",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(u.COLLISION_ACTIVE,e,n,i)})),f.on(e,"collisionEnd",(function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(u.COLLISION_END,e,n,i)}))},setBounds:function(t,e,n,i,r,s,o,a,c){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),void 0===r&&(r=64),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=!0),void 0===c&&(c=!0),this.updateWall(s,"left",t-r,e-r,r,i+2*r),this.updateWall(o,"right",t+n,e-r,r,i+2*r),this.updateWall(a,"top",t,e-r,n,r),this.updateWall(c,"bottom",t,e+i,n,r),this},updateWall:function(t,e,n,i,r,s){var o=this.walls[e];t?(o&&g.remove(this.localWorld,o),n+=r/2,i+=s/2,this.walls[e]=this.create(n,i,r,s,{isStatic:!0,friction:0,frictionStatic:0})):(o&&g.remove(this.localWorld,o),this.walls[e]=null)},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},disableGravity:function(){return this.localWorld.gravity.x=0,this.localWorld.gravity.y=0,this.localWorld.gravity.scale=0,this},setGravity:function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1),void 0===n&&(n=.001),this.localWorld.gravity.x=t,this.localWorld.gravity.y=e,this.localWorld.gravity.scale=n,this},create:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return g.add(this.localWorld,o),o},add:function(t){return g.add(this.localWorld,t),this},remove:function(t,e){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n],r=i.body?i.body:i;a.remove(this.localWorld,r,e)}return this},removeConstraint:function(t,e){return a.remove(this.localWorld,t,e),this},convertTilemapLayer:function(t,e){var n=t.layer,i=t.getTilesWithin(0,0,n.width,n.height,{isColliding:!0});return this.convertTiles(i,e),this},convertTiles:function(t,e){if(0===t.length)return this;for(var n=0;n<t.length;n++)new m(this,t[n],e);return this},nextGroup:function(t){return p.nextGroup(t)},nextCategory:function(){return p.nextCategory()},pause:function(){return this.enabled=!1,this.emit(u.PAUSE),this},resume:function(){return this.enabled=!0,this.emit(u.RESUME),this},update:function(t,e){if(this.enabled&&this.autoUpdate){var n=this.engine,i=this.runner,r=n.timing;i.isFixed?e=this.getDelta(t,e):(e=t-i.timePrev||i.delta,i.timePrev=t,i.deltaHistory.push(e),i.deltaHistory=i.deltaHistory.slice(-i.deltaSampleSize),e=(e=(e=Math.min.apply(null,i.deltaHistory))<i.deltaMin?i.deltaMin:e)>i.deltaMax?i.deltaMax:e,i.delta=e),i.timeScalePrev=r.timeScale,i.frameCounter+=1,t-i.counterTimestamp>=1e3&&(i.fps=i.frameCounter*((t-i.counterTimestamp)/1e3),i.counterTimestamp=t,i.frameCounter=0),c.update(n,e)}},step:function(t){c.update(this.engine,t)},update60Hz:function(){return 1e3/60},update30Hz:function(){return 1e3/30},has:function(t){var e=t.hasOwnProperty("body")?t.body:t;return null!==a.get(this.localWorld,e.id,e.type)},getAllBodies:function(){return a.allBodies(this.localWorld)},getAllConstraints:function(){return a.allConstraints(this.localWorld)},getAllComposites:function(){return a.allComposites(this.localWorld)},postUpdate:function(){if(this.drawDebug){var t=this.debugConfig,e=this.engine,n=this.debugGraphic,i=a.allBodies(this.localWorld);this.debugGraphic.clear(),t.showBroadphase&&e.broadphase.controller&&this.renderGrid(e.broadphase,n,t.broadphaseColor,.5),t.showBounds&&this.renderBodyBounds(i,n,t.boundsColor,.5),(t.showBody||t.showStaticBody)&&this.renderBodies(i),t.showJoint&&this.renderJoints(),(t.showAxes||t.showAngleIndicator)&&this.renderBodyAxes(i,n,t.showAxes,t.angleColor,.5),t.showVelocity&&this.renderBodyVelocity(i,n,t.velocityColor,1,2),t.showSeparations&&this.renderSeparations(e.pairs.list,n,t.separationColor),t.showCollisions&&this.renderCollisions(e.pairs.list,n,t.collisionColor)}},renderGrid:function(t,e,n,i){e.lineStyle(1,n,i);for(var r=o.keys(t.buckets),s=0;s<r.length;s++){var a=r[s];if(!(t.buckets[a].length<2)){var c=a.split(/C|R/);e.strokeRect(parseInt(c[1],10)*t.bucketWidth,parseInt(c[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}return this},renderSeparations:function(t,e,n){e.lineStyle(1,n,1);for(var i=0;i<t.length;i++){var r=t[i];if(r.isActive){var s=r.collision,o=s.bodyA,a=s.bodyB,c=o.position,l=a.position,u=s.penetration,h=o.isStatic||a.isStatic?1:4;a.isStatic&&(h=0),e.lineBetween(l.x,l.y,l.x-u.x*h,l.y-u.y*h),h=o.isStatic||a.isStatic?1:4,o.isStatic&&(h=0),e.lineBetween(c.x,c.y,c.x-u.x*h,c.y-u.y*h)}}return this},renderCollisions:function(t,e,n){var i,r;for(e.lineStyle(1,n,.5),e.fillStyle(n,1),i=0;i<t.length;i++)if((r=t[i]).isActive)for(var s=0;s<r.activeContacts.length;s++){var o=r.activeContacts[s].vertex;e.fillRect(o.x-2,o.y-2,5,5)}for(i=0;i<t.length;i++)if((r=t[i]).isActive){var a=r.collision,c=r.activeContacts;if(c.length>0){var l=c[0].vertex.x,u=c[0].vertex.y;2===c.length&&(l=(c[0].vertex.x+c[1].vertex.x)/2,u=(c[0].vertex.y+c[1].vertex.y)/2),a.bodyB===a.supports[0].body||a.bodyA.isStatic?e.lineBetween(l-8*a.normal.x,u-8*a.normal.y,l,u):e.lineBetween(l+8*a.normal.x,u+8*a.normal.y,l,u)}}return this},renderBodyBounds:function(t,e,n,i){e.lineStyle(1,n,i);for(var r=0;r<t.length;r++){var s=t[r];if(s.render.visible){var o=s.bounds;if(o)e.strokeRect(o.min.x,o.min.y,o.max.x-o.min.x,o.max.y-o.min.y);else for(var a=s.parts,c=a.length>1?1:0;c<a.length;c++){var l=a[c];e.strokeRect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}}}return this},renderBodyAxes:function(t,e,n,i,r){e.lineStyle(1,i,r);for(var s=0;s<t.length;s++){var o,a,c,l=t[s],u=l.parts;if(l.render.visible)if(n)for(a=u.length>1?1:0;a<u.length;a++)for(o=u[a],c=0;c<o.axes.length;c++){var h=o.axes[c];e.lineBetween(o.position.x,o.position.y,o.position.x+20*h.x,o.position.y+20*h.y)}else for(a=u.length>1?1:0;a<u.length;a++)for(o=u[a],c=0;c<o.axes.length;c++)e.lineBetween(o.position.x,o.position.y,(o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}return this},renderBodyVelocity:function(t,e,n,i,r){e.lineStyle(r,n,i);for(var s=0;s<t.length;s++){var o=t[s];o.render.visible&&e.lineBetween(o.position.x,o.position.y,o.position.x+2*(o.position.x-o.positionPrev.x),o.position.y+2*(o.position.y-o.positionPrev.y))}return this},renderBodies:function(t){for(var e=this.debugGraphic,n=this.debugConfig,i=n.showBody,r=n.showStaticBody,s=n.showSleeping,o=n.showInternalEdges,a=n.showConvexHulls,c=n.renderFill,l=n.renderLine,u=n.staticBodySleepOpacity,h=n.sleepFillColor,d=n.sleepLineColor,p=n.hullColor,f=0;f<t.length;f++){var m=t[f];if(m.render.visible&&(r||!m.isStatic)&&(i||m.isStatic)){var g=m.render.lineColor,v=m.render.lineOpacity,y=m.render.lineThickness,x=m.render.fillColor,b=m.render.fillOpacity;s&&m.isSleeping&&(m.isStatic?(v*=u,b*=u):(g=d,x=h)),c||(x=null),l||(g=null),this.renderBody(m,e,o,g,v,y,x,b);var w=m.parts.length;a&&w>1&&this.renderConvexHull(m,e,p,y)}}},renderBody:function(t,e,n,i,r,s,o,a){void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=1),void 0===o&&(o=null),void 0===a&&(a=null);for(var c=this.debugConfig,l=c.sensorFillColor,u=c.sensorLineColor,h=t.parts,d=h.length,p=d>1?1:0;p<d;p++){var f=h[p],m=f.render,g=m.opacity;if(m.visible&&0!==g&&(!f.isSensor||c.showSensors)){var v=f.circleRadius;if(e.beginPath(),f.isSensor?(null!==o&&e.fillStyle(l,a*g),null!==i&&e.lineStyle(s,u,r*g)):(null!==o&&e.fillStyle(o,a*g),null!==i&&e.lineStyle(s,i,r*g)),v)e.arc(f.position.x,f.position.y,v,0,2*Math.PI);else{var y=f.vertices,x=y.length;e.moveTo(y[0].x,y[0].y);for(var b=1;b<x;b++){var w=y[b];if(!y[b-1].isInternal||n?e.lineTo(w.x,w.y):e.moveTo(w.x,w.y),b<x&&w.isInternal&&!n){var S=(b+1)%x;e.moveTo(y[S].x,y[S].y)}}e.closePath()}null!==o&&e.fillPath(),null!==i&&e.strokePath()}}if(c.showPositions&&!t.isStatic){var _=t.position.x,T=t.position.y,E=Math.ceil(c.positionSize/2);e.fillStyle(c.positionColor,1),e.fillRect(_-E,T-E,c.positionSize,c.positionSize)}return this},renderConvexHull:function(t,e,n,i){if(void 0===i&&(i=1),t.parts.length>1){var r=t.vertices;e.lineStyle(i,n),e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var s=1;s<r.length;s++)e.lineTo(r[s].x,r[s].y);e.lineTo(r[0].x,r[0].y),e.strokePath()}return this},renderJoints:function(){for(var t=this.debugGraphic,e=a.allConstraints(this.localWorld),n=0;n<e.length;n++){var i=e[n].render,r=i.lineColor,s=i.lineOpacity,o=i.lineThickness,c=i.pinSize,l=i.anchorColor,u=i.anchorSize;this.renderConstraint(e[n],t,r,s,o,c,l,u)}},renderConstraint:function(t,e,n,i,r,s,a,c){var l=t.render;if(!l.visible||!t.pointA||!t.pointB)return this;e.lineStyle(r,n,i);var u,h,d=t.bodyA,p=t.bodyB;if(u=d?v.add(d.position,t.pointA):t.pointA,"pin"===l.type)e.strokeCircle(u.x,u.y,s);else{if(h=p?v.add(p.position,t.pointB):t.pointB,e.beginPath(),e.moveTo(u.x,u.y),"spring"===l.type)for(var f,m=v.sub(h,u),g=v.perp(v.normalise(m)),y=Math.ceil(o.clamp(t.length/5,12,20)),x=1;x<y;x+=1)f=x%2===0?1:-1,e.lineTo(u.x+m.x*(x/y)+g.x*f*4,u.y+m.y*(x/y)+g.y*f*4);e.lineTo(h.x,h.y)}return e.strokePath(),l.anchors&&c>0&&(e.fillStyle(a),e.fillCircle(u.x,u.y,c),e.fillCircle(h.x,h.y,c)),this},resetCollisionIDs:function(){return r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,this},shutdown:function(){f.off(this.engine),this.removeAllListeners(),g.clear(this.localWorld,!1),c.clear(this.engine),this.drawDebug&&this.debugGraphic.destroy()},destroy:function(){this.shutdown()}});t.exports=y},95349:t=>{t.exports={setBounce:function(t){return this.body.restitution=t,this}}},70679:t=>{var e={setCollisionCategory:function(t){return this.body.collisionFilter.category=t,this},setCollisionGroup:function(t){return this.body.collisionFilter.group=t,this},setCollidesWith:function(t){var e=0;if(Array.isArray(t))for(var n=0;n<t.length;n++)e|=t[n];else e=t;return this.body.collisionFilter.mask=e,this},setOnCollide:function(t){return this.body.onCollideCallback=t,this},setOnCollideEnd:function(t){return this.body.onCollideEndCallback=t,this},setOnCollideActive:function(t){return this.body.onCollideActiveCallback=t,this},setOnCollideWith:function(t,e){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n].hasOwnProperty("body")?t[n].body:t[n];this.body.setOnCollideWith(i,e)}return this}};t.exports=e},77178:(t,e,n)=>{var i=n(84125),r={applyForce:function(t){return this._tempVec2.set(this.body.position.x,this.body.position.y),i.applyForce(this.body,this._tempVec2,t),this},applyForceFrom:function(t,e){return i.applyForce(this.body,t,e),this},thrust:function(t){var e=this.body.angle;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustLeft:function(t){var e=this.body.angle-Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustRight:function(t){var e=this.body.angle+Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustBack:function(t){var e=this.body.angle-Math.PI;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this}};t.exports=r},74015:t=>{var e={setFriction:function(t,e,n){return this.body.friction=t,void 0!==e&&(this.body.frictionAir=e),void 0!==n&&(this.body.frictionStatic=n),this},setFrictionAir:function(t){return this.body.frictionAir=t,this},setFrictionStatic:function(t){return this.body.frictionStatic=t,this}};t.exports=e},11535:t=>{t.exports={setIgnoreGravity:function(t){return this.body.ignoreGravity=t,this}}},74497:(t,e,n)=>{var i=n(84125),r=n(93736),s={setMass:function(t){return i.setMass(this.body,t),this},setDensity:function(t){return i.setDensity(this.body,t),this},centerOfMass:{get:function(){return new r(this.body.centerOfMass.x,this.body.centerOfMass.y)}}};t.exports=s},75529:t=>{t.exports={setSensor:function(t){return this.body.isSensor=t,this},isSensor:function(){return this.body.isSensor}}},64024:(t,e,n)=>{var i=n(68516),r=n(84125),s=n(88456),o=n(72632),a=n(10998),c=n(72829),l=n(39745),u={setRectangle:function(t,e,n){return this.setBody({type:"rectangle",width:t,height:e},n)},setCircle:function(t,e){return this.setBody({type:"circle",radius:t},e)},setPolygon:function(t,e,n){return this.setBody({type:"polygon",sides:e,radius:t},n)},setTrapezoid:function(t,e,n,i){return this.setBody({type:"trapezoid",width:t,height:e,slope:n},i)},setExistingBody:function(t,e){void 0===e&&(e=!0),this.body&&this.world.remove(this.body,!0),this.body=t;for(var n=0;n<t.parts.length;n++)t.parts[n].gameObject=this;var i=this;if(t.destroy=function(){i.world.remove(i.body,!0),i.body.gameObject=null},e&&(this.world.has(t)&&this.world.remove(t,!0),this.world.add(t)),this._originComponent){var r=t.render.sprite.xOffset,o=t.render.sprite.yOffset,a=t.centerOfMass.x,c=t.centerOfMass.y;if(s(a,.5)&&s(c,.5))this.setOrigin(r+.5,o+.5);else{var l=t.centerOffset.x,u=t.centerOffset.y;this.setOrigin(r+l/this.displayWidth,o+u/this.displayHeight)}}return this},setBody:function(t,e){if(!t)return this;var n;"string"===typeof t&&(t={type:t});var s=o(t,"type","rectangle"),u=o(t,"x",this._tempVec2.x),h=o(t,"y",this._tempVec2.y),d=o(t,"width",this.width),p=o(t,"height",this.height);switch(s){case"rectangle":n=i.rectangle(u,h,d,p,e);break;case"circle":var f=o(t,"radius",Math.max(d,p)/2),m=o(t,"maxSides",25);n=i.circle(u,h,f,e,m);break;case"trapezoid":var g=o(t,"slope",.5);n=i.trapezoid(u,h,d,p,g,e);break;case"polygon":var v=o(t,"sides",5),y=o(t,"radius",Math.max(d,p)/2);n=i.polygon(u,h,v,y,e);break;case"fromVertices":case"fromVerts":var x=o(t,"verts",null);if(x)if("string"===typeof x&&(x=l.fromPath(x)),this.body&&!this.body.hasOwnProperty("temp"))r.setVertices(this.body,x),n=this.body;else{var b=o(t,"flagInternal",!1),w=o(t,"removeCollinear",.01),S=o(t,"minimumArea",10);n=i.fromVertices(u,h,x,e,b,w,S)}break;case"fromPhysicsEditor":n=a.parseBody(u,h,t,e);break;case"fromPhysicsTracer":n=c.parseBody(u,h,t,e)}return n&&this.setExistingBody(n,t.addToWorld),this}};t.exports=u},25106:(t,e,n)=>{var i=n(35416),r=n(22806),s=n(39073),o={setToSleep:function(){return r.set(this.body,!0),this},setAwake:function(){return r.set(this.body,!1),this},setSleepThreshold:function(t){return void 0===t&&(t=60),this.body.sleepThreshold=t,this},setSleepEvents:function(t,e){return this.setSleepStartEvent(t),this.setSleepEndEvent(e),this},setSleepStartEvent:function(t){if(t){var e=this.world;s.on(this.body,"sleepStart",(function(t){e.emit(i.SLEEP_START,t,this)}))}else s.off(this.body,"sleepStart");return this},setSleepEndEvent:function(t){if(t){var e=this.world;s.on(this.body,"sleepEnd",(function(t){e.emit(i.SLEEP_END,t,this)}))}else s.off(this.body,"sleepEnd");return this}};t.exports=o},82884:(t,e,n)=>{var i=n(84125),r={setStatic:function(t){return i.setStatic(this.body,t),this},isStatic:function(){return this.body.isStatic}};t.exports=r},4753:(t,e,n)=>{var i=n(84125),r=n(83392),s=n(35786),o=n(62138),a={x:{get:function(){return this.body.position.x},set:function(t){this._tempVec2.set(t,this.y),i.setPosition(this.body,this._tempVec2)}},y:{get:function(){return this.body.position.y},set:function(t){this._tempVec2.set(this.x,t),i.setPosition(this.body,this._tempVec2)}},scaleX:{get:function(){return this._scaleX},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleX=t,0===this._scaleX?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,t,this._scaleY)}},scaleY:{get:function(){return this._scaleY},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleY=t,0===this._scaleY?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,this._scaleX,t)}},angle:{get:function(){return o(this.body.angle*r.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*r.DEG_TO_RAD}},rotation:{get:function(){return this.body.angle},set:function(t){this._rotation=s(t),i.setAngle(this.body,this._rotation)}},setPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._tempVec2.set(t,e),i.setPosition(this.body,this._tempVec2),this},setRotation:function(t){return void 0===t&&(t=0),this._rotation=s(t),i.setAngle(this.body,t),this},setFixedRotation:function(){return i.setInertia(this.body,1/0),this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,i.setAngle(this.body,this.rotation),this},setScale:function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=t);var r=1/this._scaleX,s=1/this._scaleY;return this._scaleX=t,this._scaleY=e,i.scale(this.body,r,s,n),i.scale(this.body,t,e,n),this}};t.exports=a},37268:(t,e,n)=>{var i=n(84125),r={setVelocityX:function(t){return this._tempVec2.set(t,this.body.velocity.y),i.setVelocity(this.body,this._tempVec2),this},setVelocityY:function(t){return this._tempVec2.set(this.body.velocity.x,t),i.setVelocity(this.body,this._tempVec2),this},setVelocity:function(t,e){return this._tempVec2.set(t,e),i.setVelocity(this.body,this._tempVec2),this},getVelocity:function(){return i.getVelocity(this.body)},setAngularVelocity:function(t){return i.setAngularVelocity(this.body,t),this},getAngularVelocity:function(){return i.getAngularVelocity(this.body)},setAngularSpeed:function(t){return i.setAngularSpeed(this.body,t),this},getAngularSpeed:function(){return i.getAngularSpeed(this.body)}};t.exports=r},74527:(t,e,n)=>{t.exports={Bounce:n(95349),Collision:n(70679),Force:n(77178),Friction:n(74015),Gravity:n(11535),Mass:n(74497),Sensor:n(75529),SetBody:n(64024),Sleep:n(25106),Static:n(82884),Transform:n(4753),Velocity:n(37268)}},63201:t=>{t.exports="afteradd"},30474:t=>{t.exports="afterremove"},44822:t=>{t.exports="afterupdate"},88820:t=>{t.exports="beforeadd"},94849:t=>{t.exports="beforeremove"},6391:t=>{t.exports="beforeupdate"},96738:t=>{t.exports="collisionactive"},7916:t=>{t.exports="collisionend"},59529:t=>{t.exports="collisionstart"},10219:t=>{t.exports="dragend"},183:t=>{t.exports="drag"},39143:t=>{t.exports="dragstart"},16483:t=>{t.exports="pause"},35806:t=>{t.exports="resume"},22106:t=>{t.exports="sleepend"},5803:t=>{t.exports="sleepstart"},35416:(t,e,n)=>{t.exports={AFTER_ADD:n(63201),AFTER_REMOVE:n(30474),AFTER_UPDATE:n(44822),BEFORE_ADD:n(88820),BEFORE_REMOVE:n(94849),BEFORE_UPDATE:n(6391),COLLISION_ACTIVE:n(96738),COLLISION_END:n(7916),COLLISION_START:n(59529),DRAG_END:n(10219),DRAG:n(183),DRAG_START:n(39143),PAUSE:n(16483),RESUME:n(35806),SLEEP_END:n(22106),SLEEP_START:n(5803)}},45949:(t,e,n)=>{t.exports={BodyBounds:n(63568),Components:n(74527),Events:n(35416),Factory:n(72653),MatterGameObject:n(3860),Image:n(7030),Matter:n(18171),MatterPhysics:n(50583),PolyDecomp:n(81084),Sprite:n(73658),TileBody:n(84720),PhysicsEditorParser:n(10998),PhysicsJSONParser:n(72829),PointerConstraint:n(88596),World:n(31468)}},84125:(t,e,n)=>{var i={};t.exports=i;var r=n(39745),s=n(10438),o=n(22806),a=n(68758),c=n(84091),l=n(50658);!function(){i._timeCorrection=!0,i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i._baseDelta=1e3/60,i.create=function(e){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:null,position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inverseMass:0,inertia:0,deltaTime:1e3/60,inverseInertia:0,_original:null,render:{visible:!0,opacity:1,sprite:{xOffset:0,yOffset:0},fillColor:null,fillOpacity:null,lineColor:null,lineOpacity:null,lineThickness:null},gameObject:null,scale:{x:1,y:1},centerOfMass:{x:0,y:0},centerOffset:{x:0,y:0},gravityScale:{x:1,y:1},ignoreGravity:!1,ignorePointer:!1,onCollideCallback:null,onCollideEndCallback:null,onCollideActiveCallback:null,onCollideWith:{}};!e.hasOwnProperty("position")&&e.hasOwnProperty("vertices")?e.position=r.centre(e.vertices):e.hasOwnProperty("vertices")||(n.vertices=r.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"));var i=a.extend(n,e);return t(i,e),i.setOnCollideWith=function(t,e){return e?this.onCollideWith[t.id]=e:delete this.onCollideWith[t.id],this},i},i.nextGroup=function(t){return t?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var t=function(t,e){if(e=e||{},i.set(t,{bounds:t.bounds||c.create(t.vertices),positionPrev:t.positionPrev||s.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),r.rotate(t.vertices,t.angle,t.position),l.rotate(t.axes,t.angle),c.update(t.bounds,t.vertices,t.velocity),i.set(t,{axes:e.axes||t.axes,area:e.area||t.area,mass:e.mass||t.mass,inertia:e.inertia||t.inertia}),1===t.parts.length){var n=t.bounds,o=t.centerOfMass,a=t.centerOffset,u=n.max.x-n.min.x,h=n.max.y-n.min.y;o.x=-(n.min.x-t.position.x)/u,o.y=-(n.min.y-t.position.y)/h,a.x=u*o.x,a.y=h*o.y}};i.set=function(t,e,n){var r;for(r in"string"===typeof e&&(r=e,(e={})[r]=n),e)if(Object.prototype.hasOwnProperty.call(e,r))switch(n=e[r],r){case"isStatic":i.setStatic(t,n);break;case"isSleeping":o.set(t,n);break;case"mass":i.setMass(t,n);break;case"density":i.setDensity(t,n);break;case"inertia":i.setInertia(t,n);break;case"vertices":i.setVertices(t,n);break;case"position":i.setPosition(t,n);break;case"angle":i.setAngle(t,n);break;case"velocity":i.setVelocity(t,n);break;case"angularVelocity":i.setAngularVelocity(t,n);break;case"speed":i.setSpeed(t,n);break;case"angularSpeed":i.setAngularSpeed(t,n);break;case"parts":i.setParts(t,n);break;case"centre":i.setCentre(t,n);break;default:t[r]=n}},i.setStatic=function(t,e){for(var n=0;n<t.parts.length;n++){var i=t.parts[n];e?(i.isStatic||(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia}),i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null),i.isStatic=e}},i.setMass=function(t,e){var n=t.inertia/(t.mass/6);t.inertia=n*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},i.setDensity=function(t,e){i.setMass(t,e*t.area),t.density=e},i.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},i.setVertices=function(t,e){e[0].body===t?t.vertices=e:t.vertices=r.create(e,t),t.axes=l.fromVertices(t.vertices),t.area=r.area(t.vertices),i.setMass(t,t.density*t.area);var n=r.centre(t.vertices);r.translate(t.vertices,n,-1),i.setInertia(t,i._inertiaScale*r.inertia(t.vertices,t.mass)),r.translate(t.vertices,t.position),c.update(t.bounds,t.vertices,t.velocity)},i.setParts=function(t,e,n){var s;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,s=0;s<e.length;s++){var o=e[s];o!==t&&(o.parent=t,t.parts.push(o))}if(1!==t.parts.length){if(n="undefined"===typeof n||n){var a=[];for(s=0;s<e.length;s++)a=a.concat(e[s].vertices);r.clockwiseSort(a);var l=r.hull(a),u=r.centre(l);i.setVertices(t,l),r.translate(t.vertices,u)}var h=i._totalProperties(t),d=h.centre.x,p=h.centre.y,f=t.bounds,m=t.centerOfMass,g=t.centerOffset;c.update(f,t.vertices,t.velocity),m.x=-(f.min.x-d)/(f.max.x-f.min.x),m.y=-(f.min.y-p)/(f.max.y-f.min.y),g.x=d,g.y=p,t.area=h.area,t.parent=t,t.position.x=d,t.position.y=p,t.positionPrev.x=d,t.positionPrev.y=p,i.setMass(t,h.mass),i.setInertia(t,h.inertia),i.setPosition(t,h.centre)}},i.setCentre=function(t,e,n){n?(t.positionPrev.x+=e.x,t.positionPrev.y+=e.y,t.position.x+=e.x,t.position.y+=e.y):(t.positionPrev.x=e.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=e.y-(t.position.y-t.positionPrev.y),t.position.x=e.x,t.position.y=e.y)},i.setPosition=function(t,e,n){var i=s.sub(e,t.position);n?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=i.x,t.velocity.y=i.y,t.speed=s.magnitude(i)):(t.positionPrev.x+=i.x,t.positionPrev.y+=i.y);for(var o=0;o<t.parts.length;o++){var a=t.parts[o];a.position.x+=i.x,a.position.y+=i.y,r.translate(a.vertices,i),c.update(a.bounds,a.vertices,t.velocity)}},i.setAngle=function(t,e,n){var i=e-t.angle;n?(t.anglePrev=t.angle,t.angularVelocity=i,t.angularSpeed=Math.abs(i)):t.anglePrev+=i;for(var o=0;o<t.parts.length;o++){var a=t.parts[o];a.angle+=i,r.rotate(a.vertices,i,t.position),l.rotate(a.axes,i),c.update(a.bounds,a.vertices,t.velocity),o>0&&s.rotateAbout(a.position,i,t.position,a.position)}},i.setVelocity=function(t,e){var n=t.deltaTime/i._baseDelta;t.positionPrev.x=t.position.x-e.x*n,t.positionPrev.y=t.position.y-e.y*n,t.velocity.x=(t.position.x-t.positionPrev.x)/n,t.velocity.y=(t.position.y-t.positionPrev.y)/n,t.speed=s.magnitude(t.velocity)},i.getVelocity=function(t){var e=i._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*e,y:(t.position.y-t.positionPrev.y)*e}},i.getSpeed=function(t){return s.magnitude(i.getVelocity(t))},i.setSpeed=function(t,e){i.setVelocity(t,s.mult(s.normalise(i.getVelocity(t)),e))},i.setAngularVelocity=function(t,e){var n=t.deltaTime/i._baseDelta;t.anglePrev=t.angle-e*n,t.angularVelocity=(t.angle-t.anglePrev)/n,t.angularSpeed=Math.abs(t.angularVelocity)},i.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*i._baseDelta/t.deltaTime},i.getAngularSpeed=function(t){return Math.abs(i.getAngularVelocity(t))},i.setAngularSpeed=function(t,e){i.setAngularVelocity(t,a.sign(i.getAngularVelocity(t))*e)},i.translate=function(t,e,n){i.setPosition(t,s.add(t.position,e),n)},i.rotate=function(t,e,n,r){if(n){var s=Math.cos(e),o=Math.sin(e),a=t.position.x-n.x,c=t.position.y-n.y;i.setPosition(t,{x:n.x+(a*s-c*o),y:n.y+(a*o+c*s)},r),i.setAngle(t,t.angle+e,r)}else i.setAngle(t,t.angle+e,r)},i.scale=function(t,e,n,s){var o=0,a=0;s=s||t.position;for(var u=0;u<t.parts.length;u++){var h=t.parts[u];h.scale.x=e,h.scale.y=n,r.scale(h.vertices,e,n,s),h.axes=l.fromVertices(h.vertices),h.area=r.area(h.vertices),i.setMass(h,t.density*h.area),r.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),i.setInertia(h,i._inertiaScale*r.inertia(h.vertices,h.mass)),r.translate(h.vertices,{x:h.position.x,y:h.position.y}),u>0&&(o+=h.area,a+=h.inertia),h.position.x=s.x+(h.position.x-s.x)*e,h.position.y=s.y+(h.position.y-s.y)*n,c.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=o,t.isStatic||(i.setMass(t,t.density*o),i.setInertia(t,a))),t.circleRadius&&(e===n?t.circleRadius*=e:t.circleRadius=null)},i.update=function(t,e){var n=(e=("undefined"!==typeof e?e:1e3/60)*t.timeScale)*e,o=i._timeCorrection?e/(t.deltaTime||e):1,u=1-t.frictionAir*(e/a._baseDelta),h=(t.position.x-t.positionPrev.x)*o,d=(t.position.y-t.positionPrev.y)*o;t.velocity.x=h*u+t.force.x/t.mass*n,t.velocity.y=d*u+t.force.y/t.mass*n,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=e,t.angularVelocity=(t.angle-t.anglePrev)*u*o+t.torque/t.inertia*n,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=s.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var p=0;p<t.parts.length;p++){var f=t.parts[p];r.translate(f.vertices,t.velocity),p>0&&(f.position.x+=t.velocity.x,f.position.y+=t.velocity.y),0!==t.angularVelocity&&(r.rotate(f.vertices,t.angularVelocity,t.position),l.rotate(f.axes,t.angularVelocity),p>0&&s.rotateAbout(f.position,t.angularVelocity,t.position,f.position)),c.update(f.bounds,f.vertices,t.velocity)}},i.updateVelocities=function(t){var e=i._baseDelta/t.deltaTime,n=t.velocity;n.x=(t.position.x-t.positionPrev.x)*e,n.y=(t.position.y-t.positionPrev.y)*e,t.speed=Math.sqrt(n.x*n.x+n.y*n.y),t.angularVelocity=(t.angle-t.anglePrev)*e,t.angularSpeed=Math.abs(t.angularVelocity)},i.applyForce=function(t,e,n){var i=e.x-t.position.x,r=e.y-t.position.y;t.force.x+=n.x,t.force.y+=n.y,t.torque+=i*n.y-r*n.x},i._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===t.parts.length?0:1;n<t.parts.length;n++){var i=t.parts[n],r=i.mass!==1/0?i.mass:1;e.mass+=r,e.area+=i.area,e.inertia+=i.inertia,e.centre=s.add(e.centre,s.mult(i.position,r))}return e.centre=s.div(e.centre,e.mass),e}}()},11299:(t,e,n)=>{var i={};t.exports=i;var r=n(39073),s=n(68758),o=n(84091),a=n(84125);i.create=function(t){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},t)},i.setModified=function(t,e,n,s){if(r.trigger(t,"compositeModified",t),t.isModified=e,e&&t.cache&&(t.cache.allBodies=null,t.cache.allConstraints=null,t.cache.allComposites=null),n&&t.parent&&i.setModified(t.parent,e,n,s),s)for(var o=0;o<t.composites.length;o++){var a=t.composites[o];i.setModified(a,e,n,s)}},i.add=function(t,e){var n=[].concat(e);r.trigger(t,"beforeAdd",{object:e});for(var o=0;o<n.length;o++){var a=n[o];switch(a.type){case"body":if(a.parent!==a){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(t,a);break;case"constraint":i.addConstraint(t,a);break;case"composite":i.addComposite(t,a);break;case"mouseConstraint":i.addConstraint(t,a.constraint)}}return r.trigger(t,"afterAdd",{object:e}),t},i.remove=function(t,e,n){var s=[].concat(e);r.trigger(t,"beforeRemove",{object:e});for(var o=0;o<s.length;o++){var a=s[o];switch(a.type){case"body":i.removeBody(t,a,n);break;case"constraint":i.removeConstraint(t,a,n);break;case"composite":i.removeComposite(t,a,n);break;case"mouseConstraint":i.removeConstraint(t,a.constraint)}}return r.trigger(t,"afterRemove",{object:e}),t},i.addComposite=function(t,e){return t.composites.push(e),e.parent=t,i.setModified(t,!0,!0,!1),t},i.removeComposite=function(t,e,n){var r=s.indexOf(t.composites,e);if(-1!==r&&i.removeCompositeAt(t,r),n)for(var o=0;o<t.composites.length;o++)i.removeComposite(t.composites[o],e,!0);return t},i.removeCompositeAt=function(t,e){return t.composites.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addBody=function(t,e){return t.bodies.push(e),i.setModified(t,!0,!0,!1),t},i.removeBody=function(t,e,n){var r=s.indexOf(t.bodies,e);if(-1!==r&&i.removeBodyAt(t,r),n)for(var o=0;o<t.composites.length;o++)i.removeBody(t.composites[o],e,!0);return t},i.removeBodyAt=function(t,e){return t.bodies.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addConstraint=function(t,e){return t.constraints.push(e),i.setModified(t,!0,!0,!1),t},i.removeConstraint=function(t,e,n){var r=s.indexOf(t.constraints,e);if(-1!==r&&i.removeConstraintAt(t,r),n)for(var o=0;o<t.composites.length;o++)i.removeConstraint(t.composites[o],e,!0);return t},i.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),i.setModified(t,!0,!0,!1),t},i.clear=function(t,e,n){if(n)for(var r=0;r<t.composites.length;r++)i.clear(t.composites[r],e,!0);return e?t.bodies=t.bodies.filter((function(t){return t.isStatic})):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,i.setModified(t,!0,!0,!1),t},i.allBodies=function(t){if(t.cache&&t.cache.allBodies)return t.cache.allBodies;for(var e=[].concat(t.bodies),n=0;n<t.composites.length;n++)e=e.concat(i.allBodies(t.composites[n]));return t.cache&&(t.cache.allBodies=e),e},i.allConstraints=function(t){if(t.cache&&t.cache.allConstraints)return t.cache.allConstraints;for(var e=[].concat(t.constraints),n=0;n<t.composites.length;n++)e=e.concat(i.allConstraints(t.composites[n]));return t.cache&&(t.cache.allConstraints=e),e},i.allComposites=function(t){if(t.cache&&t.cache.allComposites)return t.cache.allComposites;for(var e=[].concat(t.composites),n=0;n<t.composites.length;n++)e=e.concat(i.allComposites(t.composites[n]));return t.cache&&(t.cache.allComposites=e),e},i.get=function(t,e,n){var r,s;switch(n){case"body":r=i.allBodies(t);break;case"constraint":r=i.allConstraints(t);break;case"composite":r=i.allComposites(t).concat(t)}return r?0===(s=r.filter((function(t){return t.id.toString()===e.toString()}))).length?null:s[0]:null},i.move=function(t,e,n){return i.remove(t,e),i.add(n,e),t},i.rebase=function(t){for(var e=i.allBodies(t).concat(i.allConstraints(t)).concat(i.allComposites(t)),n=0;n<e.length;n++)e[n].id=s.nextId();return t},i.translate=function(t,e,n){for(var r=n?i.allBodies(t):t.bodies,s=0;s<r.length;s++)a.translate(r[s],e);return t},i.rotate=function(t,e,n,r){for(var s=Math.cos(e),o=Math.sin(e),c=r?i.allBodies(t):t.bodies,l=0;l<c.length;l++){var u=c[l],h=u.position.x-n.x,d=u.position.y-n.y;a.setPosition(u,{x:n.x+(h*s-d*o),y:n.y+(h*o+d*s)}),a.rotate(u,e)}return t},i.scale=function(t,e,n,r,s){for(var o=s?i.allBodies(t):t.bodies,c=0;c<o.length;c++){var l=o[c],u=l.position.x-r.x,h=l.position.y-r.y;a.setPosition(l,{x:r.x+u*e,y:r.y+h*n}),a.scale(l,e,n)}return t},i.bounds=function(t){for(var e=i.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return o.create(n)}},72005:(t,e,n)=>{var i={};t.exports=i;var r=n(11299);i.create=r.create,i.add=r.add,i.remove=r.remove,i.clear=r.clear,i.addComposite=r.addComposite,i.addBody=r.addBody,i.addConstraint=r.addConstraint},63454:(t,e,n)=>{var i={};t.exports=i;var r=n(39745),s=n(70584);!function(){var t=[],e={overlap:0,axis:null},n={overlap:0,axis:null};i.create=function(t,e){return{pair:null,collided:!1,bodyA:t,bodyB:e,parentA:t.parent,parentB:e.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(t,o,a){if(i._overlapAxes(e,t.vertices,o.vertices,t.axes),e.overlap<=0)return null;if(i._overlapAxes(n,o.vertices,t.vertices,o.axes),n.overlap<=0)return null;var c,l,u=a&&a.table[s.id(t,o)];u?c=u.collision:((c=i.create(t,o)).collided=!0,c.bodyA=t.id<o.id?t:o,c.bodyB=t.id<o.id?o:t,c.parentA=c.bodyA.parent,c.parentB=c.bodyB.parent),t=c.bodyA,o=c.bodyB,l=e.overlap<n.overlap?e:n;var h=c.normal,d=c.supports,p=l.axis,f=p.x,m=p.y;f*(o.position.x-t.position.x)+m*(o.position.y-t.position.y)<0?(h.x=f,h.y=m):(h.x=-f,h.y=-m),c.tangent.x=-h.y,c.tangent.y=h.x,c.depth=l.overlap,c.penetration.x=h.x*c.depth,c.penetration.y=h.y*c.depth;var g=i._findSupports(t,o,h,1),v=0;if(r.contains(t.vertices,g[0])&&(d[v++]=g[0]),r.contains(t.vertices,g[1])&&(d[v++]=g[1]),v<2){var y=i._findSupports(o,t,h,-1);r.contains(o.vertices,y[0])&&(d[v++]=y[0]),v<2&&r.contains(o.vertices,y[1])&&(d[v++]=y[1])}return 0===v&&(d[v++]=g[0]),d.length=v,c},i._overlapAxes=function(t,e,n,i){var r,s,o,a,c,l,u=e.length,h=n.length,d=e[0].x,p=e[0].y,f=n[0].x,m=n[0].y,g=i.length,v=Number.MAX_VALUE,y=0;for(c=0;c<g;c++){var x=i[c],b=x.x,w=x.y,S=d*b+p*w,_=f*b+m*w,T=S,E=_;for(l=1;l<u;l+=1)(a=e[l].x*b+e[l].y*w)>T?T=a:a<S&&(S=a);for(l=1;l<h;l+=1)(a=n[l].x*b+n[l].y*w)>E?E=a:a<_&&(_=a);if((r=(s=T-_)<(o=E-S)?s:o)<v&&(v=r,y=c,r<=0))break}t.axis=i[y],t.overlap=v},i._projectToAxis=function(t,e,n){for(var i=e[0].x*n.x+e[0].y*n.y,r=i,s=1;s<e.length;s+=1){var o=e[s].x*n.x+e[s].y*n.y;o>r?r=o:o<i&&(i=o)}t.min=i,t.max=r},i._findSupports=function(e,n,i,r){var s,o,a,c,l,u=n.vertices,h=u.length,d=e.position.x,p=e.position.y,f=i.x*r,m=i.y*r,g=Number.MAX_VALUE;for(l=0;l<h;l+=1)(c=f*(d-(o=u[l]).x)+m*(p-o.y))<g&&(g=c,s=o);return g=f*(d-(a=u[(h+s.index-1)%h]).x)+m*(p-a.y),f*(d-(o=u[(s.index+1)%h]).x)+m*(p-o.y)<g?(t[0]=s,t[1]=o,t):(t[0]=s,t[1]=a,t)}}()},17319:t=>{var e={};t.exports=e,e.create=function(t){return{vertex:t,normalImpulse:0,tangentImpulse:0}}},13657:(t,e,n)=>{var i={};t.exports=i;var r=n(68758),s=n(63454);i.create=function(t){return r.extend({bodies:[],pairs:null},t)},i.setBodies=function(t,e){t.bodies=e.slice(0)},i.clear=function(t){t.bodies=[]},i.collisions=function(t){var e,n,r=[],o=t.pairs,a=t.bodies,c=a.length,l=i.canCollide,u=s.collides;for(a.sort(i._compareBoundsX),e=0;e<c;e++){var h=a[e],d=h.bounds,p=h.bounds.max.x,f=h.bounds.max.y,m=h.bounds.min.y,g=h.isStatic||h.isSleeping,v=h.parts.length,y=1===v;for(n=e+1;n<c;n++){var x=a[n];if((k=x.bounds).min.x>p)break;if(!(f<k.min.y||m>k.max.y)&&(!g||!x.isStatic&&!x.isSleeping)&&l(h.collisionFilter,x.collisionFilter)){var b=x.parts.length;if(y&&1===b)(E=u(h,x,o))&&r.push(E);else for(var w=b>1?1:0,S=v>1?1:0;S<v;S++)for(var _=h.parts[S],T=(d=_.bounds,w);T<b;T++){var E,C=x.parts[T],k=C.bounds;d.min.x>k.max.x||d.max.x<k.min.x||d.max.y<k.min.y||d.min.y>k.max.y||(E=u(_,C,o))&&r.push(E)}}}}return r},i.canCollide=function(t,e){return t.group===e.group&&0!==t.group?t.group>0:0!==(t.mask&e.category)&&0!==(e.mask&t.category)},i._compareBoundsX=function(t,e){return t.bounds.min.x-e.bounds.min.x}},70584:(t,e,n)=>{var i={};t.exports=i;var r=n(17319);i.create=function(t,e){var n=t.bodyA,r=t.bodyB,s={id:i.id(n,r),bodyA:n,bodyB:r,collision:t,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||r.isSensor,timeCreated:e,timeUpdated:e,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(s,t,e),s},i.update=function(t,e,n){var i=t.contacts,s=e.supports,o=t.activeContacts,a=e.parentA,c=e.parentB,l=a.vertices.length;t.isActive=!0,t.timeUpdated=n,t.collision=e,t.separation=e.depth,t.inverseMass=a.inverseMass+c.inverseMass,t.friction=a.friction<c.friction?a.friction:c.friction,t.frictionStatic=a.frictionStatic>c.frictionStatic?a.frictionStatic:c.frictionStatic,t.restitution=a.restitution>c.restitution?a.restitution:c.restitution,t.slop=a.slop>c.slop?a.slop:c.slop,e.pair=t,o.length=0;for(var u=0;u<s.length;u++){var h=s[u],d=h.body===a?h.index:l+h.index,p=i[d];p?o.push(p):o.push(i[d]=r.create(h))}},i.setActive=function(t,e,n){e?(t.isActive=!0,t.timeUpdated=n):(t.isActive=!1,t.activeContacts.length=0)},i.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}},91327:(t,e,n)=>{var i={};t.exports=i;var r=n(70584),s=n(68758);i.create=function(t){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},i.update=function(t,e,n){var i,s,o,a,c=t.list,l=c.length,u=t.table,h=e.length,d=t.collisionStart,p=t.collisionEnd,f=t.collisionActive;for(d.length=0,p.length=0,f.length=0,a=0;a<l;a++)c[a].confirmedActive=!1;for(a=0;a<h;a++)(o=(i=e[a]).pair)?(o.isActive?f.push(o):d.push(o),r.update(o,i,n),o.confirmedActive=!0):(u[(o=r.create(i,n)).id]=o,d.push(o),c.push(o));var m=[];for(l=c.length,a=0;a<l;a++)(o=c[a]).confirmedActive||(r.setActive(o,!1,n),p.push(o),o.collision.bodyA.isSleeping||o.collision.bodyB.isSleeping||m.push(a));for(a=0;a<m.length;a++)o=c[s=m[a]-a],c.splice(s,1),delete u[o.id]},i.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}},13390:(t,e,n)=>{var i={};t.exports=i;var r=n(10438),s=n(63454),o=n(84091),a=n(68516),c=n(39745);i.collides=function(t,e){for(var n=[],i=e.length,r=t.bounds,a=s.collides,c=o.overlaps,l=0;l<i;l++){var u=e[l],h=u.parts.length,d=1===h?0:1;if(t!==u&&c(u.bounds,r))for(var p=d;p<h;p++){var f=u.parts[p];if(c(f.bounds,r)){var m=a(f,t);if(m){n.push(m);break}}}}return n},i.ray=function(t,e,n,s){s=s||1e-100;for(var o=r.angle(e,n),c=r.magnitude(r.sub(e,n)),l=.5*(n.x+e.x),u=.5*(n.y+e.y),h=a.rectangle(l,u,c,s,{angle:o}),d=i.collides(h,t),p=0;p<d.length;p+=1){var f=d[p];f.body=f.bodyB=f.bodyA}return d},i.region=function(t,e,n){for(var i=[],r=0;r<t.length;r++){var s=t[r],a=o.overlaps(s.bounds,e);(a&&!n||!a&&n)&&i.push(s)}return i},i.point=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(o.contains(r.bounds,e))for(var s=1===r.parts.length?0:1;s<r.parts.length;s++){var a=r.parts[s];if(o.contains(a.bounds,e)&&c.contains(a.vertices,e)){n.push(r);break}}}return n}},44272:(t,e,n)=>{var i={};t.exports=i;var r=n(39745),s=n(68758),o=n(84091);i._restingThresh=2,i._restingThreshTangent=Math.sqrt(6),i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i._frictionMaxStatic=Number.MAX_VALUE,i.preSolvePosition=function(t){var e,n,i,r=t.length;for(e=0;e<r;e++)(n=t[e]).isActive&&(i=n.activeContacts.length,n.collision.parentA.totalContacts+=i,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(t,e,n){var r,o,a,c,l,u,h,d,p=i._positionDampen*(n||1),f=s.clamp(e/s._baseDelta,0,1),m=t.length;for(r=0;r<m;r++)(o=t[r]).isActive&&!o.isSensor&&(c=(a=o.collision).parentA,l=a.parentB,u=a.normal,o.separation=u.x*(l.positionImpulse.x+a.penetration.x-c.positionImpulse.x)+u.y*(l.positionImpulse.y+a.penetration.y-c.positionImpulse.y));for(r=0;r<m;r++)(o=t[r]).isActive&&!o.isSensor&&(c=(a=o.collision).parentA,l=a.parentB,u=a.normal,d=o.separation-o.slop*f,(c.isStatic||l.isStatic)&&(d*=2),c.isStatic||c.isSleeping||(h=p/c.totalContacts,c.positionImpulse.x+=u.x*d*h,c.positionImpulse.y+=u.y*d*h),l.isStatic||l.isSleeping||(h=p/l.totalContacts,l.positionImpulse.x-=u.x*d*h,l.positionImpulse.y-=u.y*d*h))},i.postSolvePosition=function(t){for(var e=i._positionWarming,n=t.length,s=r.translate,a=o.update,c=0;c<n;c++){var l=t[c],u=l.positionImpulse,h=u.x,d=u.y,p=l.velocity;if(l.totalContacts=0,0!==h||0!==d){for(var f=0;f<l.parts.length;f++){var m=l.parts[f];s(m.vertices,u),a(m.bounds,m.vertices,p),m.position.x+=h,m.position.y+=d}l.positionPrev.x+=h,l.positionPrev.y+=d,h*p.x+d*p.y<0?(u.x=0,u.y=0):(u.x*=e,u.y*=e)}}},i.preSolveVelocity=function(t){var e,n,i=t.length;for(e=0;e<i;e++){var r=t[e];if(r.isActive&&!r.isSensor){var s=r.activeContacts,o=s.length,a=r.collision,c=a.parentA,l=a.parentB,u=a.normal,h=a.tangent;for(n=0;n<o;n++){var d=s[n],p=d.vertex,f=d.normalImpulse,m=d.tangentImpulse;if(0!==f||0!==m){var g=u.x*f+h.x*m,v=u.y*f+h.y*m;c.isStatic||c.isSleeping||(c.positionPrev.x+=g*c.inverseMass,c.positionPrev.y+=v*c.inverseMass,c.anglePrev+=c.inverseInertia*((p.x-c.position.x)*v-(p.y-c.position.y)*g)),l.isStatic||l.isSleeping||(l.positionPrev.x-=g*l.inverseMass,l.positionPrev.y-=v*l.inverseMass,l.anglePrev-=l.inverseInertia*((p.x-l.position.x)*v-(p.y-l.position.y)*g))}}}}},i.solveVelocity=function(t,e){var n,r,o,a,c=e/s._baseDelta,l=c*c*c,u=-i._restingThresh*c,h=i._restingThreshTangent,d=i._frictionNormalMultiplier*c,p=i._frictionMaxStatic,f=t.length;for(o=0;o<f;o++){var m=t[o];if(m.isActive&&!m.isSensor){var g=m.collision,v=g.parentA,y=g.parentB,x=v.velocity,b=y.velocity,w=g.normal.x,S=g.normal.y,_=g.tangent.x,T=g.tangent.y,E=m.activeContacts,C=E.length,k=1/C,A=v.inverseMass+y.inverseMass,I=m.friction*m.frictionStatic*d;for(x.x=v.position.x-v.positionPrev.x,x.y=v.position.y-v.positionPrev.y,b.x=y.position.x-y.positionPrev.x,b.y=y.position.y-y.positionPrev.y,v.angularVelocity=v.angle-v.anglePrev,y.angularVelocity=y.angle-y.anglePrev,a=0;a<C;a++){var O=E[a],R=O.vertex,N=R.x-v.position.x,M=R.y-v.position.y,D=R.x-y.position.x,P=R.y-y.position.y,F=x.x-M*v.angularVelocity,L=x.y+N*v.angularVelocity,B=F-(b.x-P*y.angularVelocity),z=L-(b.y+D*y.angularVelocity),U=w*B+S*z,j=_*B+T*z,V=m.separation+U,W=Math.min(V,1),G=(W=V<0?0:W)*I;j<-G||j>G?(r=j>0?j:-j,(n=m.friction*(j>0?1:-1)*l)<-r?n=-r:n>r&&(n=r)):(n=j,r=p);var q=N*S-M*w,H=D*S-P*w,X=k/(A+v.inverseInertia*q*q+y.inverseInertia*H*H),Y=(1+m.restitution)*U*X;if(n*=X,U<u)O.normalImpulse=0;else{var K=O.normalImpulse;O.normalImpulse+=Y,O.normalImpulse>0&&(O.normalImpulse=0),Y=O.normalImpulse-K}if(j<-h||j>h)O.tangentImpulse=0;else{var Q=O.tangentImpulse;O.tangentImpulse+=n,O.tangentImpulse<-r&&(O.tangentImpulse=-r),O.tangentImpulse>r&&(O.tangentImpulse=r),n=O.tangentImpulse-Q}var Z=w*Y+_*n,J=S*Y+T*n;v.isStatic||v.isSleeping||(v.positionPrev.x+=Z*v.inverseMass,v.positionPrev.y+=J*v.inverseMass,v.anglePrev+=(N*J-M*Z)*v.inverseInertia),y.isStatic||y.isSleeping||(y.positionPrev.x-=Z*y.inverseMass,y.positionPrev.y-=J*y.inverseMass,y.anglePrev-=(D*J-P*Z)*y.inverseInertia)}}}}},52838:(t,e,n)=>{var i={};t.exports=i;var r=n(39745),s=n(10438),o=n(22806),a=n(84091),c=n(50658),l=n(68758);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(t){var e=t;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?s.add(e.bodyA.position,e.pointA):e.pointA,i=e.bodyB?s.add(e.bodyB.position,e.pointB):e.pointB,r=s.magnitude(s.sub(n,i));e.length="undefined"!==typeof e.length?e.length:r,e.id=e.id||l.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var o={visible:!0,type:"line",anchors:!0,lineColor:null,lineOpacity:null,lineThickness:null,pinSize:null,anchorColor:null,anchorSize:null};return 0===e.length&&e.stiffness>.1?(o.type="pin",o.anchors=!1):e.stiffness<.9&&(o.type="spring"),e.render=l.extend(o,e.render),e},i.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var n=t[e],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(t,e){for(var n=l.clamp(e/l._baseDelta,0,1),r=0;r<t.length;r+=1){var s=t[r],o=!s.bodyA||s.bodyA&&s.bodyA.isStatic,a=!s.bodyB||s.bodyB&&s.bodyB.isStatic;(o||a)&&i.solve(t[r],n)}for(r=0;r<t.length;r+=1)o=!(s=t[r]).bodyA||s.bodyA&&s.bodyA.isStatic,a=!s.bodyB||s.bodyB&&s.bodyB.isStatic,o||a||i.solve(t[r],n)},i.solve=function(t,e){var n=t.bodyA,r=t.bodyB,o=t.pointA,a=t.pointB;if(n||r){n&&!n.isStatic&&(s.rotate(o,n.angle-t.angleA,o),t.angleA=n.angle),r&&!r.isStatic&&(s.rotate(a,r.angle-t.angleB,a),t.angleB=r.angle);var c=o,l=a;if(n&&(c=s.add(n.position,o)),r&&(l=s.add(r.position,a)),c&&l){var u=s.sub(c,l),h=s.magnitude(u);h<i._minLength&&(h=i._minLength);var d,p,f,m,g,v=(h-t.length)/h,y=t.stiffness>=1||0===t.length?t.stiffness*e:t.stiffness*e*e,x=t.damping*e,b=s.mult(u,v*y),w=(n?n.inverseMass:0)+(r?r.inverseMass:0),S=w+((n?n.inverseInertia:0)+(r?r.inverseInertia:0));if(x>0){var _=s.create();f=s.div(u,h),g=s.sub(r&&s.sub(r.position,r.positionPrev)||_,n&&s.sub(n.position,n.positionPrev)||_),m=s.dot(f,g)}n&&!n.isStatic&&(p=n.inverseMass/w,n.constraintImpulse.x-=b.x*p,n.constraintImpulse.y-=b.y*p,n.position.x-=b.x*p,n.position.y-=b.y*p,x>0&&(n.positionPrev.x-=x*f.x*m*p,n.positionPrev.y-=x*f.y*m*p),d=s.cross(o,b)/S*i._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle-=d,n.angle-=d),r&&!r.isStatic&&(p=r.inverseMass/w,r.constraintImpulse.x+=b.x*p,r.constraintImpulse.y+=b.y*p,r.position.x+=b.x*p,r.position.y+=b.y*p,x>0&&(r.positionPrev.x+=x*f.x*m*p,r.positionPrev.y+=x*f.y*m*p),d=s.cross(a,b)/S*i._torqueDampen*r.inverseInertia*(1-t.angularStiffness),r.constraintImpulse.angle+=d,r.angle+=d)}}},i.postSolveAll=function(t){for(var e=0;e<t.length;e++){var n=t[e],l=n.constraintImpulse;if(!(n.isStatic||0===l.x&&0===l.y&&0===l.angle)){o.set(n,!1);for(var u=0;u<n.parts.length;u++){var h=n.parts[u];r.translate(h.vertices,l),u>0&&(h.position.x+=l.x,h.position.y+=l.y),0!==l.angle&&(r.rotate(h.vertices,l.angle,n.position),c.rotate(h.axes,l.angle),u>0&&s.rotateAbout(h.position,l.angle,n.position,h.position)),a.update(h.bounds,h.vertices,n.velocity)}l.angle*=i._warming,l.x*=i._warming,l.y*=i._warming}}},i.pointAWorld=function(t){return{x:(t.bodyA?t.bodyA.position.x:0)+(t.pointA?t.pointA.x:0),y:(t.bodyA?t.bodyA.position.y:0)+(t.pointA?t.pointA.y:0)}},i.pointBWorld=function(t){return{x:(t.bodyB?t.bodyB.position.x:0)+(t.pointB?t.pointB.x:0),y:(t.bodyB?t.bodyB.position.y:0)+(t.pointB?t.pointB.y:0)}},i.currentLength=function(t){var e=(t.bodyA?t.bodyA.position.x:0)+(t.pointA?t.pointA.x:0),n=(t.bodyA?t.bodyA.position.y:0)+(t.pointA?t.pointA.y:0),i=e-((t.bodyB?t.bodyB.position.x:0)+(t.pointB?t.pointB.x:0)),r=n-((t.bodyB?t.bodyB.position.y:0)+(t.pointB?t.pointB.y:0));return Math.sqrt(i*i+r*r)}},68758:(t,e,n)=>{var i={};t.exports=i,function(){i._baseDelta=1e3/60,i._nextId=0,i._seed=0,i._nowStartTime=+new Date,i._warnedOnce={},i._decomp=null,i.extend=function(t,e){var n,r;"boolean"===typeof e?(n=2,r=e):(n=1,r=!0);for(var s=n;s<arguments.length;s++){var o=arguments[s];if(o)for(var a in o)r&&o[a]&&o[a].constructor===Object?t[a]&&t[a].constructor!==Object?t[a]=o[a]:(t[a]=t[a]||{},i.extend(t[a],r,o[a])):t[a]=o[a]}return t},i.clone=function(t,e){return i.extend({},e,t)},i.keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},i.values=function(t){var e=[];if(Object.keys){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(t[n[i]]);return e}for(var r in t)e.push(t[r]);return e},i.get=function(t,e,n,i){e=e.split(".").slice(n,i);for(var r=0;r<e.length;r+=1)t=t[e[r]];return t},i.set=function(t,e,n,r,s){var o=e.split(".").slice(r,s);return i.get(t,e,0,-1)[o[o.length-1]]=n,n},i.shuffle=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(i.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t},i.choose=function(t){return t[Math.floor(i.random()*t.length)]},i.isElement=function(t){return"undefined"!==typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isFunction=function(t){return"function"===typeof t},i.isPlainObject=function(t){return"object"===typeof t&&t.constructor===Object},i.isString=function(t){return"[object String]"===toString.call(t)},i.clamp=function(t,e,n){return t<e?e:t>n?n:t},i.sign=function(t){return t<0?-1:1},i.now=function(){if("undefined"!==typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-i._nowStartTime},i.random=function(e,n){return n="undefined"!==typeof n?n:1,(e="undefined"!==typeof e?e:0)+t()*(n-e)};var t=function(){return i._seed=(9301*i._seed+49297)%233280,i._seed/233280};i.colorToNumber=function(t){return 3==(t=t.replace("#","")).length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},i.logLevel=1,i.log=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.info=function(){console&&i.logLevel>0&&i.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warn=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warnOnce=function(){var t=Array.prototype.slice.call(arguments).join(" ");i._warnedOnce[t]||(i.warn(t),i._warnedOnce[t]=!0)},i.deprecated=function(t,e,n){t[e]=i.chain((function(){i.warnOnce("\ud83d\udd05 deprecated \ud83d\udd05",n)}),t[e])},i.nextId=function(){return i._nextId++},i.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},i.map=function(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n},i.topologicalSort=function(t){var e=[],n=[],r=[];for(var s in t)n[s]||r[s]||i._topologicalSort(s,n,r,t,e);return e},i._topologicalSort=function(t,e,n,r,s){var o=r[t]||[];n[t]=!0;for(var a=0;a<o.length;a+=1){var c=o[a];n[c]||e[c]||i._topologicalSort(c,e,n,r,s)}n[t]=!1,e[t]=!0,s.push(t)},i.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var n=arguments[e];n._chained?t.push.apply(t,n._chained):t.push(n)}var i=function(){for(var e,n=new Array(arguments.length),i=0,r=arguments.length;i<r;i++)n[i]=arguments[i];for(i=0;i<t.length;i+=1){var s=t[i].apply(e,n);"undefined"!==typeof s&&(e=s)}return e};return i._chained=t,i},i.chainPathBefore=function(t,e,n){return i.set(t,e,i.chain(n,i.get(t,e)))},i.chainPathAfter=function(t,e,n){return i.set(t,e,i.chain(i.get(t,e),n))},i.setDecomp=function(t){i._decomp=t},i.getDecomp=function(){var t=i._decomp;try{t||"undefined"===typeof window||(t=window.decomp),t||"undefined"===typeof n.g||(t=n.g.decomp)}catch(e){t=null}return t}}()},45775:(t,e,n)=>{var i={};t.exports=i;var r=n(22806),s=n(44272),o=n(13657),a=n(91327),c=n(39073),l=n(11299),u=n(52838),h=n(68758),d=n(84125);i.create=function(t){t=t||{};var e=h.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},t);return e.world=t.world||l.create({label:"World"}),e.pairs=t.pairs||a.create(),e.detector=t.detector||o.create(),e.grid={buckets:[]},e.world.gravity=e.gravity,e.broadphase=e.grid,e.metrics={},e},i.update=function(t,e){var n,d=h.now(),p=t.world,f=t.detector,m=t.pairs,g=t.timing,v=g.timestamp;e="undefined"!==typeof e?e:h._baseDelta,e*=g.timeScale,g.timestamp+=e,g.lastDelta=e;var y={timestamp:g.timestamp,delta:e};c.trigger(t,"beforeUpdate",y);var x=l.allBodies(p),b=l.allConstraints(p);for(p.isModified&&(o.setBodies(f,x),l.setModified(p,!1,!1,!0)),t.enableSleeping&&r.update(x,e),i._bodiesApplyGravity(x,t.gravity),e>0&&i._bodiesUpdate(x,e),c.trigger(t,"beforeSolve",y),u.preSolveAll(x),n=0;n<t.constraintIterations;n++)u.solveAll(b,e);u.postSolveAll(x),f.pairs=t.pairs;var w=o.collisions(f);a.update(m,w,v),t.enableSleeping&&r.afterCollisions(m.list),m.collisionStart.length>0&&c.trigger(t,"collisionStart",{pairs:m.collisionStart,timestamp:g.timestamp,delta:e});var S=h.clamp(20/t.positionIterations,0,1);for(s.preSolvePosition(m.list),n=0;n<t.positionIterations;n++)s.solvePosition(m.list,e,S);for(s.postSolvePosition(x),u.preSolveAll(x),n=0;n<t.constraintIterations;n++)u.solveAll(b,e);for(u.postSolveAll(x),s.preSolveVelocity(m.list),n=0;n<t.velocityIterations;n++)s.solveVelocity(m.list,e);return i._bodiesUpdateVelocities(x),m.collisionActive.length>0&&c.trigger(t,"collisionActive",{pairs:m.collisionActive,timestamp:g.timestamp,delta:e}),m.collisionEnd.length>0&&c.trigger(t,"collisionEnd",{pairs:m.collisionEnd,timestamp:g.timestamp,delta:e}),i._bodiesClearForces(x),c.trigger(t,"afterUpdate",y),t.timing.lastElapsed=h.now()-d,t},i.merge=function(t,e){if(h.extend(t,e),e.world){t.world=e.world,i.clear(t);for(var n=l.allBodies(t.world),s=0;s<n.length;s++){var o=n[s];r.set(o,!1),o.id=h.nextId()}}},i.clear=function(t){a.clear(t.pairs),o.clear(t.detector)},i._bodiesClearForces=function(t){for(var e=t.length,n=0;n<e;n++){var i=t[n];i.force.x=0,i.force.y=0,i.torque=0}},i._bodiesApplyGravity=function(t,e){var n="undefined"!==typeof e.scale?e.scale:.001,i=t.length;if((0!==e.x||0!==e.y)&&0!==n)for(var r=0;r<i;r++){var s=t[r];s.ignoreGravity||s.isStatic||s.isSleeping||(s.force.y+=s.mass*e.y*n,s.force.x+=s.mass*e.x*n)}},i._bodiesUpdate=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];r.isStatic||r.isSleeping||d.update(r,e)}},i._bodiesUpdateVelocities=function(t){for(var e=t.length,n=0;n<e;n++)d.updateVelocities(t[n])}},39073:(t,e,n)=>{var i={};t.exports=i;var r=n(68758);i.on=function(t,e,n){for(var i,r=e.split(" "),s=0;s<r.length;s++)i=r[s],t.events=t.events||{},t.events[i]=t.events[i]||[],t.events[i].push(n);return n},i.off=function(t,e,n){if(e){"function"===typeof e&&(n=e,e=r.keys(t.events).join(" "));for(var i=e.split(" "),s=0;s<i.length;s++){var o=t.events[i[s]],a=[];if(n&&o)for(var c=0;c<o.length;c++)o[c]!==n&&a.push(o[c]);t.events[i[s]]=a}}else t.events={}},i.trigger=function(t,e,n){var i,s,o,a,c=t.events;if(c&&r.keys(c).length>0){n||(n={}),i=e.split(" ");for(var l=0;l<i.length;l++)if(o=c[s=i[l]]){(a=r.clone(n,!1)).name=s,a.source=t;for(var u=0;u<o.length;u++)o[u].apply(t,[a])}}}},16929:(t,e,n)=>{var i={};t.exports=i;var r=n(84474),s=n(68758);i.name="matter-js",i.version="0.19.0",i.uses=[],i.used=[],i.use=function(){r.use(i,Array.prototype.slice.call(arguments))},i.before=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathBefore(i,t,e)},i.after=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathAfter(i,t,e)}},84474:(t,e,n)=>{var i={};t.exports=i;var r=n(68758);i._registry={},i.register=function(t){if(i.isPlugin(t)||r.warn("Plugin.register:",i.toString(t),"does not implement all required fields."),t.name in i._registry){var e=i._registry[t.name],n=i.versionParse(t.version).number,s=i.versionParse(e.version).number;n>s?(r.warn("Plugin.register:",i.toString(e),"was upgraded to",i.toString(t)),i._registry[t.name]=t):n<s?r.warn("Plugin.register:",i.toString(e),"can not be downgraded to",i.toString(t)):t!==e&&r.warn("Plugin.register:",i.toString(t),"is already registered to different plugin object")}else i._registry[t.name]=t;return t},i.resolve=function(t){return i._registry[i.dependencyParse(t).name]},i.toString=function(t){return"string"===typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},i.isPlugin=function(t){return t&&t.name&&t.version&&t.install},i.isUsed=function(t,e){return t.used.indexOf(e)>-1},i.isFor=function(t,e){var n=t.for&&i.dependencyParse(t.for);return!t.for||e.name===n.name&&i.versionSatisfies(e.version,n.range)},i.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0!==t.uses.length){for(var n=i.dependencies(t),s=r.topologicalSort(n),o=[],a=0;a<s.length;a+=1)if(s[a]!==t.name){var c=i.resolve(s[a]);c?i.isUsed(t,c.name)||(i.isFor(c,t)||(r.warn("Plugin.use:",i.toString(c),"is for",c.for,"but installed on",i.toString(t)+"."),c._warned=!0),c.install?c.install(t):(r.warn("Plugin.use:",i.toString(c),"does not specify an install function."),c._warned=!0),c._warned?(o.push("\ud83d\udd36 "+i.toString(c)),delete c._warned):o.push("\u2705 "+i.toString(c)),t.used.push(c.name)):o.push("\u274c "+s[a])}o.length>0&&!c.silent&&r.info(o.join("  "))}else r.warn("Plugin.use:",i.toString(t),"does not specify any dependencies to install.")},i.dependencies=function(t,e){var n=i.dependencyParse(t),s=n.name;if(!(s in(e=e||{}))){t=i.resolve(t)||t,e[s]=r.map(t.uses||[],(function(e){i.isPlugin(e)&&i.register(e);var s=i.dependencyParse(e),o=i.resolve(e);return o&&!i.versionSatisfies(o.version,s.range)?(r.warn("Plugin.dependencies:",i.toString(o),"does not satisfy",i.toString(s),"used by",i.toString(n)+"."),o._warned=!0,t._warned=!0):o||(r.warn("Plugin.dependencies:",i.toString(e),"used by",i.toString(n),"could not be resolved."),t._warned=!0),s.name}));for(var o=0;o<e[s].length;o+=1)i.dependencies(e[s][o],e);return e}},i.dependencyParse=function(t){return r.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(t)||r.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},i.versionParse=function(t){var e=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;e.test(t)||r.warn("Plugin.versionParse:",t,"is not a valid version or range.");var n=e.exec(t),i=Number(n[4]),s=Number(n[5]),o=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:t,operator:n[1]||n[2]||"",major:i,minor:s,patch:o,parts:[i,s,o],prerelease:n[7],number:1e8*i+1e4*s+o}},i.versionSatisfies=function(t,e){e=e||"*";var n=i.versionParse(e),r=i.versionParse(t);if(n.isRange){if("*"===n.operator||"*"===t)return!0;if(">"===n.operator)return r.number>n.number;if(">="===n.operator)return r.number>=n.number;if("~"===n.operator)return r.major===n.major&&r.minor===n.minor&&r.patch>=n.patch;if("^"===n.operator)return n.major>0?r.major===n.major&&r.number>=n.number:n.minor>0?r.minor===n.minor&&r.patch>=n.patch:r.patch===n.patch}return t===e||"*"===t}},22806:(t,e,n)=>{var i={};t.exports=i;var r=n(84125),s=n(39073),o=n(68758);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(t,e){for(var n=e/o._baseDelta,s=i._motionSleepThreshold,a=0;a<t.length;a++){var c=t[a],l=r.getSpeed(c),u=r.getAngularSpeed(c),h=l*l+u*u;if(0===c.force.x&&0===c.force.y){var d=Math.min(c.motion,h),p=Math.max(c.motion,h);c.motion=i._minBias*d+(1-i._minBias)*p,c.sleepThreshold>0&&c.motion<s?(c.sleepCounter+=1,c.sleepCounter>=c.sleepThreshold/n&&i.set(c,!0)):c.sleepCounter>0&&(c.sleepCounter-=1)}else i.set(c,!1)}},i.afterCollisions=function(t){for(var e=i._motionSleepThreshold,n=0;n<t.length;n++){var r=t[n];if(r.isActive){var s=r.collision,o=s.bodyA.parent,a=s.bodyB.parent;if(!(o.isSleeping&&a.isSleeping||o.isStatic||a.isStatic)&&(o.isSleeping||a.isSleeping)){var c=o.isSleeping&&!o.isStatic?o:a,l=c===o?a:o;!c.isStatic&&l.motion>e&&i.set(c,!1)}}}},i.set=function(t,e){var n=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,n||s.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,n&&s.trigger(t,"sleepEnd"))}},68516:(t,e,n)=>{var i={};t.exports=i;var r=n(39745),s=n(68758),o=n(84125),a=n(84091),c=n(10438);i.rectangle=function(t,e,n,i,a){a=a||{};var c={label:"Rectangle Body",position:{x:t,y:e},vertices:r.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var l=a.chamfer;c.vertices=r.chamfer(c.vertices,l.radius,l.quality,l.qualityMin,l.qualityMax),delete a.chamfer}return o.create(s.extend({},c,a))},i.trapezoid=function(t,e,n,i,a,c){c=c||{};var l,u=n*(a*=.5),h=u+(1-2*a)*n,d=h+u;l=a<.5?"L 0 0 L "+u+" "+-i+" L "+h+" "+-i+" L "+d+" 0":"L 0 0 L "+h+" "+-i+" L "+d+" 0";var p={label:"Trapezoid Body",position:{x:t,y:e},vertices:r.fromPath(l)};if(c.chamfer){var f=c.chamfer;p.vertices=r.chamfer(p.vertices,f.radius,f.quality,f.qualityMin,f.qualityMax),delete c.chamfer}return o.create(s.extend({},p,c))},i.circle=function(t,e,n,r,o){r=r||{};var a={label:"Circle Body",circleRadius:n};o=o||25;var c=Math.ceil(Math.max(10,Math.min(o,n)));return c%2===1&&(c+=1),i.polygon(t,e,c,n,s.extend({},a,r))},i.polygon=function(t,e,n,a,c){if(c=c||{},n<3)return i.circle(t,e,a,c);for(var l=2*Math.PI/n,u="",h=.5*l,d=0;d<n;d+=1){var p=h+d*l,f=Math.cos(p)*a,m=Math.sin(p)*a;u+="L "+f.toFixed(3)+" "+m.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:t,y:e},vertices:r.fromPath(u)};if(c.chamfer){var v=c.chamfer;g.vertices=r.chamfer(g.vertices,v.radius,v.quality,v.qualityMin,v.qualityMax),delete c.chamfer}return o.create(s.extend({},g,c))},i.fromVertices=function(t,e,n,i,l,u,h,d){var p,f,m,g,v,y,x,b,w,S,_=s.getDecomp();for(p=Boolean(_&&_.quickDecomp),i=i||{},m=[],l="undefined"!==typeof l&&l,u="undefined"!==typeof u?u:.01,h="undefined"!==typeof h?h:10,d="undefined"!==typeof d?d:.01,s.isArray(n[0])||(n=[n]),w=0;w<n.length;w+=1)if(v=n[w],!(g=r.isConvex(v))&&!p&&s.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),g||!p)v=g?r.clockwiseSort(v):r.hull(v),m.push({position:{x:t,y:e},vertices:v});else{var T=v.map((function(t){return[t.x,t.y]}));_.makeCCW(T),!1!==u&&_.removeCollinearPoints(T,u),!1!==d&&_.removeDuplicatePoints&&_.removeDuplicatePoints(T,d);var E=_.quickDecomp(T);for(y=0;y<E.length;y++){var C=E[y].map((function(t){return{x:t[0],y:t[1]}}));h>0&&r.area(C)<h||m.push({position:r.centre(C),vertices:C})}}for(y=0;y<m.length;y++)m[y]=o.create(s.extend(m[y],i));if(l)for(y=0;y<m.length;y++){var k=m[y];for(x=y+1;x<m.length;x++){var A=m[x];if(a.overlaps(k.bounds,A.bounds)){var I=k.vertices,O=A.vertices;for(b=0;b<k.vertices.length;b++)for(S=0;S<A.vertices.length;S++){var R=c.magnitudeSquared(c.sub(I[(b+1)%I.length],O[S])),N=c.magnitudeSquared(c.sub(I[b],O[(S+1)%O.length]));R<5&&N<5&&(I[b].isInternal=!0,O[S].isInternal=!0)}}}}return m.length>1?(f=o.create(s.extend({parts:m.slice(0)},i)),o.setPosition(f,{x:t,y:e}),f):m[0]},i.flagCoincidentParts=function(t,e){void 0===e&&(e=5);for(var n=0;n<t.length;n++)for(var i=t[n],r=n+1;r<t.length;r++){var s=t[r];if(a.overlaps(i.bounds,s.bounds))for(var o=i.vertices,l=s.vertices,u=0;u<i.vertices.length;u++)for(var h=0;h<s.vertices.length;h++){var d=c.magnitudeSquared(c.sub(o[(u+1)%o.length],l[h])),p=c.magnitudeSquared(c.sub(o[u],l[(h+1)%l.length]));d<e&&p<e&&(o[u].isInternal=!0,l[h].isInternal=!0)}}return t}},56643:(t,e,n)=>{var i={};t.exports=i;var r=n(11299),s=n(52838),o=n(68758),a=n(84125),c=n(68516);i.stack=function(t,e,n,i,s,o,c){for(var l,u=r.create({label:"Stack"}),h=t,d=e,p=0,f=0;f<i;f++){for(var m=0,g=0;g<n;g++){var v=c(h,d,g,f,l,p);if(v){var y=v.bounds.max.y-v.bounds.min.y,x=v.bounds.max.x-v.bounds.min.x;y>m&&(m=y),a.translate(v,{x:.5*x,y:.5*y}),h=v.bounds.max.x+s,r.addBody(u,v),l=v,p+=1}else h+=s}d+=m+o,h=t}return u},i.chain=function(t,e,n,i,a,c){for(var l=t.bodies,u=1;u<l.length;u++){var h=l[u-1],d=l[u],p=h.bounds.max.y-h.bounds.min.y,f=h.bounds.max.x-h.bounds.min.x,m=d.bounds.max.y-d.bounds.min.y,g={bodyA:h,pointA:{x:f*e,y:p*n},bodyB:d,pointB:{x:(d.bounds.max.x-d.bounds.min.x)*i,y:m*a}},v=o.extend(g,c);r.addConstraint(t,s.create(v))}return t.label+=" Chain",t},i.mesh=function(t,e,n,i,a){var c,l,u,h,d,p=t.bodies;for(c=0;c<n;c++){for(l=1;l<e;l++)u=p[l-1+c*e],h=p[l+c*e],r.addConstraint(t,s.create(o.extend({bodyA:u,bodyB:h},a)));if(c>0)for(l=0;l<e;l++)u=p[l+(c-1)*e],h=p[l+c*e],r.addConstraint(t,s.create(o.extend({bodyA:u,bodyB:h},a))),i&&l>0&&(d=p[l-1+(c-1)*e],r.addConstraint(t,s.create(o.extend({bodyA:d,bodyB:h},a)))),i&&l<e-1&&(d=p[l+1+(c-1)*e],r.addConstraint(t,s.create(o.extend({bodyA:d,bodyB:h},a))))}return t.label+=" Mesh",t},i.pyramid=function(t,e,n,r,s,o,c){return i.stack(t,e,n,r,s,o,(function(e,i,o,l,u,h){var d=Math.min(r,Math.ceil(n/2)),p=u?u.bounds.max.x-u.bounds.min.x:0;if(!(l>d)&&!(o<(l=d-l)||o>n-1-l))return 1===h&&a.translate(u,{x:(o+(n%2===1?1:-1))*p,y:0}),c(t+(u?o*p:0)+o*s,i,o,l,u,h)}))},i.newtonsCradle=function(t,e,n,i,o){for(var a=r.create({label:"Newtons Cradle"}),l=0;l<n;l++){var u=c.circle(t+l*(1.9*i),e+o,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),h=s.create({pointA:{x:t+l*(1.9*i),y:e},bodyB:u});r.addBody(a,u),r.addConstraint(a,h)}return a},i.car=function(t,e,n,i,o){var l=a.nextGroup(!0),u=.5*-n+20,h=.5*n-20,d=r.create({label:"Car"}),p=c.rectangle(t,e,n,i,{collisionFilter:{group:l},chamfer:{radius:.5*i},density:2e-4}),f=c.circle(t+u,e+0,o,{collisionFilter:{group:l},friction:.8}),m=c.circle(t+h,e+0,o,{collisionFilter:{group:l},friction:.8}),g=s.create({bodyB:p,pointB:{x:u,y:0},bodyA:f,stiffness:1,length:0}),v=s.create({bodyB:p,pointB:{x:h,y:0},bodyA:m,stiffness:1,length:0});return r.addBody(d,p),r.addBody(d,f),r.addBody(d,m),r.addConstraint(d,g),r.addConstraint(d,v),d},i.softBody=function(t,e,n,r,s,a,l,u,h,d){h=o.extend({inertia:1/0},h),d=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},d);var p=i.stack(t,e,n,r,s,a,(function(t,e){return c.circle(t,e,u,h)}));return i.mesh(p,n,r,l,d),p.label="Soft Body",p}},50658:(t,e,n)=>{var i={};t.exports=i;var r=n(10438),s=n(68758);i.fromVertices=function(t){for(var e={},n=0;n<t.length;n++){var i=(n+1)%t.length,o=r.normalise({x:t[i].y-t[n].y,y:t[n].x-t[i].x}),a=0===o.y?1/0:o.x/o.y;e[a=a.toFixed(3).toString()]=o}return s.values(e)},i.rotate=function(t,e){if(0!==e)for(var n=Math.cos(e),i=Math.sin(e),r=0;r<t.length;r++){var s,o=t[r];s=o.x*n-o.y*i,o.y=o.x*i+o.y*n,o.x=s}}},84091:t=>{var e={};t.exports=e,e.create=function(t){var n={min:{x:0,y:0},max:{x:0,y:0}};return t&&e.update(n,t),n},e.update=function(t,e,n){t.min.x=1/0,t.max.x=-1/0,t.min.y=1/0,t.max.y=-1/0;for(var i=0;i<e.length;i++){var r=e[i];r.x>t.max.x&&(t.max.x=r.x),r.x<t.min.x&&(t.min.x=r.x),r.y>t.max.y&&(t.max.y=r.y),r.y<t.min.y&&(t.min.y=r.y)}n&&(n.x>0?t.max.x+=n.x:t.min.x+=n.x,n.y>0?t.max.y+=n.y:t.min.y+=n.y)},e.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},e.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},e.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},e.shift=function(t,e){var n=t.max.x-t.min.x,i=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+n,t.min.y=e.y,t.max.y=e.y+i}},92765:(t,e,n)=>{var i={};t.exports=i,n(84091);var r=n(68758);i.pathToVertices=function(t,e){"undefined"===typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,s,o,a,c,l,u,h,d,p,f,m=[],g=0,v=0,y=0;e=e||15;var x=function(t,e,n){var i=n%2===1&&n>1;if(!d||t!=d.x||e!=d.y){d&&i?(p=d.x,f=d.y):(p=0,f=0);var r={x:p+t,y:f+e};!i&&d||(d=r),m.push(r),v=p+t,y=f+e}},b=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":v=t.x,y=t.y;break;case"H":v=t.x;break;case"V":y=t.y}x(v,y,t.pathSegType)}};for(i._svgPathToAbsolute(t),o=t.getTotalLength(),l=[],n=0;n<t.pathSegList.numberOfItems;n+=1)l.push(t.pathSegList.getItem(n));for(u=l.concat();g<o;){if((c=l[t.getPathSegAtLength(g)])!=h){for(;u.length&&u[0]!=c;)b(u.shift());h=c}switch(c.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=t.getPointAtLength(g),x(a.x,a.y,0)}g+=e}for(n=0,s=u.length;n<s;++n)b(u[n]);return m},i._svgPathToAbsolute=function(t){for(var e,n,i,r,s,o,a=t.pathSegList,c=0,l=0,u=a.numberOfItems,h=0;h<u;++h){var d=a.getItem(h),p=d.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(p))"x"in d&&(c=d.x),"y"in d&&(l=d.y);else switch("x1"in d&&(i=c+d.x1),"x2"in d&&(s=c+d.x2),"y1"in d&&(r=l+d.y1),"y2"in d&&(o=l+d.y2),"x"in d&&(c+=d.x),"y"in d&&(l+=d.y),p){case"m":a.replaceItem(t.createSVGPathSegMovetoAbs(c,l),h);break;case"l":a.replaceItem(t.createSVGPathSegLinetoAbs(c,l),h);break;case"h":a.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(c),h);break;case"v":a.replaceItem(t.createSVGPathSegLinetoVerticalAbs(l),h);break;case"c":a.replaceItem(t.createSVGPathSegCurvetoCubicAbs(c,l,i,r,s,o),h);break;case"s":a.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(c,l,s,o),h);break;case"q":a.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(c,l,i,r),h);break;case"t":a.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(c,l),h);break;case"a":a.replaceItem(t.createSVGPathSegArcAbs(c,l,d.r1,d.r2,d.angle,d.largeArcFlag,d.sweepFlag),h);break;case"z":case"Z":c=e,l=n}"M"!=p&&"m"!=p||(e=c,n=l)}}},10438:t=>{var e={};t.exports=e,e.create=function(t,e){return{x:t||0,y:e||0}},e.clone=function(t){return{x:t.x,y:t.y}},e.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},e.rotate=function(t,e,n){var i=Math.cos(e),r=Math.sin(e);n||(n={});var s=t.x*i-t.y*r;return n.y=t.x*r+t.y*i,n.x=s,n},e.rotateAbout=function(t,e,n,i){var r=Math.cos(e),s=Math.sin(e);i||(i={});var o=n.x+((t.x-n.x)*r-(t.y-n.y)*s);return i.y=n.y+((t.x-n.x)*s+(t.y-n.y)*r),i.x=o,i},e.normalise=function(t){var n=e.magnitude(t);return 0===n?{x:0,y:0}:{x:t.x/n,y:t.y/n}},e.dot=function(t,e){return t.x*e.x+t.y*e.y},e.cross=function(t,e){return t.x*e.y-t.y*e.x},e.cross3=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},e.add=function(t,e,n){return n||(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n},e.sub=function(t,e,n){return n||(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},e.mult=function(t,e){return{x:t.x*e,y:t.y*e}},e.div=function(t,e){return{x:t.x/e,y:t.y/e}},e.perp=function(t,e){return{x:(e=!0===e?-1:1)*-t.y,y:e*t.x}},e.neg=function(t){return{x:-t.x,y:-t.y}},e.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},e._temp=[e.create(),e.create(),e.create(),e.create(),e.create(),e.create()]},39745:(t,e,n)=>{var i={};t.exports=i;var r=n(10438),s=n(68758);i.create=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],s={x:r.x,y:r.y,index:i,body:e,isInternal:!1};n.push(s)}return n},i.fromPath=function(t,e){var n=[];return t.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(t,e,i){n.push({x:parseFloat(e),y:parseFloat(i)})})),i.create(n,e)},i.centre=function(t){for(var e,n,s,o=i.area(t,!0),a={x:0,y:0},c=0;c<t.length;c++)s=(c+1)%t.length,e=r.cross(t[c],t[s]),n=r.mult(r.add(t[c],t[s]),e),a=r.add(a,n);return r.div(a,6*o)},i.mean=function(t){for(var e={x:0,y:0},n=0;n<t.length;n++)e.x+=t[n].x,e.y+=t[n].y;return r.div(e,t.length)},i.area=function(t,e){for(var n=0,i=t.length-1,r=0;r<t.length;r++)n+=(t[i].x-t[r].x)*(t[i].y+t[r].y),i=r;return e?n/2:Math.abs(n)/2},i.inertia=function(t,e){for(var n,i,s=0,o=0,a=t,c=0;c<a.length;c++)i=(c+1)%a.length,s+=(n=Math.abs(r.cross(a[i],a[c])))*(r.dot(a[i],a[i])+r.dot(a[i],a[c])+r.dot(a[c],a[c])),o+=n;return e/6*(s/o)},i.translate=function(t,e,n){n="undefined"!==typeof n?n:1;var i,r=t.length,s=e.x*n,o=e.y*n;for(i=0;i<r;i++)t[i].x+=s,t[i].y+=o;return t},i.rotate=function(t,e,n){if(0!==e){var i,r,s,o,a=Math.cos(e),c=Math.sin(e),l=n.x,u=n.y,h=t.length;for(o=0;o<h;o++)r=(i=t[o]).x-l,s=i.y-u,i.x=l+(r*a-s*c),i.y=u+(r*c+s*a);return t}},i.contains=function(t,e){for(var n,i=e.x,r=e.y,s=t.length,o=t[s-1],a=0;a<s;a++){if(n=t[a],(i-o.x)*(n.y-o.y)+(r-o.y)*(o.x-n.x)>0)return!1;o=n}return!0},i.scale=function(t,e,n,s){if(1===e&&1===n)return t;var o,a;s=s||i.centre(t);for(var c=0;c<t.length;c++)o=t[c],a=r.sub(o,s),t[c].x=s.x+a.x*e,t[c].y=s.y+a.y*n;return t},i.chamfer=function(t,e,n,i,o){e="number"===typeof e?[e]:e||[8],n="undefined"!==typeof n?n:-1,i=i||2,o=o||14;for(var a=[],c=0;c<t.length;c++){var l=t[c-1>=0?c-1:t.length-1],u=t[c],h=t[(c+1)%t.length],d=e[c<e.length?c:e.length-1];if(0!==d){var p=r.normalise({x:u.y-l.y,y:l.x-u.x}),f=r.normalise({x:h.y-u.y,y:u.x-h.x}),m=Math.sqrt(2*Math.pow(d,2)),g=r.mult(s.clone(p),d),v=r.normalise(r.mult(r.add(p,f),.5)),y=r.sub(u,r.mult(v,m)),x=n;-1===n&&(x=1.75*Math.pow(d,.32)),(x=s.clamp(x,i,o))%2===1&&(x+=1);for(var b=Math.acos(r.dot(p,f))/x,w=0;w<x;w++)a.push(r.add(r.rotate(g,b*w),y))}else a.push(u)}return a},i.clockwiseSort=function(t){var e=i.mean(t);return t.sort((function(t,n){return r.angle(e,t)-r.angle(e,n)})),t},i.isConvex=function(t){var e,n,i,r,s=0,o=t.length;if(o<3)return null;for(e=0;e<o;e++)if(i=(e+2)%o,r=(t[n=(e+1)%o].x-t[e].x)*(t[i].y-t[n].y),(r-=(t[n].y-t[e].y)*(t[i].x-t[n].x))<0?s|=1:r>0&&(s|=2),3===s)return!1;return 0!==s||null},i.hull=function(t){var e,n,i=[],s=[];for((t=t.slice(0)).sort((function(t,e){var n=t.x-e.x;return 0!==n?n:t.y-e.y})),n=0;n<t.length;n+=1){for(e=t[n];s.length>=2&&r.cross3(s[s.length-2],s[s.length-1],e)<=0;)s.pop();s.push(e)}for(n=t.length-1;n>=0;n-=1){for(e=t[n];i.length>=2&&r.cross3(i[i.length-2],i[i.length-1],e)<=0;)i.pop();i.push(e)}return i.pop(),s.pop(),i.concat(s)}},1675:(t,e,n)=>{var i=n(18171),r={name:"matter-attractors",version:"0.1.7",for:"matter-js@^0.19.0",silent:!0,install:function(t){t.after("Body.create",(function(){r.Body.init(this)})),t.before("Engine.update",(function(t){r.Engine.update(t)}))},Body:{init:function(t){t.plugin.attractors=t.plugin.attractors||[]}},Engine:{update:function(t){for(var e=i.Composite.allBodies(t.world),n=0;n<e.length;n++){var r=e[n],s=r.plugin.attractors;if(s&&s.length>0)for(var o=0;o<e.length;o++){var a=e[o];if(n!==o)for(var c=0;c<s.length;c++){var l=s[c],u=l;i.Common.isFunction(l)&&(u=l(r,a)),u&&i.Body.applyForce(a,a.position,u)}}}}},Attractors:{gravityConstant:.001,gravity:function(t,e){var n=i.Vector.sub(e.position,t.position),s=i.Vector.magnitudeSquared(n)||1e-4,o=i.Vector.normalise(n),a=-r.Attractors.gravityConstant*(t.mass*e.mass/s),c=i.Vector.mult(o,a);i.Body.applyForce(t,t.position,i.Vector.neg(c)),i.Body.applyForce(e,e.position,c)}}};t.exports=r},80391:t=>{t.exports={name:"matter-collision-events",version:"0.1.6",for:"matter-js@^0.19.0",silent:!0,install:function(t){t.after("Engine.create",(function(){t.Events.on(this,"collisionStart",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collide",n,i,e),i.gameObject&&i.gameObject.emit("collide",i,n,e),t.Events.trigger(n,"onCollide",{pair:e}),t.Events.trigger(i,"onCollide",{pair:e}),n.onCollideCallback&&n.onCollideCallback(e),i.onCollideCallback&&i.onCollideCallback(e),n.onCollideWith[i.id]&&n.onCollideWith[i.id](i,e),i.onCollideWith[n.id]&&i.onCollideWith[n.id](n,e)}))})),t.Events.on(this,"collisionActive",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collideActive",n,i,e),i.gameObject&&i.gameObject.emit("collideActive",i,n,e),t.Events.trigger(n,"onCollideActive",{pair:e}),t.Events.trigger(i,"onCollideActive",{pair:e}),n.onCollideActiveCallback&&n.onCollideActiveCallback(e),i.onCollideActiveCallback&&i.onCollideActiveCallback(e)}))})),t.Events.on(this,"collisionEnd",(function(e){e.pairs.map((function(e){var n=e.bodyA,i=e.bodyB;n.gameObject&&n.gameObject.emit("collideEnd",n,i,e),i.gameObject&&i.gameObject.emit("collideEnd",i,n,e),t.Events.trigger(n,"onCollideEnd",{pair:e}),t.Events.trigger(i,"onCollideEnd",{pair:e}),n.onCollideEndCallback&&n.onCollideEndCallback(e),i.onCollideEndCallback&&i.onCollideEndCallback(e)}))}))}))}}},44097:(t,e,n)=>{var i=n(18171),r={name:"matter-wrap",version:"0.1.4",for:"matter-js@^0.19.0",silent:!0,install:function(t){t.after("Engine.update",(function(){r.Engine.update(this)}))},Engine:{update:function(t){for(var e=t.world,n=i.Composite.allBodies(e),s=i.Composite.allComposites(e),o=0;o<n.length;o+=1){var a=n[o];a.plugin.wrap&&r.Body.wrap(a,a.plugin.wrap)}for(o=0;o<s.length;o+=1){var c=s[o];c.plugin.wrap&&r.Composite.wrap(c,c.plugin.wrap)}}},Bounds:{wrap:function(t,e){var n=null,i=null;if("undefined"!==typeof e.min.x&&"undefined"!==typeof e.max.x&&(t.min.x>e.max.x?n=e.min.x-t.max.x:t.max.x<e.min.x&&(n=e.max.x-t.min.x)),"undefined"!==typeof e.min.y&&"undefined"!==typeof e.max.y&&(t.min.y>e.max.y?i=e.min.y-t.max.y:t.max.y<e.min.y&&(i=e.max.y-t.min.y)),null!==n||null!==i)return{x:n||0,y:i||0}}},Body:{wrap:function(t,e){var n=r.Bounds.wrap(t.bounds,e);return n&&i.Body.translate(t,n),n}},Composite:{bounds:function(t){for(var e=i.Composite.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return i.Bounds.create(n)},wrap:function(t,e){var n=r.Bounds.wrap(r.Composite.bounds(t),e);return n&&i.Composite.translate(t,n),n}}};t.exports=r},81084:t=>{function e(t,e,n){n=n||0;var i,r,s,o,a,c,l,u=[0,0];return i=t[1][1]-t[0][1],r=t[0][0]-t[1][0],s=i*t[0][0]+r*t[0][1],o=e[1][1]-e[0][1],a=e[0][0]-e[1][0],c=o*e[0][0]+a*e[0][1],_(l=i*a-o*r,0,n)||(u[0]=(a*s-r*c)/l,u[1]=(i*c-o*s)/l),u}function n(t,e,n,i){var r=e[0]-t[0],s=e[1]-t[1],o=i[0]-n[0],a=i[1]-n[1];if(o*s-a*r===0)return!1;var c=(r*(n[1]-t[1])+s*(t[0]-n[0]))/(o*s-a*r),l=(o*(t[1]-n[1])+a*(n[0]-t[0]))/(a*r-o*s);return c>=0&&c<=1&&l>=0&&l<=1}function i(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function r(t,e,n){return i(t,e,n)>0}function s(t,e,n){return i(t,e,n)>=0}function o(t,e,n){return i(t,e,n)<0}function a(t,e,n){return i(t,e,n)<=0}t.exports={decomp:function(t){var e=b(t);return e.length>0?w(t,e):[t]},quickDecomp:function t(e,n,i,c,l,u,m){u=u||100,m=m||0,l=l||25,n="undefined"!==typeof n?n:[],i=i||[],c=c||[];var g=[0,0],v=[0,0],x=[0,0],b=0,w=0,_=0,T=0,E=0,C=0,k=0,A=[],I=[],O=e,R=e;if(R.length<3)return n;if(++m>u)return console.warn("quickDecomp: max level ("+u+") reached."),n;for(var N=0;N<e.length;++N)if(f(O,N)){i.push(O[N]),b=w=Number.MAX_VALUE;for(var M=0;M<e.length;++M)r(d(O,N-1),d(O,N),d(O,M))&&a(d(O,N-1),d(O,N),d(O,M-1))&&(x=S(d(O,N-1),d(O,N),d(O,M),d(O,M-1)),o(d(O,N+1),d(O,N),x)&&(_=h(O[N],x))<w&&(w=_,v=x,C=M)),r(d(O,N+1),d(O,N),d(O,M+1))&&a(d(O,N+1),d(O,N),d(O,M))&&(x=S(d(O,N+1),d(O,N),d(O,M),d(O,M+1)),r(d(O,N-1),d(O,N),x)&&(_=h(O[N],x))<b&&(b=_,g=x,E=M));if(C===(E+1)%e.length)x[0]=(v[0]+g[0])/2,x[1]=(v[1]+g[1])/2,c.push(x),N<E?(p(A,O,N,E+1),A.push(x),I.push(x),0!==C&&p(I,O,C,O.length),p(I,O,0,N+1)):(0!==N&&p(A,O,N,O.length),p(A,O,0,E+1),A.push(x),I.push(x),p(I,O,C,N+1));else{if(C>E&&(E+=e.length),T=Number.MAX_VALUE,E<C)return n;for(M=C;M<=E;++M)s(d(O,N-1),d(O,N),d(O,M))&&a(d(O,N+1),d(O,N),d(O,M))&&(_=h(d(O,N),d(O,M)))<T&&y(O,N,M)&&(T=_,k=M%e.length);N<k?(p(A,O,N,k+1),0!==k&&p(I,O,k,R.length),p(I,O,0,N+1)):(0!==N&&p(A,O,N,R.length),p(A,O,0,k+1),p(I,O,k,N+1))}return A.length<I.length?(t(A,n,i,c,l,u,m),t(I,n,i,c,l,u,m)):(t(I,n,i,c,l,u,m),t(A,n,i,c,l,u,m)),n}return n.push(e),n},isSimple:function(t){var e,i=t;for(e=0;e<i.length-1;e++)for(var r=0;r<e-1;r++)if(n(i[e],i[e+1],i[r],i[r+1]))return!1;for(e=1;e<i.length-2;e++)if(n(i[0],i[i.length-1],i[e],i[e+1]))return!1;return!0},removeCollinearPoints:function(t,e){for(var n=0,i=t.length-1;t.length>3&&i>=0;--i)u(d(t,i-1),d(t,i),d(t,i+1),e)&&(t.splice(i%t.length,1),n++);return n},removeDuplicatePoints:function(t,e){for(var n=t.length-1;n>=1;--n)for(var i=t[n],r=n-1;r>=0;--r)T(i,t[r],e)&&t.splice(n,1)},makeCCW:function(t){for(var e=0,n=t,i=1;i<t.length;++i)(n[i][1]<n[e][1]||n[i][1]===n[e][1]&&n[i][0]>n[e][0])&&(e=i);return!r(d(t,e-1),d(t,e),d(t,e+1))&&(function(t){for(var e=[],n=t.length,i=0;i!==n;i++)e.push(t.pop());for(i=0;i!==n;i++)t[i]=e[i]}(t),!0)}};var c=[],l=[];function u(t,e,n,r){if(r){var s=c,o=l;s[0]=e[0]-t[0],s[1]=e[1]-t[1],o[0]=n[0]-e[0],o[1]=n[1]-e[1];var a=s[0]*o[0]+s[1]*o[1],u=Math.sqrt(s[0]*s[0]+s[1]*s[1]),h=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(a/(u*h))<r}return 0===i(t,e,n)}function h(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function d(t,e){var n=t.length;return t[e<0?e%n+n:e%n]}function p(t,e,n,i){for(var r=n;r<i;r++)t.push(e[r])}function f(t,e){return o(d(t,e-1),d(t,e),d(t,e+1))}var m=[],g=[];function v(t,n,i){var r,o,c=m,l=g;if(s(d(t,n+1),d(t,n),d(t,i))&&a(d(t,n-1),d(t,n),d(t,i)))return!1;o=h(d(t,n),d(t,i));for(var u=0;u!==t.length;++u)if((u+1)%t.length!==n&&u!==n&&s(d(t,n),d(t,i),d(t,u+1))&&a(d(t,n),d(t,i),d(t,u))&&(c[0]=d(t,n),c[1]=d(t,i),l[0]=d(t,u),l[1]=d(t,u+1),r=e(c,l),h(d(t,n),r)<o))return!1;return!0}function y(t,e,i){for(var r=0;r!==t.length;++r)if(r!==e&&r!==i&&(r+1)%t.length!==e&&(r+1)%t.length!==i&&n(d(t,e),d(t,i),d(t,r),d(t,r+1)))return!1;return!0}function x(t,e,n,i){var r=i||[];if(function(t){t.length=0}(r),e<n)for(var s=e;s<=n;s++)r.push(t[s]);else{for(s=0;s<=n;s++)r.push(t[s]);for(s=e;s<t.length;s++)r.push(t[s])}return r}function b(t){for(var e=[],n=[],i=[],r=[],s=Number.MAX_VALUE,o=0;o<t.length;++o)if(f(t,o))for(var a=0;a<t.length;++a)if(v(t,o,a)){n=b(x(t,o,a,r)),i=b(x(t,a,o,r));for(var c=0;c<i.length;c++)n.push(i[c]);n.length<s&&(e=n,s=n.length,e.push([d(t,o),d(t,a)]))}return e}function w(t,e){if(0===e.length)return[t];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2===e[0].length&&e[0][0]instanceof Array){for(var n=[t],i=0;i<e.length;i++)for(var r=e[i],s=0;s<n.length;s++){var o=w(n[s],r);if(o){n.splice(s,1),n.push(o[0],o[1]);break}}return n}return r=e,i=t.indexOf(r[0]),s=t.indexOf(r[1]),-1!==i&&-1!==s&&[x(t,i,s),x(t,s,i)]}function S(t,e,n,i,r){r=r||0;var s=e[1]-t[1],o=t[0]-e[0],a=s*t[0]+o*t[1],c=i[1]-n[1],l=n[0]-i[0],u=c*n[0]+l*n[1],h=s*l-c*o;return _(h,0,r)?[0,0]:[(l*a-o*u)/h,(s*u-c*a)/h]}function _(t,e,n){return n=n||0,Math.abs(t-e)<=n}function T(t,e,n){return _(t[0],e[0],n)&&_(t[1],e[1],n)}},88257:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},18360:t=>{t.exports={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]}},91963:t=>{var e={},n={},i={register:function(t,n,i,r){void 0===r&&(r=!1),e[t]={plugin:n,mapping:i,custom:r}},registerCustom:function(t,e,i,r){n[t]={plugin:e,mapping:i,data:r}},hasCore:function(t){return e.hasOwnProperty(t)},hasCustom:function(t){return n.hasOwnProperty(t)},getCore:function(t){return e[t]},getCustom:function(t){return n[t]},getCustomClass:function(t){return n.hasOwnProperty(t)?n[t].plugin:null},remove:function(t){e.hasOwnProperty(t)&&delete e[t]},removeCustom:function(t){n.hasOwnProperty(t)&&delete n[t]},destroyCorePlugins:function(){for(var t in e)e.hasOwnProperty(t)&&delete e[t]},destroyCustomPlugins:function(){for(var t in n)n.hasOwnProperty(t)&&delete n[t]}};t.exports=i},49274:(t,e,n)=>{var i=n(56694),r=n(97081),s=n(6659),o=n(76846),a=n(99325),c=n(61286),l=n(72632),u=n(91963),h=n(66458),d=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted?this.boot():t.events.once(r.BOOT,this.boot,this)},boot:function(){var t,e,n,i,s,o,a,c=this.game.config,u=c.installGlobalPlugins;for(u=u.concat(this._pendingGlobal),t=0;t<u.length;t++)e=u[t],n=l(e,"key",null),i=l(e,"plugin",null),s=l(e,"start",!1),o=l(e,"mapping",null),a=l(e,"data",null),n&&(i?this.install(n,i,s,o,a):console.warn("Missing `plugin` for key: "+n));for(u=(u=c.installScenePlugins).concat(this._pendingScene),t=0;t<u.length;t++)e=u[t],n=l(e,"key",null),i=l(e,"plugin",null),o=l(e,"mapping",null),n&&(i?this.installScenePlugin(n,i,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(r.DESTROY,this.destroy,this)},addToScene:function(t,e,n){var i,r,s,o=this.game,a=t.scene,c=t.settings.map,l=t.settings.isBooted;for(i=0;i<e.length;i++)o[r=e[i]]?(t[r]=o[r],c.hasOwnProperty(r)&&(a[c[r]]=t[r])):"game"===r&&c.hasOwnProperty(r)&&(a[c[r]]=o);for(var h=0;h<n.length;h++)for(s=n[h],i=0;i<s.length;i++)if(r=s[i],u.hasCore(r)){var d=u.getCore(r),p=d.mapping,f=new d.plugin(a,this,p);t[p]=f,d.custom?a[p]=f:c.hasOwnProperty(p)&&(a[c[p]]=f),l&&f.boot()}for(s=this.plugins,i=0;i<s.length;i++){var m=s[i];m.mapping&&(a[m.mapping]=m.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t=t.concat(this.scenePlugins)},installScenePlugin:function(t,e,n,i,r){if(void 0===r&&(r=!1),"function"===typeof e){if(u.hasCore(t)||u.register(t,e,n,!0),-1===this.scenePlugins.indexOf(t))this.scenePlugins.push(t);else if(!r&&u.hasCore(t))return void console.warn("Scene Plugin key in use: "+t);if(i){var s=new e(i,this,t);i.sys[t]=s,n&&""!==n&&(i[n]=s),s.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,n,i,r){if(void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=null),"function"!==typeof e)return console.warn("Invalid Plugin: "+t),null;if(u.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==i&&(n=!0),this.game.isBooted){if(u.registerCustom(t,e,i,r),n)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:n,mapping:i,data:r});return null},getIndex:function(t){for(var e=this.plugins,n=0;n<e.length;n++)if(e[n].key===t)return n;return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var n=this.getEntry(e);return n&&!n.active?(n.active=!0,n.plugin.start()):n||(n=this.createEntry(t,e)),n?n.plugin:null},createEntry:function(t,e){var n=u.getCustom(t);if(n){var i=new n.plugin(this);n={key:e,plugin:i,active:!0,mapping:n.mapping,data:n.data},this.plugins.push(n),i.init(n.data),i.start()}return n},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var n=this.getEntry(t);if(n)return n.plugin;var i=this.getClass(t);return i&&e?(n=this.createEntry(t,t))?n.plugin:null:i||null},getClass:function(t){return u.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&h(this.plugins,e),u.removeCustom(t)},removeScenePlugin:function(t){h(this.scenePlugins,t),u.remove(t)},registerGameObject:function(t,e,n){return e&&c.register(t,e),n&&a.register(t,n),this},removeGameObject:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),e&&c.remove(t),n&&a.remove(t),this},registerFileType:function(t,e,n){o.register(t,e),n&&n.sys.load&&(n.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();u.destroyCustomPlugins(),this.game.noReturn&&u.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});t.exports=d},39283:(t,e,n)=>{var i=n(88257),r=n(56694),s=n(7599),o=new r({Extends:i,initialize:function(t,e,n){i.call(this,e),this.scene=t,this.systems=t.sys,this.pluginKey=n,t.sys.events.once(s.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=o},45615:(t,e,n)=>{t.exports={BasePlugin:n(88257),DefaultPlugins:n(18360),PluginCache:n(91963),PluginManager:n(49274),ScenePlugin:n(39283)}},75205:()=>{HTMLVideoElement&&!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(t){const e=performance.now(),n=this.getVideoPlaybackQuality(),i=this.mozPresentedFrames||this.mozPaintedFrames||n.totalVideoFrames-n.droppedVideoFrames,r=(s,o)=>{const a=this.getVideoPlaybackQuality(),c=this.mozPresentedFrames||this.mozPaintedFrames||a.totalVideoFrames-a.droppedVideoFrames;if(c>i){const i=this.mozFrameDelay||a.totalFrameDelay-n.totalFrameDelay||0,r=o-s;t(o,{presentationTime:o+1e3*i,expectedDisplayTime:o+r,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+r/1e3,presentedFrames:c,processingDuration:i}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame((t=>r(o,t)))};return this._rvfcpolyfillmap[e]=requestAnimationFrame((t=>r(e,t))),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(t){cancelAnimationFrame(this._rvfcpolyfillmap[t]),delete this._rvfcpolyfillmap[t]})},95723:t=>{t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},27394:t=>{t.exports={DEFAULT:0,LINEAR:0,NEAREST:1}},91135:(t,e,n)=>{var i=n(89787),r=n(61840),s=n(56694),o=n(86459),a=n(6659),c=n(81044),l=n(32834),u=n(40444),h=n(38203),d=n(69360),p=new s({Extends:a,initialize:function(t){a.call(this);var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,backgroundColor:e.backgroundColor,antialias:e.antialias,roundPixels:e.roundPixels},this.game=t,this.type=o.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=t.canvas;var n={alpha:t.config.transparent,desynchronized:t.config.desynchronized,willReadFrequently:!1};this.gameContext=e.context?e.context:this.gameCanvas.getContext("2d",n),this.currentContext=this.gameContext,this.antialias=t.config.antialias,this.blendModes=l(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new d,this._tempMatrix2=new d,this._tempMatrix3=new d,this.isBooted=!1,this.init()},init:function(){this.game.textures.once(h.READY,this.boot,this)},boot:function(){var t=this.game,e=t.scale.baseSize;this.width=e.width,this.height=e.height,this.isBooted=!0,t.scale.on(u.RESIZE,this.onResize,this),this.resize(e.width,e.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e,this.emit(c.RESIZE,t,e)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,n=this.width,i=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),e.clearBeforeRender&&(t.clearRect(0,0,n,i),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,n,i))),t.save(),this.drawCount=0,this.emit(c.PRE_RENDER)},render:function(t,e,n){var r=e.length;this.emit(c.RENDER,t,n);var s=n.x,o=n.y,a=n.width,l=n.height,u=n.renderToTexture?n.context:t.sys.context;u.save(),this.game.scene.customViewports&&(u.beginPath(),u.rect(s,o,a,l),u.clip()),n.emit(i.PRE_RENDER,n),this.currentContext=u;var h=n.mask;h&&h.preRenderCanvas(this,null,n._maskCamera),n.transparent||(u.fillStyle=n.backgroundColor.rgba,u.fillRect(s,o,a,l)),u.globalAlpha=n.alpha,u.globalCompositeOperation="source-over",this.drawCount+=r,n.renderToTexture&&n.emit(i.PRE_RENDER,n),n.matrix.copyToContext(u);for(var d=0;d<r;d++){var p=e[d];p.mask&&p.mask.preRenderCanvas(this,p,n),p.renderCanvas(this,p,n),p.mask&&p.mask.postRenderCanvas(this,p,n)}u.setTransform(1,0,0,1,0,0),u.globalCompositeOperation="source-over",u.globalAlpha=1,n.flashEffect.postRenderCanvas(u),n.fadeEffect.postRenderCanvas(u),n.dirty=!1,h&&h.postRenderCanvas(this),u.restore(),n.renderToTexture&&(n.emit(i.POST_RENDER,n),n.renderToGame&&t.sys.context.drawImage(n.canvas,s,o)),n.emit(i.POST_RENDER,n)},postRender:function(){this.gameContext.restore(),this.emit(c.POST_RENDER);var t=this.snapshotState;t.callback&&(r(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,e,n,i,s,o,a,c,l){void 0===n&&(n=!1),this.snapshotArea(i,s,o,a,e,c,l);var u=this.snapshotState;return u.getPixel=n,r(t,u),u.callback=null,this},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=Math.min(n,this.gameCanvas.width),a.height=Math.min(i,this.gameCanvas.height),this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,n,i){var r=n.alpha*t.alpha;if(0!==r){var s=this.currentContext,o=this._tempMatrix1,a=this._tempMatrix2,c=e.canvasData,l=c.x,u=c.y,h=e.cutWidth,d=e.cutHeight,p=e.customPivot,f=e.source.resolution,m=t.displayOriginX,g=t.displayOriginY,v=-m+e.x,y=-g+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),h=x.cw,d=x.ch,l=x.cx,u=x.cy,v=-m+x.x,y=-g+x.y,t.flipX&&(v>=0?v=-(v+h):v<0&&(v=Math.abs(v)-h)),t.flipY&&(y>=0?y=-(y+d):y<0&&(y=Math.abs(y)-d))}var b=1,w=1;t.flipX&&(p||(v+=-e.realWidth+2*m),b=-1),t.flipY&&(p||(y+=-e.realHeight+2*g),w=-1);var S=t.x,_=t.y;a.applyITRS(S,_,t.rotation,t.scaleX*b,t.scaleY*w),o.copyFrom(n.matrix),i?(o.multiplyWithOffset(i,-n.scrollX*t.scrollFactorX,-n.scrollY*t.scrollFactorY),a.e=S,a.f=_):(a.e-=n.scrollX*t.scrollFactorX,a.f-=n.scrollY*t.scrollFactorY),o.multiply(a),n.roundPixels&&(o.e=Math.round(o.e),o.f=Math.round(o.f)),s.save(),o.setToContext(s),s.globalCompositeOperation=this.blendModes[t.blendMode],s.globalAlpha=r,s.imageSmoothingEnabled=!e.source.scaleMode,t.mask&&t.mask.preRenderCanvas(this,t,n),h>0&&d>0&&(n.roundPixels?s.drawImage(e.source.image,l,u,h,d,Math.round(v),Math.round(y),Math.round(h/f),Math.round(d/f)):s.drawImage(e.source.image,l,u,h,d,v,y,h/f,d/f)),t.mask&&t.mask.postRenderCanvas(this,t,n),s.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});t.exports=p},6046:(t,e,n)=>{t.exports={CanvasRenderer:n(91135),GetBlendModes:n(32834),SetTransform:n(49584)}},32834:(t,e,n)=>{var i=n(95723),r=n(98581);t.exports=function(){var t=[],e=r.supportNewBlendModes,n="source-over";return t[i.NORMAL]=n,t[i.ADD]="lighter",t[i.MULTIPLY]=e?"multiply":n,t[i.SCREEN]=e?"screen":n,t[i.OVERLAY]=e?"overlay":n,t[i.DARKEN]=e?"darken":n,t[i.LIGHTEN]=e?"lighten":n,t[i.COLOR_DODGE]=e?"color-dodge":n,t[i.COLOR_BURN]=e?"color-burn":n,t[i.HARD_LIGHT]=e?"hard-light":n,t[i.SOFT_LIGHT]=e?"soft-light":n,t[i.DIFFERENCE]=e?"difference":n,t[i.EXCLUSION]=e?"exclusion":n,t[i.HUE]=e?"hue":n,t[i.SATURATION]=e?"saturation":n,t[i.COLOR]=e?"color":n,t[i.LUMINOSITY]=e?"luminosity":n,t[i.ERASE]="destination-out",t[i.SOURCE_IN]="source-in",t[i.SOURCE_OUT]="source-out",t[i.SOURCE_ATOP]="source-atop",t[i.DESTINATION_OVER]="destination-over",t[i.DESTINATION_IN]="destination-in",t[i.DESTINATION_OUT]="destination-out",t[i.DESTINATION_ATOP]="destination-atop",t[i.LIGHTER]="lighter",t[i.COPY]="copy",t[i.XOR]="xor",t}},49584:(t,e,n)=>{var i=n(73329);t.exports=function(t,e,n,r,s){var o=r.alpha*n.alpha;if(o<=0)return!1;var a=i(n,r,s).calc;return e.globalCompositeOperation=t.blendModes[n.blendMode],e.globalAlpha=o,e.save(),a.setToContext(e),e.imageSmoothingEnabled=n.frame?!n.frame.source.scaleMode:t.antialias,!0}},70936:t=>{t.exports="postrender"},99298:t=>{t.exports="prerender"},7743:t=>{t.exports="render"},99519:t=>{t.exports="resize"},81044:(t,e,n)=>{t.exports={POST_RENDER:n(70936),PRE_RENDER:n(99298),RENDER:n(7743),RESIZE:n(99519)}},42069:(t,e,n)=>{t.exports={Canvas:n(6046),Events:n(81044),Snapshot:n(95528),WebGL:n(55478)}},61840:(t,e,n)=>{var i=n(61068),r=n(27119),s=n(72632);t.exports=function(t,e){var n=s(e,"callback"),o=s(e,"type","image/png"),a=s(e,"encoder",.92),c=Math.abs(Math.round(s(e,"x",0))),l=Math.abs(Math.round(s(e,"y",0))),u=Math.floor(s(e,"width",t.width)),h=Math.floor(s(e,"height",t.height));if(s(e,"getPixel",!1)){var d=t.getContext("2d",{willReadFrequently:!1}).getImageData(c,l,1,1).data;n.call(null,new r(d[0],d[1],d[2],d[3]))}else if(0!==c||0!==l||u!==t.width||h!==t.height){var p=i.createWebGL(this,u,h),f=p.getContext("2d",{willReadFrequently:!0});u>0&&h>0&&f.drawImage(t,c,l,u,h,0,0,u,h);var m=new Image;m.onerror=function(){n.call(null),i.remove(p)},m.onload=function(){n.call(null,m),i.remove(p)},m.src=p.toDataURL(o,a)}else{var g=new Image;g.onerror=function(){n.call(null)},g.onload=function(){n.call(null,g)},g.src=t.toDataURL(o,a)}}},1217:(t,e,n)=>{var i=n(61068),r=n(27119),s=n(72632);t.exports=function(t,e){var n=t,o=s(e,"callback"),a=s(e,"type","image/png"),c=s(e,"encoder",.92),l=Math.abs(Math.round(s(e,"x",0))),u=Math.abs(Math.round(s(e,"y",0))),h=s(e,"getPixel",!1),d=s(e,"isFramebuffer",!1),p=d?s(e,"bufferWidth",1):n.drawingBufferWidth,f=d?s(e,"bufferHeight",1):n.drawingBufferHeight;if(h){var m=new Uint8Array(4),g=d?u:f-u;n.readPixels(l,g,1,1,n.RGBA,n.UNSIGNED_BYTE,m),o.call(null,new r(m[0],m[1],m[2],m[3]))}else{var v=Math.floor(s(e,"width",p)),y=Math.floor(s(e,"height",f)),x=v*y*4,b=new Uint8Array(x);n.readPixels(l,f-u-y,v,y,n.RGBA,n.UNSIGNED_BYTE,b);for(var w=i.createWebGL(this,v,y),S=w.getContext("2d",{willReadFrequently:!0}),_=S.getImageData(0,0,v,y),T=_.data,E=0;E<y;E++)for(var C=0;C<v;C++){var k=4*((y-E-1)*v+C),A=d?x-4*(E*v+(v-C)):4*(E*v+C);T[A+0]=b[k+0],T[A+1]=b[k+1],T[A+2]=b[k+2],T[A+3]=b[k+3]}S.putImageData(_,0,0);var I=new Image;I.onerror=function(){o.call(null),i.remove(w)},I.onload=function(){o.call(null,I),i.remove(w)},I.src=w.toDataURL(a,c)}}},95528:(t,e,n)=>{t.exports={Canvas:n(61840),WebGL:n(1217)}},35217:(t,e,n)=>{var i=n(56694),r=n(65641),s=n(33885),o=n(77290),a=n(72632),c=n(37410),l=n(82127),u=n(5583),h=n(58136),d=n(47406),p=n(81828),f=n(66901),m=n(71264),g=n(77310),v=n(10919),y=n(21213),x=n(51212),b=n(60848),w=new i({initialize:function(t){this.game=t.game,this.renderer=t,this.classes=new s([[r.UTILITY_PIPELINE,b],[r.MULTI_PIPELINE,g],[r.BITMAPMASK_PIPELINE,u],[r.SINGLE_PIPELINE,x],[r.ROPE_PIPELINE,y],[r.LIGHT_PIPELINE,f],[r.POINTLIGHT_PIPELINE,v],[r.MOBILE_PIPELINE,m]]),this.postPipelineClasses=new s,this.pipelines=new s,this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(t,e,n){var i=this.renderer,s=this.renderTargets;this.frameInc=Math.floor(a(t,"frameInc",32));var l,u,f=i.width,m=i.height,g=this.game.config.disablePreFX;if(this.game.config.disablePostFX||this.postPipelineClasses.setAll([[String(d.BARREL),h.Barrel],[String(d.BLOOM),h.Bloom],[String(d.BLUR),h.Blur],[String(d.BOKEH),h.Bokeh],[String(d.CIRCLE),h.Circle],[String(d.COLOR_MATRIX),h.ColorMatrix],[String(d.DISPLACEMENT),h.Displacement],[String(d.GLOW),h.Glow],[String(d.GRADIENT),h.Gradient],[String(d.PIXELATE),h.Pixelate],[String(d.SHADOW),h.Shadow],[String(d.SHINE),h.Shine],[String(d.VIGNETTE),h.Vignette],[String(d.WIPE),h.Wipe]]),!g){this.classes.set(r.FX_PIPELINE,p);for(var v=Math.min(f,m),y=Math.ceil(v/this.frameInc),x=1;x<y;x++){var b=x*this.frameInc;s.push(new c(i,b,b)),s.push(new c(i,b,b)),s.push(new c(i,b,b)),this.maxDimension=b}s.push(new c(i,f,m,1,0,!0,!0)),s.push(new c(i,f,m,1,0,!0,!0)),s.push(new c(i,f,m,1,0,!0,!0))}var w=this,S=this.game;if(this.classes.each((function(t,e){l=w.add(t,new e({game:S})),t===r.UTILITY_PIPELINE&&(w.UTILITY_PIPELINE=l,w.fullFrame1=l.fullFrame1,w.fullFrame2=l.fullFrame2,w.halfFrame1=l.halfFrame1,w.halfFrame2=l.halfFrame2)})),this.MULTI_PIPELINE=this.get(r.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(r.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(r.MOBILE_PIPELINE),g||(this.FX_PIPELINE=this.get(r.FX_PIPELINE)),t)for(u in t){var _=t[u];(l=new _(S)).name=u,l.isPostFX?this.postPipelineClasses.set(u,_):this.has(u)||(this.classes.set(u,_),this.add(u,l))}this.default=this.get(e),n&&!o.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(t){var e=this.get(t);return e&&(this.default=e),e},add:function(t,e){if(!e.isPostFX){var n=this.pipelines,i=this.renderer;return n.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,n.set(t,e)),e.hasBooted||e.boot(),0===i.width||0===i.height||e.isPreFX||e.resize(i.width,i.height),e}console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return"string"===typeof t?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;return"string"===typeof t?e.get(t):e.contains(t)?t:void 0},getPostPipeline:function(t,e,n){var i,r=this.postPipelineClasses,s="",o=typeof t;if("string"===o||"number"===o?(i=r.get(t),s=t):"function"===o?(r.contains(t)&&(i=t),s=t.name):"object"===o&&(i=r.get(t.name),s=t.name),i){var a=new i(this.game,n);return a.name=s,e&&(a.gameObject=e),a}},remove:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!0),this.pipelines.delete(t),e&&this.classes.delete(t),n&&this.postPipelineClasses.delete(t)},set:function(t,e,n){if(!t.isPostFX)return this.isCurrent(t,n)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(n)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=e.length-1;n>=0;n--){var i=e[n];i.active&&i.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=0;n<e.length;n++){var i=e[n];i.active&&i.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=e.length-1;n>=0;n--){var i=e[n];i.active&&i.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,n=0;n<e.length;n++){var i=e[n];i.active&&i.postBatch(t)}}},isCurrent:function(t,e){var n=this.renderer,i=this.current;return i&&!e&&(e=i.currentShader),!(i!==t||e.program!==n.currentProgram)},copyFrame:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,n,i,r),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,n,i){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,n,i),this},blendFrames:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,n,i,r),this},blendFramesAdditive:function(t,e,n,i,r){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,n,i,r),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,n,i,r,s){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,n,i,r,s),this},copyFrameRect:function(t,e,n,i,r,s,o,a){return this.UTILITY_PIPELINE.copyFrameRect(t,e,n,i,r,s,o,a),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},setFX:function(){return this.set(this.FX_PIPELINE)},rebind:function(t){void 0===t&&this.previous&&(t=this.previous);var e=this.renderer,n=e.gl;n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),e.hasActiveStencilMask()?n.clear(n.DEPTH_BUFFER_BIT):(n.disable(n.STENCIL_TEST),n.clear(n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT)),n.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var i=e.vaoExtension;i&&i.bindVertexArrayOES(null);var r=this.pipelines.entries;for(var s in r)r[s].glReset=!0;t&&(this.current=t,t.rebind())},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0);var e=t.vaoExtension;e&&e.bindVertexArrayOES(null)},getRenderTarget:function(t){var e=this.renderTargets;if(t>this.maxDimension)return this.targetIndex=e.length-3,e[this.targetIndex];var n=3*(l(t,this.frameInc,0,!0)-1);return this.targetIndex=n,e[n]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});t.exports=w},37410:(t,e,n)=>{var i=n(56694),r=n(81044),s=new i({initialize:function(t,e,n,i,r,s,o,a,c){void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=!0),void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===c&&(c=!0),this.renderer=t,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=i,this.minFilter=r,this.autoClear=s,this.autoResize=!0,this.hasDepthBuffer=a,this.forceClamp=c,this.resize(e,n),o?this.setAutoResize(!0):this.autoResize=!1},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(r.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(r.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){if((t=Math.round(t*this.scale))<=0&&(t=1),(e=Math.round(e*this.scale))<=0&&(e=1),this.autoResize&&(t!==this.width||e!==this.height)){var n=this.renderer;n.deleteFramebuffer(this.framebuffer),n.deleteTexture(this.texture),this.texture=n.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=n.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e}return this},willResize:function(t,e){return(t=Math.round(t*this.scale))<=0&&(t=1),(e=Math.round(e*this.scale))<=0&&(e=1),t!==this.width||e!==this.height},bind:function(t,e,n){void 0===t&&(t=!1);var i=this.renderer;if(t&&i.flush(),e&&n&&this.resize(e,n),i.pushFramebuffer(this.framebuffer,!1,!1),t&&this.adjustViewport(),this.autoClear){var r=this.renderer.gl;r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)}i.clearStencilMask()},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(){var t=this.renderer,e=t.gl;t.pushFramebuffer(this.framebuffer),e.disable(e.SCISSOR_TEST),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t.popFramebuffer(),t.resetScissor()},unbind:function(t){void 0===t&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.off(r.RESIZE,this.resize,this),t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});t.exports=s},75512:t=>{t.exports={getTintFromFloats:function(t,e,n,i){return((255&(255*i|0))<<24|(255&(255*t|0))<<16|(255&(255*e|0))<<8|255&(255*n|0))>>>0},getTintAppendFloatAlpha:function(t,e){return((255&(255*e|0))<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255&(255*e|0))<<24|(255&(0|t))<<16|(255&(t>>8|0))<<8|255&(t>>16|0))>>>0},getFloatsFromUintRGB:function(t){return[(255&(t>>16|0))/255,(255&(t>>8|0))/255,(255&(0|t))/255]},checkShaderMax:function(t,e){var n=Math.min(16,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));return e&&-1!==e?Math.min(n,e):n},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var n="",i=0;i<e;i++)i>0&&(n+="\n\telse "),i<e-1&&(n+="if (outTexId < "+i+".5)"),n+="\n\t{",n+="\n\t\ttexture = texture2D(uMainSampler["+i+"], outTexCoord);",n+="\n\t}";return(t=t.replace(/%count%/gi,e.toString())).replace(/%forloop%/gi,n)},setGlowQuality:function(t,e,n,i){return void 0===n&&(n=e.config.glowFXQuality),void 0===i&&(i=e.config.glowFXDistance),t=(t=t.replace(/__SIZE__/gi,(1/n/i).toFixed(7))).replace(/__DIST__/gi,i.toFixed(0)+".0")}}},44775:(t,e,n)=>{var i=n(56694),r=n(28699),s=n(6659),o=n(18970),a=n(72632),c=n(16650),l=n(81044),u=n(37410),h=n(75512),d=n(71305),p=new i({Extends:s,initialize:function(t){s.call(this);var e=t.game,n=e.renderer,i=n.gl;this.name=a(t,"name","WebGLPipeline"),this.game=e,this.renderer=n,this.manager,this.gl=i,this.view=e.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=a(t,"topology",i.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=a(t,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=t,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[]},boot:function(){var t,e=this.gl,n=this.config,i=this.renderer;this.isPostFX||(this.projectionMatrix=(new c).identity());var r=this.renderTargets,s=a(n,"renderTarget",!1);"boolean"===typeof s&&s&&(s=1);var h=i.width,d=i.height;if("number"===typeof s)for(t=0;t<s;t++)r.push(new u(i,h,d,1,0,!0));else if(Array.isArray(s))for(t=0;t<s.length;t++){var p=a(s[t],"scale",1),f=a(s[t],"minFilter",0),m=a(s[t],"autoClear",1),g=a(s[t],"width",null),v=a(s[t],"height",g);g?r.push(new u(i,g,v,1,f,m)):r.push(new u(i,h,d,p,f,m))}r.length&&(this.currentRenderTarget=r[0]),this.setShadersFromConfig(n);var y=this.shaders,x=0;for(t=0;t<y.length;t++)y[t].vertexSize>x&&(x=y[t].vertexSize);var b=a(n,"batchSize",i.config.batchSize);this.vertexCapacity=6*b;var w=new ArrayBuffer(this.vertexCapacity*x);this.vertexData=w,this.bytes=new Uint8Array(w),this.vertexViewF32=new Float32Array(w),this.vertexViewU32=new Uint32Array(w);var S=a(n,"vertices",null);for(S?(this.vertexViewF32.set(S),this.vertexBuffer=i.createVertexBuffer(w,e.STATIC_DRAW)):this.vertexBuffer=i.createVertexBuffer(w.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=y.length-1;t>=0;t--)y[t].rebind();this.hasBooted=!0,i.on(l.RESIZE,this.resize,this),i.on(l.PRE_RENDER,this.onPreRender,this),i.on(l.RENDER,this.onRender,this),i.on(l.POST_RENDER,this.onPostRender,this),this.emit(o.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e,n){var i=this.renderer;return t===this.currentShader&&i.currentProgram===this.currentShader.program||(this.flush(),this.setVertexBuffer(n)&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t),this},getShaderByName:function(t){for(var e=this.shaders,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},setShadersFromConfig:function(t){var e,n=this.shaders,i=this.renderer;for(e=0;e<n.length;e++)n[e].destroy();var s="vertShader",o="fragShader",c="attributes",l=a(t,s,null),u=h.parseFragmentShaderMaxTextures(a(t,o,null),i.maxTextures),p=a(t,c,null),f=a(t,"shaders",[]),m=f.length;if(0===m)l&&u&&(this.shaders=[new d(this,"default",l,u,r(p))]);else{var g=[];for(e=0;e<m;e++){var v,y,x,b,w=f[e];if("string"===typeof w?(v="default",y=l,x=h.parseFragmentShaderMaxTextures(w,i.maxTextures),b=p):(v=a(w,"name","default"),y=a(w,s,l),x=h.parseFragmentShaderMaxTextures(a(w,o,u),i.maxTextures),b=a(w,c,p)),"default"===v){var S=x.split("\n")[0].trim();S.indexOf("#define SHADER_NAME")>-1&&(v=S.substring(20))}y&&x&&g.push(new d(this,v,y,x,r(b)))}this.shaders=g}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},createBatch:function(t){return this.currentBatch={start:this.vertexCount,count:0,texture:[t],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=t,this.batch.push(this.currentBatch),0},addTextureToBatch:function(t){var e=this.currentBatch;e&&(e.texture.push(t),e.unit++,e.maxUnit++)},pushBatch:function(t){if(!this.currentBatch||this.forceZero&&t!==this.currentTexture)return this.createBatch(t);if(t===this.currentTexture)return this.currentUnit;var e=this.currentBatch,n=e.texture.indexOf(t);return-1===n?e.texture.length===this.renderer.maxTextures?this.createBatch(t):(e.unit++,e.maxUnit++,e.texture.push(t),this.currentUnit=e.unit,this.currentTexture=t,e.unit):(this.currentUnit=n,this.currentTexture=t,n)},setGameObject:function(t,e){return void 0===e&&(e=t.frame),this.pushBatch(e.source.glTexture)},shouldFlush:function(t){return void 0===t&&(t=0),this.vertexCount+t>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(t,e){t===this.width&&e===this.height||this.flush(),this.width=t,this.height=e;for(var n=this.renderTargets,i=0;i<n.length;i++)n[i].resize(t,e);return this.setProjectionMatrix(t,e),this.emit(o.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var n=this.projectionMatrix;if(!n)return this;this.projectionWidth=t,this.projectionHeight=e,n.ortho(0,t,e,0,-1e3,1e3);for(var i=this.shaders,r="uProjectionMatrix",s=0;s<i.length;s++){var o=i[s];o.hasUniform(r)&&(o.resetUniform(r),o.setMatrix4fv(r,!1,n.val,o))}return this},flipProjectionMatrix:function(t){void 0===t&&(t=!0);var e=this.projectionMatrix;if(!e)return this;var n=this.projectionWidth,i=this.projectionHeight;t?e.ortho(0,n,0,i,-1e3,1e3):e.ortho(0,n,i,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,e.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;this.projectionWidth===t&&this.projectionHeight===e||this.setProjectionMatrix(t,e)}},bind:function(t){if(void 0===t&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=!1,n=this.gl;return n.getParameter(n.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),this.activeBuffer=this.vertexBuffer,e=!0),t.bind(e),this.currentShader=t,this.activeTextures.length=0,this.emit(o.BIND,this,t),this.onActive(t),this},rebind:function(t){this.activeBuffer=null,this.setVertexBuffer();for(var e=this.shaders,n=e.length-1;n>=0;n--){var i=e[n].rebind();t&&i!==t||(this.currentShader=i)}return this.activeTextures.length=0,this.emit(o.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},setVertexBuffer:function(t){if(void 0===t&&(t=this.vertexBuffer),t!==this.activeBuffer){var e=this.gl;return this.gl.bindBuffer(e.ARRAY_BUFFER,t),this.activeBuffer=t,!0}return!1},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(void 0===t&&(t=!1),this.vertexCount>0){this.emit(o.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,n=this.vertexCount,i=this.currentShader.vertexSize,r=this.topology;if(this.active){var s,a,c;this.setVertexBuffer(),n===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,n*i));var l=this.batch,u=this.activeTextures;if(this.forceZero)for(u[0]||e.activeTexture(e.TEXTURE0),s=0;s<l.length;s++)c=(a=l[s]).texture[0],u[0]!==c&&(e.bindTexture(e.TEXTURE_2D,c),u[0]=c),e.drawArrays(r,a.start,a.count);else for(s=0;s<l.length;s++){a=l[s];for(var h=0;h<=a.maxUnit;h++)c=a.texture[h],u[h]!==c&&(e.activeTexture(e.TEXTURE0+h),e.bindTexture(e.TEXTURE_2D,c),u[h]=c);e.drawArrays(r,a.start,a.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(o.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,n,i,r,s,o){var a=this.vertexViewF32,c=this.vertexViewU32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;a[++l]=t,a[++l]=e,a[++l]=n,a[++l]=i,a[++l]=r,a[++l]=s,c[++l]=o,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y,x){void 0===x&&(x=this.currentUnit);var b=!1;this.shouldFlush(6)&&(this.flush(),b=!0),this.currentBatch||(x=this.setTexture2D(y));var w=this.vertexViewF32,S=this.vertexViewU32,_=this.vertexCount*this.currentShader.vertexComponentCount-1;return w[++_]=e,w[++_]=n,w[++_]=l,w[++_]=u,w[++_]=x,w[++_]=v,S[++_]=p,w[++_]=i,w[++_]=r,w[++_]=l,w[++_]=d,w[++_]=x,w[++_]=v,S[++_]=m,w[++_]=s,w[++_]=o,w[++_]=h,w[++_]=d,w[++_]=x,w[++_]=v,S[++_]=g,w[++_]=e,w[++_]=n,w[++_]=l,w[++_]=u,w[++_]=x,w[++_]=v,S[++_]=p,w[++_]=s,w[++_]=o,w[++_]=h,w[++_]=d,w[++_]=x,w[++_]=v,S[++_]=g,w[++_]=a,w[++_]=c,w[++_]=h,w[++_]=u,w[++_]=x,w[++_]=v,S[++_]=f,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),b},batchTri:function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g){void 0===g&&(g=this.currentUnit);var v=!1;this.shouldFlush(3)&&(this.flush(),v=!0),this.currentBatch||(g=this.setTexture2D(m));var y=this.vertexViewF32,x=this.vertexViewU32,b=this.vertexCount*this.currentShader.vertexComponentCount-1;return y[++b]=e,y[++b]=n,y[++b]=a,y[++b]=c,y[++b]=g,y[++b]=f,x[++b]=h,y[++b]=i,y[++b]=r,y[++b]=a,y[++b]=u,y[++b]=g,y[++b]=f,x[++b]=d,y[++b]=s,y[++b]=o,y[++b]=l,y[++b]=u,y[++b]=g,y[++b]=f,x[++b]=p,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),v},drawFillRect:function(t,e,n,i,r,s,o,a){void 0===o&&(o=this.renderer.whiteTexture),void 0===a&&(a=!0),t=Math.floor(t),e=Math.floor(e);var c=Math.floor(t+n),l=Math.floor(e+i),u=this.setTexture2D(o),d=h.getTintAppendFloatAlphaAndSwap(r,s),p=0,f=1;a&&(p=1,f=0),this.batchQuad(null,t,e,t,l,c,l,c,e,0,p,1,f,d,d,d,d,0,o,u)},setTexture2D:function(t){return void 0===t&&(t=this.renderer.whiteTexture),this.pushBatch(t)},bindTexture:function(t,e){void 0===e&&(e=0);var n=this.gl;return n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,t),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t,e){return this.set1f(t,this.game.loop.getDuration(),e),this},setBoolean:function(t,e,n){return void 0===n&&(n=this.currentShader),n.setBoolean(t,e),this},set1f:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1f(t,e),this},set2f:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.set2f(t,e,n),this},set3f:function(t,e,n,i,r){return void 0===r&&(r=this.currentShader),r.set3f(t,e,n,i),this},set4f:function(t,e,n,i,r,s){return void 0===s&&(s=this.currentShader),s.set4f(t,e,n,i,r),this},set1fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1fv(t,e),this},set2fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set2fv(t,e),this},set3fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set3fv(t,e),this},set4fv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set4fv(t,e),this},set1iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1iv(t,e),this},set2iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set2iv(t,e),this},set3iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set3iv(t,e),this},set4iv:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set4iv(t,e),this},set1i:function(t,e,n){return void 0===n&&(n=this.currentShader),n.set1i(t,e),this},set2i:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.set2i(t,e,n),this},set3i:function(t,e,n,i,r){return void 0===r&&(r=this.currentShader),r.set3i(t,e,n,i),this},set4i:function(t,e,n,i,r,s){return void 0===s&&(s=this.currentShader),s.set4i(t,e,n,i,r),this},setMatrix2fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix2fv(t,e,n),this},setMatrix3fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix3fv(t,e,n),this},setMatrix4fv:function(t,e,n,i){return void 0===i&&(i=this.currentShader),i.setMatrix4fv(t,e,n),this},destroy:function(){var t;this.emit(o.DESTROY,this);var e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var n=this.renderTargets;for(t=0;t<n.length;t++)n[t].destroy();this.gl.deleteBuffer(this.vertexBuffer);var i=this.renderer;return i.off(l.RESIZE,this.resize,this),i.off(l.PRE_RENDER,this.onPreRender,this),i.off(l.RENDER,this.onRender,this),i.off(l.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});t.exports=p},11857:(t,e,n)=>{var i=n(66458),r=n(89787),s=n(56694),o=n(86459),a=n(6659),c=n(81044),l=n(28621),u=n(16650),h=n(72283),d=n(35217),p=n(37410),f=n(40444),m=n(38203),g=n(75512),v=n(1217),y=new s({Extends:a,initialize:function(t){a.call(this);var e=t.config,n={alpha:e.transparent,desynchronized:e.desynchronized,depth:!0,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference,preserveDrawingBuffer:e.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:n,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights,mipmapFilter:e.mipmapFilter},this.game=t,this.type=o.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=h,this.contextRestoredHandler=h,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(t){var e,n=this.game,i=this.canvas,r=t.backgroundColor;if(!(e=n.config.context?n.config.context:i.getContext("webgl",t.contextCreation)||i.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e;var s=this;this.contextLostHandler=function(t){s.contextLost=!0,console&&console.warn("WebGL Context lost. Renderer disabled"),t.preventDefault()},i.addEventListener("webglcontextlost",this.contextLostHandler,!1),n.context=e;for(var a=0;a<=27;a++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats=[e.BYTE,e.SHORT,e.UNSIGNED_BYTE,e.UNSIGNED_SHORT,e.FLOAT],this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}};var c=e.getSupportedExtensions();t.maxTextures&&-1!==t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),this.supportedExtensions=c;var l="ANGLE_instanced_arrays";this.instancedArraysExtension=c.indexOf(l)>-1?e.getExtension(l):null;var h="OES_vertex_array_object";this.vaoExtension=c.indexOf(h)>-1?e.getExtension(h):null,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),-1!==["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"].indexOf(t.mipmapFilter)&&(this.mipmapFilter=e[t.mipmapFilter]),this.maxTextures=g.checkShaderMax(e,t.maxTextures),this.textureIndexes=[];for(var p=0;p<this.maxTextures;p++){var f=e.createTexture();e.activeTexture(e.TEXTURE0+p),e.bindTexture(e.TEXTURE_2D,f),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(p)}return this.pipelines=new d(this),this.setBlendMode(o.BlendModes.NORMAL),this.projectionMatrix=(new u).identity(),n.textures.once(m.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,n=t.scale.baseSize,i=n.width,r=n.height;this.width=i,this.height=r,this.isBooted=!0,this.renderTarget=new p(this,i,r,1,0,!0,!0),this.maskTarget=new p(this,i,r,1,0,!0,!0),this.maskSource=new p(this,i,r,1,0,!0,!0);var s=t.config;e.boot(s.pipeline,s.defaultPipeline,s.autoMobilePipeline),this.blankTexture=t.textures.getFrame("__DEFAULT").glTexture,this.whiteTexture=t.textures.getFrame("__WHITE").glTexture;var o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,null),o.enable(o.SCISSOR_TEST),t.scale.on(f.RESIZE,this.onResize,this),this.resize(i,r)},captureFrame:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1)},captureNextFrame:function(){},getFps:function(){},log:function(){},startCapture:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1)},stopCapture:function(){},onCapture:function(t){},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},beginCapture:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var n=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),n.viewport(0,0,t,e),this.drawingBufferHeight=n.drawingBufferHeight,n.scissor(0,n.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(c.RESIZE,t,e),this},getCompressedTextures:function(){var t="WEBGL_compressed_texture_",e="WEBKIT_"+t,n=function(n,i){var r=n.getExtension(t+i)||n.getExtension(e+i);if(r){var s={};for(var o in r)s[r[o]]=o;return s}},i=this.gl;return{ETC:n(i,"etc"),ETC1:n(i,"etc1"),ATC:n(i,"atc"),ASTC:n(i,"astc"),BPTC:n(i,"bptc"),RGTC:n(i,"rgtc"),PVRTC:n(i,"pvrtc"),S3TC:n(i,"s3tc"),S3TCSRGB:n(i,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(t,e){var n=this.compression[t.toUpperCase()];if(e in n)return n[e]},supportsCompressedTexture:function(t,e){var n=this.compression[t.toUpperCase()];return!!n&&(!e||e in n)},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return t===this.projectionWidth&&e===this.projectionHeight||(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=[t,e,n,i];return this.scissorStack.push(s),this.setScissor(t,e,n,i,r),this.currentScissor=s,s},setScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=this.gl,o=this.currentScissor,a=n>0&&i>0;if(o&&a){var c=o[0],l=o[1],u=o[2],h=o[3];a=c!==t||l!==e||u!==n||h!==i}a&&(this.flush(),s.scissor(t,r-e-i,n,i))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var n=e[0],i=e[1],r=e[2],s=e[3];r>0&&s>0&&t.scissor(n,this.drawingBufferHeight-i-s,r,s)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){void 0===e&&(e=!1);var n=this.gl,i=this.blendModes[t];return!!(e||t!==o.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),n.enable(n.BLEND),n.blendEquation(i.equation),i.func.length>2?n.blendFuncSeparate(i.func[0],i.func[1],i.func[2],i.func[3]):n.blendFunc(i.func[0],i.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,n){return this.blendModes[t]&&(this.blendModes[t].func=e,n&&(this.blendModes[t].equation=n)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},pushFramebuffer:function(t,e,n,i,r){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,n,i,r))},setFramebuffer:function(t,e,n,i,r){if(void 0===e&&(e=!1),void 0===n&&(n=!0),void 0===i&&(i=null),void 0===r&&(r=!1),t===this.currentFramebuffer)return this;var s=this.gl,o=this.width,a=this.height;return t&&t.renderTexture&&n?(o=t.renderTexture.width,a=t.renderTexture.height):this.flush(),s.bindFramebuffer(s.FRAMEBUFFER,t),n&&s.viewport(0,0,o,a),i&&s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0),r&&(s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)),e&&(t?(this.drawingBufferHeight=a,this.pushScissor(0,0,o,a)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,this},popFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var n=this.fboStack;n.pop();var i=n[n.length-1];return i||(i=null),this.setFramebuffer(i,t,e),i},restoreFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var n=this.fboStack,i=n[n.length-1];i||(i=null),this.currentFramebuffer=null,this.setFramebuffer(i,t,e)},setProgram:function(t){return t!==this.currentProgram&&(this.flush(),this.gl.useProgram(t),this.currentProgram=t,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram),this},createTextureFromSource:function(t,e,n,i,r){void 0===r&&(r=!1);var s=this.gl,a=s.NEAREST,c=s.NEAREST,u=s.CLAMP_TO_EDGE;e=t?t.width:e,n=t?t.height:n;var h=l(e,n);return h&&!r&&(u=s.REPEAT),i===o.ScaleModes.LINEAR&&this.config.antialias&&(a=h&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,c=s.LINEAR),t&&t.compressed&&(a=s.LINEAR,c=s.LINEAR),t||"number"!==typeof e||"number"!==typeof n?this.createTexture2D(0,a,c,u,u,s.RGBA,t):this.createTexture2D(0,a,c,u,u,s.RGBA,null,e,n)},createTexture2D:function(t,e,n,i,r,s,o,a,c,u,h,d){u=void 0===u||null===u||u,void 0===h&&(h=!1),void 0===d&&(d=!1);var p=this.gl,f=p.createTexture();p.activeTexture(p.TEXTURE0);var m=p.getParameter(p.TEXTURE_BINDING_2D);p.bindTexture(p.TEXTURE_2D,f),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,i),p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),d&&p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!0);var g=!1;if(null===o||void 0===o)p.texImage2D(p.TEXTURE_2D,t,s,a,c,0,s,p.UNSIGNED_BYTE,null),g=l(a,c);else if(o.compressed){a=o.width,c=o.height,g=o.generateMipmap;for(var v=0;v<o.mipmaps.length;v++)p.compressedTexImage2D(p.TEXTURE_2D,v,o.internalFormat,o.mipmaps[v].width,o.mipmaps[v].height,0,o.mipmaps[v].data)}else h||(a=o.width,c=o.height),p.texImage2D(p.TEXTURE_2D,t,s,s,p.UNSIGNED_BYTE,o),g=l(a,c);return g&&p.generateMipmap(p.TEXTURE_2D),m&&p.bindTexture(p.TEXTURE_2D,m),f.isAlphaPremultiplied=u,f.isRenderTexture=!1,f.width=a,f.height=c,f},createFramebuffer:function(t,e,n,i){void 0===i&&(i=!0);var r,s=this.gl,o=s.createFramebuffer();if(this.setFramebuffer(o),n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),(r=s.checkFramebufferStatus(s.FRAMEBUFFER))!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+({36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"}[r]||r));if(o.renderTexture=n,i){var a=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,a),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t,e),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)}return this.setFramebuffer(null),o},beginBitmapMask:function(t,e){this.gl&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==t&&(this.currentMask.mask=t,this.currentMask.camera=e))},drawBitmapMask:function(t,e,n){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),t.renderWebGL(this,t,e),this.maskSource.unbind(!0),this.maskTarget.unbind();var i=this.gl,r=this.getCurrentStencilMask();r?(i.enable(i.STENCIL_TEST),r.mask.applyStencil(this,r.camera,!0)):this.currentMask.mask=null,this.pipelines.set(n),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.maskTarget.texture),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.maskSource.texture)},createProgram:function(t,e){var n=this.gl,i=n.createProgram(),r=n.createShader(n.VERTEX_SHADER),s=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(r,t),n.shaderSource(s,e),n.compileShader(r),n.compileShader(s);var o="Shader failed:\n";if(!n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Vertex "+o+n.getShaderInfoLog(r));if(!n.getShaderParameter(s,n.COMPILE_STATUS))throw new Error("Fragment "+o+n.getShaderInfoLog(s));if(n.attachShader(i,r),n.attachShader(i,s),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw new Error("Link "+o+n.getProgramInfoLog(i));return n.useProgram(i),i},createVertexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,t,e),n.bindBuffer(n.ARRAY_BUFFER,null),i},createIndexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,e),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),i},deleteTexture:function(t){return t&&this.gl.deleteTexture(t),this},deleteFramebuffer:function(t){if(!t)return this;var e=this.gl;this.currentFramebuffer===t&&(this.currentFramebuffer=null),i(this.fboStack,t),e.bindFramebuffer(e.FRAMEBUFFER,t),t.renderTexture=void 0;var n=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==n&&(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.deleteTexture(n));var r=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);return null!==r&&e.deleteRenderbuffer(r),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(t),this},deleteProgram:function(t){return t&&this.gl.deleteProgram(t),this},deleteBuffer:function(t){return this.gl.deleteBuffer(t),this},preRenderCamera:function(t){var e=t.x,n=t.y,i=t.width,s=t.height,o=t.backgroundColor;t.emit(r.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,n,i,s),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),o.alphaGL>0&&this.pipelines.setMulti().drawFillRect(e,n,i,s,g.getTintFromFloats(o.blueGL,o.greenGL,o.redGL,1),o.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,n=this.currentCameraMask;return e.length>0?t=e[e.length-1]:n.mask&&n.mask.isStencil&&(t=n),t},postRenderCamera:function(t){var e=t.flashEffect,n=t.fadeEffect;if(e.isRunning||n.isRunning||n.isComplete){var i=this.pipelines.setMulti();e.postRenderWebGL(i,g.getTintFromFloats),n.postRenderWebGL(i,g.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(r.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(c.PRE_RENDER)}},render:function(t,e,n){if(!this.contextLost){var i=e.length;if(this.emit(c.RENDER,t,n),this.preRenderCamera(n),0===i)return this.setBlendMode(o.BlendModes.NORMAL),void this.postRenderCamera(n);this.currentType="";for(var r=this.currentMask,s=0;s<i;s++){this.finalType=s===i-1;var a=e[s],l=a.mask;(r=this.currentMask).mask&&r.mask!==l&&r.mask.postRenderWebGL(this,r.camera),l&&r.mask!==l&&l.preRenderWebGL(this,a,n),a.blendMode!==this.currentBlendMode&&this.setBlendMode(a.blendMode);var u=a.type;u!==this.currentType&&(this.newType=!0,this.currentType=u),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[s+1].type===this.currentType,a.renderWebGL(this,a,n),this.newType=!1}(r=this.currentMask).mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(n)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(c.POST_RENDER);var t=this.snapshotState;t.callback&&(v(this.gl,t),t.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var t=this.gl,e=this.getCurrentStencilMask();if(e){var n=e.mask;t.enable(t.STENCIL_TEST),n.invertAlpha?t.stencilFunc(t.NOTEQUAL,n.level,255):t.stencilFunc(t.EQUAL,n.level,255)}},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=n,a.height=i,this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,n,i,r,s,o,a,c,l,u){void 0===r&&(r=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=e),void 0===c&&(c=n),"pixel"===l&&(r=!0,l="image/png");var h=this.currentFramebuffer;this.snapshotArea(s,o,a,c,i,l,u);var d=this.snapshotState;return d.getPixel=r,d.isFramebuffer=!0,d.bufferWidth=e,d.bufferHeight=n,d.width=Math.min(d.width,e),d.height=Math.min(d.height,n),this.setFramebuffer(t),v(this.gl,d),this.setFramebuffer(h),d.callback=null,d.isFramebuffer=!1,this},canvasToTexture:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e?this.updateCanvasTexture(t,e,i):this.createCanvasTexture(t,n,i)},createCanvasTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=i.NEAREST,s=i.NEAREST,o=t.width,a=t.height,c=i.CLAMP_TO_EDGE,u=l(o,a);return!e&&u&&(c=i.REPEAT),this.config.antialias&&(r=u&&this.mipmapFilter?this.mipmapFilter:i.LINEAR,s=i.LINEAR),this.createTexture2D(0,r,s,c,c,i.RGBA,t,o,a,!0,!1,n)},updateCanvasTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.width,s=t.height;if(r>0&&s>0){i.activeTexture(i.TEXTURE0);var o=i.getParameter(i.TEXTURE_BINDING_2D);i.bindTexture(i.TEXTURE_2D,e),n&&i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,o&&i.bindTexture(i.TEXTURE_2D,o)}return e},createVideoTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=i.NEAREST,s=i.NEAREST,o=t.videoWidth,a=t.videoHeight,c=i.CLAMP_TO_EDGE,u=l(o,a);return!e&&u&&(c=i.REPEAT),this.config.antialias&&(r=u&&this.mipmapFilter?this.mipmapFilter:i.LINEAR,s=i.LINEAR),this.createTexture2D(0,r,s,c,c,i.RGBA,t,o,a,!0,!0,n)},updateVideoTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.videoWidth,s=t.videoHeight;if(r>0&&s>0){i.activeTexture(i.TEXTURE0);var o=i.getParameter(i.TEXTURE_BINDING_2D);i.bindTexture(i.TEXTURE_2D,e),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,o&&i.bindTexture(i.TEXTURE_2D,o)}return e},setTextureFilter:function(t,e){var n=this.gl,i=0===e?n.LINEAR:n.NEAREST;n.activeTexture(n.TEXTURE0);var r=n.getParameter(n.TEXTURE_BINDING_2D);return n.bindTexture(n.TEXTURE_2D,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,i),r&&n.bindTexture(n.TEXTURE_2D,r),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}});t.exports=y},71305:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(71402),o=new i({initialize:function(t,e,n,i,r){this.pipeline=t,this.name=e,this.renderer=t.renderer,this.gl=this.renderer.gl,this.fragSrc=i,this.vertSrc=n,this.program=this.renderer.createProgram(n,i),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(r),this.createUniforms()},createAttributes:function(t){var e=0,n=0,i=[];this.vertexComponentCount=0;for(var o=0;o<t.length;o++){var a=t[o],c=a.name,l=r(a,"size",1),u=r(a,"type",s.FLOAT),h=u.enum,d=u.size,p=!!a.normalized;i.push({name:c,size:l,type:h,normalized:p,offset:n,enabled:!1,location:-1}),4===d?e+=l:e++,n+=l*d}this.vertexSize=n,this.vertexComponentCount=e,this.attributes=i},bind:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){void 0===t&&(t=!1);for(var e=this.gl,n=this.vertexSize,i=this.attributes,r=this.program,s=0;s<i.length;s++){var o=i[s],a=o.size,c=o.type,l=o.offset,u=o.enabled,h=o.location,d=!!o.normalized;if(t){var p=e.getAttribLocation(r,o.name);p>=0?(e.enableVertexAttribArray(p),e.vertexAttribPointer(p,a,c,d,n,l),o.enabled=!0,o.location=p):-1!==p&&e.disableVertexAttribArray(p)}else u?e.vertexAttribPointer(h,a,c,d,n,l):!u&&h>-1&&(e.disableVertexAttribArray(h),o.location=-1)}return this},createUniforms:function(){var t,e,n,i=this.gl,r=this.program,s=this.uniforms,o=i.getProgramParameter(r,i.ACTIVE_UNIFORMS);for(t=0;t<o;t++){var a=i.getActiveUniform(r,t);if(a){e=a.name,null!==(n=i.getUniformLocation(r,e))&&(s[e]={name:e,location:n,value1:null,value2:null,value3:null,value4:null});var c=e.indexOf("[");c>0&&(e=e.substr(0,c),s.hasOwnProperty(e)||null!==(n=i.getUniformLocation(r,e))&&(s[e]={name:e,location:n,value1:null,value2:null,value3:null,value4:null}))}}return this},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,n,i){var r=this.uniforms[e];return r?((i||r.value1!==n)&&(r.value1=n,this.renderer.setProgram(this.program),t.call(this.gl,r.location,n),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,n,i,r){var s=this.uniforms[e];return s?((r||s.value1!==n||s.value2!==i)&&(s.value1=n,s.value2=i,this.renderer.setProgram(this.program),t.call(this.gl,s.location,n,i),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,n,i,r,s){var o=this.uniforms[e];return o?((s||o.value1!==n||o.value2!==i||o.value3!==r)&&(o.value1=n,o.value2=i,o.value3=r,this.renderer.setProgram(this.program),t.call(this.gl,o.location,n,i,r),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,n,i,r,s,o){var a=this.uniforms[e];return a?((o||a.value1!==n||a.value2!==i||a.value3!==r||a.value4!==s)&&(a.value1=n,a.value2=i,a.value3=r,a.value4=s,this.renderer.setProgram(this.program),t.call(this.gl,a.location,n,i,r,s),this.pipeline.currentShader=this),this):this},setBoolean:function(t,e){return this.setUniform1(this.gl.uniform1i,t,Number(e))},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,n){return this.setUniform2(this.gl.uniform2f,t,e,n)},set3f:function(t,e,n,i){return this.setUniform3(this.gl.uniform3f,t,e,n,i)},set4f:function(t,e,n,i,r){return this.setUniform4(this.gl.uniform4f,t,e,n,i,r)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e,!0)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e,!0)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e,!0)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e,!0)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e,!0)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e,!0)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e,!0)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e,!0)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,n){return this.setUniform2(this.gl.uniform2i,t,e,n)},set3i:function(t,e,n,i){return this.setUniform3(this.gl.uniform3i,t,e,n,i)},set4i:function(t,e,n,i,r){return this.setUniform4(this.gl.uniform4i,t,e,n,i,r)},setMatrix2fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,n,!0)},setMatrix3fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,n,!0)},setMatrix4fv:function(t,e,n){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,n,!0)},createProgram:function(t,e){void 0===t&&(t=this.vertSrc),void 0===e&&(e=this.fragSrc);var n=this.gl;return this.program&&n.deleteProgram(this.program),this.vertSrc=t,this.fragSrc=e,this.program=this.renderer.createProgram(t,e),this.createUniforms(),this.rebind()},destroy:function(){this.gl.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null,this.attributes=null,this.uniforms=null}});t.exports=o},71402:t=>{t.exports={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}}},55478:(t,e,n)=>{var i=n(71402),r=n(98611),s={PipelineManager:n(35217),Pipelines:n(62253),RenderTarget:n(37410),Utils:n(75512),WebGLPipeline:n(44775),WebGLRenderer:n(11857),WebGLShader:n(71305)};s=r(!1,s,i),t.exports=s},5583:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(91679),o=n(89053),a=n(71402),c=n(44775),l=new i({Extends:c,initialize:function(t){t.fragShader=r(t,"fragShader",s),t.vertShader=r(t,"vertShader",o),t.batchSize=r(t,"batchSize",1),t.vertices=r(t,"vertices",[-1,1,-1,-7,7,1]),t.attributes=r(t,"attributes",[{name:"inPosition",size:2,type:a.FLOAT}]),c.call(this,t)},boot:function(){c.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){c.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,n){this.renderer.beginBitmapMask(t,n)},endMask:function(t,e,n){var i=this.gl,r=this.renderer,s=t.bitmapMask;s&&i&&(r.drawBitmapMask(s,e,this),n&&this.set2f("uResolution",n.width,n.height),this.set1i("uInvertMaskAlpha",t.invertAlpha),i.drawArrays(this.topology,0,3),n&&this.set2f("uResolution",this.width,this.height),i.bindTexture(i.TEXTURE_2D,null))}});t.exports=l},81828:(t,e,n)=>{var i=n(56694),r=n(58136),s=n(47406),o=n(72632),a=n(87228),c=n(92462),l=n(75512),u=new i({Extends:a,initialize:function(t){t.shaders=[l.setGlowQuality(c.FXGlowFrag,t.game),c.FXShadowFrag,c.FXPixelateFrag,c.FXVignetteFrag,c.FXShineFrag,c.FXBlurLowFrag,c.FXBlurMedFrag,c.FXBlurHighFrag,c.FXGradientFrag,c.FXBloomFrag,c.ColorMatrixFrag,c.FXCircleFrag,c.FXBarrelFrag,c.FXDisplacementFrag,c.FXWipeFrag,c.FXBokehFrag],a.call(this,t);var e=this.game;this.glow=new r.Glow(e),this.shadow=new r.Shadow(e),this.pixelate=new r.Pixelate(e),this.vignette=new r.Vignette(e),this.shine=new r.Shine(e),this.gradient=new r.Gradient(e),this.circle=new r.Circle(e),this.barrel=new r.Barrel(e),this.wipe=new r.Wipe(e),this.bokeh=new r.Bokeh(e);var n=[];n[s.GLOW]=this.onGlow,n[s.SHADOW]=this.onShadow,n[s.PIXELATE]=this.onPixelate,n[s.VIGNETTE]=this.onVignette,n[s.SHINE]=this.onShine,n[s.BLUR]=this.onBlur,n[s.GRADIENT]=this.onGradient,n[s.BLOOM]=this.onBloom,n[s.COLOR_MATRIX]=this.onColorMatrix,n[s.CIRCLE]=this.onCircle,n[s.BARREL]=this.onBarrel,n[s.DISPLACEMENT]=this.onDisplacement,n[s.WIPE]=this.onWipe,n[s.BOKEH]=this.onBokeh,this.fxHandlers=n,this.source,this.target,this.swap},onDraw:function(t,e,n){this.source=t,this.target=e,this.swap=n;var i=t.width,r=t.height,s=this.tempSprite,o=this.fxHandlers;if(s&&s.preFX)for(var a=s.preFX.list,c=0;c<a.length;c++){var l=a[c];l.active&&o[l.type].call(this,l,i,r)}this.drawToGame(this.source)},runDraw:function(){var t=this.source,e=this.target;this.copy(t,e),this.source=e,this.target=t},onGlow:function(t,e,n){var i=this.shaders[s.GLOW];this.setShader(i),this.glow.onPreRender(t,i,e,n),this.runDraw()},onShadow:function(t){var e=this.shaders[s.SHADOW];this.setShader(e),this.shadow.onPreRender(t,e),this.runDraw()},onPixelate:function(t,e,n){var i=this.shaders[s.PIXELATE];this.setShader(i),this.pixelate.onPreRender(t,i,e,n),this.runDraw()},onVignette:function(t){var e=this.shaders[s.VIGNETTE];this.setShader(e),this.vignette.onPreRender(t,e),this.runDraw()},onShine:function(t,e,n){var i=this.shaders[s.SHINE];this.setShader(i),this.shine.onPreRender(t,i,e,n),this.runDraw()},onBlur:function(t,e,n){var i=o(t,"quality"),r=this.shaders[s.BLUR+i];this.setShader(r),this.set1i("uMainSampler",0),this.set2f("resolution",e,n),this.set1f("strength",o(t,"strength")),this.set3fv("color",o(t,"glcolor"));for(var a=o(t,"x"),c=o(t,"y"),l=o(t,"steps"),u=0;u<l;u++)this.set2f("offset",a,0),this.runDraw(),this.set2f("offset",0,c),this.runDraw()},onGradient:function(t){var e=this.shaders[s.GRADIENT];this.setShader(e),this.gradient.onPreRender(t,e),this.runDraw()},onBloom:function(t,e,n){var i=this.shaders[s.BLOOM];this.copySprite(this.source,this.swap),this.setShader(i),this.set1i("uMainSampler",0),this.set1f("strength",o(t,"blurStrength")),this.set3fv("color",o(t,"glcolor"));for(var r=2/e*o(t,"offsetX"),a=2/n*o(t,"offsetY"),c=o(t,"steps"),l=0;l<c;l++)this.set2f("offset",r,0),this.runDraw(),this.set2f("offset",0,a),this.runDraw();this.blendFrames(this.swap,this.source,this.target,o(t,"strength")),this.copySprite(this.target,this.source)},onColorMatrix:function(t){this.setShader(this.colorMatrixShader),this.set1fv("uColorMatrix",t.getData()),this.set1f("uAlpha",t.alpha),this.runDraw()},onCircle:function(t,e,n){var i=this.shaders[s.CIRCLE];this.setShader(i),this.circle.onPreRender(t,i,e,n),this.runDraw()},onBarrel:function(t){var e=this.shaders[s.BARREL];this.setShader(e),this.barrel.onPreRender(t,e),this.runDraw()},onDisplacement:function(t){this.setShader(this.shaders[s.DISPLACEMENT]),this.set1i("uDisplacementSampler",1),this.set2f("amount",t.x,t.y),this.bindTexture(t.glTexture,1),this.runDraw()},onWipe:function(t){var e=this.shaders[s.WIPE];this.setShader(e),this.wipe.onPreRender(t,e),this.runDraw()},onBokeh:function(t,e,n){var i=this.shaders[s.BOKEH];this.setShader(i),this.bokeh.onPreRender(t,i,e,n),this.runDraw()},destroy:function(){return this.glow.destroy(),this.shadow.destroy(),this.pixelate.destroy(),this.vignette.destroy(),this.shine.destroy(),this.gradient.destroy(),this.circle.destroy(),this.barrel.destroy(),this.wipe.destroy(),this.bokeh.destroy(),this.fxHandlers=null,this.source=null,this.target=null,this.swap=null,a.prototype.destroy.call(this),this}});t.exports=u},66901:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(65045),o=n(77310),a=n(69360),c=n(93736),l=n(44775),u=new i({Extends:o,initialize:function(t){var e=r(t,"fragShader",s);t.fragShader=e.replace("%LIGHT_COUNT%",t.game.renderer.config.maxLights),o.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.defaultNormalMap,this.currentNormalMap,this.lightsActive=!0,this.tempVec2=new c,this._tempMatrix=new a,this._tempMatrix2=new a},boot:function(){l.prototype.boot.call(this);var t=this.gl,e=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([127,127,255,255])),this.defaultNormalMap={glTexture:e}},onRender:function(t,e){var n=t.sys.lights;if(this.lightsActive=!1,n&&n.active){var i,r=n.getLights(e),s=r.length;this.lightsActive=!0;var o=this.renderer.height,a=e.matrix,c=this.tempVec2;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",e.x,e.y,e.rotation,e.zoom),this.set3f("uAmbientLightColor",n.ambientColor.r,n.ambientColor.g,n.ambientColor.b),this.set1i("uLightCount",s),i=0;i<s;i++){var l=r[i].light,u=l.color,h="uLights["+i+"].";a.transformPoint(l.x,l.y,c),this.set2f(h+"position",c.x-e.scrollX*l.scrollFactorX*e.zoom,o-(c.y-e.scrollY*l.scrollFactorY*e.zoom)),this.set3f(h+"color",u.r,u.g,u.b),this.set1f(h+"intensity",l.intensity),this.set1f(h+"radius",l.radius)}this.currentNormalMapRotation=null}},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.vertexCount){this.vertexCount>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var n=-t,i=Math.cos(n),r=Math.sin(n);e[1]=r,e[3]=-r,e[0]=e[4]=i}else e[0]=e[4]=1,e[1]=e[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},setTexture2D:function(t,e){var n=this.renderer;void 0===t&&(t=n.whiteTexture);var i=this.getNormalMap(e);this.isNewNormalMap(t,i)&&(this.flush(),this.createBatch(t),this.addTextureToBatch(i),this.currentNormalMap=i);var r=0;return e&&e.parentContainer?r=e.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2).rotationNormalized:e&&(r=e.rotation),this.setNormalMapRotation(r),0},setGameObject:function(t,e){void 0===e&&(e=t.frame);var n=e.glTexture,i=this.getNormalMap(t);if(this.isNewNormalMap(n,i)&&(this.flush(),this.createBatch(n),this.addTextureToBatch(i),this.currentNormalMap=i),t.parentContainer){var r=t.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);this.setNormalMapRotation(r.rotationNormalized)}else this.setNormalMapRotation(t.rotation);return 0},isNewNormalMap:function(t,e){return this.currentTexture!==t||this.currentNormalMap!==e},getNormalMap:function(t){var e;return t?t.displayTexture?e=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?e=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(e=Array.isArray(t.tileset)?t.tileset[0].image.dataSource[0]:t.tileset.image.dataSource[0]):e=this.defaultNormalMap,e||(e=this.defaultNormalMap),e.glTexture},batchSprite:function(t,e,n){this.lightsActive&&o.prototype.batchSprite.call(this,t,e,n)},batchTexture:function(t,e,n,i,r,s,a,c,l,u,h,d,p,f,m,g,v,y,x,b,w,S,_,T,E,C,k,A,I,O,R,N){this.lightsActive&&o.prototype.batchTexture.call(this,t,e,n,i,r,s,a,c,l,u,h,d,p,f,m,g,v,y,x,b,w,S,_,T,E,C,k,A,I,O,R,N)},batchTextureFrame:function(t,e,n,i,r,s,a){this.lightsActive&&o.prototype.batchTextureFrame.call(this,t,e,n,i,r,s,a)}});t.exports=u},71264:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(77310),o=n(85060),a=n(18166),c=n(71402),l=n(44775),u=new i({Extends:s,initialize:function(t){t.fragShader=r(t,"fragShader",o),t.vertShader=r(t,"vertShader",a),t.attributes=r(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:c.UNSIGNED_BYTE,normalized:!0}]),t.forceZero=!0,s.call(this,t)},boot:function(){l.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height),this.set1i("uRoundPixels",t.config.roundPixels)}});t.exports=u},77310:(t,e,n)=>{var i=n(56694),r=n(11117),s=n(72632),o=n(53787),a=n(15968),c=n(69360),l=n(75512),u=n(71402),h=n(44775),d=new i({Extends:h,initialize:function(t){var e=t.game.renderer,n=s(t,"fragShader",o);t.fragShader=l.parseFragmentShaderMaxTextures(n,e.maxTextures),t.vertShader=s(t,"vertShader",a),t.attributes=s(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:u.UNSIGNED_BYTE,normalized:!0}]),h.call(this,t),this._tempMatrix1=new c,this._tempMatrix2=new c,this._tempMatrix3=new c,this.calcMatrix=new c,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){h.prototype.boot.call(this);var t=this.renderer;this.set1iv("uMainSampler",t.textureIndexes),this.set2f("uResolution",t.width,t.height),this.set1i("uRoundPixels",t.config.roundPixels)},batchSprite:function(t,e,n){this.manager.set(this,t);var i=this._tempMatrix1,r=this._tempMatrix2,s=this._tempMatrix3,o=t.frame,a=o.glTexture,c=o.u0,u=o.v0,h=o.u1,d=o.v1,p=o.x,f=o.y,m=o.cutWidth,g=o.cutHeight,v=o.customPivot,y=t.displayOriginX,x=t.displayOriginY,b=-y+p,w=-x+f;if(t.isCropped){var S=t._crop;S.flipX===t.flipX&&S.flipY===t.flipY||o.updateCropUVs(S,t.flipX,t.flipY),c=S.u0,u=S.v0,h=S.u1,d=S.v1,m=S.width,g=S.height,b=-y+(p=S.x),w=-x+(f=S.y)}var _=1,T=1;t.flipX&&(v||(b+=-o.realWidth+2*y),_=-1),(t.flipY||o.source.isGLTexture&&!a.flipY)&&(v||(w+=-o.realHeight+2*x),T=-1);var E=t.x,C=t.y;r.applyITRS(E,C,t.rotation,t.scaleX*_,t.scaleY*T),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),r.e=E,r.f=C):(r.e-=e.scrollX*t.scrollFactorX,r.f-=e.scrollY*t.scrollFactorY),i.multiply(r,s);var k=s.setQuad(b,w,b+m,w+g),A=l.getTintAppendFloatAlpha,I=e.alpha,O=A(t.tintTopLeft,I*t._alphaTL),R=A(t.tintTopRight,I*t._alphaTR),N=A(t.tintBottomLeft,I*t._alphaBL),M=A(t.tintBottomRight,I*t._alphaBR);this.shouldFlush(6)&&this.flush();var D=this.setGameObject(t,o);this.manager.preBatch(t),this.currentShader.set1i("uRoundPixels",e.roundPixels),this.batchQuad(t,k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],c,u,h,d,O,R,N,M,t.tintFill,a,D),this.manager.postBatch(t)},batchTexture:function(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y,x,b,w,S,_,T,E,C,k,A,I,O,R,N){void 0===N&&(N=!1),this.manager.set(this,t);var M=this._tempMatrix1,D=this._tempMatrix2,P=this._tempMatrix3,F=v/n+C,L=y/i+k,B=(v+x)/n+C,z=(y+b)/i+k,U=o,j=a,V=-m,W=-g;if(t.isCropped){var G=t._crop,q=G.width,H=G.height;U=q,j=H,o=q,a=H;var X=v=G.x,Y=y=G.y;h&&(X=x-G.x-q),d&&(Y=b-G.y-H),F=X/n+C,L=Y/i+k,B=(X+q)/n+C,z=(Y+H)/i+k,V=-m+v,W=-g+y}h&&(U*=-1,V+=o),(d^=!O&&e.isRenderTexture?1:0)&&(j*=-1,W+=a),D.applyITRS(r,s,u,c,l),M.copyFrom(A.matrix),I?(M.multiplyWithOffset(I,-A.scrollX*p,-A.scrollY*f),D.e=r,D.f=s):(D.e-=A.scrollX*p,D.f-=A.scrollY*f),M.multiply(D,P);var K=P.setQuad(V,W,V+U,W+j);void 0!==R&&null!==R||(R=this.setTexture2D(e)),t&&!N&&this.manager.preBatch(t),this.currentShader.set1i("uRoundPixels",A.roundPixels),this.batchQuad(t,K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],F,L,B,z,w,S,_,T,E,e,R),t&&!N&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,n,i,r,s,o){this.manager.set(this);var a=this._tempMatrix1.copyFrom(s),c=this._tempMatrix2;o?a.multiply(o,c):c=a;var u=c.setQuad(e,n,e+t.width,n+t.height),h=this.setTexture2D(t.source.glTexture);i=l.getTintAppendFloatAlpha(i,r),this.batchQuad(null,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],t.u0,t.v0,t.u1,t.v1,i,i,i,i,0,t.glTexture,h)},batchFillRect:function(t,e,n,i,r,s){this.renderer.pipelines.set(this);var o=this.calcMatrix;s&&s.multiply(r,o);var a=o.setQuad(t,e,t+n,e+i),c=this.fillTint;this.batchQuad(null,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],0,0,1,1,c.TL,c.TR,c.BL,c.BR,2)},batchFillTriangle:function(t,e,n,i,r,s,o,a){this.renderer.pipelines.set(this);var c=this.calcMatrix;a&&a.multiply(o,c);var l=c.getX(t,e),u=c.getY(t,e),h=c.getX(n,i),d=c.getY(n,i),p=c.getX(r,s),f=c.getY(r,s),m=this.fillTint;this.currentShader.set1i("uRoundPixels",!1),this.batchTri(null,l,u,h,d,p,f,0,0,1,1,m.TL,m.TR,m.BL,2)},batchStrokeTriangle:function(t,e,n,i,r,s,o,a,c){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=o,l[1].x=n,l[1].y=i,l[1].width=o,l[2].x=r,l[2].y=s,l[2].width=o,l[3].x=t,l[3].y=e,l[3].width=o,this.batchStrokePath(l,o,!1,a,c)},batchFillPath:function(t,e,n){this.renderer.pipelines.set(this);var i=this.calcMatrix;n&&n.multiply(e,i);for(var s,o,a=t.length,c=this.polygonCache,l=this.fillTint.TL,u=this.fillTint.TR,h=this.fillTint.BL,d=0;d<a;++d)o=t[d],c.push(o.x,o.y);a=(s=r(c)).length,this.currentShader.set1i("uRoundPixels",!1);for(var p=0;p<a;p+=3){var f=2*s[p+0],m=2*s[p+1],g=2*s[p+2],v=c[f+0],y=c[f+1],x=c[m+0],b=c[m+1],w=c[g+0],S=c[g+1],_=i.getX(v,y),T=i.getY(v,y),E=i.getX(x,b),C=i.getY(x,b),k=i.getX(w,S),A=i.getY(w,S);this.batchTri(null,_,T,E,C,k,A,0,0,1,1,l,u,h,2)}c.length=0},batchStrokePath:function(t,e,n,i,r){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var s=t.length-1,o=0;o<s;o++){var a=t[o],c=t[o+1];this.batchLine(a.x,a.y,c.x,c.y,a.width/2,c.width/2,e,o,!n&&o===s-1,i,r)}},batchLine:function(t,e,n,i,r,s,o,a,c,l,u){this.renderer.pipelines.set(this);var h=this.calcMatrix;u&&u.multiply(l,h);var d=n-t,p=i-e,f=Math.sqrt(d*d+p*p);if(0!==f){var m=r*(i-e)/f,g=r*(t-n)/f,v=s*(i-e)/f,y=s*(t-n)/f,x=n-v,b=i-y,w=t-m,S=e-g,_=n+v,T=i+y,E=t+m,C=e+g,k=h.getX(x,b),A=h.getY(x,b),I=h.getX(w,S),O=h.getY(w,S),R=h.getX(_,T),N=h.getY(_,T),M=h.getX(E,C),D=h.getY(E,C),P=this.strokeTint,F=P.TL,L=P.TR,B=P.BL,z=P.BR;if(this.currentShader.set1i("uRoundPixels",!1),this.batchQuad(null,M,D,I,O,k,A,R,N,0,0,1,1,F,L,B,z,2),!(o<=2)){var U=this.prevQuad,j=this.firstQuad;a>0&&U[4]?this.batchQuad(null,M,D,I,O,U[0],U[1],U[2],U[3],0,0,1,1,F,L,B,z,2):(j[0]=M,j[1]=D,j[2]=I,j[3]=O,j[4]=1),c&&j[4]?this.batchQuad(null,k,A,R,N,j[0],j[1],j[2],j[3],0,0,1,1,F,L,B,z,2):(U[0]=k,U[1]=A,U[2]=R,U[3]=N,U[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,h.prototype.destroy.call(this),this}});t.exports=d},10919:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(83327),o=n(54677),a=n(44775),c=new i({Extends:a,initialize:function(t){t.vertShader=r(t,"vertShader",o),t.fragShader=r(t,"fragShader",s),t.attributes=r(t,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),a.call(this,t)},onRender:function(t,e){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",e.zoom)},batchPointLight:function(t,e,n,i,r,s,o,a,c,l,u,h){var d=t.color,p=t.intensity,f=t.radius,m=t.attenuation,g=d.r*p,v=d.g*p,y=d.b*p,x=e.alpha*t.alpha;this.shouldFlush(6)&&this.flush(),this.currentBatch||this.setTexture2D(),this.batchLightVert(n,i,u,h,f,m,g,v,y,x),this.batchLightVert(r,s,u,h,f,m,g,v,y,x),this.batchLightVert(o,a,u,h,f,m,g,v,y,x),this.batchLightVert(n,i,u,h,f,m,g,v,y,x),this.batchLightVert(o,a,u,h,f,m,g,v,y,x),this.batchLightVert(c,l,u,h,f,m,g,v,y,x),this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchLightVert:function(t,e,n,i,r,s,o,a,c,l){var u=this.vertexViewF32,h=this.vertexCount*this.currentShader.vertexComponentCount-1;u[++h]=t,u[++h]=e,u[++h]=n,u[++h]=i,u[++h]=r,u[++h]=s,u[++h]=o,u[++h]=a,u[++h]=c,u[++h]=l,this.vertexCount++}});t.exports=c},80486:(t,e,n)=>{var i=n(56694),r=n(65246),s=n(72632),o=n(12569),a=n(99365),c=n(44775),l=new i({Extends:c,initialize:function(t){t.renderTarget=s(t,"renderTarget",1),t.fragShader=s(t,"fragShader",o),t.vertShader=s(t,"vertShader",a),t.attributes=s(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.batchSize=1,t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],c.call(this,t),this.isPostFX=!0,this.gameObject,this.controller,this.colorMatrix=new r,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines)},bootFX:function(){c.prototype.boot.call(this);var t=this.manager.UTILITY_PIPELINE;this.fullFrame1=t.fullFrame1,this.fullFrame2=t.fullFrame2,this.halfFrame1=t.halfFrame1,this.halfFrame2=t.halfFrame2;var e=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",e.width,e.height),this.set1i("uRoundPixels",e.config.roundPixels);for(var n=this.renderTargets,i=0;i<n.length;i++)n[i].autoResize=!0},postBatch:function(t){return this.hasBooted||this.bootFX(),this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(t){this.bindAndDraw(t)},getController:function(t){return void 0!==t?t:this.controller?this.controller:this},copySprite:function(t,e,n){void 0===n&&(n=!1);var i=this.gl;i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture);var r=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,e.framebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.texture,0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.bufferData(i.ARRAY_BUFFER,this.vertexData,i.STATIC_DRAW),i.drawArrays(i.TRIANGLES,0,6),n&&(i.bindTexture(i.TEXTURE_2D,null),i.bindFramebuffer(i.FRAMEBUFFER,r))},copyFrame:function(t,e,n,i,r){this.manager.copyFrame(t,e,n,i,r)},copyToGame:function(t){this.manager.copyToGame(t)},drawFrame:function(t,e,n){this.manager.drawFrame(t,e,n,this.colorMatrix)},blendFrames:function(t,e,n,i,r){this.manager.blendFrames(t,e,n,i,r)},blendFramesAdditive:function(t,e,n,i,r){this.manager.blendFramesAdditive(t,e,n,i,r)},clearFrame:function(t,e){this.manager.clearFrame(t,e)},blitFrame:function(t,e,n,i,r,s){this.manager.blitFrame(t,e,n,i,r,s)},copyFrameRect:function(t,e,n,i,r,s,o,a){this.manager.copyFrameRect(t,e,n,i,r,s,o,a)},bindAndDraw:function(t,e,n,i,r){void 0===n&&(n=!0),void 0===i&&(i=!0);var s=this.gl,o=this.renderer;this.bind(r),this.set1i("uMainSampler",0),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture,0),n&&(i?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT))):(o.popFramebuffer(!1,!1),o.currentFramebuffer||s.viewport(0,0,o.width,o.height)),o.restoreStencilMask(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),e&&(s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,o.currentFramebuffer))},destroy:function(){return this.controller&&this.controller.destroy(),this.gameObject=null,this.controller=null,this.colorMatrix=null,this.fullFrame1=null,this.fullFrame2=null,this.halfFrame1=null,this.halfFrame2=null,c.prototype.destroy.call(this),this}});t.exports=l},87228:(t,e,n)=>{var i=n(95723),r=n(79993),s=n(56694),o=n(37486),a=n(72632),c=n(77310),l=n(12569),u=n(74118),h=n(37410),d=n(85060),p=n(18166),f=n(44775),m=new s({Extends:c,initialize:function(t){var e=a(t,"fragShader",l),n=a(t,"vertShader",p),i=a(t,"drawShader",l),r=[{name:"DrawSprite",fragShader:d,vertShader:p},{name:"CopySprite",fragShader:e,vertShader:n},{name:"DrawGame",fragShader:i,vertShader:p},{name:"ColorMatrix",fragShader:o}],s=a(t,"shaders",[]);t.shaders=r.concat(s),t.vertShader||(t.vertShader=n),t.batchSize=1,c.call(this,t),this.isPreFX=!0,this.customMainSampler=null,this.drawSpriteShader,this.copyShader,this.gameShader,this.colorMatrixShader,this.quadVertexData,this.quadVertexBuffer,this.quadVertexViewF32,this.spriteBounds=new u,this.targetBounds=new u,this.fsTarget,this.tempSprite,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){f.prototype.boot.call(this);var t=this.shaders,e=this.renderer;this.drawSpriteShader=t[0],this.copyShader=t[1],this.gameShader=t[2],this.colorMatrixShader=t[3],this.fsTarget=new h(e,e.width,e.height,1,0,!0,!0),this.renderTargets=this.manager.renderTargets.concat(this.fsTarget);var n=new ArrayBuffer(168);this.quadVertexData=n,this.quadVertexViewF32=new Float32Array(n),this.quadVertexBuffer=e.createVertexBuffer(n,this.gl.STATIC_DRAW),this.onResize(e.width,e.height),this.currentShader=this.copyShader,this.set2f("uResolution",e.width,e.height),this.set1i("uRoundPixels",e.config.roundPixels)},onResize:function(t,e){var n=this.quadVertexViewF32;n[1]=e,n[22]=e,n[14]=t,n[28]=t,n[35]=t,n[36]=e},batchQuad:function(t,e,n,i,s,o,a,c,l,u,h,d,p,f,m,g,v,y,x){var b=Math.min(e,i,o,c),w=Math.min(n,s,a,l),S=Math.max(e,i,o,c)-b,_=Math.max(n,s,a,l)-w,T=this.spriteBounds.setTo(b,w,S,_),E=t?t.preFX.padding:0,C=S+2*E,k=_+2*E,A=Math.abs(Math.max(C,k)),I=this.manager.getRenderTarget(A),O=this.targetBounds.setTo(0,0,I.width,I.height);r(O,T.centerX,T.centerY),this.tempSprite=t;var R=this.gl,N=this.renderer;N.clearStencilMask(),this.setShader(this.drawSpriteShader),this.set1i("uMainSampler",0),this.set2f("uResolution",N.width,N.height),this.set1i("uRoundPixels",N.config.roundPixels),this.flipProjectionMatrix(!0),t&&(this.onDrawSprite(t,I),t.preFX.onFX(this));var M=this.fsTarget;return this.flush(),R.viewport(0,0,N.width,N.height),R.bindFramebuffer(R.FRAMEBUFFER,M.framebuffer),R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_2D,M.texture,0),R.clearColor(0,0,0,0),R.clear(R.COLOR_BUFFER_BIT),this.setTexture2D(x),this.batchVert(e,n,u,h,0,y,f),this.batchVert(i,s,u,p,0,y,g),this.batchVert(o,a,d,p,0,y,v),this.batchVert(e,n,u,h,0,y,f),this.batchVert(o,a,d,p,0,y,v),this.batchVert(c,l,d,h,0,y,m),this.flush(),this.flipProjectionMatrix(!1),R.activeTexture(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,I.texture),R.copyTexSubImage2D(R.TEXTURE_2D,0,0,0,O.x,O.y,O.width,O.height),R.bindFramebuffer(R.FRAMEBUFFER,null),R.bindTexture(R.TEXTURE_2D,null),this.onBatch(t),this.currentShader=this.copyShader,this.onDraw(I,this.manager.getSwapRenderTarget(),this.manager.getAltSwapRenderTarget()),!0},onDrawSprite:function(){},onCopySprite:function(){},copySprite:function(t,e,n,r,s,o,a){void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===s&&(s=!1),void 0===a&&(a=this.copyShader);var c=this.gl,l=this.tempSprite;o&&(a=this.colorMatrixShader),this.currentShader=a;var u=this.setVertexBuffer(this.quadVertexBuffer);a.bind(u,!1);var h=this.renderer;if(this.set1i("uMainSampler",0),this.set2f("uResolution",h.width,h.height),this.set1i("uRoundPixels",h.config.roundPixels),l.preFX.onFXCopy(this),this.onCopySprite(t,e,l),o&&(this.set1fv("uColorMatrix",o.getData()),this.set1f("uAlpha",o.alpha)),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,t.texture),t.height>e.height)c.viewport(0,0,t.width,t.height),this.setTargetUVs(t,e);else{var d=e.height-t.height;c.viewport(0,d,t.width,t.height),this.resetUVs()}if(c.bindFramebuffer(c.FRAMEBUFFER,e.framebuffer),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e.texture,0),n&&(c.clearColor(0,0,0,Number(!r)),c.clear(c.COLOR_BUFFER_BIT)),s){var p=this.renderer.currentBlendMode;this.renderer.setBlendMode(i.ERASE)}c.bufferData(c.ARRAY_BUFFER,this.quadVertexData,c.STATIC_DRAW),c.drawArrays(c.TRIANGLES,0,6),s&&this.renderer.setBlendMode(p),c.bindFramebuffer(c.FRAMEBUFFER,null)},copy:function(t,e){var n=this.gl;this.set1i("uMainSampler",0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.texture),n.viewport(0,0,t.width,t.height),this.setUVs(0,0,0,1,1,1,1,0),n.bindFramebuffer(n.FRAMEBUFFER,e.framebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.texture,0),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.bufferData(n.ARRAY_BUFFER,this.quadVertexData,n.STATIC_DRAW),n.drawArrays(n.TRIANGLES,0,6),n.bindFramebuffer(n.FRAMEBUFFER,null)},blendFrames:function(t,e,n,i,r){this.manager.blendFrames(t,e,n,i,r)},blendFramesAdditive:function(t,e,n,i,r){this.manager.blendFramesAdditive(t,e,n,i,r)},drawToGame:function(t){this.currentShader=null,this.setShader(this.copyShader),this.bindAndDraw(t)},copyToGame:function(t){this.currentShader=null,this.setShader(this.gameShader),this.bindAndDraw(t)},bindAndDraw:function(t){var e=this.gl,n=this.renderer;this.set1i("uMainSampler",0),this.customMainSampler?this.setTexture2D(this.customMainSampler):this.setTexture2D(t.texture);var i=this._tempMatrix1.loadIdentity(),r=this.targetBounds.x,s=this.targetBounds.y,o=r+t.width,a=s+t.height,c=i.getX(r,s),l=i.getX(r,a),u=i.getX(o,a),h=i.getX(o,s),d=i.getY(r,s),p=i.getY(r,a),f=i.getY(o,a),m=i.getY(o,s),g=16777215;this.batchVert(c,d,0,0,0,0,g),this.batchVert(l,p,0,1,0,0,g),this.batchVert(u,f,1,1,0,0,g),this.batchVert(c,d,0,0,0,0,g),this.batchVert(u,f,1,1,0,0,g),this.batchVert(h,m,1,0,0,0,g),n.restoreFramebuffer(!1,!0),n.currentFramebuffer||e.viewport(0,0,n.width,n.height),n.restoreStencilMask(),this.flush(),this.tempSprite=null},onDraw:function(t){this.drawToGame(t)},setUVs:function(t,e,n,i,r,s,o,a){var c=this.quadVertexViewF32;c[2]=t,c[3]=e,c[9]=n,c[10]=i,c[16]=r,c[17]=s,c[23]=t,c[24]=e,c[30]=r,c[31]=s,c[37]=o,c[38]=a},setTargetUVs:function(t,e){var n=e.height/t.height;n=n>.5?.5-(n-.5):.5-n+.5,this.setUVs(0,n,0,1+n,1,1+n,1,n)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)},destroy:function(){return this.gl.deleteBuffer(this.quadVertexBuffer),this.drawSpriteShader=null,this.copyShader=null,this.gameShader=null,this.colorMatrixShader=null,this.quadVertexData=null,this.quadVertexBuffer=null,this.quadVertexViewF32=null,this.fsTarget=null,this.tempSprite=null,c.prototype.destroy.call(this),this}});t.exports=m},21213:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(77310),o=new i({Extends:s,initialize:function(t){t.topology=5,t.batchSize=r(t,"batchSize",256),s.call(this,t)}});t.exports=o},51212:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(77310),o=n(85060),a=n(18166),c=n(44775),l=new i({Extends:s,initialize:function(t){t.fragShader=r(t,"fragShader",o),t.vertShader=r(t,"vertShader",a),t.forceZero=!0,s.call(this,t)},boot:function(){c.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height),this.set1i("uRoundPixels",t.config.roundPixels)}});t.exports=l},60848:(t,e,n)=>{var i=n(2529),r=n(95723),s=n(56694),o=n(65246),a=n(37486),c=n(79060),l=n(72632),u=n(98921),h=n(99365),d=n(44775),p=new s({Extends:d,initialize:function(t){t.renderTarget=l(t,"renderTarget",[{scale:1},{scale:1},{scale:.5},{scale:.5}]),t.vertShader=l(t,"vertShader",h),t.shaders=l(t,"shaders",[{name:"Copy",fragShader:c},{name:"AddBlend",fragShader:i},{name:"LinearBlend",fragShader:u},{name:"ColorMatrix",fragShader:a}]),t.attributes=l(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],t.batchSize=1,d.call(this,t),this.colorMatrix=new o,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){d.prototype.boot.call(this);var t=this.shaders,e=this.renderTargets;this.copyShader=t[0],this.addShader=t[1],this.linearShader=t[2],this.colorMatrixShader=t[3],this.fullFrame1=e[0],this.fullFrame2=e[1],this.halfFrame1=e[2],this.halfFrame2=e[3]},copyFrame:function(t,e,n,i,r){void 0===n&&(n=1),void 0===i&&(i=!0),void 0===r&&(r=!0);var s=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture,0)):s.viewport(0,0,t.width,t.height),i&&(r?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT)),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D,null)},blitFrame:function(t,e,n,i,s,o,a){void 0===n&&(n=1),void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===o&&(o=!1),void 0===a&&(a=!1);var c=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,t.texture),t.height>e.height)c.viewport(0,0,t.width,t.height),this.setTargetUVs(t,e);else{var l=e.height-t.height;c.viewport(0,l,t.width,t.height)}if(c.bindFramebuffer(c.FRAMEBUFFER,e.framebuffer),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e.texture,0),i&&(s?c.clearColor(0,0,0,0):c.clearColor(0,0,0,1),c.clear(c.COLOR_BUFFER_BIT)),o){var u=this.renderer.currentBlendMode;this.renderer.setBlendMode(r.ERASE)}a&&this.flipY(),c.bufferData(c.ARRAY_BUFFER,this.vertexData,c.STATIC_DRAW),c.drawArrays(c.TRIANGLES,0,6),o&&this.renderer.setBlendMode(u),c.bindFramebuffer(c.FRAMEBUFFER,null),c.bindTexture(c.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(t,e,n,i,r,s,o,a){void 0===o&&(o=!0),void 0===a&&(a=!0);var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,t.framebuffer),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,t.texture,0),o&&(a?c.clearColor(0,0,0,0):c.clearColor(0,0,0,1),c.clear(c.COLOR_BUFFER_BIT)),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,e.texture),c.copyTexSubImage2D(c.TEXTURE_2D,0,0,0,n,i,r,s),c.bindFramebuffer(c.FRAMEBUFFER,null),c.bindTexture(c.TEXTURE_2D,null)},copyToGame:function(t){var e=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),e.drawArrays(e.TRIANGLES,0,6)},drawFrame:function(t,e,n,i){void 0===n&&(n=!0),void 0===i&&(i=this.colorMatrix);var r=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",i.getData()),this.set1f("uAlpha",i.alpha),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture,0)):r.viewport(0,0,t.width,t.height),n?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)},blendFrames:function(t,e,n,i,r,s){void 0===i&&(i=1),void 0===r&&(r=!0),void 0===s&&(s=this.linearShader);var o=this.gl;this.setShader(s),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",i),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.texture),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,e.texture),n?(o.bindFramebuffer(o.FRAMEBUFFER,n.framebuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,n.texture,0),o.viewport(0,0,n.width,n.height)):o.viewport(0,0,t.width,t.height),r?o.clearColor(0,0,0,0):o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT),o.bufferData(o.ARRAY_BUFFER,this.vertexData,o.STATIC_DRAW),o.drawArrays(o.TRIANGLES,0,6),o.bindFramebuffer(o.FRAMEBUFFER,null),o.bindTexture(o.TEXTURE_2D,null)},blendFramesAdditive:function(t,e,n,i,r){this.blendFrames(t,e,n,i,r,this.addShader)},clearFrame:function(t,e){void 0===e&&(e=!0);var n=this.gl;n.viewport(0,0,t.width,t.height),n.bindFramebuffer(n.FRAMEBUFFER,t.framebuffer),e?n.clearColor(0,0,0,0):n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT);var i=this.renderer.currentFramebuffer;n.bindFramebuffer(n.FRAMEBUFFER,i)},setUVs:function(t,e,n,i,r,s,o,a){var c=this.vertexViewF32;c[2]=t,c[3]=e,c[6]=n,c[7]=i,c[10]=r,c[11]=s,c[14]=t,c[15]=e,c[18]=r,c[19]=s,c[22]=o,c[23]=a},setTargetUVs:function(t,e){var n=e.height/t.height;n=n>.5?.5-(n-.5):.5-n+.5,this.setUVs(0,n,0,1+n,1,1+n,1,n)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});t.exports=p},65641:t=>{t.exports={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"}},68726:t=>{t.exports="pipelineafterflush"},67186:t=>{t.exports="pipelinebeforeflush"},22709:t=>{t.exports="pipelinebind"},74469:t=>{t.exports="pipelineboot"},93953:t=>{t.exports="pipelinedestroy"},51687:t=>{t.exports="pipelinerebind"},25034:t=>{t.exports="pipelineresize"},18970:(t,e,n)=>{t.exports={AFTER_FLUSH:n(68726),BEFORE_FLUSH:n(67186),BIND:n(22709),BOOT:n(74469),DESTROY:n(93953),REBIND:n(51687),RESIZE:n(25034)}},32469:(t,e,n)=>{var i=n(56694),r=n(87751),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.amount=1},onPreRender:function(t,e){t=this.getController(t),this.set1f("amount",t.amount,e)}});t.exports=o},2134:(t,e,n)=>{var i=n(56694),r=n(88222),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.steps=4,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.strength=1,this.glcolor=[1,1,1]},onPreRender:function(t){t=this.getController(t),this.set1f("strength",t.blurStrength),this.set3fv("color",t.glcolor)},onDraw:function(t){var e=this.getController(),n=this.fullFrame1,i=this.fullFrame2;this.copyFrame(t,i);for(var r=2/t.width*e.offsetX,s=2/t.height*e.offsetY,o=0;o<e.steps;o++)this.set2f("offset",r,0),this.copySprite(t,n),this.set2f("offset",0,s),this.copySprite(n,t);this.blendFrames(i,t,n,e.strength),this.copyToGame(n)}});t.exports=o},63377:(t,e,n)=>{var i=n(56694),r=n(35491),s=n(75568),o=n(44481),a=n(80486),c=new i({Extends:a,initialize:function(t){a.call(this,{game:t,shaders:[{name:"Gaussian5",fragShader:r},{name:"Gaussian9",fragShader:s},{name:"Gaussian13",fragShader:o}]}),this.activeShader=this.shaders[0],this.x=2,this.y=2,this.steps=4,this.strength=1,this.glcolor=[1,1,1]},setQualityLow:function(){return this.activeShader=this.shaders[0],this},setQualityMedium:function(){return this.activeShader=this.shaders[1],this},setQualityHigh:function(){return this.activeShader=this.shaders[2],this},onDraw:function(t){var e=this.getController(),n=this.gl,i=this.fullFrame1,r=n.getParameter(n.FRAMEBUFFER_BINDING);this.bind(this.shaders[e.quality]),n.activeTexture(n.TEXTURE0),n.viewport(0,0,t.width,t.height),this.set1i("uMainSampler",0),this.set2f("resolution",t.width,t.height),this.set1f("strength",e.strength),this.set3fv("color",e.glcolor);for(var s=0;s<e.steps;s++)this.set2f("offset",e.x,0),this.copySprite(t,i),this.set2f("offset",0,e.y),this.copySprite(i,t);n.bindFramebuffer(n.FRAMEBUFFER,r),n.bindTexture(n.TEXTURE_2D,null),this.copyToGame(t)}});t.exports=c},49745:(t,e,n)=>{var i=n(56694),r=n(69960),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.isTiltShift=!1,this.strength=1,this.blurX=1,this.blurY=1,this.radius=.5,this.amount=1,this.contrast=.2},onPreRender:function(t,e,n,i){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("amount",t.amount,e),this.set1f("contrast",t.contrast,e),this.set1f("strength",t.strength,e),this.set2f("blur",t.blurX,t.blurY,e),this.setBoolean("isTiltShift",t.isTiltShift,e),n&&i&&this.set2f("resolution",n,i,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});t.exports=o},4323:(t,e,n)=>{var i=n(56694),r=n(33754),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.scale=1,this.feather=.005,this.thickness=8,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4]},onPreRender:function(t,e,n,i){t=this.getController(t),this.set1f("scale",t.scale,e),this.set1f("feather",t.feather,e),this.set1f("thickness",t.thickness,e),this.set3fv("color",t.glcolor,e),this.set4fv("backgroundColor",t.glcolor2,e),n&&i&&this.set2f("resolution",n,i,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});t.exports=o},92066:(t,e,n)=>{var i=n(56694),r=n(80486),s=new i({Extends:r,initialize:function(t){r.call(this,{game:t})},onDraw:function(t){var e=this.fullFrame1;this.controller?this.manager.drawFrame(t,e,!0,this.controller):this.drawFrame(t,e),this.copyToGame(e)}});t.exports=s},89581:(t,e,n)=>{var i=n(56694),r=n(35668),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.x=.005,this.y=.005,this.glTexture},onBoot:function(){this.setTexture("__WHITE")},setTexture:function(t){var e=this.game.textures.getFrame(t);e&&(this.glTexture=e.glTexture)},onDraw:function(t){var e=this.getController(),n=this.fullFrame1;this.bind(),this.set1i("uMainSampler",0),this.set1i("uDisplacementSampler",1),this.set2f("amount",e.x,e.y),this.bindTexture(e.glTexture,1),this.copySprite(t,n),this.copyToGame(n)}});t.exports=o},55084:(t,e,n)=>{var i=n(56694),r=n(72632),s=n(69675),o=n(80486),a=n(75512),c=new i({Extends:o,initialize:function(t,e){var n=r(e,"quality",.1),i=r(e,"distance",10);o.call(this,{game:t,fragShader:a.setGlowQuality(s,t,n,i)}),this.outerStrength=4,this.innerStrength=0,this.knockout=!1,this.glcolor=[1,1,1,1]},onPreRender:function(t,e,n,i){t=this.getController(t),this.set1f("outerStrength",t.outerStrength,e),this.set1f("innerStrength",t.innerStrength,e),this.set4fv("glowColor",t.glcolor,e),this.setBoolean("knockout",t.knockout,e),n&&i&&this.set2f("resolution",n,i,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});t.exports=c},41653:(t,e,n)=>{var i=n(56694),r=n(90993),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.alpha=.2,this.size=0,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0]},onPreRender:function(t,e){t=this.getController(t),this.set1f("alpha",t.alpha,e),this.set1i("size",t.size,e),this.set3fv("color1",t.glcolor1,e),this.set3fv("color2",t.glcolor2,e),this.set2f("positionFrom",t.fromX,t.fromY,e),this.set2f("positionTo",t.toX,t.toY,e)}});t.exports=o},73416:(t,e,n)=>{var i=n(56694),r=n(37945),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.amount=1},onPreRender:function(t,e,n,i){t=this.getController(t),this.set1f("amount",t.amount,e),n&&i&&this.set2f("resolution",n,i,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});t.exports=o},58049:(t,e,n)=>{var i=n(56694),r=n(85718),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.x=0,this.y=0,this.decay=.1,this.power=1,this.glcolor=[0,0,0,1],this.samples=6,this.intensity=1},onPreRender:function(t,e){var n=(t=this.getController(t)).samples;this.set1i("samples",n,e),this.set1f("intensity",t.intensity,e),this.set1f("decay",t.decay,e),this.set1f("power",t.power/n,e),this.set2f("lightPosition",t.x,t.y,e),this.set4fv("color",t.glcolor,e)}});t.exports=o},18026:(t,e,n)=>{var i=n(56694),r=n(13740),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1},onPreRender:function(t,e,n,i){t=this.getController(t),this.setTime("time",e),this.set1f("speed",t.speed,e),this.set1f("lineWidth",t.lineWidth,e),this.set1f("gradient",t.gradient,e),this.setBoolean("reveal",t.reveal,e),n&&i&&this.set2f("resolution",n,i,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});t.exports=o},72381:(t,e,n)=>{var i=n(56694),r=n(80617),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5},onPreRender:function(t,e){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("strength",t.strength,e),this.set2f("position",t.x,t.y,e)}});t.exports=o},80542:(t,e,n)=>{var i=n(56694),r=n(62879),s=n(80486),o=new i({Extends:s,initialize:function(t){s.call(this,{game:t,fragShader:r}),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1},onPreRender:function(t,e){var n=(t=this.getController(t)).progress,i=t.wipeWidth,r=t.direction,s=t.axis;this.set4f("config",n,i,r,s,e),this.setBoolean("reveal",t.reveal,e)}});t.exports=o},58136:(t,e,n)=>{var i={Barrel:n(32469),Bloom:n(2134),Blur:n(63377),Bokeh:n(49745),Circle:n(4323),ColorMatrix:n(92066),Displacement:n(89581),Glow:n(55084),Gradient:n(41653),Pixelate:n(73416),Shadow:n(58049),Shine:n(18026),Vignette:n(72381),Wipe:n(80542)};t.exports=i},62253:(t,e,n)=>{var i=n(65641),r=n(98611),s={FX:n(58136),BitmapMaskPipeline:n(5583),Events:n(18970),FXPipeline:n(81828),LightPipeline:n(66901),MobilePipeline:n(71264),MultiPipeline:n(77310),PointLightPipeline:n(10919),PostFXPipeline:n(80486),PreFXPipeline:n(87228),RopePipeline:n(21213),SinglePipeline:n(51212),UtilityPipeline:n(60848)};s=r(!1,s,i),t.exports=s},2529:t=>{t.exports=["#define SHADER_NAME PHASER_ADD_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = frame1 + frame2 * uStrength;","}"].join("\n")},91679:t=>{t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join("\n")},89053:t=>{t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join("\n")},37486:t=>{t.exports=["#define SHADER_NAME PHASER_COLORMATRIX_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","varying vec2 outTexCoord;","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","        return;","    }","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","    vec4 result;","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","    rgb *= result.a;","    gl_FragColor = vec4(rgb, result.a);","}"].join("\n")},79060:t=>{t.exports=["#define SHADER_NAME PHASER_COPY_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uBrightness;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}"].join("\n")},87751:t=>{t.exports=["#define SHADER_NAME BARREL_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float amount;","varying vec2 outTexCoord;","vec2 Distort(vec2 p)","{","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, amount);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * (p + 1.0);","}","void main()","{","    vec2 xy = 2.0 * outTexCoord - 1.0;","    vec2 texCoord = outTexCoord;","    if (length(xy) < 1.0)","    {","        texCoord = Distort(xy);","    }","    gl_FragColor = texture2D(uMainSampler, texCoord);","}"].join("\n")},88222:t=>{t.exports=["#define SHADER_NAME BLOOM_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;","    gl_FragColor = (sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913) * vec4(color, 1);","}"].join("\n")},44481:t=>{t.exports=["#define SHADER_NAME BLUR_HIGH_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.411764705882353) * offset * strength;","    vec2 off2 = vec2(3.2941176470588234) * offset * strength;","    vec2 off3 = vec2(5.176470588235294) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.1964825501511404;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv + (off3 / resolution)) * 0.010381362401148057;","    col += texture2D(uMainSampler, uv - (off3 / resolution)) * 0.010381362401148057;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n")},35491:t=>{t.exports=["#define SHADER_NAME BLUR_LOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 offset = vec2(1.333) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.29411764705882354;","    col += texture2D(uMainSampler, uv + (offset / resolution)) * 0.35294117647058826;","    col += texture2D(uMainSampler, uv - (offset / resolution)) * 0.35294117647058826;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n")},75568:t=>{t.exports=["#define SHADER_NAME BLUR_MED_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.3846153846) * offset * strength;","    vec2 off2 = vec2(3.2307692308) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.2270270270;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.0702702703;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.0702702703;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n")},69960:t=>{t.exports=["#define SHADER_NAME BOKEH_FS","precision mediump float;","#define ITERATIONS 100.0","#define ONEOVER_ITR 1.0 / ITERATIONS","#define PI 3.141596","#define GOLDEN_ANGLE 2.39996323","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float radius;","uniform float amount;","uniform float contrast;","uniform bool isTiltShift;","uniform float strength;","uniform vec2 blur;","varying vec2 outTexCoord;","vec2 Sample (in float theta, inout float r)","{","    r += 1.0 / r;","    return (r - 1.0) * vec2(cos(theta), sin(theta)) * 0.06;","}","vec3 Bokeh (sampler2D tex, vec2 uv, float radius)","{","    vec3 acc = vec3(0.0);","    vec3 div = vec3(0.0);","    vec2 pixel = vec2(resolution.y / resolution.x, 1.0) * radius * .025;","    float r = 1.0;","    for (float j = 0.0; j < GOLDEN_ANGLE * ITERATIONS; j += GOLDEN_ANGLE)","    {","        vec3 col = texture2D(tex, uv + pixel * Sample(j, r)).xyz;","        col = contrast > 0.0 ? col * col * (1.0 + contrast) : col;","        vec3 bokeh = vec3(0.5) + pow(col, vec3(10.0)) * amount;","        acc += col * bokeh;","        div += bokeh;","    }","    return acc / div;","}","void main ()","{","    float shift = 1.0;","    if (isTiltShift)","    {","        vec2 uv = vec2(gl_FragCoord.xy / resolution + vec2(-0.5, -0.5)) * 2.0;","        float centerStrength = 1.0;","        shift = length(uv * blur * strength) * centerStrength;","    }","    gl_FragColor = vec4(Bokeh(uMainSampler, outTexCoord * vec2(1.0, 1.0), radius * shift), 0.0);","}"].join("\n")},33754:t=>{t.exports=["#define SHADER_NAME CIRCLE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec3 color;","uniform vec4 backgroundColor;","uniform float thickness;","uniform float scale;","uniform float feather;","varying vec2 outTexCoord;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 position = (gl_FragCoord.xy / resolution.xy) * 2.0 - 1.0;","    float aspectRatio = resolution.x / resolution.y;","    position.x *= aspectRatio;","    float grad = length(position);","    float outer = aspectRatio;","    float inner = outer - (thickness * 2.0 / resolution.y);","    if (aspectRatio >= 1.0)","    {","        float f = 2.0 + (resolution.y / resolution.x);","        outer = 1.0;","        inner = 1.0 - (thickness * f / resolution.x);","    }","    outer *= scale;","    inner *= scale;","    float circle = smoothstep(outer, outer - 0.01, grad);","    float ring = circle - smoothstep(inner, inner - feather, grad);","    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);","    texture = (texture * (circle - ring));","    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);","}"].join("\n")},35668:t=>{t.exports=["#define SHADER_NAME DISPLACEMENT_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform sampler2D uDisplacementSampler;","uniform vec2 amount;","varying vec2 outTexCoord;","void main ()","{","    vec2 disp = (-vec2(0.5, 0.5) + texture2D(uDisplacementSampler, outTexCoord).rr) * amount;","    gl_FragColor = texture2D(uMainSampler, outTexCoord + disp).rgba;","}"].join("\n")},69675:t=>{t.exports=["#define SHADER_NAME GLOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform float outerStrength;","uniform float innerStrength;","uniform vec2 resolution;","uniform vec4 glowColor;","uniform bool knockout;","const float PI = 3.14159265358979323846264;","const float DIST = __DIST__;","const float SIZE = min(__SIZE__, PI * 2.0);","const float STEP = ceil(PI * 2.0 / SIZE);","const float MAX_ALPHA = STEP * DIST * (DIST + 1.0) / 2.0;","void main ()","{","    vec2 px = vec2(1.0 / resolution.x, 1.0 / resolution.y);","    float totalAlpha = 0.0;","    vec2 direction;","    vec2 displaced;","    vec4 color;","    for (float angle = 0.0; angle < PI * 2.0; angle += SIZE)","    {","        direction = vec2(cos(angle), sin(angle)) * px;","        for (float curDistance = 0.0; curDistance < DIST; curDistance++)","        {","            displaced = outTexCoord + direction * (curDistance + 1.0);","            color = texture2D(uMainSampler, displaced);","            totalAlpha += (DIST - curDistance) * color.a;","        }","    }","    color = texture2D(uMainSampler, outTexCoord);","    float alphaRatio = (totalAlpha / MAX_ALPHA);","    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * color.a;","    float innerGlowStrength = min(1.0, innerGlowAlpha);","    vec4 innerColor = mix(color, glowColor, innerGlowStrength);","    float outerGlowAlpha = alphaRatio * outerStrength * (1.0 - color.a);","    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);","    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;","    if (knockout)","    {","        float resultAlpha = outerGlowAlpha + innerGlowAlpha;","        gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);","    }","    else","    {","        gl_FragColor = innerColor + outerGlowColor;","    }","}"].join("\n")},90993:t=>{t.exports=["#define SHADER_NAME GRADIENT_FS","#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))","#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))","#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 positionFrom;","uniform vec2 positionTo;","uniform vec3 color1;","uniform vec3 color2;","uniform float alpha;","uniform int size;","varying vec2 outTexCoord;","float gradientNoise(in vec2 uv)","{","    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(magic.z * fract(dot(uv, magic.xy)));","}","float stepped (in float s, in float scale, in int steps)","{","    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;","}","void main ()","{","    vec2 a = positionFrom;","    vec2 b = positionTo;","    vec2 ba = b - a;","    float d = dot(outTexCoord - a, ba) / dot(ba, ba);","    float t = size > 0 ? stepped(d, 1.0, size) : d;","    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));","    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);","    color = LINEAR_TO_SRGB(color);","    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;","}"].join("\n")},37945:t=>{t.exports=["#define SHADER_NAME PIXELATE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float amount;","varying vec2 outTexCoord;","void main ()","{","    float pixelSize = floor(2.0 + amount);","    vec2 center = pixelSize * floor(outTexCoord * resolution / pixelSize) + pixelSize * vec2(0.5, 0.5);","    vec2 corner1 = center + pixelSize * vec2(-0.5, -0.5);","    vec2 corner2 = center + pixelSize * vec2(+0.5, -0.5);","    vec2 corner3 = center + pixelSize * vec2(+0.5, +0.5);","    vec2 corner4 = center + pixelSize * vec2(-0.5, +0.5);","    vec4 pixel = 0.4 * texture2D(uMainSampler, center / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner1 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner2 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner3 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner4 / resolution);","    gl_FragColor = pixel;","}"].join("\n")},85718:t=>{t.exports=["#define SHADER_NAME SHADOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform vec2 lightPosition;","uniform vec4 color;","uniform float decay;","uniform float power;","uniform float intensity;","uniform int samples;","const int MAX = 12;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 pc = (lightPosition - outTexCoord) * intensity;","    float shadow = 0.0;","    float limit = max(float(MAX), float(samples));","    for (int i = 0; i < MAX; ++i)","    {","        if (i >= samples)","        {","            break;","        }","        shadow += texture2D(uMainSampler, outTexCoord + float(i) * decay / limit * pc).a * power;","    }","    float mask = 1.0 - texture.a;","    gl_FragColor = mix(texture, color, shadow * mask);","}"].join("\n")},13740:t=>{t.exports=["#define SHADER_NAME SHINE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform bool reveal;","uniform float speed;","uniform float time;","uniform float lineWidth;","uniform float gradient;","varying vec2 outTexCoord;","void main ()","{","\tvec2 uv = gl_FragCoord.xy / resolution.xy;","    vec4 tex = texture2D(uMainSampler, outTexCoord);","    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);","    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);","    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;","    float y = uv.x * gradient;","    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);","    gl_FragColor = (((s * col1) + (s * col2)) * tex);","    if (!reveal)","    {","        gl_FragColor += tex;","    }","}"].join("\n")},80617:t=>{t.exports=["#define SHADER_NAME VIGNETTE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float radius;","uniform float strength;","uniform vec2 position;","varying vec2 outTexCoord;","void main ()","{","    vec4 col = vec4(1.0);","    float d = length(outTexCoord - position);","    if (d <= radius)","    {","        float g = d / radius;","        g = sin(g * 3.14 * strength);","    \tcol = vec4(g * g * g);","    }","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = texture * (1.0 - col);","}"].join("\n")},62879:t=>{t.exports=["#define SHADER_NAME WIPE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec4 config;","uniform bool reveal;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 color0;","    vec4 color1;","    if (reveal)","    {","        color0 = vec4(0);","        color1 = texture2D(uMainSampler, uv);","    }","    else","    {","        color0 = texture2D(uMainSampler, uv);","        color1 = vec4(0);","    }","    float distance = config.x;","    float width = config.y;","    float direction = config.z;","    float axis = uv.x;","    if (config.w == 1.0)","    {","        axis = uv.y;","    }","    float adjust = mix(width, -width, distance);","    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);","    gl_FragColor = mix(color1, color0, value);","}"].join("\n")},65045:t=>{t.exports=["#define SHADER_NAME PHASER_LIGHT_FS","precision mediump float;","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","const int kMaxLights = %LIGHT_COUNT%;","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","uniform int uLightCount;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","    for (int index = 0; index < kMaxLights; ++index)","    {","        if (index < uLightCount)","        {","            Light light = uLights[index];","            vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","            vec3 lightNormal = normalize(lightDir);","            float distToSurf = length(lightDir) * uCamera.w;","            float diffuseFactor = max(dot(normal, lightNormal), 0.0);","            float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","            float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","            vec3 diffuse = light.color * diffuseFactor;","            finalColor += (attenuation * diffuse) * light.intensity;","        }","    }","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}"].join("\n")},98921:t=>{t.exports=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}"].join("\n")},25005:t=>{t.exports=["#define SHADER_NAME PHASER_MESH_FS","precision mediump float;","uniform vec3 uLightPosition;","uniform vec3 uLightAmbient;","uniform vec3 uLightDiffuse;","uniform vec3 uLightSpecular;","uniform vec3 uFogColor;","uniform float uFogNear;","uniform float uFogFar;","uniform vec3 uMaterialAmbient;","uniform vec3 uMaterialDiffuse;","uniform vec3 uMaterialSpecular;","uniform float uMaterialShine;","uniform vec3 uCameraPosition;","uniform sampler2D uTexture;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main (void)","{","    vec4 color = texture2D(uTexture, vTextureCoord);","    vec3 ambient = uLightAmbient * uMaterialAmbient;","    vec3 norm = normalize(vNormal);","    vec3 lightDir = normalize(uLightPosition - vPosition);","    float diff = max(dot(norm, lightDir), 0.0);","    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);","    vec3 viewDir = normalize(uCameraPosition - vPosition);","    vec3 reflectDir = reflect(-lightDir, norm);","    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);","    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);","    vec3 result = (ambient + diffuse + specular) * color.rgb;","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep(uFogNear, uFogFar, depth);","    gl_FragColor.rgb = mix(result.rgb, uFogColor, fogFactor);","    gl_FragColor.a = color.a;","}"].join("\n")},94914:t=>{t.exports=["#define SHADER_NAME PHASER_MESH_VS","precision mediump float;","attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uViewProjectionMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uNormalMatrix;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main ()","{","    vTextureCoord = aTextureCoord;","    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));","    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));","    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);","}"].join("\n")},11263:t=>{t.exports=["#define SHADER_NAME PHASER_MOBILE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")},51852:t=>{t.exports=["#define SHADER_NAME PHASER_MOBILE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform int uRoundPixels;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    if (uRoundPixels == 1)","    {","        gl_Position.xy = floor(((gl_Position.xy + 1.0) * 0.5 * uResolution) + 0.5) / uResolution * 2.0 - 1.0;","    }","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")},53787:t=>{t.exports=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")},15968:t=>{t.exports=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform int uRoundPixels;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    if (uRoundPixels == 1)","    {","        gl_Position.xy = floor(((gl_Position.xy + 1.0) * 0.5 * uResolution) + 0.5) / uResolution * 2.0 - 1.0;","    }","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")},83327:t=>{t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_FS","precision mediump float;","uniform vec2 uResolution;","uniform float uCameraZoom;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","    float distToSurf = length(center - gl_FragCoord.xy);","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}"].join("\n")},54677:t=>{t.exports=["#define SHADER_NAME PHASER_POINTLIGHT_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}"].join("\n")},12569:t=>{t.exports=["#define SHADER_NAME PHASER_POSTFX_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}"].join("\n")},99365:t=>{t.exports=["#define SHADER_NAME PHASER_QUAD_VS","precision mediump float;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","varying vec2 outFragCoord;","varying vec2 outTexCoord;","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","    gl_Position = vec4(inPosition, 0, 1);","}"].join("\n")},85060:t=>{t.exports=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")},18166:t=>{t.exports=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform int uRoundPixels;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    if (uRoundPixels == 1)","    {","        gl_Position.xy = floor(((gl_Position.xy + 1.0) * 0.5 * uResolution) + 0.5) / uResolution * 2.0 - 1.0;","    }","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")},92462:(t,e,n)=>{t.exports={AddBlendFrag:n(2529),BitmapMaskFrag:n(91679),BitmapMaskVert:n(89053),ColorMatrixFrag:n(37486),CopyFrag:n(79060),FXBarrelFrag:n(87751),FXBloomFrag:n(88222),FXBlurHighFrag:n(44481),FXBlurLowFrag:n(35491),FXBlurMedFrag:n(75568),FXBokehFrag:n(69960),FXCircleFrag:n(33754),FXDisplacementFrag:n(35668),FXGlowFrag:n(69675),FXGradientFrag:n(90993),FXPixelateFrag:n(37945),FXShadowFrag:n(85718),FXShineFrag:n(13740),FXVignetteFrag:n(80617),FXWipeFrag:n(62879),LightFrag:n(65045),LinearBlendFrag:n(98921),MeshFrag:n(25005),MeshVert:n(94914),MobileFrag:n(11263),MobileVert:n(51852),MultiFrag:n(53787),MultiVert:n(15968),PointLightFrag:n(83327),PointLightVert:n(54677),PostFXFrag:n(12569),QuadVert:n(99365),SingleFrag:n(85060),SingleVert:n(18166)}},756:(t,e,n)=>{var i=n(55301),r=n(56694),s=n(6659),o=n(40444),a=n(97081),c=n(74181),l=n(2893),u=n(9229),h=n(72283),d=n(74118),p=n(90881),f=n(84314),m=n(93736),g=n(47751),v=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.canvas,this.canvasBounds=new d,this.parent=null,this.parentIsWindow=!1,this.parentSize=new p,this.gameSize=new p,this.baseSize=new p,this.displaySize=new p,this.scaleMode=i.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new m(1,1),this.autoRound=!1,this.autoCenter=i.CENTER.NO_CENTER,this.orientation=i.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:h,windowResize:h,fullScreenChange:h,fullScreenError:h}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(a.BOOT,this.boot,this)},boot:function(){var t=this.game;this.canvas=t.canvas,this.fullscreen=t.device.fullscreen,this.scaleMode!==i.SCALE_MODE.RESIZE&&this.displaySize.setAspectMode(this.scaleMode),this.scaleMode===i.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),t.events.on(a.PRE_STEP,this.step,this),t.events.once(a.READY,this.refresh,this),t.events.once(a.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(t){this.getParent(t),this.getParentBounds();var e=t.width,n=t.height,r=t.scaleMode,s=t.zoom,o=t.autoRound;if("string"===typeof e)if("%"!==e.substr(-1))e=parseInt(e,10);else{var a=this.parentSize.width;0===a&&(a=window.innerWidth);var c=parseInt(e,10)/100;e=Math.floor(a*c)}if("string"===typeof n)if("%"!==n.substr(-1))n=parseInt(n,10);else{var l=this.parentSize.height;0===l&&(l=window.innerHeight);var h=parseInt(n,10)/100;n=Math.floor(l*h)}this.scaleMode=r,this.autoRound=o,this.autoCenter=t.autoCenter,this.resizeInterval=t.resizeInterval,o&&(e=Math.floor(e),n=Math.floor(n)),this.gameSize.setSize(e,n),s===i.ZOOM.MAX_ZOOM&&(s=this.getMaxZoom()),this.zoom=s,1!==s&&(this._resetZoom=!0),this.baseSize.setSize(e,n),o&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),t.minWidth>0&&this.displaySize.setMin(t.minWidth*s,t.minHeight*s),t.maxWidth>0&&this.displaySize.setMax(t.maxWidth*s,t.maxHeight*s),this.displaySize.setSize(e,n),this.orientation=u(e,n)},getParent:function(t){var e=t.parent;if(null!==e){if(this.parent=l(e),this.parentIsWindow=this.parent===document.body,t.expandParent&&t.scaleMode!==i.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}t.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=l(t.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=c(!0));var n=e.width,i=e.height;if(t.width!==n||t.height!==i)return t.setSize(n,i),!0;if(this.canvas){var r=this.canvasBounds,s=this.canvas.getBoundingClientRect();if(s.x!==r.x||s.y!==r.y)return!0}return!1},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e.call(screen,t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var n=this.autoRound;n&&(t=Math.floor(t),e=Math.floor(e));var i=this.width,r=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(i,r)},resize:function(t,e){var n=this.zoom,i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var r=this.width,s=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*n,e*n),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var o=this.canvas.style,a=t*n,c=e*n;return i&&(a=Math.floor(a),c=Math.floor(c)),a===t&&c===e||(o.width=a+"px",o.height=c+"px"),this.refresh(r,s)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var n=this.game.domContainer;if(n){this.baseSize.setCSS(n);var i=this.canvas.style,r=n.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=i.marginLeft,r.marginTop=i.marginTop}return this.emit(o.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=u(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(o.ORIENTATION_CHANGE,t))}},updateScale:function(){var t,e,n=this.canvas.style,r=this.gameSize.width,s=this.gameSize.height,o=this.zoom,a=this.autoRound;this.scaleMode===i.SCALE_MODE.NONE?(this.displaySize.setSize(r*o,s*o),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),this._resetZoom&&(n.width=t+"px",n.height=e+"px",this._resetZoom=!1)):this.scaleMode===i.SCALE_MODE.RESIZE?(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),this.canvas.width=t,this.canvas.height=e):(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),t=this.displaySize.width,e=this.displaySize.height,a&&(t=Math.floor(t),e=Math.floor(e)),n.width=t+"px",n.height=e+"px"),this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=f(this.parentSize.width,this.gameSize.width,0,!0),e=f(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var t=this.autoCenter;if(t!==i.CENTER.NO_CENTER){var e=this.canvas,n=e.style,r=e.getBoundingClientRect(),s=r.width,o=r.height,a=Math.floor((this.parentSize.width-s)/2),c=Math.floor((this.parentSize.height-o)/2);t===i.CENTER.CENTER_HORIZONTALLY?c=0:t===i.CENTER.CENTER_VERTICALLY&&(a=0),n.marginLeft=a+"px",n.marginTop=c+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var n=this.getFullscreenTarget();e.keyboard?n[e.request](Element.ALLOW_KEYBOARD_INPUT):n[e.request](t)}}else this.emit(o.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(o.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(o.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}return this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(o.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget(),this.getParentBounds(),this.emit(o.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.domlisteners;e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0},e.windowResize=function(){t.updateBounds(),t.dirty=!0},window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available&&(e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)},["webkit","moz",""].forEach((function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)})),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1))},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():this.stopFullscreen()},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(t,e){t instanceof g||(e=t,t=void 0),void 0===e&&(e=new d);var n,i,r=this.baseSize,s=this.parentSize,o=this.canvasBounds,a=this.displayScale,c=o.x>=0?0:-o.x*a.x,l=o.y>=0?0:-o.y*a.y;return n=s.width>=o.width?r.width:r.width-(o.width-s.width)*a.x,i=s.height>=o.height?r.height:r.height-(o.height-s.height)*a.y,e.setTo(c,l,n,i),t&&(e.width/=t.zoomX,e.height/=t.zoomY,e.centerX=t.centerX+t.scrollX,e.centerY=t.centerY+t.scrollY),e},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.domlisteners;window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1),["webkit","moz",""].forEach((function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)})),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===i.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===i.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});t.exports=v},35098:t=>{t.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}},53539:t=>{t.exports={LANDSCAPE:"landscape-primary",PORTRAIT:"portrait-primary"}},12637:t=>{t.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5}},10217:t=>{t.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}},55301:(t,e,n)=>{var i={CENTER:n(35098),ORIENTATION:n(53539),SCALE_MODE:n(12637),ZOOM:n(10217)};t.exports=i},82085:t=>{t.exports="enterfullscreen"},11826:t=>{t.exports="fullscreenfailed"},56691:t=>{t.exports="fullscreenunsupported"},34739:t=>{t.exports="leavefullscreen"},26681:t=>{t.exports="orientationchange"},11428:t=>{t.exports="resize"},40444:(t,e,n)=>{t.exports={ENTER_FULLSCREEN:n(82085),FULLSCREEN_FAILED:n(11826),FULLSCREEN_UNSUPPORTED:n(56691),LEAVE_FULLSCREEN:n(34739),ORIENTATION_CHANGE:n(26681),RESIZE:n(11428)}},86754:(t,e,n)=>{var i=n(98611),r=n(55301),s={Center:n(35098),Events:n(40444),Orientation:n(53539),ScaleManager:n(756),ScaleModes:n(12637),Zoom:n(10217)};s=i(!1,s,r.CENTER),s=i(!1,s,r.ORIENTATION),s=i(!1,s,r.SCALE_MODE),s=i(!1,s,r.ZOOM),t.exports=s},47736:(t,e,n)=>{var i=n(72632),r=n(40587);t.exports=function(t){var e=t.game.config.defaultPhysicsSystem,n=i(t.settings,"physics",!1);if(e||n){var s=[];if(e&&s.push(r(e+"Physics")),n)for(var o in n)o=r(o.concat("Physics")),-1===s.indexOf(o)&&s.push(o);return s}}},91088:(t,e,n)=>{var i=n(72632);t.exports=function(t){var e=t.plugins.getDefaultScenePlugins(),n=i(t.settings,"plugins",!1);return Array.isArray(n)?n:e||[]}},90415:t=>{t.exports={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"}},87157:(t,e,n)=>{var i=n(56694),r=n(63946),s=new i({initialize:function(t){this.sys=new r(this,t),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.scale,this.plugins,this.renderer},update:function(){}});t.exports=s},13553:(t,e,n)=>{var i=n(56694),r=n(92980),s=n(7599),o=n(97081),a=n(10850),c=n(683),l=n(72283),u=n(87157),h=n(63946),d=new i({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)this._pending.push({key:"default",scene:e[n],autoStart:0===n,data:{}})}t.events.once(o.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,n,i;for(this.systemScene=this.createSceneFromInstance("__SYSTEM",new u),this.game.events.emit(o.SYSTEM_READY,this.systemScene,this),t=0;t<this._pending.length;t++){var r;n=(e=this._pending[t]).key,(i=e.scene)instanceof u?r=this.createSceneFromInstance(n,i):"object"===typeof i?r=this.createSceneFromObject(n,i):"function"===typeof i&&(r=this.createSceneFromFunction(n,i)),n=r.sys.settings.key,this.keys[n]=r,this.scenes.push(r),this._data[n]&&(r.sys.settings.data=this._data[n].data,this._data[n].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(n)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(0!==t||0!==e){var n,i;if(t){for(n=0;n<t;n++)i=this._pending[n],this.add(i.key,i.scene,i.autoStart,i.data);for(n=0;n<this._start.length;n++)i=this._start[n],this.start(i);this._start.length=0,this._pending.length=0}for(n=0;n<this._queue.length;n++)this[(i=this._queue[n]).op](i.keyA,i.keyB);this._queue.length=0}},add:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:n,data:i}),this.isBooted||(this._data[t]={data:i}),null):(t=this.getKey(t,e),e instanceof u?r=this.createSceneFromInstance(t,e):"object"===typeof e?(e.key=t,r=this.createSceneFromObject(t,e)):"function"===typeof e&&(r=this.createSceneFromFunction(t,e)),r.sys.settings.data=i,t=r.sys.settings.key,this.keys[t]=r,this.scenes.push(r),(n||r.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),r);var r},remove:function(t){if(this.isProcessing)this._queue.push({op:"remove",keyA:t,keyB:null});else{var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var n=this.scenes.indexOf(e),i=e.sys.settings.key;n>-1&&(delete this.keys[i],this.scenes.splice(n,1),this._start.indexOf(i)>-1&&(n=this._start.indexOf(i),this._start.splice(n,1)),e.sys.destroy())}return this},bootScene:function(t){var e,n=t.sys,i=n.settings;n.sceneUpdate=l,t.init&&(t.init.call(t,i.data),i.status=r.INIT,i.isTransition&&n.events.emit(s.TRANSITION_INIT,i.transitionFrom,i.transitionDuration)),n.load&&(e=n.load).reset(),e&&t.preload?(t.preload.call(t),i.status=r.LOADING,e.once(c.COMPLETE,this.loadComplete,this),e.start()):this.create(t)},loadComplete:function(t){this.game.sound&&this.game.sound.onBlurPausedSounds&&this.game.sound.unlock(),this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,e){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var i=this.scenes[n].sys;i.settings.status>r.START&&i.settings.status<=r.RUNNING&&i.step(t,e),i.scenePlugin._target&&i.scenePlugin.step(t,e)}},render:function(t){for(var e=0;e<this.scenes.length;e++){var n=this.scenes[e].sys;n.settings.visible&&n.settings.status>=r.LOADING&&n.settings.status<r.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var e=t.sys,n=e.settings;t.create&&(n.status=r.CREATING,t.create.call(t,n.data),n.status===r.DESTROYED)||(n.isTransition&&e.events.emit(s.TRANSITION_START,n.transitionFrom,n.transitionDuration),t.update&&(e.sceneUpdate=t.update),n.status=r.RUNNING,e.events.emit(s.CREATE,t))},createSceneFromFunction:function(t,e){var n=new e;if(n instanceof u){var i=n.sys.settings.key;if(""!==i&&(t=i),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return this.createSceneFromInstance(t,n)}return n.sys=new h(n),n.sys.settings.key=t,n.sys.init(this.game),n},createSceneFromInstance:function(t,e){return""===e.sys.settings.key&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var n=new u(e),i=n.sys.settings.key;""!==i?t=i:n.sys.settings.key=t,n.sys.init(this.game);for(var r=["init","preload","create","update","render"],s=0;s<r.length;s++){var o=a(e,r[s],null);o&&(n[r[s]]=o)}if(e.hasOwnProperty("extend"))for(var c in e.extend)if(e.extend.hasOwnProperty(c)){var l=e.extend[c];"data"===c&&n.hasOwnProperty("data")&&"object"===typeof l?n.data.merge(l):"sys"!==c&&(n[c]=l)}return n},getKey:function(t,e){if(t||(t="default"),"function"===typeof e)return t;if(e instanceof u?t=e.sys.settings.key:"object"===typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var n=[],i=this.scenes,r=0;r<i.length;r++){var s=i[r];s&&(!t||t&&s.sys.isActive())&&n.push(s)}return e?n.reverse():n},getScene:function(t){if("string"===typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var n=this.getScene(t);return n&&n.sys.pause(e),this},resume:function(t,e){var n=this.getScene(t);return n&&n.sys.resume(e),this},sleep:function(t,e){var n=this.getScene(t);return n&&!n.sys.isTransitioning()&&n.sys.sleep(e),this},wake:function(t,e){var n=this.getScene(t);return n&&n.sys.wake(e),this},run:function(t,e){var n=this.getScene(t);if(!n){for(var i=0;i<this._pending.length;i++)if(this._pending[i].key===t){this.queueOp("start",t,e);break}return this}n.sys.isSleeping()?n.sys.wake(e):n.sys.isPaused()?n.sys.resume(e):this.start(t,e)},start:function(t,e){if(!this.isBooted)return this._data[t]={autoStart:!0,data:e},this;var n=this.getScene(t);if(!n)return console.warn("Scene not found for key: "+t),this;var i,s=n.sys,o=s.settings.status;if(o>=r.START&&o<=r.CREATING)return this;if(o>=r.RUNNING&&o<=r.SLEEPING)s.shutdown(),s.sceneUpdate=l,s.start(e);else if(s.sceneUpdate=l,s.start(e),s.load&&(i=s.load),i&&s.settings.hasOwnProperty("pack")&&(i.reset(),i.addPack({payload:s.settings.pack})))return s.settings.status=r.LOADING,i.once(c.COMPLETE,this.payloadComplete,this),i.start(),this;return this.bootScene(n),this},stop:function(t,e){var n=this.getScene(t);if(n&&!n.sys.isTransitioning()&&n.sys.settings.status!==r.SHUTDOWN){var i=n.sys.load;i&&(i.off(c.COMPLETE,this.loadComplete,this),i.off(c.COMPLETE,this.payloadComplete,this)),n.sys.shutdown(e)}return this},switch:function(t,e){var n=this.getScene(t),i=this.getScene(e);return n&&i&&n!==i&&(this.sleep(t),this.isSleeping(e)?this.wake(e):this.start(e)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)this._queue.push({op:"bringToTop",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e<this.scenes.length){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.push(n)}}return this},sendToBack:function(t){if(this.isProcessing)this._queue.push({op:"sendToBack",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e>0){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(n)}}return this},moveDown:function(t){if(this.isProcessing)this._queue.push({op:"moveDown",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e>0){var n=e-1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveUp:function(t){if(this.isProcessing)this._queue.push({op:"moveUp",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e<this.scenes.length-1){var n=e+1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveAbove",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i&&i<n){var r=this.getAt(i);this.scenes.splice(i,1),this.scenes.splice(n+(i>n),0,r)}}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveBelow",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i&&i>n){var r=this.getAt(i);this.scenes.splice(i,1),0===n?this.scenes.unshift(r):this.scenes.splice(n-(i<n),0,r)}}return this},queueOp:function(t,e,n){return this._queue.push({op:t,keyA:e,keyB:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"swapPosition",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(n!==i&&-1!==n&&-1!==i){var r=this.getAt(n);this.scenes[n]=this.scenes[i],this.scenes[i]=r}}return this},dump:function(){for(var t=[],e=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var i=this.scenes[n].sys,s=!i.settings.visible||i.settings.status!==r.RUNNING&&i.settings.status!==r.PAUSED?"[-] ":"[*] ";s+=i.settings.key+" ("+e[i.settings.status]+")",t.push(s)}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++)this.scenes[t].sys.destroy();this.systemScene.sys.destroy(),this.update=l,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});t.exports=d},64051:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(7599),o=n(72632),a=n(91963),c=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.pluginStart,this)},boot:function(){this.systems.events.once(s.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(s.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=o(t,"target",!1),n=this.manager.getScene(e);if(!e||!this.checkValidTransition(n))return!1;var i=o(t,"duration",1e3);this._elapsed=0,this._target=n,this._duration=i,this._willSleep=o(t,"sleep",!1),this._willRemove=o(t,"remove",!1);var r=o(t,"onUpdate",null);r&&(this._onUpdate=r,this._onUpdateScope=o(t,"onUpdateScope",this.scene));var a=o(t,"allowInput",!1);this.settings.transitionAllowInput=a;var c=n.sys.settings;c.isTransition=!0,c.transitionFrom=this.scene,c.transitionDuration=i,c.transitionAllowInput=a,o(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):o(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),n.sys.isSleeping()?n.sys.wake(o(t,"data")):this.manager.start(e,o(t,"data"));var l=o(t,"onStart",null),u=o(t,"onStartScope",this.scene);return l&&l.call(u,this.scene,n,i),this.systems.events.emit(s.TRANSITION_OUT,n,i),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(t,e){this._elapsed+=e,this.transitionProgress=i(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;t.events.emit(s.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,n,i){return this.manager.add(t,e,n,i)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t){return t!==this.key&&this.manager.queueOp("switch",this.key,t),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,n){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setActive(t,n),this},setVisible:function(t,e){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getStatus:function(t){var e=this.manager.getScene(t);if(e)return e.sys.getStatus()},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(s.SHUTDOWN,this.shutdown,this),t.off(s.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});a.register("ScenePlugin",c,"scenePlugin"),t.exports=c},36765:(t,e,n)=>{var i=n(92980),r=n(10850),s=n(30657),o=n(90415),a={create:function(t){return"string"===typeof t?t={key:t}:void 0===t&&(t={}),{status:i.PENDING,key:r(t,"key",""),active:r(t,"active",!1),visible:r(t,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:r(t,"pack",!1),cameras:r(t,"cameras",null),map:r(t,"map",s(o,r(t,"mapAdd",{}))),physics:r(t,"physics",{}),loader:r(t,"loader",{}),plugins:r(t,"plugins",!1),input:r(t,"input",{})}}};t.exports=a},63946:(t,e,n)=>{var i=n(56694),r=n(92980),s=n(18360),o=n(7599),a=n(47736),c=n(91088),l=n(72283),u=n(36765),h=new i({initialize:function(t,e){this.scene=t,this.game,this.renderer,this.config=e,this.settings=u.create(e),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=l},init:function(t){this.settings.status=r.INIT,this.sceneUpdate=l,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var e=t.plugins;this.plugins=e,e.addToScene(this,s.Global,[s.CoreScene,c(this),a(this)]),this.events.emit(o.BOOT,this),this.settings.isBooted=!0},step:function(t,e){var n=this.events;n.emit(o.PRE_UPDATE,t,e),n.emit(o.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),n.emit(o.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(o.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(o.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var e=this.settings,n=this.getStatus();return n!==r.CREATING&&n!==r.RUNNING?console.warn("Cannot pause non-running Scene",e.key):this.settings.active&&(e.status=r.PAUSED,e.active=!1,this.events.emit(o.PAUSE,this,t)),this},resume:function(t){var e=this.events,n=this.settings;return this.settings.active||(n.status=r.RUNNING,n.active=!0,e.emit(o.RESUME,this,t)),this},sleep:function(t){var e=this.settings,n=this.getStatus();return n!==r.CREATING&&n!==r.RUNNING?console.warn("Cannot sleep non-running Scene",e.key):(e.status=r.SLEEPING,e.active=!1,e.visible=!1,this.events.emit(o.SLEEP,this,t)),this},wake:function(t){var e=this.events,n=this.settings;return n.status=r.RUNNING,n.active=!0,n.visible=!0,e.emit(o.WAKE,this,t),n.isTransition&&e.emit(o.TRANSITION_WAKE,n.transitionFrom,n.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var t=this.settings.status;return t>r.PENDING&&t<=r.RUNNING},isSleeping:function(){return this.settings.status===r.SLEEPING},isActive:function(){return this.settings.status===r.RUNNING},isPaused:function(){return this.settings.status===r.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var e=this.events,n=this.settings;t&&(n.data=t),n.status=r.START,n.active=!0,n.visible=!0,e.emit(o.START,this),e.emit(o.READY,this,t)},shutdown:function(t){var e=this.events,n=this.settings;e.off(o.TRANSITION_INIT),e.off(o.TRANSITION_START),e.off(o.TRANSITION_COMPLETE),e.off(o.TRANSITION_OUT),n.status=r.SHUTDOWN,n.active=!1,n.visible=!1,e.emit(o.SHUTDOWN,this,t)},destroy:function(){var t=this.events,e=this.settings;e.status=r.DESTROYED,e.active=!1,e.visible=!1,t.emit(o.DESTROY,this),t.removeAllListeners();for(var n=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],i=0;i<n.length;i++)this[n[i]]=null}});t.exports=h},92980:t=>{t.exports={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9}},31803:t=>{t.exports="addedtoscene"},94817:t=>{t.exports="boot"},28977:t=>{t.exports="create"},91959:t=>{t.exports="destroy"},363:t=>{t.exports="pause"},15643:t=>{t.exports="postupdate"},17058:t=>{t.exports="prerender"},77125:t=>{t.exports="preupdate"},76018:t=>{t.exports="ready"},28620:t=>{t.exports="removedfromscene"},41538:t=>{t.exports="render"},34268:t=>{t.exports="resume"},2342:t=>{t.exports="shutdown"},96541:t=>{t.exports="sleep"},74244:t=>{t.exports="start"},17046:t=>{t.exports="transitioncomplete"},13637:t=>{t.exports="transitioninit"},14733:t=>{t.exports="transitionout"},33899:t=>{t.exports="transitionstart"},52418:t=>{t.exports="transitionwake"},31735:t=>{t.exports="update"},8470:t=>{t.exports="wake"},7599:(t,e,n)=>{t.exports={ADDED_TO_SCENE:n(31803),BOOT:n(94817),CREATE:n(28977),DESTROY:n(91959),PAUSE:n(363),POST_UPDATE:n(15643),PRE_RENDER:n(17058),PRE_UPDATE:n(77125),READY:n(76018),REMOVED_FROM_SCENE:n(28620),RENDER:n(41538),RESUME:n(34268),SHUTDOWN:n(2342),SLEEP:n(96541),START:n(74244),TRANSITION_COMPLETE:n(17046),TRANSITION_INIT:n(13637),TRANSITION_OUT:n(14733),TRANSITION_START:n(33899),TRANSITION_WAKE:n(52418),UPDATE:n(31735),WAKE:n(8470)}},20436:(t,e,n)=>{var i=n(92980),r=n(98611),s={Events:n(7599),GetPhysicsPlugins:n(47736),GetScenePlugins:n(91088),SceneManager:n(13553),ScenePlugin:n(64051),Settings:n(36765),Systems:n(63946)};s=r(!1,s,i),t.exports=s},25798:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(76038),o=n(98611),a=n(72283),c=new i({Extends:r,initialize:function(t,e,n){r.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},this.currentConfig=this.config,this.config=o(this.config,n),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(t){return!(!t||!t.name||"string"!==typeof t.name)&&(this.markers[t.name]?(console.error("addMarker "+t.name+" already exists in Sound"),!1):(t=o(!0,{name:"",start:0,duration:this.totalDuration-(t.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0}},t),this.markers[t.name]=t,!0))},updateMarker:function(t){return!(!t||!t.name||"string"!==typeof t.name)&&(this.markers[t.name]?(this.markers[t.name]=o(!0,this.markers[t.name],t),!0):(console.warn("Audio Marker: "+t.name+" missing in Sound: "+this.key),!1))},removeMarker:function(t){var e=this.markers[t];return e?(this.markers[t]=null,e):null},play:function(t,e){if(void 0===t&&(t=""),"object"===typeof t&&(e=t,t=""),"string"!==typeof t)return!1;if(t){if(!this.markers[t])return console.warn("Marker: "+t+" missing in Sound: "+this.key),!1;this.currentMarker=this.markers[t],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}else this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;return this.resetConfig(),this.currentConfig=o(this.currentConfig,e),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return!(this.isPaused||!this.isPlaying)&&(this.isPlaying=!1,this.isPaused=!0,!0)},resume:function(){return!(!this.isPaused||this.isPlaying)&&(this.isPlaying=!0,this.isPaused=!1,!0)},stop:function(){return!(!this.isPaused&&!this.isPlaying)&&(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),!0)},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop,this.pan=this.currentConfig.pan},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:a,calculateRate:function(){var t=this.currentConfig.detune+this.manager.detune,e=Math.pow(1.0005777895065548,t);this.totalRate=this.currentConfig.rate*this.manager.rate*e},destroy:function(){this.pendingRemove||(this.stop(),this.emit(s.DESTROY,this),this.removeAllListeners(),this.pendingRemove=!0,this.manager=null,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});t.exports=c},12486:(t,e,n)=>{var i=n(56694),r=n(32742),s=n(6659),o=n(76038),a=n(97081),c=n(71608),l=n(51463),u=n(72283),h=n(93736),d=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.jsonCache=t.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,this.gameLostFocus=!1,this.listenerPosition=new h,t.events.on(a.BLUR,this.onGameBlur,this),t.events.on(a.FOCUS,this.onGameFocus,this),t.events.on(a.PRE_STEP,this.update,this),t.events.once(a.DESTROY,this.destroy,this)},add:u,addAudioSprite:function(t,e){void 0===e&&(e={});var n=this.add(t,e);for(var i in n.spritemap=this.jsonCache.get(t).spritemap,n.spritemap)if(n.spritemap.hasOwnProperty(i)){var s=r(e),o=n.spritemap[i];s.loop=!!o.hasOwnProperty("loop")&&o.loop,n.addMarker({name:i,start:o.start,duration:o.end-o.start,config:s})}return n},get:function(t){return l(this.sounds,"key",t)},getAll:function(t){return t?c(this.sounds,"key",t):c(this.sounds)},getAllPlaying:function(){return c(this.sounds,"isPlaying",!0)},play:function(t,e){var n=this.add(t);return n.once(o.COMPLETE,n.destroy,n),e?e.name?(n.addMarker(e),n.play(e.name)):n.play(e):n.play()},playAudioSprite:function(t,e,n){var i=this.addAudioSprite(t);return i.once(o.COMPLETE,i.destroy,i),i.play(e,n)},remove:function(t){var e=this.sounds.indexOf(t);return-1!==e&&(t.destroy(),this.sounds.splice(e,1),!0)},removeAll:function(){this.sounds.forEach((function(t){t.destroy()})),this.sounds.length=0},removeByKey:function(t){for(var e=0,n=this.sounds.length-1;n>=0;n--){var i=this.sounds[n];i.key===t&&(i.destroy(),this.sounds.splice(n,1),e++)}return e},pauseAll:function(){this.forEachActiveSound((function(t){t.pause()})),this.emit(o.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound((function(t){t.resume()})),this.emit(o.RESUME_ALL,this)},setListenerPosition:u,stopAll:function(){this.forEachActiveSound((function(t){t.stop()})),this.emit(o.STOP_ALL,this)},stopByKey:function(t){var e=0;return this.getAll(t).forEach((function(t){t.stop()&&e++})),e},unlock:u,onBlur:u,onFocus:u,onGameBlur:function(){this.gameLostFocus=!0,this.pauseOnBlur&&this.onBlur()},onGameFocus:function(){this.gameLostFocus=!1,this.pauseOnBlur&&this.onFocus()},update:function(t,e){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(o.UNLOCKED,this));for(var n=this.sounds.length-1;n>=0;n--)this.sounds[n].pendingRemove&&this.sounds.splice(n,1);this.sounds.forEach((function(n){n.update(t,e)}))},destroy:function(){this.game.events.off(a.BLUR,this.onGameBlur,this),this.game.events.off(a.FOCUS,this.onGameFocus,this),this.game.events.off(a.PRE_STEP,this.update,this),this.removeAllListeners(),this.removeAll(),this.sounds.length=0,this.sounds=null,this.listenerPosition=null,this.game=null},forEachActiveSound:function(t,e){var n=this;this.sounds.forEach((function(i,r){i&&!i.pendingRemove&&t.call(e||n,i,r,n.sounds)}))},setRate:function(t){return this.rate=t,this},rate:{get:function(){return this._rate},set:function(t){this._rate=t,this.forEachActiveSound((function(t){t.calculateRate()})),this.emit(o.GLOBAL_RATE,this,t)}},setDetune:function(t){return this.detune=t,this},detune:{get:function(){return this._detune},set:function(t){this._detune=t,this.forEachActiveSound((function(t){t.calculateRate()})),this.emit(o.GLOBAL_DETUNE,this,t)}}});t.exports=d},84191:(t,e,n)=>{var i=n(27622),r=n(17546),s=n(55491),o={create:function(t){var e=t.config.audio,n=t.device.audio;return e.noAudio||!n.webAudio&&!n.audioData?new r(t):n.webAudio&&!e.disableWebAudio?new s(t):new i(t)}};t.exports=o},77578:t=>{t.exports="complete"},19679:t=>{t.exports="decodedall"},56951:t=>{t.exports="decoded"},16436:t=>{t.exports="destroy"},55154:t=>{t.exports="detune"},57818:t=>{t.exports="detune"},57890:t=>{t.exports="mute"},83022:t=>{t.exports="rate"},99170:t=>{t.exports="volume"},64289:t=>{t.exports="looped"},67214:t=>{t.exports="loop"},53128:t=>{t.exports="mute"},73078:t=>{t.exports="pan"},76763:t=>{t.exports="pauseall"},88426:t=>{t.exports="pause"},13765:t=>{t.exports="play"},80291:t=>{t.exports="rate"},11124:t=>{t.exports="resumeall"},55382:t=>{t.exports="resume"},71157:t=>{t.exports="seek"},31776:t=>{t.exports="stopall"},39450:t=>{t.exports="stop"},21939:t=>{t.exports="unlocked"},33019:t=>{t.exports="volume"},76038:(t,e,n)=>{t.exports={COMPLETE:n(77578),DECODED:n(56951),DECODED_ALL:n(19679),DESTROY:n(16436),DETUNE:n(55154),GLOBAL_DETUNE:n(57818),GLOBAL_MUTE:n(57890),GLOBAL_RATE:n(83022),GLOBAL_VOLUME:n(99170),LOOP:n(67214),LOOPED:n(64289),MUTE:n(53128),PAN:n(73078),PAUSE_ALL:n(76763),PAUSE:n(88426),PLAY:n(13765),RATE:n(80291),RESUME_ALL:n(11124),RESUME:n(55382),SEEK:n(71157),STOP_ALL:n(31776),STOP:n(39450),UNLOCKED:n(21939),VOLUME:n(33019)}},34350:(t,e,n)=>{var i=n(25798),r=n(56694),s=n(76038),o=n(82897),a=new r({Extends:i,initialize:function(t,e,n){if(void 0===n&&(n={}),this.tags=t.game.cache.audio.get(e),!this.tags)throw new Error('No cached audio asset with key "'+e);this.audio=null,this.startTime=0,this.previousTime=0,this.duration=this.tags[0].duration,this.totalDuration=this.tags[0].duration,i.call(this,t,e,n)},play:function(t,e){return!this.manager.isLocked(this,"play",[t,e])&&!!i.prototype.play.call(this,t,e)&&!!this.pickAndPlayAudioTag()&&(this.emit(s.PLAY,this),!0)},pause:function(){return!this.manager.isLocked(this,"pause")&&!(this.startTime>0)&&!!i.prototype.pause.call(this)&&(this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.stopAndReleaseAudioTag(),this.emit(s.PAUSE,this),!0)},resume:function(){return!this.manager.isLocked(this,"resume")&&!(this.startTime>0)&&!!i.prototype.resume.call(this)&&!!this.pickAndPlayAudioTag()&&(this.emit(s.RESUME,this),!0)},stop:function(){return!this.manager.isLocked(this,"stop")&&!!i.prototype.stop.call(this)&&(this.stopAndReleaseAudioTag(),this.emit(s.STOP,this),!0)},pickAndPlayAudioTag:function(){if(!this.pickAudioTag())return this.reset(),!1;var t=this.currentConfig.seek,e=this.currentConfig.delay,n=(this.currentMarker?this.currentMarker.start:0)+t;return this.previousTime=n,this.audio.currentTime=n,this.applyConfig(),0===e?(this.startTime=0,this.audio.paused&&this.playCatchPromise()):(this.startTime=window.performance.now()+1e3*e,this.audio.paused||this.audio.pause()),this.resetConfig(),!0},pickAudioTag:function(){if(this.audio)return!0;for(var t=0;t<this.tags.length;t++){var e=this.tags[t];if("false"===e.dataset.used)return e.dataset.used="true",this.audio=e,!0}if(!this.manager.override)return!1;var n=[];this.manager.forEachActiveSound((function(t){t.key===this.key&&t.audio&&n.push(t)}),this),n.sort((function(t,e){return t.loop===e.loop?e.seek/e.duration-t.seek/t.duration:t.loop?1:-1}));var i=n[0];return this.audio=i.audio,i.reset(),i.audio=null,i.startTime=0,i.previousTime=0,!0},playCatchPromise:function(){var t=this.audio.play();t&&t.catch((function(t){console.warn(t)}))},stopAndReleaseAudioTag:function(){this.startTime=0,this.previousTime=0,this.audio&&(this.audio.pause(),this.audio.dataset.used="false",this.audio=null)},reset:function(){i.prototype.stop.call(this)},onBlur:function(){this.isPlaying=!1,this.isPaused=!0,this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1e3),this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=!0,this.isPaused=!1,this.pickAndPlayAudioTag()},update:function(t){if(this.isPlaying)if(this.startTime>0)this.startTime<t-this.manager.audioPlayDelay&&(this.audio.currentTime+=Math.max(0,t-this.startTime)/1e3,this.startTime=0,this.previousTime=this.audio.currentTime,this.playCatchPromise());else{var e=this.currentMarker?this.currentMarker.start:0,n=e+this.duration,i=this.audio.currentTime;if(this.currentConfig.loop)i>=n-this.manager.loopEndOffset?(this.audio.currentTime=e+Math.max(0,i-n),i=this.audio.currentTime):i<e&&(this.audio.currentTime+=e,i=this.audio.currentTime),i<this.previousTime&&this.emit(s.LOOPED,this);else if(i>=n)return this.reset(),this.stopAndReleaseAudioTag(),void this.emit(s.COMPLETE,this);this.previousTime=i}},destroy:function(){i.prototype.destroy.call(this),this.tags=null,this.audio&&this.stopAndReleaseAudioTag()},updateMute:function(){this.audio&&(this.audio.muted=this.currentConfig.mute||this.manager.mute)},updateVolume:function(){this.audio&&(this.audio.volume=o(this.currentConfig.volume*this.manager.volume,0,1))},calculateRate:function(){i.prototype.calculateRate.call(this),this.audio&&(this.audio.playbackRate=this.totalRate)},mute:{get:function(){return this.currentConfig.mute},set:function(t){this.currentConfig.mute=t,this.manager.isLocked(this,"mute",t)||(this.updateMute(),this.emit(s.MUTE,this,t))}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.currentConfig.volume},set:function(t){this.currentConfig.volume=t,this.manager.isLocked(this,"volume",t)||(this.updateVolume(),this.emit(s.VOLUME,this,t))}},setVolume:function(t){return this.volume=t,this},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.manager.isLocked(this,s.RATE,t)||(this.calculateRate(),this.emit(s.RATE,this,t))}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.manager.isLocked(this,s.DETUNE,t)||(this.calculateRate(),this.emit(s.DETUNE,this,t))}},setDetune:function(t){return this.detune=t,this},seek:{get:function(){return this.isPlaying?this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0):this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.isLocked(this,"seek",t)||this.startTime>0||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.isPlaying?(this.previousTime=t,this.audio.currentTime=t):this.isPaused&&(this.currentConfig.seek=t),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.manager.isLocked(this,"loop",t)||(this.audio&&(this.audio.loop=t),this.emit(s.LOOP,this,t))}},setLoop:function(t){return this.loop=t,this},pan:{get:function(){return this.currentConfig.pan},set:function(t){this.currentConfig.pan=t,this.emit(s.PAN,this,t)}},setPan:function(t){return this.pan=t,this}});t.exports=a},27622:(t,e,n)=>{var i=n(12486),r=n(56694),s=n(76038),o=n(34350),a=new r({Extends:i,initialize:function(t){this.override=!0,this.audioPlayDelay=.1,this.loopEndOffset=.05,this.onBlurPausedSounds=[],this.locked="ontouchstart"in window,this.lockedActionsQueue=this.locked?[]:null,this._mute=!1,this._volume=1,i.call(this,t)},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},unlock:function(){this.locked=!1;var t=this;if(this.game.cache.audio.entries.each((function(e,n){for(var i=0;i<n.length;i++)if("true"===n[i].dataset.locked)return t.locked=!0,!1;return!0})),this.locked){var e=!1,n=function(){e=!0},i=function(){if(e)e=!1;else{document.body.removeEventListener("touchmove",n),document.body.removeEventListener("touchend",i);var r=[];if(t.game.cache.audio.entries.each((function(t,e){for(var n=0;n<e.length;n++){var i=e[n];"true"===i.dataset.locked&&r.push(i)}return!0})),0!==r.length){var s=r[r.length-1];s.oncanplaythrough=function(){s.oncanplaythrough=null,r.forEach((function(t){t.dataset.locked="false"})),t.unlocked=!0},r.forEach((function(t){t.load()}))}}};this.once(s.UNLOCKED,(function(){for(this.forEachActiveSound((function(t){null===t.currentMarker&&0===t.duration&&(t.duration=t.tags[0].duration),t.totalDuration=t.tags[0].duration}));this.lockedActionsQueue.length;){var t=this.lockedActionsQueue.shift();t.sound[t.prop].apply?t.sound[t.prop].apply(t.sound,t.value||[]):t.sound[t.prop]=t.value}}),this),document.body.addEventListener("touchmove",n,!1),document.body.addEventListener("touchend",i,!1)}},onBlur:function(){this.forEachActiveSound((function(t){t.isPlaying&&(this.onBlurPausedSounds.push(t),t.onBlur())}))},onFocus:function(){this.onBlurPausedSounds.forEach((function(t){t.onFocus()})),this.onBlurPausedSounds.length=0},destroy:function(){i.prototype.destroy.call(this),this.onBlurPausedSounds.length=0,this.onBlurPausedSounds=null},isLocked:function(t,e,n){return"true"===t.tags[0].dataset.locked&&(this.lockedActionsQueue.push({sound:t,prop:e,value:n}),!0)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return this._mute},set:function(t){this._mute=t,this.forEachActiveSound((function(t){t.updateMute()})),this.emit(s.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this._volume},set:function(t){this._volume=t,this.forEachActiveSound((function(t){t.updateVolume()})),this.emit(s.GLOBAL_VOLUME,this,t)}}});t.exports=a},56751:(t,e,n)=>{t.exports={SoundManagerCreator:n(84191),Events:n(76038),BaseSound:n(25798),BaseSoundManager:n(12486),WebAudioSound:n(96008),WebAudioSoundManager:n(55491),HTML5AudioSound:n(34350),HTML5AudioSoundManager:n(27622),NoAudioSound:n(38662),NoAudioSoundManager:n(17546)}},38662:(t,e,n)=>{var i=n(25798),r=n(56694),s=n(6659),o=n(98611),a=n(72283),c=function(){return!1},l=function(){return null},u=function(){return this},h=new r({Extends:s,initialize:function(t,e,n){void 0===n&&(n={}),s.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=o({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0,pan:0},n),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.pan=0,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:c,updateMarker:c,removeMarker:l,play:c,pause:c,resume:c,stop:c,setMute:u,setVolume:u,setRate:u,setDetune:u,setSeek:u,setLoop:u,setPan:u,applyConfig:l,resetConfig:l,update:a,calculateRate:l,destroy:function(){i.prototype.destroy.call(this)}});t.exports=h},17546:(t,e,n)=>{var i=n(12486),r=n(56694),s=n(6659),o=n(38662),a=n(72283),c=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},addAudioSprite:function(t,e){var n=this.add(t,e);return n.spritemap={},n},get:function(t){return i.prototype.get.call(this,t)},getAll:function(t){return i.prototype.getAll.call(this,t)},play:function(t,e){return!1},playAudioSprite:function(t,e,n){return!1},remove:function(t){return i.prototype.remove.call(this,t)},removeAll:function(){return i.prototype.removeAll.call(this)},removeByKey:function(t){return i.prototype.removeByKey.call(this,t)},stopByKey:function(t){return i.prototype.stopByKey.call(this,t)},onBlur:a,onFocus:a,onGameBlur:a,onGameFocus:a,pauseAll:a,resumeAll:a,stopAll:a,update:a,setRate:a,setDetune:a,setMute:a,setVolume:a,unlock:a,forEachActiveSound:function(t,e){i.prototype.forEachActiveSound.call(this,t,e)},destroy:function(){i.prototype.destroy.call(this)}});t.exports=c},96008:(t,e,n)=>{var i=n(25798),r=n(56694),s=n(76038),o=n(72632),a=new r({Extends:i,initialize:function(t,e,n){if(void 0===n&&(n={}),this.audioBuffer=t.game.cache.audio.get(e),!this.audioBuffer)throw new Error('Audio key "'+e+'" missing from cache');this.source=null,this.loopSource=null,this.muteNode=t.context.createGain(),this.volumeNode=t.context.createGain(),this.pannerNode=null,this.spatialNode=null,this.spatialSource=null,this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),t.context.createPanner&&(this.spatialNode=t.context.createPanner(),this.volumeNode.connect(this.spatialNode)),t.context.createStereoPanner?(this.pannerNode=t.context.createStereoPanner(),t.context.createPanner?this.spatialNode.connect(this.pannerNode):this.volumeNode.connect(this.pannerNode),this.pannerNode.connect(t.destination)):t.context.createPanner?this.spatialNode.connect(t.destination):this.volumeNode.connect(t.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,i.call(this,t,e,n)},play:function(t,e){return!!i.prototype.play.call(this,t,e)&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(s.PLAY,this),!0)},pause:function(){return!(this.manager.context.currentTime<this.startTime)&&!!i.prototype.pause.call(this)&&(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(s.PAUSE,this),!0)},resume:function(){return!(this.manager.context.currentTime<this.startTime)&&!!i.prototype.resume.call(this)&&(this.createAndStartBufferSource(),this.emit(s.RESUME,this),!0)},stop:function(){return!!i.prototype.stop.call(this)&&(this.stopAndRemoveBufferSource(),this.emit(s.STOP,this),!0)},createAndStartBufferSource:function(){var t=this.currentConfig.seek,e=this.currentConfig.delay,n=this.manager.context.currentTime+e,i=(this.currentMarker?this.currentMarker.start:0)+t,r=this.duration-t;this.playTime=n-t,this.startTime=n,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,n),Math.max(0,i),Math.max(0,r)),this.resetConfig()},createAndStartLoopBufferSource:function(){var t=this.getLoopTime(),e=this.currentMarker?this.currentMarker.start:0,n=this.duration;this.loopTime=t,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,t),Math.max(0,e),Math.max(0,n))},createBufferSource:function(){var t=this,e=this.manager.context.createBufferSource();return e.buffer=this.audioBuffer,e.connect(this.muteNode),e.onended=function(e){e.target===t.source&&(t.currentConfig.loop?t.hasLooped=!0:t.hasEnded=!0)},e},stopAndRemoveBufferSource:function(){this.source&&(this.source.stop(),this.source.disconnect(),this.source=null),this.playTime=0,this.startTime=0,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1});var t=this.currentConfig.source;if(t&&this.manager.context.createPanner){var e=this.spatialNode;e.panningModel=o(t,"panningModel","equalpower"),e.distanceModel=o(t,"distanceModel","inverse"),e.orientationX.value=o(t,"orientationX",0),e.orientationY.value=o(t,"orientationY",0),e.orientationZ.value=o(t,"orientationZ",-1),e.refDistance=o(t,"refDistance",1),e.maxDistance=o(t,"maxDistance",1e4),e.rolloffFactor=o(t,"rolloffFactor",1),e.coneInnerAngle=o(t,"coneInnerAngle",360),e.coneOuterAngle=o(t,"coneOuterAngle",0),e.coneOuterGain=o(t,"coneOuterGain",0),this.spatialSource=o(t,"follow",null),this.spatialSource||(e.positionX.value=o(t,"x",0),e.positionY.value=o(t,"y",0),e.positionZ.value=o(t,"z",0))}i.prototype.applyConfig.call(this)},x:{get:function(){return this.spatialNode?this.spatialNode.positionX:0},set:function(t){this.spatialNode&&(this.spatialNode.positionX.value=t)}},y:{get:function(){return this.spatialNode?this.spatialNode.positionY:0},set:function(t){this.spatialNode&&(this.spatialNode.positionY.value=t)}},update:function(){if(this.isPlaying&&this.spatialSource){var t=o(this.spatialSource,"x",null),e=o(this.spatialSource,"y",null);t&&t!==this._spatialx&&(this._spatialx=this.spatialNode.positionX.value=t),e&&e!==this._spatialy&&(this._spatialy=this.spatialNode.positionY.value=e)}this.hasEnded?(this.hasEnded=!1,i.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(s.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(s.LOOPED,this))},destroy:function(){this.pendingRemove||(i.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null),this.spatialNode&&(this.spatialNode.disconnect(),this.spatialNode=null,this.spatialSource=null),this.rateUpdates.length=0,this.rateUpdates=null)},calculateRate:function(){i.prototype.calculateRate.call(this);var t=this.manager.context.currentTime;this.source&&"number"===typeof this.totalRate&&this.source.playbackRate.setValueAtTime(this.totalRate,t),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,t)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var t=0,e=0;e<this.rateUpdates.length;e++)t+=((e<this.rateUpdates.length-1?this.rateUpdates[e+1].time:this.manager.context.currentTime-this.playTime)-this.rateUpdates[e].time)*this.rateUpdates[e].rate;return t},getLoopTime:function(){for(var t=0,e=0;e<this.rateUpdates.length-1;e++)t+=(this.rateUpdates[e+1].time-this.rateUpdates[e].time)*this.rateUpdates[e].rate;var n=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+n.time+(this.duration-t)/n.rate},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.calculateRate(),this.emit(s.RATE,this,t)}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.calculateRate(),this.emit(s.DETUNE,this,t)}},setDetune:function(t){return this.detune=t,this},mute:{get:function(){return 0===this.muteNode.gain.value},set:function(t){this.currentConfig.mute=t,this.muteNode.gain.setValueAtTime(t?0:1,0),this.emit(s.MUTE,this,t)}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(t){this.currentConfig.volume=t,this.volumeNode.gain.setValueAtTime(t,0),this.emit(s.VOLUME,this,t)}},setVolume:function(t){return this.volume=t,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.currentConfig.seek=t,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),t&&this.createAndStartLoopBufferSource()),this.emit(s.LOOP,this,t)}},setLoop:function(t){return this.loop=t,this},pan:{get:function(){return this.pannerNode?this.pannerNode.pan.value:0},set:function(t){this.currentConfig.pan=t,this.pannerNode&&this.pannerNode.pan.setValueAtTime(t,this.manager.context.currentTime),this.emit(s.PAN,this,t)}},setPan:function(t){return this.pan=t,this}});t.exports=a},55491:(t,e,n)=>{var i=n(82329),r=n(12486),s=n(56694),o=n(76038),a=n(97081),c=n(96008),l=n(72632),u=new s({Extends:r,initialize:function(t){this.context=this.createAudioContext(t),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked="suspended"===this.context.state&&("ontouchstart"in window||"onclick"in window),r.call(this,t),this.locked&&t.isBooted?this.unlock():t.events.once(a.BOOT,this.unlock,this)},createAudioContext:function(t){var e=t.config.audio;return e.context?(e.context.resume(),e.context):window.hasOwnProperty("AudioContext")?new AudioContext:window.hasOwnProperty("webkitAudioContext")?new window.webkitAudioContext:void 0},setAudioContext:function(t){return this.context&&this.context.close(),this.masterMuteNode&&this.masterMuteNode.disconnect(),this.masterVolumeNode&&this.masterVolumeNode.disconnect(),this.context=t,this.masterMuteNode=t.createGain(),this.masterVolumeNode=t.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(t.destination),this.destination=this.masterMuteNode,this},add:function(t,e){var n=new c(this,t,e);return this.sounds.push(n),n},decodeAudio:function(t,e){var n;n=Array.isArray(t)?t:[{key:t,data:e}];for(var r=this.game.cache.audio,s=n.length,a=0;a<n.length;a++){var c=n[a],l=c.key,u=c.data;"string"===typeof u&&(u=i(u));var h=function(t,e){r.add(t,e),this.emit(o.DECODED,t),0===--s&&this.emit(o.DECODED_ALL)}.bind(this,l),d=function(t,e){console.error("Error decoding audio: "+t+" - ",e?e.message:""),0===--s&&this.emit(o.DECODED_ALL)}.bind(this,l);this.context.decodeAudioData(u,h,d)}},setListenerPosition:function(t,e){return void 0===t&&(t=this.game.scale.width/2),void 0===e&&(e=this.game.scale.height/2),this.listenerPosition.set(t,e),this},unlock:function(){var t=this,e=document.body,n=function n(){if(t.context&&e){var i=e.removeEventListener.bind(e);t.context.resume().then((function(){i("touchstart",n),i("touchend",n),i("click",n),i("keydown",n),t.unlocked=!0}),(function(){i("touchstart",n),i("touchend",n),i("click",n),i("keydown",n)}))}};e&&(e.addEventListener("touchstart",n,!1),e.addEventListener("touchend",n,!1),e.addEventListener("click",n,!1),e.addEventListener("keydown",n,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){var t=this.context;!t||this.locked||"suspended"!==t.state&&"interrupted"!==t.state||t.resume()},update:function(t,e){var n=this.context.listener;if(n&&void 0!==n.positionX){var i=l(this.listenerPosition,"x",null),s=l(this.listenerPosition,"y",null);i&&i!==this._spatialx&&(this._spatialx=n.positionX.value=i),s&&s!==this._spatialy&&(this._spatialy=n.positionY.value=s)}r.prototype.update.call(this,t,e),this.gameLostFocus||this.onFocus()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio.context)this.context.suspend();else{var t=this;this.context.close().then((function(){t.context=null}))}r.prototype.destroy.call(this)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return 0===this.masterMuteNode.gain.value},set:function(t){this.masterMuteNode.gain.setValueAtTime(t?0:1,0),this.emit(o.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(t){this.masterVolumeNode.gain.setValueAtTime(t,0),this.emit(o.GLOBAL_VOLUME,this,t)}}});t.exports=u},71207:(t,e,n)=>{var i=n(59959),r=n(56694),s=n(72283),o=n(17922),a=new r({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=s,this.removeCallback=s,this._sortKey=""},add:function(t,e){return e?i.Add(this.list,t):i.Add(this.list,t,0,this.addCallback,this)},addAt:function(t,e,n){return n?i.AddAt(this.list,t,e):i.AddAt(this.list,t,e,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),o(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e){return i.CountAllMatching(this.list,t,e)},swap:function(t,e){i.Swap(this.list,t,e)},moveTo:function(t,e){return i.MoveTo(this.list,t,e)},moveAbove:function(t,e){return i.MoveAbove(this.list,t,e)},moveBelow:function(t,e){return i.MoveBelow(this.list,t,e)},remove:function(t,e){return e?i.Remove(this.list,t):i.Remove(this.list,t,this.removeCallback,this)},removeAt:function(t,e){return e?i.RemoveAt(this.list,t):i.RemoveAt(this.list,t,this.removeCallback,this)},removeBetween:function(t,e,n){return n?i.RemoveBetween(this.list,t,e):i.RemoveBetween(this.list,t,e,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(t){return i.BringToTop(this.list,t)},sendToBack:function(t){return i.SendToBack(this.list,t)},moveUp:function(t){return i.MoveUp(this.list,t),t},moveDown:function(t){return i.MoveDown(this.list,t),t},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e){return i.Replace(this.list,t,e)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});t.exports=a},33885:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){this.entries={},this.size=0,this.setAll(t)},setAll:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1]);return this},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach((function(t){delete this.entries[t]}),this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var n in e)if(!1===t(n,e[n]))break;return this},contains:function(t){var e=this.entries;for(var n in e)if(e[n]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var n=this.entries,i=t.entries;for(var r in i)n.hasOwnProperty(r)&&e?n[r]=i[r]:this.set(r,i[r]);return this}});t.exports=i},74623:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(36716),o=new i({Extends:r,initialize:function(){r.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(t){return this._active.indexOf(t)>-1},isPending:function(t){return this._toProcess>0&&this._pending.indexOf(t)>-1},isDestroying:function(t){return this._destroy.indexOf(t)>-1},add:function(t){return this.checkQueue&&this.isActive(t)&&!this.isDestroying(t)||this.isPending(t)||(this._pending.push(t),this._toProcess++),t},remove:function(t){if(this.isPending(t)){var e=this._pending,n=e.indexOf(t);-1!==n&&e.splice(n,1)}else this.isActive(t)&&(this._destroy.push(t),this._toProcess++);return t},removeAll:function(){for(var t=this._active,e=this._destroy,n=t.length;n--;)e.push(t[n]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,i=this._active;for(t=0;t<n.length;t++){e=n[t];var r=i.indexOf(e);-1!==r&&(i.splice(r,1),this.emit(s.PROCESS_QUEUE_REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)e=n[t],(!this.checkQueue||this.checkQueue&&-1===i.indexOf(e))&&(i.push(e),this.emit(s.PROCESS_QUEUE_ADD,e));return n.length=0,this._toProcess=0,i},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});t.exports=o},68687:(t,e,n)=>{var i=n(53466);function r(t){if(!(this instanceof r))return new r(t,[".left",".top",".right",".bottom"]);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],c(r,t.leaf?i(s):s);return r}function c(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,s-i)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,r,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,i(t,o,e,n,s),a.push(e,o,o,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!m(t,e))return n;for(var r,s,o,a,c=[];e;){for(r=0,s=e.children.length;r<s;r++)o=e.children[r],m(t,a=e.leaf?i(o):o)&&(e.leaf?n.push(o):f(t,a)?this._all(o,n):c.push(o));e=c.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var i,r,s,o,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(s=e.children[i],m(t,o=e.leaf?n(s):s)){if(e.leaf||f(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,c=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(r=s(t,a.children,e)))return a.children.splice(r,1),l.push(a),this._condense(l),this;o||a.leaf||!f(a,c)?i?(n++,a=i.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=g([])).leaf=!1,r.height=i;var c,l,u,h,d=Math.ceil(s/a),p=d*Math.ceil(Math.sqrt(a));for(v(t,e,n,p,this.compareMinX),c=e;c<=n;c+=p)for(v(t,c,u=Math.min(c+p-1,n),d,this.compareMinY),l=c;l<=u;l+=d)h=Math.min(l+d-1,u),r.children.push(this._build(t,l,h,i-1));return o(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,s,o,a,c,l,u,d,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(u=d=1/0,r=0,s=e.children.length;r<s;r++)c=h(o=e.children[r]),p=t,f=o,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-c)<d?(d=l,u=c<u?c:u,a=o):l===d&&c<u&&(u=c,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),c(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=g(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,s,o,c,l,u,d;for(l=u=1/0,i=e;i<=n-e;i++)o=p(r=a(t,0,i,this.toBBox),s=a(t,i,n,this.toBBox)),c=h(r)+h(s),o<l?(l=o,d=i,u=c<u?c:u):o===l&&c<u&&(u=c,d=i);return d},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,s,o=this.toBBox,l=a(t,0,e,o),u=a(t,n-e,n,o),h=d(l)+d(u);for(r=e;r<n-e;r++)s=t.children[r],c(l,t.leaf?o(s):s),h+=d(l);for(r=n-e-1;r>=e;r--)s=t.children[r],c(u,t.leaf?o(s):s),h+=d(u);return h},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)c(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},t.exports=r},58403:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var n=0;n<this.entries.length;n++){var i=this.entries[n];if(i[t]===e)return i}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var n,i=this.entries.slice(),r=i.length;if(e)for(n=0;n<r&&!1!==t.call(e,i[n],n);n++);else for(n=0;n<r&&!1!==t(i[n],n);n++);return this},iterate:function(t,e){var n,i=this.entries.length;if(e)for(n=0;n<i&&!1!==t.call(e,this.entries[n],n);n++);else for(n=0;n<i&&!1!==t(this.entries[n],n);n++);return this},iterateLocal:function(t){var e,n=[];for(e=1;e<arguments.length;e++)n.push(arguments[e]);var i=this.entries.length;for(e=0;e<i;e++){var r=this.entries[e];r[t].apply(r,n)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(t){var e=new i;return t.entries.forEach((function(t){e.set(t)})),this.entries.forEach((function(t){e.set(t)})),e},intersect:function(t){var e=new i;return this.entries.forEach((function(n){t.contains(n)&&e.set(n)})),e},difference:function(t){var e=new i;return this.entries.forEach((function(n){t.contains(n)||e.set(n)})),e},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});t.exports=i},90881:(t,e,n)=>{var i=n(82897),r=n(56694),s=n(84314),o=n(93736),a=new r({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=null),this._width=t,this._height=e,this._parent=i,this.aspectMode=n,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new o},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.minWidth=i(t,0,this.maxWidth),this.minHeight=i(e,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(t,e){return void 0===t&&(t=Number.MAX_VALUE),void 0===e&&(e=t),this.maxWidth=i(t,this.minWidth,Number.MAX_VALUE),this.maxHeight=i(e,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case a.NONE:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case a.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case a.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(s(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case a.FIT:this.constrain(t,e,!0);break;case a.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minWidth,this.maxWidth),e&&this._parent&&t>this._parent.width&&(t=Math.max(this.minWidth,this._parent.width)),t},getNewHeight:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minHeight,this.maxHeight),e&&this._parent&&t>this._parent.height&&(t=Math.max(this.minHeight,this._parent.height)),t},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var i=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=s(t,i.x))/this.aspectRatio,i.y>0&&(t=(e=s(e,i.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=s(e,i.y))*this.aspectRatio,i.x>0&&(e=(t=s(t,i.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});a.NONE=0,a.WIDTH_CONTROLS_HEIGHT=1,a.HEIGHT_CONTROLS_WIDTH=2,a.FIT=3,a.ENVELOP=4,t.exports=a},94160:t=>{t.exports="add"},95393:t=>{t.exports="remove"},36716:(t,e,n)=>{t.exports={PROCESS_QUEUE_ADD:n(94160),PROCESS_QUEUE_REMOVE:n(95393)}},20010:(t,e,n)=>{t.exports={Events:n(36716),List:n(71207),Map:n(33885),ProcessQueue:n(74623),RTree:n(68687),Set:n(58403),Size:n(90881)}},17487:(t,e,n)=>{var i=n(56694),r=n(82897),s=n(27119),o=n(86459),a=n(28621),c=n(31673),l=new i({Extends:c,initialize:function(t,e,n,i,r){c.call(this,t,e,n,i,r),this.add("__BASE",0,0,0,i,r),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=i,this.height=r,this.imageData=this.context.getImageData(0,0,i,r),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===o.WEBGL&&this.refresh(),this},draw:function(t,e,n,i){return void 0===i&&(i=!0),this.context.drawImage(n,t,e),i&&this.update(),this},drawFrame:function(t,e,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=!0);var s=this.manager.getFrame(t,e);if(s){var o=s.canvasData,a=s.cutWidth,c=s.cutHeight,l=s.source.resolution;this.context.drawImage(s.source.image,o.x,o.y,a,c,n,i,a/l,c/l),r&&this.update()}return this},setPixel:function(t,e,n,i,r,s){if(void 0===s&&(s=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var o=this.context.getImageData(t,e,1,1);o.data[0]=n,o.data[1]=i,o.data[2]=r,o.data[3]=s,this.context.putImageData(o,t,e)}return this},putData:function(t,e,n,i,r,s,o){return void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=t.width),void 0===o&&(o=t.height),this.context.putImageData(t,e,n,i,r,s,o),this},getData:function(t,e,n,i){return t=r(Math.floor(t),0,this.width-1),e=r(Math.floor(e),0,this.height-1),n=r(n,1,this.width-t),i=r(i,1,this.height-e),this.context.getImageData(t,e,n,i)},getPixel:function(t,e,n){n||(n=new s);var i=this.getIndex(t,e);if(i>-1){var r=this.data,o=r[i+0],a=r[i+1],c=r[i+2],l=r[i+3];n.setTo(o,a,c,l)}return n},getPixels:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=n),t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e));for(var o=r(t,0,this.width),a=r(t+n,0,this.width),c=r(e,0,this.height),l=r(e+i,0,this.height),u=new s,h=[],d=c;d<l;d++){for(var p=[],f=o;f<a;f++)u=this.getPixel(f,d,u),p.push({x:f,y:d,color:u.color,alpha:u.alphaGL});h.push(p)}return h},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,n,i,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),void 0===r&&(r=!0),this.context.clearRect(t,e,n,i),r&&this.update(),this},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=a(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){c.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});t.exports=l},845:(t,e,n)=>{var i=n(95723),r=n(51052),s=n(61068),o=n(56694),a=n(86459),c=n(82047),l=n(72632),u=n(65641),h=n(37410),d=n(31673),p=n(75512),f=new o({Extends:d,initialize:function(t,e,n,i){void 0===n&&(n=256),void 0===i&&(i=256),this.type="DynamicTexture";var o=t.game.renderer,c=o&&o.type===a.CANVAS,l=c?s.create2D(this,n,i):[this];d.call(this,t,e,l,n,i),this.add("__BASE",0,0,0,n,i),this.renderer=o,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=c?l:null,this.context=c?l.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new r(0,0,n,i).setScene(t.game.scene.systemScene,!1),this.renderTarget=c?null:new h(o,n,i,1,0,!1,!0,!0,!1),this.pipeline=c?null:o.pipelines.get(u.SINGLE_PIPELINE),c||this.setSize(n,i)},setSize:function(t,e){void 0===e&&(e=t);var n=this.get(),i=n.source;if(t!==this.width||e!==this.height){this.canvas&&(this.canvas.width=t,this.canvas.height=e);var r=this.renderTarget;r&&(r.willResize(t,e)&&(r.resize(t,e),this.renderer.deleteTexture(i.glTexture)),this.setFromRenderTarget()),this.camera.setSize(t,e),i.width=t,i.height=e,n.setSize(t,e),this.width=t,this.height=e}else{var s=this.getSourceImage();n.cutX+t>s.width&&(t=s.width-n.cutX),n.cutY+e>s.height&&(e=s.height-n.cutY),n.setSize(t,e,n.cutX,n.cutY)}return this},setFromRenderTarget:function(){var t=this.get(),e=t.source,n=this.renderTarget;return t.glTexture=n.texture,e.isRenderTexture=!0,e.isGLTexture=!0,e.glTexture=n.texture,e.glTexture.flipY=!0,this},setIsSpriteTexture:function(t){return this.isSpriteTexture=t,this},fill:function(t,e,n,i,r,s){var o=this.camera,a=this.renderer;void 0===e&&(e=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.width),void 0===s&&(s=this.height);var c=t>>16&255,l=t>>8&255,u=255&t,h=this.renderTarget;if(o.preRender(),h){h.bind(!0);var d=this.pipeline.manager.set(this.pipeline),f=a.width/h.width,m=a.height/h.height,g=h.height-(i+s);d.drawFillRect(n*f,g*m,r*f,s*m,p.getTintFromFloats(u/255,l/255,c/255,1),e),h.unbind(!0)}else{var v=this.context;a.setContext(v),v.globalCompositeOperation="source-over",v.fillStyle="rgba("+c+","+l+","+u+","+e+")",v.fillRect(n,i,r,s),a.setContext()}return this.dirty=!0,this},clear:function(){if(this.dirty){var t=this.context,e=this.renderTarget;e?e.clear():t&&(t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.width,this.height),t.restore()),this.dirty=!1}return this},stamp:function(t,e,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0);var s=l(r,"alpha",1),o=l(r,"tint",16777215),a=l(r,"angle",0),c=l(r,"rotation",0),u=l(r,"scale",1),h=l(r,"scaleX",u),d=l(r,"scaleY",u),p=l(r,"originX",.5),f=l(r,"originY",.5),m=l(r,"blendMode",0),g=l(r,"erase",!1),v=l(r,"skipBatch",!1),y=this.manager.resetStamp(s,o);return y.setAngle(0),0!==a?y.setAngle(a):0!==c&&y.setRotation(c),y.setScale(h,d),y.setTexture(t,e),y.setOrigin(p,f),y.setBlendMode(m),g&&(this._eraseMode=!0),v?this.batchGameObject(y,n,i):this.draw(y,n,i),g&&(this._eraseMode=!1),this},erase:function(t,e,n){return this._eraseMode=!0,this.draw(t,e,n),this._eraseMode=!1,this},draw:function(t,e,n,i,r){return this.beginDraw(),this.batchDraw(t,e,n,i,r),this.endDraw(),this},drawFrame:function(t,e,n,i,r,s){return this.beginDraw(),this.batchDrawFrame(t,e,n,i,r,s),this.endDraw(),this},repeat:function(t,e,n,i,r,s,o,a,l){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.width),void 0===s&&(s=this.height),void 0===o&&(o=1),void 0===a&&(a=16777215),void 0===l&&(l=!1),!(e=t instanceof c?t:this.manager.getFrame(t,e)))return this;var u=this.manager.resetStamp(o,a);u.setFrame(e),u.setOrigin(0);var h=e.width,d=e.height;r=Math.floor(r),s=Math.floor(s);var p=Math.ceil(r/h),f=Math.ceil(s/d),m=p*h-r,g=f*d-s;m>0&&(m=h-m),g>0&&(g=d-g),n<0&&(p+=Math.ceil(Math.abs(n)/h)),i<0&&(f+=Math.ceil(Math.abs(i)/d));var v=n,y=i,x=!1,b=this.manager.stampCrop.setTo(0,0,h,d);l||this.beginDraw();for(var w=0;w<f;w++)if(y+d<0)y+=d;else{for(var S=0;S<p;S++)x=!1,v+h<0||(v<0&&(x=!0,b.width=h+v,b.x=h-b.width),y<0&&(x=!0,b.height=d+y,b.y=d-b.height),m>0&&S===p-1&&(x=!0,b.width=m),g>0&&w===f-1&&(x=!0,b.height=g),x&&u.setCrop(b),this.batchGameObject(u,v,y),u.isCropped=!1,b.setTo(0,0,h,d)),v+=h;v=n,y+=d}return l||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var t=this.camera,e=this.renderer,n=this.renderTarget;t.preRender(),n?e.beginCapture(n.width,n.height):e.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(t,e,n,i,r){return Array.isArray(t)||(t=[t]),this.batchList(t,e,n,i,r),this},batchDrawFrame:function(t,e,n,i,r,s){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===s&&(s=16777215);var o=this.manager.getFrame(t,e);return o&&(this.renderTarget?this.pipeline.batchTextureFrame(o,n,i,s,r,this.camera.matrix,null):this.batchTextureFrame(o,n,i,r,s)),this},endDraw:function(t){if(void 0===t&&(t=this._eraseMode),this.isDrawing){var e=this.renderer,n=this.renderTarget;if(n){var i=e.endCapture();e.pipelines.setUtility().blitFrame(i,n,1,!1,!1,t,this.isSpriteTexture),e.resetScissor(),e.resetViewport()}else e.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(t,e,n,i,r){var s=t.length;if(0!==s)for(var o=0;o<s;o++){var a=t[o];a&&a!==this&&(a.renderWebGL||a.renderCanvas?this.batchGameObject(a,e,n):a.isParent||a.list?this.batchGroup(a.getChildren(),e,n):"string"===typeof a?this.batchTextureFrameKey(a,null,e,n,i,r):a instanceof c?this.batchTextureFrame(a,e,n,i,r):Array.isArray(a)&&this.batchList(a,e,n,i,r))}},batchGroup:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);for(var i=0;i<t.length;i++){var r=t[i];r.willRender(this.camera)&&this.batchGameObject(r,r.x+e,r.y+n)}},batchGameObject:function(t,e,n){void 0===e&&(e=t.x),void 0===n&&(n=t.y);var r=t.x,s=t.y,o=this.camera,a=this.renderer,c=this._eraseMode,l=t.mask;if(t.setPosition(e,n),this.canvas){if(c){var u=t.blendMode;t.blendMode=i.ERASE}l&&l.preRenderCanvas(a,t,o),t.renderCanvas(a,t,o,null),l&&l.postRenderCanvas(a,t,o),c&&(t.blendMode=u)}else a&&(l&&l.preRenderWebGL(a,t,o),c||a.setBlendMode(t.blendMode),t.renderWebGL(a,t,o),l&&l.postRenderWebGL(a,o,this.renderTarget));t.setPosition(r,s)},batchTextureFrameKey:function(t,e,n,i,r,s){var o=this.manager.getFrame(t,e);o&&this.batchTextureFrame(o,n,i,r,s)},batchTextureFrame:function(t,e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=16777215);var s=this.camera.matrix;if(this.renderTarget)this.pipeline.batchTextureFrame(t,e,n,r,i,s,null);else{var o=this.context,a=t.canvasData,c=t.source.image;o.save(),o.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",o.globalAlpha=i,s.setToContext(o),a.width>0&&a.height>0&&o.drawImage(c,a.x,a.y,a.width,a.height,e,n,a.width,a.height),o.restore()}},snapshotArea:function(t,e,n,i,r,s,o){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,r,!1,t,e,n,i,s,o):this.renderer.snapshotCanvas(this.canvas,r,!1,t,e,n,i,s,o),this},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.width,this.height,t,e,n)},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(t,e,n,i){var r=this.manager.resetStamp();r.setTexture(this),r.setOrigin(0),r.renderWebGL(t,r,n,i)},renderCanvas:function(){},destroy:function(){var t=this.manager.stamp;t&&t.texture===this&&this.manager.resetStamp(),d.prototype.destroy.call(this),s.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});t.exports=f},82047:(t,e,n)=>{var i=n(56694),r=n(82897),s=n(98611),o=new i({initialize:function(t,e,n,i,r,s,o){this.texture=t,this.name=e,this.source=t.source[n],this.sourceIndex=n,this.glTexture=this.source.glTexture,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(s,o,i,r)},setSize:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this.cutX=n,this.cutY=i,this.cutWidth=t,this.cutHeight=e,this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var r=this.data,s=r.cut;s.x=n,s.y=i,s.w=t,s.h=e,s.r=n+t,s.b=i+e,r.sourceSize.w=t,r.sourceSize.h=e,r.spriteSourceSize.w=t,r.spriteSourceSize.h=e,r.radius=.5*Math.sqrt(t*t+e*e);var o=r.drawImage;return o.x=n,o.y=i,o.width=t,o.height=e,this.updateUVs()},setTrim:function(t,e,n,i,r,s){var o=this.data,a=o.spriteSourceSize;return o.trim=!0,o.sourceSize.w=t,o.sourceSize.h=e,a.x=n,a.y=i,a.w=r,a.h=s,a.r=n+r,a.b=i+s,this.x=n,this.y=i,this.width=r,this.height=s,this.halfWidth=.5*r,this.halfHeight=.5*s,this.centerX=Math.floor(r/2),this.centerY=Math.floor(s/2),this.updateUVs()},setScale9:function(t,e,n,i){var r=this.data;return r.scale9=!0,r.is3Slice=0===e&&i===this.height,r.scale9Borders.x=t,r.scale9Borders.y=e,r.scale9Borders.w=n,r.scale9Borders.h=i,this},setCropUVs:function(t,e,n,i,s,o,a){var c=this.cutX,l=this.cutY,u=this.cutWidth,h=this.cutHeight,d=this.realWidth,p=this.realHeight,f=c+(e=r(e,0,d)),m=l+(n=r(n,0,p)),g=i=r(i,0,d-e),v=s=r(s,0,p-n),y=this.data;if(y.trim){var x=y.spriteSourceSize,b=e+(i=r(i,0,u-e)),w=n+(s=r(s,0,h-n));if(x.r<e||x.b<n||x.x>b||x.y>w)f=0,m=0,g=0,v=0;else{var S=Math.max(x.x,e),_=Math.max(x.y,n),T=Math.min(x.r,b)-S,E=Math.min(x.b,w)-_;g=T,v=E,f=o?c+(u-(S-x.x)-T):c+(S-x.x),m=a?l+(h-(_-x.y)-E):l+(_-x.y),e=S,n=_,i=T,s=E}}else o&&(f=c+(u-e-i)),a&&(m=l+(h-n-s));var C=this.source.width,k=this.source.height;return t.u0=Math.max(0,f/C),t.v0=Math.max(0,m/k),t.u1=Math.min(1,(f+g)/C),t.v1=Math.min(1,(m+v)/k),t.x=e,t.y=n,t.cx=f,t.cy=m,t.cw=g,t.ch=v,t.width=i,t.height=s,t.flipX=o,t.flipY=a,t},updateCropUVs:function(t,e,n){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,n)},setUVs:function(t,e,n,i,r,s){var o=this.data.drawImage;return o.width=t,o.height=e,this.u0=n,this.v0=i,this.u1=r,this.v1=s,this},updateUVs:function(){var t=this.cutX,e=this.cutY,n=this.cutWidth,i=this.cutHeight,r=this.data.drawImage;r.width=n,r.height=i;var s=this.source.width,o=this.source.height;return this.u0=t/s,this.v0=e/o,this.u1=(t+n)/s,this.v1=(e+i)/o,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new o(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=s(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.texture=null,this.source=null,this.glTexture=null,this.customData=null,this.data=null},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});t.exports=o},31673:(t,e,n)=>{var i=n(56694),r=n(82047),s=n(32547),o='Texture "%s" has no frame "%s"',a=new i({initialize:function(t,e,n,i,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var o=0;o<n.length;o++)this.source.push(new s(this,n[o],i,r))},add:function(t,e,n,i,s,o){if(this.has(t))return null;var a=new r(this,t,e,n,i,s,o);return this.frames[t]=a,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,a},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames.hasOwnProperty(t)},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(o,this.key,t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var n=[];for(var i in this.frames)if("__BASE"!==i||e){var r=this.frames[i];r.sourceIndex===t&&n.push(r)}return n},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var n=e.indexOf("__BASE");-1!==n&&e.splice(n,1)}return e},getSourceImage:function(t){void 0!==t&&null!==t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(o,this.key,t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){void 0!==t&&null!==t&&1!==this.frameTotal||(t="__BASE");var e,n=this.frames[t];return n?e=n.sourceIndex:(console.warn(o,this.key,t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new s(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t,e=this.source,n=this.dataSource;for(t=0;t<e.length;t++)e[t]&&e[t].destroy();for(t=0;t<n.length;t++)n[t]&&n[t].destroy();for(var i in this.frames){var r=this.frames[i];r&&r.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});t.exports=a},6237:(t,e,n)=>{var i=n(61068),r=n(17487),s=n(56694),o=n(27119),a=n(86459),c=n(845),l=n(6659),u=n(38203),h=n(82047),d=n(97081),p=n(52780),f=n(10850),m=n(1539),g=n(42911),v=n(69150),y=n(74118),x=n(31673),b=new s({Extends:l,initialize:function(t){l.call(this),this.game=t,this.name="TextureManager",this.list={},this._tempCanvas=i.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new y,this.silentWarnings=!1,t.events.once(d.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(u.LOAD,this.updatePending,this),this.on(u.ERROR,this.updatePending,this);var t=this.game.config;this.addBase64("__DEFAULT",t.defaultImage),this.addBase64("__MISSING",t.missingImage),this.addBase64("__WHITE",t.whiteImage),this.game.events.once(d.DESTROY,this.destroy,this),this.game.events.once(d.SYSTEM_READY,(function(t){this.stamp=new m(t).setOrigin(0)}),this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(u.LOAD),this.off(u.ERROR),this.emit(u.READY))},checkKey:function(t){return!this.exists(t)||(this.silentWarnings||console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"===typeof t){if(!this.exists(t))return this.silentWarnings||console.warn("No texture found matching key: "+t),this;t=this.get(t)}var e=t.key;return this.list.hasOwnProperty(e)&&(t.destroy(),this.emit(u.REMOVE,e),this.emit(u.REMOVE_KEY+e)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var n=this,i=new Image;i.onerror=function(){n.emit(u.ERROR,t)},i.onload=function(){var e=n.create(t,i);v.Image(e,0),n.emit(u.ADD,t,e),n.emit(u.ADD_KEY+t,e),n.emit(u.LOAD,t,e)},i.src=e}return this},getBase64:function(t,e,n,r){void 0===n&&(n="image/png"),void 0===r&&(r=.92);var s="",o=this.getFrame(t,e);if(o&&(o.source.isRenderTexture||o.source.isGLTexture))this.silentWarnings||console.warn("Cannot getBase64 from WebGL Texture");else if(o){var a=o.canvasData,c=i.create2D(this,a.width,a.height),l=c.getContext("2d",{willReadFrequently:!0});a.width>0&&a.height>0&&l.drawImage(o.source.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),s=c.toDataURL(n,r),i.remove(c)}return s},addImage:function(t,e,n){var i=null;return this.checkKey(t)&&(i=this.create(t,e),v.Image(i,0),n&&i.setDataSource(n),this.emit(u.ADD,t,i),this.emit(u.ADD_KEY+t,i)),i},addGLTexture:function(t,e,n,i){var r=null;return this.checkKey(t)&&(void 0===n&&(n=e.width),void 0===i&&(i=e.height),(r=this.create(t,e,n,i)).add("__BASE",0,0,0,n,i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)),r},addCompressedTexture:function(t,e,n){var i=null;if(this.checkKey(t)){if((i=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),n)if(Array.isArray(n))for(var r=0;r<n.length;r++)v.JSONHash(i,r,n[r]);else v.JSONHash(i,0,n);this.emit(u.ADD,t,i),this.emit(u.ADD_KEY+t,i)}return i},addRenderTexture:function(t,e){var n=null;return this.checkKey(t)&&((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(u.ADD,t,n),this.emit(u.ADD_KEY+t,n)),n},generate:function(t,e){if(this.checkKey(t)){var n=i.create(this,1,1);return e.canvas=n,p(e),this.addCanvas(t,n)}return null},createCanvas:function(t,e,n){if(void 0===e&&(e=256),void 0===n&&(n=256),this.checkKey(t)){var r=i.create(this,e,n,a.CANVAS,!0);return this.addCanvas(t,r)}return null},addCanvas:function(t,e,n){void 0===n&&(n=!1);var i=null;return n?i=new r(this,t,e,e.width,e.height):this.checkKey(t)&&(i=new r(this,t,e,e.width,e.height),this.list[t]=i,this.emit(u.ADD,t,i),this.emit(u.ADD_KEY+t,i)),i},addDynamicTexture:function(t,e,n){var i=null;return"string"!==typeof t||this.exists(t)?t=(i=t).key:i=new c(this,t,e,n),this.checkKey(t)?(this.list[t]=i,this.emit(u.ADD,t,i),this.emit(u.ADD_KEY+t,i)):i=null,i},addAtlas:function(t,e,n,i){return Array.isArray(n.textures)||Array.isArray(n.frames)?this.addAtlasJSONArray(t,e,n,i):this.addAtlasJSONHash(t,e,n,i)},addAtlasJSONArray:function(t,e,n,i){var r=null;if(e instanceof x?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){if(Array.isArray(n))for(var s=1===n.length,o=0;o<r.source.length;o++){var a=s?n[0]:n[o];v.JSONArray(r,o,a)}else v.JSONArray(r,0,n);i&&r.setDataSource(i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)}return r},addAtlasJSONHash:function(t,e,n,i){var r=null;if(e instanceof x?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){if(Array.isArray(n))for(var s=0;s<n.length;s++)v.JSONHash(r,s,n[s]);else v.JSONHash(r,0,n);i&&r.setDataSource(i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)}return r},addAtlasXML:function(t,e,n,i){var r=null;return e instanceof x?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r&&(v.AtlasXML(r,0,n),i&&r.setDataSource(i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)),r},addUnityAtlas:function(t,e,n,i){var r=null;return e instanceof x?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r&&(v.UnityYAML(r,0,n),i&&r.setDataSource(i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)),r},addSpriteSheet:function(t,e,n,i){var r=null;if(e instanceof x?(t=e.key,r=e):this.checkKey(t)&&(r=this.create(t,e)),r){var s=r.source[0].width,o=r.source[0].height;v.SpriteSheet(r,0,0,0,s,o,n),i&&r.setDataSource(i),this.emit(u.ADD,t,r),this.emit(u.ADD_KEY+t,r)}return r},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var n=f(e,"atlas",null),i=f(e,"frame",null);if(n&&i){var r=this.get(n).get(i);if(r){var s=this.create(t,r.source.image);return r.trimmed?v.SpriteSheetFromAtlas(s,r,e):v.SpriteSheet(s,0,r.cutX,r.cutY,r.cutWidth,r.cutHeight,e),this.emit(u.ADD,t,s),this.emit(u.ADD_KEY+t,s),s}}},create:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=new x(this,t,e,n,i),this.list[t]=r),r},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof x?t:t instanceof h?t.texture:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},parseFrame:function(t){if(t)return"string"===typeof t?this.getFrame(t):Array.isArray(t)&&2===t.length?this.getFrame(t[0],t[1]):g(t)?this.getFrame(t.key,t.frame):t instanceof x?t.get():t instanceof h?t:void 0},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&"__WHITE"!==e&&t.push(e);return t},getPixel:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(t+=s.x,e+=s.y,t>=s.x&&t<s.r&&e>=s.y&&e<s.b){var a=this._tempContext;a.clearRect(0,0,1,1),a.drawImage(r.source.image,t,e,1,1,0,0,1,1);var c=a.getImageData(0,0,1,1);return new o(c.data[0],c.data[1],c.data[2],c.data[3])}}return null},getPixelAlpha:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(t+=s.x,e+=s.y,t>=s.x&&t<s.r&&e>=s.y&&e<s.b){var o=this._tempContext;return o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,n){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(n)),t},renameTexture:function(t,e){var n=this.get(t);return!(!n||t===e)&&(n.key=e,this.list[e]=n,delete this.list[t],!0)},each:function(t,e){for(var n=[null],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[0]=this.list[r],t.apply(e,n)},resetStamp:function(t,e){void 0===t&&(t=1),void 0===e&&(e=16777215);var n=this.stamp;return n.setCrop(),n.setPosition(0),n.setAngle(0),n.setScale(1),n.setAlpha(t),n.setTint(e),n.setTexture("__WHITE"),n},destroy:function(){for(var t in this.list)this.list[t].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,i.remove(this._tempCanvas)}});t.exports=b},32547:(t,e,n)=>{var i=n(61068),r=n(56694),s=n(28621),o=n(27394),a=new r({initialize:function(t,e,n,i,r){void 0===r&&(r=!1);var a=t.manager.game;this.renderer=a.renderer,this.texture=t,this.source=e,this.image=e.compressed?null:e,this.compressionAlgorithm=e.compressed?e.format:null,this.resolution=1,this.width=n||e.naturalWidth||e.videoWidth||e.width||0,this.height=i||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=o.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type||"DynamicTexture"===e.type,this.isGLTexture=window.hasOwnProperty("WebGLTexture")&&e instanceof WebGLTexture,this.isPowerOf2=s(this.width,this.height),this.glTexture=null,this.flipY=r,this.init(a)},init:function(t){var e=this.renderer;if(e){var n=this.source;if(e.gl){var i=this.image,r=this.flipY,s=this.width,o=this.height,a=this.scaleMode;this.isCanvas?this.glTexture=e.createCanvasTexture(i,!1,r):this.isVideo?this.glTexture=e.createVideoTexture(i,!1,r):this.isRenderTexture?this.glTexture=e.createTextureFromSource(null,s,o,a):this.isGLTexture?this.glTexture=n:this.compressionAlgorithm?this.glTexture=e.createTextureFromSource(n):this.glTexture=e.createTextureFromSource(i,s,o,a)}else this.isRenderTexture&&(this.image=n.canvas)}t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),this.flipY=t,this},update:function(){var t=this.renderer,e=this.image,n=this.flipY,i=t.gl;i&&this.isCanvas?this.glTexture=t.updateCanvasTexture(e,this.glTexture,n):i&&this.isVideo&&(this.glTexture=t.updateVideoTexture(e,this.glTexture,n))},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&i.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});t.exports=a},65154:t=>{t.exports={LINEAR:0,NEAREST:1}},49644:t=>{t.exports="addtexture"},29569:t=>{t.exports="addtexture-"},60079:t=>{t.exports="onerror"},72665:t=>{t.exports="onload"},93006:t=>{t.exports="ready"},69018:t=>{t.exports="removetexture"},85549:t=>{t.exports="removetexture-"},38203:(t,e,n)=>{t.exports={ADD:n(49644),ADD_KEY:n(29569),ERROR:n(60079),LOAD:n(72665),READY:n(93006),REMOVE:n(69018),REMOVE_KEY:n(85549)}},87499:(t,e,n)=>{var i=n(98611),r=n(65154),s={CanvasTexture:n(17487),DynamicTexture:n(845),Events:n(38203),FilterMode:r,Frame:n(82047),Parsers:n(69150),Texture:n(31673),TextureManager:n(6237),TextureSource:n(32547)};s=i(!1,s,r),t.exports=s},35082:t=>{t.exports=function(t,e,n){if(n.getElementsByTagName("TextureAtlas")){var i=t.source[e];t.add("__BASE",e,0,0,i.width,i.height);for(var r,s=n.getElementsByTagName("SubTexture"),o=0;o<s.length;o++){var a=s[o].attributes,c=a.name.value,l=parseInt(a.x.value,10),u=parseInt(a.y.value,10),h=parseInt(a.width.value,10),d=parseInt(a.height.value,10);if(r=t.add(c,e,l,u,h,d),a.frameX){var p=Math.abs(parseInt(a.frameX.value,10)),f=Math.abs(parseInt(a.frameY.value,10)),m=parseInt(a.frameWidth.value,10),g=parseInt(a.frameHeight.value,10);r.setTrim(h,d,p,f,m,g)}}return t}console.warn("Invalid Texture Atlas XML given")}},83332:t=>{t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},21560:t=>{t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},64423:(t,e,n)=>{var i=n(32742);t.exports=function(t,e,n){if(n.frames||n.textures){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);for(var s,o=Array.isArray(n.textures)?n.textures[e].frames:n.frames,a=0;a<o.length;a++){var c=o[a];if(s=t.add(c.filename,e,c.frame.x,c.frame.y,c.frame.w,c.frame.h)){c.trimmed&&s.setTrim(c.sourceSize.w,c.sourceSize.h,c.spriteSourceSize.x,c.spriteSourceSize.y,c.spriteSourceSize.w,c.spriteSourceSize.h),c.rotated&&(s.rotated=!0,s.updateUVsInverted());var l=c.anchor||c.pivot;l&&(s.customPivot=!0,s.pivotX=l.x,s.pivotY=l.y),c.scale9Borders&&s.setScale9(c.scale9Borders.x,c.scale9Borders.y,c.scale9Borders.w,c.scale9Borders.h),s.customData=i(c)}else console.warn("Invalid atlas json, frame already exists: "+c.filename)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?t.customData[u]=n[u].slice(0):t.customData[u]=n[u]);return t}console.warn("Invalid Texture Atlas JSON Array")}},17264:(t,e,n)=>{var i=n(32742);t.exports=function(t,e,n){if(n.frames){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);var s,o=n.frames;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];if(s=t.add(a,e,c.frame.x,c.frame.y,c.frame.w,c.frame.h)){c.trimmed&&s.setTrim(c.sourceSize.w,c.sourceSize.h,c.spriteSourceSize.x,c.spriteSourceSize.y,c.spriteSourceSize.w,c.spriteSourceSize.h),c.rotated&&(s.rotated=!0,s.updateUVsInverted());var l=c.anchor||c.pivot;l&&(s.customPivot=!0,s.pivotX=l.x,s.pivotY=l.y),c.scale9Borders&&s.setScale9(c.scale9Borders.x,c.scale9Borders.y,c.scale9Borders.w,c.scale9Borders.h),s.customData=i(c)}else console.warn("Invalid atlas json, frame already exists: "+a)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?t.customData[u]=n[u].slice(0):t.customData[u]=n[u]);return t}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")}},67409:t=>{t.exports=function(t){var e,n=[171,75,84,88,32,49,49,187,13,10,26,10],i=new Uint8Array(t,0,12);for(e=0;e<i.length;e++)if(i[e]!==n[e])return void console.warn("KTXParser - Invalid file format");var r=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(t,12,13*r),o=67305985===s.getUint32(0,!0);if(0===s.getUint32(1*r,o)){var a=s.getUint32(4*r,o),c=s.getUint32(6*r,o),l=s.getUint32(7*r,o),u=Math.max(1,s.getUint32(11*r,o)),h=s.getUint32(12*r,o),d=new Array(u),p=64+h,f=c,m=l;for(e=0;e<u;e++){var g=new Int32Array(t,p,1)[0];p+=4,d[e]={data:new Uint8Array(t,p,g),width:f,height:m},f=Math.max(1,f>>1),m=Math.max(1,m>>1),p+=g}return{mipmaps:d,width:c,height:l,internalFormat:a,compressed:!0,generateMipmap:!1}}console.warn("KTXParser - Only compressed formats supported")}},24904:t=>{function e(t,e,n,i,r,s,o){return void 0===o&&(o=16),Math.floor((t+n)/r)*Math.floor((e+i)/s)*o}function n(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function i(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function r(t,n){return e(t,n,3,3,4,4,8)}function s(t,n){return e(t,n,3,3,4,4)}var o={0:{sizeFunc:n,glFormat:35841},1:{sizeFunc:n,glFormat:35843},2:{sizeFunc:i,glFormat:35840},3:{sizeFunc:i,glFormat:35842},6:{sizeFunc:r,glFormat:36196},7:{sizeFunc:r,glFormat:33776},8:{sizeFunc:s,glFormat:33777},9:{sizeFunc:s,glFormat:33778},11:{sizeFunc:s,glFormat:33779},22:{sizeFunc:r,glFormat:37492},23:{sizeFunc:s,glFormat:37496},24:{sizeFunc:r,glFormat:37494},25:{sizeFunc:r,glFormat:37488},26:{sizeFunc:s,glFormat:37490},27:{sizeFunc:s,glFormat:37808},28:{sizeFunc:function(t,n){return e(t,n,4,3,5,4)},glFormat:37809},29:{sizeFunc:function(t,n){return e(t,n,4,4,5,5)},glFormat:37810},30:{sizeFunc:function(t,n){return e(t,n,5,4,6,5)},glFormat:37811},31:{sizeFunc:function(t,n){return e(t,n,5,5,6,6)},glFormat:37812},32:{sizeFunc:function(t,n){return e(t,n,7,4,8,5)},glFormat:37813},33:{sizeFunc:function(t,n){return e(t,n,7,5,8,6)},glFormat:37814},34:{sizeFunc:function(t,n){return e(t,n,7,7,8,8)},glFormat:37815},35:{sizeFunc:function(t,n){return e(t,n,9,4,10,5)},glFormat:37816},36:{sizeFunc:function(t,n){return e(t,n,9,5,10,6)},glFormat:37817},37:{sizeFunc:function(t,n){return e(t,n,9,7,10,8)},glFormat:37818},38:{sizeFunc:function(t,n){return e(t,n,9,9,10,10)},glFormat:37819},39:{sizeFunc:function(t,n){return e(t,n,11,9,12,10)},glFormat:37820},40:{sizeFunc:function(t,n){return e(t,n,11,11,12,12)},glFormat:37821}};t.exports=function(t){for(var e=new Uint32Array(t,0,13),n=e[2],i=o[n].glFormat,r=o[n].sizeFunc,s=e[11],a=e[7],c=e[6],l=52+e[12],u=new Uint8Array(t,l),h=new Array(s),d=0,p=a,f=c,m=0;m<s;m++){var g=r(p,f);h[m]={data:new Uint8Array(u.buffer,u.byteOffset+d,g),width:p,height:f},p=Math.max(1,p>>1),f=Math.max(1,f>>1),d+=g}return{mipmaps:h,width:a,height:c,internalFormat:i,compressed:!0,generateMipmap:!1}}},6143:(t,e,n)=>{var i=n(72632);t.exports=function(t,e,n,r,s,o,a){var c=i(a,"frameWidth",null),l=i(a,"frameHeight",c);if(null===c)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var u=t.source[e];t.add("__BASE",e,0,0,u.width,u.height);var h=i(a,"startFrame",0),d=i(a,"endFrame",-1),p=i(a,"margin",0),f=i(a,"spacing",0),m=Math.floor((s-p+f)/(c+f))*Math.floor((o-p+f)/(l+f));0===m&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",t.key),(h>m||h<-m)&&(h=0),h<0&&(h=m+h),(-1===d||d>m||d<h)&&(d=m);for(var g=p,v=p,y=0,x=0,b=0,w=0;w<m;w++){y=0,x=0;var S=g+c,_=v+l;S>s&&(y=S-s),_>o&&(x=_-o),w>=h&&w<=d&&(t.add(b,e,n+g,r+v,c-y,l-x),b++),(g+=c+f)+c>s&&(g=p,v+=l+f)}return t}},20030:(t,e,n)=>{var i=n(72632);t.exports=function(t,e,n){var r=i(n,"frameWidth",null),s=i(n,"frameHeight",r);if(!r)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var o=t.source[0];t.add("__BASE",0,0,0,o.width,o.height);var a,c=i(n,"startFrame",0),l=i(n,"endFrame",-1),u=i(n,"margin",0),h=i(n,"spacing",0),d=e.cutX,p=e.cutY,f=e.cutWidth,m=e.cutHeight,g=e.realWidth,v=e.realHeight,y=Math.floor((g-u+h)/(r+h)),x=Math.floor((v-u+h)/(s+h)),b=y*x,w=e.x,S=r-w,_=r-(g-f-w),T=e.y,E=s-T,C=s-(v-m-T);(c>b||c<-b)&&(c=0),c<0&&(c=b+c),-1!==l&&(b=c+(l+1));for(var k=u,A=u,I=0,O=0;O<x;O++){for(var R=0===O,N=O===x-1,M=0;M<y;M++){var D=0===M,P=M===y-1;if(a=t.add(I,0,d+k,p+A,r,s),D||R||P||N){var F=D?w:0,L=R?T:0,B=0,z=0;D&&(B+=r-S),P&&(B+=r-_),R&&(z+=s-E),N&&(z+=s-C);var U=r-B,j=s-z;a.cutWidth=U,a.cutHeight=j,a.setTrim(r,s,F,L,U,j)}k+=h,k+=D?S:P?_:r,I++}k=u,A+=h,A+=R?E:N?C:s}return t}},89187:t=>{var e=0,n=function(t,n,i,r){var s=e-r.y-r.height;t.add(i,n,r.x,s,r.width,r.height)};t.exports=function(t,i,r){var s=t.source[i];t.add("__BASE",i,0,0,s.width,s.height),e=s.height;for(var o=r.split("\n"),a=/^[ ]*(- )*(\w+)+[: ]+(.*)/,c="",l="",u={x:0,y:0,width:0,height:0},h=0;h<o.length;h++){var d=o[h].match(a);if(d){var p="- "===d[1],f=d[2],m=d[3];if(p&&(l!==c&&(n(t,i,l,u),c=l),u={x:0,y:0,width:0,height:0}),"name"!==f)switch(f){case"x":case"y":case"width":case"height":u[f]=parseInt(m,10)}else l=m}}return l!==c&&n(t,i,l,u),t}},69150:(t,e,n)=>{t.exports={AtlasXML:n(35082),Canvas:n(83332),Image:n(21560),JSONArray:n(64423),JSONHash:n(17264),KTXParser:n(67409),PVRParser:n(24904),SpriteSheet:n(6143),SpriteSheetFromAtlas:n(20030),UnityYAML:n(89187)}},93560:t=>{t.exports={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3}},97042:(t,e,n)=>{var i=new(n(56694))({initialize:function(t,e,n,i,r,s,o){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===r&&(r=0),void 0===s&&(s=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|n,this.imageHeight=0|i,this.imageMargin=0|r,this.imageSpacing=0|s,this.properties=o||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e){return this.images.push({gid:t,image:e}),this.total++,this}});t.exports=i},46422:(t,e,n)=>{var i=new(n(56694))({initialize:function(t){if(this.gids=[],void 0!==t)for(var e=0;e<t.length;++e)for(var n=t[e],i=0;i<n.total;++i)this.gids[n.firstgid+i]=n;this._gids=this.gids},enabled:{get:function(){return!!this.gids},set:function(t){this.gids=t?this._gids:void 0}},getTypeIncludingTile:function(t){if(void 0!==t.type&&""!==t.type)return t.type;if(this.gids&&void 0!==t.gid){var e=this.gids[t.gid];if(e){var n=e.getTileData(t.gid);if(n)return n.type}}},setTextureAndFrame:function(t,e,n,i){if(null===e&&this.gids&&void 0!==i.gid){var r=this.gids[i.gid];r&&(null===e&&void 0!==r.image&&(e=r.image.key),null===n&&(n=i.gid-r.firstgid),t.scene.textures.getFrame(e,n)||(e=null,n=null))}t.setTexture(e,n)},setPropertiesFromTiledObject:function(t,e){if(void 0!==this.gids&&void 0!==e.gid){var n=this.gids[e.gid];void 0!==n&&this.setFromJSON(t,n.getTileProperties(e.gid))}this.setFromJSON(t,e.properties)},setFromJSON:function(t,e){if(e)if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];void 0!==t[i.name]?t[i.name]=i.value:t.setData(i.name,i.value)}else for(var r in e)void 0!==t[r]?t[r]=e[r]:t.setData(r,e[r])}});t.exports=i},15043:(t,e,n)=>{var i=n(93560),r=n(16586),s=n(90715),o=n(89797);t.exports=function(t,e,n,a,c,l,u,h){void 0===n&&(n=32),void 0===a&&(a=32),void 0===c&&(c=10),void 0===l&&(l=10),void 0===h&&(h=!1);var d=null;if(Array.isArray(u))d=s(void 0!==e?e:"map",i.ARRAY_2D,u,n,a,h);else if(void 0!==e){var p=t.cache.tilemap.get(e);p?d=s(e,p.format,p.data,n,a,h):console.warn("No map data found for key "+e)}return null===d&&(d=new r({tileWidth:n,tileHeight:a,width:c,height:l})),new o(t,d)}},29633:(t,e,n)=>{var i=n(56694),r=n(64937),s=n(12920),o=n(28699),a=n(66658),c=new i({Mixins:[r.AlphaSingle,r.Flip,r.Visible],initialize:function(t,e,n,i,r,s,o,a){this.layer=t,this.index=e,this.x=n,this.y=i,this.width=r,this.height=s,this.right,this.bottom,this.baseWidth=void 0!==o?o:r,this.baseHeight=void 0!==a?a:s,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,this.collisionCallbackContext=this,this.tint=16777215,this.tintFill=!1,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=o(t.properties),this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).x:this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).y:this.y*this.baseWidth-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new a),e.x=this.getLeft(t),e.y=this.getTop(t),e.width=this.getRight(t)-e.x,e.height=this.getBottom(t)-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},intersects:function(t,e,n,i){return!(n<=this.pixelX||i<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){return void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,n,i,r){return void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=t),void 0===r&&(r=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=n,this.collideDown=i,this.faceLeft=t,this.faceRight=e,this.faceTop=n,this.faceBottom=i,r&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,n,i){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==n&&(this.baseWidth=n),void 0!==i&&(this.baseHeight=i),this.updatePixelXY(),this},updatePixelXY:function(){var t=this.layer.orientation;if(t===s.ORTHOGONAL)this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight;else if(t===s.ISOMETRIC)this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5;else if(t===s.STAGGERED)this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2);else if(t===s.HEXAGONAL){var e,n,i=this.layer.staggerAxis,r=this.layer.staggerIndex,o=this.layer.hexSideLength;"y"===i?(n=(this.baseHeight-o)/2+o,this.pixelX="odd"===r?this.x*this.baseWidth+this.y%2*(this.baseWidth/2):this.x*this.baseWidth-this.y%2*(this.baseWidth/2),this.pixelY=this.y*n):"x"===i&&(e=(this.baseWidth-o)/2+o,this.pixelX=this.x*e,this.pixelY="odd"===r?this.y*this.baseHeight+this.x%2*(this.baseHeight/2):this.y*this.baseHeight-this.x%2*(this.baseHeight/2))}return this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});t.exports=c},89797:(t,e,n)=>{var i=n(14556),r=n(56694),s=n(75606),o=n(93560),a=n(72632),c=n(94990),l=n(46422),u=n(12920),h=n(52257),d=n(72677),p=n(13747),f=n(29633),m=n(5047),g=n(87177),v=n(47975),y=new r({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tiles=e.tiles,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0,this.hexSideLength=e.hexSideLength;var n=this.orientation;this._convert={WorldToTileXY:m.GetWorldToTileXYFunction(n),WorldToTileX:m.GetWorldToTileXFunction(n),WorldToTileY:m.GetWorldToTileYFunction(n),TileToWorldXY:m.GetTileToWorldXYFunction(n),TileToWorldX:m.GetTileToWorldXFunction(n),TileToWorldY:m.GetTileToWorldYFunction(n),GetTileCorners:m.GetTileCornersFunction(n)}},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"===typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(t,e,n,r,s,a,c,l){if(void 0===t)return null;if(void 0!==e&&null!==e||(e=t),!this.scene.sys.textures.exists(e))return console.warn("Invalid Tileset Image: "+e),null;var u=this.scene.sys.textures.get(e),h=this.getTilesetIndex(t);if(null===h&&this.format===o.TILED_JSON)return console.warn("No data found for Tileset: "+t),null;var d=this.tilesets[h];return d?(d.setTileSize(n,r),d.setSpacing(s,a),d.setImage(u),d):(void 0===n&&(n=this.tileWidth),void 0===r&&(r=this.tileHeight),void 0===s&&(s=0),void 0===a&&(a=0),void 0===c&&(c=0),void 0===l&&(l={x:0,y:0}),(d=new v(t,c,n,r,s,a,void 0,void 0,l)).setImage(u),this.tilesets.push(d),this.tiles=i(this),d)},copy:function(t,e,n,i,r,s,o,a){return null!==(a=this.getLayer(a))?(m.Copy(t,e,n,i,r,s,o,a),this):null},createBlankLayer:function(t,e,n,i,r,s,o,a){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.width),void 0===s&&(s=this.height),void 0===o&&(o=this.tileWidth),void 0===a&&(a=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var l,u=new c({name:t,tileWidth:o,tileHeight:a,width:r,height:s,orientation:this.orientation}),h=0;h<s;h++){l=[];for(var d=0;d<r;d++)l.push(new f(u,-1,d,h,o,a,this.tileWidth,this.tileHeight));u.data.push(l)}this.layers.push(u),this.currentLayerIndex=this.layers.length-1;var p=new g(this.scene,this,this.currentLayerIndex,e,n,i);return p.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(p),p},createLayer:function(t,e,n,i){var r=this.getLayerIndex(t);if(null===r)return console.warn("Invalid Tilemap Layer ID: "+t),"string"===typeof t&&console.warn("Valid tilelayer names: %o",this.getTileLayerNames()),null;var s=this.layers[r];if(s.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=r,void 0===n&&(n=s.x),void 0===i&&(i=s.y);var o=new g(this.scene,this,r,e,n,i);return o.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(o),o},createFromObjects:function(t,e,n){void 0===n&&(n=!0);var i=[],r=this.getObjectLayer(t);if(!r)return console.warn("createFromObjects: Invalid objectLayerName given: "+t),i;var o=new l(n?this.tilesets:void 0);Array.isArray(e)||(e=[e]);for(var c=r.objects,d=0;d<e.length;d++){var f,m=e[d],g=a(m,"id",null),v=a(m,"gid",null),y=a(m,"name",null),x=a(m,"type",null);o.enabled=!a(m,"ignoreTileset",null);for(var b=[],w=0;w<c.length;w++)f=c[w],(null===g&&null===v&&null===y&&null===x||null!==g&&f.id===g||null!==v&&f.gid===v||null!==y&&f.name===y||null!==x&&o.getTypeIncludingTile(f)===x)&&b.push(f);for(var S=a(m,"classType",p),_=a(m,"scene",this.scene),T=a(m,"container",null),E=a(m,"key",null),C=a(m,"frame",null),k=0;k<b.length;k++){f=b[k];var A=new S(_);if(A.setName(f.name),A.setPosition(f.x,f.y),o.setTextureAndFrame(A,E,C,f),f.width&&(A.displayWidth=f.width),f.height&&(A.displayHeight=f.height),this.orientation===u.ISOMETRIC){var I=this.tileWidth/this.tileHeight,O={x:A.x-A.y,y:(A.x+A.y)/I};A.x=O.x,A.y=O.y}var R={x:A.originX*f.width,y:(A.originY-(f.gid?1:0))*f.height};if(f.rotation){var N=s(f.rotation);h(R,N),A.rotation=N}A.x+=R.x,A.y+=R.y,void 0===f.flippedHorizontal&&void 0===f.flippedVertical||A.setFlip(f.flippedHorizontal,f.flippedVertical),f.visible||(A.visible=!1),o.setPropertiesFromTiledObject(A,f),T?T.add(A):_.add.existing(A),i.push(A)}}return i},createFromTiles:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:m.CreateFromTiles(t,e,n,i,r,s)},fill:function(t,e,n,i,r,s,o){return void 0===s&&(s=!0),null===(o=this.getLayer(o))?null:(m.Fill(t,e,n,i,r,s,o),this)},filterObjects:function(t,e,n){if("string"===typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.filter(e,n)},filterTiles:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:m.FilterTiles(t,e,n,i,r,s,o,a)},findByIndex:function(t,e,n,i){return null===(i=this.getLayer(i))?null:m.FindByIndex(t,e,n,i)},findObject:function(t,e,n){if("string"===typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.find(e,n)||null},findTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:m.FindTile(t,e,n,i,r,s,o,a)},forEachTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:(m.ForEachTile(t,e,n,i,r,s,o,a),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map((function(t){return t.name})):[]},getIndex:function(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return n;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map((function(t){return t.name})):[]},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"===typeof t?this.getLayerIndexByName(t):"number"===typeof t&&t<this.layers.length?t:t instanceof g&&t.tilemap===this?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,n,i){return null===(i=this.getLayer(i))?null:m.GetTileAt(t,e,n,i)},getTileAtWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:m.GetTileAtWorldXY(t,e,n,i,r)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map((function(t){return t.name})):[]},getTilesWithin:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:m.GetTilesWithin(t,e,n,i,r,s)},getTilesWithinShape:function(t,e,n,i){return null===(i=this.getLayer(i))?null:m.GetTilesWithinShape(t,e,n,i)},getTilesWithinWorldXY:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:m.GetTilesWithinWorldXY(t,e,n,i,r,s,o)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,n){return null===(n=this.getLayer(n))?null:m.HasTileAt(t,e,n)},hasTileAtWorldXY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:m.HasTileAtWorldXY(t,e,n,i)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,n,i,r){return void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:m.PutTileAt(t,e,n,i,r)},putTileAtWorldXY:function(t,e,n,i,r,s){return void 0===i&&(i=!0),null===(s=this.getLayer(s))?null:m.PutTileAtWorldXY(t,e,n,i,r,s)},putTilesAt:function(t,e,n,i,r){return void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:(m.PutTilesAt(t,e,n,i,r),this)},randomize:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:(m.Randomize(t,e,n,i,r,s),this)},calculateFacesAt:function(t,e,n){return null===(n=this.getLayer(n))?null:(m.CalculateFacesAt(t,e,n),this)},calculateFacesWithin:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(m.CalculateFacesWithin(t,e,n,i,r),this)},removeLayer:function(t){var e=this.getLayerIndex(t);if(null!==e){d(this.layers,e);for(var n=e;n<this.layers.length;n++)this.layers[n].tilemapLayer&&this.layers[n].tilemapLayer.layerIndex--;return this.currentLayerIndex===e&&(this.currentLayerIndex=0),this}return null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).tilemapLayer.destroy(),d(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=!0);var i=[];Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];i.push(this.removeTileAt(s.x,s.y,!0,n,s.tilemapLayer)),e>-1&&this.putTileAt(e,s.x,s.y,n,s.tilemapLayer)}return i},removeTileAt:function(t,e,n,i,r){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:m.RemoveTileAt(t,e,n,i,r)},removeTileAtWorldXY:function(t,e,n,i,r,s){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(s=this.getLayer(s))?null:m.RemoveTileAtWorldXY(t,e,n,i,r,s)},renderDebug:function(t,e,n){return null===(n=this.getLayer(n))?null:(this.orientation===u.ORTHOGONAL&&m.RenderDebug(t,e,n),this)},renderDebugFull:function(t,e){for(var n=this.layers,i=0;i<n.length;i++)m.RenderDebug(t,e,n[i]);return this},replaceByIndex:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(m.ReplaceByIndex(t,e,n,i,r,s,o),this)},setCollision:function(t,e,n,i,r){return void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),null===(i=this.getLayer(i))?null:(m.SetCollision(t,e,n,i,r),this)},setCollisionBetween:function(t,e,n,i,r){return void 0===n&&(n=!0),void 0===i&&(i=!0),null===(r=this.getLayer(r))?null:(m.SetCollisionBetween(t,e,n,i,r),this)},setCollisionByProperty:function(t,e,n,i){return void 0===e&&(e=!0),void 0===n&&(n=!0),null===(i=this.getLayer(i))?null:(m.SetCollisionByProperty(t,e,n,i),this)},setCollisionByExclusion:function(t,e,n,i){return void 0===e&&(e=!0),void 0===n&&(n=!0),null===(i=this.getLayer(i))?null:(m.SetCollisionByExclusion(t,e,n,i),this)},setCollisionFromCollisionGroup:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),null===(n=this.getLayer(n))?null:(m.SetCollisionFromCollisionGroup(t,e,n),this)},setTileIndexCallback:function(t,e,n,i){return null===(i=this.getLayer(i))?null:(m.SetTileIndexCallback(t,e,n,i),this)},setTileLocationCallback:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(m.SetTileLocationCallback(t,e,n,i,r,s,o),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var n=0;n<this.layers.length;n++){this.layers[n].baseTileWidth=t,this.layers[n].baseTileHeight=e;for(var i=this.layers[n].data,r=this.layers[n].width,s=this.layers[n].height,o=0;o<s;o++)for(var a=0;a<r;a++){var c=i[o][a];null!==c&&c.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,n){if(null===(n=this.getLayer(n)))return this;n.tileWidth=t,n.tileHeight=e;for(var i=n.data,r=n.width,s=n.height,o=0;o<s;o++)for(var a=0;a<r;a++){var c=i[o][a];null!==c&&c.setSize(t,e)}return this},shuffle:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(m.Shuffle(t,e,n,i,r),this)},swapByIndex:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(m.SwapByIndex(t,e,n,i,r,s,o),this)},tileToWorldX:function(t,e,n){return null===(n=this.getLayer(n))?null:this._convert.TileToWorldX(t,e,n)},tileToWorldY:function(t,e,n){return null===(n=this.getLayer(n))?null:this._convert.TileToWorldY(t,e,n)},tileToWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:this._convert.TileToWorldXY(t,e,n,i,r)},getTileCorners:function(t,e,n,i){return null===(i=this.getLayer(i))?null:this._convert.GetTileCorners(t,e,n,i)},weightedRandomize:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:(m.WeightedRandomize(e,n,i,r,t,s),this)},worldToTileX:function(t,e,n,i){return null===(i=this.getLayer(i))?null:this._convert.WorldToTileX(t,e,n,i)},worldToTileY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:this._convert.WorldToTileY(t,e,n,i)},worldToTileXY:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:this._convert.WorldToTileXY(t,e,n,i,r,s)},destroy:function(){this.removeAllLayers(),this.tiles.length=0,this.tilesets.length=0,this.objects.length=0,this.scene=null}});t.exports=y},4843:(t,e,n)=>{var i=n(99325),r=n(15043);i.register("tilemap",(function(t){var e=void 0!==t?t:{};return r(this.scene,e.key,e.tileWidth,e.tileHeight,e.width,e.height,e.data,e.insertNull)}))},37940:(t,e,n)=>{var i=n(61286),r=n(15043);i.register("tilemap",(function(t,e,n,i,s,o,a){return null===t&&(t=void 0),null===e&&(e=void 0),null===n&&(n=void 0),null===i&&(i=void 0),null===s&&(s=void 0),r(this.scene,t,e,n,i,s,o,a)}))},87177:(t,e,n)=>{var i=n(56694),r=n(95239),s=n(64937),o=n(89980),a=n(5047),c=n(96193),l=n(93736),u=new i({Extends:o,Mixins:[s.Alpha,s.BlendMode,s.ComputedSize,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.PostPipeline,s.Transform,s.Visible,s.ScrollFactor,r,c],initialize:function(t,e,n,i,r,s){o.call(this,t,"TilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=n,this.layer=e.layers[n],this.layer.tilemapLayer=this,this.tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=a.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.tempVec=new l,this.collisionCategory=1,this.collisionMask=1,this.setTilesets(i),this.setAlpha(this.layer.alpha),this.setPosition(r,s),this.setOrigin(0,0),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline(),this.initPostPipeline(!1)},setTilesets:function(t){var e=[],n=[],i=this.tilemap;Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];if("string"===typeof s&&(s=i.getTileset(s)),s){n.push(s);for(var o=s.firstgid,a=0;a<s.total;a++)e[o+a]=s}}this.gidMap=e,this.tileset=n},setRenderOrder:function(t){return"string"===typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return a.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,n,i){return a.CalculateFacesWithin(t,e,n,i,this.layer),this},createFromTiles:function(t,e,n,i,r){return a.CreateFromTiles(t,e,n,i,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,n,i,r,s,o){return a.Copy(t,e,n,i,r,s,o,this.layer),this},fill:function(t,e,n,i,r,s){return a.Fill(t,e,n,i,r,s,this.layer),this},filterTiles:function(t,e,n,i,r,s,o){return a.FilterTiles(t,e,n,i,r,s,o,this.layer)},findByIndex:function(t,e,n){return a.FindByIndex(t,e,n,this.layer)},findTile:function(t,e,n,i,r,s,o){return a.FindTile(t,e,n,i,r,s,o,this.layer)},forEachTile:function(t,e,n,i,r,s,o){return a.ForEachTile(t,e,n,i,r,s,o,this.layer),this},setTint:function(t,e,n,i,r,s){return void 0===t&&(t=16777215),this.forEachTile((function(e){e.tint=t,e.tintFill=!1}),this,e,n,i,r,s)},setTintFill:function(t,e,n,i,r,s){return void 0===t&&(t=16777215),this.forEachTile((function(e){e.tint=t,e.tintFill=!0}),this,e,n,i,r,s)},getTileAt:function(t,e,n){return a.GetTileAt(t,e,n,this.layer)},getTileAtWorldXY:function(t,e,n,i){return a.GetTileAtWorldXY(t,e,n,i,this.layer)},getIsoTileAtWorldXY:function(t,e,n,i,r){void 0===n&&(n=!0);var s=this.tempVec;return a.IsometricWorldToTileXY(t,e,!0,s,r,this.layer,n),this.getTileAt(s.x,s.y,i)},getTilesWithin:function(t,e,n,i,r){return a.GetTilesWithin(t,e,n,i,r,this.layer)},getTilesWithinShape:function(t,e,n){return a.GetTilesWithinShape(t,e,n,this.layer)},getTilesWithinWorldXY:function(t,e,n,i,r,s){return a.GetTilesWithinWorldXY(t,e,n,i,r,s,this.layer)},hasTileAt:function(t,e){return a.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,n){return a.HasTileAtWorldXY(t,e,n,this.layer)},putTileAt:function(t,e,n,i){return a.PutTileAt(t,e,n,i,this.layer)},putTileAtWorldXY:function(t,e,n,i,r){return a.PutTileAtWorldXY(t,e,n,i,r,this.layer)},putTilesAt:function(t,e,n,i){return a.PutTilesAt(t,e,n,i,this.layer),this},randomize:function(t,e,n,i,r){return a.Randomize(t,e,n,i,r,this.layer),this},removeTileAt:function(t,e,n,i){return a.RemoveTileAt(t,e,n,i,this.layer)},removeTileAtWorldXY:function(t,e,n,i,r){return a.RemoveTileAtWorldXY(t,e,n,i,r,this.layer)},renderDebug:function(t,e){return a.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,n,i,r,s){return a.ReplaceByIndex(t,e,n,i,r,s,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,n,i){return a.SetCollision(t,e,n,this.layer,i),this},setCollisionBetween:function(t,e,n,i){return a.SetCollisionBetween(t,e,n,i,this.layer),this},setCollisionByProperty:function(t,e,n){return a.SetCollisionByProperty(t,e,n,this.layer),this},setCollisionByExclusion:function(t,e,n){return a.SetCollisionByExclusion(t,e,n,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return a.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,n){return a.SetTileIndexCallback(t,e,n,this.layer),this},setTileLocationCallback:function(t,e,n,i,r,s){return a.SetTileLocationCallback(t,e,n,i,r,s,this.layer),this},shuffle:function(t,e,n,i){return a.Shuffle(t,e,n,i,this.layer),this},swapByIndex:function(t,e,n,i,r,s){return a.SwapByIndex(t,e,n,i,r,s,this.layer),this},tileToWorldX:function(t,e){return this.tilemap.tileToWorldX(t,e,this)},tileToWorldY:function(t,e){return this.tilemap.tileToWorldY(t,e,this)},tileToWorldXY:function(t,e,n,i){return this.tilemap.tileToWorldXY(t,e,n,i,this)},getTileCorners:function(t,e,n){return this.tilemap.getTileCorners(t,e,n,this)},weightedRandomize:function(t,e,n,i,r){return a.WeightedRandomize(e,n,i,r,t,this.layer),this},worldToTileX:function(t,e,n){return this.tilemap.worldToTileX(t,e,n,this)},worldToTileY:function(t,e,n){return this.tilemap.worldToTileY(t,e,n,this)},worldToTileXY:function(t,e,n,i,r){return this.tilemap.worldToTileXY(t,e,n,i,r,this)},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],o.prototype.destroy.call(this))}});t.exports=u},17394:(t,e,n)=>{var i=n(69360),r=new i,s=new i,o=new i;t.exports=function(t,e,n,i){var a=e.cull(n),c=a.length,l=n.alpha*e.alpha;if(!(0===c||l<=0)){var u=r,h=s,d=o;h.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(n.matrix);var p=t.currentContext,f=e.gidMap;p.save(),i?(u.multiplyWithOffset(i,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),h.e=e.x,h.f=e.y,u.multiply(h,d),d.copyToContext(p)):(h.e-=n.scrollX*e.scrollFactorX,h.f-=n.scrollY*e.scrollFactorY,h.copyToContext(p)),(!t.antialias||e.scaleX>1||e.scaleY>1)&&(p.imageSmoothingEnabled=!1);for(var m=0;m<c;m++){var g=a[m],v=f[g.index];if(v){var y=v.image.getSourceImage(),x=v.getTileTextureCoordinates(g.index),b=v.tileWidth,w=v.tileHeight;if(null!==x&&0!==b&&0!==w){var S=.5*b,_=.5*w;x.x+=v.tileOffset.x,x.y+=v.tileOffset.y,p.save(),p.translate(g.pixelX+S,g.pixelY+_),0!==g.rotation&&p.rotate(g.rotation),(g.flipX||g.flipY)&&p.scale(g.flipX?-1:1,g.flipY?-1:1),p.globalAlpha=l*g.alpha,p.drawImage(y,x.x,x.y,b,w,-S,-_,b,w),p.restore()}}}p.restore()}}},96193:(t,e,n)=>{var i=n(72283),r=i,s=i;r=n(51395),s=n(17394),t.exports={renderWebGL:r,renderCanvas:s}},51395:(t,e,n)=>{var i=n(75512);t.exports=function(t,e,n){var r=e.cull(n),s=r.length,o=n.alpha*e.alpha;if(!(0===s||o<=0)){var a=e.gidMap,c=t.pipelines.set(e.pipeline,e),l=i.getTintAppendFloatAlpha,u=e.scrollFactorX,h=e.scrollFactorY,d=e.x,p=e.y,f=e.scaleX,m=e.scaleY;t.pipelines.preBatch(e);for(var g=0;g<s;g++){var v=r[g],y=a[v.index];if(y){var x=y.getTileTextureCoordinates(v.index);if(null!==x){var b=y.glTexture,w=c.setTexture2D(b,e),S=y.tileWidth,_=y.tileHeight,T=x.x,E=x.y,C=.5*y.tileWidth,k=.5*y.tileHeight,A=y.tileOffset.x,I=y.tileOffset.y,O=l(v.tint,o*v.alpha);c.batchTexture(e,b,b.width,b.height,d+v.pixelX*f+(C*f-A),p+v.pixelY*m+(k*m-I),v.width,v.height,f,m,v.rotation,v.flipX,v.flipY,u,h,C,k,T,E,S,_,O,O,O,O,v.tintFill,0,0,n,null,!0,w,!0)}}}t.pipelines.postBatch(e)}}},47975:(t,e,n)=>{var i=n(56694),r=n(93736),s=new i({initialize:function(t,e,n,i,s,o,a,c,l){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a={}),void 0===c&&(c={}),this.name=t,this.firstgid=e,this.tileWidth=n,this.tileHeight=i,this.tileMargin=s,this.tileSpacing=o,this.tileProperties=a,this.tileData=c,this.tileOffset=new r,void 0!==l&&this.tileOffset.set(l.x,l.y),this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){return this.image=t,this.glTexture=t.get().source.glTexture,this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e){var n=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),i=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);n%1===0&&i%1===0||console.warn("Image tile area not tile size multiple in: "+this.name),n=Math.floor(n),i=Math.floor(i),this.rows=n,this.columns=i,this.total=n*i,this.texCoordinates.length=0;for(var r=this.tileMargin,s=this.tileMargin,o=0;o<this.rows;o++){for(var a=0;a<this.columns;a++)this.texCoordinates.push({x:r,y:s}),r+=this.tileWidth+this.tileSpacing;r=this.tileMargin,s+=this.tileHeight+this.tileSpacing}return this}});t.exports=s},92839:(t,e,n)=>{var i=n(15494);t.exports=function(t,e,n){var r=i(t,e,!0,n),s=i(t,e-1,!0,n),o=i(t,e+1,!0,n),a=i(t-1,e,!0,n),c=i(t+1,e,!0,n),l=r&&r.collides;return l&&(r.faceTop=!0,r.faceBottom=!0,r.faceLeft=!0,r.faceRight=!0),s&&s.collides&&(l&&(r.faceTop=!1),s.faceBottom=!l),o&&o.collides&&(l&&(r.faceBottom=!1),o.faceTop=!l),a&&a.collides&&(l&&(r.faceLeft=!1),a.faceRight=!l),c&&c.collides&&(l&&(r.faceRight=!1),c.faceLeft=!l),r&&!r.collides&&r.resetFaces(),r}},60386:(t,e,n)=>{var i=n(15494),r=n(50811);t.exports=function(t,e,n,s,o){for(var a=null,c=null,l=null,u=null,h=r(t,e,n,s,null,o),d=0;d<h.length;d++){var p=h[d];p&&(p.collides?(a=i(p.x,p.y-1,!0,o),c=i(p.x,p.y+1,!0,o),l=i(p.x-1,p.y,!0,o),u=i(p.x+1,p.y,!0,o),p.faceTop=!a||!a.collides,p.faceBottom=!c||!c.collides,p.faceLeft=!l||!l.collides,p.faceRight=!u||!u.collides):p.resetFaces())}}},13125:(t,e,n)=>{var i=new(n(93736));t.exports=function(t,e,n,r){var s=n.tilemapLayer,o=s.cullPaddingX,a=s.cullPaddingY,c=s.tilemap.tileToWorldXY(t,e,i,r,s);return c.x>r.worldView.x+s.scaleX*n.tileWidth*(-o-.5)&&c.x<r.worldView.right+s.scaleX*n.tileWidth*(o-.5)&&c.y>r.worldView.y+s.scaleY*n.tileHeight*(-a-1)&&c.y<r.worldView.bottom+s.scaleY*n.tileHeight*(a-.5)}},17347:(t,e,n)=>{var i=n(60386),r=n(50811),s=n(62839),o=n(29633);t.exports=function(t,e,n,a,c,l,u,h){void 0===u&&(u=!0);var d=r(t,e,n,a,null,h),p=[];d.forEach((function(t){var e=new o(t.layer,t.index,t.x,t.y,t.width,t.height,t.baseWidth,t.baseHeight);e.copy(t),p.push(e)}));for(var f=c-t,m=l-e,g=0;g<p.length;g++){var v=p[g],y=v.x+f,x=v.y+m;s(y,x,h)&&h.data[x][y]&&(v.x=y,v.y=x,v.updatePixelXY(),h.data[x][y]=v)}u&&i(c-1,l-1,n+2,a+2,h),d.length=0,p.length=0}},93604:(t,e,n)=>{var i=n(50811),r=n(51202);t.exports=function(t,e,n,s,o,a){n||(n={}),Array.isArray(t)||(t=[t]);var c=a.tilemapLayer;s||(s=c.scene),o||(o=s.cameras.main);var l,u=i(0,0,a.width,a.height,null,a),h=[];for(l=0;l<u.length;l++){var d=u[l];if(-1!==t.indexOf(d.index)){var p=c.tileToWorldXY(d.x,d.y,void 0,o,a);n.x=p.x,n.y=p.y,h.push(s.make.sprite(n))}}if("number"===typeof e)for(l=0;l<t.length;l++)r(t[l],e,0,0,a.width,a.height,a);else if(Array.isArray(e))for(l=0;l<t.length;l++)r(t[l],e[l],0,0,a.width,a.height,a);return h}},71586:(t,e,n)=>{var i=n(74118),r=n(82127),s=n(84314),o=new i;t.exports=function(t,e){var n=t.tilemapLayer.tilemap,i=t.tilemapLayer,a=Math.floor(n.tileWidth*i.scaleX),c=Math.floor(n.tileHeight*i.scaleY),l=s(e.worldView.x-i.x,a,0,!0)-i.cullPaddingX,u=r(e.worldView.right-i.x,a,0,!0)+i.cullPaddingX,h=s(e.worldView.y-i.y,c,0,!0)-i.cullPaddingY,d=r(e.worldView.bottom-i.y,c,0,!0)+i.cullPaddingY;return o.setTo(l,h,u-l,d-h)}},381:(t,e,n)=>{var i=n(71586),r=n(6987);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer,a=i(t,e);return(o.skipCull||1!==o.scrollFactorX||1!==o.scrollFactorY)&&(a.left=0,a.right=t.width,a.top=0,a.bottom=t.height),r(t,a,s,n),n}},97734:(t,e,n)=>{var i=n(50811),r=n(60386),s=n(68234);t.exports=function(t,e,n,o,a,c,l){for(var u=-1!==l.collideIndexes.indexOf(t),h=i(e,n,o,a,null,l),d=0;d<h.length;d++)h[d].index=t,s(h[d],u);c&&r(e-1,n-1,o+2,a+2,l)}},63555:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a,c){return i(n,r,s,o,a,c).filter(t,e)}},37982:t=>{t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=!1);var r,s,o,a=0;if(n){for(s=i.height-1;s>=0;s--)for(r=i.width-1;r>=0;r--)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}}else for(s=0;s<i.height;s++)for(r=0;r<i.width;r++)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}return null}},48297:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a,c){return i(n,r,s,o,a,c).find(t,e)||null}},80916:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a,c){i(n,r,s,o,a,c).forEach(t,e)}},31493:(t,e,n)=>{var i=n(12920),r=n(381),s=n(37524),o=n(20887),a=n(72283),c=n(19242);t.exports=function(t){return t===i.ORTHOGONAL?r:t===i.HEXAGONAL?s:t===i.STAGGERED?c:t===i.ISOMETRIC?o:a}},15494:(t,e,n)=>{var i=n(62839);t.exports=function(t,e,n,r){if(void 0===n&&(n=!1),i(t,e,r)){var s=r.data[e][t]||null;return s?-1===s.index?n?s:null:s:null}return null}},24640:(t,e,n)=>{var i=n(15494),r=new(n(93736));t.exports=function(t,e,n,s,o){return o.tilemapLayer.worldToTileXY(t,e,!0,r,s),i(r.x,r.y,n,o)}},48495:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r){var s=r.baseTileWidth,o=r.baseTileHeight,a=r.tilemapLayer,c=0,l=0;a&&(n||(n=a.scene.cameras.main),c=a.x+n.scrollX*(1-a.scrollFactorX),l=a.y+n.scrollY*(1-a.scrollFactorY),s*=a.scaleX,o*=a.scaleY);var u=c+t*s,h=l+e*o;return[new i(u,h),new i(u+s,h),new i(u+s,h+o),new i(u,h+o)]}},7160:(t,e,n)=>{var i=n(12920),r=n(63634),s=n(72283),o=n(48495);t.exports=function(t){return t===i.ORTHOGONAL?o:t===i.ISOMETRIC?s:t===i.HEXAGONAL?r:(i.STAGGERED,s)}},16884:(t,e,n)=>{var i=n(12920),r=n(72283),s=n(44150);t.exports=function(t){return t===i.ORTHOGONAL?s:r}},68182:(t,e,n)=>{var i=n(12920),r=n(21715),s=n(21808),o=n(72283),a=n(33388),c=n(46836);t.exports=function(t){return t===i.ORTHOGONAL?c:t===i.ISOMETRIC?s:t===i.HEXAGONAL?r:t===i.STAGGERED?a:o}},3752:(t,e,n)=>{var i=n(12920),r=n(72283),s=n(84132),o=n(42477);t.exports=function(t){return t===i.ORTHOGONAL?o:t===i.STAGGERED?s:r}},50811:(t,e,n)=>{var i=n(72632);t.exports=function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=o.width),void 0===r&&(r=o.height),s||(s={});var a=i(s,"isNotEmpty",!1),c=i(s,"isColliding",!1),l=i(s,"hasInterestingFace",!1);t<0&&(n+=t,t=0),e<0&&(r+=e,e=0),t+n>o.width&&(n=Math.max(o.width-t,0)),e+r>o.height&&(r=Math.max(o.height-e,0));for(var u=[],h=e;h<e+r;h++)for(var d=t;d<t+n;d++){var p=o.data[h][d];if(null!==p){if(a&&-1===p.index)continue;if(c&&!p.collides)continue;if(l&&!p.hasInterestingFace)continue;u.push(p)}}return u}},31674:(t,e,n)=>{var i=n(84068),r=n(50811),s=n(7563),o=n(72283),a=n(93736),c=function(t,e){return s.RectangleToTriangle(e,t)},l=new a,u=new a,h=new a;t.exports=function(t,e,n,a){if(void 0===t)return[];var d=o;t instanceof i.Circle?d=s.CircleToRectangle:t instanceof i.Rectangle?d=s.RectangleToRectangle:t instanceof i.Triangle?d=c:t instanceof i.Line&&(d=s.LineToRectangle),a.tilemapLayer.worldToTileXY(t.left,t.top,!0,u,n);var p=u.x,f=u.y;a.tilemapLayer.worldToTileXY(t.right,t.bottom,!1,h,n);var m=Math.ceil(h.x),g=Math.ceil(h.y),v=Math.max(m-p,1),y=Math.max(g-f,1),x=r(p,f,v,y,e,a),b=a.tileWidth,w=a.tileHeight;a.tilemapLayer&&(b*=a.tilemapLayer.scaleX,w*=a.tilemapLayer.scaleY);for(var S=[],_=new i.Rectangle(0,0,b,w),T=0;T<x.length;T++){var E=x[T];a.tilemapLayer.tileToWorldXY(E.x,E.y,l,n),_.x=l.x,_.y=l.y,d(t,_)&&S.push(E)}return S}},44662:(t,e,n)=>{var i=n(50811),r=n(93736),s=new r,o=new r;t.exports=function(t,e,n,r,a,c,l){var u=l.tilemapLayer.tilemap._convert.WorldToTileXY;u(t,e,!0,s,c,l);var h=s.x,d=s.y;u(t+n,e+r,!1,o,c,l);var p=Math.ceil(o.x),f=Math.ceil(o.y);return i(h,d,p-h,f-d,a,l)}},29296:(t,e,n)=>{var i=n(12920),r=n(10618),s=n(806);t.exports=function(t){return t===i.ORTHOGONAL?s:r}},32688:(t,e,n)=>{var i=n(12920),r=n(11516),s=n(18750),o=n(72283),a=n(90562),c=n(45676);t.exports=function(t){return t===i.ORTHOGONAL?c:t===i.ISOMETRIC?s:t===i.HEXAGONAL?r:t===i.STAGGERED?a:o}},74326:(t,e,n)=>{var i=n(12920),r=n(10618),s=n(3689),o=n(70520);t.exports=function(t){return t===i.ORTHOGONAL?o:t===i.STAGGERED?s:r}},46598:(t,e,n)=>{var i=n(62839);t.exports=function(t,e,n){if(i(t,e,n)){var r=n.data[e][t];return null!==r&&r.index>-1}return!1}},28654:(t,e,n)=>{var i=n(46598),r=new(n(93736));t.exports=function(t,e,n,s){s.tilemapLayer.worldToTileXY(t,e,!0,r,n);var o=r.x,a=r.y;return i(o,a,s)}},6358:(t,e,n)=>{var i=n(82127),r=n(84314);t.exports=function(t,e){var n,s,o,a,c=t.tilemapLayer.tilemap,l=t.tilemapLayer,u=Math.floor(c.tileWidth*l.scaleX),h=Math.floor(c.tileHeight*l.scaleY),d=t.hexSideLength;if("y"===t.staggerAxis){var p=(h-d)/2+d;n=r(e.worldView.x-l.x,u,0,!0)-l.cullPaddingX,s=i(e.worldView.right-l.x,u,0,!0)+l.cullPaddingX,o=r(e.worldView.y-l.y,p,0,!0)-l.cullPaddingY,a=i(e.worldView.bottom-l.y,p,0,!0)+l.cullPaddingY}else{var f=(u-d)/2+d;n=r(e.worldView.x-l.x,f,0,!0)-l.cullPaddingX,s=i(e.worldView.right-l.x,f,0,!0)+l.cullPaddingX,o=r(e.worldView.y-l.y,h,0,!0)-l.cullPaddingY,a=i(e.worldView.bottom-l.y,h,0,!0)+l.cullPaddingY}return{left:n,right:s,top:o,bottom:a}}},37524:(t,e,n)=>{var i=n(6358),r=n(6987);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer,a=i(t,e);return o.skipCull&&1===o.scrollFactorX&&1===o.scrollFactorY&&(a.left=0,a.right=t.width,a.top=0,a.bottom=t.height),r(t,a,s,n),n}},63634:(t,e,n)=>{var i=n(21715),r=n(93736),s=new r;t.exports=function(t,e,n,o){var a=o.baseTileWidth,c=o.baseTileHeight,l=o.tilemapLayer;l&&(a*=l.scaleX,c*=l.scaleY);var u,h,d=i(t,e,s,n,o),p=[],f=.5773502691896257;"y"===o.staggerAxis?(u=f*a,h=c/2):(u=a/2,h=f*c);for(var m=0;m<6;m++){var g=2*Math.PI*(.5-m)/6;p.push(new r(d.x+u*Math.cos(g),d.y+h*Math.sin(g)))}return p}},21715:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,c=s.tilemapLayer,l=0,u=0;c&&(r||(r=c.scene.cameras.main),l=c.x+r.scrollX*(1-c.scrollFactorX),u=c.y+r.scrollY*(1-c.scrollFactorY),o*=c.scaleX,a*=c.scaleY);var h,d,p=o/2,f=a/2;return"y"===s.staggerAxis?(h=l+o*t+o,d=u+1.5*e*f+f,e%2===0&&("odd"===this.staggerIndex?h-=p:h+=p)):"x"===this.staggerAxis&&"odd"===this.staggerIndex&&(h=l+1.5*t*p+p,d=u+a*t+a,t%2===0&&("odd"===this.staggerIndex?d-=f:d+=f)),n.set(h,d)}},11516:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s,o){r||(r=new i);var a=o.baseTileWidth,c=o.baseTileHeight,l=o.tilemapLayer;l&&(s||(s=l.scene.cameras.main),t-=l.x+s.scrollX*(1-l.scrollFactorX),e-=l.y+s.scrollY*(1-l.scrollFactorY),a*=l.scaleX,c*=l.scaleY);var u,h,d,p,f,m=.5773502691896257,g=-.3333333333333333,v=.6666666666666666,y=a/2,x=c/2;"y"===o.staggerAxis?(d=m*(u=(t-y)/(m*a))+g*(h=(e-x)/x),p=0*u+v*h):(d=g*(u=(t-y)/y)+m*(h=(e-x)/(m*c)),p=v*u+0*h),f=-d-p;var b,w=Math.round(d),S=Math.round(p),_=Math.round(f),T=Math.abs(w-d),E=Math.abs(S-p),C=Math.abs(_-f);T>E&&T>C?w=-S-_:E>C&&(S=-w-_);var k=S;return b="odd"===o.staggerIndex?k%2===0?S/2+w:S/2+w-.5:k%2===0?S/2+w:S/2+w+.5,r.set(b,k)}},62839:t=>{t.exports=function(t,e,n){return t>=0&&t<n.width&&e>=0&&e<n.height}},20887:(t,e,n)=>{var i=n(13125);t.exports=function(t,e,n,r){void 0===n&&(n=[]),void 0===r&&(r=0),n.length=0;var s,o,a,c=t.tilemapLayer,l=t.data,u=t.width,h=t.height,d=c.skipCull,p=u,f=h;if(0===r){for(o=0;o<f;o++)for(s=0;s<p;s++)if(d||i(s,o,t,e)){if(!(a=l[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(1===r){for(o=0;o<f;o++)for(s=p;s>=0;s--)if(d||i(s,o,t,e)){if(!(a=l[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(2===r){for(o=f;o>=0;o--)for(s=0;s<p;s++)if(d||i(s,o,t,e)){if(!(a=l[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}}else if(3===r)for(o=f;o>=0;o--)for(s=p;s>=0;s--)if(d||i(s,o,t,e)){if(!(a=l[o][s])||-1===a.index||!a.visible||0===a.alpha)continue;n.push(a)}return c.tilesDrawn=n.length,c.tilesTotal=u*h,n}},21808:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,c=s.tilemapLayer,l=0,u=0;c&&(r||(r=c.scene.cameras.main),l=c.x+r.scrollX*(1-c.scrollFactorX),o*=c.scaleX,u=c.y+r.scrollY*(1-c.scrollFactorY),a*=c.scaleY);var h=l+o/2*(t-e),d=u+(t+e)*(a/2);return n.set(h,d)}},18750:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s,o,a){r||(r=new i);var c=o.baseTileWidth,l=o.baseTileHeight,u=o.tilemapLayer;u&&(s||(s=u.scene.cameras.main),e-=u.y+s.scrollY*(1-u.scrollFactorY),l*=u.scaleY,t-=u.x+s.scrollX*(1-u.scrollFactorX),c*=u.scaleX);var h=c/2,d=l/2;a||(e-=l);var p=.5*((t-=h)/h+e/d),f=.5*(-t/h+e/d);return n&&(p=Math.floor(p),f=Math.floor(f)),r.set(p,f)}},29003:(t,e,n)=>{var i=n(29633),r=n(62839),s=n(92839),o=n(68234);t.exports=function(t,e,n,a,c){if(void 0===a&&(a=!0),!r(e,n,c))return null;var l,u=c.data[n][e],h=u&&u.collides;t instanceof i?(null===c.data[n][e]&&(c.data[n][e]=new i(c,t.index,e,n,c.tileWidth,c.tileHeight)),c.data[n][e].copy(t)):(l=t,null===c.data[n][e]?c.data[n][e]=new i(c,l,e,n,c.tileWidth,c.tileHeight):c.data[n][e].index=l);var d=c.data[n][e],p=-1!==c.collideIndexes.indexOf(d.index);if(-1===(l=t instanceof i?t.index:t))d.width=c.tileWidth,d.height=c.tileHeight;else{var f=c.tilemapLayer.tilemap,m=f.tiles[l][2],g=f.tilesets[m];d.width=g.tileWidth,d.height=g.tileHeight}return o(d,p),a&&h!==d.collides&&s(e,n,c),d}},48565:(t,e,n)=>{var i=n(29003),r=new(n(93736));t.exports=function(t,e,n,s,o,a){return a.tilemapLayer.worldToTileXY(e,n,!0,r,o,a),i(t,r.x,r.y,s,a)}},56547:(t,e,n)=>{var i=n(60386),r=n(29003);t.exports=function(t,e,n,s,o){if(void 0===s&&(s=!0),!Array.isArray(t))return null;Array.isArray(t[0])||(t=[t]);for(var a=t.length,c=t[0].length,l=0;l<a;l++)for(var u=0;u<c;u++){var h=t[l][u];r(h,e+u,n+l,!1,o)}s&&i(e-1,n-1,c+2,a+2,o)}},91180:(t,e,n)=>{var i=n(50811),r=n(72861);t.exports=function(t,e,n,s,o,a){var c,l=i(t,e,n,s,{},a);if(!o)for(o=[],c=0;c<l.length;c++)-1===o.indexOf(l[c].index)&&o.push(l[c].index);for(c=0;c<l.length;c++)l[c].index=r(o)}},929:(t,e,n)=>{var i=n(29633),r=n(62839),s=n(92839);t.exports=function(t,e,n,o,a){if(void 0===n&&(n=!0),void 0===o&&(o=!0),!r(t,e,a))return null;var c=a.data[e][t];return c?(a.data[e][t]=n?null:new i(a,-1,t,e,a.tileWidth,a.tileHeight),o&&c&&c.collides&&s(t,e,a),c):null}},17384:(t,e,n)=>{var i=n(929),r=new(n(93736));t.exports=function(t,e,n,s,o,a){return a.tilemapLayer.worldToTileXY(t,e,!0,r,o,a),i(r.x,r.y,n,s,a)}},93763:(t,e,n)=>{var i=n(50811),r=n(95509),s=new r(105,210,231,150),o=new r(243,134,48,200),a=new r(40,39,37,150);t.exports=function(t,e,n){void 0===e&&(e={});var r=void 0!==e.tileColor?e.tileColor:s,c=void 0!==e.collidingTileColor?e.collidingTileColor:o,l=void 0!==e.faceColor?e.faceColor:a,u=i(0,0,n.width,n.height,null,n);t.translateCanvas(n.tilemapLayer.x,n.tilemapLayer.y),t.scaleCanvas(n.tilemapLayer.scaleX,n.tilemapLayer.scaleY);for(var h=0;h<u.length;h++){var d=u[h],p=d.width,f=d.height,m=d.pixelX,g=d.pixelY,v=d.collides?c:r;null!==v&&(t.fillStyle(v.color,v.alpha/255),t.fillRect(m,g,p,f)),m+=1,g+=1,p-=2,f-=2,null!==l&&(t.lineStyle(1,l.color,l.alpha/255),d.faceTop&&t.lineBetween(m,g,m+p,g),d.faceRight&&t.lineBetween(m+p,g,m+p,g+f),d.faceBottom&&t.lineBetween(m,g+f,m+p,g+f),d.faceLeft&&t.lineBetween(m,g,m,g+f))}}},51202:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a){for(var c=i(n,r,s,o,null,a),l=0;l<c.length;l++)c[l]&&c[l].index===t&&(c[l].index=e)}},6987:t=>{t.exports=function(t,e,n,i){var r,s,o,a=t.data,c=t.width,l=t.height,u=t.tilemapLayer,h=Math.max(0,e.left),d=Math.min(c,e.right),p=Math.max(0,e.top),f=Math.min(l,e.bottom);if(0===n)for(s=p;s<f;s++)for(r=h;a[s]&&r<d;r++)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(1===n)for(s=p;s<f;s++)for(r=d;a[s]&&r>=h;r--)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(2===n)for(s=f;s>=p;s--)for(r=h;a[s]&&r<d;r++)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);else if(3===n)for(s=f;s>=p;s--)for(r=d;a[s]&&r>=h;r--)(o=a[s][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&i.push(o);return u.tilesDrawn=i.length,u.tilesTotal=c*l,i}},51710:(t,e,n)=>{var i=n(68234),r=n(60386),s=n(91181);t.exports=function(t,e,n,o,a){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===a&&(a=!0),Array.isArray(t)||(t=[t]);for(var c=0;c<t.length;c++)s(t[c],e,o);if(a)for(var l=0;l<o.height;l++)for(var u=0;u<o.width;u++){var h=o.data[l][u];h&&-1!==t.indexOf(h.index)&&i(h,e)}n&&r(0,0,o.width,o.height,o)}},15216:(t,e,n)=>{var i=n(68234),r=n(60386),s=n(91181);t.exports=function(t,e,n,o,a,c){if(void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===c&&(c=!0),!(t>e)){for(var l=t;l<=e;l++)s(l,n,a);if(c)for(var u=0;u<a.height;u++)for(var h=0;h<a.width;h++){var d=a.data[u][h];d&&d.index>=t&&d.index<=e&&i(d,n)}o&&r(0,0,a.width,a.height,a)}}},33158:(t,e,n)=>{var i=n(68234),r=n(60386),s=n(91181);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0),Array.isArray(t)||(t=[t]);for(var a=0;a<o.height;a++)for(var c=0;c<o.width;c++){var l=o.data[a][c];l&&-1===t.indexOf(l.index)&&(i(l,e),s(l.index,e,o))}n&&r(0,0,o.width,o.height,o)}},4180:(t,e,n)=>{var i=n(68234),r=n(60386),s=n(19256);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0);for(var a=0;a<o.height;a++)for(var c=0;c<o.width;c++){var l=o.data[a][c];if(l)for(var u in t)if(s(l.properties,u)){var h=t[u];Array.isArray(h)||(h=[h]);for(var d=0;d<h.length;d++)l.properties[u]===h[d]&&i(l,e)}}n&&r(0,0,o.width,o.height,o)}},18625:(t,e,n)=>{var i=n(68234),r=n(60386);t.exports=function(t,e,n){void 0===t&&(t=!0),void 0===e&&(e=!0);for(var s=0;s<n.height;s++)for(var o=0;o<n.width;o++){var a=n.data[s][o];if(a){var c=a.getCollisionGroup();c&&c.objects&&c.objects.length>0&&i(a,t)}}e&&r(0,0,n.width,n.height,n)}},91181:t=>{t.exports=function(t,e,n){var i=n.collideIndexes.indexOf(t);e&&-1===i?n.collideIndexes.push(t):e||-1===i||n.collideIndexes.splice(i,1)}},68234:t=>{t.exports=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)}},11628:t=>{t.exports=function(t,e,n,i){if("number"===typeof t)i.callbacks[t]=null!==e?{callback:e,callbackContext:n}:void 0;else for(var r=0,s=t.length;r<s;r++)i.callbacks[t[r]]=null!==e?{callback:e,callbackContext:n}:void 0}},72732:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a){for(var c=i(t,e,n,r,null,a),l=0;l<c.length;l++)c[l].setCollisionCallback(s,o)}},34397:(t,e,n)=>{var i=n(50811),r=n(18592);t.exports=function(t,e,n,s,o){var a=i(t,e,n,s,null,o),c=a.map((function(t){return t.index}));r(c);for(var l=0;l<a.length;l++)a[l].index=c[l]}},53945:(t,e,n)=>{var i=n(82127),r=n(84314);t.exports=function(t,e){var n=t.tilemapLayer.tilemap,s=t.tilemapLayer,o=Math.floor(n.tileWidth*s.scaleX),a=Math.floor(n.tileHeight*s.scaleY);return{left:r(e.worldView.x-s.x,o,0,!0)-s.cullPaddingX,right:i(e.worldView.right-s.x,o,0,!0)+s.cullPaddingX,top:r(e.worldView.y-s.y,a/2,0,!0)-s.cullPaddingY,bottom:i(e.worldView.bottom-s.y,a/2,0,!0)+s.cullPaddingY}}},19242:(t,e,n)=>{var i=n(53945),r=n(6987);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o=t.tilemapLayer,a=i(t,e);return o.skipCull&&1===o.scrollFactorX&&1===o.scrollFactorY&&(a.left=0,a.right=t.width,a.top=0,a.bottom=t.height),r(t,a,s,n),n}},33388:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s){n||(n=new i);var o=s.baseTileWidth,a=s.baseTileHeight,c=s.tilemapLayer,l=0,u=0;c&&(r||(r=c.scene.cameras.main),l=c.x+r.scrollX*(1-c.scrollFactorX),o*=c.scaleX,u=c.y+r.scrollY*(1-c.scrollFactorY),a*=c.scaleY);var h=l+t*o+e%2*(o/2),d=u+e*(a/2);return n.set(h,d)}},84132:t=>{t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;return r&&(void 0===e&&(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY),s+t*(i/2)+i}},90562:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s,o){r||(r=new i);var a=o.baseTileWidth,c=o.baseTileHeight,l=o.tilemapLayer;l&&(s||(s=l.scene.cameras.main),e-=l.y+s.scrollY*(1-l.scrollFactorY),c*=l.scaleY,t-=l.x+s.scrollX*(1-l.scrollFactorX),a*=l.scaleX);var u=n?Math.floor(e/(c/2)):e/(c/2),h=n?Math.floor((t+u%2*.5*a)/a):(t+u%2*.5*a)/a;return r.set(h,u)}},3689:t=>{t.exports=function(t,e,n,i){var r=i.baseTileHeight,s=i.tilemapLayer;return s&&(n||(n=s.scene.cameras.main),t-=s.y+n.scrollY*(1-s.scrollFactorY),r*=s.scaleY),e?Math.floor(t/(r/2)):t/(r/2)}},55217:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o,a){for(var c=i(n,r,s,o,null,a),l=0;l<c.length;l++)c[l]&&(c[l].index===t?c[l].index=e:c[l].index===e&&(c[l].index=t))}},44150:t=>{t.exports=function(t,e,n){var i=n.baseTileWidth,r=n.tilemapLayer,s=0;return r&&(e||(e=r.scene.cameras.main),s=r.x+e.scrollX*(1-r.scrollFactorX),i*=r.scaleX),s+t*i}},46836:(t,e,n)=>{var i=n(44150),r=n(42477),s=n(93736);t.exports=function(t,e,n,o,a){return n||(n=new s(0,0)),n.x=i(t,o,a),n.y=r(e,o,a),n}},42477:t=>{t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;return r&&(e||(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY),s+t*i}},39677:(t,e,n)=>{var i=n(50811);t.exports=function(t,e,n,r,s,o){if(s){var a,c=i(t,e,n,r,null,o),l=0;for(a=0;a<s.length;a++)l+=s[a].weight;if(!(l<=0))for(a=0;a<c.length;a++){for(var u=Math.random()*l,h=0,d=-1,p=0;p<s.length;p++)if(u<=(h+=s[p].weight)){var f=s[p].index;d=Array.isArray(f)?f[Math.floor(Math.random()*f.length)]:f;break}c[a].index=d}}}},806:(t,e,n)=>{var i=n(45676),r=new(n(93736));t.exports=function(t,e,n,s){return i(t,0,e,r,n,s),r.x}},45676:(t,e,n)=>{var i=n(93736);t.exports=function(t,e,n,r,s,o){void 0===n&&(n=!0),r||(r=new i);var a=o.baseTileWidth,c=o.baseTileHeight,l=o.tilemapLayer;l&&(s||(s=l.scene.cameras.main),t-=l.x+s.scrollX*(1-l.scrollFactorX),e-=l.y+s.scrollY*(1-l.scrollFactorY),a*=l.scaleX,c*=l.scaleY);var u=t/a,h=e/c;return n&&(u=Math.floor(u),h=Math.floor(h)),r.set(u,h)}},70520:(t,e,n)=>{var i=n(45676),r=new(n(93736));t.exports=function(t,e,n,s){return i(0,t,e,r,n,s),r.y}},5047:(t,e,n)=>{t.exports={CalculateFacesAt:n(92839),CalculateFacesWithin:n(60386),CheckIsoBounds:n(13125),Copy:n(17347),CreateFromTiles:n(93604),CullBounds:n(71586),CullTiles:n(381),Fill:n(97734),FilterTiles:n(63555),FindByIndex:n(37982),FindTile:n(48297),ForEachTile:n(80916),GetCullTilesFunction:n(31493),GetTileAt:n(15494),GetTileAtWorldXY:n(24640),GetTileCorners:n(48495),GetTileCornersFunction:n(7160),GetTilesWithin:n(50811),GetTilesWithinShape:n(31674),GetTilesWithinWorldXY:n(44662),GetTileToWorldXFunction:n(16884),GetTileToWorldXYFunction:n(68182),GetTileToWorldYFunction:n(3752),GetWorldToTileXFunction:n(29296),GetWorldToTileXYFunction:n(32688),GetWorldToTileYFunction:n(74326),HasTileAt:n(46598),HasTileAtWorldXY:n(28654),HexagonalCullBounds:n(6358),HexagonalCullTiles:n(37524),HexagonalGetTileCorners:n(63634),HexagonalTileToWorldXY:n(21715),HexagonalWorldToTileXY:n(11516),IsInLayerBounds:n(62839),IsometricCullTiles:n(20887),IsometricTileToWorldXY:n(21808),IsometricWorldToTileXY:n(18750),PutTileAt:n(29003),PutTileAtWorldXY:n(48565),PutTilesAt:n(56547),Randomize:n(91180),RemoveTileAt:n(929),RemoveTileAtWorldXY:n(17384),RenderDebug:n(93763),ReplaceByIndex:n(51202),RunCull:n(6987),SetCollision:n(51710),SetCollisionBetween:n(15216),SetCollisionByExclusion:n(33158),SetCollisionByProperty:n(4180),SetCollisionFromCollisionGroup:n(18625),SetLayerCollisionIndex:n(91181),SetTileCollision:n(68234),SetTileIndexCallback:n(11628),SetTileLocationCallback:n(72732),Shuffle:n(34397),StaggeredCullBounds:n(53945),StaggeredCullTiles:n(19242),StaggeredTileToWorldXY:n(33388),StaggeredTileToWorldY:n(84132),StaggeredWorldToTileXY:n(90562),StaggeredWorldToTileY:n(3689),SwapByIndex:n(55217),TileToWorldX:n(44150),TileToWorldXY:n(46836),TileToWorldY:n(42477),WeightedRandomize:n(39677),WorldToTileX:n(806),WorldToTileXY:n(45676),WorldToTileY:n(70520)}},12920:t=>{t.exports={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3}},84758:(t,e,n)=>{var i={ORIENTATION:n(12920)};t.exports=i},52678:(t,e,n)=>{var i=n(98611),r=n(84758),s={Components:n(5047),Parsers:n(34124),Formats:n(93560),ImageCollection:n(97042),ParseToTilemap:n(15043),Tile:n(29633),Tilemap:n(89797),TilemapCreator:n(4843),TilemapFactory:n(37940),Tileset:n(47975),TilemapLayer:n(87177),Orientation:n(12920),LayerData:n(94990),MapData:n(16586),ObjectLayer:n(15256)};s=i(!1,s,r.ORIENTATION),t.exports=s},94990:(t,e,n)=>{var i=n(56694),r=n(12920),s=n(72632),o=new i({initialize:function(t){void 0===t&&(t={}),this.name=s(t,"name","layer"),this.id=s(t,"id",0),this.x=s(t,"x",0),this.y=s(t,"y",0),this.width=s(t,"width",0),this.height=s(t,"height",0),this.tileWidth=s(t,"tileWidth",0),this.tileHeight=s(t,"tileHeight",0),this.baseTileWidth=s(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=s(t,"baseTileHeight",this.tileHeight),this.orientation=s(t,"orientation",r.ORTHOGONAL),this.widthInPixels=s(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=s(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=s(t,"alpha",1),this.visible=s(t,"visible",!0),this.properties=s(t,"properties",[]),this.indexes=s(t,"indexes",[]),this.collideIndexes=s(t,"collideIndexes",[]),this.callbacks=s(t,"callbacks",[]),this.bodies=s(t,"bodies",[]),this.data=s(t,"data",[]),this.tilemapLayer=s(t,"tilemapLayer",null),this.hexSideLength=s(t,"hexSideLength",0),this.staggerAxis=s(t,"staggerAxis","y"),this.staggerIndex=s(t,"staggerIndex","odd")}});t.exports=o},16586:(t,e,n)=>{var i=n(56694),r=n(12920),s=n(72632),o=new i({initialize:function(t){void 0===t&&(t={}),this.name=s(t,"name","map"),this.width=s(t,"width",0),this.height=s(t,"height",0),this.infinite=s(t,"infinite",!1),this.tileWidth=s(t,"tileWidth",0),this.tileHeight=s(t,"tileHeight",0),this.widthInPixels=s(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=s(t,"heightInPixels",this.height*this.tileHeight),this.format=s(t,"format",null),this.orientation=s(t,"orientation",r.ORTHOGONAL),this.renderOrder=s(t,"renderOrder","right-down"),this.version=s(t,"version","1"),this.properties=s(t,"properties",{}),this.layers=s(t,"layers",[]),this.images=s(t,"images",[]),this.objects=s(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[]),this.collision=s(t,"collision",{}),this.tilesets=s(t,"tilesets",[]),this.imageCollections=s(t,"imageCollections",[]),this.tiles=s(t,"tiles",[]),this.hexSideLength=s(t,"hexSideLength",0),this.staggerAxis=s(t,"staggerAxis","y"),this.staggerIndex=s(t,"staggerIndex","odd")}});t.exports=o},15256:(t,e,n)=>{var i=n(56694),r=n(72632),s=new i({initialize:function(t){void 0===t&&(t={}),this.name=r(t,"name","object layer"),this.id=r(t,"id",0),this.opacity=r(t,"opacity",1),this.properties=r(t,"properties",{}),this.propertyTypes=r(t,"propertytypes",{}),this.type=r(t,"type","objectgroup"),this.visible=r(t,"visible",!0),this.objects=r(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[])}});t.exports=s},21394:(t,e,n)=>{var i=n(12920);t.exports=function(t){return"isometric"===(t=t.toLowerCase())?i.ISOMETRIC:"staggered"===t?i.STAGGERED:"hexagonal"===t?i.HEXAGONAL:i.ORTHOGONAL}},90715:(t,e,n)=>{var i=n(93560),r=n(84346),s=n(96097),o=n(2378),a=n(44909);t.exports=function(t,e,n,c,l,u){var h;switch(e){case i.ARRAY_2D:h=r(t,n,c,l,u);break;case i.CSV:h=s(t,n,c,l,u);break;case i.TILED_JSON:h=o(t,n,u);break;case i.WELTMEISTER:h=a(t,n,u);break;default:console.warn("Unrecognized tilemap data format: "+e),h=null}return h}},84346:(t,e,n)=>{var i=n(93560),r=n(94990),s=n(16586),o=n(29633);t.exports=function(t,e,n,a,c){for(var l=new r({tileWidth:n,tileHeight:a}),u=new s({name:t,tileWidth:n,tileHeight:a,format:i.ARRAY_2D,layers:[l]}),h=[],d=e.length,p=0,f=0;f<e.length;f++){h[f]=[];for(var m=e[f],g=0;g<m.length;g++){var v=parseInt(m[g],10);isNaN(v)||-1===v?h[f][g]=c?null:new o(l,-1,g,f,n,a):h[f][g]=new o(l,v,g,f,n,a)}0===p&&(p=m.length)}return u.width=l.width=p,u.height=l.height=d,u.widthInPixels=l.widthInPixels=p*n,u.heightInPixels=l.heightInPixels=d*a,l.data=h,u}},96097:(t,e,n)=>{var i=n(93560),r=n(84346);t.exports=function(t,e,n,s,o){var a=e.trim().split("\n").map((function(t){return t.split(",")})),c=r(t,a,n,s,o);return c.format=i.CSV,c}},30951:(t,e,n)=>{var i=n(94990),r=n(29633);t.exports=function(t,e){for(var n=[],s=0;s<t.layer.length;s++){for(var o=t.layer[s],a=new i({name:o.name,width:o.width,height:o.height,tileWidth:o.tilesize,tileHeight:o.tilesize,visible:1===o.visible}),c=[],l=[],u=0;u<o.data.length;u++){for(var h=0;h<o.data[u].length;h++){var d,p=o.data[u][h]-1;d=p>-1?new r(a,p,h,u,o.tilesize,o.tilesize):e?null:new r(a,-1,h,u,o.tilesize,o.tilesize),c.push(d)}l.push(c),c=[]}a.data=l,n.push(a)}return n}},47488:(t,e,n)=>{var i=n(47975);t.exports=function(t){for(var e=[],n=[],r=0;r<t.layer.length;r++){var s=t.layer[r],o=s.tilesetName;""!==o&&-1===n.indexOf(o)&&(n.push(o),e.push(new i(o,0,s.tilesize,s.tilesize,0,0)))}return e}},44909:(t,e,n)=>{var i=n(93560),r=n(16586),s=n(30951),o=n(47488);t.exports=function(t,e,n){if(0===e.layer.length)return console.warn("No layers found in the Weltmeister map: "+t),null;for(var a=0,c=0,l=0;l<e.layer.length;l++)e.layer[l].width>a&&(a=e.layer[l].width),e.layer[l].height>c&&(c=e.layer[l].height);var u=new r({width:a,height:c,name:t,tileWidth:e.layer[0].tilesize,tileHeight:e.layer[0].tilesize,format:i.WELTMEISTER});return u.layers=s(e,n),u.tilesets=o(e),u}},24507:(t,e,n)=>{t.exports={ParseTileLayers:n(30951),ParseTilesets:n(47488),ParseWeltmeister:n(44909)}},34124:(t,e,n)=>{t.exports={FromOrientationString:n(21394),Parse:n(90715),Parse2DArray:n(84346),ParseCSV:n(96097),Impact:n(24507),Tiled:n(50044)}},48646:(t,e,n)=>{var i=n(98611);t.exports=function(t){for(var e,n,r,s,o,a=0;a<t.layers.length;a++){e=t.layers[a],s=null;for(var c=0;c<e.data.length;c++){o=e.data[c];for(var l=0;l<o.length;l++)null===(n=o[l])||n.index<0||(r=t.tiles[n.index][2],s=t.tilesets[r],n.width=s.tileWidth,n.height=s.tileHeight,s.tileProperties&&s.tileProperties[n.index-s.firstgid]&&(n.properties=i(n.properties,s.tileProperties[n.index-s.firstgid])))}}}},43908:t=>{t.exports=function(t){for(var e=window.atob(t),n=e.length,i=new Array(n/4),r=0;r<n;r+=4)i[r/4]=(e.charCodeAt(r)|e.charCodeAt(r+1)<<8|e.charCodeAt(r+2)<<16|e.charCodeAt(r+3)<<24)>>>0;return i}},14556:(t,e,n)=>{var i=n(47975);t.exports=function(t){var e,n,r=[];for(e=0;e<t.imageCollections.length;e++)for(var s=t.imageCollections[e],o=s.images,a=0;a<o.length;a++){var c=o[a];(n=new i(c.image,c.gid,s.imageWidth,s.imageHeight,0,0)).updateTileData(s.imageWidth,s.imageHeight),t.tilesets.push(n)}for(e=0;e<t.tilesets.length;e++)for(var l=(n=t.tilesets[e]).tileMargin,u=n.tileMargin,h=0,d=0,p=0,f=n.firstgid;f<n.firstgid+n.total&&(r[f]=[l,u,e],l+=n.tileWidth+n.tileSpacing,++h!==n.total)&&(++d!==n.columns||(l=n.tileMargin,u+=n.tileHeight+n.tileSpacing,d=0,++p!==n.rows));f++);return r}},92044:(t,e,n)=>{var i=n(72632);t.exports=function(t,e,n){if(!e)return{i:0,layers:t.layers,name:"",opacity:1,visible:!0,x:0,y:0};var r=e.x+i(e,"startx",0)*t.tilewidth+i(e,"offsetx",0),s=e.y+i(e,"starty",0)*t.tileheight+i(e,"offsety",0);return{i:0,layers:e.layers,name:n.name+e.name+"/",opacity:n.opacity*e.opacity,visible:n.visible&&e.visible,x:n.x+r,y:n.y+s}}},8847:t=>{var e=2147483648,n=1073741824,i=536870912;t.exports=function(t){var r=Boolean(t&e),s=Boolean(t&n),o=Boolean(t&i);t&=536870911;var a=0,c=!1;return r&&s&&o?(a=Math.PI/2,c=!0):r&&s&&!o?(a=Math.PI,c=!1):r&&!s&&o?(a=Math.PI/2,c=!1):!r||s||o?!r&&s&&o?(a=3*Math.PI/2,c=!1):r||!s||o?r||s||!o?r||s||o||(a=0,c=!1):(a=3*Math.PI/2,c=!0):(a=Math.PI,c=!0):(a=0,c=!0),{gid:t,flippedHorizontal:r,flippedVertical:s,flippedAntiDiagonal:o,rotation:a,flipped:c}}},78339:(t,e,n)=>{var i=n(72632),r=n(92044);t.exports=function(t){for(var e=[],n=[],s=r(t);s.i<s.layers.length||n.length>0;)if(s.i>=s.layers.length){if(n.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}s=n.pop()}else{var o=s.layers[s.i];if(s.i++,"imagelayer"===o.type){var a=i(o,"offsetx",0)+i(o,"startx",0),c=i(o,"offsety",0)+i(o,"starty",0);e.push({name:s.name+o.name,image:o.image,x:s.x+a+o.x,y:s.y+c+o.y,alpha:s.opacity*o.opacity,visible:s.visible&&o.visible,properties:i(o,"properties",{})})}else if("group"===o.type){var l=r(t,o,s);n.push(s),s=l}}return e}},2378:(t,e,n)=>{var i=n(48646),r=n(14556),s=n(12920),o=n(28699),a=n(93560),c=n(21394),l=n(16586),u=n(78339),h=n(61136),d=n(95925),p=n(93392);t.exports=function(t,e,n){var f=o(e),m=new l({width:f.width,height:f.height,name:t,tileWidth:f.tilewidth,tileHeight:f.tileheight,orientation:c(f.orientation),format:a.TILED_JSON,version:f.version,properties:f.properties,renderOrder:f.renderorder,infinite:f.infinite});m.orientation===s.HEXAGONAL&&(m.hexSideLength=f.hexsidelength,m.staggerAxis=f.staggeraxis,m.staggerIndex=f.staggerindex),m.layers=d(f,n),m.images=u(f);var g=p(f);return m.tilesets=g.tilesets,m.imageCollections=g.imageCollections,m.objects=h(f),m.tiles=r(m),i(m),m}},4281:(t,e,n)=>{var i=n(28820),r=n(8847),s=function(t){return{x:t.x,y:t.y}},o=["id","name","type","rotation","properties","visible","x","y","width","height"];t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);var a=i(t,o);if(a.x+=e,a.y+=n,t.gid){var c=r(t.gid);a.gid=c.gid,a.flippedHorizontal=c.flippedHorizontal,a.flippedVertical=c.flippedVertical,a.flippedAntiDiagonal=c.flippedAntiDiagonal}else t.polyline?a.polyline=t.polyline.map(s):t.polygon?a.polygon=t.polygon.map(s):t.ellipse?a.ellipse=t.ellipse:t.text?a.text=t.text:t.point?a.point=!0:a.rectangle=!0;return a}},61136:(t,e,n)=>{var i=n(72632),r=n(4281),s=n(15256),o=n(92044);t.exports=function(t){for(var e=[],n=[],a=o(t);a.i<a.layers.length||n.length>0;)if(a.i>=a.layers.length){if(n.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}a=n.pop()}else{var c=a.layers[a.i];if(a.i++,c.opacity*=a.opacity,c.visible=a.visible&&c.visible,"objectgroup"===c.type){c.name=a.name+c.name;for(var l=a.x+i(c,"startx",0)+i(c,"offsetx",0),u=a.y+i(c,"starty",0)+i(c,"offsety",0),h=[],d=0;d<c.objects.length;d++){var p=r(c.objects[d],l,u);h.push(p)}var f=new s(c);f.objects=h,e.push(f)}else if("group"===c.type){var m=o(t,c,a);n.push(a),a=m}}return e}},95925:(t,e,n)=>{var i=n(43908),r=n(12920),s=n(92044),o=n(21394),a=n(72632),c=n(94990),l=n(8847),u=n(29633);t.exports=function(t,e){for(var n=a(t,"infinite",!1),h=[],d=[],p=s(t);p.i<p.layers.length||d.length>0;)if(p.i>=p.layers.length){if(d.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}p=d.pop()}else{var f=p.layers[p.i];if(p.i++,"tilelayer"===f.type)if(f.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+f.name+"'");else{if(f.encoding&&"base64"===f.encoding){if(f.chunks)for(var m=0;m<f.chunks.length;m++)f.chunks[m].data=i(f.chunks[m].data);f.data&&(f.data=i(f.data)),delete f.encoding}var g,v,y,x,b=[],w=0;if(n){var S=a(f,"startx",0)+f.x,_=a(f,"starty",0)+f.y;(g=new c({name:p.name+f.name,id:f.id,x:p.x+a(f,"offsetx",0)+S*t.tilewidth,y:p.y+a(f,"offsety",0)+_*t.tileheight,width:f.width,height:f.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:p.opacity*f.opacity,visible:p.visible&&f.visible,properties:a(f,"properties",[]),orientation:o(t.orientation)})).orientation===r.HEXAGONAL&&(g.hexSideLength=t.hexsidelength,g.staggerAxis=t.staggeraxis,g.staggerIndex=t.staggerindex);for(var T=0;T<f.height;T++){b[T]=[null];for(var E=0;E<f.width;E++)b[T][E]=null}for(T=0,F=f.chunks.length;T<F;T++)for(var C=f.chunks[T],k=C.x-S,A=C.y-_,I=0,O=0,R=C.data.length;O<R;O++){var N=w+k,M=I+A;(v=l(C.data[O])).gid>0?((y=new u(g,v.gid,N,M,t.tilewidth,t.tileheight)).rotation=v.rotation,y.flipX=v.flipped,b[M][N]=y):(x=e?null:new u(g,-1,N,M,t.tilewidth,t.tileheight),b[M][N]=x),++w===C.width&&(I++,w=0)}}else{(g=new c({name:p.name+f.name,id:f.id,x:p.x+a(f,"offsetx",0)+f.x,y:p.y+a(f,"offsety",0)+f.y,width:f.width,height:f.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:p.opacity*f.opacity,visible:p.visible&&f.visible,properties:a(f,"properties",[]),orientation:o(t.orientation)})).orientation===r.HEXAGONAL&&(g.hexSideLength=t.hexsidelength,g.staggerAxis=t.staggeraxis,g.staggerIndex=t.staggerindex);for(var D=[],P=0,F=f.data.length;P<F;P++)(v=l(f.data[P])).gid>0?((y=new u(g,v.gid,w,b.length,t.tilewidth,t.tileheight)).rotation=v.rotation,y.flipX=v.flipped,D.push(y)):(x=e?null:new u(g,-1,w,b.length,t.tilewidth,t.tileheight),D.push(x)),++w===f.width&&(b.push(D),w=0,D=[])}g.data=b,h.push(g)}else if("group"===f.type){var L=s(t,f,p);d.push(p),p=L}}return h}},93392:(t,e,n)=>{var i=n(47975),r=n(97042),s=n(4281),o=n(39642);t.exports=function(t){for(var e,n=[],a=[],c=null,l=0;l<t.tilesets.length;l++){var u=t.tilesets[l];if(u.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(u.image){var h=new i(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,void 0,void 0,u.tileoffset);if(t.version>1){var d=void 0,p=void 0;if(Array.isArray(u.tiles)){d=d||{},p=p||{};for(var f=0;f<u.tiles.length;f++){var m=u.tiles[f];if(m.properties){var g={};m.properties.forEach((function(t){g[t.name]=t.value})),p[m.id]=g}if(m.objectgroup&&((d[m.id]||(d[m.id]={})).objectgroup=m.objectgroup,m.objectgroup.objects)){var v=m.objectgroup.objects.map((function(t){return s(t)}));d[m.id].objectgroup.objects=v}m.animation&&((d[m.id]||(d[m.id]={})).animation=m.animation),m.type&&((d[m.id]||(d[m.id]={})).type=m.type)}}Array.isArray(u.wangsets)&&(d=d||{},p=p||{},o(u.wangsets,d)),d&&(h.tileData=d,h.tileProperties=p)}else if(u.tileproperties&&(h.tileProperties=u.tileproperties),u.tiles)for(e in h.tileData=u.tiles,h.tileData){var y=h.tileData[e].objectgroup;if(y&&y.objects){var x=y.objects.map((function(t){return s(t)}));h.tileData[e].objectgroup.objects=x}}h.updateTileData(u.imagewidth,u.imageheight),n.push(h)}else{var b=new r(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,u.properties),w=0;for(f=0;f<u.tiles.length;f++){var S=(m=u.tiles[f]).image,_=parseInt(m.id,10),T=u.firstgid+_;b.addImage(T,S),w=Math.max(_,w)}b.maxId=w,a.push(b)}c&&(c.lastgid=u.firstgid-1),c=u}return{tilesets:n,imageCollections:a}}},39642:t=>{t.exports=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=n;if(i.name&&""!==i.name&&(r=i.name),Array.isArray(i.wangtiles)&&i.wangtiles.length>0){var s,o,a,c={},l={};if(Array.isArray(i.edgecolors))for(s=0;s<i.edgecolors.length;s++)a=1+s,""!==(o=i.edgecolors[s]).name&&(c[a]=o.name);if(Array.isArray(i.cornercolors))for(s=0;s<i.cornercolors.length;s++)a=1+s,""!==(o=i.cornercolors[s]).name&&(l[a]=o.name);if(Array.isArray(i.colors))for(s=0;s<i.colors.length;s++)a=1+s,""!==(o=i.colors[s]).name&&(c[a]=l[a]=o.name);for(var u=[c,l,c,l,c,l,c,l],h=0;h<i.wangtiles.length;h++){var d=i.wangtiles[h],p=e[d.tileid]||(e[d.tileid]={});p=p.wangid||(p.wangid={});for(var f=[],m=0;m<Math.min(u.length,d.wangid.length);m++)if(0!==(o=d.wangid[m])){var g=u[m][o];void 0===g?f.push(o):f.push(g)}else f.push(void 0);p[r]=f}}}}},50044:(t,e,n)=>{t.exports={AssignTileProperties:n(48646),Base64Decode:n(43908),BuildTilesetIndex:n(14556),CreateGroupLayer:n(92044),ParseGID:n(8847),ParseImageLayers:n(78339),ParseJSONTiled:n(2378),ParseObject:n(4281),ParseObjectLayers:n(61136),ParseTileLayers:n(95925),ParseTilesets:n(93392)}},73779:(t,e,n)=>{var i=n(56694),r=n(91963),s=n(7599),o=n(57911),a=n(66458),c=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(s.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var t=this.systems.events;t.on(s.PRE_UPDATE,this.preUpdate,this),t.on(s.UPDATE,this.update,this),t.once(s.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;return t instanceof o?(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=-1===e.repeat||e.loop?999999999999:e.repeat):e=new o(t),this._pendingInsertion.push(e),e},delayedCall:function(t,e,n,i){return this.addEvent({delay:t,callback:e,args:n,callbackScope:i})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];a(this._pendingRemoval,n),a(this._pendingInsertion,n),a(this._active,n)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var n,i;for(n=0;n<t;n++){i=this._pendingRemoval[n];var r=this._active.indexOf(i);r>-1&&this._active.splice(r,1),i.destroy()}for(n=0;n<e;n++)i=this._pendingInsertion[n],this._active.push(i);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var n=0;n<this._active.length;n++){var i=this._active[n];if(!i.paused&&(i.elapsed+=e*i.timeScale,i.elapsed>=i.delay)){var r=i.elapsed-i.delay;if(i.elapsed=i.delay,!i.hasDispatched&&i.callback&&(i.hasDispatched=!0,i.callback.apply(i.callbackScope,i.args)),i.repeatCount>0){if(i.repeatCount--,r>=i.delay)for(;r>=i.delay&&i.repeatCount>0;)i.callback&&i.callback.apply(i.callbackScope,i.args),r-=i.delay,i.repeatCount--;i.elapsed=r,i.hasDispatched=!1}else i.hasDispatched&&this._pendingRemoval.push(i)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(s.PRE_UPDATE,this.preUpdate,this),e.off(s.UPDATE,this.update,this),e.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null}});r.register("Clock",c,"time"),t.exports=c},20517:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(61286),o=n(72632),a=n(7599),c=n(52944),l=new i({Extends:r,initialize:function(t,e){r.call(this),this.scene=t,this.systems=t.sys,this.elapsed=0,this.paused=!0,this.complete=!1,this.totalComplete=0,this.events=[];var n=this.systems.events;n.on(a.PRE_UPDATE,this.preUpdate,this),n.on(a.UPDATE,this.update,this),n.once(a.SHUTDOWN,this.destroy,this),e&&this.add(e)},preUpdate:function(t,e){this.paused||(this.elapsed+=e)},update:function(){if(!this.paused&&!this.complete){var t,e,n=this.events,i=!1,r=this.systems;for(t=0;t<n.length;t++){var s=n[t];if(!s.complete&&s.time<=this.elapsed){if(s.complete=!0,this.totalComplete++,e=s.target?s.target:this,s.if&&!s.if.call(e,s))continue;if(s.once&&(i=!0),s.set&&s.target)for(var o in s.set)s.target[o]=s.set[o];s.tween&&r.tweens.add(s.tween),s.sound&&("string"===typeof s.sound?r.sound.play(s.sound):r.sound.play(s.sound.key,s.sound.config)),s.event&&this.emit(s.event,e),s.run&&s.run.call(e),s.stop&&this.stop()}}if(i)for(t=0;t<n.length;t++)n[t].complete&&n[t].once&&(n.splice(t,1),t--);this.totalComplete>=n.length&&(this.complete=!0),this.complete&&this.emit(c.COMPLETE,this)}},play:function(t){return void 0===t&&(t=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,t&&this.reset(),this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(){this.elapsed=0;for(var t=0;t<this.events.length;t++)this.events[t].complete=!1;return this.play(!1)},add:function(t){Array.isArray(t)||(t=[t]);var e=this.events,n=0;e.length>0&&(n=e[e.length-1].time);for(var i=0;i<t.length;i++){var r=t[i],s=o(r,"at",0),a=o(r,"in",null);null!==a&&(s=this.elapsed+a);var c=o(r,"from",null);null!==c&&(s=n+c),e.push({complete:!1,time:s,if:o(r,"if",null),run:o(r,"run",null),event:o(r,"event",null),target:o(r,"target",null),set:o(r,"set",null),tween:o(r,"tween",null),sound:o(r,"sound",null),once:o(r,"once",!1),stop:o(r,"stop",!1)}),n=s}return this.complete=!1,this},clear:function(){return this.events=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){return Math.min(this.totalComplete,this.events.length)/this.events.length},destroy:function(){var t=this.systems.events;t.off(a.PRE_UPDATE,this.preUpdate,this),t.off(a.UPDATE,this.update,this),t.off(a.SHUTDOWN,this.destroy,this),this.scene=null,this.systems=null,this.events=[]}});s.register("timeline",(function(t){return new l(this.scene,t)})),t.exports=l},57911:(t,e,n)=>{var i=n(56694),r=n(72632),s=new i({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){if(this.delay=r(t,"delay",0),this.repeat=r(t,"repeat",0),this.loop=r(t,"loop",!1),this.callback=r(t,"callback",void 0),this.callbackScope=r(t,"callbackScope",this),this.args=r(t,"args",[]),this.timeScale=r(t,"timeScale",1),this.startAt=r(t,"startAt",0),this.paused=r(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,0===this.delay&&(this.repeat>0||this.loop))throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/t}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});t.exports=s},12144:t=>{t.exports="complete"},52944:(t,e,n)=>{t.exports={COMPLETE:n(12144)}},97121:(t,e,n)=>{t.exports={Clock:n(73779),Events:n(52944),Timeline:n(20517),TimerEvent:n(57911)}},64532:(t,e,n)=>{var i=n(66458),r=n(56694),s=n(5454),o=n(68710),a=n(91963),c=n(7599),l=n(91944),u=n(39366),h=n(68061),d=n(45641),p=n(56034),f=new r({initialize:function(t){this.scene=t,this.events=t.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(c.BOOT,this.boot,this),this.events.on(c.START,this.start,this)},boot:function(){this.events.once(c.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(c.UPDATE,this.update,this),this.events.once(c.SHUTDOWN,this.shutdown,this)},create:function(t){Array.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++){var i=t[n];i instanceof u||i instanceof d?e.push(i):Array.isArray(i.tweens)?e.push(p(this,i)):e.push(h(this,i))}return 1===e.length?e[0]:e},add:function(t){var e=t,n=this.tweens;return e instanceof u||e instanceof d||(e=Array.isArray(e.tweens)?p(this,e):h(this,e)),n.push(e.reset()),e},addMultiple:function(t){for(var e,n=[],i=this.tweens,r=0;r<t.length;r++)(e=t[r])instanceof u||e instanceof d||(e=Array.isArray(e.tweens)?p(this,e):h(this,e)),i.push(e.reset()),n.push(e);return n},chain:function(t){var e=p(this,t);return this.tweens.push(e.init()),e},getChainedTweens:function(t){return t.getChainedTweens()},has:function(t){return this.tweens.indexOf(t)>-1},existing:function(t){return this.has(t)||this.tweens.push(t.reset()),this},addCounter:function(t){var e=o(this,t);return this.tweens.push(e.reset()),e},stagger:function(t,e){return l(t,e)},setLagSmooth:function(t,e){return void 0===t&&(t=1/1e-8),void 0===e&&(e=0),this.maxLag=t,this.lagSkip=Math.min(e,this.maxLag),this},setFps:function(t){return void 0===t&&(t=240),this.gap=1e3/t,this.nextTime=1e3*this.time+this.gap,this},getDelta:function(t){var e=Date.now()-this.prevTime;e>this.maxLag&&(this.startTime+=e-this.lagSkip),this.prevTime+=e;var n=this.prevTime-this.startTime,i=n-this.nextTime,r=n-1e3*this.time;return i>0||t?(n/=1e3,this.time=n,this.nextTime+=i+(i>=this.gap?4:this.gap-i)):r=0,r},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(t){void 0===t&&(t=!1);var e=this.getDelta(t);if(!(e<=0)){var n,i;this.processing=!0;var r=[],s=this.tweens;for(n=0;n<s.length;n++)(i=s[n]).update(e)&&r.push(i);var o=r.length;if(o&&s.length>0){for(n=0;n<o;n++){i=r[n];var a=s.indexOf(i);a>-1&&(i.isPendingRemove()||i.isDestroyed())&&(s.splice(a,1),i.destroy())}r.length=0}this.processing=!1}},remove:function(t){return this.processing?t.setPendingRemoveState():(i(this.tweens,t),t.setRemovedState()),this},reset:function(t){return this.existing(t),t.seek(),t.setActiveState(),this},makeActive:function(t){return this.existing(t),t.setActiveState(),this},each:function(t,e){var n,i=[null];for(n=1;n<arguments.length;n++)i.push(arguments[n]);return this.tweens.forEach((function(n){i[0]=n,t.apply(e,i)})),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(t){for(var e=[],n=this.tweens,i=(t=Array.isArray(t)?s(t):[t]).length,r=0;r<n.length;r++)for(var o=n[r],a=0;a<i;a++)!o.isDestroyed()&&o.hasTarget(t[a])&&e.push(o);return e},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(t){return this.timeScale=t,this},isTweening:function(t){for(var e,n=this.tweens,i=0;i<n.length;i++)if((e=n[i]).isPlaying()&&e.hasTarget(t))return!0;return!1},killAll:function(){for(var t=this.processing?this.getTweens():this.tweens,e=0;e<t.length;e++)t[e].destroy();return this.processing||(t.length=0),this},killTweensOf:function(t){for(var e=this.getTweensOf(t),n=0;n<e.length;n++)e[n].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(c.UPDATE,this.update,this),this.events.off(c.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(c.START,this.start,this),this.scene=null,this.events=null}});a.register("TweenManager",f,"tweens"),t.exports=f},63130:t=>{t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},21902:(t,e,n)=>{var i=n(35060),r=n(40587);t.exports=function(t,e){var n=i.Power0;if("string"===typeof t)if(i.hasOwnProperty(t))n=i[t];else{var s="";if(t.indexOf(".")){var o=(s=t.substring(t.indexOf(".")+1)).toLowerCase();"in"===o?s="easeIn":"out"===o?s="easeOut":"inout"===o&&(s="easeInOut")}t=r(t.substring(0,t.indexOf(".")+1)+s),i.hasOwnProperty(t)&&(n=i[t])}else"function"===typeof t&&(n=t);if(!e)return n;var a=e.slice(0);return a.unshift(0),function(t){return a[0]=t,n.apply(this,a)}}},4840:(t,e,n)=>{var i=n(63210),r=n(88332),s={bezier:i,catmull:r,catmullrom:r,linear:n(47614)};t.exports=function(t){if(null===t)return null;var e=s.linear;return"string"===typeof t?s.hasOwnProperty(t)&&(e=s[t]):"function"===typeof t&&(e=t),e}},28348:t=>{t.exports=function(t,e,n){return t.hasOwnProperty(e)?"function"===typeof t[e]?function(n,i,r,s,o,a){return t[e](n,i,r,s,o,a)}:function(){return t[e]}:"function"===typeof n?n:function(){return n}}},92407:(t,e,n)=>{var i=n(53709);t.exports=function(t){var e,n=[];if(t.hasOwnProperty("props"))for(e in t.props)"_"!==e.substring(0,1)&&n.push({key:e,value:t.props[e]});else for(e in t)-1===i.indexOf(e)&&"_"!==e.substring(0,1)&&n.push({key:e,value:t[e]});return n}},65868:(t,e,n)=>{var i=n(10850);t.exports=function(t){var e=i(t,"targets",null);return null===e||("function"===typeof e&&(e=e.call()),Array.isArray(e)||(e=[e])),e}},9744:(t,e,n)=>{var i=n(17489),r=n(61616);function s(t){return!!t.getActive&&"function"===typeof t.getActive}function o(t){return!!t.getStart&&"function"===typeof t.getStart}function a(t){return!!t.getEnd&&"function"===typeof t.getEnd}var c=function(t,e){var n,l,u=function(t,e,n){return n},h=function(t,e,n){return n},d=null,p=typeof e;if("number"===p)u=function(){return e};else if(Array.isArray(e))h=function(){return e[0]},u=function(){return e[e.length-1]};else if("string"===p){var f=e.toLowerCase(),m="random"===f.substring(0,6),g="int"===f.substring(0,3);if(m||g){var v=f.indexOf("("),y=f.indexOf(")"),x=f.indexOf(",");if(!(v&&y&&x))throw new Error("invalid random() format");var b=parseFloat(f.substring(v+1,x)),w=parseFloat(f.substring(x+1,y));u=m?function(){return r(b,w)}:function(){return i(b,w)}}else{f=f[0];var S=parseFloat(e.substr(2));switch(f){case"+":u=function(t,e,n){return n+S};break;case"-":u=function(t,e,n){return n-S};break;case"*":u=function(t,e,n){return n*S};break;case"/":u=function(t,e,n){return n/S};break;default:u=function(){return parseFloat(e)}}}}else if("function"===p)u=e;else if("object"===p)if(o(l=e)||a(l)||s(l))s(e)&&(d=e.getActive),a(e)&&(u=e.getEnd),o(e)&&(h=e.getStart);else if(e.hasOwnProperty("value"))n=c(t,e.value);else{var _=e.hasOwnProperty("to"),T=e.hasOwnProperty("from"),E=e.hasOwnProperty("start");if(_&&(T||E)){if(n=c(t,e.to),E){var C=c(t,e.start);n.getActive=C.getEnd}if(T){var k=c(t,e.from);n.getStart=k.getEnd}}}return n||(n={getActive:d,getEnd:u,getStart:h}),n};t.exports=c},68710:(t,e,n)=>{var i=n(502),r=n(99730),s=n(20494),o=n(63130),a=n(21902),c=n(28348),l=n(10850),u=n(9744),h=n(72066),d=n(39366);t.exports=function(t,e,n){if(e instanceof d)return e.parent=t,e;n=void 0===n?r:h(r,n);var p=l(e,"from",0),f=l(e,"to",1),m=[{value:p}],g=l(e,"delay",n.delay),v=l(e,"easeParams",n.easeParams),y=l(e,"ease",n.ease),x=u("value",f),b=new d(t,m),w=b.add(0,"value",x.getEnd,x.getStart,x.getActive,a(l(e,"ease",y),l(e,"easeParams",v)),c(e,"delay",g),l(e,"duration",n.duration),o(e,"yoyo",n.yoyo),l(e,"hold",n.hold),l(e,"repeat",n.repeat),l(e,"repeatDelay",n.repeatDelay),!1,!1);w.start=p,w.current=p,b.completeDelay=s(e,"completeDelay",0),b.loop=Math.round(s(e,"loop",0)),b.loopDelay=Math.round(s(e,"loopDelay",0)),b.paused=o(e,"paused",!1),b.persist=o(e,"persist",!1),b.callbackScope=l(e,"callbackScope",b);for(var S=i.TYPES,_=0;_<S.length;_++){var T=S[_],E=l(e,T,!1);if(E){var C=l(e,T+"Params",[]);b.setCallback(T,E,C)}}return b}},91944:(t,e,n)=>{var i=n(21902),r=n(10850),s=n(83392);t.exports=function(t,e){var n;void 0===e&&(e={});var o=r(e,"start",0),a=r(e,"ease",null),c=r(e,"grid",null),l=r(e,"from",0),u="first"===l,h="center"===l,d="last"===l,p="number"===typeof l,f=Array.isArray(t),m=f?parseFloat(t[0]):parseFloat(t),g=f?parseFloat(t[1]):0,v=Math.max(m,g);if(f&&(o+=m),c){var y=c[0],x=c[1],b=0,w=0,S=0,_=0,T=[];d?(b=y-1,w=x-1):p?(b=l%y,w=Math.floor(l/y)):h&&(b=(y-1)/2,w=(x-1)/2);for(var E=s.MIN_SAFE_INTEGER,C=0;C<x;C++){T[C]=[];for(var k=0;k<y;k++){S=b-k,_=w-C;var A=Math.sqrt(S*S+_*_);A>E&&(E=A),T[C][k]=A}}}var I=a?i(a):null;return n=c?function(t,e,n,i){var r,s=0,a=i%y,c=Math.floor(i/y);if(a>=0&&a<y&&c>=0&&c<x&&(s=T[c][a]),f){var l=g-m;r=I?s/E*l*I(s/E):s/E*l}else r=I?s*m*I(s/E):s*m;return r+o}:function(t,e,n,i,r){var s,a,c;return r--,u?s=i:h?s=Math.abs(r/2-i):d?s=r-i:p&&(s=Math.abs(l-i)),f?(c=h?(g-m)/r*(2*s):(g-m)/r*s,a=I?c*I(s/r):c):a=I?r*v*I(s/r):s*m,a+o},n}},68061:(t,e,n)=>{var i=n(502),r=n(99730),s=n(20494),o=n(63130),a=n(21902),c=n(4840),l=n(28348),u=n(92407),h=n(65868),d=n(10850),p=n(9744),f=n(72066),m=n(39366);t.exports=function(t,e,n){if(e instanceof m)return e.parent=t,e;n=void 0===n?r:f(r,n);var g=h(e);!g&&n.targets&&(g=n.targets);for(var v=u(e),y=d(e,"delay",n.delay),x=d(e,"duration",n.duration),b=d(e,"easeParams",n.easeParams),w=d(e,"ease",n.ease),S=d(e,"hold",n.hold),_=d(e,"repeat",n.repeat),T=d(e,"repeatDelay",n.repeatDelay),E=o(e,"yoyo",n.yoyo),C=o(e,"flipX",n.flipX),k=o(e,"flipY",n.flipY),A=d(e,"interpolation",n.interpolation),I=function(t,e,n,i){if("texture"===n){var r=i,s=void 0;Array.isArray(i)?(r=i[0],s=i[1]):i.hasOwnProperty("value")?(r=i.value,Array.isArray(i.value)?(r=i.value[0],s=i.value[1]):"string"===typeof i.value&&(r=i.value)):"string"===typeof i&&(r=i),t.addFrame(e,r,s,l(i,"delay",y),d(i,"duration",x),d(i,"hold",S),d(i,"repeat",_),d(i,"repeatDelay",T),o(i,"flipX",C),o(i,"flipY",k))}else{var u=p(n,i),h=c(d(i,"interpolation",A));t.add(e,n,u.getEnd,u.getStart,u.getActive,a(d(i,"ease",w),d(i,"easeParams",b)),l(i,"delay",y),d(i,"duration",x),o(i,"yoyo",E),d(i,"hold",S),d(i,"repeat",_),d(i,"repeatDelay",T),o(i,"flipX",C),o(i,"flipY",k),h,h?i:null)}},O=new m(t,g),R=0;R<v.length;R++)for(var N=v[R].key,M=v[R].value,D=0;D<g.length;D++)"scale"!==N||g[D].hasOwnProperty("scale")?I(O,D,N,M):(I(O,D,"scaleX",M),I(O,D,"scaleY",M));O.completeDelay=s(e,"completeDelay",0),O.loop=Math.round(s(e,"loop",0)),O.loopDelay=Math.round(s(e,"loopDelay",0)),O.paused=o(e,"paused",!1),O.persist=o(e,"persist",!1),O.callbackScope=d(e,"callbackScope",O);for(var P=i.TYPES,F=0;F<P.length;F++){var L=P[F],B=d(e,L,!1);if(B){var z=d(e,L+"Params",[]);O.setCallback(L,B,z)}}return O}},56034:(t,e,n)=>{var i=n(502),r=n(20494),s=n(63130),o=n(65868),a=n(10850),c=n(68061),l=n(45641);t.exports=function(t,e){if(e instanceof l)return e.parent=t,e;var n,u=new l(t);u.startDelay=a(e,"delay",0),u.completeDelay=r(e,"completeDelay",0),u.loop=Math.round(r(e,"loop",a(e,"repeat",0))),u.loopDelay=Math.round(r(e,"loopDelay",a(e,"repeatDelay",0))),u.paused=s(e,"paused",!1),u.persist=s(e,"persist",!0),u.callbackScope=a(e,"callbackScope",u);var h=i.TYPES;for(n=0;n<h.length;n++){var d=h[n],p=a(e,d,!1);if(p){var f=a(e,d+"Params",[]);u.setCallback(d,p,f)}}var m=a(e,"tweens",null);if(Array.isArray(m)){var g=[],v=o(e),y=void 0;for(v&&(y={targets:v}),n=0;n<m.length;n++)g.push(c(u,m[n],y));u.add(g)}return u}},79619:(t,e,n)=>{t.exports={GetBoolean:n(63130),GetEaseFunction:n(21902),GetInterpolationFunction:n(4840),GetNewValue:n(28348),GetProps:n(92407),GetTargets:n(65868),GetValueOp:n(9744),NumberTweenBuilder:n(68710),StaggerBuilder:n(91944),TweenBuilder:n(68061)}},5570:t=>{t.exports="active"},6383:t=>{t.exports="complete"},72582:t=>{t.exports="loop"},90281:t=>{t.exports="pause"},80803:t=>{t.exports="repeat"},13640:t=>{t.exports="resume"},10472:t=>{t.exports="start"},5379:t=>{t.exports="stop"},43449:t=>{t.exports="update"},61541:t=>{t.exports="yoyo"},54272:(t,e,n)=>{t.exports={TWEEN_ACTIVE:n(5570),TWEEN_COMPLETE:n(6383),TWEEN_LOOP:n(72582),TWEEN_PAUSE:n(90281),TWEEN_RESUME:n(13640),TWEEN_REPEAT:n(80803),TWEEN_START:n(10472),TWEEN_STOP:n(5379),TWEEN_UPDATE:n(43449),TWEEN_YOYO:n(61541)}},75193:(t,e,n)=>{var i={States:n(55303),Builders:n(79619),Events:n(54272),TweenManager:n(64532),Tween:n(39366),TweenData:n(15718),TweenFrameData:n(96490),BaseTween:n(502),TweenChain:n(45641)};t.exports=i},502:(t,e,n)=>{var i=n(56694),r=n(6659),s=n(54272),o=n(55303),a=new i({Extends:r,initialize:function(t){r.call(this),this.parent=t,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=o.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(s.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(s.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(s.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(s.TWEEN_COMPLETE,"onComplete")},complete:function(t){return void 0===t&&(t=0),t?(this.setCompleteDelayState(),this.countdown=t):this.onCompleteHandler(),this},completeAfterLoop:function(t){return void 0===t&&(t=0),this.loopCounter>t&&(this.loopCounter=t),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return!this.parent||this.isRemoved()||this.isPendingRemove()||this.isDestroyed()||(this.dispatchEvent(s.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(t){this.countdown-=t,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(s.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(t){return this.countdown-=t,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(s.TWEEN_START,"onStart"),t=0),t},updateCompleteDelay:function(t){this.countdown-=t,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(t,e,n){return void 0===n&&(n=[]),this.callbacks.hasOwnProperty(t)&&(this.callbacks[t]={func:e,params:n}),this},setPendingState:function(){this.state=o.PENDING},setActiveState:function(){this.state=o.ACTIVE},setLoopDelayState:function(){this.state=o.LOOP_DELAY},setCompleteDelayState:function(){this.state=o.COMPLETE_DELAY},setStartDelayState:function(){this.state=o.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=o.PENDING_REMOVE},setRemovedState:function(){this.state=o.REMOVED},setFinishedState:function(){this.state=o.FINISHED},setDestroyedState:function(){this.state=o.DESTROYED},isPending:function(){return this.state===o.PENDING},isActive:function(){return this.state===o.ACTIVE},isLoopDelayed:function(){return this.state===o.LOOP_DELAY},isCompleteDelayed:function(){return this.state===o.COMPLETE_DELAY},isStartDelayed:function(){return this.state===o.START_DELAY},isPendingRemove:function(){return this.state===o.PENDING_REMOVE},isRemoved:function(){return this.state===o.REMOVED},isFinished:function(){return this.state===o.FINISHED},isDestroyed:function(){return this.state===o.DESTROYED},destroy:function(){this.data&&this.data.forEach((function(t){t.destroy()})),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});a.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],t.exports=a},65521:(t,e,n)=>{var i=n(56694),r=n(54272),s=n(55303),o=new i({initialize:function(t,e,n,i,r,s,o,a,c,l){this.tween=t,this.targetIndex=e,this.duration=i,this.totalDuration=0,this.delay=0,this.getDelay=n,this.yoyo=r,this.hold=s,this.repeat=o,this.repeatDelay=a,this.repeatCounter=0,this.flipX=c,this.flipY=l,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(t){void 0===t&&(t=this.current),this.tween.targets[this.targetIndex][this.key]=t},setCreatedState:function(){this.state=s.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=s.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=s.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=s.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=s.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=s.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=s.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=s.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===s.CREATED},isDelayed:function(){return this.state===s.DELAY},isPendingRender:function(){return this.state===s.PENDING_RENDER},isPlayingForward:function(){return this.state===s.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===s.PLAYING_BACKWARD},isHolding:function(){return this.state===s.HOLD_DELAY},isRepeating:function(){return this.state===s.REPEAT_DELAY},isComplete:function(){return this.state===s.COMPLETE},setStateFromEnd:function(t){this.yoyo?this.onRepeat(t,!0,!0):this.repeatCounter>0?this.onRepeat(t,!0,!1):this.setCompleteState()},setStateFromStart:function(t){this.repeatCounter>0?this.onRepeat(t,!1):this.setCompleteState()},reset:function(){var t=this.tween,e=t.totalTargets,n=this.targetIndex,i=t.targets[n],r=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(i,r,0,n,e,t),this.repeatCounter=-1===this.repeat?s.MAX:this.repeat,this.setPendingRenderState();var o=this.duration+this.hold;this.yoyo&&(o+=this.duration);var a=o+this.repeatDelay;this.totalDuration=this.delay+o,-1===this.repeat?(this.totalDuration+=a*s.MAX,t.isInfinite=!0):this.repeat>0&&(this.totalDuration+=a*this.repeat),this.totalDuration>t.duration&&(t.duration=this.totalDuration),this.delay<t.startDelay&&(t.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(t,e,n){var i=this.tween,s=i.totalTargets,o=this.targetIndex,a=i.targets[o],c=this.key,l="texture"!==c;if(this.elapsed=t,this.progress=t/this.duration,this.flipX&&a.toggleFlipX(),this.flipY&&a.toggleFlipY(),l&&(e||n)&&(this.start=this.getStartValue(a,c,this.start,o,s,i)),n)return this.setPlayingBackwardState(),void this.dispatchEvent(r.TWEEN_YOYO,"onYoyo");this.repeatCounter--,l&&(this.end=this.getEndValue(a,c,this.start,o,s,i)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-t,l&&(this.current=this.start,a[c]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(r.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});t.exports=o},99730:t=>{t.exports={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null}},53709:t=>{t.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]},39366:(t,e,n)=>{var i=n(502),r=n(56694),s=n(54272),o=n(99325),a=n(61286),c=n(83392),l=n(55303),u=n(15718),h=n(96490),d=new r({Extends:i,initialize:function(t,e){i.call(this,t),this.targets=e,this.totalTargets=e.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0},add:function(t,e,n,i,r,s,o,a,c,l,h,d,p,f,m,g){var v=new u(this,t,e,n,i,r,s,o,a,c,l,h,d,p,f,m,g);return this.totalData=this.data.push(v),v},addFrame:function(t,e,n,i,r,s,o,a,c,l){var u=new h(this,t,e,n,i,r,s,o,a,c,l);return this.totalData=this.data.push(u),u},getValue:function(t){void 0===t&&(t=0);var e=null;return this.data&&(e=this.data[t].current),e},hasTarget:function(t){return this.targets&&-1!==this.targets.indexOf(t)},updateTo:function(t,e,n){if(void 0===n&&(n=!1),"texture"!==t)for(var i=0;i<this.totalData;i++){var r=this.data[i];r.key===t&&(r.isPlayingForward()||r.isPlayingBackward())&&(r.end=e,n&&(r.start=r.current))}return this},restart:function(){switch(this.state){case l.REMOVED:case l.FINISHED:this.seek(),this.parent.makeActive(this);break;case l.PENDING:case l.PENDING_REMOVE:this.parent.reset(this);break;case l.DESTROYED:console.warn("Cannot restart destroyed Tween",this);break;default:this.seek()}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(s.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,i.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed Tween",this),this):((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=16.6),void 0===n&&(n=!1),this.isDestroyed())return console.warn("Cannot seek destroyed Tween",this),this;n||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(s.TWEEN_ACTIVE,"onActive");var i=this.paused;if(this.paused=!1,t>0){for(var r=Math.floor(t/e),o=t-r*e,a=0;a<r;a++)this.update(e);o>0&&this.update(o)}return this.paused=i,this.isSeeking=!1,this},initTweenData:function(t){void 0===t&&(t=!1),this.duration=0,this.startDelay=c.MAX_SAFE_INTEGER;for(var e=this.data,n=0;n<this.totalData;n++)e[n].reset(t);this.duration=Math.max(this.duration,.01);var i=this.duration,r=this.completeDelay,s=this.loopCounter,o=this.loopDelay;this.totalDuration=s>0?i+r+(i+o)*s:i+r},reset:function(t){return void 0===t&&(t=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,-1===this.loop&&(this.isInfinite=!0,this.loopCounter=l.MAX),t||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(s.TWEEN_ACTIVE,"onActive")),this},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!0;if(this.paused||this.isFinished())return!1;if(t*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(s.TWEEN_START,"onStart"),t=0));var e=!1;if(this.isActive())for(var n=this.data,i=0;i<this.totalData;i++)n[i].update(t)&&(e=!0);this.elapsed+=t,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=t,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),e||this.nextState();var r=this.isPendingRemove();return r&&this.persist&&(this.setFinishedState(),r=!1),r},forward:function(t){return this.update(t),this},rewind:function(t){return this.update(-t),this},dispatchEvent:function(t,e){if(!this.isSeeking){this.emit(t,this,this.targets);var n=this.callbacks[e];n&&n.func.apply(this.callbackScope,[this,this.targets].concat(n.params))}},destroy:function(){i.prototype.destroy.call(this),this.targets=null}});a.register("tween",(function(t){return this.scene.sys.tweens.add(t)})),o.register("tween",(function(t){return this.scene.sys.tweens.create(t)})),t.exports=d},45641:(t,e,n)=>{var i=n(66458),r=n(502),s=n(56694),o=n(54272),a=n(99325),c=n(61286),l=n(55303),u=new s({Extends:r,initialize:function(t){r.call(this,t),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=-1===this.loop?l.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this.dispatchEvent(o.TWEEN_ACTIVE,"onActive"),this},add:function(t){var e=this.parent.create(t);Array.isArray(e)||(e=[e]);for(var n=this.data,i=0;i<e.length;i++){var r=e[i];r.parent=this,n.push(r.reset())}return this.totalData=n.length,this},remove:function(t){return i(this.data,t),t.setRemovedState(),t===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(t){for(var e=this.data,n=0;n<this.totalData;n++)if(e[n].hasTarget(t))return!0;return!1},restart:function(){return this.isDestroyed()?(console.warn("Cannot restart destroyed TweenChain",this),this):(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(t){return t.seek(),t.setActiveState(),this},makeActive:function(t){return t.reset(),t.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(o.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed TweenChain",this),this):((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var t=this.data,e=this.totalData,n=0;n<e;n++)t[n].reset(!1);this.currentIndex=0,this.currentTween=t[0]},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!0;if(this.isFinished()||this.paused)return!1;t*=this.parent.timeScale,this.isLoopDelayed()?this.updateLoopCountdown(t):this.isCompleteDelayed()?this.updateCompleteDelay(t):this.isStartDelayed()&&(t=this.updateStartCountdown(t));var e=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(t)&&this.nextTween()&&this.nextState(),(e=this.isPendingRemove())&&this.persist&&(this.setFinishedState(),e=!1)),e},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData||(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(t){this.currentIndex=t,this.currentTween=this.data[t],this.currentTween.setActiveState(),this.currentTween.dispatchEvent(o.TWEEN_ACTIVE,"onActive")},dispatchEvent:function(t,e){this.emit(t,this);var n=this.callbacks[e];n&&n.func.apply(this.callbackScope,[this].concat(n.params))},destroy:function(){r.prototype.destroy.call(this),this.currentTween=null}});c.register("tweenchain",(function(t){return this.scene.sys.tweens.chain(t)})),a.register("tweenchain",(function(t){return this.scene.sys.tweens.create(t)})),t.exports=u},15718:(t,e,n)=>{var i=n(65521),r=n(82897),s=n(56694),o=n(54272),a=new s({Extends:i,initialize:function(t,e,n,r,s,o,a,c,l,u,h,d,p,f,m,g,v){i.call(this,t,e,c,l,u,h,d,p,f,m),this.key=n,this.getActiveValue=o,this.getEndValue=r,this.getStartValue=s,this.ease=a,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=g,this.interpolationData=v},reset:function(t){i.prototype.reset.call(this);var e=this.tween.targets[this.targetIndex],n=this.key;t&&(e[n]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(e[n]=this.getActiveValue(e,n,0))},update:function(t){var e=this.tween,n=e.totalTargets,i=this.targetIndex,s=e.targets[i],a=this.key;if(!s)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(o.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(s,a,s[a],i,n,e),this.end=this.getEndValue(s,a,this.start,i,n,e),this.current=this.start,s[a]=this.start,this.setPlayingForwardState(),!0;var c=this.isPlayingForward(),l=this.isPlayingBackward();if(c||l){var u=this.elapsed,h=this.duration,d=0,p=!1;(u+=t)>=h?(d=u-h,u=h,p=!0):u<0&&(u=0);var f=r(u/h,0,1);if(this.elapsed=u,this.progress=f,this.previous=this.current,p)c?(this.current=this.end,s[a]=this.end,this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(d)):(this.current=this.start,s[a]=this.start,this.setStateFromStart(d));else{c||(f=1-f);var m=this.ease(f);this.interpolation?this.current=this.interpolation(this.interpolationData,m):this.current=this.start+(this.end-this.start)*m,s[a]=this.current}this.dispatchEvent(o.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var n=this.tween;if(!n.isSeeking){var i=n.targets[this.targetIndex],r=this.key,s=this.current,o=this.previous;n.emit(t,n,r,i,s,o);var a=n.callbacks[e];a&&a.func.apply(n.callbackScope,[n,i,r,s,o].concat(a.params))}},destroy:function(){i.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});t.exports=a},96490:(t,e,n)=>{var i=n(65521),r=n(82897),s=n(56694),o=n(54272),a=new s({Extends:i,initialize:function(t,e,n,r,s,o,a,c,l,u,h){i.call(this,t,e,s,o,!1,a,c,l,u,h),this.key="texture",this.startTexture=null,this.endTexture=n,this.startFrame=null,this.endFrame=r,this.yoyo=0!==c},reset:function(t){i.prototype.reset.call(this);var e=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=e.texture.key,this.startFrame=e.frame.name),t&&e.setTexture(this.startTexture,this.startFrame)},update:function(t){var e=this.tween,n=this.targetIndex,i=e.targets[n];if(!i)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(o.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&i.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var s=this.isPlayingForward(),a=this.isPlayingBackward();if(s||a){var c=this.elapsed,l=this.duration,u=0,h=!1;(c+=t)>=l?(u=c-l,c=l,h=!0):c<0&&(c=0);var d=r(c/l,0,1);this.elapsed=c,this.progress=d,h&&(s?(i.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(u)):(i.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(u))),this.dispatchEvent(o.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var n=this.tween;if(!n.isSeeking){var i=n.targets[this.targetIndex],r=this.key;n.emit(t,n,r,i);var s=n.callbacks[e];s&&s.func.apply(n.callbackScope,[n,i,r].concat(s.params))}},destroy:function(){i.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});t.exports=a},55303:t=>{t.exports={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999}},56694:t=>{function e(t,e,n){var i=n?t[e]:Object.getOwnPropertyDescriptor(t,e);return!n&&i.value&&"object"===typeof i.value&&(i=i.value),!(!i||!function(t){return!!t.get&&"function"===typeof t.get||!!t.set&&"function"===typeof t.set}(i))&&("undefined"===typeof i.enumerable&&(i.enumerable=!0),"undefined"===typeof i.configurable&&(i.configurable=!0),i)}function n(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!!n&&(n.value&&"object"===typeof n.value&&(n=n.value),!1===n.configurable)}function i(t,i,r,o){for(var a in i)if(i.hasOwnProperty(a)){var c=e(i,a,r);if(!1!==c){if(n((o||t).prototype,a)){if(s.ignoreFinals)continue;throw new Error("cannot override final property '"+a+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,a,c)}else t.prototype[a]=i[a]}}function r(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)i(t,e[n].prototype||e[n])}}function s(t){var e,n;if(t||(t={}),t.initialize){if("function"!==typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var s=t.Extends;e=function(){s.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,n=t.Extends,delete t.Extends):e.prototype.constructor=e;var o=null;return t.Mixins&&(o=t.Mixins,delete t.Mixins),r(e,o),i(e,t,!0,n),e}s.extend=i,s.mixin=r,s.ignoreFinals=!1,t.exports=s},72283:t=>{t.exports=function(){}},10618:t=>{t.exports=function(){return null}},78991:t=>{t.exports=function(t,e,n,i,r){if(void 0===r&&(r=t),n>0){var s=n-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),i&&i.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.splice(o,1),o--;if(0===(o=e.length))return null;n>0&&o>s&&(e.splice(s),o=s);for(var a=0;a<o;a++){var c=e[a];t.push(c),i&&i.call(r,c)}return e}},48522:t=>{t.exports=function(t,e,n,i,r,s){if(void 0===n&&(n=0),void 0===s&&(s=t),i>0){var o=i-t.length;if(o<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(n,0,e),r&&r.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.pop(),a--;if(0===(a=e.length))return null;i>0&&a>o&&(e.splice(o),a=o);for(var c=a-1;c>=0;c--){var l=e[c];t.splice(n,0,l),r&&r.call(s,l)}return e}},58742:t=>{t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n<t.length&&(t.splice(n,1),t.push(e)),e}},30164:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=0;if(i(t,r,s))for(var a=r;a<s;a++)t[a][e]===n&&o++;return o}},36337:t=>{t.exports=function(t,e,n){var i,r=[null];for(i=3;i<arguments.length;i++)r.push(arguments[i]);for(i=0;i<t.length;i++)r[0]=t[i],e.apply(n,r);return t}},46208:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s)){var o,a=[null];for(o=5;o<arguments.length;o++)a.push(arguments[o]);for(o=r;o<s;o++)a[0]=t[o],e.apply(n,a)}return t}},2406:t=>{t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,r,s=1;if(n){if(t<e[0][n])return e[0];for(;e[s][n]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),n?(i=e[s-1][n],(r=e[s][n])-t<=t-i?e[s]:e[s-1]):(i=e[s-1],(r=e[s])-t<=t-i?r:i)}},5454:t=>{var e=function(t,n){void 0===n&&(n=[]);for(var i=0;i<t.length;i++)Array.isArray(t[i])?e(t[i],n):n.push(t[i]);return n};t.exports=e},71608:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=[];if(i(t,r,s))for(var a=r;a<s;a++){var c=t[a];(!e||e&&void 0===n&&c.hasOwnProperty(e)||e&&void 0!==n&&c[e]===n)&&o.push(c)}return o}},51463:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];if(!e||e&&void 0===n&&a.hasOwnProperty(e)||e&&void 0!==n&&a[e]===n)return a}return null}},72861:t=>{t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},24218:t=>{t.exports=function(t,e,n){if(e===n)return t;var i=t.indexOf(e),r=t.indexOf(n);if(i<0||r<0)throw new Error("Supplied items must be elements of the same array");return i>r||(t.splice(i,1),r===t.length-1?t.push(e):t.splice(r,0,e)),t}},58258:t=>{t.exports=function(t,e,n){if(e===n)return t;var i=t.indexOf(e),r=t.indexOf(n);if(i<0||r<0)throw new Error("Supplied items must be elements of the same array");return i<r||(t.splice(i,1),0===r?t.unshift(e):t.splice(r,0,e)),t}},51172:t=>{t.exports=function(t,e){var n=t.indexOf(e);if(n>0){var i=t[n-1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},68396:t=>{t.exports=function(t,e,n){var i=t.indexOf(e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(t.splice(i,1),t.splice(n,0,e)),e}},27555:t=>{t.exports=function(t,e){var n=t.indexOf(e);if(-1!==n&&n<t.length-1){var i=t[n+1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},13401:t=>{t.exports=function(t,e,n,i){var r,s=[],o=!1;if((n||i)&&(o=!0,n||(n=""),i||(i="")),e<t)for(r=t;r>=e;r--)o?s.push(n+r.toString()+i):s.push(r);else for(r=t;r<=e;r++)o?s.push(n+r.toString()+i):s.push(r);return s}},89955:(t,e,n)=>{var i=n(67233);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var r=[],s=Math.max(i((e-t)/(n||1)),0),o=0;o<s;o++)r.push(t),t+=n;return r}},53466:t=>{function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t,r,s,o,a){for(void 0===s&&(s=0),void 0===o&&(o=t.length-1),void 0===a&&(a=n);o>s;){if(o-s>600){var c=o-s+1,l=r-s+1,u=Math.log(c),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(c-h)/c)*(l-c/2<0?-1:1),p=Math.max(s,Math.floor(r-l*h/c+d)),f=Math.min(o,Math.floor(r+(c-l)*h/c+d));i(t,r,p,f,a)}var m=t[r],g=s,v=o;for(e(t,s,r),a(t[o],m)>0&&e(t,s,o);g<v;){for(e(t,g,v),g++,v--;a(t[g],m)<0;)g++;for(;a(t[v],m)>0;)v--}0===a(t[s],m)?e(t,s,v):e(t,++v,o),v<=r&&(s=v+1),r<=v&&(o=v-1)}};t.exports=i},75757:(t,e,n)=>{var i=n(10850),r=n(18592),s=function(t,e,n){for(var i=[],r=0;r<t.length;r++)for(var s=0;s<e.length;s++)for(var o=0;o<n;o++)i.push({a:t[r],b:e[s]});return i};t.exports=function(t,e,n){var o=i(n,"max",0),a=i(n,"qty",1),c=i(n,"random",!1),l=i(n,"randomB",!1),u=i(n,"repeat",0),h=i(n,"yoyo",!1),d=[];if(l&&r(e),-1===u)if(0===o)u=0;else{var p=t.length*e.length*a;h&&(p*=2),u=Math.ceil(o/p)}for(var f=0;f<=u;f++){var m=s(t,e,a);c&&r(m),d=d.concat(m),h&&(m.reverse(),d=d.concat(m))}return o&&d.splice(o),d}},66458:(t,e,n)=>{var i=n(72677);t.exports=function(t,e,n,r){var s;if(void 0===r&&(r=t),!Array.isArray(e))return-1!==(s=t.indexOf(e))?(i(t,s),n&&n.call(r,e),e):null;for(var o=e.length-1,a=[];o>=0;){var c=e[o];-1!==(s=t.indexOf(c))&&(i(t,s),a.push(c),n&&n.call(r,c)),o--}return a}},8324:(t,e,n)=>{var i=n(72677);t.exports=function(t,e,n,r){if(void 0===r&&(r=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var s=i(t,e);return n&&n.call(r,s),s}},47427:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===s&&(s=t),i(t,e,n)){var o=n-e,a=t.splice(e,o);if(r)for(var c=0;c<a.length;c++){var l=a[c];r.call(s,l)}return a}return[]}},50147:(t,e,n)=>{var i=n(72677);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r=e+Math.floor(Math.random()*n);return i(t,r)}},80402:t=>{t.exports=function(t,e,n){var i=t.indexOf(e),r=t.indexOf(n);return-1!==i&&-1===r&&(t[i]=n,!0)}},77640:t=>{t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},38487:t=>{t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},45838:t=>{t.exports=function(t,e,n,i){var r=t.length;if(e<0||e>r||e>=n||n>r){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},27847:t=>{t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n>0&&(t.splice(n,1),t.unshift(e)),e}},6034:(t,e,n)=>{var i=n(45838);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];a.hasOwnProperty(e)&&(a[e]=n)}return t}},18592:t=>{t.exports=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},28834:t=>{t.exports=function(t){var e=/\D/g;return t.sort((function(t,n){return parseInt(t.replace(e,""),10)-parseInt(n.replace(e,""),10)})),t}},72677:t=>{t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],r=e;r<n;r++)t[r]=t[r+1];return t.length=n,i}}},17922:(t,e,n)=>{var i=n(77290);function r(t,e){return String(t).localeCompare(e)}function s(t,e,n,i){var r,s,o,a,c,l=t.length,u=0,h=2*n;for(r=0;r<l;r+=h)for(o=(s=r+n)+n,s>l&&(s=l),o>l&&(o=l),a=r,c=s;;)if(a<s&&c<o)e(t[a],t[c])<=0?i[u++]=t[a++]:i[u++]=t[c++];else if(a<s)i[u++]=t[a++];else{if(!(c<o))break;i[u++]=t[c++]}}t.exports=function(t,e){if(void 0===e&&(e=r),!t||t.length<2)return t;if(i.features.stableSort)return t.sort(e);var n=function(t,e){var n=t.length;if(n<=1)return t;for(var i=new Array(n),r=1;r<n;r*=2){s(t,e,r,i);var o=t;t=i,i=o}return t}(t,e);return n!==t&&s(n,null,t.length,t),t}},96928:t=>{t.exports=function(t,e,n){if(e===n)return t;var i=t.indexOf(e),r=t.indexOf(n);if(i<0||r<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[r]=e,t}},59959:(t,e,n)=>{t.exports={Matrix:n(13515),Add:n(78991),AddAt:n(48522),BringToTop:n(58742),CountAllMatching:n(30164),Each:n(36337),EachInRange:n(46208),FindClosestInSorted:n(2406),Flatten:n(5454),GetAll:n(71608),GetFirst:n(51463),GetRandom:n(72861),MoveDown:n(51172),MoveTo:n(68396),MoveUp:n(27555),MoveAbove:n(24218),MoveBelow:n(58258),NumberArray:n(13401),NumberArrayStep:n(89955),QuickSelect:n(53466),Range:n(75757),Remove:n(66458),RemoveAt:n(8324),RemoveBetween:n(47427),RemoveRandomElement:n(50147),Replace:n(80402),RotateLeft:n(77640),RotateRight:n(38487),SafeRange:n(45838),SendToBack:n(27847),SetAll:n(6034),Shuffle:n(18592),SortByDigits:n(28834),SpliceOne:n(72677),StableSort:n(17922),Swap:n(96928)}},97494:t=>{t.exports=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},68428:(t,e,n)=>{var i=n(76400),r=n(97494);t.exports=function(t){var e="";if(!r(t))return e;for(var n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++){var o=t[n][s].toString();e+="undefined"!==o?i(o,2):"?",s<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var a=0;a<t[n].length;a++)e+="---",a<t[n].length-1&&(e+="+");e+="\n"}}return e}},59521:t=>{t.exports=function(t){return t.reverse()}},51995:t=>{t.exports=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t}},89011:(t,e,n)=>{var i=n(63515);t.exports=function(t){return i(t,180)}},42549:(t,e,n)=>{var i=n(63515);t.exports=function(t,e){void 0===e&&(e=1);for(var n=0;n<e;n++)t=i(t,90);return t}},63515:(t,e,n)=>{var i=n(97494),r=n(78581);t.exports=function(t,e){if(void 0===e&&(e=90),!i(t))return null;if("string"!==typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)(t=r(t)).reverse();else if(-90===e||270===e||"rotateRight"===e)t.reverse(),t=r(t);else if(180===Math.abs(e)||"rotate180"===e){for(var n=0;n<t.length;n++)t[n].reverse();t.reverse()}return t}},14305:(t,e,n)=>{var i=n(63515);t.exports=function(t,e){void 0===e&&(e=1);for(var n=0;n<e;n++)t=i(t,-90);return t}},27365:(t,e,n)=>{var i=n(77640),r=n(38487);t.exports=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),0!==n&&(n<0?i(t,Math.abs(n)):r(t,n)),0!==e)for(var s=0;s<t.length;s++){var o=t[s];e<0?i(o,Math.abs(e)):r(o,e)}return t}},78581:t=>{t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),r=0;r<n;r++){i[r]=new Array(e);for(var s=e-1;s>-1;s--)i[r][s]=t[s][r]}return i}},13515:(t,e,n)=>{t.exports={CheckMatrix:n(97494),MatrixToString:n(68428),ReverseColumns:n(59521),ReverseRows:n(51995),Rotate180:n(89011),RotateLeft:n(42549),RotateMatrix:n(63515),RotateRight:n(14305),Translate:n(27365),TransposeMatrix:n(78581)}},40581:t=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports=function(t,n){for(var i=new Uint8Array(t),r=i.length,s=n?"data:"+n+";base64,":"",o=0;o<r;o+=3)s+=e[i[o]>>2],s+=e[(3&i[o])<<4|i[o+1]>>4],s+=e[(15&i[o+1])<<2|i[o+2]>>6],s+=e[63&i[o+2]];return r%3===2?s=s.substring(0,s.length-1)+"=":r%3===1&&(s=s.substring(0,s.length-2)+"=="),s}},82329:t=>{for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<64;i++)n[e.charCodeAt(i)]=i;t.exports=function(t){var e,i,r,s,o=(t=t.substr(t.indexOf(",")+1)).length,a=.75*o,c=0;"="===t[o-1]&&(a--,"="===t[o-2]&&a--);for(var l=new ArrayBuffer(a),u=new Uint8Array(l),h=0;h<o;h+=4)e=n[t.charCodeAt(h)],i=n[t.charCodeAt(h+1)],r=n[t.charCodeAt(h+2)],s=n[t.charCodeAt(h+3)],u[c++]=e<<2|i>>4,u[c++]=(15&i)<<4|r>>2,u[c++]=(3&r)<<6|63&s;return l}},78417:(t,e,n)=>{t.exports={ArrayBufferToBase64:n(40581),Base64ToArrayBuffer:n(82329)}},22178:(t,e,n)=>{t.exports={Array:n(59959),Base64:n(78417),Objects:n(64615),String:n(50379),NOOP:n(72283),NULL:n(10618)}},32742:t=>{t.exports=function(t){var e={};for(var n in t)Array.isArray(t[n])?e[n]=t[n].slice(0):e[n]=t[n];return e}},28699:t=>{var e=function(t){var n,i,r;if("object"!==typeof t||null===t)return t;for(r in n=Array.isArray(t)?[]:{},t)i=t[r],n[r]=e(i);return n};t.exports=e},98611:(t,e,n)=>{var i=n(42911),r=function(){var t,e,n,s,o,a,c=arguments[0]||{},l=1,u=arguments.length,h=!1;for("boolean"===typeof c&&(h=c,c=arguments[1]||{},l=2),u===l&&(c=this,--l);l<u;l++)if(null!=(t=arguments[l]))for(e in t)n=c[e],c!==(s=t[e])&&(h&&s&&(i(s)||(o=Array.isArray(s)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&i(n)?n:{},c[e]=r(h,a,s)):void 0!==s&&(c[e]=s));return c};t.exports=r},20494:(t,e,n)=>{var i=n(5923),r=n(10850);t.exports=function(t,e,n){var s=r(t,e,null);if(null===s)return n;if(Array.isArray(s))return i.RND.pick(s);if("object"===typeof s){if(s.hasOwnProperty("randInt"))return i.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return i.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if("function"===typeof s)return s(e);return s}},72632:t=>{t.exports=function(t,e,n){var i=typeof t;return t&&"number"!==i&&"string"!==i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},94324:(t,e,n)=>{var i=n(10850),r=n(82897);t.exports=function(t,e,n,s,o){void 0===o&&(o=n);var a=i(t,e,o);return r(a,n,s)}},10850:t=>{t.exports=function(t,e,n,i){if(!t&&!i||"number"===typeof t)return n;if(t&&t.hasOwnProperty(e))return t[e];if(i&&i.hasOwnProperty(e))return i[e];if(-1!==e.indexOf(".")){for(var r=e.split("."),s=t,o=i,a=n,c=n,l=!0,u=!0,h=0;h<r.length;h++)s&&s.hasOwnProperty(r[h])?(a=s[r[h]],s=s[r[h]]):l=!1,o&&o.hasOwnProperty(r[h])?(c=o[r[h]],o=o[r[h]]):u=!1;return l?a:u?c:n}return n}},87701:t=>{t.exports=function(t,e){for(var n=0;n<e.length;n++)if(!t.hasOwnProperty(e[n]))return!1;return!0}},53523:t=>{t.exports=function(t,e){for(var n=0;n<e.length;n++)if(t.hasOwnProperty(e[n]))return!0;return!1}},19256:t=>{t.exports=function(t,e){return t.hasOwnProperty(e)}},42911:t=>{t.exports=function(t){if(!t||"object"!==typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0}},30657:(t,e,n)=>{var i=n(32742);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r]);return n}},72066:(t,e,n)=>{var i=n(32742);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)&&(n[r]=e[r]);return n}},28820:(t,e,n)=>{var i=n(19256);t.exports=function(t,e){for(var n={},r=0;r<e.length;r++){var s=e[r];i(t,s)&&(n[s]=t[s])}return n}},22440:t=>{t.exports=function(t,e,n){if(!t||"number"===typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=n,!0;if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=t,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o]))return!1;s=r,r=r[i[o]]}return s[i[i.length-1]]=n,!0}return!1}},64615:(t,e,n)=>{t.exports={Clone:n(32742),DeepCopy:n(28699),Extend:n(98611),GetAdvancedValue:n(20494),GetFastValue:n(72632),GetMinMaxValue:n(94324),GetValue:n(10850),HasAll:n(87701),HasAny:n(53523),HasValue:n(19256),IsPlainObject:n(42911),Merge:n(30657),MergeRight:n(72066),Pick:n(28820),SetValue:n(22440)}},69429:t=>{t.exports=function(t,e){return t.replace(/%([0-9]+)/g,(function(t,n){return e[Number(n)-1]}))}},76400:t=>{t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3);var r=0;if(e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var s=Math.ceil((r=e-t.length)/2);t=new Array(r-s+1).join(n)+t+new Array(s+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},76872:t=>{t.exports=function(t,e){return 0===e?t.slice(1):t.slice(0,e-1)+t.slice(e)}},8051:t=>{t.exports=function(t){return t.split("").reverse().join("")}},76583:t=>{t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}},40587:t=>{t.exports=function(t){return t&&t[0].toUpperCase()+t.slice(1)}},50379:(t,e,n)=>{t.exports={Format:n(69429),Pad:n(76400),RemoveAt:n(76872),Reverse:n(8051),UppercaseFirst:n(40587),UUID:n(76583)}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}return n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n(92491)})(),t.exports=e()},888:(t,e,n)=>{"use strict";var i=n(9047);function r(){}function s(){}s.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,s,o){if(o!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},2007:(t,e,n)=>{t.exports=n(888)()},9047:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7808:(t,e,n)=>{"use strict";var i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var r=o(n(9702)),s=o(n(1725));function o(t){return t&&t.__esModule?t:{default:t}}var a="undefined"===typeof document||"undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&!1,c={},l=void 0;function u(){return l&&!l.headersSent}function h(t,e){var n=a?c:r.default.parse(document.cookie),i=n&&n[t];if("undefined"===typeof e&&(e=!i||"{"!==i[0]&&"["!==i[0]),!e)try{i=JSON.parse(i)}catch(s){}return i}function d(t){var e=a?c:r.default.parse(document.cookie);if("undefined"===typeof t&&(t=!e||"{"!==e[0]&&"["!==e[0]),!t)try{e=JSON.parse(e)}catch(n){}return e}function p(t){var e=a?c:r.default.parse(document.cookie);return e?t?Object.keys(e).reduce((function(n,i){if(!t.test(i))return n;var r={};return r[i]=e[i],(0,s.default)({},n,r)}),{}):e:{}}function f(t,e,n){c[t]=e,"object"===("undefined"===typeof e?"undefined":i(e))&&(c[t]=JSON.stringify(e)),a||(document.cookie=r.default.serialize(t,c[t],n)),u()&&l.cookie&&l.cookie(t,e,n)}function m(t,e){delete c[t],e="undefined"===typeof e?{}:"string"===typeof e?{path:e}:(0,s.default)({},e),"undefined"!==typeof document&&(e.expires=new Date(1970,1,1,0,0,1),e.maxAge=0,document.cookie=r.default.serialize(t,"",e)),u()&&l.clearCookie&&l.clearCookie(t,e)}function g(t){c=t?r.default.parse(t):{}}function v(t,e){return t.cookie?c=t.cookie:t.cookies?c=t.cookies:t.headers&&t.headers.cookie?g(t.headers.cookie):c={},l=e,function(){l=null,c={}}}e.ZP={setRawCookie:g,load:h,loadAll:d,select:p,save:f,remove:m,plugToRequest:v}},4463:(t,e,n)=>{"use strict";var i=n(2791),r=n(5296);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function c(t,e){l(t,e),l(t+"Capture",e)}function l(t,e){for(a[t]=e,t=0;t<e.length;t++)o.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(t,e,n,i,r,s,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function x(t,e,n,i){var r=g.hasOwnProperty(e)?g[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(f,t)||!h.call(p,t)&&(d.test(t)?f[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),k=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function P(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=D&&t[D]||t["@@iterator"])?t:null}var F,L=Object.assign;function B(t){if(void 0===F)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);F=e&&e[1]||""}return"\n"+F+t}var z=!1;function U(t,e){if(!t||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var i=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){i=l}t.call(e.prototype)}else{try{throw Error()}catch(l){i=l}t()}}catch(l){if(l&&i&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var c="\n"+r[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}}while(1<=o&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?B(t):""}function j(t){switch(t.tag){case 5:return B(t.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return t=U(t.type,!1);case 11:return t=U(t.type.render,!1);case 1:return t=U(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case _:return"Fragment";case S:return"Portal";case E:return"Profiler";case T:return"StrictMode";case I:return"Suspense";case O:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case k:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case A:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case R:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case N:e=t._payload,t=t._init;try{return V(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function G(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function q(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function H(t){t._valueTracker||(t._valueTracker=function(t){var e=q(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,s.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function X(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=q(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function Y(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function K(t,e){var n=e.checked;return L({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Q(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=G(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Z(t,e){null!=(e=e.checked)&&x(t,"checked",e,!1)}function J(t,e){Z(t,e);var n=G(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,G(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function $(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&Y(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+G(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return L({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(et(n)){if(1<n.length)throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:G(n)}}function st(t,e){var n=G(e.value),i=G(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ct(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var lt,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((lt=lt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||pt.hasOwnProperty(t)&&pt[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=mt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(pt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pt[e]=pt[t]}))}));var vt=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(vt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62))}}function xt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function wt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var St=null,_t=null,Tt=null;function Et(t){if(t=xr(t)){if("function"!==typeof St)throw Error(s(280));var e=t.stateNode;e&&(e=wr(e),St(t.stateNode,t.type,e))}}function Ct(t){_t?Tt?Tt.push(t):Tt=[t]:_t=t}function kt(){if(_t){var t=_t,e=Tt;if(Tt=_t=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function At(t,e){return t(e)}function It(){}var Ot=!1;function Rt(t,e,n){if(Ot)return t(e,n);Ot=!0;try{return At(t,e,n)}finally{Ot=!1,(null!==_t||null!==Tt)&&(It(),kt())}}function Nt(t,e){var n=t.stateNode;if(null===n)return null;var i=wr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}var Mt=!1;if(u)try{var Dt={};Object.defineProperty(Dt,"passive",{get:function(){Mt=!0}}),window.addEventListener("test",Dt,Dt),window.removeEventListener("test",Dt,Dt)}catch(ut){Mt=!1}function Pt(t,e,n,i,r,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Ft=!1,Lt=null,Bt=!1,zt=null,Ut={onError:function(t){Ft=!0,Lt=t}};function jt(t,e,n,i,r,s,o,a,c){Ft=!1,Lt=null,Pt.apply(Ut,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Gt(t){if(Vt(t)!==t)throw Error(s(188))}function qt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Gt(r),t;if(o===i)return Gt(r),e;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,c=r.child;c;){if(c===n){a=!0,n=r,i=o;break}if(c===i){a=!0,i=r,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,i=r;break}if(c===i){a=!0,i=o,n=r;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t))?Ht(t):null}function Ht(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Ht(t);if(null!==e)return e;t=t.sibling}return null}var Xt=r.unstable_scheduleCallback,Yt=r.unstable_cancelCallback,Kt=r.unstable_shouldYield,Qt=r.unstable_requestPaint,Zt=r.unstable_now,Jt=r.unstable_getCurrentPriorityLevel,$t=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,se=null;var oe=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(ae(t)/ce|0)|0},ae=Math.log,ce=Math.LN2;var le=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=he(a):0!==(s&=o)&&(i=he(s))}else 0!==(o=n&~r)?i=he(o):0!==s&&(i=he(s));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&r)&&((r=i&-i)>=(s=e&-e)||16===r&&0!==(4194240&s)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-oe(e)),i|=t[n],e&=~r;return i}function pe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=le;return 0===(4194240&(le<<=1))&&(le=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ve(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-oe(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var xe=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var we,Se,_e,Te,Ee,Ce=!1,ke=[],Ae=null,Ie=null,Oe=null,Re=new Map,Ne=new Map,Me=[],De="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pe(t,e){switch(t){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":Ie=null;break;case"mouseover":case"mouseout":Oe=null;break;case"pointerover":case"pointerout":Re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ne.delete(e.pointerId)}}function Fe(t,e,n,i,r,s){return null===t||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==e&&(null!==(e=xr(e))&&Se(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Le(t){var e=yr(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){_e(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Be(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=xr(n))&&Se(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);bt=i,n.target.dispatchEvent(i),bt=null,e.shift()}return!0}function ze(t,e,n){Be(t)&&n.delete(e)}function Ue(){Ce=!1,null!==Ae&&Be(Ae)&&(Ae=null),null!==Ie&&Be(Ie)&&(Ie=null),null!==Oe&&Be(Oe)&&(Oe=null),Re.forEach(ze),Ne.forEach(ze)}function je(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ue)))}function Ve(t){function e(e){return je(e,t)}if(0<ke.length){je(ke[0],t);for(var n=1;n<ke.length;n++){var i=ke[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Ae&&je(Ae,t),null!==Ie&&je(Ie,t),null!==Oe&&je(Oe,t),Re.forEach(e),Ne.forEach(e),n=0;n<Me.length;n++)(i=Me[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Le(n),null===n.blockedOn&&Me.shift()}var We=b.ReactCurrentBatchConfig,Ge=!0;function qe(t,e,n,i){var r=xe,s=We.transition;We.transition=null;try{xe=1,Xe(t,e,n,i)}finally{xe=r,We.transition=s}}function He(t,e,n,i){var r=xe,s=We.transition;We.transition=null;try{xe=4,Xe(t,e,n,i)}finally{xe=r,We.transition=s}}function Xe(t,e,n,i){if(Ge){var r=Ke(t,e,n,i);if(null===r)Gi(t,e,i,Ye,n),Pe(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Ae=Fe(Ae,t,e,n,i,r),!0;case"dragenter":return Ie=Fe(Ie,t,e,n,i,r),!0;case"mouseover":return Oe=Fe(Oe,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Re.set(s,Fe(Re.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ne.set(s,Fe(Ne.get(s)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(Pe(t,i),4&e&&-1<De.indexOf(t)){for(;null!==r;){var s=xr(r);if(null!==s&&we(s),null===(s=Ke(t,e,n,i))&&Gi(t,e,i,Ye,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Gi(t,e,i,null,n)}}var Ye=null;function Ke(t,e,n,i){if(Ye=null,null!==(t=yr(t=wt(i))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ye=t,null}function Qe(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jt()){case $t:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Ze=null,Je=null,$e=null;function tn(){if($e)return $e;var t,e,n=Je,i=n.length,r="value"in Ze?Ze.value:Ze.textContent,s=r.length;for(t=0;t<i&&n[t]===r[t];t++);var o=i-t;for(e=1;e<=o&&n[i-e]===r[s-e];e++);return $e=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function sn(t){function e(e,n,i,r,s){for(var o in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(ln),hn=L({},ln,{view:0,detail:0}),dn=sn(hn),pn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cn&&(cn&&"mousemove"===t.type?(on=t.screenX-cn.screenX,an=t.screenY-cn.screenY):an=on=0,cn=t),on)},movementY:function(t){return"movementY"in t?t.movementY:an}}),fn=sn(pn),mn=sn(L({},pn,{dataTransfer:0})),gn=sn(L({},hn,{relatedTarget:0})),vn=sn(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},ln,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xn=sn(yn),bn=sn(L({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=_n[t])&&!!e[t]}function En(){return Tn}var Cn=L({},hn,{key:function(t){if(t.key){var e=wn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?Sn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),kn=sn(Cn),An=sn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),On=sn(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=L({},pn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=sn(Rn),Mn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var Fn=u&&"TextEvent"in window&&!Pn,Ln=u&&(!Dn||Pn&&8<Pn&&11>=Pn),Bn=String.fromCharCode(32),zn=!1;function Un(t,e){switch(t){case"keyup":return-1!==Mn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function qn(t,e,n,i){Ct(i),0<(e=Hi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Hn=null,Xn=null;function Yn(t){Bi(t,0)}function Kn(t){if(X(br(t)))return t}function Qn(t,e){if("change"===t)return e}var Zn=!1;if(u){var Jn;if(u){var $n="oninput"in document;if(!$n){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),$n="function"===typeof ti.oninput}Jn=$n}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function ei(){Hn&&(Hn.detachEvent("onpropertychange",ni),Xn=Hn=null)}function ni(t){if("value"===t.propertyName&&Kn(Xn)){var e=[];qn(e,Xn,t,wt(t)),Rt(Yn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Xn=n,(Hn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Kn(Xn)}function si(t,e){if("click"===t)return Kn(e)}function oi(t,e){if("input"===t||"change"===t)return Kn(e)}var ai="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function ci(t,e){if(ai(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!ai(t[r],e[r]))return!1}return!0}function li(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=li(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=li(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=Y();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=Y((t=e.contentWindow).document)}return e}function pi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,xi=!1;function bi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xi||null==gi||gi!==Y(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&ci(yi,i)||(yi=i,0<(i=Hi(vi,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=gi)))}function wi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Si={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},_i={},Ti={};function Ei(t){if(_i[t])return _i[t];if(!Si[t])return t;var e,n=Si[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ti)return _i[t]=n[e];return t}u&&(Ti=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);var Ci=Ei("animationend"),ki=Ei("animationiteration"),Ai=Ei("animationstart"),Ii=Ei("transitionend"),Oi=new Map,Ri="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(t,e){Oi.set(t,e),c(e,[t])}for(var Mi=0;Mi<Ri.length;Mi++){var Di=Ri[Mi];Ni(Di.toLowerCase(),"on"+(Di[0].toUpperCase()+Di.slice(1)))}Ni(Ci,"onAnimationEnd"),Ni(ki,"onAnimationIteration"),Ni(Ai,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Ii,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Li(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,o,a,c,l){if(jt.apply(this,arguments),Ft){if(!Ft)throw Error(s(198));var u=Lt;Ft=!1,Lt=null,Bt||(Bt=!0,zt=u)}}(i,e,void 0,t),t.currentTarget=null}function Bi(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break t;Li(r,a,l),s=c}else for(o=0;o<i.length;o++){if(c=(a=i[o]).instance,l=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break t;Li(r,a,l),s=c}}}if(Bt)throw t=zt,Bt=!1,zt=null,t}function zi(t,e){var n=e[mr];void 0===n&&(n=e[mr]=new Set);var i=t+"__bubble";n.has(i)||(Wi(e,t,2,!1),n.add(i))}function Ui(t,e,n){var i=0;e&&(i|=4),Wi(n,t,i,e)}var ji="_reactListening"+Math.random().toString(36).slice(2);function Vi(t){if(!t[ji]){t[ji]=!0,o.forEach((function(e){"selectionchange"!==e&&(Fi.has(e)||Ui(e,!1,t),Ui(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[ji]||(e[ji]=!0,Ui("selectionchange",!1,e))}}function Wi(t,e,n,i){switch(Qe(e)){case 1:var r=qe;break;case 4:r=He;break;default:r=Xe}n=r.bind(null,e,n,t),r=void 0,!Mt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Gi(t,e,n,i,r){var s=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===r||8===c.nodeType&&c.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=yr(a)))return;if(5===(c=o.tag)||6===c){i=s=o;continue t}a=a.parentNode}}i=i.return}Rt((function(){var i=s,r=wt(n),o=[];t:{var a=Oi.get(t);if(void 0!==a){var c=un,l=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":c=kn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=In;break;case Ci:case ki:case Ai:c=vn;break;case Ii:c=On;break;case"scroll":c=dn;break;case"wheel":c=Nn;break;case"copy":case"cut":case"paste":c=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=An}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Nt(f,d))&&u.push(qi(f,m,p)))),h)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&e)){if(c="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||n===bt||!(l=n.relatedTarget||n.fromElement)||!yr(l)&&!l[fr])&&(c||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=i,null!==(l=(l=n.relatedTarget||n.toElement)?yr(l):null)&&(l!==(h=Vt(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=i),c!==l)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(u=An,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==c?a:br(c),p=null==l?a:br(l),(a=new u(m,f+"leave",c,n,r)).target=h,a.relatedTarget=p,m=null,yr(r)===i&&((u=new u(d,f+"enter",l,n,r)).target=p,u.relatedTarget=h,m=u),h=m,c&&l)t:{for(d=l,f=0,p=u=c;p;p=Xi(p))f++;for(p=0,m=d;m;m=Xi(m))p++;for(;0<f-p;)u=Xi(u),f--;for(;0<p-f;)d=Xi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break t;u=Xi(u),d=Xi(d)}u=null}else u=null;null!==c&&Yi(o,a,c,u,!1),null!==l&&null!==h&&Yi(o,h,l,u,!0)}if("select"===(c=(a=i?br(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var g=Qn;else if(Gn(a))if(Zn)g=oi;else{g=ri;var v=ii}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=si);switch(g&&(g=g(t,i))?qn(o,g,n,r):(v&&v(t,a,i),"focusout"===t&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&tt(a,"number",a.value)),v=i?br(i):window,t){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":xi=!0;break;case"contextmenu":case"mouseup":case"dragend":xi=!1,bi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":bi(o,n,r)}var y;if(Dn)t:{switch(t){case"compositionstart":var x="onCompositionStart";break t;case"compositionend":x="onCompositionEnd";break t;case"compositionupdate":x="onCompositionUpdate";break t}x=void 0}else Vn?Un(t,n)&&(x="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(x="onCompositionStart");x&&(Ln&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Vn&&(y=tn()):(Je="value"in(Ze=r)?Ze.value:Ze.textContent,Vn=!0)),0<(v=Hi(i,x)).length&&(x=new bn(x,t,null,n,r),o.push({event:x,listeners:v}),y?x.data=y:null!==(y=jn(n))&&(x.data=y))),(y=Fn?function(t,e){switch(t){case"compositionend":return jn(e);case"keypress":return 32!==e.which?null:(zn=!0,Bn);case"textInput":return(t=e.data)===Bn&&zn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!Dn&&Un(t,e)?(t=tn(),$e=Je=Ze=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ln&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=y))}Bi(o,e)}))}function qi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Nt(t,n))&&i.unshift(qi(t,s,r)),null!=(s=Nt(t,e))&&i.push(qi(t,s,r))),t=t.return}return i}function Xi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Yi(t,e,n,i,r){for(var s=e._reactName,o=[];null!==n&&n!==i;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===i)break;5===a.tag&&null!==l&&(a=l,r?null!=(c=Nt(n,s))&&o.unshift(qi(n,c,a)):r||null!=(c=Nt(n,s))&&o.push(qi(n,c,a))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var Ki=/\r\n?/g,Qi=/\u0000|\uFFFD/g;function Zi(t){return("string"===typeof t?t:""+t).replace(Ki,"\n").replace(Qi,"")}function Ji(t,e,n){if(e=Zi(e),Zi(t)!==e&&n)throw Error(s(425))}function $i(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(t){return sr.resolve(null).then(t).catch(ar)}:ir;function ar(t){setTimeout((function(){throw t}))}function cr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ve(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ve(e)}function lr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ur(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fr]||n[dr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ur(t);null!==t;){if(n=t[dr])return n;t=ur(t)}return e}n=(t=n).parentNode}return null}function xr(t){return!(t=t[dr]||t[fr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function br(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function wr(t){return t[pr]||null}var Sr=[],_r=-1;function Tr(t){return{current:t}}function Er(t){0>_r||(t.current=Sr[_r],Sr[_r]=null,_r--)}function Cr(t,e){_r++,Sr[_r]=t.current,t.current=e}var kr={},Ar=Tr(kr),Ir=Tr(!1),Or=kr;function Rr(t,e){var n=t.type.contextTypes;if(!n)return kr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Nr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Mr(){Er(Ir),Er(Ar)}function Dr(t,e,n){if(Ar.current!==kr)throw Error(s(168));Cr(Ar,e),Cr(Ir,n)}function Pr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(s(108,W(t)||"Unknown",r));return L({},n,i)}function Fr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||kr,Or=Ar.current,Cr(Ar,t),Cr(Ir,Ir.current),!0}function Lr(t,e,n){var i=t.stateNode;if(!i)throw Error(s(169));n?(t=Pr(t,e,Or),i.__reactInternalMemoizedMergedChildContext=t,Er(Ir),Er(Ar),Cr(Ar,t)):Er(Ir),Cr(Ir,n)}var Br=null,zr=!1,Ur=!1;function jr(t){null===Br?Br=[t]:Br.push(t)}function Vr(){if(!Ur&&null!==Br){Ur=!0;var t=0,e=xe;try{var n=Br;for(xe=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Br=null,zr=!1}catch(r){throw null!==Br&&(Br=Br.slice(t+1)),Xt($t,Vr),r}finally{xe=e,Ur=!1}}return null}var Wr=[],Gr=0,qr=null,Hr=0,Xr=[],Yr=0,Kr=null,Qr=1,Zr="";function Jr(t,e){Wr[Gr++]=Hr,Wr[Gr++]=qr,qr=t,Hr=e}function $r(t,e,n){Xr[Yr++]=Qr,Xr[Yr++]=Zr,Xr[Yr++]=Kr,Kr=t;var i=Qr;t=Zr;var r=32-oe(i)-1;i&=~(1<<r),n+=1;var s=32-oe(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Qr=1<<32-oe(e)+r|n<<r|i,Zr=s+t}else Qr=1<<s|n<<r|i,Zr=t}function ts(t){null!==t.return&&(Jr(t,1),$r(t,1,0))}function es(t){for(;t===qr;)qr=Wr[--Gr],Wr[Gr]=null,Hr=Wr[--Gr],Wr[Gr]=null;for(;t===Kr;)Kr=Xr[--Yr],Xr[Yr]=null,Zr=Xr[--Yr],Xr[Yr]=null,Qr=Xr[--Yr],Xr[Yr]=null}var ns=null,is=null,rs=!1,ss=null;function os(t,e){var n=Nl(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function as(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,ns=t,is=lr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,ns=t,is=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Kr?{id:Qr,overflow:Zr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Nl(18,null,null,0)).stateNode=e,n.return=t,t.child=n,ns=t,is=null,!0);default:return!1}}function cs(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ls(t){if(rs){var e=is;if(e){var n=e;if(!as(t,e)){if(cs(t))throw Error(s(418));e=lr(n.nextSibling);var i=ns;e&&as(t,e)?os(i,n):(t.flags=-4097&t.flags|2,rs=!1,ns=t)}}else{if(cs(t))throw Error(s(418));t.flags=-4097&t.flags|2,rs=!1,ns=t}}}function us(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;ns=t}function hs(t){if(t!==ns)return!1;if(!rs)return us(t),rs=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=is)){if(cs(t))throw ds(),Error(s(418));for(;e;)os(t,e),e=lr(e.nextSibling)}if(us(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){is=lr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}is=null}}else is=ns?lr(t.stateNode.nextSibling):null;return!0}function ds(){for(var t=is;t;)t=lr(t.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(t){null===ss?ss=[t]:ss.push(t)}var ms=b.ReactCurrentBatchConfig;function gs(t,e){if(t&&t.defaultProps){for(var n in e=L({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var vs=Tr(null),ys=null,xs=null,bs=null;function ws(){bs=xs=ys=null}function Ss(t){var e=vs.current;Er(vs),t._currentValue=e}function _s(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Ts(t,e){ys=t,bs=xs=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ba=!0),t.firstContext=null)}function Es(t){var e=t._currentValue;if(bs!==t)if(t={context:t,memoizedValue:e,next:null},null===xs){if(null===ys)throw Error(s(308));xs=t,ys.dependencies={lanes:0,firstContext:t}}else xs=xs.next=t;return e}var Cs=null;function ks(t){null===Cs?Cs=[t]:Cs.push(t)}function As(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,ks(e)):(n.next=r.next,r.next=n),e.interleaved=n,Is(t,i)}function Is(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Rs(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ns(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ms(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ds(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Ic)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Is(t,n)}return null===(r=i.interleaved)?(e.next=e,ks(i)):(e.next=r.next,r.next=e),i.interleaved=e,Is(t,n)}function Ps(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}function Fs(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=e:s=s.next=e}else r=s=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ls(t,e,n,i){var r=t.updateQueue;Os=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var c=a,l=c.next;c.next=null,null===o?s=l:o.next=l,o=c;var u=t.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==s){var h=r.baseState;for(o=0,u=l=c=null,a=s;;){var d=a.lane,p=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var f=t,m=a;switch(d=e,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break t}h=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break t;h=L({},h,d);break t;case 2:Os=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=p,c=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(c=h),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null!==(e=r.shared.interleaved)){r=e;do{o|=r.lane,r=r.next}while(r!==e)}else null===s&&(r.shared.lanes=0);Lc|=o,t.lanes=o,t.memoizedState=h}}function Bs(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var zs=(new i.Component).refs;function Us(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:L({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var js={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=el(),r=nl(t),s=Ms(i,r);s.payload=e,void 0!==n&&null!==n&&(s.callback=n),null!==(e=Ds(t,s,r))&&(il(e,t,r,i),Ps(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=el(),r=nl(t),s=Ms(i,r);s.tag=1,s.payload=e,void 0!==n&&null!==n&&(s.callback=n),null!==(e=Ds(t,s,r))&&(il(e,t,r,i),Ps(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=el(),i=nl(t),r=Ms(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),null!==(e=Ds(t,r,i))&&(il(e,t,i,n),Ps(e,t,i))}};function Vs(t,e,n,i,r,s,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,s,o):!e.prototype||!e.prototype.isPureReactComponent||(!ci(n,i)||!ci(r,s))}function Ws(t,e,n){var i=!1,r=kr,s=e.contextType;return"object"===typeof s&&null!==s?s=Es(s):(r=Nr(e)?Or:Ar.current,s=(i=null!==(i=e.contextTypes)&&void 0!==i)?Rr(t,r):kr),e=new e(n,s),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=js,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function Gs(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&js.enqueueReplaceState(e,e.state,null)}function qs(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=zs,Rs(t);var s=e.contextType;"object"===typeof s&&null!==s?r.context=Es(s):(s=Nr(e)?Or:Ar.current,r.context=Rr(t,s)),r.state=t.memoizedState,"function"===typeof(s=e.getDerivedStateFromProps)&&(Us(t,e,s,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&js.enqueueReplaceState(r,r.state,null),Ls(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}function Hs(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,t));var r=i,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=r.refs;e===zs&&(e=r.refs={}),null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function Xs(t,e){throw t=Object.prototype.toString.call(e),Error(s(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ys(t){return(0,t._init)(t._payload)}function Ks(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Dl(t,e)).index=0,t.sibling=null,t}function o(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function c(t,e,n,i){return null===e||6!==e.tag?((e=Bl(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function l(t,e,n,i){var s=n.type;return s===_?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===N&&Ys(s)===e.type)?((i=r(e,n.props)).ref=Hs(t,e,n),i.return=t,i):((i=Pl(n.type,n.key,n.props,null,t.mode,i)).ref=Hs(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=zl(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,s){return null===e||7!==e.tag?((e=Fl(n,t.mode,i,s)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Bl(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(n=Pl(e.type,e.key,e.props,null,t.mode,n)).ref=Hs(t,null,e),n.return=t,n;case S:return(e=zl(e,t.mode,n)).return=t,e;case N:return d(t,(0,e._init)(e._payload),n)}if(et(e)||P(e))return(e=Fl(e,t.mode,n,null)).return=t,e;Xs(t,e)}return null}function p(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:c(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?l(t,e,n,i):null;case S:return n.key===r?u(t,e,n,i):null;case N:return p(t,e,(r=n._init)(n._payload),i)}if(et(n)||P(n))return null!==r?null:h(t,e,n,i,null);Xs(t,n)}return null}function f(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return c(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return l(e,t=t.get(null===i.key?n:i.key)||null,i,r);case S:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case N:return f(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||P(i))return h(e,t=t.get(n)||null,i,r,null);Xs(e,i)}return null}function m(r,s,a,c){for(var l=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(r,h,a[m],c);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(r,h),s=o(v,s,m),null===u?l=v:u.sibling=v,u=v,h=g}if(m===a.length)return n(r,h),rs&&Jr(r,m),l;if(null===h){for(;m<a.length;m++)null!==(h=d(r,a[m],c))&&(s=o(h,s,m),null===u?l=h:u.sibling=h,u=h);return rs&&Jr(r,m),l}for(h=i(r,h);m<a.length;m++)null!==(g=f(h,r,m,a[m],c))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?l=g:u.sibling=g,u=g);return t&&h.forEach((function(t){return e(r,t)})),rs&&Jr(r,m),l}function g(r,a,c,l){var u=P(c);if("function"!==typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var x=p(r,m,y.value,l);if(null===x){null===m&&(m=v);break}t&&m&&null===x.alternate&&e(r,m),a=o(x,a,g),null===h?u=x:h.sibling=x,h=x,m=v}if(y.done)return n(r,m),rs&&Jr(r,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=d(r,y.value,l))&&(a=o(y,a,g),null===h?u=y:h.sibling=y,h=y);return rs&&Jr(r,g),u}for(m=i(r,m);!y.done;g++,y=c.next())null!==(y=f(m,r,g,y.value,l))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===h?u=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(r,t)})),rs&&Jr(r,g),u}return function t(i,s,o,c){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:t:{for(var l=o.key,u=s;null!==u;){if(u.key===l){if((l=o.type)===_){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break t}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===N&&Ys(l)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=Hs(i,u,o),s.return=i,i=s;break t}n(i,u);break}e(i,u),u=u.sibling}o.type===_?((s=Fl(o.props.children,i.mode,c,o.key)).return=i,i=s):((c=Pl(o.type,o.key,o.props,null,i.mode,c)).ref=Hs(i,s,o),c.return=i,i=c)}return a(i);case S:t:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break t}n(i,s);break}e(i,s),s=s.sibling}(s=zl(o,i.mode,c)).return=i,i=s}return a(i);case N:return t(i,s,(u=o._init)(o._payload),c)}if(et(o))return m(i,s,o,c);if(P(o))return g(i,s,o,c);Xs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Bl(o,i.mode,c)).return=i,i=s),a(i)):n(i,s)}}var Qs=Ks(!0),Zs=Ks(!1),Js={},$s=Tr(Js),to=Tr(Js),eo=Tr(Js);function no(t){if(t===Js)throw Error(s(174));return t}function io(t,e){switch(Cr(eo,e),Cr(to,t),Cr($s,Js),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ct(null,"");break;default:e=ct(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Er($s),Cr($s,e)}function ro(){Er($s),Er(to),Er(eo)}function so(t){no(eo.current);var e=no($s.current),n=ct(e,t.type);e!==n&&(Cr(to,t),Cr($s,n))}function oo(t){to.current===t&&(Er($s),Er(to))}var ao=Tr(0);function co(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lo=[];function uo(){for(var t=0;t<lo.length;t++)lo[t]._workInProgressVersionPrimary=null;lo.length=0}var ho=b.ReactCurrentDispatcher,po=b.ReactCurrentBatchConfig,fo=0,mo=null,go=null,vo=null,yo=!1,xo=!1,bo=0,wo=0;function So(){throw Error(s(321))}function _o(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ai(t[n],e[n]))return!1;return!0}function To(t,e,n,i,r,o){if(fo=o,mo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ho.current=null===t||null===t.memoizedState?aa:ca,t=n(i,r),xo){o=0;do{if(xo=!1,bo=0,25<=o)throw Error(s(301));o+=1,vo=go=null,e.updateQueue=null,ho.current=la,t=n(i,r)}while(xo)}if(ho.current=oa,e=null!==go&&null!==go.next,fo=0,vo=go=mo=null,yo=!1,e)throw Error(s(300));return t}function Eo(){var t=0!==bo;return bo=0,t}function Co(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?mo.memoizedState=vo=t:vo=vo.next=t,vo}function ko(){if(null===go){var t=mo.alternate;t=null!==t?t.memoizedState:null}else t=go.next;var e=null===vo?mo.memoizedState:vo.next;if(null!==e)vo=e,go=t;else{if(null===t)throw Error(s(310));t={memoizedState:(go=t).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===vo?mo.memoizedState=vo=t:vo=vo.next=t}return vo}function Ao(t,e){return"function"===typeof e?e(t):e}function Io(t){var e=ko(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=go,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var c=a=null,l=null,u=o;do{var h=u.lane;if((fo&h)===h)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,a=i):l=l.next=d,mo.lanes|=h,Lc|=h}u=u.next}while(null!==u&&u!==o);null===l?a=i:l.next=c,ai(i,e.memoizedState)||(ba=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{o=r.lane,mo.lanes|=o,Lc|=o,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Oo(t){var e=ko(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,o=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=t(o,a.action),a=a.next}while(a!==r);ai(o,e.memoizedState)||(ba=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function Ro(){}function No(t,e){var n=mo,i=ko(),r=e(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ba=!0),i=i.queue,Go(Po.bind(null,n,i,t),[t]),i.getSnapshot!==e||o||null!==vo&&1&vo.memoizedState.tag){if(n.flags|=2048,zo(9,Do.bind(null,n,i,r,e),void 0,null),null===Oc)throw Error(s(349));0!==(30&fo)||Mo(n,e,r)}return r}function Mo(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=mo.updateQueue)?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Do(t,e,n,i){e.value=n,e.getSnapshot=i,Fo(e)&&Lo(t)}function Po(t,e,n){return n((function(){Fo(e)&&Lo(t)}))}function Fo(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ai(t,n)}catch(i){return!0}}function Lo(t){var e=Is(t,1);null!==e&&il(e,t,1,-1)}function Bo(t){var e=Co();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:t},e.queue=t,t=t.dispatch=na.bind(null,mo,t),[e.memoizedState,t]}function zo(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=mo.updateQueue)?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Uo(){return ko().memoizedState}function jo(t,e,n,i){var r=Co();mo.flags|=t,r.memoizedState=zo(1|e,n,void 0,void 0===i?null:i)}function Vo(t,e,n,i){var r=ko();i=void 0===i?null:i;var s=void 0;if(null!==go){var o=go.memoizedState;if(s=o.destroy,null!==i&&_o(i,o.deps))return void(r.memoizedState=zo(e,n,s,i))}mo.flags|=t,r.memoizedState=zo(1|e,n,s,i)}function Wo(t,e){return jo(8390656,8,t,e)}function Go(t,e){return Vo(2048,8,t,e)}function qo(t,e){return Vo(4,2,t,e)}function Ho(t,e){return Vo(4,4,t,e)}function Xo(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Yo(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Vo(4,4,Xo.bind(null,e,t),n)}function Ko(){}function Qo(t,e){var n=ko();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&_o(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Zo(t,e){var n=ko();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&_o(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Jo(t,e,n){return 0===(21&fo)?(t.baseState&&(t.baseState=!1,ba=!0),t.memoizedState=n):(ai(n,e)||(n=me(),mo.lanes|=n,Lc|=n,t.baseState=!0),e)}function $o(t,e){var n=xe;xe=0!==n&&4>n?n:4,t(!0);var i=po.transition;po.transition={};try{t(!1),e()}finally{xe=n,po.transition=i}}function ta(){return ko().memoizedState}function ea(t,e,n){var i=nl(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ia(t))ra(e,n);else if(null!==(n=As(t,e,n,i))){il(n,t,i,el()),sa(n,e,i)}}function na(t,e,n){var i=nl(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(t))ra(e,r);else{var s=t.alternate;if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var c=e.interleaved;return null===c?(r.next=r,ks(e)):(r.next=c.next,c.next=r),void(e.interleaved=r)}}catch(l){}null!==(n=As(t,e,r,i))&&(il(n,t,i,r=el()),sa(n,e,i))}}function ia(t){var e=t.alternate;return t===mo||null!==e&&e===mo}function ra(t,e){xo=yo=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function sa(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}var oa={readContext:Es,useCallback:So,useContext:So,useEffect:So,useImperativeHandle:So,useInsertionEffect:So,useLayoutEffect:So,useMemo:So,useReducer:So,useRef:So,useState:So,useDebugValue:So,useDeferredValue:So,useTransition:So,useMutableSource:So,useSyncExternalStore:So,useId:So,unstable_isNewReconciler:!1},aa={readContext:Es,useCallback:function(t,e){return Co().memoizedState=[t,void 0===e?null:e],t},useContext:Es,useEffect:Wo,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,jo(4194308,4,Xo.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jo(4194308,4,t,e)},useInsertionEffect:function(t,e){return jo(4,2,t,e)},useMemo:function(t,e){var n=Co();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Co();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=ea.bind(null,mo,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},Co().memoizedState=t},useState:Bo,useDebugValue:Ko,useDeferredValue:function(t){return Co().memoizedState=t},useTransition:function(){var t=Bo(!1),e=t[0];return t=$o.bind(null,t[1]),Co().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=mo,r=Co();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=e(),null===Oc)throw Error(s(349));0!==(30&fo)||Mo(i,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,Wo(Po.bind(null,i,o,t),[t]),i.flags|=2048,zo(9,Do.bind(null,i,o,n,e),void 0,null),n},useId:function(){var t=Co(),e=Oc.identifierPrefix;if(rs){var n=Zr;e=":"+e+"R"+(n=(Qr&~(1<<32-oe(Qr)-1)).toString(32)+n),0<(n=bo++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=wo++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ca={readContext:Es,useCallback:Qo,useContext:Es,useEffect:Go,useImperativeHandle:Yo,useInsertionEffect:qo,useLayoutEffect:Ho,useMemo:Zo,useReducer:Io,useRef:Uo,useState:function(){return Io(Ao)},useDebugValue:Ko,useDeferredValue:function(t){return Jo(ko(),go.memoizedState,t)},useTransition:function(){return[Io(Ao)[0],ko().memoizedState]},useMutableSource:Ro,useSyncExternalStore:No,useId:ta,unstable_isNewReconciler:!1},la={readContext:Es,useCallback:Qo,useContext:Es,useEffect:Go,useImperativeHandle:Yo,useInsertionEffect:qo,useLayoutEffect:Ho,useMemo:Zo,useReducer:Oo,useRef:Uo,useState:function(){return Oo(Ao)},useDebugValue:Ko,useDeferredValue:function(t){var e=ko();return null===go?e.memoizedState=t:Jo(e,go.memoizedState,t)},useTransition:function(){return[Oo(Ao)[0],ko().memoizedState]},useMutableSource:Ro,useSyncExternalStore:No,useId:ta,unstable_isNewReconciler:!1};function ua(t,e){try{var n="",i=e;do{n+=j(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:t,source:e,stack:r,digest:null}}function ha(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function da(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(t,e,n){(n=Ms(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){qc||(qc=!0,Hc=i),da(0,e)},n}function ma(t,e,n){(n=Ms(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){da(0,e)}}var s=t.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,e),"function"!==typeof i&&(null===Xc?Xc=new Set([this]):Xc.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ga(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new pa;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Cl.bind(null,t,e,n),e.then(t,t))}function va(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ya(t,e,n,i,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Ms(-1,1)).tag=2,Ds(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var xa=b.ReactCurrentOwner,ba=!1;function wa(t,e,n,i){e.child=null===t?Zs(e,null,n,i):Qs(e,t.child,n,i)}function Sa(t,e,n,i,r){n=n.render;var s=e.ref;return Ts(e,r),i=To(t,e,n,i,s,r),n=Eo(),null===t||ba?(rs&&n&&ts(e),e.flags|=1,wa(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,qa(t,e,r))}function _a(t,e,n,i,r){if(null===t){var s=n.type;return"function"!==typeof s||Ml(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Pl(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Ta(t,e,s,i,r))}if(s=t.child,0===(t.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:ci)(o,i)&&t.ref===e.ref)return qa(t,e,r)}return e.flags|=1,(t=Dl(s,i)).ref=e.ref,t.return=e,e.child=t}function Ta(t,e,n,i,r){if(null!==t){var s=t.memoizedProps;if(ci(s,i)&&t.ref===e.ref){if(ba=!1,e.pendingProps=i=s,0===(t.lanes&r))return e.lanes=t.lanes,qa(t,e,r);0!==(131072&t.flags)&&(ba=!0)}}return ka(t,e,n,i,r)}function Ea(t,e,n){var i=e.pendingProps,r=i.children,s=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Dc,Mc),Mc|=n;else{if(0===(1073741824&n))return t=null!==s?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cr(Dc,Mc),Mc|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Cr(Dc,Mc),Mc|=i}else null!==s?(i=s.baseLanes|n,e.memoizedState=null):i=n,Cr(Dc,Mc),Mc|=i;return wa(t,e,r,n),e.child}function Ca(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ka(t,e,n,i,r){var s=Nr(n)?Or:Ar.current;return s=Rr(e,s),Ts(e,r),n=To(t,e,n,i,s,r),i=Eo(),null===t||ba?(rs&&i&&ts(e),e.flags|=1,wa(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,qa(t,e,r))}function Aa(t,e,n,i,r){if(Nr(n)){var s=!0;Fr(e)}else s=!1;if(Ts(e,r),null===e.stateNode)Ga(t,e),Ws(e,n,i),qs(e,n,i,r),i=!0;else if(null===t){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=Es(l):l=Rr(e,l=Nr(n)?Or:Ar.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||c!==l)&&Gs(e,o,i,l),Os=!1;var d=e.memoizedState;o.state=d,Ls(e,i,o,r),c=e.memoizedState,a!==i||d!==c||Ir.current||Os?("function"===typeof u&&(Us(e,n,u,i),c=e.memoizedState),(a=Os||Vs(e,n,a,i,d,c,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=l,i=a):("function"===typeof o.componentDidMount&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,Ns(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:gs(e.type,a),o.props=l,h=e.pendingProps,d=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=Es(c):c=Rr(e,c=Nr(n)?Or:Ar.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==c)&&Gs(e,o,i,c),Os=!1,d=e.memoizedState,o.state=d,Ls(e,i,o,r);var f=e.memoizedState;a!==h||d!==f||Ir.current||Os?("function"===typeof p&&(Us(e,n,p,i),f=e.memoizedState),(l=Os||Vs(e,n,l,i,d,f,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,c)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),o.props=i,o.state=f,o.context=c,i=l):("function"!==typeof o.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Ia(t,e,n,i,s,r)}function Ia(t,e,n,i,r,s){Ca(t,e);var o=0!==(128&e.flags);if(!i&&!o)return r&&Lr(e,n,!1),qa(t,e,s);i=e.stateNode,xa.current=e;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&o?(e.child=Qs(e,t.child,null,s),e.child=Qs(e,null,a,s)):wa(t,e,a,s),e.memoizedState=i.state,r&&Lr(e,n,!0),e.child}function Oa(t){var e=t.stateNode;e.pendingContext?Dr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Dr(0,e.context,!1),io(t,e.containerInfo)}function Ra(t,e,n,i,r){return ps(),fs(r),e.flags|=256,wa(t,e,n,i),e.child}var Na,Ma,Da,Pa,Fa={dehydrated:null,treeContext:null,retryLane:0};function La(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ba(t,e,n){var i,r=e.pendingProps,o=ao.current,a=!1,c=0!==(128&e.flags);if((i=c)||(i=(null===t||null!==t.memoizedState)&&0!==(2&o)),i?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),Cr(ao,1&o),null===t)return ls(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(c=r.children,t=r.fallback,a?(r=e.mode,a=e.child,c={mode:"hidden",children:c},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ll(c,r,0,null),t=Fl(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=La(n),e.memoizedState=Fa,t):za(e,c));if(null!==(o=t.memoizedState)&&null!==(i=o.dehydrated))return function(t,e,n,i,r,o,a){if(n)return 256&e.flags?(e.flags&=-257,Ua(t,e,a,i=ha(Error(s(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=Ll({mode:"visible",children:i.children},r,0,null),(o=Fl(o,r,a,null)).flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,0!==(1&e.mode)&&Qs(e,t.child,null,a),e.child.memoizedState=La(a),e.memoizedState=Fa,o);if(0===(1&e.mode))return Ua(t,e,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var c=i.dgst;return i=c,Ua(t,e,a,i=ha(o=Error(s(419)),i,void 0))}if(c=0!==(a&t.childLanes),ba||c){if(null!==(i=Oc)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Is(t,r),il(i,t,r,-1))}return gl(),Ua(t,e,a,i=ha(Error(s(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Al.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,is=lr(r.nextSibling),ns=e,rs=!0,ss=null,null!==t&&(Xr[Yr++]=Qr,Xr[Yr++]=Zr,Xr[Yr++]=Kr,Qr=t.id,Zr=t.overflow,Kr=e),e=za(e,i.children),e.flags|=4096,e)}(t,e,c,r,i,o,n);if(a){a=r.fallback,c=e.mode,i=(o=t.child).sibling;var l={mode:"hidden",children:r.children};return 0===(1&c)&&e.child!==o?((r=e.child).childLanes=0,r.pendingProps=l,e.deletions=null):(r=Dl(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Dl(i,a):(a=Fl(a,c,n,null)).flags|=2,a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,c=null===(c=t.child.memoizedState)?La(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=t.childLanes&~n,e.memoizedState=Fa,r}return t=(a=t.child).sibling,r=Dl(a,{mode:"visible",children:r.children}),0===(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function za(t,e){return(e=Ll({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Ua(t,e,n,i){return null!==i&&fs(i),Qs(e,t.child,null,n),(t=za(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function ja(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),_s(t.return,e,n)}function Va(t,e,n,i,r){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Wa(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(wa(t,e,i.children,n),0!==(2&(i=ao.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ja(t,n,e);else if(19===t.tag)ja(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Cr(ao,i),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===co(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Va(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===co(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Va(e,!0,n,null,s);break;case"together":Va(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ga(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qa(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Lc|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Dl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Dl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ha(t,e){if(!rs)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Xa(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Ya(t,e,n){var i=e.pendingProps;switch(es(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(e),null;case 1:case 17:return Nr(e.type)&&Mr(),Xa(e),null;case 3:return i=e.stateNode,ro(),Er(Ir),Er(Ar),uo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(hs(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==ss&&(al(ss),ss=null))),Ma(t,e),Xa(e),null;case 5:oo(e);var r=no(eo.current);if(n=e.type,null!==t&&null!=e.stateNode)Da(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(s(166));return Xa(e),null}if(t=no($s.current),hs(e)){i=e.stateNode,n=e.type;var o=e.memoizedProps;switch(i[dr]=e,i[pr]=o,t=0!==(1&e.mode),n){case"dialog":zi("cancel",i),zi("close",i);break;case"iframe":case"object":case"embed":zi("load",i);break;case"video":case"audio":for(r=0;r<Pi.length;r++)zi(Pi[r],i);break;case"source":zi("error",i);break;case"img":case"image":case"link":zi("error",i),zi("load",i);break;case"details":zi("toggle",i);break;case"input":Q(i,o),zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},zi("invalid",i);break;case"textarea":rt(i,o),zi("invalid",i)}for(var c in yt(n,o),r=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?i.textContent!==l&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,l,t),r=["children",l]):"number"===typeof l&&i.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,l,t),r=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&zi("scroll",i)}switch(n){case"input":H(i),$(i,o,!0);break;case"textarea":H(i),ot(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=$i)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{c=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=c.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=c.createElement(n,{is:i.is}):(t=c.createElement(n),"select"===n&&(c=t,i.multiple?c.multiple=!0:i.size&&(c.size=i.size))):t=c.createElementNS(t,n),t[dr]=e,t[pr]=i,Na(t,e,!1,!1),e.stateNode=t;t:{switch(c=xt(n,i),n){case"dialog":zi("cancel",t),zi("close",t),r=i;break;case"iframe":case"object":case"embed":zi("load",t),r=i;break;case"video":case"audio":for(r=0;r<Pi.length;r++)zi(Pi[r],t);r=i;break;case"source":zi("error",t),r=i;break;case"img":case"image":case"link":zi("error",t),zi("load",t),r=i;break;case"details":zi("toggle",t),r=i;break;case"input":Q(t,i),r=K(t,i),zi("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=L({},i,{value:void 0}),zi("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),zi("invalid",t)}for(o in yt(n,r),l=r)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?gt(t,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&zi("scroll",t):null!=u&&x(t,o,u,c))}switch(n){case"input":H(t),$(t,i,!1);break;case"textarea":H(t),ot(t);break;case"option":null!=i.value&&t.setAttribute("value",""+G(i.value));break;case"select":t.multiple=!!i.multiple,null!=(o=i.value)?nt(t,!!i.multiple,o,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Xa(e),null;case 6:if(t&&null!=e.stateNode)Pa(t,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(s(166));if(n=no(eo.current),no($s.current),hs(e)){if(i=e.stateNode,n=e.memoizedProps,i[dr]=e,(o=i.nodeValue!==n)&&null!==(t=ns))switch(t.tag){case 3:Ji(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&t.mode))}o&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=e,e.stateNode=i}return Xa(e),null;case 13:if(Er(ao),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&e.mode)&&0===(128&e.flags))ds(),ps(),e.flags|=98560,o=!1;else if(o=hs(e),null!==i&&null!==i.dehydrated){if(null===t){if(!o)throw Error(s(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=e}else ps(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Xa(e),o=!1}else null!==ss&&(al(ss),ss=null),o=!0;if(!o)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((i=null!==i)!==(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&ao.current)?0===Pc&&(Pc=3):gl())),null!==e.updateQueue&&(e.flags|=4),Xa(e),null);case 4:return ro(),Ma(t,e),null===t&&Vi(e.stateNode.containerInfo),Xa(e),null;case 10:return Ss(e.type._context),Xa(e),null;case 19:if(Er(ao),null===(o=e.memoizedState))return Xa(e),null;if(i=0!==(128&e.flags),null===(c=o.rendering))if(i)Ha(o,!1);else{if(0!==Pc||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(c=co(t))){for(e.flags|=128,Ha(o,!1),null!==(i=c.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,t=c.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Cr(ao,1&ao.current|2),e.child}t=t.sibling}null!==o.tail&&Zt()>Wc&&(e.flags|=128,i=!0,Ha(o,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=co(c))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Ha(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!rs)return Xa(e),null}else 2*Zt()-o.renderingStartTime>Wc&&1073741824!==n&&(e.flags|=128,i=!0,Ha(o,!1),e.lanes=4194304);o.isBackwards?(c.sibling=e.child,e.child=c):(null!==(n=o.last)?n.sibling=c:e.child=c,o.last=c)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Zt(),e.sibling=null,n=ao.current,Cr(ao,i?1&n|2:1&n),e):(Xa(e),null);case 22:case 23:return dl(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Mc)&&(Xa(e),6&e.subtreeFlags&&(e.flags|=8192)):Xa(e),null;case 24:case 25:return null}throw Error(s(156,e.tag))}function Ka(t,e){switch(es(e),e.tag){case 1:return Nr(e.type)&&Mr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return ro(),Er(Ir),Er(Ar),uo(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return oo(e),null;case 13:if(Er(ao),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(s(340));ps()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Er(ao),null;case 4:return ro(),null;case 10:return Ss(e.type._context),null;case 22:case 23:return dl(),null;default:return null}}Na=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ma=function(){},Da=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,no($s.current);var s,o=null;switch(n){case"input":r=K(t,r),i=K(t,i),o=[];break;case"select":r=L({},r,{value:void 0}),i=L({},i,{value:void 0}),o=[];break;case"textarea":r=it(t,r),i=it(t,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(t.onclick=$i)}for(u in yt(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var c=r[u];for(s in c)c.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var l=i[u];if(c=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(s in c)!c.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&c[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&zi("scroll",t),o||c===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}},Pa=function(t,e,n,i){n!==i&&(e.flags|=4)};var Qa=!1,Za=!1,Ja="function"===typeof WeakSet?WeakSet:Set,$a=null;function tc(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){El(t,e,i)}else n.current=null}function ec(t,e,n){try{n()}catch(i){El(t,e,i)}}var nc=!1;function ic(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,void 0!==s&&ec(e,n,s)}r=r.next}while(r!==i)}}function rc(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function sc(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function oc(t){var e=t.alternate;null!==e&&(t.alternate=null,oc(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[dr],delete e[pr],delete e[mr],delete e[gr],delete e[vr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ac(t){return 5===t.tag||3===t.tag||4===t.tag}function cc(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||ac(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function lc(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=$i));else if(4!==i&&null!==(t=t.child))for(lc(t,e,n),t=t.sibling;null!==t;)lc(t,e,n),t=t.sibling}function uc(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(uc(t,e,n),t=t.sibling;null!==t;)uc(t,e,n),t=t.sibling}var hc=null,dc=!1;function pc(t,e,n){for(n=n.child;null!==n;)fc(t,e,n),n=n.sibling}function fc(t,e,n){if(se&&"function"===typeof se.onCommitFiberUnmount)try{se.onCommitFiberUnmount(re,n)}catch(a){}switch(n.tag){case 5:Za||tc(n,e);case 6:var i=hc,r=dc;hc=null,pc(t,e,n),dc=r,null!==(hc=i)&&(dc?(t=hc,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):hc.removeChild(n.stateNode));break;case 18:null!==hc&&(dc?(t=hc,n=n.stateNode,8===t.nodeType?cr(t.parentNode,n):1===t.nodeType&&cr(t,n),Ve(t)):cr(hc,n.stateNode));break;case 4:i=hc,r=dc,hc=n.stateNode.containerInfo,dc=!0,pc(t,e,n),hc=i,dc=r;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&ec(n,e,o),r=r.next}while(r!==i)}pc(t,e,n);break;case 1:if(!Za&&(tc(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){El(n,e,a)}pc(t,e,n);break;case 21:pc(t,e,n);break;case 22:1&n.mode?(Za=(i=Za)||null!==n.memoizedState,pc(t,e,n),Za=i):pc(t,e,n);break;default:pc(t,e,n)}}function mc(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ja),e.forEach((function(e){var i=Il.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function gc(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=t,a=e,c=a;t:for(;null!==c;){switch(c.tag){case 5:hc=c.stateNode,dc=!1;break t;case 3:case 4:hc=c.stateNode.containerInfo,dc=!0;break t}c=c.return}if(null===hc)throw Error(s(160));fc(o,a,r),hc=null,dc=!1;var l=r.alternate;null!==l&&(l.return=null),r.return=null}catch(u){El(r,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)vc(e,t),e=e.sibling}function vc(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gc(e,t),yc(t),4&i){try{ic(3,t,t.return),rc(3,t)}catch(g){El(t,t.return,g)}try{ic(5,t,t.return)}catch(g){El(t,t.return,g)}}break;case 1:gc(e,t),yc(t),512&i&&null!==n&&tc(n,n.return);break;case 5:if(gc(e,t),yc(t),512&i&&null!==n&&tc(n,n.return),32&t.flags){var r=t.stateNode;try{dt(r,"")}catch(g){El(t,t.return,g)}}if(4&i&&null!=(r=t.stateNode)){var o=t.memoizedProps,a=null!==n?n.memoizedProps:o,c=t.type,l=t.updateQueue;if(t.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&Z(r,o),xt(c,a);var u=xt(c,o);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];"style"===h?gt(r,d):"dangerouslySetInnerHTML"===h?ht(r,d):"children"===h?dt(r,d):x(r,h,d,u)}switch(c){case"input":J(r,o);break;case"textarea":st(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?nt(r,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?nt(r,!!o.multiple,o.defaultValue,!0):nt(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(g){El(t,t.return,g)}}break;case 6:if(gc(e,t),yc(t),4&i){if(null===t.stateNode)throw Error(s(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(g){El(t,t.return,g)}}break;case 3:if(gc(e,t),yc(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(g){El(t,t.return,g)}break;case 4:default:gc(e,t),yc(t);break;case 13:gc(e,t),yc(t),8192&(r=t.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Vc=Zt())),4&i&&mc(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Za=(u=Za)||h,gc(e,t),Za=u):gc(e,t),yc(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for($a=t,h=t.child;null!==h;){for(d=$a=h;null!==$a;){switch(f=(p=$a).child,p.tag){case 0:case 11:case 14:case 15:ic(4,p,p.return);break;case 1:tc(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){El(i,n,g)}}break;case 5:tc(p,p.return);break;case 22:if(null!==p.memoizedState){Sc(d);continue}}null!==f?(f.return=p,$a=f):Sc(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,a=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=mt("display",a))}catch(g){El(t,t.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){El(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gc(e,t),yc(t),4&i&&mc(t);case 21:}}function yc(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(ac(n)){var i=n;break t}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(dt(r,""),i.flags&=-33),uc(t,cc(t),r);break;case 3:case 4:var o=i.stateNode.containerInfo;lc(t,cc(t),o);break;default:throw Error(s(161))}}catch(a){El(t,t.return,a)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function xc(t,e,n){$a=t,bc(t,e,n)}function bc(t,e,n){for(var i=0!==(1&t.mode);null!==$a;){var r=$a,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Qa;if(!o){var a=r.alternate,c=null!==a&&null!==a.memoizedState||Za;a=Qa;var l=Za;if(Qa=o,(Za=c)&&!l)for($a=r;null!==$a;)c=(o=$a).child,22===o.tag&&null!==o.memoizedState?_c(r):null!==c?(c.return=o,$a=c):_c(r);for(;null!==s;)$a=s,bc(s,e,n),s=s.sibling;$a=r,Qa=a,Za=l}wc(t)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,$a=s):wc(t)}}function wc(t){for(;null!==$a;){var e=$a;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Za||rc(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Za)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:gs(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&Bs(e,o,i);break;case 3:var a=e.updateQueue;if(null!==a){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Bs(e,a,n)}break;case 5:var c=e.stateNode;if(null===n&&4&e.flags){n=c;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ve(d)}}}break;default:throw Error(s(163))}Za||512&e.flags&&sc(e)}catch(p){El(e,e.return,p)}}if(e===t){$a=null;break}if(null!==(n=e.sibling)){n.return=e.return,$a=n;break}$a=e.return}}function Sc(t){for(;null!==$a;){var e=$a;if(e===t){$a=null;break}var n=e.sibling;if(null!==n){n.return=e.return,$a=n;break}$a=e.return}}function _c(t){for(;null!==$a;){var e=$a;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rc(4,e)}catch(c){El(e,n,c)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(c){El(e,r,c)}}var s=e.return;try{sc(e)}catch(c){El(e,s,c)}break;case 5:var o=e.return;try{sc(e)}catch(c){El(e,o,c)}}}catch(c){El(e,e.return,c)}if(e===t){$a=null;break}var a=e.sibling;if(null!==a){a.return=e.return,$a=a;break}$a=e.return}}var Tc,Ec=Math.ceil,Cc=b.ReactCurrentDispatcher,kc=b.ReactCurrentOwner,Ac=b.ReactCurrentBatchConfig,Ic=0,Oc=null,Rc=null,Nc=0,Mc=0,Dc=Tr(0),Pc=0,Fc=null,Lc=0,Bc=0,zc=0,Uc=null,jc=null,Vc=0,Wc=1/0,Gc=null,qc=!1,Hc=null,Xc=null,Yc=!1,Kc=null,Qc=0,Zc=0,Jc=null,$c=-1,tl=0;function el(){return 0!==(6&Ic)?Zt():-1!==$c?$c:$c=Zt()}function nl(t){return 0===(1&t.mode)?1:0!==(2&Ic)&&0!==Nc?Nc&-Nc:null!==ms.transition?(0===tl&&(tl=me()),tl):0!==(t=xe)?t:t=void 0===(t=window.event)?16:Qe(t.type)}function il(t,e,n,i){if(50<Zc)throw Zc=0,Jc=null,Error(s(185));ve(t,n,i),0!==(2&Ic)&&t===Oc||(t===Oc&&(0===(2&Ic)&&(Bc|=n),4===Pc&&cl(t,Nc)),rl(t,i),1===n&&0===Ic&&0===(1&e.mode)&&(Wc=Zt()+500,zr&&Vr()))}function rl(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-oe(s),a=1<<o,c=r[o];-1===c?0!==(a&n)&&0===(a&i)||(r[o]=pe(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}(t,e);var i=de(t,t===Oc?Nc:0);if(0===i)null!==n&&Yt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Yt(n),1===e)0===t.tag?function(t){zr=!0,jr(t)}(ll.bind(null,t)):jr(ll.bind(null,t)),or((function(){0===(6&Ic)&&Vr()})),n=null;else{switch(be(i)){case 1:n=$t;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Ol(n,sl.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sl(t,e){if($c=-1,tl=0,0!==(6&Ic))throw Error(s(327));var n=t.callbackNode;if(_l()&&t.callbackNode!==n)return null;var i=de(t,t===Oc?Nc:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=vl(t,i);else{e=i;var r=Ic;Ic|=2;var o=ml();for(Oc===t&&Nc===e||(Gc=null,Wc=Zt()+500,pl(t,e));;)try{xl();break}catch(c){fl(t,c)}ws(),Cc.current=o,Ic=r,null!==Rc?e=0:(Oc=null,Nc=0,e=Pc)}if(0!==e){if(2===e&&(0!==(r=fe(t))&&(i=r,e=ol(t,r))),1===e)throw n=Fc,pl(t,0),cl(t,i),rl(t,Zt()),n;if(6===e)cl(t,i);else{if(r=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=vl(t,i))&&(0!==(o=fe(t))&&(i=o,e=ol(t,o))),1===e))throw n=Fc,pl(t,0),cl(t,i),rl(t,Zt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(s(345));case 2:case 5:Sl(t,jc,Gc);break;case 3:if(cl(t,i),(130023424&i)===i&&10<(e=Vc+500-Zt())){if(0!==de(t,0))break;if(((r=t.suspendedLanes)&i)!==i){el(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(Sl.bind(null,t,jc,Gc),e);break}Sl(t,jc,Gc);break;case 4:if(cl(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-oe(i);o=1<<a,(a=e[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Zt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Ec(i/1960))-i)){t.timeoutHandle=ir(Sl.bind(null,t,jc,Gc),i);break}Sl(t,jc,Gc);break;default:throw Error(s(329))}}}return rl(t,Zt()),t.callbackNode===n?sl.bind(null,t):null}function ol(t,e){var n=Uc;return t.current.memoizedState.isDehydrated&&(pl(t,e).flags|=256),2!==(t=vl(t,e))&&(e=jc,jc=n,null!==e&&al(e)),t}function al(t){null===jc?jc=t:jc.push.apply(jc,t)}function cl(t,e){for(e&=~zc,e&=~Bc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),i=1<<n;t[n]=-1,e&=~i}}function ll(t){if(0!==(6&Ic))throw Error(s(327));_l();var e=de(t,0);if(0===(1&e))return rl(t,Zt()),null;var n=vl(t,e);if(0!==t.tag&&2===n){var i=fe(t);0!==i&&(e=i,n=ol(t,i))}if(1===n)throw n=Fc,pl(t,0),cl(t,e),rl(t,Zt()),n;if(6===n)throw Error(s(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Sl(t,jc,Gc),rl(t,Zt()),null}function ul(t,e){var n=Ic;Ic|=1;try{return t(e)}finally{0===(Ic=n)&&(Wc=Zt()+500,zr&&Vr())}}function hl(t){null!==Kc&&0===Kc.tag&&0===(6&Ic)&&_l();var e=Ic;Ic|=1;var n=Ac.transition,i=xe;try{if(Ac.transition=null,xe=1,t)return t()}finally{xe=i,Ac.transition=n,0===(6&(Ic=e))&&Vr()}}function dl(){Mc=Dc.current,Er(Dc)}function pl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==Rc)for(n=Rc.return;null!==n;){var i=n;switch(es(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Mr();break;case 3:ro(),Er(Ir),Er(Ar),uo();break;case 5:oo(i);break;case 4:ro();break;case 13:case 19:Er(ao);break;case 10:Ss(i.type._context);break;case 22:case 23:dl()}n=n.return}if(Oc=t,Rc=t=Dl(t.current,null),Nc=Mc=e,Pc=0,Fc=null,zc=Bc=Lc=0,jc=Uc=null,null!==Cs){for(e=0;e<Cs.length;e++)if(null!==(i=(n=Cs[e]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Cs=null}return t}function fl(t,e){for(;;){var n=Rc;try{if(ws(),ho.current=oa,yo){for(var i=mo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}yo=!1}if(fo=0,vo=go=mo=null,xo=!1,bo=0,kc.current=null,null===n||null===n.return){Pc=1,Fc=e,Rc=null;break}t:{var o=t,a=n.return,c=n,l=e;if(e=Nc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,ya(f,a,c,0,e),1&f.mode&&ga(o,u,e),l=u;var m=(e=f).updateQueue;if(null===m){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break t}if(0===(1&e)){ga(o,u,e),gl();break t}l=Error(s(426))}else if(rs&&1&c.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ya(v,a,c,0,e),fs(ua(l,c));break t}}o=l=ua(l,c),4!==Pc&&(Pc=2),null===Uc?Uc=[o]:Uc.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,Fs(o,fa(0,l,e));break t;case 1:c=l;var y=o.type,x=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Xc||!Xc.has(x)))){o.flags|=65536,e&=-e,o.lanes|=e,Fs(o,ma(o,c,e));break t}}o=o.return}while(null!==o)}wl(n)}catch(b){e=b,Rc===n&&null!==n&&(Rc=n=n.return);continue}break}}function ml(){var t=Cc.current;return Cc.current=oa,null===t?oa:t}function gl(){0!==Pc&&3!==Pc&&2!==Pc||(Pc=4),null===Oc||0===(268435455&Lc)&&0===(268435455&Bc)||cl(Oc,Nc)}function vl(t,e){var n=Ic;Ic|=2;var i=ml();for(Oc===t&&Nc===e||(Gc=null,pl(t,e));;)try{yl();break}catch(r){fl(t,r)}if(ws(),Ic=n,Cc.current=i,null!==Rc)throw Error(s(261));return Oc=null,Nc=0,Pc}function yl(){for(;null!==Rc;)bl(Rc)}function xl(){for(;null!==Rc&&!Kt();)bl(Rc)}function bl(t){var e=Tc(t.alternate,t,Mc);t.memoizedProps=t.pendingProps,null===e?wl(t):Rc=e,kc.current=null}function wl(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Ya(n,e,Mc)))return void(Rc=n)}else{if(null!==(n=Ka(n,e)))return n.flags&=32767,void(Rc=n);if(null===t)return Pc=6,void(Rc=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Rc=e);Rc=e=t}while(null!==e);0===Pc&&(Pc=5)}function Sl(t,e,n){var i=xe,r=Ac.transition;try{Ac.transition=null,xe=1,function(t,e,n,i){do{_l()}while(null!==Kc);if(0!==(6&Ic))throw Error(s(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(s(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-oe(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}(t,o),t===Oc&&(Rc=Oc=null,Nc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yc||(Yc=!0,Ol(ee,(function(){return _l(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Ac.transition,Ac.transition=null;var a=xe;xe=1;var c=Ic;Ic|=4,kc.current=null,function(t,e){if(tr=Ge,pi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break t}var a=0,c=-1,l=-1,u=0,h=0,d=t,p=null;e:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(c=a+r),d!==o||0!==i&&3!==d.nodeType||(l=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===t)break e;if(p===n&&++u===r&&(c=a),p===o&&++h===i&&(l=a),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},Ge=!1,$a=e;null!==$a;)if(t=(e=$a).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,$a=t;else for(;null!==$a;){e=$a;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:gs(e.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){El(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,$a=t;break}$a=e.return}m=nc,nc=!1}(t,n),vc(n,t),fi(er),Ge=!!tr,er=tr=null,t.current=n,xc(n,t,r),Qt(),Ic=c,xe=a,Ac.transition=o}else t.current=n;if(Yc&&(Yc=!1,Kc=t,Qc=r),o=t.pendingLanes,0===o&&(Xc=null),function(t){if(se&&"function"===typeof se.onCommitFiberRoot)try{se.onCommitFiberRoot(re,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),rl(t,Zt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(qc)throw qc=!1,t=Hc,Hc=null,t;0!==(1&Qc)&&0!==t.tag&&_l(),o=t.pendingLanes,0!==(1&o)?t===Jc?Zc++:(Zc=0,Jc=t):Zc=0,Vr()}(t,e,n,i)}finally{Ac.transition=r,xe=i}return null}function _l(){if(null!==Kc){var t=be(Qc),e=Ac.transition,n=xe;try{if(Ac.transition=null,xe=16>t?16:t,null===Kc)var i=!1;else{if(t=Kc,Kc=null,Qc=0,0!==(6&Ic))throw Error(s(331));var r=Ic;for(Ic|=4,$a=t.current;null!==$a;){var o=$a,a=o.child;if(0!==(16&$a.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for($a=u;null!==$a;){var h=$a;switch(h.tag){case 0:case 11:case 15:ic(8,h,o)}var d=h.child;if(null!==d)d.return=h,$a=d;else for(;null!==$a;){var p=(h=$a).sibling,f=h.return;if(oc(h),h===u){$a=null;break}if(null!==p){p.return=f,$a=p;break}$a=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}$a=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,$a=a;else t:for(;null!==$a;){if(0!==(2048&(o=$a).flags))switch(o.tag){case 0:case 11:case 15:ic(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,$a=y;break t}$a=o.return}}var x=t.current;for($a=x;null!==$a;){var b=(a=$a).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,$a=b;else t:for(a=x;null!==$a;){if(0!==(2048&(c=$a).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(S){El(c,c.return,S)}if(c===a){$a=null;break t}var w=c.sibling;if(null!==w){w.return=c.return,$a=w;break t}$a=c.return}}if(Ic=r,Vr(),se&&"function"===typeof se.onPostCommitFiberRoot)try{se.onPostCommitFiberRoot(re,t)}catch(S){}i=!0}return i}finally{xe=n,Ac.transition=e}}return!1}function Tl(t,e,n){t=Ds(t,e=fa(0,e=ua(n,e),1),1),e=el(),null!==t&&(ve(t,1,e),rl(t,e))}function El(t,e,n){if(3===t.tag)Tl(t,t,n);else for(;null!==e;){if(3===e.tag){Tl(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Xc||!Xc.has(i))){e=Ds(e,t=ma(e,t=ua(n,t),1),1),t=el(),null!==e&&(ve(e,1,t),rl(e,t));break}}e=e.return}}function Cl(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=el(),t.pingedLanes|=t.suspendedLanes&n,Oc===t&&(Nc&n)===n&&(4===Pc||3===Pc&&(130023424&Nc)===Nc&&500>Zt()-Vc?pl(t,0):zc|=n),rl(t,e)}function kl(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=el();null!==(t=Is(t,e))&&(ve(t,e,n),rl(t,n))}function Al(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),kl(t,n)}function Il(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(e),kl(t,n)}function Ol(t,e){return Xt(t,e)}function Rl(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nl(t,e,n,i){return new Rl(t,e,n,i)}function Ml(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Dl(t,e){var n=t.alternate;return null===n?((n=Nl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pl(t,e,n,i,r,o){var a=2;if(i=t,"function"===typeof t)Ml(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case _:return Fl(n.children,r,o,e);case T:a=8,r|=8;break;case E:return(t=Nl(12,n,e,2|r)).elementType=E,t.lanes=o,t;case I:return(t=Nl(13,n,e,r)).elementType=I,t.lanes=o,t;case O:return(t=Nl(19,n,e,r)).elementType=O,t.lanes=o,t;case M:return Ll(n,r,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case k:a=9;break t;case A:a=11;break t;case R:a=14;break t;case N:a=16,i=null;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=Nl(a,n,e,r)).elementType=t,e.type=i,e.lanes=o,e}function Fl(t,e,n,i){return(t=Nl(7,t,i,e)).lanes=n,t}function Ll(t,e,n,i){return(t=Nl(22,t,i,e)).elementType=M,t.lanes=n,t.stateNode={isHidden:!1},t}function Bl(t,e,n){return(t=Nl(6,t,null,e)).lanes=n,t}function zl(t,e,n){return(e=Nl(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ul(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function jl(t,e,n,i,r,s,o,a,c){return t=new Ul(t,e,n,a,c),1===e?(e=1,!0===s&&(e|=8)):e=0,s=Nl(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rs(s),t}function Vl(t){if(!t)return kr;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(s(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(s(171))}if(1===t.tag){var n=t.type;if(Nr(n))return Pr(t,n,e)}return e}function Wl(t,e,n,i,r,s,o,a,c){return(t=jl(n,i,!0,t,0,s,0,a,c)).context=Vl(null),n=t.current,(s=Ms(i=el(),r=nl(n))).callback=void 0!==e&&null!==e?e:null,Ds(n,s,r),t.current.lanes=r,ve(t,r,i),rl(t,i),t}function Gl(t,e,n,i){var r=e.current,s=el(),o=nl(r);return n=Vl(n),null===e.context?e.context=n:e.pendingContext=n,(e=Ms(s,o)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Ds(r,e,o))&&(il(t,r,o,s),Ps(t,r,o)),o}function ql(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hl(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Xl(t,e){Hl(t,e),(t=t.alternate)&&Hl(t,e)}Tc=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ir.current)ba=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return ba=!1,function(t,e,n){switch(e.tag){case 3:Oa(e),ps();break;case 5:so(e);break;case 1:Nr(e.type)&&Fr(e);break;case 4:io(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Cr(vs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Cr(ao,1&ao.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Ba(t,e,n):(Cr(ao,1&ao.current),null!==(t=qa(t,e,n))?t.sibling:null);Cr(ao,1&ao.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Wa(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(ao,ao.current),i)break;return null;case 22:case 23:return e.lanes=0,Ea(t,e,n)}return qa(t,e,n)}(t,e,n);ba=0!==(131072&t.flags)}else ba=!1,rs&&0!==(1048576&e.flags)&&$r(e,Hr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Ga(t,e),t=e.pendingProps;var r=Rr(e,Ar.current);Ts(e,n),r=To(null,e,i,t,r,n);var o=Eo();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nr(i)?(o=!0,Fr(e)):o=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Rs(e),r.updater=js,e.stateNode=r,r._reactInternals=e,qs(e,i,t,n),e=Ia(null,e,i,!0,o,n)):(e.tag=0,rs&&o&&ts(e),wa(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Ga(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"===typeof t)return Ml(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===A)return 11;if(t===R)return 14}return 2}(i),t=gs(i,t),r){case 0:e=ka(null,e,i,t,n);break t;case 1:e=Aa(null,e,i,t,n);break t;case 11:e=Sa(null,e,i,t,n);break t;case 14:e=_a(null,e,i,gs(i.type,t),n);break t}throw Error(s(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,ka(t,e,i,r=e.elementType===i?r:gs(i,r),n);case 1:return i=e.type,r=e.pendingProps,Aa(t,e,i,r=e.elementType===i?r:gs(i,r),n);case 3:t:{if(Oa(e),null===t)throw Error(s(387));i=e.pendingProps,r=(o=e.memoizedState).element,Ns(t,e),Ls(e,i,null,n);var a=e.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Ra(t,e,i,n,r=ua(Error(s(423)),e));break t}if(i!==r){e=Ra(t,e,i,n,r=ua(Error(s(424)),e));break t}for(is=lr(e.stateNode.containerInfo.firstChild),ns=e,rs=!0,ss=null,n=Zs(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){e=qa(t,e,n);break t}wa(t,e,i,n)}e=e.child}return e;case 5:return so(e),null===t&&ls(e),i=e.type,r=e.pendingProps,o=null!==t?t.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(e.flags|=32),Ca(t,e),wa(t,e,a,n),e.child;case 6:return null===t&&ls(e),null;case 13:return Ba(t,e,n);case 4:return io(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Qs(e,null,i,n):wa(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,Sa(t,e,i,r=e.elementType===i?r:gs(i,r),n);case 7:return wa(t,e,e.pendingProps,n),e.child;case 8:case 12:return wa(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,a=r.value,Cr(vs,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Ir.current){e=qa(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var c=o.dependencies;if(null!==c){a=o.child;for(var l=c.firstContext;null!==l;){if(l.context===i){if(1===o.tag){(l=Ms(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),_s(o.return,n,e),c.lanes|=n;break}l=l.next}}else if(10===o.tag)a=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),_s(a,n,e),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===e){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Ts(e,n),i=i(r=Es(r)),e.flags|=1,wa(t,e,i,n),e.child;case 14:return r=gs(i=e.type,e.pendingProps),_a(t,e,i,r=gs(i.type,r),n);case 15:return Ta(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:gs(i,r),Ga(t,e),e.tag=1,Nr(i)?(t=!0,Fr(e)):t=!1,Ts(e,n),Ws(e,i,r),qs(e,i,r,n),Ia(null,e,i,!0,t,n);case 19:return Wa(t,e,n);case 22:return Ea(t,e,n)}throw Error(s(156,e.tag))};var Yl="function"===typeof reportError?reportError:function(t){console.error(t)};function Kl(t){this._internalRoot=t}function Ql(t){this._internalRoot=t}function Zl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function $l(){}function tu(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var t=ql(o);a.call(t)}}Gl(e,o,t,r)}else o=function(t,e,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var t=ql(o);s.call(t)}}var o=Wl(e,i,t,0,null,!1,0,"",$l);return t._reactRootContainer=o,t[fr]=o.current,Vi(8===t.nodeType?t.parentNode:t),hl(),o}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof i){var a=i;i=function(){var t=ql(c);a.call(t)}}var c=jl(t,0,!1,null,0,!1,0,"",$l);return t._reactRootContainer=c,t[fr]=c.current,Vi(8===t.nodeType?t.parentNode:t),hl((function(){Gl(e,c,n,i)})),c}(n,e,t,r,i);return ql(o)}Ql.prototype.render=Kl.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(s(409));Gl(t,e,null,null)},Ql.prototype.unmount=Kl.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;hl((function(){Gl(null,t,null,null)})),e[fr]=null}},Ql.prototype.unstable_scheduleHydration=function(t){if(t){var e=Te();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Me.length&&0!==e&&e<Me[n].priority;n++);Me.splice(n,0,t),0===n&&Le(t)}},we=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ye(e,1|n),rl(e,Zt()),0===(6&Ic)&&(Wc=Zt()+500,Vr()))}break;case 13:hl((function(){var e=Is(t,1);if(null!==e){var n=el();il(e,t,1,n)}})),Xl(t,1)}},Se=function(t){if(13===t.tag){var e=Is(t,134217728);if(null!==e)il(e,t,134217728,el());Xl(t,134217728)}},_e=function(t){if(13===t.tag){var e=nl(t),n=Is(t,e);if(null!==n)il(n,t,e,el());Xl(t,e)}},Te=function(){return xe},Ee=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}},St=function(t,e,n){switch(e){case"input":if(J(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=wr(i);if(!r)throw Error(s(90));X(i),J(i,r)}}}break;case"textarea":st(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},At=ul,It=hl;var eu={usingClientEntryPoint:!1,Events:[xr,br,wr,Ct,kt,ul]},nu={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=qt(t))?null:t.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{re=ru.inject(iu),se=ru}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(e))throw Error(s(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Zl(t))throw Error(s(299));var n=!1,i="",r=Yl;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=jl(t,1,!1,null,0,n,0,i,r),t[fr]=e.current,Vi(8===t.nodeType?t.parentNode:t),new Kl(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw t=Object.keys(t).join(","),Error(s(268,t))}return t=null===(t=qt(e))?null:t.stateNode},e.flushSync=function(t){return hl(t)},e.hydrate=function(t,e,n){if(!Jl(e))throw Error(s(200));return tu(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Zl(t))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Yl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),e=Wl(e,null,t,1,null!=n?n:null,r,0,o,a),t[fr]=e.current,Vi(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Ql(e)},e.render=function(t,e,n){if(!Jl(e))throw Error(s(200));return tu(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Jl(t))throw Error(s(40));return!!t._reactRootContainer&&(hl((function(){tu(null,null,t,!1,(function(){t._reactRootContainer=null,t[fr]=null}))})),!0)},e.unstable_batchedUpdates=ul,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Jl(n))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return tu(t,e,n,!1,i)},e.version="18.2.0-next-9e3b772b8-20220608"},1250:(t,e,n)=>{"use strict";var i=n(4164);e.s=i.createRoot,i.hydrateRoot},4164:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(4463)},1372:(t,e)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,x=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case u:case h:case s:case a:case o:case p:return t;default:switch(t=t&&t.$$typeof){case l:case d:case g:case m:case c:return t;default:return e}}case r:return e}}}function S(t){return w(t)===h}e.AsyncMode=u,e.ConcurrentMode=h,e.ContextConsumer=l,e.ContextProvider=c,e.Element=i,e.ForwardRef=d,e.Fragment=s,e.Lazy=g,e.Memo=m,e.Portal=r,e.Profiler=a,e.StrictMode=o,e.Suspense=p,e.isAsyncMode=function(t){return S(t)||w(t)===u},e.isConcurrentMode=S,e.isContextConsumer=function(t){return w(t)===l},e.isContextProvider=function(t){return w(t)===c},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===i},e.isForwardRef=function(t){return w(t)===d},e.isFragment=function(t){return w(t)===s},e.isLazy=function(t){return w(t)===g},e.isMemo=function(t){return w(t)===m},e.isPortal=function(t){return w(t)===r},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===o},e.isSuspense=function(t){return w(t)===p},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===s||t===h||t===a||t===o||t===p||t===f||"object"===typeof t&&null!==t&&(t.$$typeof===g||t.$$typeof===m||t.$$typeof===c||t.$$typeof===l||t.$$typeof===d||t.$$typeof===y||t.$$typeof===x||t.$$typeof===b||t.$$typeof===v)},e.typeOf=w},7441:(t,e,n)=>{"use strict";t.exports=n(1372)},3688:(t,e,n)=>{"use strict";function i(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==t&&void 0!==t&&this.setState(t)}function r(t){this.setState(function(e){var n=this.constructor.getDerivedStateFromProps(t,e);return null!==n&&void 0!==n?n:null}.bind(this))}function s(t,e){try{var n=this.props,i=this.state;this.props=t,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,i)}finally{this.props=n,this.state=i}}function o(t){var e=t.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if("function"!==typeof t.getDerivedStateFromProps&&"function"!==typeof e.getSnapshotBeforeUpdate)return t;var n=null,o=null,a=null;if("function"===typeof e.componentWillMount?n="componentWillMount":"function"===typeof e.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"===typeof e.componentWillReceiveProps?o="componentWillReceiveProps":"function"===typeof e.UNSAFE_componentWillReceiveProps&&(o="UNSAFE_componentWillReceiveProps"),"function"===typeof e.componentWillUpdate?a="componentWillUpdate":"function"===typeof e.UNSAFE_componentWillUpdate&&(a="UNSAFE_componentWillUpdate"),null!==n||null!==o||null!==a){var c=t.displayName||t.name,l="function"===typeof t.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+c+" uses "+l+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==o?"\n  "+o:"")+(null!==a?"\n  "+a:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"===typeof t.getDerivedStateFromProps&&(e.componentWillMount=i,e.componentWillReceiveProps=r),"function"===typeof e.getSnapshotBeforeUpdate){if("function"!==typeof e.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=s;var u=e.componentDidUpdate;e.componentDidUpdate=function(t,e,n){var i=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;u.call(this,t,e,i)}}return t}n.r(e),n.d(e,{polyfill:()=>o}),i.__suppressDeprecationWarning=!0,r.__suppressDeprecationWarning=!0,s.__suppressDeprecationWarning=!0},2240:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bodyOpenClassName=e.portalClassName=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(2791),o=f(s),a=f(n(4164)),c=f(n(2007)),l=f(n(4334)),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(5858)),h=n(3663),d=f(h),p=n(3688);function f(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}var g=e.portalClassName="ReactModalPortal",v=e.bodyOpenClassName="ReactModal__Body--open",y=h.canUseDOM&&void 0!==a.default.createPortal,x=function(t){return document.createElement(t)},b=function(){return y?a.default.createPortal:a.default.unstable_renderSubtreeIntoContainer};function w(t){return t()}var S=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=m(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(c))),r.removePortal=function(){!y&&a.default.unmountComponentAtNode(r.node);var t=w(r.props.parentSelector);t&&t.contains(r.node)?t.removeChild(r.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},r.portalRef=function(t){r.portal=t},r.renderPortal=function(t){var n=b()(r,o.default.createElement(l.default,i({defaultStyles:e.defaultStyles},t)),r.node);r.portalRef(n)},m(r,n)}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentDidMount",value:function(){h.canUseDOM&&(y||(this.node=x("div")),this.node.className=this.props.portalClassName,w(this.props.parentSelector).appendChild(this.node),!y&&this.renderPortal(this.props))}},{key:"getSnapshotBeforeUpdate",value:function(t){return{prevParent:w(t.parentSelector),nextParent:w(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(t,e,n){if(h.canUseDOM){var i=this.props,r=i.isOpen,s=i.portalClassName;t.portalClassName!==s&&(this.node.className=s);var o=n.prevParent,a=n.nextParent;a!==o&&(o.removeChild(this.node),a.appendChild(this.node)),(t.isOpen||r)&&!y&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(h.canUseDOM&&this.node&&this.portal){var t=this.portal.state,e=Date.now(),n=t.isOpen&&this.props.closeTimeoutMS&&(t.closesAt||e+this.props.closeTimeoutMS);n?(t.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-e)):this.removePortal()}}},{key:"render",value:function(){return h.canUseDOM&&y?(!this.node&&y&&(this.node=x("div")),b()(o.default.createElement(l.default,i({ref:this.portalRef,defaultStyles:e.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(t){u.setElement(t)}}]),e}(s.Component);S.propTypes={isOpen:c.default.bool.isRequired,style:c.default.shape({content:c.default.object,overlay:c.default.object}),portalClassName:c.default.string,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,className:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),overlayClassName:c.default.oneOfType([c.default.string,c.default.shape({base:c.default.string.isRequired,afterOpen:c.default.string.isRequired,beforeClose:c.default.string.isRequired})]),appElement:c.default.oneOfType([c.default.instanceOf(d.default),c.default.instanceOf(h.SafeHTMLCollection),c.default.instanceOf(h.SafeNodeList),c.default.arrayOf(c.default.instanceOf(d.default))]),onAfterOpen:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,ariaHideApp:c.default.bool,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,parentSelector:c.default.func,aria:c.default.object,data:c.default.object,role:c.default.string,contentLabel:c.default.string,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func},S.defaultProps={isOpen:!1,portalClassName:g,bodyOpenClassName:v,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,e){return o.default.createElement("div",t,e)},contentElement:function(t,e){return o.default.createElement("div",t,e)}},S.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,p.polyfill)(S),e.default=S},4334:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(2791),a=g(n(2007)),c=m(n(8844)),l=g(n(870)),u=m(n(5858)),h=m(n(4942)),d=n(3663),p=g(d),f=g(n(8484));function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function g(t){return t&&t.__esModule?t:{default:t}}n(5670);var v={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},y=0,x=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.setOverlayRef=function(t){n.overlay=t,n.props.overlayRef&&n.props.overlayRef(t)},n.setContentRef=function(t){n.content=t,n.props.contentRef&&n.props.contentRef(t)},n.afterClose=function(){var t=n.props,e=t.appElement,i=t.ariaHideApp,r=t.htmlOpenClassName,s=t.bodyOpenClassName,o=t.parentSelector,a=o&&o().ownerDocument||document;s&&h.remove(a.body,s),r&&h.remove(a.getElementsByTagName("html")[0],r),i&&y>0&&0===(y-=1)&&u.show(e),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(c.returnFocus(n.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),n.props.onAfterClose&&n.props.onAfterClose(),f.default.deregister(n)},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(c.setupScopedFocus(n.node),c.markForFocusLater()),n.setState({isOpen:!0},(function(){n.openAnimationFrame=requestAnimationFrame((function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen({overlayEl:n.overlay,contentEl:n.content})}))})))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus({preventScroll:!0})},n.closeWithTimeout=function(){var t=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:t},(function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())}))},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(t){(function(t){return"Tab"===t.code||9===t.keyCode})(t)&&(0,l.default)(n.content,t),n.props.shouldCloseOnEsc&&function(t){return"Escape"===t.code||27===t.keyCode}(t)&&(t.stopPropagation(),n.requestClose(t))},n.handleOverlayOnClick=function(t){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(t):n.focusContent()),n.shouldClose=null},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(t){n.props.shouldCloseOnOverlayClick||t.target!=n.overlay||t.preventDefault()},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1},n.requestClose=function(t){return n.ownerHandlesClose()&&n.props.onRequestClose(t)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(t,e){var i="object"===("undefined"===typeof e?"undefined":r(e))?e:{base:v[t],afterOpen:v[t]+"--after-open",beforeClose:v[t]+"--before-close"},s=i.base;return n.state.afterOpen&&(s=s+" "+i.afterOpen),n.state.beforeClose&&(s=s+" "+i.beforeClose),"string"===typeof e&&e?s+" "+e:s},n.attributesFromObject=function(t,e){return Object.keys(e).reduce((function(n,i){return n[t+"-"+i]=e[i],n}),{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(t,e){this.props.isOpen&&!t.isOpen?this.open():!this.props.isOpen&&t.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!e.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var t=this.props,e=t.appElement,n=t.ariaHideApp,i=t.htmlOpenClassName,r=t.bodyOpenClassName,s=t.parentSelector,o=s&&s().ownerDocument||document;r&&h.add(o.body,r),i&&h.add(o.getElementsByTagName("html")[0],i),n&&(y+=1,u.hide(e)),f.default.register(this)}},{key:"render",value:function(){var t=this.props,e=t.id,n=t.className,r=t.overlayClassName,s=t.defaultStyles,o=t.children,a=n?{}:s.content,c=r?{}:s.overlay;if(this.shouldBeClosed())return null;var l={ref:this.setOverlayRef,className:this.buildClassName("overlay",r),style:i({},c,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},u=i({id:e,ref:this.setContentRef,style:i({},a,this.props.style.content),className:this.buildClassName("content",n),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",i({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),h=this.props.contentElement(u,o);return this.props.overlayElement(l,h)}}]),e}(o.Component);x.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},x.propTypes={isOpen:a.default.bool.isRequired,defaultStyles:a.default.shape({content:a.default.object,overlay:a.default.object}),style:a.default.shape({content:a.default.object,overlay:a.default.object}),className:a.default.oneOfType([a.default.string,a.default.object]),overlayClassName:a.default.oneOfType([a.default.string,a.default.object]),parentSelector:a.default.func,bodyOpenClassName:a.default.string,htmlOpenClassName:a.default.string,ariaHideApp:a.default.bool,appElement:a.default.oneOfType([a.default.instanceOf(p.default),a.default.instanceOf(d.SafeHTMLCollection),a.default.instanceOf(d.SafeNodeList),a.default.arrayOf(a.default.instanceOf(p.default))]),onAfterOpen:a.default.func,onAfterClose:a.default.func,onRequestClose:a.default.func,closeTimeoutMS:a.default.number,shouldFocusAfterRender:a.default.bool,shouldCloseOnOverlayClick:a.default.bool,shouldReturnFocusAfterClose:a.default.bool,preventScroll:a.default.bool,role:a.default.string,contentLabel:a.default.string,aria:a.default.object,data:a.default.object,children:a.default.node,shouldCloseOnEsc:a.default.bool,overlayRef:a.default.func,contentRef:a.default.func,id:a.default.string,overlayElement:a.default.func,contentElement:a.default.func,testId:a.default.string},e.default=x,t.exports=e.default},5858:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){a&&(a.removeAttribute?a.removeAttribute("aria-hidden"):null!=a.length?a.forEach((function(t){return t.removeAttribute("aria-hidden")})):document.querySelectorAll(a).forEach((function(t){return t.removeAttribute("aria-hidden")})));a=null},e.log=function(){0},e.assertNodeList=c,e.setElement=function(t){var e=t;if("string"===typeof e&&o.canUseDOM){var n=document.querySelectorAll(e);c(n,e),e=n}return a=e||a},e.validateElement=l,e.hide=function(t){var e=!0,n=!1,i=void 0;try{for(var r,s=l(t)[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.setAttribute("aria-hidden","true")}}catch(o){n=!0,i=o}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}},e.show=function(t){var e=!0,n=!1,i=void 0;try{for(var r,s=l(t)[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.removeAttribute("aria-hidden")}}catch(o){n=!0,i=o}finally{try{!e&&s.return&&s.return()}finally{if(n)throw i}}},e.documentNotReadyOrSSRTesting=function(){a=null};var i,r=n(2391),s=(i=r)&&i.__esModule?i:{default:i},o=n(3663);var a=null;function c(t,e){if(!t||!t.length)throw new Error("react-modal: No elements were found for selector "+e+".")}function l(t){var e=t||a;return e?Array.isArray(e)||e instanceof HTMLCollection||e instanceof NodeList?e:[e]:((0,s.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}},5670:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){for(var t=[o,a],e=0;e<t.length;e++){var n=t[e];n&&(n.parentNode&&n.parentNode.removeChild(n))}o=a=null,c=[]},e.log=function(){console.log("bodyTrap ----------"),console.log(c.length);for(var t=[o,a],e=0;e<t.length;e++){var n=t[e]||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")};var i,r=n(8484),s=(i=r)&&i.__esModule?i:{default:i};var o=void 0,a=void 0,c=[];function l(){0!==c.length&&c[c.length-1].focusContent()}s.default.subscribe((function(t,e){o||a||((o=document.createElement("div")).setAttribute("data-react-modal-body-trap",""),o.style.position="absolute",o.style.opacity="0",o.setAttribute("tabindex","0"),o.addEventListener("focus",l),(a=o.cloneNode()).addEventListener("focus",l)),(c=e).length>0?(document.body.firstChild!==o&&document.body.insertBefore(o,document.body.firstChild),document.body.lastChild!==a&&document.body.appendChild(a)):(o.parentElement&&o.parentElement.removeChild(o),a.parentElement&&a.parentElement.removeChild(a))}))},4942:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){var t=document.getElementsByTagName("html")[0];for(var e in n)r(t,n[e]);var s=document.body;for(var o in i)r(s,i[o]);n={},i={}},e.log=function(){0};var n={},i={};function r(t,e){t.classList.remove(e)}e.add=function(t,e){return r=t.classList,s="html"==t.nodeName.toLowerCase()?n:i,void e.split(" ").forEach((function(t){!function(t,e){t[e]||(t[e]=0),t[e]+=1}(s,t),r.add(t)}));var r,s},e.remove=function(t,e){return r=t.classList,s="html"==t.nodeName.toLowerCase()?n:i,void e.split(" ").forEach((function(t){!function(t,e){t[e]&&(t[e]-=1)}(s,t),0===s[t]&&r.remove(t)}));var r,s}},8844:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resetState=function(){o=[]},e.log=function(){0},e.handleBlur=l,e.handleFocus=u,e.markForFocusLater=function(){o.push(document.activeElement)},e.returnFocus=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=null;try{return void(0!==o.length&&(e=o.pop()).focus({preventScroll:t}))}catch(n){console.warn(["You tried to return focus to",e,"but it is not in the DOM anymore"].join(" "))}},e.popWithoutFocus=function(){o.length>0&&o.pop()},e.setupScopedFocus=function(t){a=t,window.addEventListener?(window.addEventListener("blur",l,!1),document.addEventListener("focus",u,!0)):(window.attachEvent("onBlur",l),document.attachEvent("onFocus",u))},e.teardownScopedFocus=function(){a=null,window.addEventListener?(window.removeEventListener("blur",l),document.removeEventListener("focus",u)):(window.detachEvent("onBlur",l),document.detachEvent("onFocus",u))};var i,r=n(9750),s=(i=r)&&i.__esModule?i:{default:i};var o=[],a=null,c=!1;function l(){c=!0}function u(){if(c){if(c=!1,!a)return;setTimeout((function(){a.contains(document.activeElement)||((0,s.default)(a)[0]||a).focus()}),0)}}},8484:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.log=function(){console.log("portalOpenInstances ----------"),console.log(i.openInstances.length),i.openInstances.forEach((function(t){return console.log(t)})),console.log("end portalOpenInstances ----------")},e.resetState=function(){i=new n};var n=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.register=function(t){-1===e.openInstances.indexOf(t)&&(e.openInstances.push(t),e.emit("register"))},this.deregister=function(t){var n=e.openInstances.indexOf(t);-1!==n&&(e.openInstances.splice(n,1),e.emit("deregister"))},this.subscribe=function(t){e.subscribers.push(t)},this.emit=function(t){e.subscribers.forEach((function(n){return n(t,e.openInstances.slice())}))},this.openInstances=[],this.subscribers=[]},i=new n;e.default=i},3663:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canUseDOM=e.SafeNodeList=e.SafeHTMLCollection=void 0;var i,r=n(2618);var s=((i=r)&&i.__esModule?i:{default:i}).default,o=s.canUseDOM?window.HTMLElement:{};e.SafeHTMLCollection=s.canUseDOM?window.HTMLCollection:{},e.SafeNodeList=s.canUseDOM?window.NodeList:{},e.canUseDOM=s.canUseDOM;e.default=o},870:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=(0,s.default)(t);if(!n.length)return void e.preventDefault();var i=void 0,r=e.shiftKey,a=n[0],c=n[n.length-1],l=o();if(t===l){if(!r)return;i=c}c!==l||r||(i=a);a===l&&r&&(i=c);if(i)return e.preventDefault(),void i.focus();var u=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==u||"Chrome"==u[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var h=n.indexOf(l);h>-1&&(h+=r?-1:1);if("undefined"===typeof(i=n[h]))return e.preventDefault(),void(i=r?c:a).focus();e.preventDefault(),i.focus()};var i,r=n(9750),s=(i=r)&&i.__esModule?i:{default:i};function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return t.activeElement.shadowRoot?o(t.activeElement.shadowRoot):t.activeElement}t.exports=e.default},9750:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e){var n=[].slice.call(e.querySelectorAll("*"),0).reduce((function(e,n){return e.concat(n.shadowRoot?t(n.shadowRoot):[n])}),[]);return n.filter(a)};var n="none",i="contents",r=/input|select|textarea|button|object|iframe/;function s(t){var e=t.offsetWidth<=0&&t.offsetHeight<=0;if(e&&!t.innerHTML)return!0;try{var r=window.getComputedStyle(t),s=r.getPropertyValue("display");return e?s!==i&&function(t,e){return"visible"!==e.getPropertyValue("overflow")||t.scrollWidth<=0&&t.scrollHeight<=0}(t,r):s===n}catch(o){return console.warn("Failed to inspect element style"),!1}}function o(t,e){var n=t.nodeName.toLowerCase();return(r.test(n)&&!t.disabled||"a"===n&&t.href||e)&&function(t){for(var e=t,n=t.getRootNode&&t.getRootNode();e&&e!==document.body;){if(n&&e===n&&(e=n.host.parentNode),s(e))return!1;e=e.parentNode}return!0}(t)}function a(t){var e=t.getAttribute("tabindex");null===e&&(e=void 0);var n=isNaN(e);return(n||e>=0)&&o(t,!n)}t.exports=e.default},7948:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(2240),s=(i=r)&&i.__esModule?i:{default:i};e.default=s.default,t.exports=e.default},8459:(t,e)=>{"use strict";var n,i=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function v(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case s:case a:case o:case d:case p:return t;default:switch(t=t&&t.$$typeof){case u:case l:case h:case m:case f:case c:return t;default:return e}}case r:return e}}}n=Symbol.for("react.module.reference")},6900:(t,e,n)=>{"use strict";n(8459)},7169:function(t,e,n){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return s(e,t),e},a=this&&this.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var c=o(n(2791)),l=n(8945),u=(0,n(7074).createAnimation)("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");e.default=function(t){var e=t.loading,n=void 0===e||e,r=t.color,s=void 0===r?"#000000":r,o=t.speedMultiplier,h=void 0===o?1:o,d=t.cssOverride,p=void 0===d?{}:d,f=t.size,m=void 0===f?15:f,g=t.margin,v=void 0===g?2:g,y=a(t,["loading","color","speedMultiplier","cssOverride","size","margin"]),x=i({display:"inherit"},p),b=function(t){return{display:"inline-block",backgroundColor:s,width:(0,l.cssValue)(m),height:(0,l.cssValue)(m),margin:(0,l.cssValue)(v),borderRadius:"100%",animation:"".concat(u," ").concat(.7/h,"s ").concat(t%2?"0s":"".concat(.35/h,"s")," infinite linear"),animationFillMode:"both"}};return n?c.createElement("span",i({style:x},y),c.createElement("span",{style:b(1)}),c.createElement("span",{style:b(2)}),c.createElement("span",{style:b(3)})):null}},7074:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createAnimation=void 0;e.createAnimation=function(t,e,n){var i="react-spinners-".concat(t,"-").concat(n);if("undefined"==typeof window||!window.document)return i;var r=document.createElement("style");document.head.appendChild(r);var s=r.sheet,o="\n    @keyframes ".concat(i," {\n      ").concat(e,"\n    }\n  ");return s&&s.insertRule(o,0),i}},8945:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cssValue=e.parseLengthAndUnit=void 0;var n={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function i(t){if("number"===typeof t)return{value:t,unit:"px"};var e,i=(t.match(/^[0-9.]*/)||"").toString();e=i.includes(".")?parseFloat(i):parseInt(i,10);var r=(t.match(/[^0-9]*$/)||"").toString();return n[r]?{value:e,unit:r}:(console.warn("React Spinners: ".concat(t," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}e.parseLengthAndUnit=i,e.cssValue=function(t){var e=i(t);return"".concat(e.value).concat(e.unit)}},6374:(t,e,n)=>{"use strict";var i=n(2791),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,n){var i,s={},l=null,u=null;for(i in void 0!==n&&(l=""+n),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(u=e.ref),e)o.call(e,i)&&!c.hasOwnProperty(i)&&(s[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===s[i]&&(s[i]=e[i]);return{$$typeof:r,type:t,key:l,ref:u,props:s,_owner:a.current}}e.Fragment=s,e.jsx=l,e.jsxs=l},9117:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}function y(){}function x(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,m(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,_={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,i){var r,s={},o=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(o=""+e.key),e)S.call(e,r)&&!T.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in c=t.defaultProps)void 0===s[r]&&(s[r]=c[r]);return{$$typeof:n,type:t,key:o,ref:a,props:s,_owner:_.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var k=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function I(t,e,r,s,o){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var c=!1;if(null===t)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case n:case i:c=!0}}if(c)return o=o(c=t),t=""===s?"."+A(c,0):s,w(o)?(r="",null!=t&&(r=t.replace(k,"$&/")+"/"),I(o,e,r,"",(function(t){return t}))):null!=o&&(C(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,r+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+t)),e.push(o)),1;if(c=0,s=""===s?".":s+":",w(t))for(var l=0;l<t.length;l++){var u=s+A(a=t[l],l);c+=I(a,e,r,u,o)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=p&&t[p]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),l=0;!(a=t.next()).done;)c+=I(a=a.value,e,r,u=s+A(a,l++),o);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function O(t,e,n){if(null==t)return t;var i=[],r=0;return I(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function R(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var N={current:null},M={transition:null},D={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};e.Children={map:O,forEach:function(t,e,n){O(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return O(t,(function(){e++})),e},toArray:function(t){return O(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=r,e.Profiler=o,e.PureComponent=x,e.StrictMode=s,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=m({},t.props),s=t.key,o=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,a=_.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)S.call(e,l)&&!T.hasOwnProperty(l)&&(r[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:n,type:t.type,key:s,ref:o,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:c,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return N.current.useCallback(t,e)},e.useContext=function(t){return N.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return N.current.useDeferredValue(t)},e.useEffect=function(t,e){return N.current.useEffect(t,e)},e.useId=function(){return N.current.useId()},e.useImperativeHandle=function(t,e,n){return N.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return N.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return N.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return N.current.useMemo(t,e)},e.useReducer=function(t,e,n){return N.current.useReducer(t,e,n)},e.useRef=function(t){return N.current.useRef(t)},e.useState=function(t){return N.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return N.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return N.current.useTransition()},e.version="18.2.0"},2791:(t,e,n)=>{"use strict";t.exports=n(9117)},184:(t,e,n)=>{"use strict";t.exports=n(6374)},6813:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<s(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,o=r>>>1;i<o;){var a=2*(i+1)-1,c=t[a],l=a+1,u=t[l];if(0>s(c,n))l<r&&0>s(u,c)?(t[i]=u,t[l]=n,i=l):(t[i]=c,t[a]=n,i=a);else{if(!(l<r&&0>s(u,n)))break t;t[i]=u,t[l]=n,i=l}}}return e}function s(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var l=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(t){for(var e=i(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,n(l,e)}e=i(u)}}function w(t){if(g=!1,b(t),!m)if(null!==i(l))m=!0,M(S);else{var e=i(u);null!==e&&D(w,e.startTime-t)}}function S(t,n){m=!1,g&&(g=!1,y(C),C=-1),f=!0;var s=p;try{for(b(n),d=i(l);null!==d&&(!(d.expirationTime>n)||t&&!I());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof a?d.callback=a:d===i(l)&&r(l),b(n)}else r(l);d=i(l)}if(null!==d)var c=!0;else{var h=i(u);null!==h&&D(w,h.startTime-n),c=!1}return c}finally{d=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,T=!1,E=null,C=-1,k=5,A=-1;function I(){return!(e.unstable_now()-A<k)}function O(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?_():(T=!1,E=null)}}else T=!1}if("function"===typeof x)_=function(){x(O)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,N=R.port2;R.port1.onmessage=O,_=function(){N.postMessage(null)}}else _=function(){v(O,0)};function M(t){E=t,T||(T=!0,_())}function D(t,n){C=v((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,M(S))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_scheduleCallback=function(t,r,s){var o=e.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(t.sortIndex=s,n(u,t),null===i(l)&&t===i(u)&&(g?(y(C),C=-1):g=!0,D(w,s-o))):(t.sortIndex=a,n(l,t),m||f||(m=!0,M(S))),t},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(t){var e=p;return function(){var n=p;p=e;try{return t.apply(this,arguments)}finally{p=n}}}},5296:(t,e,n)=>{"use strict";t.exports=n(6813)},6699:(t,e,n)=>{var i=n(2501),r=n(9112),s=n(2132),o=n(890),a=n(4113),c=n(1350),l=n(3411);l.alea=i,l.xor128=r,l.xorwow=s,l.xorshift7=o,l.xor4096=a,l.tychei=c,t.exports=l},2501:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n=function(){var t=4022871197,e=function(e){e=e.toString();for(var n=0;n<e.length;n++){var i=.02519603282416938*(t+=e.charCodeAt(n));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.alea=c}(0,t=n.nmd(t),n.amdD)},1350:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.tychei=c}(0,t=n.nmd(t),n.amdD)},9112:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor128=c}(0,t=n.nmd(t),n.amdD)},4113:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],c=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,c=Math.max(c,e.length)),r=0,s=-32;s<c;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(o=o+1640531527|0,r=0==(n=a[127&s]^=i+o)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},890:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},2132:function(t,e,n){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=c:n.amdD&&n.amdO?void 0===(i=function(){return c}.call(e,n,e,r))||(r.exports=i):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},3411:(t,e,n)=>{var i;!function(r,s){var o,a=(0,eval)("this"),c=256,l="random",u=s.pow(c,6),h=s.pow(2,52),d=2*h,p=c-1;function f(t,e,n){var i=[],p=y(v((e=1==e?{entropy:!0}:e||{}).entropy?[t,x(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(c):(t=new Uint8Array(c),(a.crypto||a.msCrypto).getRandomValues(t)),x(t)}catch(i){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,x(r)]}}():t,3),i),f=new m(i),b=function(){for(var t=f.g(6),e=u,n=0;t<h;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(x(f.S),r),(e.pass||n||function(t,e,n,i){return i&&(i.S&&g(i,f),t.state=function(){return g(f,{})}),n?(s[l]=t,e):t})(b,p,"global"in e?e.global:this==s,e.state)}function m(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<c;)o[r]=r++;for(r=0;r<c;r++)o[r]=o[s=p&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=p&r+1],n=n*c+o[p&(o[r]=o[s=p&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(c)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(v(t[n],e-1))}catch(s){}return i.length?i:"string"==r?t:t+"\0"}function y(t,e){for(var n,i=t+"",r=0;r<i.length;)e[p&r]=p&(n^=19*e[p&r])+i.charCodeAt(r++);return x(e)}function x(t){return String.fromCharCode.apply(0,t)}if(s["seed"+l]=f,y(s.random(),r),t.exports){t.exports=f;try{o=n(5042)}catch(b){}}else void 0===(i=function(){return f}.call(e,n,e,t))||(t.exports=i)}([],Math)},6869:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AMOscillator:()=>Ks,AMSynth:()=>Ao,Abs:()=>ho,Add:()=>no,AmplitudeEnvelope:()=>Eo,Analyser:()=>Qa,AudioToGain:()=>Xs,AutoFilter:()=>pa,AutoPanner:()=>ma,AutoWah:()=>va,BaseContext:()=>Ir,BiquadFilter:()=>Io,BitCrusher:()=>xa,Buffer:()=>Oc,BufferSource:()=>Nc,Buffers:()=>Rc,Channel:()=>rc,Chebyshev:()=>wa,Chorus:()=>Ca,Clock:()=>ys,Compressor:()=>uc,Context:()=>Or,Convolver:()=>gc,CrossFade:()=>ua,DCMeter:()=>tc,Delay:()=>xs,Destination:()=>wc,Distortion:()=>ka,Draw:()=>Cc,DuoSynth:()=>Mo,EQ3:()=>mc,Emitter:()=>Ar,Envelope:()=>wo,FFT:()=>$a,FMOscillator:()=>Qs,FMSynth:()=>Do,FatOscillator:()=>Js,FeedbackCombFilter:()=>Go,FeedbackDelay:()=>Ia,Filter:()=>Oo,Follower:()=>ga,Freeverb:()=>Da,Frequency:()=>ts,FrequencyClass:()=>Zr,FrequencyEnvelope:()=>Ro,FrequencyShifter:()=>Ra,Gain:()=>us,GainToAudio:()=>po,Gate:()=>hc,GrainPlayer:()=>uo,GreaterThan:()=>vo,GreaterThanZero:()=>go,IntervalTimeline:()=>ks,JCReverb:()=>Ba,LFO:()=>so,Limiter:()=>dc,Listener:()=>Tc,Loop:()=>Zo,LowpassCombFilter:()=>Ho,Master:()=>Sc,MembraneSynth:()=>Lo,Merge:()=>_a,MetalSynth:()=>Fo,Meter:()=>Ja,MidSideCompressor:()=>pc,MidSideMerge:()=>qa,MidSideSplit:()=>Ga,Midi:()=>_s,MidiClass:()=>Ss,Mono:()=>sc,MonoSynth:()=>No,MultibandCompressor:()=>fc,MultibandSplit:()=>oc,Multiply:()=>Ys,Negate:()=>fo,Noise:()=>Ls,NoiseSynth:()=>Bo,Offline:()=>bs,OfflineContext:()=>Pr,OmniOscillator:()=>eo,OnePoleFilter:()=>qo,Oscillator:()=>Gs,PWMOscillator:()=>$s,PanVol:()=>ic,Panner:()=>fa,Panner3D:()=>cc,Param:()=>ss,Part:()=>Jo,Pattern:()=>ca,Phaser:()=>Va,PingPongDelay:()=>Ua,PitchShift:()=>ja,Player:()=>co,Players:()=>lo,PluckSynth:()=>Xo,PolySynth:()=>Yo,Pow:()=>yo,PulseOscillator:()=>Zs,Recorder:()=>lc,Reverb:()=>Wa,Sampler:()=>Ko,Scale:()=>io,ScaleExp:()=>xo,Sequence:()=>la,Signal:()=>ps,Solo:()=>nc,Split:()=>Sa,StateTimeline:()=>rs,StereoWidener:()=>Xa,Subtract:()=>mo,SyncedSignal:()=>bo,Synth:()=>Co,Ticks:()=>Es,TicksClass:()=>Ts,Time:()=>Qr,TimeClass:()=>Kr,Timeline:()=>_r,ToneAudioBuffer:()=>Dr,ToneAudioBuffers:()=>ws,ToneAudioNode:()=>os,ToneBufferSource:()=>Fs,ToneEvent:()=>Qo,ToneOscillatorNode:()=>Ws,Transport:()=>xc,TransportTime:()=>ns,TransportTimeClass:()=>es,Tremolo:()=>Ya,Unit:()=>r,UserMedia:()=>js,Vibrato:()=>Ka,Volume:()=>Is,WaveShaper:()=>Hs,Waveform:()=>ec,Zero:()=>ro,connect:()=>cs,connectSeries:()=>as,connectSignal:()=>fs,context:()=>Ac,dbToGain:()=>jr,debug:()=>i,defaultArg:()=>fr,disconnect:()=>ls,ftom:()=>qr,gainToDb:()=>Vr,getContext:()=>Br,getDestination:()=>_c,getDraw:()=>kc,getListener:()=>Ec,getTransport:()=>bc,immediate:()=>yc,intervalToFrequencyRatio:()=>Wr,isArray:()=>Ji,isBoolean:()=>Zi,isDefined:()=>Xi,isFunction:()=>Yi,isNote:()=>tr,isNumber:()=>Ki,isObject:()=>Qi,isString:()=>$i,isUndef:()=>Hi,loaded:()=>Ic,mtof:()=>Xr,now:()=>vc,optionsFromArguments:()=>pr,setContext:()=>zr,start:()=>Ur,supported:()=>Bi,version:()=>s});var i={};n.r(i),n.d(i,{assert:()=>zi,assertContextRunning:()=>ji,assertRange:()=>Ui,log:()=>Gi,setLogger:()=>Wi,warn:()=>qi});var r={};n.r(r);const s="14.7.77";var o=n(8667);const a=new WeakSet,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v={construct:()=>v},y=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,x=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(y);for(;null!==r;){const t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(y)}return[n.join(";"),i]},b=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},w=t=>{if(!(t=>{try{new new Proxy(t,v)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!==typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},S=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},_=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},T=(t,e,n,i)=>{const r=S(t,e),s=_(r,(t=>t[0]===n&&t[1]===i));return 0===r.size&&t.delete(e),s},E=t=>S(p,t),C=t=>{if(a.has(t))throw new Error("The AudioNode is already stored.");a.add(t),E(t).forEach((t=>t(!0)))},k=t=>"port"in t,A=t=>{if(!a.has(t))throw new Error("The AudioNode is not stored.");a.delete(t),E(t).forEach((t=>t(!1)))},I=(t,e)=>{!k(t)&&e.every((t=>0===t.size))&&A(t)},O={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},R=(t,e)=>t.context===e,N=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},M=()=>new DOMException("","IndexSizeError"),D=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(i){if(12===i.code)throw M();throw i}})},P={numberOfChannels:1},F=-34028234663852886e22,L=-F,B=t=>a.has(t),z={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},U=t=>S(c,t),j=t=>S(u,t),V=(t,e)=>{const{activeInputs:n}=U(t);n.forEach((n=>n.forEach((n=>{let[i]=n;e.includes(t)||V(i,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:k(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const r of i){const t=j(r);void 0!==t&&t.activeInputs.forEach((t=>{let[n]=t;return V(n,e)}))}B(t)&&A(t)},W=t=>{V(t.destination,[])},G=t=>void 0===t||"number"===typeof t||"string"===typeof t&&("balanced"===t||"interactive"===t||"playback"===t),q=t=>"context"in t,H=t=>q(t[0]),X=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Y=(t,e,n,i)=>{let[r,s]=n;X(t,[e,r,s],(t=>t[0]===e&&t[1]===r),i)},K=(t,e,n)=>{let[i,r,s]=e;const o=t.get(i);void 0===o?t.set(i,new Set([[r,s]])):X(o,[r,s],(t=>t[0]===r),n)},Q=t=>"inputs"in t,Z=(t,e,n,i)=>{if(Q(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},J=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},$=(t,e)=>{if(!E(t).delete(e))throw new Error("Missing the expected event listener.")},tt=(t,e,n)=>{const i=S(t,e),r=_(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),r},et=(t,e,n,i)=>{Q(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},nt=t=>S(l,t),it=t=>S(h,t),rt=t=>f.has(t),st=t=>!a.has(t),ot=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(t=>1===t))?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination)},o.start()}})),at=(t,e)=>{const n=new Map;for(const i of t)for(const t of i){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},ct=t=>"context"in t,lt=t=>{const e=new Map;t.connect=(t=>function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=ct(n)?t(n,i,r):t(n,i),o=e.get(n);return void 0===o?e.set(n,[{input:r,output:i}]):o.every((t=>t.input!==r||t.output!==i))&&o.push({input:r,output:i}),s})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),void 0===i)e.clear();else if("number"===typeof i)for(const[t,n]of e){const r=n.filter((t=>t.output!==i));0===r.length?e.delete(t):e.set(t,r)}else if(e.has(i))if(void 0===r)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==r&&(t.input!==s||void 0===s)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,o]of e)o.forEach((e=>{ct(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},ut=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=j(e),{outputs:o}=U(t),a=E(t),c=o=>{const a=nt(t),c=it(e);if(o){const e=tt(s,t,n);Y(r,t,e,!1),i||rt(t)||a.connect(c,n)}else{const e=((t,e,n)=>_(t,(t=>t[0]===e&&t[1]===n)))(r,t,n);K(s,e,!1),i||rt(t)||a.disconnect(c,n)}};return!!X(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(c),B(t)?Y(r,t,[n,c],!0):K(s,[t,n,c],!0),!0)},ht=(t,e,n,i,r)=>{const[s,o]=((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=U(e),o=J(r[i],t,n);if(null===o)return[T(s,t,n,i)[2],!1];return[o[2],!0]})(t,n,i,r);if(null!==s&&($(t,s),!o||e||rt(t)||et(nt(t),nt(n),i,r)),B(n)){const{activeInputs:t}=U(n);I(n,t)}},dt=(t,e,n,i)=>{const[r,s]=((t,e,n)=>{const{activeInputs:i,passiveInputs:r}=j(e),s=J(i,t,n);if(null===s)return[tt(r,t,n)[1],!1];return[s[2],!0]})(t,n,i);null!==r&&($(t,r),!s||e||rt(t)||nt(t).disconnect(it(n),i))};class pt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const ft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function mt(t,e,n,i,r){if("function"===typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{const t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const gt=(t,e,n,i,r)=>{"function"===typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},vt=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],r="number"===typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},yt=async(t,e,n,i,r,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=i.channelCount*i.numberOfInputs,l=r.reduce(((t,e)=>t+e),0),u=0===l?null:n.createBuffer(l,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const h=U(t),d=await((t,e)=>{const n=S(g,t),i=nt(e);return S(n,i)})(n,t),p=vt(i.numberOfInputs,i.channelCount),f=vt(i.numberOfOutputs,r),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let g=0;g<a;g+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)mt(e,p[t],n,n,g);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach(((t,n)=>{let{name:i}=t;mt(e,m,i,c+n,g)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=p.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(g/n.sampleRate,n.sampleRate,(()=>d.process(t,f,m)));if(null!==u)for(let n=0,s=0;n<i.numberOfOutputs;n+=1){for(let t=0;t<r[n];t+=1)gt(u,f[n],t,s+t,g);s+=r[n]}if(!e)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},xt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},bt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},wt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},St={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},_t={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Tt=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}}))},Et={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ct=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},kt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},At={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},It=()=>new DOMException("","InvalidStateError"),Ot=()=>new DOMException("","InvalidAccessError"),Rt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Nt=(t,e,n,i,r,s,o,a,c,l,u)=>{const h=l.length;let d=a;for(let p=0;p<h;p+=1){let a=n[0]*l[p];for(let e=1;e<r;e+=1){const i=d-e&c-1;a+=n[e]*s[i],a-=t[e]*o[i]}for(let t=r;t<i;t+=1)a+=n[t]*s[d-t&c-1];for(let n=r;n<e;n+=1)a-=t[n]*o[d-n&c-1];s[d]=l[p],o[d]=a,d=d+1&c-1,u[p]=a}return d},Mt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Dt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Pt={numberOfChannels:1},Ft=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Lt=(t,e)=>{Ft(t,e,"channelCount"),Ft(t,e,"channelCountMode"),Ft(t,e,"channelInterpretation")},Bt=t=>"function"===typeof t.getFloatTimeDomainData,zt=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},Ut=t=>{t.start=(e=>function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"===typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},jt=t=>{var e;t.stop=(e=t.stop,function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Vt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Wt=async(t,e)=>{const n=await(t=>new Promise(((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=t=>{let{data:n}=t;i.close(),r.close(),e(n)},i.onmessageerror=t=>{let{data:e}=t;i.close(),r.close(),n(e)},r.postMessage(t)})))(e);return new t(n)},Gt=(t,e)=>{const n=t.createBiquadFilter();return Lt(n,e),zt(n,e,"Q"),zt(n,e,"detune"),zt(n,e,"frequency"),zt(n,e,"gain"),Ft(n,e,"type"),n},qt=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Lt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw It()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw It()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw It()}})})(n),n},Ht=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Xt=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Lt(n,e),zt(n,e,"delayTime"),n},Yt=(t,e)=>{const n=t.createGain();return Lt(n,e),zt(n,e,"gain"),n};function Kt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Qt(t,e){let n=[0,0];for(let s=t.length-1;s>=0;s-=1)r=e,n=[(i=n)[0]*r[0]-i[1]*r[1],i[0]*r[1]+i[1]*r[0]],n[0]+=t[s];var i,r;return n}const Zt=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Jt=()=>new DOMException("","NotSupportedError"),$t={numberOfChannels:1},te={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},ee={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},ne={disableNormalization:!1},ie={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},re=()=>new DOMException("","UnknownError"),se={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},oe=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),ae=t=>{if(null===t)return!1;const e=t.length;return e%2!==0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ce=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)})},le=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;le(t,e,n+1e-7)}},ue=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},he=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},de=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},pe=()=>{try{new DOMException}catch{return!1}return!0},fe=()=>new Promise((t=>{const e=new ArrayBuffer(0),{port1:n,port2:i}=new MessageChannel;n.onmessage=e=>{let{data:n}=e;return t(null!==n)},i.postMessage(e,[e])})),me=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),Ht(t,n),t.stop=(e=>{let i=!1;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(i)try{e.call(t,r)}catch{n.gain.setValueAtTime(0,r)}else e.call(t,r),i=!0}})(t.stop)},ge=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"===typeof e?e.call(t,n):e.handleEvent.call(t,n)},ve=(t=>(e,n,i,r)=>{let[s,o,a]=i;t(e[o],[n,s,a],(t=>t[0]===n&&t[1]===s),r)})(X),ye=(t=>(e,n,i,r)=>{let[s,o,a]=i;const c=e.get(s);void 0===c?e.set(s,new Set([[o,n,a]])):t(c,[o,n,a],(t=>t[0]===o&&t[1]===n),r)})(X),xe=(t=>(e,n,i,r)=>t(e[r],(t=>t[0]===n&&t[1]===i)))(_),be=new WeakMap,we=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(be),Se=(_e=new Map,Te=new WeakMap,(t,e)=>{const n=Te.get(t);if(void 0!==n)return n;const i=_e.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(_e.set(t,n),n.catch((()=>!1)).then((e=>(_e.delete(t),Te.set(t,e),e)))):(Te.set(t,n),n)}catch{return Te.set(t,!1),!1}});var _e,Te;const Ee="undefined"===typeof window?null:window,Ce=((t,e)=>(n,i)=>{const r=n.createAnalyser();if(Lt(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Ft(r,i,"fftSize"),Ft(r,i,"maxDecibels"),Ft(r,i,"minDecibels"),Ft(r,i,"smoothingTimeConstant"),t(Bt,(()=>Bt(r)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(r),r})(Se,M),ke=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(U),Ae=((t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map(((t,o)=>Array.from(t).map((async t=>{let[a,c]=t;const l=e(a),u=await l.render(a,r),h=i.context.destination;n(a)||i===h&&n(i)||u.connect(s,c,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(U,ke,rt),Ie=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!R(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(Ce,nt,Ae),Oe=(Re=d,t=>{const e=Re.get(t);if(void 0===e)throw It();return e});var Re;const Ne=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Ee),Me=(t=>e=>null!==t&&e instanceof t)(Ne),De=new WeakMap,Pe=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=t(this,n),"function"===typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(ge),Fe=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Ee),Le=(t=>e=>null!==t&&e instanceof t)(Fe),Be=(t=>e=>null!==t&&"function"===typeof t.AudioNode&&e instanceof t.AudioNode)(Ee),ze=(t=>e=>null!==t&&"function"===typeof t.AudioParam&&e instanceof t.AudioParam)(Ee),Ue=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Ee),je=((t,e,n,i,r,s,o,a,c,u,h,d,f,m,g,v)=>class extends u{constructor(e,i,r,s){super(r),this._context=e,this._nativeAudioNode=r;const o=h(e);d(o)&&!0!==n(ot,(()=>ot(o,v)))&&lt(r),l.set(this,r),p.set(this,new Set),"closed"!==e.state&&i&&C(this),t(this,s,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const l=h(this._context),u=g(l);if(f(t)||m(t))throw s();if(q(t)){const r=nt(t);try{const e=Z(this._nativeAudioNode,r,n,a),i=st(this);(u||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&st(t)&&C(t)}catch(p){if(12===p.code)throw s();throw p}if(e(this,t,n,a,u)){const e=c([this],t);at(e,i(u))}return t}const d=it(t);if("playbackRate"===d.name&&1024===d.maxValue)throw o();try{this._nativeAudioNode.connect(d,n),(u||st(this))&&this._nativeAudioNode.disconnect(d,n)}catch(p){if(12===p.code)throw s();throw p}if(ut(this,t,n,u)){const e=c([this],t);at(e,i(u))}}disconnect(t,e,n){let i;const o=h(this._context),l=g(o);if(void 0===t)i=((t,e)=>{const n=U(t),i=[];for(const r of n.outputs)H(r)?ht(t,e,...r):dt(t,e,...r),i.push(r[0]);return n.outputs.clear(),i})(this,l);else if("number"===typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=((t,e,n)=>{const i=U(t),r=[];for(const s of i.outputs)s[1]===n&&(H(s)?ht(t,e,...s):dt(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r})(this,l,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(q(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(i=((t,e,n,i,r)=>{const s=U(t);return Array.from(s.outputs).filter((t=>t[0]===n&&(void 0===i||t[1]===i)&&(void 0===r||t[2]===r))).map((n=>(H(n)?ht(t,e,...n):dt(t,e,...n),s.outputs.delete(n),n[0])))})(this,l,t,e,n),0===i.length)throw s()}for(const r of i){const t=c([this],r);at(t,a)}}})((Ve=c,(t,e,n)=>{const i=[];for(let r=0;r<n.numberOfInputs;r+=1)i.push(new Set);Ve.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,r,s,o,a,c,l,u,h,d)=>{const p=new WeakMap;return(f,m,g,v,y)=>{const{activeInputs:x,passiveInputs:b}=s(m),{outputs:w}=s(f),S=a(f),_=s=>{const a=c(m),l=c(f);if(s){const e=T(b,f,g,v);t(x,f,e,!1),y||h(f)||n(l,a,g,v),d(m)&&C(m)}else{const t=i(x,f,g,v);e(b,v,t,!1),y||h(f)||r(l,a,g,v);const n=o(m);if(0===n)u(m)&&I(m,x);else{const t=p.get(m);void 0!==t&&clearTimeout(t),p.set(m,setTimeout((()=>{u(m)&&I(m,x)}),1e3*n))}}};return!!l(w,[m,g,v],(t=>t[0]===m&&t[1]===g&&t[2]===v),!0)&&(S.add(_),u(f)?t(x,f,[g,v,_],!0):e(b,v,[f,g,_],!0),!0)}})(ve,ye,Z,xe,et,U,we,E,nt,X,B,rt,st),Se,((t,e,n,i,r,s)=>o=>(a,c)=>{const l=t.get(a);if(void 0===l){if(!o&&s(a)){const t=i(a),{outputs:s}=n(a);for(const n of s)if(H(n)){const r=i(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,l+c)})(f,et,U,nt,it,B),M,Ot,Jt,((t,e,n,i,r,s,o,a)=>(c,l)=>{const u=e.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const h=s(c.context),d=a(h);if(u===l){if(e.delete(c),!d&&o(c)){const e=i(c),{outputs:s}=n(c);for(const n of s)if(H(n)){const r=i(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.connect(t,n[1])}}}else e.set(c,u-l)})(Z,f,U,nt,it,Oe,B,Me),((t,e,n)=>function i(r,s){const o=q(s)?s:n(t,s);if((t=>"delayTime"in t)(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...r,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(De,U,S),Pe,Oe,Le,Be,ze,Me,Ue);var Ve;const We=((t,e,n,i,r,s)=>class extends t{constructor(t,n){const o=r(t),a={...O,...n},c=i(o,a);super(t,!1,c,s(o)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(je,Ie,M,Ce,Oe,Me),Ge=new WeakSet,qe=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Ee),He=(Xe=new Uint32Array(1),t=>(Xe[0]=t,Xe[0]));var Xe;const Ye=((t,e)=>n=>{n.copyFromChannel=function(i,r){const s=t(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=t(r);if(o>=n.numberOfChannels)throw e();const a=n.length,c=n.getChannelData(o),l=i.length;for(let t=s<0?-s:0;t+s<a&&t<l;t+=1)i[t]=c[t+s]},n.copyToChannel=function(i,r){const s=t(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=t(r);if(o>=n.numberOfChannels)throw e();const a=n.length,c=n.getChannelData(o),l=i.length;for(let t=s<0?-s:0;t+s<a&&t<l;t+=1)c[t+s]=i[t]}})(He,M),Ke=(t=>e=>{e.copyFromChannel=(n=>function(i,r){const s=t(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=t(r);if(s<e.length)return n.call(e,i,o,s)})(e.copyFromChannel),e.copyToChannel=(n=>function(i,r){const s=t(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),o=t(r);if(s<e.length)return n.call(e,i,o,s)})(e.copyToChannel)})(He),Qe=((t,e,n,i,r,s,o,a)=>{let c=null;return class l{constructor(l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:h,sampleRate:d}={...P,...l};null===c&&(c=new r(1,1,44100));const p=null!==i&&e(s,s)?new i({length:u,numberOfChannels:h,sampleRate:d}):c.createBuffer(h,u,d);if(0===p.numberOfChannels)throw n();return"function"!==typeof p.copyFromChannel?(o(p),D(p)):e(N,(()=>N(p)))||a(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"===typeof e&&Object.getPrototypeOf(e)===l.prototype||t.has(e)}}})(Ge,Se,Jt,qe,Ne,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(qe),Ye,Ke),Ze=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)})(Yt),Je=((t,e,n)=>async(i,r,s)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map((async e=>{let[i,o]=e;const a=t(i),c=await a.render(i,r);n(i)||c.connect(s,o)})))})(ke,j,rt),$e=(t=>(e,n,i)=>t(n,e,i))(Je),tn=((t,e,n,i,r,s,o,a,c,l,u)=>(h,d)=>{const p=h.createBufferSource();return Lt(p,d),zt(p,d,"playbackRate"),Ft(p,d,"buffer"),Ft(p,d,"loop"),Ft(p,d,"loopEnd"),Ft(p,d,"loopStart"),e(n,(()=>n(h)))||(t=>{t.start=(e=>{let n=!1;return function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(n)throw It();e.call(t,i,r,s),n=!0}})(t.start)})(p),e(i,(()=>i(h)))||c(p),e(r,(()=>r(h)))||l(p,h),e(s,(()=>s(h)))||Ut(p),e(o,(()=>o(h)))||u(p,h),e(a,(()=>a(h)))||jt(p),t(h,p),p})(Ze,Se,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),ue,he,de,(t=>{t.start=(e=>function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;const s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})(t.start)}),(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(ce),me),en=((t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(j),Je),nn=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,l){const u=s.get(l);return void 0!==u?Promise.resolve(u):(async(c,l)=>{let u=n(c);const h=R(u,l);if(!h){const t={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=e(l,t),null!==o&&u.start(...o),null!==a&&u.stop(a)}return s.set(l,u),h?await t(l,c.playbackRate,u.playbackRate):await i(l,c.playbackRate,u.playbackRate),await r(c,l,u),u})(c,l)}}})($e,tn,nt,en,Ae),rn=((t,e,n,i,r,s,a,c,l,u,h,d,p)=>function(f,m,g){let v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const x=g.value,b=new o.AutomationEventList(x),w=m?i(b):null,S={get defaultValue(){return x},get maxValue(){return null===v?g.maxValue:v},get minValue(){return null===y?g.minValue:y},get value(){return g.value},set value(t){g.value=t,S.setValueAtTime(t,f.context.currentTime)},cancelAndHoldAtTime(t){if("function"===typeof g.cancelAndHoldAtTime)null===w&&b.flush(f.context.currentTime),b.add(r(t)),g.cancelAndHoldAtTime(t);else{const e=Array.from(b).pop();null===w&&b.flush(f.context.currentTime),b.add(r(t));const n=Array.from(b).pop();g.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?g.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?g.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?g.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&g.setValueCurveAtTime(n.values,n.startTime,n.duration))}return S},cancelScheduledValues:t=>(null===w&&b.flush(f.context.currentTime),b.add(s(t)),g.cancelScheduledValues(t),S),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;const n=f.context.currentTime;return null===w&&b.flush(n),0===Array.from(b).length&&(b.add(u(x,n)),g.setValueAtTime(x,n)),b.add(a(t,e)),g.exponentialRampToValueAtTime(t,e),S},linearRampToValueAtTime(t,e){const n=f.context.currentTime;return null===w&&b.flush(n),0===Array.from(b).length&&(b.add(u(x,n)),g.setValueAtTime(x,n)),b.add(c(t,e)),g.linearRampToValueAtTime(t,e),S},setTargetAtTime:(t,e,n)=>(null===w&&b.flush(f.context.currentTime),b.add(l(t,e,n)),g.setTargetAtTime(t,e,n),S),setValueAtTime:(t,e)=>(null===w&&b.flush(f.context.currentTime),b.add(u(t,e)),g.setValueAtTime(t,e),S),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==d&&"webkitAudioContext"===d.name){const t=e+n,r=f.context.sampleRate,s=Math.ceil(e*r),o=Math.floor(t*r),a=o-s,c=new Float32Array(a);for(let u=0;u<a;u+=1){const t=(i.length-1)/n*((s+u)/r-e),o=Math.floor(t),a=Math.ceil(t);c[u]=o===a?i[o]:(1-(t-o))*i[o]+(1-(a-t))*i[a]}null===w&&b.flush(f.context.currentTime),b.add(h(c,e,n)),g.setValueCurveAtTime(c,e,n);const l=o/r;l<t&&p(S,c[c.length-1],l),p(S,i[i.length-1],t)}else null===w&&b.flush(f.context.currentTime),b.add(h(i,e,n)),g.setValueCurveAtTime(i,e,n);return S}};return n.set(S,g),e.set(S,f),t(S,w),S})((sn=u,(t,e)=>{sn.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),De,h,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t)}}}})),o.createCancelAndHoldAutomationEvent,o.createCancelScheduledValuesAutomationEvent,o.createExponentialRampToValueAutomationEvent,o.createLinearRampToValueAutomationEvent,o.createSetTargetAutomationEvent,o.createSetValueAutomationEvent,o.createSetValueCurveAutomationEvent,Fe,le);var sn;const on=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const a=s(t),c={...z,...i},l=r(a,c),u=o(a),h=u?e():null;super(t,!1,l,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=l,this._onended=null,this._playbackRate=n(this,u,l.playbackRate,L,F)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"===typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){C(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),B(this)&&A(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(je,nn,rn,It,tn,Oe,Me,ge),an=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,n){const i=s(t),c=o(i),l=r(i,n,c);super(t,!1,l,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=l}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(je,(t=>{const e=new WeakMap;return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):(async(n,i)=>{const r=i.destination;return e.set(i,r),await t(n,i,r),r})(n,i)}}}),M,It,((t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{s.channelCount=e}catch(n){if(e>s.maxChannelCount)throw n}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o})(Yt,ce),Oe,Me,Ae),cn=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const l=R(c,a);if(!l){const t={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(a,t)}return s.set(a,c),l?(await t(a,o.Q,c.Q),await t(a,o.detune,c.detune),await t(a,o.frequency,c.frequency),await t(a,o.gain,c.gain)):(await i(a,o.Q,c.Q),await i(a,o.detune,c.detune),await i(a,o.frequency,c.frequency),await i(a,o.gain,c.gain)),await r(o,a,c),c})(o,a)}}})($e,Gt,nt,en,Ae),ln=(t=>(e,n)=>t.set(e,n))(be),un=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const c=s(t),l={...xt,...i},u=r(c,l),h=o(c);super(t,!1,u,h?n():null),this._Q=e(this,h,u.Q,L,F),this._detune=e(this,h,u.detune,1200*Math.log2(L),-1200*Math.log2(L)),this._frequency=e(this,h,u.frequency,t.sampleRate/2,0),this._gain=e(this,h,u.gain,40*Math.log10(L),F),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(r){if(11===r.code)throw i();throw r}if(t.length!==e.length||e.length!==n.length)throw i()}})(je,rn,cn,Ot,Gt,Oe,Me,ln),hn=((t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(r=>function(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=0===s.size;if(e(o))return r.call(n,o,a,c),t(s,[o,a,c],(t=>t[0]===o&&t[1]===a&&t[2]===c),!0),l&&i(),o;r.call(n,o,a),t(s,[o,a],(t=>t[0]===o&&t[1]===a),!0),l&&i()})(n.connect),n.disconnect=(t=>(i,o,a)=>{const c=s.size>0;if(void 0===i)t.apply(n),s.clear();else if("number"===typeof i){t.call(n,i);for(const t of s)t[1]===i&&s.delete(t)}else{e(i)?t.call(n,i,o,a):t.call(n,i,o);for(const t of s)t[0]!==i||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||s.delete(t)}const l=0===s.size;c&&l&&r()})(n.disconnect),n})(X,Be),dn=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)r.connect(i,0,e)}),(()=>r.disconnect(i)))})(It,hn),pn=((t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),Lt(r,i),r})(Fe,dn),fn=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!R(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(pn,nt,Ae),mn=((t,e,n,i,r)=>class extends t{constructor(t,s){const o=i(t),a={...bt,...s};super(t,!1,n(o,a),r(o)?e():null)}})(je,fn,pn,Oe,Me),gn=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!R(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(qt,nt,Ae),vn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),c=s({...wt,...o});super(t,!1,n(a,c),r(a)?e():null)}})(je,gn,qt,Oe,Me,(t=>({...t,channelCount:t.numberOfOutputs}))),yn=((t,e,n,i)=>(r,s)=>{let{offset:o,...a}=s;const c=r.createBuffer(1,2,44100),l=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...a,gain:o}),h=c.getChannelData(0);h[0]=1,h[1]=1,l.buffer=c,l.loop=!0;const d={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return l.onended},set onended(t){l.onended=t},addEventListener(){return l.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return l.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return l.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.start.call(l,t)},stop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.stop.call(l,t)}};return t(r,l),i(Ht(d,u),(()=>l.connect(u)),(()=>l.disconnect(u)))})(Ze,tn,Yt,hn),xn=((t,e,n,i,r)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return Lt(a,o),zt(a,o,"offset"),e(i,(()=>i(s)))||Ut(a),e(r,(()=>r(s)))||jt(a),t(s,a),a})(Ze,Se,yn,ue,de),bn=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,l){const u=s.get(l);return void 0!==u?Promise.resolve(u):(async(c,l)=>{let u=n(c);const h=R(u,l);if(!h){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=e(l,t),null!==o&&u.start(o),null!==a&&u.stop(a)}return s.set(l,u),h?await t(l,c.offset,u.offset):await i(l,c.offset,u.offset),await r(c,l,u),u})(c,l)}}})($e,xn,nt,en,Ae),wn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),c={...St,...o},l=i(a,c),u=s(a),h=u?n():null;super(t,!1,l,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=l,this._offset=e(this,u,l.offset,L,F),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"===typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){C(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),B(this)&&A(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(je,rn,bn,xn,Oe,Me,ge),Sn=((t,e)=>(n,i)=>{const r=n.createConvolver();if(Lt(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Ft(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(t=>()=>t.call(r)),(e=>n=>{if(n>2)throw t();return e.call(r,n)})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(t=>()=>t.call(r)),(e=>n=>{if("max"===n)throw t();return e.call(r,n)})),r})(Jt,ce),_n=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!R(o,s)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(s,e)}return i.set(s,o),Q(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(Sn,nt,Ae),Tn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),c={..._t,...o},l=n(a,c);super(t,!1,l,r(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=l,null!==c.buffer&&s(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(je,_n,Sn,Oe,Me,ln),En=((t,e,n,i,r)=>s=>{const o=new WeakMap;return{render(a,c){const l=o.get(c);return void 0!==l?Promise.resolve(l):(async(a,c)=>{let l=n(a);const u=R(l,c);if(!u){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:s};l=e(c,t)}return o.set(c,l),u?await t(c,a.delayTime,l.delayTime):await i(c,a.delayTime,l.delayTime),await r(a,c,l),l})(a,c)}}})($e,Xt,nt,en,Ae),Cn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const c=r(t),l={...Et,...a},u=i(c,l),h=s(c);super(t,!1,u,h?n(l.maxDelayTime):null),this._delayTime=e(this,h,u.delayTime),o(this,l.maxDelayTime)}get delayTime(){return this._delayTime}})(je,rn,En,Xt,Oe,Me,ln),kn=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Lt(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return zt(i,n,"attack"),zt(i,n,"knee"),zt(i,n,"ratio"),zt(i,n,"release"),zt(i,n,"threshold"),i})(Jt),An=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const l=R(c,a);if(!l){const t={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(a,t)}return s.set(a,c),l?(await t(a,o.attack,c.attack),await t(a,o.knee,c.knee),await t(a,o.ratio,c.ratio),await t(a,o.release,c.release),await t(a,o.threshold,c.threshold)):(await i(a,o.attack,c.attack),await i(a,o.knee,c.knee),await i(a,o.ratio,c.ratio),await i(a,o.release,c.release),await i(a,o.threshold,c.threshold)),await r(o,a,c),c})(o,a)}}})($e,kn,nt,en,Ae),In=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,r){const c=s(t),l={...kt,...r},u=i(c,l),h=o(c);super(t,!1,u,h?n():null),this._attack=e(this,h,u.attack),this._knee=e(this,h,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,h,u.ratio),this._release=e(this,h,u.release),this._threshold=e(this,h,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"===typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(je,rn,An,kn,Jt,Oe,Me,ln),On=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const l=R(c,a);if(!l){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(a,t)}return s.set(a,c),l?await t(a,o.gain,c.gain):await i(a,o.gain,c.gain),await r(o,a,c),c})(o,a)}}})($e,Yt,nt,en,Ae),Rn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),c={...At,...o},l=i(a,c),u=s(a);super(t,!1,l,u?n():null),this._gain=e(this,u,l.gain,L,F)}get gain(){return this._gain}})(je,rn,On,Yt,Oe,Me),Nn=((t,e,n,i)=>(r,s,o)=>{let{channelCount:a,channelCountMode:c,channelInterpretation:l,feedback:u,feedforward:h}=o;const d=Vt(s,r.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),f=h instanceof Float64Array?h:new Float64Array(h),m=p.length,g=f.length,v=Math.min(m,g);if(0===m||m>20)throw i();if(0===p[0])throw e();if(0===g||g>20)throw i();if(0===f[0])throw e();if(1!==p[0]){for(let t=0;t<g;t+=1)f[t]/=p[0];for(let t=1;t<m;t+=1)p[t]/=p[0]}const y=n(r,d,a,a);y.channelCount=a,y.channelCountMode=c,y.channelInterpretation=l;const x=[],b=[],w=[];for(let t=0;t<a;t+=1){x.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),b.push(t),w.push(e)}y.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let r=0;r<i;r+=1){const t=e.getChannelData(r),i=n.getChannelData(r);x[r]=Nt(p,m,f,g,v,b[r],w[r],x[r],32,t,i)}};const S=r.sampleRate/2;return Ht({get bufferSize(){return d},get channelCount(){return y.channelCount},set channelCount(t){y.channelCount=t},get channelCountMode(){return y.channelCountMode},set channelCountMode(t){y.channelCountMode=t},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(t){y.channelInterpretation=t},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(){return y.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return y.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/S),s=[Math.cos(r),Math.sin(r)],o=Kt(Qt(f,s),Qt(p,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener(){return y.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},y)})(Ot,It,Zt,Jt),Mn=((t,e,n,i)=>r=>t(Dt,(()=>Dt(r)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()})):new Promise((t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()})))(Se,Yt,Zt,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Yt,Ne)),Dn=((t,e,n,i,r)=>(s,o)=>{const a=new WeakMap;let c=null;const l=async(l,u)=>{let h=null,d=e(l);const p=R(d,u);if(void 0===u.createIIRFilter?h=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=u.createIIRFilter(o,s)),a.set(u,null===h?d:h),null!==h){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(l.context.destination.channelCount,l.context.length,u.sampleRate);c=(async()=>{await i(l,t,t.destination);return((t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,c=Math.min(o,a);if(1!==r[0]){for(let t=0;t<o;t+=1)s[t]/=r[0];for(let t=1;t<a;t+=1)r[t]/=r[0]}const l=new Float32Array(32),u=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let p=0;p<d;p+=1){const e=t.getChannelData(p),n=h.getChannelData(p);l.fill(0),u.fill(0),Nt(r,o,s,a,c,l,u,0,32,e,n)}return h})(await r(t),u,s,o)})()}const t=await c;return h.buffer=t,h.start(0),h}return await i(l,u,d),d};return{render(t,e){const n=a.get(e);return void 0!==n?Promise.resolve(n):l(t,e)}}})(tn,nt,Ne,Ae,Mn),Pn=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return Lt(r,i),r})(Nn),Fn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),c=r(a),l={...Rt,...o},u=e(a,c?null:t.baseLatency,l);super(t,!1,u,c?n(l.feedback,l.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw Ot();return e.call(t,n,i,r)})})(u),this._nativeIIRFilterNode=u,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(je,Pn,Dn,Oe,Me,ln),Ln=((t,e,n,i,r,s,o,a)=>(c,l)=>{const u=l.listener,{forwardX:h,forwardY:d,forwardZ:p,positionX:f,positionY:m,positionZ:g,upX:v,upY:y,upZ:x}=void 0===u.forwardX?(()=>{const h=new Float32Array(1),d=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(l);let f=!1,m=[0,0,-1,0,1,0],g=[0,0,0];const v=()=>{if(f)return;f=!0;const t=i(l,256,9,0);t.onaudioprocess=t=>{let{inputBuffer:e}=t;const n=[s(e,h,0),s(e,h,1),s(e,h,2),s(e,h,3),s(e,h,4),s(e,h,5)];n.some(((t,e)=>t!==m[e]))&&(u.setOrientation(...n),m=n);const i=[s(e,h,6),s(e,h,7),s(e,h,8)];i.some(((t,e)=>t!==g[e]))&&(u.setPosition(...i),g=i)},d.connect(t)},y=t=>e=>{e!==m[t]&&(m[t]=e,u.setOrientation(...m))},x=t=>e=>{e!==g[t]&&(g[t]=e,u.setPosition(...g))},b=(e,i,s)=>{const o=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(d,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const u=t({context:c},p,o.offset,L,F);var h,f,m,g,y,x,b;return a(u,"value",(t=>()=>t.call(u)),(t=>e=>{try{t.call(u,e)}catch(n){if(9!==n.code)throw n}v(),p&&s(e)})),u.cancelAndHoldAtTime=(h=u.cancelAndHoldAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=h.apply(u,e);return v(),i}),u.cancelScheduledValues=(f=u.cancelScheduledValues,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=f.apply(u,e);return v(),i}),u.exponentialRampToValueAtTime=(m=u.exponentialRampToValueAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=m.apply(u,e);return v(),i}),u.linearRampToValueAtTime=(g=u.linearRampToValueAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=g.apply(u,e);return v(),i}),u.setTargetAtTime=(y=u.setTargetAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=y.apply(u,e);return v(),i}),u.setValueAtTime=(x=u.setValueAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=x.apply(u,e);return v(),i}),u.setValueCurveAtTime=(b=u.setValueCurveAtTime,p?()=>{throw r()}:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=b.apply(u,e);return v(),i}),u};return{forwardX:b(0,0,y(0)),forwardY:b(1,0,y(1)),forwardZ:b(2,-1,y(2)),positionX:b(6,0,x(0)),positionY:b(7,0,x(1)),positionZ:b(8,0,x(2)),upX:b(3,0,y(3)),upY:b(4,1,y(4)),upZ:b(5,0,y(5))}})():u;return{get forwardX(){return h},get forwardY(){return d},get forwardZ(){return p},get positionX(){return f},get positionY(){return m},get positionZ(){return g},get upX(){return v},get upY(){return y},get upZ(){return x}}})(rn,pn,xn,Zt,Jt,oe,Me,ce),Bn=new WeakMap,zn=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,d.set(this,n),i(n)&&r.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"===typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(an,Ln,Pe,Me,Bn,ge),Un=((t,e,n,i,r,s)=>(o,a)=>{const c=o.createOscillator();return Lt(c,a),zt(c,a,"detune"),zt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):Ft(c,a,"type"),e(n,(()=>n(o)))||Ut(c),e(i,(()=>i(o)))||s(c,o),e(r,(()=>r(o)))||jt(c),t(o,c),c})(Ze,Se,ue,he,de,me),jn=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){c=t},render(l,u){const h=s.get(u);return void 0!==h?Promise.resolve(h):(async(l,u)=>{let h=n(l);const d=R(h,u);if(!d){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===o?void 0:o,type:h.type};h=e(u,t),null!==a&&h.start(a),null!==c&&h.stop(c)}return s.set(u,h),d?(await t(u,l.detune,h.detune),await t(u,l.frequency,h.frequency)):(await i(u,l.detune,h.detune),await i(u,l.frequency,h.frequency)),await r(l,u,h),h})(l,u)}}})($e,Un,nt,en,Ae),Vn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),c={...te,...o},l=n(a,c),u=s(a),h=u?i():null,d=t.sampleRate/2;super(t,!1,l,h),this._detune=e(this,u,l.detune,153600,-153600),this._frequency=e(this,u,l.frequency,d,-d),this._nativeOscillatorNode=l,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"===typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){C(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),B(this)&&A(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(je,rn,Un,jn,Oe,Me,ge),Wn=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(tn),Gn=((t,e,n,i,r)=>(s,o)=>{let{curve:a,oversample:c,...l}=o;const u=s.createWaveShaper(),h=s.createWaveShaper();Lt(u,l),Lt(h,l);const d=n(s,{...l,gain:1}),p=n(s,{...l,gain:-1}),f=n(s,{...l,gain:1}),m=n(s,{...l,gain:-1});let g=null,v=!1,y=null;const x={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){d.channelCount=t,p.channelCount=t,u.channelCount=t,f.channelCount=t,h.channelCount=t,m.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){d.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t,h.channelCountMode=t,m.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){d.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t,h.channelInterpretation=t,m.channelInterpretation=t},get context(){return u.context},get curve(){return y},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,h.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const r=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<r;o+=1){const a=o/r*s,c=Math.floor(a),l=Math.ceil(a);e[o]=c===l?n[c]:(1-(a-c))*n[c]+(1-(l-a))*n[l],i[o]=c===l?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(l-a))*n[t-1-l]}e[r]=t%2===1?n[r-1]:(n[r-2]+n[r-1])/2,u.curve=e,h.curve=i}y=n,v&&(i(y)&&null===g?g=t(s,d):null!==g&&(g(),g=null))},get inputs(){return[d]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(t){u.oversample=t,h.oversample=t},addEventListener(){return d.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return d.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return d.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};null!==a&&(x.curve=a instanceof Float32Array?a:new Float32Array(a)),c!==x.oversample&&(x.oversample=c);return r(Ht(x,f),(()=>{d.connect(u).connect(f),d.connect(p).connect(h).connect(m).connect(f),v=!0,i(y)&&(g=t(s,d))}),(()=>{d.disconnect(u),u.disconnect(f),d.disconnect(p),p.disconnect(h),h.disconnect(m),m.disconnect(f),v=!1,null!==g&&(g(),g=null)}))})(Wn,It,Yt,ae,hn),qn=((t,e,n,i,r,s,o)=>(a,c)=>{const l=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return n(a,c);Lt(l,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw e();Ft(l,{curve:u},"curve"),Ft(l,c,"oversample");let h=null,d=!1;o(l,"curve",(t=>()=>t.call(l)),(e=>n=>(e.call(l,n),d&&(i(n)&&null===h?h=t(a,l):i(n)||null===h||(h(),h=null)),n)));return r(l,(()=>{d=!0,i(l.curve)&&(h=t(a,l))}),(()=>{d=!1,null!==h&&(h(),h=null)}))})(Wn,It,Gn,ae,hn,Fe,ce),Hn=((t,e,n,i,r,s,o,a,c,l)=>(u,h)=>{let{coneInnerAngle:d,coneOuterAngle:p,coneOuterGain:f,distanceModel:m,maxDistance:g,orientationX:v,orientationY:y,orientationZ:x,panningModel:b,positionX:w,positionY:S,positionZ:_,refDistance:T,rolloffFactor:E,...C}=h;const k=u.createPanner();if(C.channelCount>2)throw o();if("max"===C.channelCountMode)throw o();Lt(k,C);const A={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=n(u,{...A,channelInterpretation:"speakers",numberOfInputs:6}),O=i(u,{...C,gain:1}),R=i(u,{...A,gain:1}),N=i(u,{...A,gain:0}),M=i(u,{...A,gain:0}),D=i(u,{...A,gain:0}),P=i(u,{...A,gain:0}),F=i(u,{...A,gain:0}),L=r(u,256,6,1),B=s(u,{...A,curve:new Float32Array([1,1]),oversample:"none"});let z=[v,y,x],U=[w,S,_];const j=new Float32Array(1);L.onaudioprocess=t=>{let{inputBuffer:e}=t;const n=[c(e,j,0),c(e,j,1),c(e,j,2)];n.some(((t,e)=>t!==z[e]))&&(k.setOrientation(...n),z=n);const i=[c(e,j,3),c(e,j,4),c(e,j,5)];i.some(((t,e)=>t!==U[e]))&&(k.setPosition(...i),U=i)},Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const V={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,k.channelCount=t},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,k.channelCountMode=t},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,k.channelInterpretation=t},get coneInnerAngle(){return k.coneInnerAngle},set coneInnerAngle(t){k.coneInnerAngle=t},get coneOuterAngle(){return k.coneOuterAngle},set coneOuterAngle(t){k.coneOuterAngle=t},get coneOuterGain(){return k.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();k.coneOuterGain=t},get context(){return k.context},get distanceModel(){return k.distanceModel},set distanceModel(t){k.distanceModel=t},get inputs(){return[O]},get maxDistance(){return k.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;k.maxDistance=t},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get orientationX(){return R.gain},get orientationY(){return N.gain},get orientationZ(){return M.gain},get panningModel(){return k.panningModel},set panningModel(t){k.panningModel=t},get positionX(){return D.gain},get positionY(){return P.gain},get positionZ(){return F.gain},get refDistance(){return k.refDistance},set refDistance(t){if(t<0)throw new RangeError;k.refDistance=t},get rolloffFactor(){return k.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;k.rolloffFactor=t},addEventListener(){return O.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return O.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return O.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};d!==V.coneInnerAngle&&(V.coneInnerAngle=d),p!==V.coneOuterAngle&&(V.coneOuterAngle=p),f!==V.coneOuterGain&&(V.coneOuterGain=f),m!==V.distanceModel&&(V.distanceModel=m),g!==V.maxDistance&&(V.maxDistance=g),v!==V.orientationX.value&&(V.orientationX.value=v),y!==V.orientationY.value&&(V.orientationY.value=y),x!==V.orientationZ.value&&(V.orientationZ.value=x),b!==V.panningModel&&(V.panningModel=b),w!==V.positionX.value&&(V.positionX.value=w),S!==V.positionY.value&&(V.positionY.value=S),_!==V.positionZ.value&&(V.positionZ.value=_),T!==V.refDistance&&(V.refDistance=T),E!==V.rolloffFactor&&(V.rolloffFactor=E),1===z[0]&&0===z[1]&&0===z[2]||k.setOrientation(...z),0===U[0]&&0===U[1]&&0===U[2]||k.setPosition(...U);return l(Ht(V,k),(()=>{O.connect(k),t(O,B,0,0),B.connect(R).connect(I,0,0),B.connect(N).connect(I,0,1),B.connect(M).connect(I,0,2),B.connect(D).connect(I,0,3),B.connect(P).connect(I,0,4),B.connect(F).connect(I,0,5),I.connect(L).connect(u.destination)}),(()=>{O.disconnect(k),a(O,B,0,0),B.disconnect(R),R.disconnect(I),B.disconnect(N),N.disconnect(I),B.disconnect(M),M.disconnect(I),B.disconnect(D),D.disconnect(I),B.disconnect(P),P.disconnect(I),B.disconnect(F),F.disconnect(I),I.disconnect(L),L.disconnect(u.destination)}))})(Z,It,pn,Yt,Zt,qn,Jt,et,oe,hn),Xn=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(Lt(i,n),zt(i,n,"orientationX"),zt(i,n,"orientationY"),zt(i,n,"orientationZ"),zt(i,n,"positionX"),zt(i,n,"positionY"),zt(i,n,"positionZ"),Ft(i,n,"coneInnerAngle"),Ft(i,n,"coneOuterAngle"),Ft(i,n,"coneOuterGain"),Ft(i,n,"distanceModel"),Ft(i,n,"maxDistance"),Ft(i,n,"panningModel"),Ft(i,n,"refDistance"),Ft(i,n,"rolloffFactor"),i)})(Hn),Yn=((t,e,n,i,r,s,o,a,c,l)=>()=>{const u=new WeakMap;let h=null;return{render(d,p){const f=u.get(p);return void 0!==f?Promise.resolve(f):(async(d,p)=>{let f=null,m=s(d);const g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=R(m,p);if("bufferSize"in m)f=i(p,{...g,gain:1});else if(!y){const t={...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=r(p,t)}if(u.set(p,null===f?m:f),null!==f){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,d.context.length,p.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(e,i)=>{const r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,r.offset),r})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return l(t)})()}const t=await h,s=i(p,{...g,gain:1});await c(d,p,s);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let m=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],x=i(p,{...g,gain:1}),b=r(p,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});s.connect(x).connect(b.inputs[0]),b.connect(f);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],n=[u[3][e],u[4][e],u[5][e]];if(t.some(((t,e)=>t!==m[e]))||n.some(((t,e)=>t!==y[e]))){m=t,y=n;const o=e/p.sampleRate;x.gain.setValueAtTime(0,o),x=i(p,{...g,gain:0}),b=r(p,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),x.gain.setValueAtTime(1,o),s.connect(x).connect(b.inputs[0]),b.connect(f)}}return f}return y?(await t(p,d.orientationX,m.orientationX),await t(p,d.orientationY,m.orientationY),await t(p,d.orientationZ,m.orientationZ),await t(p,d.positionX,m.positionX),await t(p,d.positionY,m.positionY),await t(p,d.positionZ,m.positionZ)):(await a(p,d.orientationX,m.orientationX),await a(p,d.orientationY,m.orientationY),await a(p,d.orientationZ,m.orientationZ),await a(p,d.positionX,m.positionX),await a(p,d.positionY,m.positionY),await a(p,d.positionZ,m.positionZ)),Q(m)?await c(d,p,m.inputs[0]):await c(d,p,m),m})(d,p)}}})($e,pn,xn,Yt,Xn,nt,Ne,en,Ae,Mn),Kn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const c=r(t),l={...ee,...a},u=n(c,l),h=s(c);super(t,!1,u,h?i():null),this._nativePannerNode=u,this._orientationX=e(this,h,u.orientationX,L,F),this._orientationY=e(this,h,u.orientationY,L,F),this._orientationZ=e(this,h,u.orientationZ,L,F),this._positionX=e(this,h,u.positionX,L,F),this._positionY=e(this,h,u.positionY,L,F),this._positionZ=e(this,h,u.positionZ,L,F),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(je,rn,Xn,Yn,Oe,Me,ln),Qn=(t=>(e,n)=>{let{disableNormalization:i,imag:r,real:s}=n;const o=r instanceof Float32Array?r:new Float32Array(r),a=s instanceof Float32Array?s:new Float32Array(s),c=e.createPeriodicWave(a,o,{disableNormalization:i});if(Array.from(r).length<2)throw t();return c})(M),Zn=((t,e,n,i)=>class r{constructor(r,s){const o=e(r),a=i({...ne,...s}),c=t(o,a);return n.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"===typeof t&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}})(Qn,Oe,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Jn=((t,e,n,i,r,s)=>{const o=16385,a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(t,s,h,d,p)=>{if(1===s)return((t,e,r,s)=>{const h=new Float32Array(o),d=new Float32Array(o);for(let n=0;n<o;n+=1){const t=n/16384*c;h[n]=Math.cos(t),d[n]=Math.sin(t)}const p=n(t,{...l,gain:0}),f=i(t,{...u,curve:h}),m=i(t,{...u,curve:a}),g=n(t,{...l,gain:0}),v=i(t,{...u,curve:d});return{connectGraph(){e.connect(p),e.connect(void 0===m.inputs?m:m.inputs[0]),e.connect(g),m.connect(r),r.connect(void 0===f.inputs?f:f.inputs[0]),r.connect(void 0===v.inputs?v:v.inputs[0]),f.connect(p.gain),v.connect(g.gain),p.connect(s,0,0),g.connect(s,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===m.inputs?m:m.inputs[0]),e.disconnect(g),m.disconnect(r),r.disconnect(void 0===f.inputs?f:f.inputs[0]),r.disconnect(void 0===v.inputs?v:v.inputs[0]),f.disconnect(p.gain),v.disconnect(g.gain),p.disconnect(s,0,0),g.disconnect(s,0,1)}}})(t,h,d,p);if(2===s)return((t,r,s,h)=>{const d=new Float32Array(o),p=new Float32Array(o),f=new Float32Array(o),m=new Float32Array(o),g=Math.floor(8192.5);for(let e=0;e<o;e+=1)if(e>g){const t=(e-g)/(16384-g)*c;d[e]=Math.cos(t),p[e]=Math.sin(t),f[e]=0,m[e]=1}else{const t=e/(16384-g)*c;d[e]=1,p[e]=0,f[e]=Math.cos(t),m[e]=Math.sin(t)}const v=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(t,{...l,gain:0}),x=i(t,{...u,curve:d}),b=n(t,{...l,gain:0}),w=i(t,{...u,curve:p}),S=i(t,{...u,curve:a}),_=n(t,{...l,gain:0}),T=i(t,{...u,curve:f}),E=n(t,{...l,gain:0}),C=i(t,{...u,curve:m});return{connectGraph(){r.connect(v),r.connect(void 0===S.inputs?S:S.inputs[0]),v.connect(y,0),v.connect(b,0),v.connect(_,1),v.connect(E,1),S.connect(s),s.connect(void 0===x.inputs?x:x.inputs[0]),s.connect(void 0===w.inputs?w:w.inputs[0]),s.connect(void 0===T.inputs?T:T.inputs[0]),s.connect(void 0===C.inputs?C:C.inputs[0]),x.connect(y.gain),w.connect(b.gain),T.connect(_.gain),C.connect(E.gain),y.connect(h,0,0),_.connect(h,0,0),b.connect(h,0,1),E.connect(h,0,1)},disconnectGraph(){r.disconnect(v),r.disconnect(void 0===S.inputs?S:S.inputs[0]),v.disconnect(y,0),v.disconnect(b,0),v.disconnect(_,1),v.disconnect(E,1),S.disconnect(s),s.disconnect(void 0===x.inputs?x:x.inputs[0]),s.disconnect(void 0===w.inputs?w:w.inputs[0]),s.disconnect(void 0===T.inputs?T:T.inputs[0]),s.disconnect(void 0===C.inputs?C:C.inputs[0]),x.disconnect(y.gain),w.disconnect(b.gain),T.disconnect(_.gain),C.disconnect(E.gain),y.disconnect(h,0,0),_.disconnect(h,0,0),b.disconnect(h,0,1),E.disconnect(h,0,1)}}})(t,h,d,p);throw r()};return(e,i)=>{let{channelCount:o,channelCountMode:a,pan:c,...l}=i;if("max"===a)throw r();const u=t(e,{...l,channelCount:1,channelCountMode:a,numberOfInputs:2}),d=n(e,{...l,channelCount:o,channelCountMode:a,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:c});let{connectGraph:f,disconnectGraph:m}=h(e,o,d,p,u);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const g={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(t){d.channelCount!==t&&(v&&m(),({connectGraph:f,disconnectGraph:m}=h(e,t,d,p,u)),v&&f()),d.channelCount=t},get channelCountMode(){return d.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();d.channelCountMode=t},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(t){d.channelInterpretation=t},get context(){return d.context},get inputs(){return[d]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get pan(){return p.gain},addEventListener(){return d.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent(){return d.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return d.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};let v=!1;return s(Ht(g,u),(()=>{f(),v=!0}),(()=>{m(),v=!1}))}})(pn,qt,Yt,qn,Jt,hn),$n=((t,e)=>(n,i)=>{const r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);const s=n.createStereoPanner();return Lt(s,i),zt(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e()}}),s})(Jn,Jt),ti=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const l=R(c,a);if(!l){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(a,t)}return s.set(a,c),l?await t(a,o.pan,c.pan):await i(a,o.pan,c.pan),Q(c)?await r(o,a,c.inputs[0]):await r(o,a,c),c})(o,a)}}})($e,$n,nt,en,Ae),ei=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),c={...ie,...o},l=n(a,c),u=s(a);super(t,!1,l,u?i():null),this._pan=e(this,u,l.pan)}get pan(){return this._pan}})(je,rn,$n,ti,Oe,Me),ni=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!R(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(s,e)}return i.set(s,o),Q(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(qn,nt,Ae),ii=((t,e,n,i,r,s,o)=>class extends t{constructor(t,e){const a=r(t),c={...se,...e},l=n(a,c);super(t,!0,l,s(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(je,It,qn,ni,Oe,Me,ln),ri=(t=>null!==t&&t.isSecureContext)(Ee),si=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Ee),oi=new WeakMap,ai=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(oi,Ne),ci=ri?((t,e,n,i,r,s,o,a,c,l,u,h,d)=>{let p=0;return function(f,g){let v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"};const y=u.get(f);if(void 0!==y&&y.has(g))return Promise.resolve();const S=l.get(f);if(void 0!==S){const t=S.get(g);if(void 0!==t)return t}const _=s(f),T=void 0===_.audioWorklet?r(g).then((t=>{let[e,i]=t;const[r,s]=x(e,i),o="".concat(r,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(s,"\n})})(window,'_AWGS')");return n(o)})).then((()=>{const t=d._AWGS.pop();if(void 0===t)throw new SyntaxError;i(_.currentTime,_.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=m.get(_);if(void 0!==i){if(i.has(t))throw e();w(n),b(n.parameterDescriptors),i.set(t,n)}else w(n),b(n.parameterDescriptors),m.set(_,new Map([[t,n]]))}),_.sampleRate,void 0,void 0)))})):Promise.all([r(g),Promise.resolve(t(h,h))]).then((t=>{let[[e,n],i]=t;const r=p+1;p=r;const[s,l]=x(e,n),u=i?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",h=i?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));",d=i?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));",f="".concat(s,";((AudioWorkletProcessor,registerProcessor)=>{").concat(l,"\n})(").concat(u,",(n,p)=>registerProcessor(n,class extends p{").concat(h,"process(i,o,p){").concat(d,"return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(r,"',class extends AudioWorkletProcessor{process(){return !1}})"),m=new Blob([f],{type:"application/javascript; charset=utf-8"}),g=URL.createObjectURL(m);return _.audioWorklet.addModule(g,v).then((()=>{if(a(_))return _;const t=o(_);return t.audioWorklet.addModule(g,v).then((()=>t))})).then((t=>{if(null===c)throw new SyntaxError;try{new c(t,"__sac".concat(r))}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(g)))}));return void 0===S?l.set(f,new Map([[g,T]])):S.set(g,T),T.then((()=>{const t=u.get(f);void 0===t?u.set(f,new Set([g])):t.add(g)})).finally((()=>{const t=l.get(f);void 0!==t&&t.delete(g)})),T}})(Se,Jt,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const r=t.document.head;if(null===r)i(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,r,s,o)=>n===a||n===t.location.href&&1===r&&1===s?(l(),i(o),!1):null!==c?c(e,n,r,s,o):void 0,s.onerror=()=>{l(),i(new SyntaxError)},s.onload=()=>{l(),n()},s.src=a,s.type="module",r.appendChild(s)}})))(Ee),si,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw t()})((()=>new DOMException("","AbortError"))),Oe,ai,Me,Ue,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering(),await new Promise((t=>setTimeout(t)))}catch{}finally{URL.revokeObjectURL(r)}return s&&!o})(Ue,Ne),Ee):void 0,li=((t,e)=>n=>t(n)||e(n))(Le,Me),ui=((t,e,n,i,r,s,o,a,c,l,u)=>(h,d)=>{const p=o(h)?h:s(h);if(r.has(d)){const t=n();return Promise.reject(t)}try{r.add(d)}catch{}return e(c,(()=>c(p)))?p.decodeAudioData(d).then((n=>(Tt(d).catch((()=>{})),e(a,(()=>a(n)))||u(n),t.add(n),n))):new Promise(((e,n)=>{const r=async()=>{try{await Tt(d)}catch{}},s=t=>{n(t),r()};try{p.decodeAudioData(d,(n=>{"function"!==typeof n.copyFromChannel&&(l(n),D(n)),t.add(n),r().then((()=>e(n)))}),(t=>{s(null===t?i():t)}))}catch(o){s(o)}}))})(Ge,Se,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,Oe,li,N,Dt,Ye,Ke),hi=((t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m,g,v,y,x)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(){return new s(this,{numberOfInputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}createChannelSplitter(){return new o(this,{numberOfOutputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(){return new u(this,{maxDelayTime:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(t,e){return new v(this,{...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1},imag:e,real:t})}createStereoPanner(){return new y(this)}createWaveShaper(){return new x(this)}decodeAudioData(t,e,n){return l(this._nativeContext,t).then((t=>("function"===typeof e&&e(t),t)),(t=>{throw"function"===typeof n&&n(t),t}))}})(ci,We,Qe,on,un,mn,vn,wn,Tn,ui,Cn,In,Rn,Fn,zn,Vn,Kn,Zn,ei,ii),di=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(je,((t,e)=>t.createMediaElementSource(e.mediaElement)),Oe,Me),pi=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t);if(i(s))throw new TypeError;const o={...Mt,...r},a=e(s,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(je,((t,e)=>{const n=t.createMediaStreamDestination();return Lt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),Oe,Me),fi=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(je,((t,e)=>{let{mediaStream:n}=e;const i=n.getAudioTracks();i.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const r=i.slice(0,1),s=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(s,"mediaStream",{value:n}),s}),Oe,Me),mi=((t,e)=>(n,i)=>{let{mediaStreamTrack:r}=i;if("function"===typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);const s=new MediaStream([r]),o=n.createMediaStreamSource(s);if("audio"!==r.kind)throw t();if(e(n))throw new TypeError;return o})(It,Me),gi=((t,e,n)=>class extends t{constructor(t,i){const r=n(t);super(t,!0,e(r,i),null)}})(je,mi,Oe),vi=((t,e,n,i,r,s,o,a,c)=>class extends t{constructor(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null===c)throw new Error("Missing the native AudioContext constructor.");try{t=new c(e)}catch(o){if(12===o.code&&"sampleRate is not in range"===o.message)throw n();throw o}if(null===t)throw i();if(!G(e.latencyHint))throw new TypeError("The provided value '".concat(e.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw n();super(t,2);const{latencyHint:r}=e,{sampleRate:s}=t;if(this._baseLatency="number"===typeof t.baseLatency?t.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=t,"webkitAudioContext"===c.name?(this._nativeGainNode=t.createGain(),this._nativeOscillatorNode=t.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(t.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===t.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)})))}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(hi,It,Jt,re,di,pi,fi,gi,Fe),yi=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Bn),xi=(t=>(e,n)=>{t(e).add(n)})(yi),bi=(t=>function(e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=e[arguments.length>2&&void 0!==arguments[2]?arguments[2]:0];if(void 0===r)throw t();return ct(n)?r.connect(n,0,i):r.connect(n,0)})(M),wi=(t=>(e,n)=>{t(e).delete(n)})(yi),Si=(t=>function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?e.forEach((t=>t.disconnect())):"number"===typeof n?Ct(t,e,n).disconnect():ct(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===r?Ct(t,e,i).disconnect(n,0):Ct(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((t=>t.disconnect(n))):Ct(t,e,i).disconnect(n,0)})(M),_i=new WeakMap,Ti=((t,e)=>n=>e(t,n))(_i,S),Ei=((t,e,n,i,r,s,o,a,c,l,u,h,d)=>(p,f,m,v)=>{if(0===v.numberOfInputs&&0===v.numberOfOutputs)throw c();const y=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(y.some((t=>t<1)))throw c();if(y.length!==v.numberOfOutputs)throw e();if("explicit"!==v.channelCountMode)throw c();const x=v.channelCount*v.numberOfInputs,b=y.reduce(((t,e)=>t+e),0),w=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(x+w>6||b>6)throw c();const S=new MessageChannel,_=[],T=[];for(let t=0;t<v.numberOfInputs;t+=1)_.push(o(p,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),T.push(r(p,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const E=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){const r=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==v.parameterData[i]?v.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?L:e},minValue:{get:()=>void 0===n?F:n}}),E.push(r)}const C=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+w)}),k=Vt(f,p.sampleRate),A=a(p,k,x+w,Math.max(1,b)),I=r(p,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),O=[];for(let t=0;t<v.numberOfOutputs;t+=1)O.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[t]}));for(let t=0;t<v.numberOfInputs;t+=1){_[t].connect(T[t]);for(let e=0;e<v.channelCount;e+=1)T[t].connect(C,e,t*v.channelCount+e)}const R=new pt(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map(((t,e)=>{let{name:n}=t;const i=E[e];return i.connect(C,0,x+e),i.start(0),[n,i.offset]})));C.connect(A);let N=v.channelInterpretation,M=null;const D=0===v.numberOfOutputs?[A]:O,P={get bufferSize(){return k},get channelCount(){return v.channelCount},set channelCount(t){throw n()},get channelCountMode(){return v.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return N},set channelInterpretation(t){for(const e of _)e.channelInterpretation=t;N=t},get context(){return A.context},get inputs(){return _},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return M},set onprocessorerror(t){"function"===typeof M&&P.removeEventListener("processorerror",M),M="function"===typeof t?t:null,"function"===typeof M&&P.addEventListener("processorerror",M)},get parameters(){return R},get port(){return S.port2},addEventListener(){return A.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:t.bind(null,D),disconnect:l.bind(null,D),dispatchEvent(){return A.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener(){return A.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},B=new Map;var z,U;S.port1.addEventListener=(z=S.port1.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){const t="function"===typeof e[1]?e[1]:"object"===typeof e[1]&&null!==e[1]&&"function"===typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=B.get(e[1]);void 0!==n?e[1]=n:(e[1]=e=>{u(p.currentTime,p.sampleRate,(()=>t(e)))},B.set(t,e[1]))}}return z.call(S.port1,e[0],e[1],e[2])}),S.port1.removeEventListener=(U=S.port1.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){const t=B.get(e[1]);void 0!==t&&(B.delete(e[1]),e[1]=t)}return U.call(S.port1,e[0],e[1],e[2])});let j=null;Object.defineProperty(S.port1,"onmessage",{get:()=>j,set:t=>{"function"===typeof j&&S.port1.removeEventListener("message",j),j="function"===typeof t?t:null,"function"===typeof j&&(S.port1.addEventListener("message",j),S.port1.start())}}),m.prototype.port=S.port1;let V=null;const W=((t,e,n,i)=>{let r=g.get(t);void 0===r&&(r=new WeakMap,g.set(t,r));const s=Wt(n,i);return r.set(e,s),s})(p,P,m,v);W.then((t=>V=t));const G=vt(v.numberOfInputs,v.channelCount),q=vt(v.numberOfOutputs,y),H=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,e)=>{let{name:n}=e;return{...t,[n]:new Float32Array(128)}}),{});let X=!0;const Y=()=>{v.numberOfOutputs>0&&A.disconnect(I);for(let t=0,e=0;t<v.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<y[t];i+=1)I.disconnect(n,e+i,i);e+=y[t]}},K=new Map;A.onaudioprocess=t=>{let{inputBuffer:e,outputBuffer:n}=t;if(null!==V){const t=h(P);for(let r=0;r<k;r+=128){for(let t=0;t<v.numberOfInputs;t+=1)for(let n=0;n<v.channelCount;n+=1)mt(e,G[t],n,n,r);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach(((t,n)=>{let{name:i}=t;mt(e,H,i,x+n,r)}));for(let t=0;t<v.numberOfInputs;t+=1)for(let e=0;e<y[t];e+=1)0===q[t][e].byteLength&&(q[t][e]=new Float32Array(128));try{const e=G.map(((e,n)=>{if(t[n].size>0)return K.set(n,k/128),e;const i=K.get(n);return void 0===i?[]:(e.every((t=>t.every((t=>0===t))))&&(1===i?K.delete(n):K.set(n,i-1)),e)})),i=u(p.currentTime+r/p.sampleRate,p.sampleRate,(()=>V.process(e,q,H)));X=i;for(let t=0,s=0;t<v.numberOfOutputs;t+=1){for(let e=0;e<y[t];e+=1)gt(n,q[t],e,s+e,r);s+=y[t]}}catch(i){X=!1,P.dispatchEvent(new ErrorEvent("processorerror",{colno:i.colno,filename:i.filename,lineno:i.lineno,message:i.message}))}if(!X){for(let t=0;t<v.numberOfInputs;t+=1){_[t].disconnect(T[t]);for(let e=0;e<v.channelCount;e+=1)T[r].disconnect(C,e,t*v.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=E[e];t.disconnect(C,0,x+e),t.stop()}}C.disconnect(A),A.onaudioprocess=null,Q?Y():$();break}}}};let Q=!1;const Z=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),J=()=>A.connect(Z).connect(p.destination),$=()=>{A.disconnect(Z),Z.disconnect()};return J(),d(P,(()=>{if(X){$(),v.numberOfOutputs>0&&A.connect(I);for(let t=0,e=0;t<v.numberOfOutputs;t+=1){const n=O[t];for(let i=0;i<y[t];i+=1)I.connect(n,e+i,i);e+=y[t]}}Q=!0}),(()=>{X&&(J(),Y()),Q=!1}))})(bi,M,It,pn,qt,xn,Yt,Zt,Jt,Si,si,Ti,hn),Ci=((t,e,n,i,r)=>(s,o,a,c,l,u)=>{if(null!==a)try{const e=new a(s,c,u),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"===typeof o&&e.removeEventListener("processorerror",o),o="function"===typeof t?t:null,"function"===typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(d=e.addEventListener,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if("processorerror"===n[0]){const t="function"===typeof n[1]?n[1]:"object"===typeof n[1]&&null!==n[1]&&"function"===typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==t){const e=i.get(n[1]);void 0!==e?n[1]=e:(n[1]=e=>{"error"===e.type?(Object.defineProperties(e,{type:{value:"processorerror"}}),t(e)):t(new ErrorEvent(n[0],{...e}))},i.set(t,n[1]))}}return d.call(e,"error",n[1],n[2]),d.call(e,...n)}),e.removeEventListener=(h=e.removeEventListener,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if("processorerror"===n[0]){const t=i.get(n[1]);void 0!==t&&(i.delete(n[1]),n[1]=t)}return h.call(e,"error",n[1],n[2]),h.call(e,n[0],n[1],n[2])}),0!==u.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(s.destination);return r(e,(()=>t.disconnect()),(()=>t.connect(s.destination)))}return e}catch(p){if(11===p.code)throw i();throw p}var h,d;if(void 0===l)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(s,o,l,u)})(It,Ei,Yt,Jt,hn),ki=((t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m)=>(g,v,y)=>{const x=new WeakMap;let b=null;return{render(w,S){a(S,w);const _=x.get(S);return void 0!==_?Promise.resolve(_):(async(a,w)=>{let S=u(a),_=null;const T=R(S,w),E=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(null===h){const t=E.reduce(((t,e)=>t+e),0),n=r(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let e=0;e<a.numberOfOutputs;e+=1)s.push(i(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:E[e]}));const l=o(w,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});l.connect=e.bind(null,s),l.disconnect=c.bind(null,s),_=[n,s,l]}else T||(S=new h(w,g));if(x.set(w,null===_?S:_[2]),null!==_){if(null===b){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=t+e,c=async()=>{const c=new d(n,128*Math.ceil(a.context.length/128),w.sampleRate),l=[],u=[];for(let t=0;t<v.numberOfInputs;t+=1)l.push(o(c,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),u.push(r(c,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=s(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(c,t,e.offset),e}))),g=i(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<v.numberOfInputs;t+=1){l[t].connect(u[t]);for(let e=0;e<v.channelCount;e+=1)u[t].connect(g,e,t*v.channelCount+e)}for(const[e,n]of h.entries())n.connect(g,0,t+e),n.start(0);return g.connect(c.destination),await Promise.all(l.map((t=>f(a,c,t)))),m(c)};b=yt(a,0===n?null:await c(),w,v,E,y,l)}const t=await b,e=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,h]=_;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let n=0,i=0;n<a.numberOfOutputs;n+=1){const t=u[n];for(let e=0;e<E[n];e+=1)c.connect(t,i+e,e);i+=E[n]}return h}if(T)for(const[e,n]of a.parameters.entries())await t(w,n,S.parameters.get(e));else for(const[t,e]of a.parameters.entries())await p(w,e,S.parameters.get(t));return await f(a,w,S),S})(w,S)}}})($e,bi,tn,pn,qt,xn,Yt,wi,Si,si,nt,Ue,Ne,en,Ae,Mn),Ai=(t=>e=>t.get(e))(oi),Ii=(t=>(e,n)=>{t.set(e,n)})(_i),Oi=ri?((t,e,n,i,r,s,o,a,c,l,u,h,d,p)=>class extends e{constructor(e,p,f){var g;const v=a(e),y=c(v),x=u({...ft,...f});d(x);const b=m.get(v),w=null===b||void 0===b?void 0:b.get(p),S=y||"closed"!==v.state?v:null!==(g=o(v))&&void 0!==g?g:v,_=r(S,y?null:e.baseLatency,l,p,w,x);super(e,!0,_,y?i(p,x,w):null);const T=[];_.parameters.forEach(((t,e)=>{const i=n(this,y,t);T.push([e,i])})),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new pt(T),y&&t(v,this);const{activeInputs:E}=s(this);h(_,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"===typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(xi,je,rn,ki,Ci,U,Ai,Oe,Me,Ue,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),Ii,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),ge):void 0,Ri=(((t,e,n,i,r)=>{})(It,Jt,re,zn,Fe),((t,e)=>(n,i,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){if("SyntaxError"===s.name)throw t();throw s}})(Jt,Ne)),Ni=((t,e,n,i,r,s,o,a)=>(c,l)=>n(c).render(c,l).then((()=>Promise.all(Array.from(i(l)).map((t=>n(t).render(t,l)))))).then((()=>r(l))).then((n=>("function"!==typeof n.copyFromChannel?(o(n),D(n)):e(s,(()=>s(n)))||a(n),t.add(n),n))))(Ge,Se,ke,yi,Mn,N,Ye,Ke),Mi=(((t,e,n,i,r)=>{})(Se,It,Ri,zn,Ni),((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"===typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!==typeof t)throw new Error("The given parameters are not valid.");s=t}const{length:o,numberOfChannels:a,sampleRate:c}={...$t,...s},l=i(a,o,c);e(Dt,(()=>Dt(l)))||l.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(l.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(l,a),this._length=o,this._nativeOfflineAudioContext=l,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,W(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(hi,Se,It,Ri,Ni)),Di=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(d,Le),Pi=((t,e)=>n=>t.has(n)||e(n))(l,Be),Fi=((t,e)=>n=>t.has(n)||e(n))(h,ze),Li=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(d,Me),Bi=()=>(async(t,e,n,i,r,s,o,a,c,l,u,h,d,p,f,m)=>{if(t(e,e)&&t(n,n)&&t(r,r)&&t(s,s)&&t(a,a)&&t(c,c)&&t(l,l)&&t(u,u)&&t(h,h)&&t(d,d)&&t(p,p))return(await Promise.all([t(i,i),t(o,o),t(f,f),t(m,m)])).every((t=>t));return!1})(Se,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch{return!1}return!0})(Ne),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,n=void 0!==e.close;try{e.close()}catch{}return n})(Fe),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise((t=>{let n=!0;const i=i=>{n&&(n=!1,e.startRendering(),t(i instanceof TypeError))};let r;try{r=e.decodeAudioData(null,(()=>{}),i)}catch(s){i(s)}void 0!==r&&r.catch(i)}))})(Ne),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Fe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n})(Ne),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new MessageChannel,r=new e(1,128,44100),s=URL.createObjectURL(n);let o=!1;try{await r.audioWorklet.addModule(s);const e=new t(r,"a",{numberOfOutputs:0}),n=r.createOscillator();await new Promise((t=>{e.port.onmessage=()=>t(),e.port.postMessage(i.port2,[i.port2])})),e.port.onmessage=()=>o=!0,n.connect(e),n.start(0),await r.startRendering(),o=await new Promise((t=>{i.port1.onmessage=e=>{let{data:n}=e;return t(1===n)},i.port1.postMessage(0)}))}catch{}finally{i.port1.close(),URL.revokeObjectURL(s)}return o})(Ue,Ne),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Ne),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Ne),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Ne),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Ne),pe,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(Ee),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(n){return!0}finally{e.close()}})(Fe),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const n=e.createConstantSource(),i=e.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(e.destination),e.startRendering().then((t=>1!==t.getChannelData(0)[0]))})(Ne),fe);function zi(t,e){if(!t)throw new Error(e)}function Ui(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(e<=t&&t<=n))throw new RangeError("Value must be within [".concat(e,", ").concat(n,"], got: ").concat(t))}function ji(t){t.isOffline||"running"===t.state||qi('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Vi=console;function Wi(t){Vi=t}function Gi(){Vi.log(...arguments)}function qi(){Vi.warn(...arguments)}function Hi(t){return"undefined"===typeof t}function Xi(t){return!Hi(t)}function Yi(t){return"function"===typeof t}function Ki(t){return"number"===typeof t}function Qi(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Zi(t){return"boolean"===typeof t}function Ji(t){return Array.isArray(t)}function $i(t){return"string"===typeof t}function tr(t){return $i(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const er="object"===typeof self?self:null,nr=er&&(er.hasOwnProperty("AudioContext")||er.hasOwnProperty("webkitAudioContext"));function ir(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function rr(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(e){s(e)}}function a(t){try{c(i.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class sr{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob(["\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t")],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function or(t){return Fi(t)}function ar(t){return Pi(t)}function cr(t){return Li(t)}function lr(t){return Di(t)}function ur(t){return t instanceof AudioBuffer}function hr(t,e){return"value"===t||or(e)||ar(e)||ur(e)}function dr(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(!n.length)return t;const r=n.shift();if(Qi(t)&&Qi(r))for(const s in r)hr(s,r[s])?t[s]=r[s]:Qi(r[s])?(t[s]||Object.assign(t,{[s]:{}}),dr(t[s],r[s])):Object.assign(t,{[s]:r[s]});return dr(t,...n)}function pr(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;const r={},s=Array.from(e);if(Qi(s[0])&&i&&!Reflect.has(s[0],i)){Object.keys(s[0]).some((e=>Reflect.has(t,e)))||(dr(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())}if(1===s.length&&Qi(s[0]))dr(r,s[0]);else for(let o=0;o<n.length;o++)Xi(s[o])&&(r[n[o]]=s[o]);return dr(t,r)}function fr(t,e){return Hi(t)?e:t}function mr(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class gr{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(){if(this.debug||er&&this.toString()===er.TONE_DEBUG_CLASS){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Gi(this,...e)}}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}gr.version=s;const vr=1e-6;function yr(t,e){return t>e+vr}function xr(t,e){return yr(t,e)||wr(t,e)}function br(t,e){return t+vr<e}function wr(t,e){return Math.abs(t-e)<vr}function Sr(t,e,n){return Math.max(Math.min(t,n),e)}class _r extends gr{constructor(){super(),this.name="Timeline",this._timeline=[];const t=pr(_r.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(zi(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];zi(xr(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(wr(this._timeline[e].time,t)){for(let n=e;n>=0&&wr(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&xr(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(wr(s[e],t)){for(let n=i;n<this._timeline.length;n++){if(!wr(this._timeline[n][e],t))break;i=n}return i}if(br(s[e],t)&&yr(o[e],t))return i;yr(s[e],t)?r=i:n=i+1}return-1}_iterate(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&wr(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&wr(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Tr=[];function Er(t){Tr.push(t)}const Cr=[];function kr(t){Cr.push(t)}class Ar extends gr{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Hi(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){var n=this;const i=function(){e(...arguments),n.off(t,i)};return this.on(t,i),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Hi(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Hi(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t){if(this._events&&this._events.hasOwnProperty(t)){const r=this._events[t].slice(0);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(let t=0,e=r.length;t<e;t++)r[t].apply(this,n)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(Ar.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Ir extends Ar{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Or extends Ir{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new _r,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=pr(Or.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new vi(t)}({latencyHint:t.latencyHint}),this._ticker=new sr(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Tr.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){zi(lr(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){zi(lr(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){zi(lr(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){zi(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){zi(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){zi(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){zi(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return zi(Xi(Oi),"This node only works in a secure context (https or localhost)"),new Oi(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return rr(this,void 0,void 0,(function*(){zi(Xi(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return rr(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,$i(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return lr(this._context)?this._context.resume():Promise.resolve()}close(){return rr(this,void 0,void 0,(function*(){var t;lr(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Cr.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}function Rr(t,e){Ji(e)?e.forEach((e=>Rr(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Nr(t,e){Ji(e)?e.forEach((e=>Nr(t,e))):Object.defineProperty(t,e,{writable:!0})}const Mr=()=>{};class Dr extends gr{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Mr;const t=pr(Dr.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&ur(t.url)||t.url instanceof Dr?this.set(t.url):$i(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Mr,onload:Mr,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Br().sampleRate}set(t){return t instanceof Dr?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return rr(this,void 0,void 0,(function*(){const e=Dr.load(t).then((t=>{this.set(t),this.onload(this)}));Dr.downloads.push(e);try{yield e}finally{const t=Dr.downloads.indexOf(e);Dr.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Ji(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=Br(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let a=0;a<n;a++)s.copyToChannel(o[a],a);return this._buffer=s,this}toMono(t){if(Ki(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(Ki(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration;const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);zi(n<i,"The start time must be less than the end time");const r=i-n,s=Br().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)s.copyToChannel(this.getChannelData(o).subarray(n,i),o);return new Dr(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Dr).fromArray(t)}static fromUrl(t){return rr(this,void 0,void 0,(function*(){const e=new Dr;return yield e.load(t)}))}static load(t){return rr(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(Dr.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===Dr.baseUrl||Dr.baseUrl.endsWith("/")?Dr.baseUrl:Dr.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error("could not load url: ".concat(t));const r=yield i.arrayBuffer();return yield Br().decodeAudioData(r)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return rr(this,void 0,void 0,(function*(){for(yield Promise.resolve();Dr.downloads.length;)yield Dr.downloads[0]}))}}Dr.baseUrl="",Dr.downloads=[];class Pr extends Or{constructor(){var t,e,n;super({clockSource:"offline",context:cr(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Mi(t,e,n)),lookAhead:0,updateInterval:cr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=cr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return rr(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n===0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return rr(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Dr(e)}))}close(){return Promise.resolve()}}const Fr=new class extends Ir{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return rr(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let Lr=Fr;function Br(){return Lr===Fr&&nr&&zr(new Or),Lr}function zr(t){Lr=lr(t)?new Or(t):cr(t)?new Pr(t):t}function Ur(){return Lr.resume()}if(er&&!er.TONE_SILENCE_LOGGING){let t="v";"dev"===s&&(t="");const e=" * Tone.js ".concat(t).concat(s," * ");console.log("%c".concat(e),"background: #000; color: #fff")}function jr(t){return Math.pow(10,t/20)}function Vr(t){return Math.log(t)/Math.LN10*20}function Wr(t){return Math.pow(2,t/12)}let Gr=440;function qr(t){return Math.round(Hr(t))}function Hr(t){return 69+12*Math.log2(t/Gr)}function Xr(t){return Gr*Math.pow(2,(t-69)/12)}class Yr extends gr{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Yr&&this.fromType(this._val),Hi(this._val))return this._noArg();if($i(this._val)&&Hi(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Qi(this._val)){let t=0;for(const e in this._val)if(Xi(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Xi(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return $i(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Kr extends Yr{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Kr(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let r=1;r<9;r++){const t=Math.pow(2,r);e.push(t+"n."),e.push(t+"n"),e.push(t+"t")}e.push("0");let n=e[0],i=new Kr(this.context,e[0]).toSeconds();return e.forEach((e=>{const r=new Kr(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return qr(this.toFrequency())}_now(){return this.context.now()}}function Qr(t,e){return new Kr(Br(),t,e)}class Zr extends Kr{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Gr}static set A4(t){!function(t){Gr=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Zr.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Jr[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Zr.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Zr(this.context,this.valueOf()*Wr(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return qr(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Zr.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return $r[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return Xr(t)}static ftom(t){return qr(t)}}const Jr={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},$r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function ts(t,e){return new Zr(Br(),t,e)}class es extends Kr{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function ns(t,e){return new es(Br(),t,e)}class is extends gr{constructor(){super();const t=pr(is.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Br()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Kr(this.context,t).toSeconds()}toFrequency(t){return new Zr(this.context,t).toFrequency()}toTicks(t){return new es(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Hi(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Xi(n)&&Xi(n.value)&&Xi(n.setValueAtTime)?t[e]=n.value:n instanceof is?t[e]=n._getPartialProperties(t[e]):Ji(n)||Ki(n)||$i(n)||Zi(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Xi(this[e])&&(this[e]&&Xi(this[e].value)&&Xi(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof is?this[e].set(t[e]):this[e]=t[e])})),this}}class rs extends _r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return Ui(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let i=n;i<this._timeline.length;i++){const e=this._timeline[i];if(e.state===t)return e}}}class ss extends is{constructor(){super(pr(ss.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=pr(ss.getDefaults(),arguments,["param","units","convert"]);for(zi(Xi(t.param)&&(or(t.param)||t.param instanceof ss),"param must be an AudioParam");!or(t.param);)t.param=t.param._param;this._swappable=!!Xi(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new _r(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Xi(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(is.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Xi(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Xi(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Xi(this.maxValue)&&Xi(this.minValue)&&Ui(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?jr(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?Vr(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return zi(isFinite(i)&&isFinite(n),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return zi(isFinite(n)&&isFinite(i),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=wr(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return zi(isFinite(n)&&isFinite(i),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);zi(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),zi(isFinite(i)&&isFinite(r),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let o=1;o<t.length;o++){const n=this._fromType(t[o])*i;this.linearRampToValueAtTime(this._toType(n),e+o*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return zi(isFinite(e),"Invalid argument to cancelScheduledValues: ".concat(JSON.stringify(t))),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));zi(isFinite(e),"Invalid argument to cancelAndHoldAtTime: ".concat(JSON.stringify(t))),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&wr(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){zi(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class os extends is{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Xi(this.input)?or(this.input)||this.input instanceof ss?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Xi(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Xi(t)&&(t instanceof os||ar(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();zi(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t){return cs(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return qi("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t){return ls(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}chain(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return as(this,...e),this}fan(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Xi(this.input)&&(this.input instanceof os?this.input.dispose():ar(this.input)&&this.input.disconnect()),Xi(this.output)&&(this.output instanceof os?this.output.dispose():ar(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function as(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.shift();e.reduce(((t,e)=>(t instanceof os?t.connect(e):ar(t)&&cs(t,e),e)),i)}function cs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(zi(Xi(t),"Cannot connect from undefined node"),zi(Xi(e),"Cannot connect to undefined node"),(e instanceof os||ar(e))&&zi(e.numberOfInputs>0,"Cannot connect to node with no inputs"),zi(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof os||e instanceof ss;)Xi(e.input)&&(e=e.input);for(;t instanceof os;)Xi(t.output)&&(t=t.output);or(e)?t.connect(e,n):t.connect(e,n,i)}function ls(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Xi(e))for(;e instanceof os;)e=e.input;for(;!ar(t);)Xi(t.output)&&(t=t.output);or(e)?t.disconnect(e,n):ar(e)?t.disconnect(e,n,i):t.disconnect()}class us extends os{constructor(){super(pr(us.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=pr(us.getDefaults(),arguments,["gain","units"]);this.gain=new ss({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Rr(this,"gain")}static getDefaults(){return Object.assign(os.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class hs extends os{constructor(t){super(t),this.onended=Mr,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new us({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(os.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Mr})}_startGain(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;zi(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){zi(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Mr&&(this.onended(this),this.onended=Mr,!this.context.isOffline)){const t=()=>this.dispose();"undefined"!==typeof window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),zi(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ds extends hs{constructor(){super(pr(ds.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=pr(ds.getDefaults(),arguments,["offset"]);cs(this._source,this._gainNode),this.offset=new ss({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(hs.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class ps extends os{constructor(){super(pr(ps.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=pr(ps.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ds({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(os.getDefaults(),{convert:!0,units:"number",value:0})}connect(t){return fs(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function fs(t,e,n,i){(e instanceof ss||or(e)||e instanceof ps&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof ps&&(e.overridden=!0)),cs(t,e,n,i)}class ms extends ss{constructor(){super(pr(ms.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new _r(1/0),this._multiplier=1;const t=pr(ms.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ss.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let o=0;o<=s;o++){const t=n*o+e,s=this._exponentialApproach(r.time,r.value,i,n,t);this.linearRampToValueAtTime(this._toType(s),t)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let o=0;o<=r;o++){const t=s*o+i.time,r=this._exponentialInterpolate(i.time,i.value,e,n,t);this.linearRampToValueAtTime(this._toType(r),t)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Hi(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r;return(o>0?o:(-i-s)/r)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class gs extends ps{constructor(){super(pr(gs.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=pr(gs.getDefaults(),arguments,["value"]);this.input=this._param=new ms({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(ps.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class vs extends is{constructor(){super(pr(vs.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new rs,this._tickOffset=new _r;const t=pr(vs.getDefaults(),arguments,["frequency"]);this.frequency=new gs({context:this.context,units:t.units,value:t.frequency}),Rr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},is.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Xi(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t})),this._state.remove(i),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t})),this._state.remove(n),r}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let r=null;if(i&&"started"===i.state){const o=Math.max(i.time,t),a=this.frequency.getTicksAtTime(o),c=a-this.frequency.getTicksAtTime(i.time);let l=Math.ceil(c)-c;l=wr(l,1)?0:l;let u=this.frequency.getTimeOfTick(a+l);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(s){r=s;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class ys extends is{constructor(){super(pr(ys.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Mr,this._lastUpdate=0,this._state=new rs("stopped"),this._boundLoop=this._loop.bind(this);const t=pr(ys.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new vs({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Rr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(is.getDefaults(),{callback:Mr,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ji(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ar.mixin(ys);class xs extends os{constructor(){super(pr(xs.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=pr(xs.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new ss({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),Rr(this,"delayTime")}static getDefaults(){return Object.assign(os.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function bs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Br().sampleRate;return rr(this,void 0,void 0,(function*(){const r=Br(),s=new Pr(n,e,i);zr(s),yield t(s);const o=s.render();zr(r);const a=yield o;return new Dr(a)}))}class ws extends gr{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=pr(ws.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:Mr,onload:Mr,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return zi(this.has(t),"ToneAudioBuffers has no buffer named: ".concat(t)),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((t=>{let[e,n]=t;return n.loaded}))}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mr,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mr;return $i(e)?this._buffers.set(t.toString(),new Dr(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new Dr(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Ss extends Zr{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return qr(super._frequencyToUnits(t))}_ticksToUnits(t){return qr(super._ticksToUnits(t))}_beatsToUnits(t){return qr(super._beatsToUnits(t))}_secondsToUnits(t){return qr(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return Xr(this.toMidi())}transpose(t){return new Ss(this.context,this.toMidi()+t)}}function _s(t,e){return new Ss(Br(),t,e)}class Ts extends es{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function Es(t,e){return new Ts(Br(),t,e)}class Cs extends is{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new _r,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Er((t=>{t.draw=new Cs({context:t})})),kr((t=>{t.draw.dispose()}));class ks extends gr{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){zi(Xi(t.time),"Events must have a time property"),zi(Xi(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new As(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class As{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Is extends os{constructor(){super(pr(Is.getDefaults(),arguments,["volume"])),this.name="Volume";const t=pr(Is.getDefaults(),arguments,["volume"]);this.input=this.output=new us({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Rr(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(os.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Os extends os{constructor(){super(pr(Os.getDefaults(),arguments)),this.name="Destination",this.input=new Is({context:this.context}),this.output=new us({context:this.context}),this.volume=this.input.volume;const t=pr(Os.getDefaults(),arguments);as(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(os.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(){this.input.disconnect();for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.unshift(this.input),e.push(this.output),as(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Er((t=>{t.destination=new Os({context:t})})),kr((t=>{t.destination.dispose()}));class Rs extends gr{constructor(t){super(),this.name="TimelineValue",this._timeline=new _r({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Ns{constructor(t,e){this.id=Ns._eventId++;const n=Object.assign(Ns.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Mr,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Ns._eventId=0;class Ms extends Ns{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Ms.getDefaults(),e);this.duration=new Ts(t.context,n.duration).valueOf(),this._interval=new Ts(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Ns.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ts(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Ts(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ts(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Ds extends is{constructor(){super(pr(Ds.getDefaults(),arguments)),this.name="Transport",this._loop=new Rs(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new _r,this._repeatedEvents=new ks,this._syncedSignals=[],this._swingAmount=0;const t=pr(Ds.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new ys({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Rr(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(is.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!==0&&e%(2*this._swingTicks)!==0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Ts(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new Ns(this,{callback:t,time:new es(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const r=new Ms(this,{callback:t,duration:new Kr(this.context,i).toTicks(),interval:new Kr(this.context,e).toTicks(),time:new es(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new Ns(this,{callback:t,once:!0,time:new es(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new Ts(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Xi(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Ji(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Kr(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Kr(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Ts(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Ts(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new us(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Nr(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ar.mixin(Ds),Er((t=>{t.transport=new Ds({context:t})})),kr((t=>{t.transport.dispose()}));class Ps extends os{constructor(t){super(t),this.input=void 0,this._state=new rs("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Mr,this._syncedStop=Mr,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Is({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Rr(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(os.getDefaults(),{mute:!1,onstop:Mr,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Hi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(fr(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else ji(this.context),this._start(i,e,n);else zi(yr(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=Hi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Xi(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Mr,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Fs extends hs{constructor(){super(pr(Fs.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=pr(Fs.getDefaults(),arguments,["url","onload"]);cs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ss({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Dr(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(hs.getDefaults(),{url:new Dr,loop:!1,loopEnd:0,loopStart:0,onload:Mr,onerror:Mr,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;zi(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?fr(e,this.loopStart):fr(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;xr(s,t)&&(s=(s-e)%n+e),wr(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,br(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),Xi(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Ls extends Ps{constructor(){super(pr(Ls.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=pr(Ls.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ps.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(zi(t in Us,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=Us[this._type];this._source=new Fs({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Bs=220500,zs={brown:null,pink:null,white:null},Us={get brown(){if(!zs.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Bs);t[e]=n;let i=0;for(let t=0;t<Bs;t++){const e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}zs.brown=(new Dr).fromArray(t)}return zs.brown},get pink(){if(!zs.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Bs);let i,r,s,o,a,c,l;t[e]=n,i=r=s=o=a=c=l=0;for(let t=0;t<Bs;t++){const e=2*Math.random()-1;i=.99886*i+.0555179*e,r=.99332*r+.0750759*e,s=.969*s+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,n[t]=i+r+s+o+a+c+l+.5362*e,n[t]*=.11,l=.115926*e}}zs.pink=(new Dr).fromArray(t)}return zs.pink},get white(){if(!zs.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Bs);t[e]=n;for(let t=0;t<Bs;t++)n[t]=2*Math.random()-1}zs.white=(new Dr).fromArray(t)}return zs.white}};class js extends os{constructor(){super(pr(js.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=pr(js.getDefaults(),arguments,["volume"]);this._volume=this.output=new Is({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Rr(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(os.getDefaults(),{mute:!1,volume:0})}open(t){return rr(this,void 0,void 0,(function*(){zi(js.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield js.enumerateDevices();Ki(t)?this._device=e[t]:(this._device=e.find((e=>e.label===t||e.deviceId===t)),!this._device&&e.length>0&&(this._device=e[0]),zi(Xi(this._device),"No matching device ".concat(t)));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;const t=this.context.createMediaStreamSource(i);cs(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((t=>{t.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return rr(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter((t=>"audioinput"===t.kind))}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return Xi(navigator.mediaDevices)&&Xi(navigator.mediaDevices.getUserMedia)}}function Vs(t,e){return rr(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new Pr(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class Ws extends hs{constructor(){super(pr(Ws.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=pr(Ws.getDefaults(),arguments,["frequency","type"]);cs(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new ss({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new ss({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Rr(this,["frequency","detune"])}static getDefaults(){return Object.assign(hs.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Gs extends Ps{constructor(){super(pr(Gs.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=pr(Gs.getDefaults(),arguments,["frequency","type"]);this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency}),Rr(this,"frequency"),this.detune=new ps({context:this.context,units:"cents",value:t.detune}),Rr(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ps.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new Ws({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return Gs._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=Gs._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Xi(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Gs._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),Gs._periodicWaveCache.length>100&&Gs._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Ui(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return Sr(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Gs._periodicWaveCache=[];class qs extends os{constructor(){super(Object.assign(pr(qs.getDefaults(),arguments,["context"])))}connect(t){return fs(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}}class Hs extends qs{constructor(){super(Object.assign(pr(Hs.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=pr(Hs.getDefaults(),arguments,["mapping","length"]);Ji(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Yi(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(ps.getDefaults(),{length:1024})}setMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){zi(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Xs extends qs{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Hs({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ys extends ps{constructor(){super(Object.assign(pr(Ys.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=pr(Ys.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new us({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ps.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Ks extends Ps{constructor(){super(pr(Ks.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Xs({context:this.context}),this._modulationNode=new us({context:this.context});const t=pr(Ks.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Gs({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Gs({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Ys({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Rr(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Gs.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Qs extends Ps{constructor(){super(pr(Qs.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new us({context:this.context,gain:0});const t=pr(Qs.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Gs({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Gs({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Ys({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Ys({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Rr(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Gs.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Zs extends Ps{constructor(){super(pr(Zs.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new us({context:this.context,gain:0}),this._thresh=new Hs({context:this.context,mapping:t=>t<=0?-1:1});const t=pr(Zs.getDefaults(),arguments,["frequency","width"]);this.width=new ps({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Gs({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Rr(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ps.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Js extends Ps{constructor(){super(pr(Js.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=pr(Js.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ps({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Rr(this,["frequency","detune"])}static getDefaults(){return Object.assign(Gs.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(Ui(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new Gs({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Mr});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class $s extends Ps{constructor(){super(pr($s.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Ys({context:this.context,value:2});const t=pr($s.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Zs({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Gs({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Rr(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ps.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const to={am:Ks,fat:Js,fm:Qs,oscillator:Gs,pulse:Zs,pwm:$s};class eo extends Ps{constructor(){super(pr(eo.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=pr(eo.getDefaults(),arguments,["frequency","type"]);this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ps({context:this.context,units:"cents",value:t.detune}),Rr(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Gs.getDefaults(),Qs.getDefaults(),Ks.getDefaults(),Js.getDefaults(),Zs.getDefaults(),$s.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=to[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof to[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&Ki(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&Ki(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&$i(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){return Vs(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class no extends ps{constructor(){super(Object.assign(pr(no.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new us({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,as(this._constantSource,this._sum)}static getDefaults(){return Object.assign(ps.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class io extends qs{constructor(){super(Object.assign(pr(io.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=pr(io.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Ys({context:this.context,value:t.max-t.min}),this._add=this.output=new no({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(qs.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class ro extends qs{constructor(){super(Object.assign(pr(ro.getDefaults(),arguments))),this.name="Zero",this._gain=new us({context:this.context}),this.output=this._gain,this.input=void 0,cs(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),ls(this.context.getConstant(0),this._gain),this}}class so extends os{constructor(){super(pr(so.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=ss.prototype._fromType,this._toType=ss.prototype._toType,this._is=ss.prototype._is,this._clampValue=ss.prototype._clampValue;const t=pr(so.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Gs(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new us({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new ps({context:this.context,units:"audioRange",value:0}),this._zeros=new ro({context:this.context}),this._a2g=new Xs({context:this.context}),this._scaler=this.output=new io({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Rr(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(Gs.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof ss||t instanceof ps)&&(this.convert=t.convert,this.units=t.units),fs(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function oo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ui(i,t,e),n.set(this,i)}})}}function ao(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ui(this.toSeconds(i),t,e),n.set(this,i)}})}}class co extends Ps{constructor(){super(pr(co.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=pr(co.getDefaults(),arguments,["url","onload"]);this._buffer=new Dr({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ps.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Mr,onerror:Mr,playbackRate:1,reverse:!1})}load(t){return rr(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mr)(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?fr(e,this._loopStart):fr(e,0);const i=this.toSeconds(e),r=n;n=fr(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new Fs({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Hi(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Ui(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Ui(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}ir([ao(0)],co.prototype,"fadeIn",void 0),ir([ao(0)],co.prototype,"fadeOut",void 0);class lo extends os{constructor(){super(pr(lo.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=pr(lo.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Is({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Rr(this,"volume"),this._buffers=new ws({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ps.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Mr,onerror:Mr,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach((e=>{e.fadeIn=t}))}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach((e=>{e.fadeOut=t}))}get state(){return Array.from(this._players).some((t=>{let[e,n]=t;return"started"===n.state}))?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(zi(this.has(t),"No Player with the name ".concat(t," exists on this object")),!this._players.has(t)){const e=new co({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return zi(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach((e=>e.stop(t))),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach((t=>t.dispose())),this._buffers.dispose(),this}}class uo extends Ps{constructor(){super(pr(uo.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=pr(uo.getDefaults(),arguments,["url","onload"]);this.buffer=new Dr({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new ys({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Ps.getDefaults(),{onload:Mr,onerror:Mr,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=fr(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const i=n<this._overlap?0:this._overlap,r=new Fs({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:Wr(this.detune/100)}).connect(this.output);r.start(t,this._grainSize*e),r.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(r),r.onended=()=>{const t=this._activeSources.indexOf(r);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){Ui(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&Ui(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&Ui(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);Ui(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class ho extends qs{constructor(){super(...arguments),this.name="Abs",this._abs=new Hs({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class po extends qs{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Hs({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class fo extends qs{constructor(){super(...arguments),this.name="Negate",this._multiply=new Ys({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class mo extends ps{constructor(){super(Object.assign(pr(mo.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new us({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new fo({context:this.context}),this.subtrahend=this._param,as(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(ps.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class go extends qs{constructor(){super(Object.assign(pr(go.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new Hs({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new Ys({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class vo extends ps{constructor(){super(Object.assign(pr(vo.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=pr(vo.getDefaults(),arguments,["value"]);this._subtract=this.input=new mo({context:this.context,value:t.value}),this._gtz=this.output=new go({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,Rr(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(ps.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class yo extends qs{constructor(){super(Object.assign(pr(yo.getDefaults(),arguments,["value"]))),this.name="Pow";const t=pr(yo.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new Hs({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(qs.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class xo extends io{constructor(){super(Object.assign(pr(xo.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=pr(xo.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new yo({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(io.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class bo extends ps{constructor(){super(pr(ps.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=pr(ps.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new ds({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new es(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const n=new es(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){const n=new es(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){const n=new es(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){const i=new es(this.context,e).toSeconds();return super.setTargetAtTime(t,i,n),this}cancelScheduledValues(t){const e=new es(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,i){const r=new es(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,r,n,i),this}cancelAndHoldAtTime(t){const e=new es(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new es(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){const i=new es(this.context,n).toSeconds();return super.exponentialRampTo(t,e,i),this}linearRampTo(t,e,n){const i=new es(this.context,n).toSeconds();return super.linearRampTo(t,e,i),this}targetRampTo(t,e,n){const i=new es(this.context,n).toSeconds();return super.targetRampTo(t,e,i),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class wo extends os{constructor(){super(pr(wo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new ps({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=pr(wo.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(os.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if($i(t))return t;{let n;for(n in So)if(So[n][e]===t)return n;return t}}_setCurve(t,e,n){if($i(n)&&Reflect.has(So,n)){const i=So[n];Qi(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Ji(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){zi(["linear","exponential"].some((e=>e===t)),"Invalid envelope curve: ".concat(t)),this._decayCurve=t}triggerAttack(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(zi(Ji(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t){return fs(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}asArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return rr(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Pr(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}ir([ao(0)],wo.prototype,"attack",void 0),ir([ao(0)],wo.prototype,"decay",void 0),ir([oo(0,1)],wo.prototype,"sustain",void 0),ir([ao(0)],wo.prototype,"release",void 0);const So=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=t/10+.83*n}r[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(a),Out:a},cosine:{In:i,Out:(l=i,l.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:c(r)},sine:{In:o,Out:c(o)},step:{In:s,Out:c(s)}};var l})();class _o extends os{constructor(){super(pr(_o.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=pr(_o.getDefaults(),arguments);this._volume=this.output=new Is({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Rr(this,"volume")}static getDefaults(){return Object.assign(os.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){var n=this;const i=this["_original_"+t]=this[t];this[t]=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];const o=r[e],a=n.context.transport.schedule((t=>{r[e]=t,i.apply(n,r)}),o);n._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class To extends _o{constructor(){super(pr(To.getDefaults(),arguments));const t=pr(To.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(_o.getDefaults(),{detune:0,onsilence:Mr,portamento:0})}triggerAttack(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Zr?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}ir([ao(0)],To.prototype,"portamento",void 0);class Eo extends wo{constructor(){super(pr(Eo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new us({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Co extends To{constructor(){super(pr(Co.getDefaults(),arguments)),this.name="Synth";const t=pr(Co.getDefaults(),arguments);this.oscillator=new eo(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Eo(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Rr(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(To.getDefaults(),{envelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(mr(eo.getDefaults(),[...Object.keys(Ps.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class ko extends To{constructor(){super(pr(ko.getDefaults(),arguments)),this.name="ModulationSynth";const t=pr(ko.getDefaults(),arguments);this._carrier=new Co({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Co({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new ps({context:this.context,units:"frequency"}),this.detune=new ps({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new Ys({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new us({context:this.context,gain:0}),Rr(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(To.getDefaults(),{harmonicity:3,oscillator:Object.assign(mr(eo.getDefaults(),[...Object.keys(Ps.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(mr(eo.getDefaults(),[...Object.keys(Ps.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Ao extends ko{constructor(){super(pr(Ao.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new Xs({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Io extends os{constructor(){super(pr(Io.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=pr(Io.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new ss({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new ss({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new ss({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new ss({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(os.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){zi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._filter.type=t}getFrequencyResponse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;const e=new Float32Array(t);for(let s=0;s<t;s++){const n=19980*Math.pow(s/t,2)+20;e[s]=n}const n=new Float32Array(t),i=new Float32Array(t),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Oo extends os{constructor(){super(pr(Oo.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new us({context:this.context}),this.output=new us({context:this.context}),this._filters=[];const t=pr(Oo.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new ps({context:this.context,units:"positive",value:t.Q}),this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ps({context:this.context,units:"cents",value:t.detune}),this.gain=new ps({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,Rr(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(os.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){zi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=Ki(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);zi(-1!==i,"rolloff can only be ".concat(n.join(", "))),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(i);for(let r=0;r<i;r++){const t=new Io({context:this.context});t.type=this._type,this.frequency.connect(t.frequency),this.detune.connect(t.detune),this.Q.connect(t.Q),this.gain.connect(t.gain),this._filters[r]=t}this._internalChannels=this._filters,as(this.input,...this._internalChannels,this.output)}getFrequencyResponse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;const e=new Io({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>n[e]*=t))})),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),Nr(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Ro extends wo{constructor(){super(pr(Ro.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=pr(Ro.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new yo({context:this.context,value:t.exponent}),this._scale=this.output=new io({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(wo.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);Ui(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class No extends To{constructor(){super(pr(No.getDefaults(),arguments)),this.name="MonoSynth";const t=pr(No.getDefaults(),arguments);this.oscillator=new eo(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Oo(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Ro(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Eo(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Rr(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(To.getDefaults(),{envelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(mr(Oo.getDefaults(),Object.keys(os.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(mr(Ro.getDefaults(),Object.keys(os.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(mr(eo.getDefaults(),Object.keys(Ps.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Mo extends To{constructor(){super(pr(Mo.getDefaults(),arguments)),this.name="DuoSynth";const t=pr(Mo.getDefaults(),arguments);this.voice0=new No(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new No(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new Ys({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new so({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new us({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new ps({context:this.context,units:"frequency",value:440}),this.detune=new ps({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),Rr(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return dr(To.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:dr(mr(No.getDefaults(),Object.keys(To.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:dr(mr(No.getDefaults(),Object.keys(To.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class Do extends ko{constructor(){super(pr(Do.getDefaults(),arguments)),this.name="FMSynth";const t=pr(Do.getDefaults(),arguments);this.modulationIndex=new Ys({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(ko.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Po=[1,1.483,1.932,2.546,2.63,3.897];class Fo extends To{constructor(){super(pr(Fo.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=pr(Fo.getDefaults(),arguments);this.detune=new ps({context:this.context,units:"cents",value:t.detune}),this.frequency=new ps({context:this.context,units:"frequency"}),this._amplitude=new us({context:this.context,gain:0}).connect(this.output),this._highpass=new Oo({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Po.length;e++){const n=new Qs({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):Mr,type:"square"});n.connect(this._highpass),this._oscillators[e]=n;const i=new Ys({context:this.context,value:Po[e]});this._freqMultipliers[e]=i,this.frequency.chain(i,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new io({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new wo({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return dr(To.getDefaults(),{envelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.envelope.triggerAttack(t,e),this._oscillators.forEach((e=>e.start(t))),0===this.envelope.sustain&&this._oscillators.forEach((e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))})),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach((e=>e.stop(t+this.toSeconds(this.envelope.release)))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach((e=>e.modulationIndex.value=t))}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach((e=>e.harmonicity.value=t))}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach((t=>t.dispose())),this._freqMultipliers.forEach((t=>t.dispose())),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class Lo extends Co{constructor(){super(pr(Lo.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=pr(Lo.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Rr(this,["oscillator","envelope"])}static getDefaults(){return dr(To.getDefaults(),Co.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Zr?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ir([oo(0)],Lo.prototype,"octaves",void 0),ir([ao(0)],Lo.prototype,"pitchDecay",void 0);class Bo extends _o{constructor(){super(pr(Bo.getDefaults(),arguments)),this.name="NoiseSynth";const t=pr(Bo.getDefaults(),arguments);this.noise=new Ls(Object.assign({context:this.context},t.noise)),this.envelope=new Eo(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(_o.getDefaults(),{envelope:Object.assign(mr(wo.getDefaults(),Object.keys(os.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(mr(Ls.getDefaults(),Object.keys(Ps.getDefaults())),{type:"white"})})}triggerAttack(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const zo=new Set;function Uo(t){zo.add(t)}function jo(t,e){const n='registerProcessor("'.concat(t,'", ').concat(e,")");zo.add(n)}class Vo extends os{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Mr;const e=URL.createObjectURL(new Blob([Array.from(zo).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Uo('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Uo("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Uo("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const Wo="feedback-comb-filter";jo(Wo,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Go extends Vo{constructor(){super(pr(Go.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=pr(Go.getDefaults(),arguments,["delayTime","resonance"]);this.input=new us({context:this.context}),this.output=new us({context:this.context}),this.delayTime=new ss({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new ss({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),Rr(this,["resonance","delayTime"])}_audioWorkletName(){return Wo}static getDefaults(){return Object.assign(os.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){as(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class qo extends os{constructor(){super(pr(qo.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=pr(qo.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new us({context:this.context}),this.output=new us({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(os.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;const e=new Float32Array(t);for(let r=0;r<t;r++){const n=19980*Math.pow(r/t,2)+20;e[r]=n}const n=new Float32Array(t),i=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Ho extends os{constructor(){super(pr(Ho.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=pr(Ho.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Go({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new qo({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(os.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Xo extends _o{constructor(){super(pr(Xo.getDefaults(),arguments)),this.name="PluckSynth";const t=pr(Xo.getDefaults(),arguments);this._noise=new Ls({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new Ho({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return dr(_o.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const n=this.toFrequency(t);e=this.toSeconds(e);const i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class Yo extends _o{constructor(){super(pr(Yo.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=pr(Yo.getDefaults(),arguments,["voice","options"]);zi(!Ki(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(_o.getDefaults(),{maxPolyphony:32,options:{},voice:Co})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}qi("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const i=new Ss(this.context,t).toMidi(),r=this._getNextAvailableVoice();r&&(r.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:r,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new Ss(this.context,t).toMidi(),i=this._activeVoices.find((t=>{let{midi:e,released:i}=t;return e===n&&!i}));i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,i){zi(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,i)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n);if(this.triggerAttack(t,r,i),Ji(e)){zi(Ji(t),"If the duration is an array, the notes must also be an array");for(let n=0;n<t.length;n++){const i=e[Math.min(n,e.length-1)],s=this.toSeconds(i);zi(s>0,"The duration must be greater than 0"),this.triggerRelease(t[n],r+s)}}else{const n=this.toSeconds(e);zi(n>0,"The duration must be greater than 0"),this.triggerRelease(t,r+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=mr(t,["onsilence","context"]);return this.options=dr(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((t=>{let{voice:n}=t;n.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Ko extends _o{constructor(){super(pr(Ko.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=pr(Ko.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(zi(tr(n)||Ki(i)&&isFinite(i),"url key is neither a note or midi pitch: ".concat(n)),tr(n)){const i=new Zr(this.context,n).toMidi();e[i]=t.urls[n]}else Ki(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new ws({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(_o.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Mr,onerror:Mr,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: ".concat(t))}triggerAttack(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Hr(new Zr(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,c=this._buffers.get(a),l=Wr(o+s),u=new Fs({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:l}).connect(this.output);u.start(e,0,c.duration/l,n),Ji(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Zr(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=this.toSeconds(n);return this.triggerAttack(t,r,i),Ji(e)?(zi(Ji(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))}))):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(zi(tr(t)||isFinite(t),"note must be a pitch or midi: ".concat(t)),tr(t)){const i=new Zr(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}ir([ao(0)],Ko.prototype,"attack",void 0),ir([ao(0)],Ko.prototype,"release",void 0);class Qo extends is{constructor(){super(pr(Qo.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new rs("stopped"),this._startOffset=0;const t=pr(Qo.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(is.getDefaults(),{callback:Mr,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Ki(this._loop)&&this._loop>1){e=1/0,Ki(this._loop)&&(e=this._loop*this._getLoopDuration());const i=this._state.getAfter(n);null!==i&&(e=Math.min(e,i.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new Ts(this.context,e));const r=new Ts(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),r,new Ts(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Ts(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=fr(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;Zi(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Ts(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new Ts(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Zo extends is{constructor(){super(pr(Zo.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=pr(Zo.getDefaults(),arguments,["callback","interval"]);this._event=new Qo({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(is.getDefaults(),{interval:"4n",callback:Mr,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class Jo extends Qo{constructor(){super(pr(Jo.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new rs("stopped"),this._events=new Set;const t=pr(Jo.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach((t=>{Ji(t)?this.add(t[0],t[1]):this.add(t)}))}static getDefaults(){return Object.assign(Qo.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=fr(e,this._loop?this._loopStart:0),e=this._loop?fr(e,this._loopStart):fr(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach((e=>{this._startNote(e,n,t)}))}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new Ts(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new Ts(this.context,e))):t.startOffset>=n&&t.start(new Ts(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach((t=>{t.startOffset+=this._startOffset}))}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((e=>{e.stop(t)})),this}at(t,e){const n=new es(this.context,t).toTicks(),i=new Ts(this.context,1).toSeconds(),r=this._events.values();let s=r.next();for(;!s.done;){const t=s.value;if(Math.abs(n-t.startOffset)<i)return Xi(e)&&(t.value=e),t;s=r.next()}return Xi(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let i;return e instanceof Qo?(i=e,i.callback=this._tick.bind(this)):i=new Qo({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach((e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new Ts(this.context,e.time))}))}remove(t,e){return Qi(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((n=>{n.startOffset===t&&(Hi(e)||Xi(e)&&n.value===e)&&(this._events.delete(n),n.dispose())})),this}clear(){return this._forEach((t=>t.dispose())),this._events.clear(),this}cancel(t){return this._forEach((e=>e.cancel(t))),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach((e=>{e instanceof Jo?e._forEach(t):t(e)})),this}_setAll(t,e){this._forEach((n=>{n[t]=e}))}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach((e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)}))}get loopEnd(){return new Ts(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach((e=>{e.loopEnd=t,this._testLoopBoundries(e)}))}get loopStart(){return new Ts(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach((t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)}))}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*$o(t){let e=0;for(;e<t.length;)e=na(e,t),yield t[e],e++}function*ta(t){let e=t.length-1;for(;e>=0;)e=na(e,t),yield t[e],e--}function*ea(t,e){for(;;)yield*e(t)}function na(t,e){return Sr(t,0,e.length-1)}function*ia(t,e){let n=e?0:t.length-1;for(;;)n=na(n,t),yield t[n],e?(n++,n>=t.length-1&&(e=!1)):(n--,n<=0&&(e=!0))}function*ra(t){let e=0,n=0;for(;e<t.length;)e=na(e,t),yield t[e],n++,e+=n%2?2:-1}function*sa(t){let e=t.length-1,n=0;for(;e>=0;)e=na(e,t),yield t[e],n++,e+=n%2?-2:1}function*oa(t){const e=[];for(let n=0;n<t.length;n++)e.push(n);for(;e.length>0;){const n=na(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[n]}}function aa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up";return function*(){switch(zi(t.length>0,"The array must have more than one value in it"),e){case"up":yield*ea(t,$o);case"down":yield*ea(t,ta);case"upDown":yield*ia(t,!0);case"downUp":yield*ia(t,!1);case"alternateUp":yield*ea(t,ra);case"alternateDown":yield*ea(t,sa);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*ea(t,oa);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}()}class ca extends Zo{constructor(){super(pr(ca.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=pr(ca.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=aa(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(Zo.getDefaults(),{pattern:"up",values:[],callback:Mr})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=aa(this._values,this._type)}}class la extends Qo{constructor(){super(pr(la.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Jo({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=pr(la.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(mr(Qo.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new Ts(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,n)=>($i(e)&&isFinite(parseInt(e,10))&&Ji(n)?t[e]=this._createSequence(n):t[e]=n,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach(((t,i)=>{const r=i*e+n;if(Ji(t))this._rescheduleSequence(t,e/t.length,r);else{const e=new Ts(this.context,r,"i").toSeconds();this._part.add(e,t)}}))}_indexTime(t){return new Ts(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class ua extends os{constructor(){super(Object.assign(pr(ua.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new po({context:this.context}),this.a=new us({context:this.context,gain:0}),this.b=new us({context:this.context,gain:0}),this.output=new us({context:this.context}),this._internalChannels=[this.a,this.b];const t=pr(ua.getDefaults(),arguments,["fade"]);this.fade=new ps({context:this.context,units:"normalRange",value:t.fade}),Rr(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",cs(this._split,this.a.gain,0),cs(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(os.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class ha extends os{constructor(t){super(t),this.name="Effect",this._dryWet=new ua({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new us({context:this.context}),this.effectReturn=new us({context:this.context}),this.input=new us({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Rr(this,"wet")}static getDefaults(){return Object.assign(os.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class da extends ha{constructor(t){super(t),this.name="LFOEffect",this._lfo=new so({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,Rr(this,["frequency","depth"])}static getDefaults(){return Object.assign(ha.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pa extends da{constructor(){super(pr(pa.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=pr(pa.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Oo(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(da.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class fa extends os{constructor(){super(Object.assign(pr(fa.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=pr(fa.getDefaults(),arguments,["pan"]);this.pan=new ss({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Rr(this,"pan")}static getDefaults(){return Object.assign(os.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class ma extends da{constructor(){super(pr(ma.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=pr(ma.getDefaults(),arguments,["frequency"]);this._panner=new fa({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(da.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class ga extends os{constructor(){super(pr(ga.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=pr(ga.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new ho({context:this.context}),this._lowpass=this.output=new qo({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(os.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class va extends ha{constructor(){super(pr(va.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=pr(va.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new ga({context:this.context,smoothing:t.follower}),this._sweepRange=new xo({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new us({context:this.context}),this._bandpass=new Oo({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Oo({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,Rr(this,["gain","Q"])}static getDefaults(){return Object.assign(ha.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return Vr(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/jr(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const ya="bit-crusher";jo(ya,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class xa extends ha{constructor(){super(pr(xa.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=pr(xa.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new ba({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(ha.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class ba extends Vo{constructor(){super(pr(ba.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=pr(ba.getDefaults(),arguments);this.input=new us({context:this.context}),this.output=new us({context:this.context}),this.bits=new ss({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(Vo.getDefaults(),{bits:12})}_audioWorkletName(){return ya}onReady(t){as(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class wa extends ha{constructor(){super(pr(wa.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=pr(wa.getDefaults(),arguments,["order"]);this._shaper=new Hs({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(ha.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap((e=>this._getCoefficient(e,t,new Map)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Sa extends os{constructor(){super(pr(Sa.getDefaults(),arguments,["channels"])),this.name="Split";const t=pr(Sa.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(os.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class _a extends os{constructor(){super(pr(_a.getDefaults(),arguments,["channels"])),this.name="Merge";const t=pr(_a.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(os.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Ta extends os{constructor(t){super(t),this.name="StereoEffect",this.input=new us({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ua({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Sa({context:this.context,channels:2}),this._merge=new _a({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Rr(this,["wet"])}connectEffectLeft(){var t;this._split.connect(arguments.length<=0?void 0:arguments[0],0,0),as(...arguments),cs((t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this._merge,0,0)}connectEffectRight(){var t;this._split.connect(arguments.length<=0?void 0:arguments[0],1,0),as(...arguments),cs((t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t],this._merge,0,1)}static getDefaults(){return Object.assign(os.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Ea extends Ta{constructor(t){super(t),this.feedback=new ps({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new us({context:this.context}),this._feedbackR=new us({context:this.context}),this._feedbackSplit=new Sa({context:this.context,channels:2}),this._feedbackMerge=new _a({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Rr(this,["feedback"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Ca extends Ea{constructor(){super(pr(Ca.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=pr(Ca.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new so({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new so({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new xs({context:this.context}),this._delayNodeR=new xs({context:this.context}),this.frequency=this._lfoL.frequency,Rr(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Ea.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class ka extends ha{constructor(){super(pr(ka.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=pr(ka.getDefaults(),arguments,["distortion"]);this._shaper=new Hs({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(ha.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,n=Math.PI/180;this._shaper.setMap((t=>Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t))))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Aa extends ha{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new us({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Rr(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(ha.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class Ia extends Aa{constructor(){super(pr(Ia.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=pr(Ia.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new xs({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Rr(this,"delayTime")}static getDefaults(){return Object.assign(Aa.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class Oa extends os{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new us({context:this.context}),this.output=new us({context:this.context}),this.offset90=new us({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),as(this.input,...this._bank0,this._oneSampleDelay,this.output),as(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map((t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])}))}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((t=>t.disconnect())),this._bank1.forEach((t=>t.disconnect())),this._oneSampleDelay.disconnect(),this}}class Ra extends ha{constructor(){super(pr(Ra.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=pr(Ra.getDefaults(),arguments,["frequency"]);this.frequency=new ps({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new Ws({context:this.context,type:"sine"}),this._cosine=new Gs({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Ys({context:this.context}),this._cosineMultiply=new Ys({context:this.context}),this._negate=new fo({context:this.context}),this._add=new no({context:this.context}),this._phaseShifter=new Oa({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(ha.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Na=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Ma=[225,556,441,341];class Da extends Ta{constructor(){super(pr(Da.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=pr(Da.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new ps({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Ma.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._allpassFiltersR=Ma.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._combFilters=Na.map(((e,n)=>{const i=new Ho({context:this.context,dampening:t.dampening,delayTime:e});return n<Na.length/2?this.connectEffectLeft(i,...this._allpassFiltersL):this.connectEffectRight(i,...this._allpassFiltersR),this.roomSize.connect(i.resonance),i})),Rr(this,["roomSize"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach((e=>e.dampening=t))}dispose(){return super.dispose(),this._allpassFiltersL.forEach((t=>t.disconnect())),this._allpassFiltersR.forEach((t=>t.disconnect())),this._combFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this}}const Pa=[.06748,.06404,.08212,.09004],Fa=[.773,.802,.753,.733],La=[347,113,37];class Ba extends Ta{constructor(){super(pr(Ba.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=pr(Ba.getDefaults(),arguments,["roomSize"]);this.roomSize=new ps({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new io({context:this.context,min:-.733,max:.197}),this._allpassFilters=La.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._feedbackCombFilters=Pa.map(((t,e)=>{const n=new Go({context:this.context,delayTime:t});return this._scaleRoomSize.connect(n.resonance),n.resonance.value=Fa[e],e<Pa.length/2?this.connectEffectLeft(...this._allpassFilters,n):this.connectEffectRight(...this._allpassFilters,n),n})),this.roomSize.connect(this._scaleRoomSize),Rr(this,["roomSize"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach((t=>t.disconnect())),this._feedbackCombFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class za extends Ea{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),Rr(this,["feedback"])}}class Ua extends za{constructor(){super(pr(Ua.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=pr(Ua.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new xs({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new xs({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new xs({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new ps({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),Rr(this,["delayTime"])}static getDefaults(){return Object.assign(za.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class ja extends Aa{constructor(){super(pr(ja.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=pr(ja.getDefaults(),arguments,["pitch"]);this._frequency=new ps({context:this.context}),this._delayA=new xs({maxDelay:1,context:this.context}),this._lfoA=new so({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new xs({maxDelay:1,context:this.context}),this._lfoB=new so({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new ua({context:this.context}),this._crossFadeLFO=new so({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new xs({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,Rr(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Aa.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=Wr(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=Wr(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Va extends Ta{constructor(){super(pr(Va.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=pr(Va.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new so({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new so({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new ps({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),Rr(this,["frequency","Q"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const n=[];for(let i=0;i<t;i++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),n.push(t)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((t=>t.disconnect())),this._filtersR.forEach((t=>t.disconnect())),this.frequency.dispose(),this}}class Wa extends ha{constructor(){super(pr(Wa.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=pr(Wa.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(ha.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){Ui(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){Ui(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return rr(this,void 0,void 0,(function*(){const t=this.ready,e=new Pr(2,this._decay+this._preDelay,this.context.sampleRate),n=new Ls({context:e}),i=new Ls({context:e}),r=new _a({context:e});n.connect(r,0,0),i.connect(r,0,1);const s=new us({context:e}).toDestination();r.connect(s),n.start(0),i.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(Mr),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Ga extends os{constructor(){super(pr(Ga.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Sa({channels:2,context:this.context}),this._midAdd=new no({context:this.context}),this.mid=new Ys({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new mo({context:this.context}),this.side=new Ys({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class qa extends os{constructor(){super(pr(qa.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new us({context:this.context}),this.side=new us({context:this.context}),this._left=new no({context:this.context}),this._leftMult=new Ys({context:this.context,value:Math.SQRT1_2}),this._right=new mo({context:this.context}),this._rightMult=new Ys({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new _a({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class Ha extends ha{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new qa({context:this.context}),this._midSideSplit=new Ga({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._midSend.chain(...e,this._midReturn)}connectEffectSide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._sideSend.chain(...e,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class Xa extends Ha{constructor(){super(pr(Xa.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=pr(Xa.getDefaults(),arguments,["width"]);this.width=new ps({context:this.context,value:t.width,units:"normalRange"}),Rr(this,["width"]),this._twoTimesWidthMid=new Ys({context:this.context,value:2}),this._twoTimesWidthSide=new Ys({context:this.context,value:2}),this._midMult=new Ys({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new mo({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),cs(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Ys({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(Ha.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class Ya extends Ta{constructor(){super(pr(Ya.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=pr(Ya.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new so({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new so({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new us({context:this.context}),this._amplitudeR=new us({context:this.context}),this.frequency=new ps({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new ps({context:this.context,value:t.depth,units:"normalRange"}),Rr(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ka extends ha{constructor(){super(pr(Ka.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=pr(Ka.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new xs({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new so({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,Rr(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(ha.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Qa extends os{constructor(){super(pr(Qa.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=pr(Qa.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new us({context:this.context}),this._split=new Sa({context:this.context,channels:t.channels}),this.input.connect(this._split),Ui(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(os.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){zi("waveform"===t||"fft"===t,"Analyser: invalid type: ".concat(t)),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class Za extends os{constructor(){super(pr(Za.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Qa({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Ja extends Za{constructor(){super(pr(Ja.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=pr(Ja.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Qa({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(Za.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return qi("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map((t=>{const e=t.reduce(((t,e)=>t+e*e),0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:Vr(this._rms)}));return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class $a extends Za{constructor(){super(pr($a.getDefaults(),arguments,["size"])),this.name="FFT";const t=pr($a.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(os.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((t=>this.normalRange?jr(t):t))}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return zi(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than ".concat(this.size)),t*this.context.sampleRate/(2*this.size)}}class tc extends Za{constructor(){super(pr(tc.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class ec extends Za{constructor(){super(pr(ec.getDefaults(),arguments,["size"])),this.name="Waveform";const t=pr(ec.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(Za.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class nc extends os{constructor(){super(pr(nc.getDefaults(),arguments,["solo"])),this.name="Solo";const t=pr(nc.getDefaults(),arguments,["solo"]);this.input=this.output=new us({context:this.context}),nc._allSolos.has(this.context)||nc._allSolos.set(this.context,new Set),nc._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(os.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),nc._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){nc._soloed.has(this.context)||nc._soloed.set(this.context,new Set),nc._soloed.get(this.context).add(this)}_removeSolo(){nc._soloed.has(this.context)&&nc._soloed.get(this.context).delete(this)}_isSoloed(){return nc._soloed.has(this.context)&&nc._soloed.get(this.context).has(this)}_noSolos(){return!nc._soloed.has(this.context)||nc._soloed.has(this.context)&&0===nc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),nc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}nc._allSolos=new Map,nc._soloed=new Map;class ic extends os{constructor(){super(pr(ic.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=pr(ic.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new fa({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Is({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Rr(this,["pan","volume"])}static getDefaults(){return Object.assign(os.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class rc extends os{constructor(){super(pr(rc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=pr(rc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new nc({solo:t.solo,context:this.context}),this._panVol=this.output=new ic({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Rr(this,["pan","volume"])}static getDefaults(){return Object.assign(os.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return rc.buses.has(t)||rc.buses.set(t,new us({context:this.context})),rc.buses.get(t)}send(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this._getBus(t),i=new us({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}rc.buses=new Map;class sc extends os{constructor(){super(pr(sc.getDefaults(),arguments)),this.name="Mono",this.input=new us({context:this.context}),this._merge=this.output=new _a({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class oc extends os{constructor(){super(pr(oc.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new us({context:this.context}),this.output=void 0,this.low=new Oo({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Oo({context:this.context,frequency:0,type:"highpass"}),this.mid=new Oo({context:this.context,frequency:0,type:"lowpass"}),this.high=new Oo({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=pr(oc.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new ps({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new ps({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new ps({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Rr(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(os.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Nr(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class ac extends os{constructor(){super(...arguments),this.name="Listener",this.positionX=new ss({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ss({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ss({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ss({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ss({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ss({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ss({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ss({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ss({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(os.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Er((t=>{t.listener=new ac({context:t})})),kr((t=>{t.listener.dispose()}));class cc extends os{constructor(){super(pr(cc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=pr(cc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new ss({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new ss({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new ss({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new ss({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new ss({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new ss({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(os.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class lc extends os{constructor(){super(pr(lc.getDefaults(),arguments)),this.name="Recorder";const t=pr(lc.getDefaults(),arguments);this.input=new us({context:this.context}),zi(lc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return os.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==er&&Reflect.has(er,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return rr(this,void 0,void 0,(function*(){zi("started"!==this.state,"Recorder is already started");const t=new Promise((t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)}));return this._recorder.start(),yield t}))}stop(){return rr(this,void 0,void 0,(function*(){zi("stopped"!==this.state,"Recorder is not started");const t=new Promise((t=>{const e=n=>{this._recorder.removeEventListener("dataavailable",e,!1),t(n.data)};this._recorder.addEventListener("dataavailable",e,!1)}));return this._recorder.stop(),yield t}))}pause(){return zi("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class uc extends os{constructor(){super(pr(uc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=pr(uc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new ss({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new ss({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new ss({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new ss({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new ss({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),Rr(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(os.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class hc extends os{constructor(){super(Object.assign(pr(hc.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=pr(hc.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new ga({context:this.context,smoothing:t.smoothing}),this._gt=new vo({context:this.context,value:jr(t.threshold)}),this.input=new us({context:this.context}),this._gate=this.output=new us({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(os.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Vr(this._gt.value)}set threshold(t){this._gt.value=jr(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class dc extends os{constructor(){super(Object.assign(pr(dc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=pr(dc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new uc({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,Rr(this,"threshold")}static getDefaults(){return Object.assign(os.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class pc extends os{constructor(){super(Object.assign(pr(pc.getDefaults(),arguments))),this.name="MidSideCompressor";const t=pr(pc.getDefaults(),arguments);this._midSideSplit=this.input=new Ga({context:this.context}),this._midSideMerge=this.output=new qa({context:this.context}),this.mid=new uc(Object.assign(t.mid,{context:this.context})),this.side=new uc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),Rr(this,["mid","side"])}static getDefaults(){return Object.assign(os.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class fc extends os{constructor(){super(Object.assign(pr(fc.getDefaults(),arguments))),this.name="MultibandCompressor";const t=pr(fc.getDefaults(),arguments);this._splitter=this.input=new oc({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new us({context:this.context}),this.low=new uc(Object.assign(t.low,{context:this.context})),this.mid=new uc(Object.assign(t.mid,{context:this.context})),this.high=new uc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),Rr(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(os.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class mc extends os{constructor(){super(pr(mc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new us({context:this.context}),this._internalChannels=[];const t=pr(mc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new oc({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new us({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new us({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new us({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Rr(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(os.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Nr(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class gc extends os{constructor(){super(pr(gc.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=pr(gc.getDefaults(),arguments,["url","onload"]);this._buffer=new Dr(t.url,(e=>{this.buffer=e,t.onload()})),this.input=new us({context:this.context}),this.output=new us({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(os.getDefaults(),{normalize:!0,onload:Mr})}load(t){return rr(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function vc(){return Br().now()}function yc(){return Br().immediate()}const xc=Br().transport;function bc(){return Br().transport}const wc=Br().destination,Sc=Br().destination;function _c(){return Br().destination}const Tc=Br().listener;function Ec(){return Br().listener}const Cc=Br().draw;function kc(){return Br().draw}const Ac=Br();function Ic(){return Dr.loaded()}const Oc=Dr,Rc=ws,Nc=Fs},1561:(t,e,n)=>{"use strict";var i=n(2791);var r="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},s=i.useState,o=i.useEffect,a=i.useLayoutEffect,c=i.useDebugValue;function l(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!r(t,n)}catch(i){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(t,e){return e()}:function(t,e){var n=e(),i=s({inst:{value:n,getSnapshot:e}}),r=i[0].inst,u=i[1];return a((function(){r.value=n,r.getSnapshot=e,l(r)&&u({inst:r})}),[t,n,e]),o((function(){return l(r)&&u({inst:r}),t((function(){l(r)&&u({inst:r})}))}),[t]),c(n),n};e.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:u},7595:(t,e,n)=>{"use strict";var i=n(2791),r=n(7248);var s="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},o=r.useSyncExternalStore,a=i.useRef,c=i.useEffect,l=i.useMemo,u=i.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=l((function(){function t(t){if(!c){if(c=!0,o=t,t=i(t),void 0!==r&&d.hasValue){var e=d.value;if(r(e,t))return a=e}return a=t}if(e=a,s(o,t))return e;var n=i(t);return void 0!==r&&r(e,n)?e:(o=t,a=n)}var o,a,c=!1,l=void 0===n?null:n;return[function(){return t(e())},null===l?void 0:function(){return t(l())}]}),[e,n,i,r]);var p=o(t,h[0],h[1]);return c((function(){d.hasValue=!0,d.value=p}),[p]),u(p),p}},7248:(t,e,n)=>{"use strict";t.exports=n(1561)},327:(t,e,n)=>{"use strict";t.exports=n(7595)},2391:t=>{"use strict";var e=function(){};t.exports=e},914:()=>{},5410:()=>{},8628:()=>{},5778:()=>{},1601:()=>{},7792:()=>{},5042:()=>{},3897:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports},5372:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9728:(t,e,n)=>{var i=n(4062);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},8872:t=>{t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s,o,a=[],c=!0,l=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);c=!0);}catch(t){l=!0,r=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},7424:(t,e,n)=>{var i=n(5372),r=n(8872),s=n(6116),o=n(2218);t.exports=function(t,e){return i(t)||r(t,e)||s(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},5036:(t,e,n)=>{var i=n(8698).default;t.exports=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports},4062:(t,e,n)=>{var i=n(8698).default,r=n(5036);t.exports=function(t){var e=r(t,"string");return"symbol"===i(e)?e:String(e)},t.exports.__esModule=!0,t.exports.default=t.exports},8698:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:(t,e,n)=>{var i=n(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;__webpack_require__.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var r=Object.create(null);__webpack_require__.r(r);var s={};t=t||[null,e({}),e([]),e(e)];for(var o=2&i&&n;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,__webpack_require__.d(r,s),r}})(),__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),__webpack_require__.p="/";var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{hasBrowserEnv:()=>Wn,hasStandardBrowserEnv:()=>Gn,hasStandardBrowserWebWorkerEnv:()=>Hn});var e=__webpack_require__(2791),n=__webpack_require__.t(e,2),i=__webpack_require__(1250),r=__webpack_require__(7248),s=__webpack_require__(327),o=__webpack_require__(4164),a=__webpack_require__.t(o,2);let c=function(t){t()};const l=()=>c,u=Symbol.for("react-redux-context"),h="undefined"!==typeof globalThis?globalThis:{};function d(){var t;if(!e.createContext)return{};const n=null!=(t=h[u])?t:h[u]=new Map;let i=n.get(e.createContext);return i||(i=e.createContext(null),n.set(e.createContext,i)),i}const p=d();function f(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return function(){return(0,e.useContext)(t)}}const m=f();let g=()=>{throw new Error("uSES not initialized!")};const v=(t,e)=>t===e;function y(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const n=t===p?m:f(t);return function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:r=v,stabilityCheck:s,noopCheck:o}="function"===typeof i?{equalityFn:i}:i;const{store:a,subscription:c,getServerState:l,stabilityCheck:u,noopCheck:h}=n(),d=((0,e.useRef)(!0),(0,e.useCallback)({[t.name]:e=>t(e)}[t.name],[t,u,s])),p=g(c.addNestedSub,a.getState,l||a.getState,d,r);return(0,e.useDebugValue)(p),p}}const x=y();__webpack_require__(2110),__webpack_require__(6900);const b={notify(){},get:()=>[]};function w(t,e){let n,i=b,r=0,s=!1;function o(){u.onStateChange&&u.onStateChange()}function a(){r++,n||(n=e?e.addNestedSub(o):t.subscribe(o),i=function(){const t=l();let e=null,n=null;return{clear(){e=null,n=null},notify(){t((()=>{let t=e;for(;t;)t.callback(),t=t.next}))},get(){let t=[],n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(t){let i=!0,r=n={callback:t,next:null,prev:n};return r.prev?r.prev.next=r:e=r,function(){i&&null!==e&&(i=!1,r.next?r.next.prev=r.prev:n=r.prev,r.prev?r.prev.next=r.next:e=r.next)}}}}())}function c(){r--,n&&0===r&&(n(),n=void 0,i.clear(),i=b)}const u={addNestedSub:function(t){a();const e=i.subscribe(t);let n=!1;return()=>{n||(n=!0,e(),c())}},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:o,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,a())},tryUnsubscribe:function(){s&&(s=!1,c())},getListeners:()=>i};return u}const S=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?e.useLayoutEffect:e.useEffect;let _=null;const T=function(t){let{store:n,context:i,children:r,serverState:s,stabilityCheck:o="once",noopCheck:a="once"}=t;const c=e.useMemo((()=>{const t=w(n);return{store:n,subscription:t,getServerState:s?()=>s:void 0,stabilityCheck:o,noopCheck:a}}),[n,s,o,a]),l=e.useMemo((()=>n.getState()),[n]);S((()=>{const{subscription:t}=c;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),l!==n.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[c,l]);const u=i||p;return e.createElement(u.Provider,{value:c},r)};function E(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const e=t===p?m:f(t);return function(){const{store:t}=e();return t}}const C=E();function k(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;const e=t===p?C:E(t);return function(){return e().dispatch}}const A=k();var I;function O(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function R(t){return!!t&&!!t[bt]}function N(t){var e;return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===wt}(t)||Array.isArray(t)||!!t[xt]||!!(null===(e=t.constructor)||void 0===e?void 0:e[xt])||z(t)||U(t))}function M(t,e,n){void 0===n&&(n=!1),0===D(t)?(n?Object.keys:St)(t).forEach((function(i){n&&"symbol"==typeof i||e(i,t[i],t)})):t.forEach((function(n,i){return e(i,n,t)}))}function D(t){var e=t[bt];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:z(t)?2:U(t)?3:0}function P(t,e){return 2===D(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function F(t,e){return 2===D(t)?t.get(e):t[e]}function L(t,e,n){var i=D(t);2===i?t.set(e,n):3===i?t.add(n):t[e]=n}function B(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function z(t){return mt&&t instanceof Map}function U(t){return gt&&t instanceof Set}function j(t){return t.o||t.t}function V(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=_t(t);delete e[bt];for(var n=St(e),i=0;i<n.length;i++){var r=n[i],s=e[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[r]})}return Object.create(Object.getPrototypeOf(t),e)}function W(t,e){return void 0===e&&(e=!1),q(t)||R(t)||!N(t)||(D(t)>1&&(t.set=t.add=t.clear=t.delete=G),Object.freeze(t),e&&M(t,(function(t,e){return W(e,!0)}),!0)),t}function G(){O(2)}function q(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function H(t){var e=Tt[t];return e||O(18,t),e}function X(t,e){Tt[t]||(Tt[t]=e)}function Y(){return pt}function K(t,e){e&&(H("Patches"),t.u=[],t.s=[],t.v=e)}function Q(t){Z(t),t.p.forEach($),t.p=null}function Z(t){t===pt&&(pt=t.l)}function J(t){return pt={p:[],l:pt,h:t,m:!0,_:0}}function $(t){var e=t[bt];0===e.i||1===e.i?e.j():e.g=!0}function tt(t,e){e._=e.p.length;var n=e.p[0],i=void 0!==t&&t!==n;return e.h.O||H("ES5").S(e,t,i),i?(n[bt].P&&(Q(e),O(4)),N(t)&&(t=et(e,t),e.l||it(e,t)),e.u&&H("Patches").M(n[bt].t,t,e.u,e.s)):t=et(e,n,[]),Q(e),e.u&&e.v(e.u,e.s),t!==yt?t:void 0}function et(t,e,n){if(q(e))return e;var i=e[bt];if(!i)return M(e,(function(r,s){return nt(t,i,e,r,s,n)}),!0),e;if(i.A!==t)return e;if(!i.P)return it(t,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=V(i.k):i.o,s=r,o=!1;3===i.i&&(s=new Set(r),r.clear(),o=!0),M(s,(function(e,s){return nt(t,i,r,e,s,n,o)})),it(t,r,!1),n&&t.u&&H("Patches").N(i,n,t.u,t.s)}return i.o}function nt(t,e,n,i,r,s,o){if(R(r)){var a=et(t,r,s&&e&&3!==e.i&&!P(e.R,i)?s.concat(i):void 0);if(L(n,i,a),!R(a))return;t.m=!1}else o&&n.add(r);if(N(r)&&!q(r)){if(!t.h.D&&t._<1)return;et(t,r),e&&e.A.l||it(t,r)}}function it(t,e,n){void 0===n&&(n=!1),!t.l&&t.h.D&&t.m&&W(e,n)}function rt(t,e){var n=t[bt];return(n?j(n):t)[e]}function st(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var i=Object.getOwnPropertyDescriptor(n,e);if(i)return i;n=Object.getPrototypeOf(n)}}function ot(t){t.P||(t.P=!0,t.l&&ot(t.l))}function at(t){t.o||(t.o=V(t.t))}function ct(t,e,n){var i=z(e)?H("MapSet").F(e,n):U(e)?H("MapSet").T(e,n):t.O?function(t,e){var n=Array.isArray(t),i={i:n?1:0,A:e?e.A:Y(),P:!1,I:!1,R:{},l:e,t:t,k:null,o:null,j:null,C:!1},r=i,s=Et;n&&(r=[i],s=Ct);var o=Proxy.revocable(r,s),a=o.revoke,c=o.proxy;return i.k=c,i.j=a,c}(e,n):H("ES5").J(e,n);return(n?n.A:Y()).p.push(i),i}function lt(t){return R(t)||O(22,t),function t(e){if(!N(e))return e;var n,i=e[bt],r=D(e);if(i){if(!i.P&&(i.i<4||!H("ES5").K(i)))return i.t;i.I=!0,n=ut(e,r),i.I=!1}else n=ut(e,r);return M(n,(function(e,r){i&&F(i.t,e)===r||L(n,e,t(r))})),3===r?new Set(n):n}(t)}function ut(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return V(t)}function ht(){function t(t,e){var n=r[t];return n?n.enumerable=e:r[t]=n={configurable:!0,enumerable:e,get:function(){var e=this[bt];return Et.get(e,t)},set:function(e){var n=this[bt];Et.set(n,t,e)}},n}function e(t){for(var e=t.length-1;e>=0;e--){var r=t[e][bt];if(!r.P)switch(r.i){case 5:i(r)&&ot(r);break;case 4:n(r)&&ot(r)}}}function n(t){for(var e=t.t,n=t.k,i=St(n),r=i.length-1;r>=0;r--){var s=i[r];if(s!==bt){var o=e[s];if(void 0===o&&!P(e,s))return!0;var a=n[s],c=a&&a[bt];if(c?c.t!==o:!B(a,o))return!0}}var l=!!e[bt];return i.length!==St(e).length+(l?0:1)}function i(t){var e=t.k;if(e.length!==t.t.length)return!0;var n=Object.getOwnPropertyDescriptor(e,e.length-1);if(n&&!n.get)return!0;for(var i=0;i<e.length;i++)if(!e.hasOwnProperty(i))return!0;return!1}var r={};X("ES5",{J:function(e,n){var i=Array.isArray(e),r=function(e,n){if(e){for(var i=Array(n.length),r=0;r<n.length;r++)Object.defineProperty(i,""+r,t(r,!0));return i}var s=_t(n);delete s[bt];for(var o=St(s),a=0;a<o.length;a++){var c=o[a];s[c]=t(c,e||!!s[c].enumerable)}return Object.create(Object.getPrototypeOf(n),s)}(i,e),s={i:i?5:4,A:n?n.A:Y(),P:!1,I:!1,R:{},l:n,t:e,k:r,o:null,g:!1,C:!1};return Object.defineProperty(r,bt,{value:s,writable:!0}),r},S:function(t,n,r){r?R(n)&&n[bt].A===t&&e(t.p):(t.u&&function t(e){if(e&&"object"==typeof e){var n=e[bt];if(n){var r=n.t,s=n.k,o=n.R,a=n.i;if(4===a)M(s,(function(e){e!==bt&&(void 0!==r[e]||P(r,e)?o[e]||t(s[e]):(o[e]=!0,ot(n)))})),M(r,(function(t){void 0!==s[t]||P(s,t)||(o[t]=!1,ot(n))}));else if(5===a){if(i(n)&&(ot(n),o.length=!0),s.length<r.length)for(var c=s.length;c<r.length;c++)o[c]=!1;else for(var l=r.length;l<s.length;l++)o[l]=!0;for(var u=Math.min(s.length,r.length),h=0;h<u;h++)s.hasOwnProperty(h)||(o[h]=!0),void 0===o[h]&&t(s[h])}}}}(t.p[0]),e(t.p))},K:function(t){return 4===t.i?n(t):i(t)}})}(t=>{g=t})(s.useSyncExternalStoreWithSelector),(t=>{_=t})(r.useSyncExternalStore),I=o.unstable_batchedUpdates,c=I;var dt,pt,ft="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),mt="undefined"!=typeof Map,gt="undefined"!=typeof Set,vt="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,yt=ft?Symbol.for("immer-nothing"):((dt={})["immer-nothing"]=!0,dt),xt=ft?Symbol.for("immer-draftable"):"__$immer_draftable",bt=ft?Symbol.for("immer-state"):"__$immer_state",wt=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),St="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,_t=Object.getOwnPropertyDescriptors||function(t){var e={};return St(t).forEach((function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)})),e},Tt={},Et={get:function(t,e){if(e===bt)return t;var n=j(t);if(!P(n,e))return function(t,e,n){var i,r=st(e,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(t.k):void 0}(t,n,e);var i=n[e];return t.I||!N(i)?i:i===rt(t.t,e)?(at(t),t.o[e]=ct(t.A.h,i,t)):i},has:function(t,e){return e in j(t)},ownKeys:function(t){return Reflect.ownKeys(j(t))},set:function(t,e,n){var i=st(j(t),e);if(null==i?void 0:i.set)return i.set.call(t.k,n),!0;if(!t.P){var r=rt(j(t),e),s=null==r?void 0:r[bt];if(s&&s.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(B(n,r)&&(void 0!==n||P(t.t,e)))return!0;at(t),ot(t)}return t.o[e]===n&&(void 0!==n||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return void 0!==rt(t.t,e)||e in t.t?(t.R[e]=!1,at(t),ot(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=j(t),i=Reflect.getOwnPropertyDescriptor(n,e);return i?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:i.enumerable,value:n[e]}:i},defineProperty:function(){O(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){O(12)}},Ct={};M(Et,(function(t,e){Ct[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),Ct.deleteProperty=function(t,e){return Ct.set.call(this,t,e,void 0)},Ct.set=function(t,e,n){return Et.set.call(this,t[0],e,n,t[0])};var kt=function(){function t(t){var e=this;this.O=vt,this.D=!0,this.produce=function(t,n,i){if("function"==typeof t&&"function"!=typeof n){var r=n;n=t;var s=e;return function(t){var e=this;void 0===t&&(t=r);for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return s.produce(t,(function(t){var i;return(i=n).call.apply(i,[e,t].concat(o))}))}}var o;if("function"!=typeof n&&O(6),void 0!==i&&"function"!=typeof i&&O(7),N(t)){var a=J(e),c=ct(e,t,void 0),l=!0;try{o=n(c),l=!1}finally{l?Q(a):Z(a)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(t){return K(a,i),tt(t,a)}),(function(t){throw Q(a),t})):(K(a,i),tt(o,a))}if(!t||"object"!=typeof t){if(void 0===(o=n(t))&&(o=t),o===yt&&(o=void 0),e.D&&W(o,!0),i){var u=[],h=[];H("Patches").M(t,o,u,h),i(u,h)}return o}O(21,t)},this.produceWithPatches=function(t,n){if("function"==typeof t)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return e.produceWithPatches(n,(function(e){return t.apply(void 0,[e].concat(r))}))};var i,r,s=e.produce(t,n,(function(t,e){i=t,r=e}));return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(t){return[t,i,r]})):[s,i,r]},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){N(t)||O(8),R(t)&&(t=lt(t));var e=J(this),n=ct(this,t,void 0);return n[bt].C=!0,Z(e),n},e.finishDraft=function(t,e){var n=(t&&t[bt]).A;return K(n,e),tt(void 0,n)},e.setAutoFreeze=function(t){this.D=t},e.setUseProxies=function(t){t&&!vt&&O(20),this.O=t},e.applyPatches=function(t,e){var n;for(n=e.length-1;n>=0;n--){var i=e[n];if(0===i.path.length&&"replace"===i.op){t=i.value;break}}n>-1&&(e=e.slice(n+1));var r=H("Patches").$;return R(t)?r(t,e):this.produce(t,(function(t){return r(t,e)}))},t}(),At=new kt,It=At.produce;At.produceWithPatches.bind(At),At.setAutoFreeze.bind(At),At.setUseProxies.bind(At),At.applyPatches.bind(At),At.createDraft.bind(At),At.finishDraft.bind(At);const Ot=It;function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Nt(t){var e=function(t,e){if("object"!==Rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==Rt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Rt(e)?e:String(e)}function Mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(n),!0).forEach((function(e){var i,r,s;i=t,r=e,s=n[e],(r=Nt(r))in i?Object.defineProperty(i,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[r]=s})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pt(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var Ft="function"===typeof Symbol&&Symbol.observable||"@@observable",Lt=function(){return Math.random().toString(36).substring(7).split("").join(".")},Bt={INIT:"@@redux/INIT"+Lt(),REPLACE:"@@redux/REPLACE"+Lt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Lt()}};function zt(t){if("object"!==typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Ut(t,e,n){var i;if("function"===typeof e&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(Pt(0));if("function"===typeof e&&"undefined"===typeof n&&(n=e,e=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(Pt(1));return n(Ut)(t,e)}if("function"!==typeof t)throw new Error(Pt(2));var r=t,s=e,o=[],a=o,c=!1;function l(){a===o&&(a=o.slice())}function u(){if(c)throw new Error(Pt(3));return s}function h(t){if("function"!==typeof t)throw new Error(Pt(4));if(c)throw new Error(Pt(5));var e=!0;return l(),a.push(t),function(){if(e){if(c)throw new Error(Pt(6));e=!1,l();var n=a.indexOf(t);a.splice(n,1),o=null}}}function d(t){if(!zt(t))throw new Error(Pt(7));if("undefined"===typeof t.type)throw new Error(Pt(8));if(c)throw new Error(Pt(9));try{c=!0,s=r(s,t)}finally{c=!1}for(var e=o=a,n=0;n<e.length;n++){(0,e[n])()}return t}return d({type:Bt.INIT}),(i={dispatch:d,subscribe:h,getState:u,replaceReducer:function(t){if("function"!==typeof t)throw new Error(Pt(10));r=t,d({type:Bt.REPLACE})}})[Ft]=function(){var t,e=h;return(t={subscribe:function(t){if("object"!==typeof t||null===t)throw new Error(Pt(11));function n(){t.next&&t.next(u())}return n(),{unsubscribe:e(n)}}})[Ft]=function(){return this},t},i}function jt(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var r=e[i];0,"function"===typeof t[r]&&(n[r]=t[r])}var s,o=Object.keys(n);try{!function(t){Object.keys(t).forEach((function(e){var n=t[e];if("undefined"===typeof n(void 0,{type:Bt.INIT}))throw new Error(Pt(12));if("undefined"===typeof n(void 0,{type:Bt.PROBE_UNKNOWN_ACTION()}))throw new Error(Pt(13))}))}(n)}catch(a){s=a}return function(t,e){if(void 0===t&&(t={}),s)throw s;for(var i=!1,r={},a=0;a<o.length;a++){var c=o[a],l=n[c],u=t[c],h=l(u,e);if("undefined"===typeof h){e&&e.type;throw new Error(Pt(14))}r[c]=h,i=i||h!==u}return(i=i||o.length!==Object.keys(t).length)?r:t}}function Vt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function Wt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),i=function(){throw new Error(Pt(15))},r={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},s=e.map((function(t){return t(r)}));return i=Vt.apply(void 0,s)(n.dispatch),Dt(Dt({},n),{},{dispatch:i})}}}function Gt(t){return function(e){var n=e.dispatch,i=e.getState;return function(e){return function(r){return"function"===typeof r?r(n,i,t):e(r)}}}}var qt=Gt();qt.withExtraArgument=Gt;const Ht=qt;var Xt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Yt=function(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},Kt=function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t},Qt=Object.defineProperty,Zt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,$t=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,ne=function(t,e,n){return e in t?Qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},ie=function(t,e){for(var n in e||(e={}))te.call(e,n)&&ne(t,n,e[n]);if($t)for(var i=0,r=$t(e);i<r.length;i++){n=r[i];ee.call(e,n)&&ne(t,n,e[n])}return t},re=function(t,e){return Zt(t,Jt(e))},se=function(t,e,n){return new Promise((function(i,r){var s=function(t){try{a(n.next(t))}catch(e){r(e)}},o=function(t){try{a(n.throw(t))}catch(e){r(e)}},a=function(t){return t.done?i(t.value):Promise.resolve(t.value).then(s,o)};a((n=n.apply(t,e)).next())}))},oe="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?Vt:Vt.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function ae(t){if("object"!==typeof t||null===t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(var n=e;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return e===n}function ce(t,e){function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(e){var r=e.apply(void 0,n);if(!r)throw new Error("prepareAction did not return an object");return ie(ie({type:t,payload:r.payload},"meta"in r&&{meta:r.meta}),"error"in r&&{error:r.error})}return{type:t,payload:n[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(e){return e.type===t},n}var le=function(t){function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Xt(e,t),Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.prototype.concat.apply(this,e)},e.prototype.prepend=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?new(e.bind.apply(e,Kt([void 0],t[0].concat(this)))):new(e.bind.apply(e,Kt([void 0],t.concat(this))))},e}(Array),ue=function(t){function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Xt(e,t),Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.prototype.concat.apply(this,e)},e.prototype.prepend=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?new(e.bind.apply(e,Kt([void 0],t[0].concat(this)))):new(e.bind.apply(e,Kt([void 0],t.concat(this))))},e}(Array);function he(t){return N(t)?Ot(t,(function(){})):t}function de(t){void 0===t&&(t={});var e=t.thunk,n=void 0===e||e,i=(t.immutableCheck,t.serializableCheck,t.actionCreatorCheck,new le);return n&&(!function(t){return"boolean"===typeof t}(n)?i.push(Ht.withExtraArgument(n.extraArgument)):i.push(Ht)),i}function pe(t){var e,n={},i=[],r={addCase:function(t,e){var i="string"===typeof t?t:t.type;if(!i)throw new Error("`builder.addCase` cannot be called with an empty action type");if(i in n)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return n[i]=e,r},addMatcher:function(t,e){return i.push({matcher:t,reducer:e}),r},addDefaultCase:function(t){return e=t,r}};return t(r),[n,i,e]}function fe(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");var n,i="function"==typeof t.initialState?t.initialState:he(t.initialState),r=t.reducers||{},s=Object.keys(r),o={},a={},c={};function l(){var e="function"===typeof t.extraReducers?pe(t.extraReducers):[t.extraReducers],n=e[0],r=void 0===n?{}:n,s=e[1],o=void 0===s?[]:s,c=e[2],l=void 0===c?void 0:c,u=ie(ie({},r),a);return function(t,e,n,i){void 0===n&&(n=[]);var r,s="function"===typeof e?pe(e):[e,n,i],o=s[0],a=s[1],c=s[2];if(function(t){return"function"===typeof t}(t))r=function(){return he(t())};else{var l=he(t);r=function(){return l}}function u(t,e){void 0===t&&(t=r());var n=Kt([o[e.type]],a.filter((function(t){return(0,t.matcher)(e)})).map((function(t){return t.reducer})));return 0===n.filter((function(t){return!!t})).length&&(n=[c]),n.reduce((function(t,n){if(n){var i;if(R(t))return void 0===(i=n(t,e))?t:i;if(N(t))return Ot(t,(function(t){return n(t,e)}));if(void 0===(i=n(t,e))){if(null===t)return t;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return t}),t)}return u.getInitialState=r,u}(i,(function(t){for(var e in u)t.addCase(e,u[e]);for(var n=0,i=o;n<i.length;n++){var r=i[n];t.addMatcher(r.matcher,r.reducer)}l&&t.addDefaultCase(l)}))}return s.forEach((function(t){var n,i,s=r[t],l=function(t,e){return t+"/"+e}(e,t);"reducer"in s?(n=s.reducer,i=s.prepare):n=s,o[t]=n,a[l]=n,c[t]=i?ce(l,i):ce(l)})),{name:e,reducer:function(t,e){return n||(n=l()),n(t,e)},actions:c,caseReducers:o,getInitialState:function(){return n||(n=l()),n.getInitialState()}}}var me=function(t){void 0===t&&(t=21);for(var e="",n=t;n--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e},ge=["name","message","stack","code"],ve=function(t,e){this.payload=t,this.meta=e},ye=function(t,e){this.payload=t,this.meta=e},xe=function(t){if("object"===typeof t&&null!==t){for(var e={},n=0,i=ge;n<i.length;n++){var r=i[n];"string"===typeof t[r]&&(e[r]=t[r])}return e}return{message:String(t)}};!function(){function t(t,e,n){var i=ce(t+"/fulfilled",(function(t,e,n,i){return{payload:t,meta:re(ie({},i||{}),{arg:n,requestId:e,requestStatus:"fulfilled"})}})),r=ce(t+"/pending",(function(t,e,n){return{payload:void 0,meta:re(ie({},n||{}),{arg:e,requestId:t,requestStatus:"pending"})}})),s=ce(t+"/rejected",(function(t,e,i,r,s){return{payload:r,error:(n&&n.serializeError||xe)(t||"Rejected"),meta:re(ie({},s||{}),{arg:i,requestId:e,rejectedWithValue:!!r,requestStatus:"rejected",aborted:"AbortError"===(null==t?void 0:t.name),condition:"ConditionError"===(null==t?void 0:t.name)})}})),o="undefined"!==typeof AbortController?AbortController:function(){function t(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return t.prototype.abort=function(){0},t}();return Object.assign((function(t){return function(a,c,l){var u,h=(null==n?void 0:n.idGenerator)?n.idGenerator(t):me(),d=new o;function p(t){u=t,d.abort()}var f=function(){return se(this,null,(function(){var o,f,m,g,v,y;return Yt(this,(function(x){switch(x.label){case 0:return x.trys.push([0,4,,5]),g=null==(o=null==n?void 0:n.condition)?void 0:o.call(n,t,{getState:c,extra:l}),null===(b=g)||"object"!==typeof b||"function"!==typeof b.then?[3,2]:[4,g];case 1:g=x.sent(),x.label=2;case 2:if(!1===g||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return!0,v=new Promise((function(t,e){return d.signal.addEventListener("abort",(function(){return e({name:"AbortError",message:u||"Aborted"})}))})),a(r(h,t,null==(f=null==n?void 0:n.getPendingMeta)?void 0:f.call(n,{requestId:h,arg:t},{getState:c,extra:l}))),[4,Promise.race([v,Promise.resolve(e(t,{dispatch:a,getState:c,extra:l,requestId:h,signal:d.signal,abort:p,rejectWithValue:function(t,e){return new ve(t,e)},fulfillWithValue:function(t,e){return new ye(t,e)}})).then((function(e){if(e instanceof ve)throw e;return e instanceof ye?i(e.payload,h,t,e.meta):i(e,h,t)}))])];case 3:return m=x.sent(),[3,5];case 4:return y=x.sent(),m=y instanceof ve?s(null,h,t,y.payload,y.meta):s(y,h,t),[3,5];case 5:return n&&!n.dispatchConditionRejection&&s.match(m)&&m.meta.condition||a(m),[2,m]}var b}))}))}();return Object.assign(f,{abort:p,requestId:h,arg:t,unwrap:function(){return f.then(be)}})}}),{pending:r,rejected:s,fulfilled:i,typePrefix:t})}t.withTypes=function(){return t}}();function be(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}Object.assign;var we="listenerMiddleware";ce(we+"/add"),ce(we+"/removeAll"),ce(we+"/remove");"function"===typeof queueMicrotask&&queueMicrotask.bind("undefined"!==typeof window?window:"undefined"!==typeof __webpack_require__.g?__webpack_require__.g:globalThis);var Se,_e=function(t){return function(e){setTimeout(e,t)}};"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:_e(10);ht();const Te=fe({name:"example",initialState:{examVar:!0},reducers:{action(t,e){t.examVar=e.payload.examVar}}}),Ee=(Te.actions,Te),Ce=fe({name:"midi",initialState:{midiList:[],midi:null,loading:!1},reducers:{setmidilist(t,e){t.midiList=e.payload.midilist},setmidi(t,e){t.midi=e.payload.midi},setLoading(t,e){t.loading=e.payload.loading}}}),ke=Ce.actions,Ae=Ce;var Ie=__webpack_require__(7808);const Oe={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Re;const Ne=new Uint8Array(16);function Me(){if(!Re&&(Re="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Re))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Re(Ne)}const De=[];for(let jo=0;jo<256;++jo)De.push((jo+256).toString(16).slice(1));function Pe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return De[t[e+0]]+De[t[e+1]]+De[t[e+2]]+De[t[e+3]]+"-"+De[t[e+4]]+De[t[e+5]]+"-"+De[t[e+6]]+De[t[e+7]]+"-"+De[t[e+8]]+De[t[e+9]]+"-"+De[t[e+10]]+De[t[e+11]]+De[t[e+12]]+De[t[e+13]]+De[t[e+14]]+De[t[e+15]]}const Fe=function(t,e,n){if(Oe.randomUUID&&!e&&!t)return Oe.randomUUID();const i=(t=t||{}).random||(t.rng||Me)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return Pe(i)};Object.freeze({keyboard:0,midi:1,phone:2});const Le=class{constructor(t){let{user_id:e,nickname:n,device:i}=t;void 0===e&&(e=Ie.ZP.load("user_id"),void 0===e&&(e=Fe(),Ie.ZP.save("user_id",e))),void 0===n&&(n=Ie.ZP.load("nickname"),void 0===n&&(n="\uc775\uba85",Ie.ZP.save("nickname",n))),this.user_id=e||"",this.nickname=n||"",this.device=i||""}},Be=fe({name:"user",initialState:{user_instance:new Le({})},reducers:{setnickname(t,e){t.user_instance.nickname=e.payload.nickname}}}),ze=Be.actions,Ue=Be;const je=class{constructor(t){this.timestamp=t.timestamp||0,this.filename=t.filename||"",this.title=t.title||"",this.imgurl=t.imgurl||"",this.subtitle=t.subtitle||"",this.rank=t.rank||0,this.poster=t.poster||"",this.like=t.like||0,this.views=t.views||0,this.music_length=t.music_length||0,this.downloadUrl=t.downloadUrl||"",this.deleteUrl=t.deleteUrl||"",this.id=t.id||0}getTimestamp(){return this.timestamp}getFilename(){return this.filename}getTitle(){return this.title}getImgurl(){return this.imgurl}getSubtitle(){return this.subtitle}getRank(){return this.rank}getPoster(){return this.poster}getLike(){return this.like}getViews(){return this.views}getMusicLength(){return this.music_length}getDownloadUrl(){return this.downloadUrl}getDeleteUrl(){return this.deleteUrl}getId(){return this.id}};const Ve=class{constructor(t){let{room_id:e,host_nickname:n,host_id:i,music_instance:r,guests:s,ongoing_code:o,error_code:a}=t;this.room_id=e||"",this.host_nickname=n||"",this.host_id=i||"",this.music_instance=r||new je({}),this.guests=s||[],this.ongoing_code=o||0,this.error_code=a||0}};function We(t,e){return function(){return t.apply(e,arguments)}}const{toString:Ge}=Object.prototype,{getPrototypeOf:qe}=Object,He=(Xe=Object.create(null),t=>{const e=Ge.call(t);return Xe[e]||(Xe[e]=e.slice(8,-1).toLowerCase())});var Xe;const Ye=t=>(t=t.toLowerCase(),e=>He(e)===t),Ke=t=>e=>typeof e===t,{isArray:Qe}=Array,Ze=Ke("undefined");const Je=Ye("ArrayBuffer");const $e=Ke("string"),tn=Ke("function"),en=Ke("number"),nn=t=>null!==t&&"object"===typeof t,rn=t=>{if("object"!==He(t))return!1;const e=qe(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},sn=Ye("Date"),on=Ye("File"),an=Ye("Blob"),cn=Ye("FileList"),ln=Ye("URLSearchParams");function un(t,e){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),Qe(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{const i=r?Object.getOwnPropertyNames(t):Object.keys(t),s=i.length;let o;for(n=0;n<s;n++)o=i[n],e.call(null,t[o],o,t)}}function hn(t,e){e=e.toLowerCase();const n=Object.keys(t);let i,r=n.length;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const dn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,pn=t=>!Ze(t)&&t!==dn;const fn=(mn="undefined"!==typeof Uint8Array&&qe(Uint8Array),t=>mn&&t instanceof mn);var mn;const gn=Ye("HTMLFormElement"),vn=(t=>{let{hasOwnProperty:e}=t;return(t,n)=>e.call(t,n)})(Object.prototype),yn=Ye("RegExp"),xn=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};un(n,((n,r)=>{let s;!1!==(s=e(n,r,t))&&(i[r]=s||n)})),Object.defineProperties(t,i)},bn="abcdefghijklmnopqrstuvwxyz",wn="0123456789",Sn={DIGIT:wn,ALPHA:bn,ALPHA_DIGIT:bn+bn.toUpperCase()+wn};const _n=Ye("AsyncFunction"),Tn={isArray:Qe,isArrayBuffer:Je,isBuffer:function(t){return null!==t&&!Ze(t)&&null!==t.constructor&&!Ze(t.constructor)&&tn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||tn(t.append)&&("formdata"===(e=He(t))||"object"===e&&tn(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&Je(t.buffer),e},isString:$e,isNumber:en,isBoolean:t=>!0===t||!1===t,isObject:nn,isPlainObject:rn,isUndefined:Ze,isDate:sn,isFile:on,isBlob:an,isRegExp:yn,isFunction:tn,isStream:t=>nn(t)&&tn(t.pipe),isURLSearchParams:ln,isTypedArray:fn,isFileList:cn,forEach:un,merge:function t(){const{caseless:e}=pn(this)&&this||{},n={},i=(i,r)=>{const s=e&&hn(n,r)||r;rn(n[s])&&rn(i)?n[s]=t(n[s],i):rn(i)?n[s]=t({},i):Qe(i)?n[s]=i.slice():n[s]=i};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&un(arguments[r],i);return n},extend:function(t,e,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return un(e,((e,i)=>{n&&tn(e)?t[i]=We(e,n):t[i]=e}),{allOwnKeys:i}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,i)=>{let r,s,o;const a={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)o=r[s],i&&!i(o,t,e)||a[o]||(e[o]=t[o],a[o]=!0);t=!1!==n&&qe(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:He,kindOfTest:Ye,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},toArray:t=>{if(!t)return null;if(Qe(t))return t;let e=t.length;if(!en(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=n.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const i=[];for(;null!==(n=t.exec(e));)i.push(n);return i},isHTMLForm:gn,hasOwnProperty:vn,hasOwnProp:vn,reduceDescriptors:xn,freezeMethods:t=>{xn(t,((e,n)=>{if(tn(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];tn(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(t,e)=>{const n={},i=t=>{t.forEach((t=>{n[t]=!0}))};return Qe(t)?i(t):i(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:hn,global:dn,isContextDefined:pn,ALPHABET:Sn,generateString:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sn.ALPHA_DIGIT,n="";const{length:i}=e;for(;t--;)n+=e[Math.random()*i|0];return n},isSpecCompliantForm:function(t){return!!(t&&tn(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),n=(t,i)=>{if(nn(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[i]=t;const r=Qe(t)?[]:{};return un(t,((t,e)=>{const s=n(t,i+1);!Ze(s)&&(r[e]=s)})),e[i]=void 0,r}}return t};return n(t,0)},isAsyncFn:_n,isThenable:t=>t&&(nn(t)||tn(t))&&tn(t.then)&&tn(t.catch)};function En(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r)}Tn.inherits(En,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Tn.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Cn=En.prototype,kn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{kn[t]={value:t}})),Object.defineProperties(En,kn),Object.defineProperty(Cn,"isAxiosError",{value:!0}),En.from=(t,e,n,i,r,s)=>{const o=Object.create(Cn);return Tn.toFlatObject(t,o,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),En.call(o,t.message,e,n,i,r),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const An=En;function In(t){return Tn.isPlainObject(t)||Tn.isArray(t)}function On(t){return Tn.endsWith(t,"[]")?t.slice(0,-2):t}function Rn(t,e,n){return t?t.concat(e).map((function(t,e){return t=On(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}const Nn=Tn.toFlatObject(Tn,{},null,(function(t){return/^is[A-Z]/.test(t)}));const Mn=function(t,e,n){if(!Tn.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(n=Tn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!Tn.isUndefined(e[t])}))).metaTokens,r=n.visitor||l,s=n.dots,o=n.indexes,a=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Tn.isSpecCompliantForm(e);if(!Tn.isFunction(r))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(Tn.isDate(t))return t.toISOString();if(!a&&Tn.isBlob(t))throw new An("Blob is not supported. Use a Buffer instead.");return Tn.isArrayBuffer(t)||Tn.isTypedArray(t)?a&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function l(t,n,r){let a=t;if(t&&!r&&"object"===typeof t)if(Tn.endsWith(n,"{}"))n=i?n:n.slice(0,-2),t=JSON.stringify(t);else if(Tn.isArray(t)&&function(t){return Tn.isArray(t)&&!t.some(In)}(t)||(Tn.isFileList(t)||Tn.endsWith(n,"[]"))&&(a=Tn.toArray(t)))return n=On(n),a.forEach((function(t,i){!Tn.isUndefined(t)&&null!==t&&e.append(!0===o?Rn([n],i,s):null===o?n:n+"[]",c(t))})),!1;return!!In(t)||(e.append(Rn(r,n,s),c(t)),!1)}const u=[],h=Object.assign(Nn,{defaultVisitor:l,convertValue:c,isVisitable:In});if(!Tn.isObject(t))throw new TypeError("data must be an object");return function t(n,i){if(!Tn.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),Tn.forEach(n,(function(n,s){!0===(!(Tn.isUndefined(n)||null===n)&&r.call(e,n,Tn.isString(s)?s.trim():s,i,h))&&t(n,i?i.concat(s):[s])})),u.pop()}}(t),e};function Dn(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function Pn(t,e){this._pairs=[],t&&Mn(t,this,e)}const Fn=Pn.prototype;Fn.append=function(t,e){this._pairs.push([t,e])},Fn.toString=function(t){const e=t?function(e){return t.call(this,e,Dn)}:Dn;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const Ln=Pn;function Bn(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function zn(t,e,n){if(!e)return t;const i=n&&n.encode||Bn,r=n&&n.serialize;let s;if(s=r?r(e,n):Tn.isURLSearchParams(e)?e.toString():new Ln(e,n).toString(i),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}const Un=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Tn.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},jn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Vn={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Ln,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Wn="undefined"!==typeof window&&"undefined"!==typeof document,Gn=(qn="undefined"!==typeof navigator&&navigator.product,Wn&&["ReactNative","NativeScript","NS"].indexOf(qn)<0);var qn;const Hn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Xn={...t,...Vn};const Yn=function(t){function e(t,n,i,r){let s=t[r++];const o=Number.isFinite(+s),a=r>=t.length;if(s=!s&&Tn.isArray(i)?i.length:s,a)return Tn.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!o;i[s]&&Tn.isObject(i[s])||(i[s]=[]);return e(t,n,i[s],r)&&Tn.isArray(i[s])&&(i[s]=function(t){const e={},n=Object.keys(t);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],e[s]=t[s];return e}(i[s])),!o}if(Tn.isFormData(t)&&Tn.isFunction(t.entries)){const n={};return Tn.forEachEntry(t,((t,i)=>{e(function(t){return Tn.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),i,n,0)})),n}return null};const Kn={transitional:jn,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,r=Tn.isObject(t);r&&Tn.isHTMLForm(t)&&(t=new FormData(t));if(Tn.isFormData(t))return i&&i?JSON.stringify(Yn(t)):t;if(Tn.isArrayBuffer(t)||Tn.isBuffer(t)||Tn.isStream(t)||Tn.isFile(t)||Tn.isBlob(t))return t;if(Tn.isArrayBufferView(t))return t.buffer;if(Tn.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Mn(t,new Xn.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,i){return Xn.isNode&&Tn.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((s=Tn.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Mn(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||i?(e.setContentType("application/json",!1),function(t,e,n){if(Tn.isString(t))try{return(e||JSON.parse)(t),Tn.trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||Kn.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(t&&Tn.isString(t)&&(n&&!this.responseType||i)){const n=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(r){if(n){if("SyntaxError"===r.name)throw An.from(r,An.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Xn.classes.FormData,Blob:Xn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Tn.forEach(["delete","get","head","post","put","patch"],(t=>{Kn.headers[t]={}}));const Qn=Kn,Zn=Tn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Jn=Symbol("internals");function $n(t){return t&&String(t).trim().toLowerCase()}function ti(t){return!1===t||null==t?t:Tn.isArray(t)?t.map(ti):String(t)}function ei(t,e,n,i,r){return Tn.isFunction(i)?i.call(this,e,n):(r&&(e=n),Tn.isString(e)?Tn.isString(i)?-1!==e.indexOf(i):Tn.isRegExp(i)?i.test(e):void 0:void 0)}class ni{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function r(t,e,n){const r=$n(e);if(!r)throw new Error("header name must be a non-empty string");const s=Tn.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||e]=ti(t))}const s=(t,e)=>Tn.forEach(t,((t,n)=>r(t,n,e)));return Tn.isPlainObject(t)||t instanceof this.constructor?s(t,e):Tn.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim())?s((t=>{const e={};let n,i,r;return t&&t.split("\n").forEach((function(t){r=t.indexOf(":"),n=t.substring(0,r).trim().toLowerCase(),i=t.substring(r+1).trim(),!n||e[n]&&Zn[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)})),e})(t),e):null!=t&&r(e,t,n),this}get(t,e){if(t=$n(t)){const n=Tn.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}(t);if(Tn.isFunction(e))return e.call(this,t,n);if(Tn.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=$n(t)){const n=Tn.findKey(this,t);return!(!n||void 0===this[n]||e&&!ei(0,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function r(t){if(t=$n(t)){const r=Tn.findKey(n,t);!r||e&&!ei(0,n[r],r,e)||(delete n[r],i=!0)}}return Tn.isArray(t)?t.forEach(r):r(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const r=e[n];t&&!ei(0,this[r],r,t,!0)||(delete this[r],i=!0)}return i}normalize(t){const e=this,n={};return Tn.forEach(this,((i,r)=>{const s=Tn.findKey(n,r);if(s)return e[s]=ti(i),void delete e[r];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,n)=>e.toUpperCase()+n))}(r):String(r).trim();o!==r&&delete e[r],e[o]=ti(i),n[o]=!0})),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return Tn.forEach(this,((n,i)=>{null!=n&&!1!==n&&(e[i]=t&&Tn.isArray(n)?n.join(", "):n)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((t=>{let[e,n]=t;return e+": "+n})).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach((t=>e.set(t))),e}static accessor(t){const e=(this[Jn]=this[Jn]={accessors:{}}).accessors,n=this.prototype;function i(t){const i=$n(t);e[i]||(!function(t,e){const n=Tn.toCamelCase(" "+e);["get","set","has"].forEach((i=>{Object.defineProperty(t,i+n,{value:function(t,n,r){return this[i].call(this,e,t,n,r)},configurable:!0})}))}(n,t),e[i]=!0)}return Tn.isArray(t)?t.forEach(i):i(t),this}}ni.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Tn.reduceDescriptors(ni.prototype,((t,e)=>{let{value:n}=t,i=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(t){this[i]=t}}})),Tn.freezeMethods(ni);const ii=ni;function ri(t,e){const n=this||Qn,i=e||n,r=ii.from(i.headers);let s=i.data;return Tn.forEach(t,(function(t){s=t.call(n,s,r.normalize(),e?e.status:void 0)})),r.normalize(),s}function si(t){return!(!t||!t.__CANCEL__)}function oi(t,e,n){An.call(this,null==t?"canceled":t,An.ERR_CANCELED,e,n),this.name="CanceledError"}Tn.inherits(oi,An,{__CANCEL__:!0});const ai=oi;const ci=Xn.hasStandardBrowserEnv?{write(t,e,n,i,r,s){const o=[t+"="+encodeURIComponent(e)];Tn.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Tn.isString(i)&&o.push("path="+i),Tn.isString(r)&&o.push("domain="+r),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function li(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const ui=Xn.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function i(n){let i=n;return t&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return n=i(window.location.href),function(t){const e=Tn.isString(t)?i(t):t;return e.protocol===n.protocol&&e.host===n.host}}():function(){return!0};const hi=function(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r,s=0,o=0;return e=void 0!==e?e:1e3,function(a){const c=Date.now(),l=i[o];r||(r=c),n[s]=a,i[s]=c;let u=o,h=0;for(;u!==s;)h+=n[u++],u%=t;if(s=(s+1)%t,s===o&&(o=(o+1)%t),c-r<e)return;const d=l&&c-l;return d?Math.round(1e3*h/d):void 0}};function di(t,e){let n=0;const i=hi(50,250);return r=>{const s=r.loaded,o=r.lengthComputable?r.total:void 0,a=s-n,c=i(a);n=s;const l={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&s<=o?(o-s)/c:void 0,event:r};l[e?"download":"upload"]=!0,t(l)}}const pi="undefined"!==typeof XMLHttpRequest&&function(t){return new Promise((function(e,n){let i=t.data;const r=ii.from(t.headers).normalize();let s,o,{responseType:a,withXSRFToken:c}=t;function l(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}if(Tn.isFormData(i))if(Xn.hasStandardBrowserEnv||Xn.hasStandardBrowserWebWorkerEnv)r.setContentType(!1);else if(!1!==(o=r.getContentType())){const[t,...e]=o?o.split(";").map((t=>t.trim())).filter(Boolean):[];r.setContentType([t||"multipart/form-data",...e].join("; "))}let u=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",n=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";r.set("Authorization","Basic "+btoa(e+":"+n))}const h=li(t.baseURL,t.url);function d(){if(!u)return;const i=ii.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new An("Request failed with status code "+n.status,[An.ERR_BAD_REQUEST,An.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}((function(t){e(t),l()}),(function(t){n(t),l()}),{data:a&&"text"!==a&&"json"!==a?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:i,config:t,request:u}),u=null}if(u.open(t.method.toUpperCase(),zn(h,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,"onloadend"in u?u.onloadend=d:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(d)},u.onabort=function(){u&&(n(new An("Request aborted",An.ECONNABORTED,t,u)),u=null)},u.onerror=function(){n(new An("Network Error",An.ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const i=t.transitional||jn;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new An(e,i.clarifyTimeoutError?An.ETIMEDOUT:An.ECONNABORTED,t,u)),u=null},Xn.hasStandardBrowserEnv&&(c&&Tn.isFunction(c)&&(c=c(t)),c||!1!==c&&ui(h))){const e=t.xsrfHeaderName&&t.xsrfCookieName&&ci.read(t.xsrfCookieName);e&&r.set(t.xsrfHeaderName,e)}void 0===i&&r.setContentType(null),"setRequestHeader"in u&&Tn.forEach(r.toJSON(),(function(t,e){u.setRequestHeader(e,t)})),Tn.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),a&&"json"!==a&&(u.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&u.addEventListener("progress",di(t.onDownloadProgress,!0)),"function"===typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",di(t.onUploadProgress)),(t.cancelToken||t.signal)&&(s=e=>{u&&(n(!e||e.type?new ai(null,t,u):e),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s)));const p=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(h);p&&-1===Xn.protocols.indexOf(p)?n(new An("Unsupported protocol "+p+":",An.ERR_BAD_REQUEST,t)):u.send(i||null)}))},fi={http:null,xhr:pi};Tn.forEach(fi,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}}));const mi=t=>"- ".concat(t),gi=t=>Tn.isFunction(t)||null===t||!1===t,vi=t=>{t=Tn.isArray(t)?t:[t];const{length:e}=t;let n,i;const r={};for(let s=0;s<e;s++){let e;if(n=t[s],i=n,!gi(n)&&(i=fi[(e=String(n)).toLowerCase()],void 0===i))throw new An("Unknown adapter '".concat(e,"'"));if(i)break;r[e||"#"+s]=i}if(!i){const t=Object.entries(r).map((t=>{let[e,n]=t;return"adapter ".concat(e," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=e?t.length>1?"since :\n"+t.map(mi).join("\n"):" "+mi(t[0]):"as no adapter specified";throw new An("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function yi(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ai(null,t)}function xi(t){yi(t),t.headers=ii.from(t.headers),t.data=ri.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return vi(t.adapter||Qn.adapter)(t).then((function(e){return yi(t),e.data=ri.call(t,t.transformResponse,e),e.headers=ii.from(e.headers),e}),(function(e){return si(e)||(yi(t),e&&e.response&&(e.response.data=ri.call(t,t.transformResponse,e.response),e.response.headers=ii.from(e.response.headers))),Promise.reject(e)}))}const bi=t=>t instanceof ii?t.toJSON():t;function wi(t,e){e=e||{};const n={};function i(t,e,n){return Tn.isPlainObject(t)&&Tn.isPlainObject(e)?Tn.merge.call({caseless:n},t,e):Tn.isPlainObject(e)?Tn.merge({},e):Tn.isArray(e)?e.slice():e}function r(t,e,n){return Tn.isUndefined(e)?Tn.isUndefined(t)?void 0:i(void 0,t,n):i(t,e,n)}function s(t,e){if(!Tn.isUndefined(e))return i(void 0,e)}function o(t,e){return Tn.isUndefined(e)?Tn.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function a(n,r,s){return s in e?i(n,r):s in t?i(void 0,n):void 0}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(t,e)=>r(bi(t),bi(e),!0)};return Tn.forEach(Object.keys(Object.assign({},t,e)),(function(i){const s=c[i]||r,o=s(t[i],e[i],i);Tn.isUndefined(o)&&s!==a||(n[i]=o)})),n}const Si="1.6.2",_i={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{_i[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}}));const Ti={};_i.transitional=function(t,e,n){function i(t,e){return"[Axios v1.6.2] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,r,s)=>{if(!1===t)throw new An(i(r," has been removed"+(e?" in "+e:"")),An.ERR_DEPRECATED);return e&&!Ti[r]&&(Ti[r]=!0,console.warn(i(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,s)}};const Ei={assertOptions:function(t,e,n){if("object"!==typeof t)throw new An("options must be an object",An.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const e=t[s],n=void 0===e||o(e,s,t);if(!0!==n)throw new An("option "+s+" must be "+n,An.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new An("Unknown option "+s,An.ERR_BAD_OPTION)}},validators:_i},Ci=Ei.validators;class ki{constructor(t){this.defaults=t,this.interceptors={request:new Un,response:new Un}}request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=wi(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:r}=e;void 0!==n&&Ei.assertOptions(n,{silentJSONParsing:Ci.transitional(Ci.boolean),forcedJSONParsing:Ci.transitional(Ci.boolean),clarifyTimeoutError:Ci.transitional(Ci.boolean)},!1),null!=i&&(Tn.isFunction(i)?e.paramsSerializer={serialize:i}:Ei.assertOptions(i,{encode:Ci.function,serialize:Ci.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=r&&Tn.merge(r.common,r[e.method]);r&&Tn.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete r[t]})),e.headers=ii.concat(s,r);const o=[];let a=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(a=a&&t.synchronous,o.unshift(t.fulfilled,t.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(t){c.push(t.fulfilled,t.rejected)}));let u,h=0;if(!a){const t=[xi.bind(this),void 0];for(t.unshift.apply(t,o),t.push.apply(t,c),u=t.length,l=Promise.resolve(e);h<u;)l=l.then(t[h++],t[h++]);return l}u=o.length;let d=e;for(h=0;h<u;){const t=o[h++],e=o[h++];try{d=t(d)}catch(p){e.call(this,p);break}}try{l=xi.call(this,d)}catch(p){return Promise.reject(p)}for(h=0,u=c.length;h<u;)l=l.then(c[h++],c[h++]);return l}getUri(t){return zn(li((t=wi(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}Tn.forEach(["delete","get","head","options"],(function(t){ki.prototype[t]=function(e,n){return this.request(wi(n||{},{method:t,url:e,data:(n||{}).data}))}})),Tn.forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,r){return this.request(wi(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}ki.prototype[t]=e(),ki.prototype[t+"Form"]=e(!0)}));const Ai=ki;class Ii{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then((t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null})),this.promise.then=t=>{let e;const i=new Promise((t=>{n.subscribe(t),e=t})).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t,i,r){n.reason||(n.reason=new ai(t,i,r),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;const e=new Ii((function(e){t=e}));return{token:e,cancel:t}}}const Oi=Ii;const Ri={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ri).forEach((t=>{let[e,n]=t;Ri[n]=e}));const Ni=Ri;const Mi=function t(e){const n=new Ai(e),i=We(Ai.prototype.request,n);return Tn.extend(i,Ai.prototype,n,{allOwnKeys:!0}),Tn.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return t(wi(e,n))},i}(Qn);Mi.Axios=Ai,Mi.CanceledError=ai,Mi.CancelToken=Oi,Mi.isCancel=si,Mi.VERSION=Si,Mi.toFormData=Mn,Mi.AxiosError=An,Mi.Cancel=Mi.CanceledError,Mi.all=function(t){return Promise.all(t)},Mi.spread=function(t){return function(e){return t.apply(null,e)}},Mi.isAxiosError=function(t){return Tn.isObject(t)&&!0===t.isAxiosError},Mi.mergeConfig=wi,Mi.AxiosHeaders=ii,Mi.formToJSON=t=>Yn(Tn.isHTMLForm(t)?new FormData(t):t),Mi.getAdapter=vi,Mi.HttpStatusCode=Ni,Mi.default=Mi;const Di=Mi,Pi=Di.create({baseURL:"http://13.124.50.132:8000"}),Fi=fe({name:"room",initialState:{room:new Ve({}),start:0,keydown:{},keyup:{}},reducers:{setRoom(t,e){t.room=e.payload.room},setOngoingFalse(t,e){t.room.ongoing_code=0,console.log("ongoing false")},setOngoingCode(t,e){const n={...t.room};n.ongoing_code=e.payload.code,t.room={...n}},setStart(t,e){t.start=e.payload.start},setKeydown(t,e){t.keydown=e.payload.keydown},setKeyup(t,e){t.keyup=e.payload.keyup}}}),Li=Fi.actions,Bi=Fi,zi=t=>e=>{e(Li.setRoom({room:t}))},Ui=()=>t=>{t(Li.setOngoingFalse())},ji=t=>e=>{e(Li.setStart({start:t}))};const Vi=class{constructor(){this.socket=null}connect(t){this.socket||(this.socket=new WebSocket(t))}isConnected(){return!!this.socket&&this.socket.readyState===WebSocket.OPEN}disconnect(){this.socket&&(this.socket.close(),this.socket=null)}send(t){this.socket&&this.socket.send(JSON.stringify(t))}on(t,e){this.socket&&this.socket.addEventListener(t,e)}},Wi=function(t){var e,n=function(t){return de(t)},i=t||{},r=i.reducer,s=void 0===r?void 0:r,o=i.middleware,a=void 0===o?n():o,c=i.devTools,l=void 0===c||c,u=i.preloadedState,h=void 0===u?void 0:u,d=i.enhancers,p=void 0===d?void 0:d;if("function"===typeof s)e=s;else{if(!ae(s))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');e=jt(s)}var f=a;"function"===typeof f&&(f=f(n));var m=Wt.apply(void 0,f),g=Vt;l&&(g=oe(ie({trace:!1},"object"===typeof l&&l)));var v=new ue(m),y=v;return Array.isArray(p)?y=Kt([m],p):"function"===typeof p&&(y=p(v)),Ut(e,h,g.apply(void 0,y))}({reducer:{example:Ee.reducer,midi:Ae.reducer,user:Ue.reducer,room:Bi.reducer},middleware:[(t=>e=>n=>i=>{const{dispatch:r,getState:s}=e,{type:o}=i;switch(o){case"socket/connect":if(t.isConnected())return n(i);const e=i.payload;console.log(e);let s="?filename=".concat(e.filename,"&nickname=").concat(e.nickname,"&user_id=").concat(e.user_id,"&device=").concat(e.device);void 0!==e.room_id&&(s="?room_id=".concat(e.room_id,"&nickname=").concat(e.nickname,"&user_id=").concat(e.user_id,"&device=").concat(e.device)),t.connect("".concat("ws://13.124.50.132:8000/ws/").concat(s)),t.on("open",(()=>{console.log("WebSocket connection opened")})),t.on("message",(t=>{console.log("WebSocket message received:",t);const n=JSON.parse(t.data);var i,s,o;"connect"===n.type?(void 0===e.room_id&&(n.data.ongoing_code=1),r(zi(new Ve(n.data))),r(ji(0))):"host_out"===n.type?r(zi(new Ve({error_code:2}))):"join"===n.type||"disconnect"===n.type?r(zi(new Ve(n.data))):"areYouReady"===n.type?r((o=2,t=>{t(Li.setOngoingCode({code:o}))})):"start"===n.type?(console.log("\uc11c\ubc84\ub85c\ubd80\ud130 start \ubc1b\uc74c",n.data),r(ji(n.data))):"keyDown"===n.type?r((s=n.data,t=>{t(Li.setKeydown({keydown:s}))})):"keyUp"===n.type&&r((i=n.data,t=>{t(Li.setKeyup({keyup:i}))}))})),t.on("close",(()=>{r(zi(new Ve({error_code:1}))),console.log("WebSocket connection closed")}));break;case"socket/disconnect":t.disconnect();break;case"socket/host_play":t.send(JSON.stringify({type:"host_play"}));break;case"socket/imready":t.send(JSON.stringify({type:"imready"}));break;case"socket/keyDown":t.send(JSON.stringify({type:"keyDown",data:i.payload}));break;case"socket/keyUp":t.send(JSON.stringify({type:"keyUp",data:i.payload}))}return n(i)})(new Vi),...de({serializableCheck:!1})]});function Gi(){return Gi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Gi.apply(this,arguments)}var qi;!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(qi||(qi={}));const Hi="popstate";function Xi(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function Yi(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function Ki(t,e){return{usr:t.state,key:t.key,idx:e}}function Qi(t,e,n,i){return void 0===n&&(n=null),Gi({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?Ji(e):e,{state:n,key:e&&e.key||i||Math.random().toString(36).substr(2,8)})}function Zi(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(e+="#"===i.charAt(0)?i:"#"+i),e}function Ji(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function $i(t,e,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=qi.Pop,c=null,l=u();function u(){return(o.state||{idx:null}).idx}function h(){a=qi.Pop;let t=u(),e=null==t?null:t-l;l=t,c&&c({action:a,location:p.location,delta:e})}function d(t){let e="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof t?t:Zi(t);return Xi(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}null==l&&(l=0,o.replaceState(Gi({},o.state,{idx:l}),""));let p={get action(){return a},get location(){return t(r,o)},listen(t){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(Hi,h),c=t,()=>{r.removeEventListener(Hi,h),c=null}},createHref:t=>e(r,t),createURL:d,encodeLocation(t){let e=d(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){a=qi.Push;let i=Qi(p.location,t,e);n&&n(i,t),l=u()+1;let h=Ki(i,l),d=p.createHref(i);try{o.pushState(h,"",d)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;r.location.assign(d)}s&&c&&c({action:a,location:p.location,delta:1})},replace:function(t,e){a=qi.Replace;let i=Qi(p.location,t,e);n&&n(i,t),l=u();let r=Ki(i,l),h=p.createHref(i);o.replaceState(r,"",h),s&&c&&c({action:a,location:p.location,delta:0})},go:t=>o.go(t)};return p}var tr;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(tr||(tr={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function er(t,e,n){void 0===n&&(n="/");let i=mr(("string"===typeof e?Ji(e):e).pathname||"/",n);if(null==i)return null;let r=nr(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every(((t,n)=>t===e[n]));return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(r);let s=null;for(let o=0;null==s&&o<r.length;++o)s=dr(r[o],fr(i));return s}function nr(t,e,n,i){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(t,r,s)=>{let o={relativePath:void 0===s?t.path||"":s,caseSensitive:!0===t.caseSensitive,childrenIndex:r,route:t};o.relativePath.startsWith("/")&&(Xi(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(i.length));let a=xr([i,o.relativePath]),c=n.concat(o);t.children&&t.children.length>0&&(Xi(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),nr(t.children,e,c,a)),(null!=t.path||t.index)&&e.push({path:a,score:hr(a,t.index),routesMeta:c})};return t.forEach(((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let i of ir(t.path))r(t,e,i);else r(t,e)})),e}function ir(t){let e=t.split("/");if(0===e.length)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let o=ir(i.join("/")),a=[];return a.push(...o.map((t=>""===t?s:[s,t].join("/")))),r&&a.push(...o),a.map((e=>t.startsWith("/")&&""===e?"/":e))}const rr=/^:\w+$/,sr=3,or=2,ar=1,cr=10,lr=-2,ur=t=>"*"===t;function hr(t,e){let n=t.split("/"),i=n.length;return n.some(ur)&&(i+=lr),e&&(i+=or),n.filter((t=>!ur(t))).reduce(((t,e)=>t+(rr.test(e)?sr:""===e?ar:cr)),i)}function dr(t,e){let{routesMeta:n}=t,i={},r="/",s=[];for(let o=0;o<n.length;++o){let t=n[o],a=o===n.length-1,c="/"===r?e:e.slice(r.length)||"/",l=pr({path:t.relativePath,caseSensitive:t.caseSensitive,end:a},c);if(!l)return null;Object.assign(i,l.params);let u=t.route;s.push({params:i,pathname:xr([r,l.pathname]),pathnameBase:br(xr([r,l.pathnameBase])),route:u}),"/"!==l.pathnameBase&&(r=xr([r,l.pathnameBase]))}return s}function pr(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);Yi("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,((t,e,n)=>(i.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));t.endsWith("*")?(i.push({paramName:"*"}),r+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==t&&"/"!==t&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,e?void 0:"i");return[s,i]}(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce(((t,e,n)=>{let{paramName:i,isOptional:r}=e;if("*"===i){let t=a[n]||"";o=s.slice(0,s.length-t.length).replace(/(.)\/+$/,"$1")}const c=a[n];return t[i]=r&&!c?void 0:function(t,e){try{return decodeURIComponent(t)}catch(n){return Yi(!1,'The value for the URL param "'+e+'" will not be decoded because the string "'+t+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),t}}(c||"",i),t}),{}),pathname:s,pathnameBase:o,pattern:t}}function fr(t){try{return decodeURI(t)}catch(e){return Yi(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function mr(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&"/"!==i?null:t.slice(n)||"/"}function gr(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function vr(t){return t.filter(((t,e)=>0===e||t.route.path&&t.route.path.length>0))}function yr(t,e,n,i){let r;void 0===i&&(i=!1),"string"===typeof t?r=Ji(t):(r=Gi({},t),Xi(!r.pathname||!r.pathname.includes("?"),gr("?","pathname","search",r)),Xi(!r.pathname||!r.pathname.includes("#"),gr("#","pathname","hash",r)),Xi(!r.search||!r.search.includes("#"),gr("#","search","hash",r)));let s,o=""===t||""===r.pathname,a=o?"/":r.pathname;if(null==a)s=n;else if(i){let t=e[e.length-1].replace(/^\//,"").split("/");if(a.startsWith("..")){let e=a.split("/");for(;".."===e[0];)e.shift(),t.pop();r.pathname=e.join("/")}s="/"+t.join("/")}else{let t=e.length-1;if(a.startsWith("..")){let e=a.split("/");for(;".."===e[0];)e.shift(),t-=1;r.pathname=e.join("/")}s=t>=0?e[t]:"/"}let c=function(t,e){void 0===e&&(e="/");let{pathname:n,search:i="",hash:r=""}="string"===typeof t?Ji(t):t,s=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:s,search:wr(i),hash:Sr(r)}}(r,s),l=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!u||(c.pathname+="/"),c}const xr=t=>t.join("/").replace(/\/\/+/g,"/"),br=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wr=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",Sr=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";Error;function _r(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const Tr=["post","put","patch","delete"],Er=(new Set(Tr),["get",...Tr]);new Set(Er),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Cr(){return Cr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Cr.apply(this,arguments)}const kr=e.createContext(null);const Ar=e.createContext(null);const Ir=e.createContext(null);const Or=e.createContext(null);const Rr=e.createContext({outlet:null,matches:[],isDataRoute:!1});const Nr=e.createContext(null);function Mr(){return null!=e.useContext(Or)}function Dr(){return Mr()||Xi(!1),e.useContext(Or).location}function Pr(t){e.useContext(Ir).static||e.useLayoutEffect(t)}function Fr(){let{isDataRoute:t}=e.useContext(Rr);return t?function(){let{router:t}=Hr(Gr.UseNavigateStable),n=Yr(qr.UseNavigateStable),i=e.useRef(!1);return Pr((()=>{i.current=!0})),e.useCallback((function(e,r){void 0===r&&(r={}),i.current&&("number"===typeof e?t.navigate(e):t.navigate(e,Cr({fromRouteId:n},r)))}),[t,n])}():function(){Mr()||Xi(!1);let t=e.useContext(kr),{basename:n,navigator:i}=e.useContext(Ir),{matches:r}=e.useContext(Rr),{pathname:s}=Dr(),o=JSON.stringify(vr(r).map((t=>t.pathnameBase))),a=e.useRef(!1);return Pr((()=>{a.current=!0})),e.useCallback((function(e,r){if(void 0===r&&(r={}),!a.current)return;if("number"===typeof e)return void i.go(e);let c=yr(e,JSON.parse(o),s,"path"===r.relative);null==t&&"/"!==n&&(c.pathname="/"===c.pathname?n:xr([n,c.pathname])),(r.replace?i.replace:i.push)(c,r.state,r)}),[n,i,o,s,t])}()}function Lr(){let{matches:t}=e.useContext(Rr),n=t[t.length-1];return n?n.params:{}}function Br(t,n,i){Mr()||Xi(!1);let{navigator:r}=e.useContext(Ir),{matches:s}=e.useContext(Rr),o=s[s.length-1],a=o?o.params:{},c=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let l,u=Dr();if(n){var h;let t="string"===typeof n?Ji(n):n;"/"===c||(null==(h=t.pathname)?void 0:h.startsWith(c))||Xi(!1),l=t}else l=u;let d=l.pathname||"/",p=er(t,{pathname:"/"===c?d:d.slice(c.length)||"/"});let f=Wr(p&&p.map((t=>Object.assign({},t,{params:Object.assign({},a,t.params),pathname:xr([c,r.encodeLocation?r.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?c:xr([c,r.encodeLocation?r.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),s,i);return n&&f?e.createElement(Or.Provider,{value:{location:Cr({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:qi.Pop}},f):f}function zr(){let t=function(){var t;let n=e.useContext(Nr),i=Xr(qr.UseRouteError),r=Yr(qr.UseRouteError);if(n)return n;return null==(t=i.errors)?void 0:t[r]}(),n=_r(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),i?e.createElement("pre",{style:s},i):null,null)}const Ur=e.createElement(zr,null);class jr extends e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error?e.createElement(Rr.Provider,{value:this.props.routeContext},e.createElement(Nr.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Vr(t){let{routeContext:n,match:i,children:r}=t,s=e.useContext(kr);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),e.createElement(Rr.Provider,{value:n},r)}function Wr(t,n,i){var r;if(void 0===n&&(n=[]),void 0===i&&(i=null),null==t){var s;if(null==(s=i)||!s.errors)return null;t=i.matches}let o=t,a=null==(r=i)?void 0:r.errors;if(null!=a){let t=o.findIndex((t=>t.route.id&&(null==a?void 0:a[t.route.id])));t>=0||Xi(!1),o=o.slice(0,Math.min(o.length,t+1))}return o.reduceRight(((t,r,s)=>{let c=r.route.id?null==a?void 0:a[r.route.id]:null,l=null;i&&(l=r.route.errorElement||Ur);let u=n.concat(o.slice(0,s+1)),h=()=>{let n;return n=c?l:r.route.Component?e.createElement(r.route.Component,null):r.route.element?r.route.element:t,e.createElement(Vr,{match:r,routeContext:{outlet:t,matches:u,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?e.createElement(jr,{location:i.location,revalidation:i.revalidation,component:l,error:c,children:h(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):h()}),null)}var Gr=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Gr||{}),qr=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(qr||{});function Hr(t){let n=e.useContext(kr);return n||Xi(!1),n}function Xr(t){let n=e.useContext(Ar);return n||Xi(!1),n}function Yr(t){let n=function(t){let n=e.useContext(Rr);return n||Xi(!1),n}(),i=n.matches[n.matches.length-1];return i.route.id||Xi(!1),i.route.id}n.startTransition;function Kr(t){Xi(!1)}function Qr(t){let{basename:n="/",children:i=null,location:r,navigationType:s=qi.Pop,navigator:o,static:a=!1}=t;Mr()&&Xi(!1);let c=n.replace(/^\/*/,"/"),l=e.useMemo((()=>({basename:c,navigator:o,static:a})),[c,o,a]);"string"===typeof r&&(r=Ji(r));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:f="default"}=r,m=e.useMemo((()=>{let t=mr(u,c);return null==t?null:{location:{pathname:t,search:h,hash:d,state:p,key:f},navigationType:s}}),[c,u,h,d,p,f,s]);return null==m?null:e.createElement(Ir.Provider,{value:l},e.createElement(Or.Provider,{children:i,value:m}))}function Zr(t){let{children:e,location:n}=t;return Br(Jr(e),n)}new Promise((()=>{}));e.Component;function Jr(t,n){void 0===n&&(n=[]);let i=[];return e.Children.forEach(t,((t,r)=>{if(!e.isValidElement(t))return;let s=[...n,r];if(t.type===e.Fragment)return void i.push.apply(i,Jr(t.props.children,s));t.type!==Kr&&Xi(!1),t.props.index&&t.props.children&&Xi(!1);let o={id:t.props.id||s.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=Jr(t.props.children,s)),i.push(o)})),i}var $r=__webpack_require__(7744),ts=__webpack_require__.n($r),es=__webpack_require__(6869);const ns={0:"C#0",1:"D#0",2:"F#0",3:"G#0",4:"A#0",5:"C#1",6:"D#1",7:"F#1",8:"G#1",9:"A#1",10:"C#2",11:"D#2",12:"F#2",13:"G#2",14:"A#2",15:"C#3",16:"D#3",17:"F#3",18:"G#3",19:"A#3",20:"C#4",21:"D#4",22:"F#4",23:"G#4",24:"A#4",25:"C#5",26:"D#5",27:"F#5",28:"G#5",29:"A#5",30:"C#6",31:"D#6",32:"F#6",33:"G#6",34:"A#6",35:"C#7",36:"D#7",37:"F#7",38:"G#7",39:"A#7",40:"C#8",41:"D#8",42:"F#8",43:"G#8",44:"A#8",45:"C#9",46:"D#9",47:"F#9"},is={12:"C0",13:"C#0",14:"D0",15:"D#0",16:"E0",17:"F0",18:"F#0",19:"G0",20:"G#0",21:"A0",22:"A#0",23:"B0",24:"C1",25:"C#1",26:"D1",27:"D#1",28:"E1",29:"F1",30:"F#1",31:"G1",32:"G#1",33:"A1",34:"A#1",35:"B1",36:"C2",37:"C#2",38:"D2",39:"D#2",40:"E2",41:"F2",42:"F#2",43:"G2",44:"G#2",45:"A2",46:"A#2",47:"B2",48:"C3",49:"C#3",50:"D3",51:"D#3",52:"E3",53:"F3",54:"F#3",55:"G3",56:"G#3",57:"A3",58:"A#3",59:"B3",60:"C4",61:"C#4",62:"D4",63:"D#4",64:"E4",65:"F4",66:"F#4",67:"G4",68:"G#4",69:"A4",70:"A#4",71:"B4",72:"C5",73:"C#5",74:"D5",75:"D#5",76:"E5",77:"F5",78:"F#5",79:"G5",80:"G#5",81:"A5",82:"A#5",83:"B5",84:"C6",85:"C#6",86:"D6",87:"D#6",88:"E6",89:"F6",90:"F#6",91:"G6",92:"G#6",93:"A6",94:"A#6",95:"B6",96:"C7",97:"C#7",98:"D7",99:"D#7",100:"E7",101:"F7",102:"F#7",103:"G7",104:"G#7",105:"A7",106:"A#7",107:"B7",108:"C8",109:"C#8",110:"D8",111:"D#8",112:"E8",113:"F8",114:"F#8",115:"G8",116:"G#8",117:"A8",118:"A#8",119:"B8",120:"C9",121:"C#9",122:"D9",123:"D#9",124:"E9",125:"F9",126:"F#9",127:"G9"},rs={0:"C0",1:"D0",2:"E0",3:"F0",4:"G0",5:"A0",6:"B0",7:"C1",8:"D1",9:"E1",10:"F1",11:"G1",12:"A1",13:"B1",14:"C2",15:"D2",16:"E2",17:"F2",18:"G2",19:"A2",20:"B2",21:"C3",22:"D3",23:"E3",24:"F3",25:"G3",26:"A3",27:"B3",28:"C4",29:"D4",30:"E4",31:"F4",32:"G4",33:"A4",34:"B4",35:"C5",36:"D5",37:"E5",38:"F5",39:"G5",40:"A5",41:"B5",42:"C6",43:"D6",44:"E6",45:"F6",46:"G6",47:"A6",48:"B6",49:"C7",50:"D7",51:"E7",52:"F7",53:"G7",54:"A7",55:"B7",56:"C8",57:"D8",58:"E8",59:"F8",60:"G8",61:"A8",62:"B8",63:"C9",64:"D9",65:"E9",66:"F9",67:"G9"};class ss{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.eventMap={},this.eventsSuspended=1==t}addListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof t&&t.length<1||t instanceof String&&t.length<1||"string"!==typeof t&&!(t instanceof String)&&t!==ss.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if("function"!==typeof e)throw new TypeError("The callback must be a function.");const i=new os(t,this,e,n);return this.eventMap[t]||(this.eventMap[t]=[]),n.prepend?this.eventMap[t].unshift(i):this.eventMap[t].push(i),i}addOneTimeListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.remaining=1,this.addListener(t,e,n)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,e){if(void 0===t)return!!(this.eventMap[ss.ANY_EVENT]&&this.eventMap[ss.ANY_EVENT].length>0)||Object.entries(this.eventMap).some((t=>{let[,e]=t;return e.length>0}));if(this.eventMap[t]&&this.eventMap[t].length>0){if(e instanceof os){let n=this.eventMap[t].filter((t=>t===e));return n.length>0}if("function"===typeof e){let n=this.eventMap[t].filter((t=>t.callback===e));return n.length>0}return void 0==e}return!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach((t=>{t.suspended=!0}))}unsuspendEvent(t){this.getListeners(t).forEach((t=>{t.suspended=!1}))}getListenerCount(t){return this.getListeners(t).length}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if("string"!==typeof t&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let r=[],s=this.eventMap[ss.ANY_EVENT]||[];return this.eventMap[t]&&(s=s.concat(this.eventMap[t])),s.forEach((t=>{if(t.suspended)return;let e=[...n];Array.isArray(t.arguments)&&(e=e.concat(t.arguments)),t.remaining>0&&(r.push(t.callback.apply(t.context,e)),t.count++),--t.remaining<1&&t.remove()})),r}removeListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===t)return void(this.eventMap={});if(!this.eventMap[t])return;let i=this.eventMap[t].filter((t=>e&&t.callback!==e||n.remaining&&n.remaining!==t.remaining||n.context&&n.context!==t.context));i.length?this.eventMap[t]=i:delete this.eventMap[t]}async waitFor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.duration=parseInt(e.duration),(isNaN(e.duration)||e.duration<=0)&&(e.duration=1/0),new Promise(((n,i)=>{let r,s=this.addListener(t,(()=>{clearTimeout(r),n()}),{remaining:1});e.duration!==1/0&&(r=setTimeout((()=>{s.remove(),i("The duration expired before the event was emitted.")}),e.duration))}))}get eventCount(){return Object.keys(this.eventMap).length}}class os{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("string"!==typeof t&&!(t instanceof String)&&t!==ss.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!e)throw new ReferenceError("The 'target' parameter is mandatory.");if("function"!==typeof n)throw new TypeError("The 'callback' must be a function.");void 0===i.arguments||Array.isArray(i.arguments)||(i.arguments=[i.arguments]),i=Object.assign({context:e,remaining:1/0,arguments:void 0,duration:1/0},i),i.duration!==1/0&&setTimeout((()=>this.remove()),i.duration),this.arguments=i.arguments,this.callback=n,this.context=i.context,this.count=0,this.event=t,this.remaining=parseInt(i.remaining)>=1?parseInt(i.remaining):1/0,this.suspended=!1,this.target=e}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class as{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),as.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),as.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),as.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),as.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}class cs{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.duration=gs.defaults.note.duration,this.attack=gs.defaults.note.attack,this.release=gs.defaults.note.release,void 0!=e.duration&&(this.duration=e.duration),void 0!=e.attack&&(this.attack=e.attack),void 0!=e.rawAttack&&(this.attack=ls.from7bitToFloat(e.rawAttack)),void 0!=e.release&&(this.release=e.release),void 0!=e.rawRelease&&(this.release=ls.from7bitToFloat(e.rawRelease)),Number.isInteger(t)?this.identifier=ls.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const e=ls.getNoteDetails(t);if(gs.validation&&!t)throw new Error("Invalid note identifier");this._name=e.name,this._accidental=e.accidental,this._octave=e.octave}get name(){return this._name}set name(t){if(gs.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(gs.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(gs.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(gs.validation&&(t=parseFloat(t),isNaN(t)||null===t||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(gs.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(gs.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return ls.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=ls.from7bitToFloat(t)}get rawRelease(){return ls.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=ls.from7bitToFloat(t)}get number(){return ls.toNoteNumber(this.identifier)}getOffsetNumber(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return gs.validation&&(t=parseInt(t)||0,e=parseInt(e)||0),Math.min(Math.max(this.number+12*t+e,0),127)}}class ls{static toNoteNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e=void 0==e?0:parseInt(e),isNaN(e))throw new RangeError("Invalid 'octaveOffset' value");"string"!==typeof t&&(t="");const n=this.getNoteDetails(t);if(!n)throw new TypeError("Invalid note identifier");let i=12*(n.octave+1+e);if(i+={C:0,D:2,E:4,F:5,G:7,A:9,B:11}[n.name],n.accidental&&(n.accidental.startsWith("b")?i-=n.accidental.length:i+=n.accidental.length),i<0||i>127)throw new RangeError("Invalid octaveOffset value");return i}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const e=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!e)throw new TypeError("Invalid note identifier");const n=e[1].toUpperCase(),i=parseInt(e[3]);let r=e[2].toLowerCase();r=""===r?void 0:r;return{accidental:r,identifier:n+(r||"")+i,name:n,octave:i}}static sanitizeChannels(t){let e;if(gs.validation)if("all"===t)e=["all"];else if("none"===t)return[];return e=Array.isArray(t)?t:[t],e.indexOf("all")>-1&&(e=as.MIDI_CHANNEL_NUMBERS),e.map((function(t){return parseInt(t)})).filter((function(t){return t>=1&&t<=16}))}static toTimestamp(t){let e=!1;const n=parseFloat(t);return!isNaN(n)&&("string"===typeof t&&"+"===t.substring(0,1)?n>=0&&(e=gs.time+n):n>=0&&(e=n),e)}static guessNoteNumber(t,e){e=parseInt(e)||0;let n=!1;if(Number.isInteger(t)&&t>=0&&t<=127)n=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)n=parseInt(t);else if("string"===typeof t||t instanceof String)try{n=this.toNoteNumber(t.trim(),e)}catch(i){return!1}return n}static toNoteIdentifier(t,e){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(e=void 0==e?0:parseInt(e),isNaN(e))throw new RangeError("Invalid octaveOffset value");const n=Math.floor(t/12-1)+e;return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t%12]+n.toString()}static buildNote(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.octaveOffset=parseInt(e.octaveOffset)||0,t instanceof cs)return t;let n=this.guessNoteNumber(t,e.octaveOffset);if(!1===n)throw new TypeError("The input could not be parsed as a note (".concat(t,")"));return e.octaveOffset=void 0,new cs(n,e)}static buildNoteArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return Array.isArray(t)||(t=[t]),t.forEach((t=>{n.push(this.buildNote(t,e))})),n}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(127*t),0),127)}static fromMsbLsbToFloat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;gs.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),e=Math.min(Math.max(parseInt(e)||0,0),127));const n=((t<<7)+e)/16383;return Math.min(Math.max(n,0),1)}static fromFloatToMsbLsb(t){gs.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const e=Math.round(16383*t);return{msb:e>>7,lsb:127&e}}static offsetNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(gs.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");e=parseInt(e)||0,n=parseInt(n)||0}return Math.min(Math.max(t+12*e+n,0),127)}static getPropertyByValue(t,e){return Object.keys(t).find((n=>t[n]===e))}static getCcNameByNumber(t){if(!gs.validation||(t=parseInt(t))>=0&&t<=127)return as.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let e=as.CONTROL_CHANGE_MESSAGES.find((e=>e.name===t));return e?e.number:as.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let e in as.CHANNEL_MODE_MESSAGES)if(as.CHANNEL_MODE_MESSAGES.hasOwnProperty(e)&&t===as.CHANNEL_MODE_MESSAGES[e])return e;return!1}static get isNode(){return"undefined"!==typeof process&&null!=process.versions&&null!=process.versions.node}static get isBrowser(){return"undefined"!==typeof window&&"undefined"!==typeof window.document}}class us extends ss{constructor(t,e){super(),this._output=t,this._number=e,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{time:0};return this.output.send(t,e),this}sendKeyAftertouch(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation){if(n.useRawValue&&(n.rawValue=n.useRawValue),isNaN(parseFloat(e)))throw new RangeError("Invalid key aftertouch value.");if(n.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}n.rawValue||(e=ls.fromFloatTo7Bit(e));const i=gs.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),ls.buildNoteArray(t).forEach((t=>{this.send([(as.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),t.getOffsetNumber(i),e],{time:ls.toTimestamp(n.time)})})),this}sendControlChange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof t&&(t=ls.getCcNumberByName(t)),Array.isArray(e)||(e=[e]),gs.validation){if(void 0===t)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(2===(e=e.map((t=>{const e=Math.min(Math.max(parseInt(t),0),127);if(isNaN(e))throw new TypeError("Values must be integers between 0 and 127");return e}))).length&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return e.forEach(((i,r)=>{this.send([(as.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+32*r,e[r]],{time:ls.toTimestamp(n.time)})})),this}_selectNonRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.sendControlChange(99,t[0],e),this.sendControlChange(98,t[1],e),this}_deselectRegisteredParameter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.sendControlChange(101,t[0],e),this.sendControlChange(100,t[1],e),this}_setCurrentParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=[].concat(t),this.sendControlChange(6,t[0],e),t.length<2||this.sendControlChange(38,t[1],e),this}sendRpnDecrement(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t)||(t=as.REGISTERED_PARAMETERS[t]),gs.validation){if(void 0===t)throw new TypeError("The specified registered parameter is invalid.");let e=!1;if(Object.getOwnPropertyNames(as.REGISTERED_PARAMETERS).forEach((n=>{as.REGISTERED_PARAMETERS[n][0]===t[0]&&as.REGISTERED_PARAMETERS[n][1]===t[1]&&(e=!0)})),!e)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,e),this.sendControlChange(97,0,e),this._deselectRegisteredParameter(e),this}sendRpnIncrement(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(t)||(t=as.REGISTERED_PARAMETERS[t]),gs.validation){if(void 0===t)throw new TypeError("The specified registered parameter is invalid.");let e=!1;if(Object.getOwnPropertyNames(as.REGISTERED_PARAMETERS).forEach((n=>{as.REGISTERED_PARAMETERS[n][0]===t[0]&&as.REGISTERED_PARAMETERS[n][1]===t[1]&&(e=!0)})),!e)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,e),this.sendControlChange(96,0,e),this._deselectRegisteredParameter(e),this}playNote(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.sendNoteOn(t,e);const n=Array.isArray(t)?t:[t];for(let i of n)if(parseInt(i.duration)>0){const t={time:(ls.toTimestamp(e.time)||gs.time)+parseInt(i.duration),release:i.release,rawRelease:i.rawRelease};this.sendNoteOff(i,t)}else if(parseInt(e.duration)>0){const t={time:(ls.toTimestamp(e.time)||gs.time)+parseInt(e.duration),release:e.release,rawRelease:e.rawRelease};this.sendNoteOff(i,t)}return this}sendNoteOff(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation){if(void 0!=e.rawRelease&&!(e.rawRelease>=0&&e.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(void 0!=e.release&&!(e.release>=0&&e.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");e.rawVelocity&&(e.rawRelease=e.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),e.velocity&&(e.release=e.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;void 0!=e.rawRelease?n=e.rawRelease:isNaN(e.release)||(n=Math.round(127*e.release));const i=gs.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ls.buildNoteArray(t,{rawRelease:parseInt(n)}).forEach((t=>{this.send([(as.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),t.getOffsetNumber(i),t.rawRelease],{time:ls.toTimestamp(e.time)})})),this}stopNote(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.sendNoteOff(t,e)}sendNoteOn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation){if(void 0!=e.rawAttack&&!(e.rawAttack>=0&&e.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(void 0!=e.attack&&!(e.attack>=0&&e.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");e.rawVelocity&&(e.rawAttack=e.velocity,e.rawRelease=e.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),e.velocity&&(e.attack=e.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;void 0!=e.rawAttack?n=e.rawAttack:isNaN(e.attack)||(n=Math.round(127*e.attack));const i=gs.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ls.buildNoteArray(t,{rawAttack:n}).forEach((t=>{this.send([(as.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),t.getOffsetNumber(i),t.rawAttack],{time:ls.toTimestamp(e.time)})})),this}sendChannelMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof t&&(t=as.CHANNEL_MODE_MESSAGES[t]),gs.validation){if(void 0===t)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(e))||e<0||e>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(as.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,e],{time:ls.toTimestamp(n.time)}),this}sendOmniMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===t||t?this.sendChannelMode("omnimodeon",0,e):this.sendChannelMode("omnimodeoff",0,e),this}sendChannelAftertouch(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(e.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return this.send([(as.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(127*t)],{time:ls.toTimestamp(e.time)}),this}sendMasterTuning(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=parseFloat(t)||0,gs.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let n=Math.floor(t)+64,i=t-Math.floor(t);i=Math.round((i+1)/2*16383);let r=i>>7&127,s=127&i;return this.sendRpnValue("channelcoarsetuning",n,e),this.sendRpnValue("channelfinetuning",[r,s],e),this}sendModulationRange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(void 0!=e&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return e>=0&&e<=127||(e=0),this.sendRpnValue("modulationrange",[t,e],n),this}sendNrpnValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e=[].concat(e),gs.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");e.forEach((t=>{if(!(t>=0&&t<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")}))}return this._selectNonRegisteredParameter(t,n),this._setCurrentParameter(e,n),this._deselectNonRegisteredParameter(n),this}sendPitchBend(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation)if(e.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(e.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||null===t)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let n=0,i=0;if(e.rawValue&&Array.isArray(t))n=t[0],i=t[1];else if(e.rawValue&&!Array.isArray(t))n=t;else{const e=ls.fromFloatToMsbLsb((t+1)/2);n=e.msb,i=e.lsb}return this.send([(as.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),i,n],{time:ls.toTimestamp(e.time)}),this}sendPitchBendRange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,e],n),this}sendProgramChange(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=parseInt(t)||0,gs.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(as.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:ls.toTimestamp(e.time)}),this}sendRpnValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Array.isArray(t)||(t=as.REGISTERED_PARAMETERS[t]),gs.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(e).forEach((t=>{if(!(t>=0&&t<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")}))}return this._selectRegisteredParameter(t,n),this._setCurrentParameter(e,n),this._deselectRegisteredParameter(n),this}sendTuningBank(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,e),this}sendTuningProgram(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,e),this}sendLocalControl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?this.sendChannelMode("localcontrol",127,e):this.sendChannelMode("localcontrol",0,e)}sendAllNotesOff(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"mono"===t?this.sendChannelMode("monomodeon",0,e):this.sendChannelMode("polymodeon",0,e)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}class hs extends ss{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let e=1;e<=16;e++)this.channels[e]=new us(this,e);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach((t=>t.destroy())),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let e={timestamp:gs.time};"open"===t.port.connection?(e.type="opened",e.target=this,e.port=e.target,this.emit("opened",e)):"closed"===t.port.connection&&"connected"===t.port.state?(e.type="closed",e.target=this,e.port=e.target,this.emit("closed",e)):"closed"===t.port.connection&&"disconnected"===t.port.state?(e.type="disconnected",e.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",e)):"pending"===t.port.connection&&"disconnected"===t.port.state||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{time:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t instanceof fs&&(t=ls.isNode?t.data:t.rawData),t instanceof Uint8Array&&ls.isNode&&(t=Array.from(t)),gs.validation){if(Array.isArray(t)||t instanceof Uint8Array||(t=[t],Array.isArray(e)&&(t=t.concat(e)),e=isNaN(n)?{time:0}:{time:n}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach((t=>{if(!((t=parseInt(t))>=0&&t<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")})),e||(e={time:0})}return this._midiOutput.send(t,ls.toTimestamp(e.time)),this}sendSysex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t=[].concat(t),e instanceof Uint8Array){const i=new Uint8Array(1+t.length+e.length+1);i[0]=as.SYSTEM_MESSAGES.sysex,i.set(Uint8Array.from(t),1),i.set(e,1+t.length),i[i.length-1]=as.SYSTEM_MESSAGES.sysexend,this.send(i,{time:n.time})}else{const i=t.concat(e,as.SYSTEM_MESSAGES.sysexend);this.send([as.SYSTEM_MESSAGES.sysex].concat(i),{time:n.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():gs.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([as.SYSTEM_MESSAGES.timecode,t],{time:e.time}),this}sendSongPosition(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Math.floor(t)||0;var n=t>>7&127,i=127&t;return this.send([as.SYSTEM_MESSAGES.songposition,n,i],{time:e.time}),this}sendSongSelect(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([as.SYSTEM_MESSAGES.songselect,t],{time:e.time}),this}sendTuneRequest(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send([as.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gs.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendKeyAftertouch(t,e,n)})),this}sendControlChange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(gs.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){const t=n;n=i,n.channels=t,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendControlChange(t,e,n)})),this}sendPitchBendRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendPitchBendRange(t,e,n)})),this}setPitchBendRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return gs.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),i.channels=n,"all"===i.channels&&(i.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,e,i)}sendRpnValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendRpnValue(t,e,n)})),this}setRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return gs.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),i.channels=n,"all"===i.channels&&(i.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,e,i)}sendChannelAftertouch(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendChannelAftertouch(t,e)})),this}sendPitchBend(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendPitchBend(t,e)})),this}sendProgramChange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendProgramChange(t,e)})),this}sendModulationRange(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendModulationRange(t,e,n)})),this}setModulationRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return gs.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),i.channels=n,"all"===i.channels&&(i.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,e,i)}sendMasterTuning(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendMasterTuning(t,e)})),this}setMasterTuning(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return gs.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),n.channels=e,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,n)}sendTuningProgram(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendTuningProgram(t,e)})),this}setTuningProgram(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return gs.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),n.channels=e,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,n)}sendTuningBank(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendTuningBank(t,e)})),this}setTuningBank(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return gs.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),n.channels=e,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,n)}sendChannelMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(gs.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){const t=n;n=i,n.channels=t,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendChannelMode(t,e,n)})),this}sendAllSoundOff(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0==t.channels&&(t.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(t.channels).forEach((e=>{this.channels[e].sendAllSoundOff(t)})),this}sendAllNotesOff(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0==t.channels&&(t.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(t.channels).forEach((e=>{this.channels[e].sendAllNotesOff(t)})),this}sendResetAllControllers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gs.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){const n=t;t=e,t.channels=n,"all"===t.channels&&(t.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==t.channels&&(t.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(t.channels).forEach((e=>{this.channels[e].sendResetAllControllers(t)})),this}sendPolyphonicMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendPolyphonicMode(t,e)})),this}sendLocalControl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendLocalControl(t,e)})),this}sendOmniMode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendOmniMode(t,e)})),this}sendNrpnValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0==n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].sendNrpnValue(t,e,n)})),this}setNonRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return gs.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),i.channels=n,"all"===i.channels&&(i.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,e,i)}sendRpnIncrement(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendRpnIncrement(t,e)})),this}incrementRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return gs.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),n.channels=e,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,n)}sendRpnDecrement(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendRpnDecrement(t,e)})),this}decrementRegisteredParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return gs.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),n.channels=e,"all"===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,n)}sendNoteOff(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendNoteOff(t,e)})),this}stopNote(t,e){return this.sendNoteOff(t,e)}playNote(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(e.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),e.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].playNote(t,e)})),this}sendNoteOn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){const t=e;e=n,e.channels=t,"all"===e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS)}return void 0==e.channels&&(e.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(e.channels).forEach((n=>{this.channels[n].sendNoteOn(t,e)})),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}class ds{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.destinations=[],this.types=[...Object.keys(as.SYSTEM_MESSAGES),...Object.keys(as.CHANNEL_MESSAGES)],this.channels=as.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),e.types&&!Array.isArray(e.types)&&(e.types=[e.types]),e.channels&&!Array.isArray(e.channels)&&(e.channels=[e.channels]),gs.validation&&(t.forEach((t=>{if(!(t instanceof hs))throw new TypeError("Destinations must be of type 'Output'.")})),void 0!==e.types&&e.types.forEach((t=>{if(!as.SYSTEM_MESSAGES.hasOwnProperty(t)&&!as.CHANNEL_MESSAGES.hasOwnProperty(t))throw new TypeError("Type must be a valid message type.")})),void 0!==e.channels&&e.channels.forEach((t=>{if(!as.MIDI_CHANNEL_NUMBERS.includes(t))throw new TypeError("MIDI channel must be between 1 and 16.")}))),this.destinations=t,e.types&&(this.types=e.types),e.channels&&(this.channels=e.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach((e=>{(!gs.validation||e instanceof hs)&&e.send(t)})))}}class ps extends ss{constructor(t,e){super(),this._input=t,this._number=e,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const e=Object.assign({},t);e.port=this.input,e.target=this,e.type="midimessage",this.emit(e.type,e),this._parseEventForStandardMessages(e)}_parseEventForStandardMessages(t){const e=Object.assign({},t);e.type=e.message.type||"unknownmessage";const n=t.message.dataBytes[0],i=t.message.dataBytes[1];if("noteoff"===e.type||"noteon"===e.type&&0===i)this.notesState[n]=!1,e.type="noteoff",e.note=new cs(ls.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+gs.octaveOffset),{rawAttack:0,rawRelease:i}),e.value=ls.from7bitToFloat(i),e.rawValue=i,e.velocity=e.note.release,e.rawVelocity=e.note.rawRelease;else if("noteon"===e.type)this.notesState[n]=!0,e.note=new cs(ls.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+gs.octaveOffset),{rawAttack:i}),e.value=ls.from7bitToFloat(i),e.rawValue=i,e.velocity=e.note.attack,e.rawVelocity=e.note.rawAttack;else if("keyaftertouch"===e.type)e.note=new cs(ls.offsetNumber(n,this.octaveOffset+this.input.octaveOffset+gs.octaveOffset)),e.value=ls.from7bitToFloat(i),e.rawValue=i,e.identifier=e.note.identifier,e.key=e.note.number,e.rawKey=n;else if("controlchange"===e.type){e.controller={number:n,name:as.CONTROL_CHANGE_MESSAGES[n].name,description:as.CONTROL_CHANGE_MESSAGES[n].description,position:as.CONTROL_CHANGE_MESSAGES[n].position},e.subtype=e.controller.name||"controller"+n,e.value=ls.from7bitToFloat(i),e.rawValue=i;const t=Object.assign({},e);t.type="".concat(e.type,"-controller").concat(n),delete t.subtype,this.emit(t.type,t);const r=Object.assign({},e);r.type="".concat(e.type,"-")+as.CONTROL_CHANGE_MESSAGES[n].name,delete r.subtype,0!==r.type.indexOf("controller")&&this.emit(r.type,r),e.message.dataBytes[0]>=120&&this._parseChannelModeMessage(e),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(e.message.dataBytes[0])&&this._parseEventForParameterNumber(e)}else"programchange"===e.type?(e.value=n,e.rawValue=e.value):"channelaftertouch"===e.type?(e.value=ls.from7bitToFloat(n),e.rawValue=n):"pitchbend"===e.type?(e.value=((i<<7)+n-8192)/8192,e.rawValue=(i<<7)+n):e.type="unknownmessage";this.emit(e.type,e)}_parseChannelModeMessage(t){const e=Object.assign({},t);e.type=e.controller.name,"localcontrol"===e.type&&(e.value=127===e.message.data[2],e.rawValue=e.message.data[2]),"omnimodeon"===e.type?(e.type="omnimode",e.value=!0,e.rawValue=e.message.data[2]):"omnimodeoff"===e.type&&(e.type="omnimode",e.value=!1,e.rawValue=e.message.data[2]),"monomodeon"===e.type?(e.type="monomode",e.value=!0,e.rawValue=e.message.data[2]):"polymodeon"===e.type&&(e.type="monomode",e.value=!1,e.rawValue=e.message.data[2]),this.emit(e.type,e)}_parseEventForParameterNumber(t){const e=t.message.dataBytes[0],n=t.message.dataBytes[1];99===e||101===e?(this._nrpnBuffer=[],this._rpnBuffer=[],99===e?this._nrpnBuffer=[t.message]:127!==n&&(this._rpnBuffer=[t.message])):98===e||100===e?98===e?(this._rpnBuffer=[],1===this._nrpnBuffer.length?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],1===this._rpnBuffer.length&&127!==n?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):6!==e&&38!==e&&96!==e&&97!==e||(2===this._rpnBuffer.length?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):2===this._nrpnBuffer.length?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return 6===t||38===t||96===t||97===t||98===t||99===t||100===t||101===t}_dispatchParameterNumberEvent(t,e,n,i){t="nrpn"===t?"nrpn":"rpn";const r={target:i.target,timestamp:i.timestamp,message:i.message,parameterMsb:e,parameterLsb:n,value:ls.from7bitToFloat(i.message.dataBytes[1]),rawValue:i.message.dataBytes[1]};r.parameter="rpn"===t?Object.keys(as.REGISTERED_PARAMETERS).find((t=>as.REGISTERED_PARAMETERS[t][0]===e&&as.REGISTERED_PARAMETERS[t][1]===n)):(e<<7)+n;const s=as.CONTROL_CHANGE_MESSAGES[i.message.dataBytes[0]].name;r.type="".concat(t,"-").concat(s),this.emit(r.type,r);const o=Object.assign({},r);"nrpn-dataincrement"===o.type?o.type="nrpn-databuttonincrement":"nrpn-datadecrement"===o.type?o.type="nrpn-databuttondecrement":"rpn-dataincrement"===o.type?o.type="rpn-databuttonincrement":"rpn-datadecrement"===o.type&&(o.type="rpn-databuttondecrement"),this.emit(o.type,o),r.type=t,r.subtype=s,this.emit(r.type,r)}getChannelModeByNumber(t){return gs.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),ls.getChannelModeByNumber(t)}getCcNameByNumber(t){if(gs.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),!((t=parseInt(t))>=0&&t<=127)))throw new RangeError("Invalid control change number.");return ls.getCcNameByNumber(t)}getNoteState(t){t instanceof cs&&(t=t.identifier);const e=ls.guessNoteNumber(t,gs.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[e]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}class fs{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=1+(15&this.statusByte)):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=ls.getPropertyByValue(as.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=ls.getPropertyByValue(as.SYSTEM_MESSAGES,this.command)),this.statusByte===as.SYSTEM_MESSAGES.sysex&&(0===this.dataBytes[0]?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}class ms extends ss{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let e=1;e<=16;e++)this.channels[e]=new ps(this,e);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach((t=>t.destroy())),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let e={timestamp:gs.time,target:this,port:this};"open"===t.port.connection?(e.type="opened",this.emit("opened",e)):"closed"===t.port.connection&&"connected"===t.port.state?(e.type="closed",this.emit("closed",e)):"closed"===t.port.connection&&"disconnected"===t.port.state?(e.type="disconnected",e.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",e)):"pending"===t.port.connection&&"disconnected"===t.port.state||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const e=new fs(t.data),n={port:this,target:this,message:e,timestamp:t.timeStamp,type:"midimessage",data:e.data,rawData:e.data,statusByte:e.data[0],dataBytes:e.dataBytes};this.emit("midimessage",n),e.isSystemMessage?this._parseEvent(n):e.isChannelMessage&&this.channels[e.channel]._processMidiMessageEvent(n),this._forwarders.forEach((t=>t.forward(e)))}_parseEvent(t){const e=Object.assign({},t);e.type=e.message.type||"unknownmidimessage","songselect"===e.type&&(e.song=t.data[1]+1,e.value=t.data[1],e.rawValue=e.value),this.emit(e.type,e)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){gs.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&"function"===typeof n){let t=void 0!=e?[].concat(e):void 0;e=n,n={channels:t}}if(as.CHANNEL_EVENTS.includes(t)){void 0===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS);let i=[];return ls.sanitizeChannels(n.channels).forEach((r=>{i.push(this.channels[r].addListener(t,e,n))})),i}return super.addListener(t,e,n)}addOneTimeListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.remaining=1,this.addListener(t,e,n)}on(t,e,n,i){return this.addListener(t,e,n,i)}hasListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&"function"===typeof n){let t=[].concat(e);e=n,n={channels:t}}return as.CHANNEL_EVENTS.includes(t)?(void 0===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),ls.sanitizeChannels(n.channels).every((n=>this.channels[n].hasListener(t,e)))):super.hasListener(t,e)}removeListener(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(gs.validation&&"function"===typeof n){let t=[].concat(e);e=n,n={channels:t}}if(void 0===n.channels&&(n.channels=as.MIDI_CHANNEL_NUMBERS),void 0==t)return ls.sanitizeChannels(n.channels).forEach((t=>{this.channels[t]&&this.channels[t].removeListener()})),super.removeListener();as.CHANNEL_EVENTS.includes(t)?ls.sanitizeChannels(n.channels).forEach((i=>{this.channels[i].removeListener(t,e,n)})):super.removeListener(t,e,n)}addForwarder(t){let e;return e=t instanceof ds?t:new ds(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this._forwarders.push(e),e}removeForwarder(t){this._forwarders=this._forwarders.filter((e=>e!==t))}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return gs.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}const gs=new class extends ss{constructor(){super(),this.defaults={note:{attack:ls.from7bitToFloat(64),release:ls.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ls.isNode){try{window.navigator}catch(s){let t=await Object.getPrototypeOf((async function(){})).constructor('\n        let jzz = await import("jzz");\n        return jzz.default;\n        ')();global.navigator||(global.navigator={}),Object.assign(global.navigator,t)}try{performance}catch(s){global.performance=await Object.getPrototypeOf((async function(){})).constructor('\n        let perf_hooks = await import("perf_hooks");\n        return perf_hooks.performance;\n        ')()}}if(this.validation=!1!==t.validation,this.validation&&("function"===typeof t&&(t={callback:t,sysex:e}),e&&(t.sysex=!0)),this.enabled)return"function"===typeof t.callback&&t.callback(),Promise.resolve();const n={timestamp:this.time,target:this,type:"error",error:void 0},i={timestamp:this.time,target:this,type:"midiaccessgranted"},r={timestamp:this.time,target:this,type:"enabled"};try{"function"===typeof t.requestMIDIAccessFunction?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(s){return n.error=s,this.emit("error",n),"function"===typeof t.callback&&t.callback(s),Promise.reject(s)}this.emit("midiaccessgranted",i),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(s){return n.error=s,this.emit("error",n),"function"===typeof t.callback&&t.callback(s),Promise.reject(s)}return this.emit("enabled",r),"function"===typeof t.callback&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then((()=>{navigator&&"function"===typeof navigator.close&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()}))}getInputById(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{disconnected:!1};if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(e.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(this._disconnectedInputs[n].id===t.toString())return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(this.inputs[n].id===t.toString())return this.inputs[n]}getInputByName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{disconnected:!1};if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(e.disconnected){for(let n=0;n<this._disconnectedInputs.length;n++)if(~this._disconnectedInputs[n].name.indexOf(t))return this._disconnectedInputs[n]}else for(let n=0;n<this.inputs.length;n++)if(~this.inputs[n].name.indexOf(t))return this.inputs[n]}getOutputByName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{disconnected:!1};if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(e.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(~this._disconnectedOutputs[n].name.indexOf(t))return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(~this.outputs[n].name.indexOf(t))return this.outputs[n]}getOutputById(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{disconnected:!1};if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(e.disconnected){for(let n=0;n<this._disconnectedOutputs.length;n++)if(this._disconnectedOutputs[n].id===t.toString())return this._disconnectedOutputs[n]}else for(let n=0;n<this.outputs.length;n++)if(this.outputs[n].id===t.toString())return this.outputs[n]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),ls.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127&&ls.getNoteDetails(ls.offsetNumber(t,this.octaveOffset)).octave}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),ls.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),ls.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),ls.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),ls.buildNoteArray(t,e)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),ls.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach((e=>t.push(e.destroy()))),this.outputs.forEach((e=>t.push(e.destroy()))),Promise.all(t).then((()=>{this._inputs=[],this._outputs=[]}))}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let e={timestamp:t.timeStamp,type:t.port.state,target:this};if("connected"===t.port.state&&"open"===t.port.connection){"output"===t.port.type?e.port=this.getOutputById(t.port.id):"input"===t.port.type&&(e.port=this.getInputById(t.port.id)),this.emit(t.port.state,e);const n=Object.assign({},e);n.type="portschanged",this.emit(n.type,n)}else if("disconnected"===t.port.state&&"pending"===t.port.connection){"input"===t.port.type?e.port=this.getInputById(t.port.id,{disconnected:!0}):"output"===t.port.type&&(e.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,e);const n=Object.assign({},e);n.type="portschanged",this.emit(n.type,n)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let e=this._inputs.length-1;e>=0;e--){const t=this._inputs[e];Array.from(this.interface.inputs.values()).find((e=>e===t._midiInput))||(this._disconnectedInputs.push(t),this._inputs.splice(e,1))}let t=[];return this.interface.inputs.forEach((e=>{if(!this._inputs.find((t=>t._midiInput===e))){let n=this._disconnectedInputs.find((t=>t._midiInput===e));n||(n=new ms(e)),this._inputs.push(n),t.push(n.open())}})),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let e=this._outputs.length-1;e>=0;e--){const t=this._outputs[e];Array.from(this.interface.outputs.values()).find((e=>e===t._midiOutput))||(this._disconnectedOutputs.push(t),this._outputs.splice(e,1))}let t=[];return this.interface.outputs.forEach((e=>{if(!this._outputs.find((t=>t._midiOutput===e))){let n=this._disconnectedOutputs.find((t=>t._midiOutput===e));n||(n=new hs(e)),this._outputs.push(n),t.push(n.open())}})),Promise.all(t)}get enabled(){return null!==this.interface}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),ls.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),ls.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return"undefined"!==typeof navigator&&navigator.requestMIDIAccess}get sysexEnabled(){return!(!this.interface||!this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.7"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),as.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),as.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),as.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),as.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),as.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}};gs.constructor=null,es.context.lookAhead=0;class vs{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;this.tone=new es.Sampler({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/",onload:()=>{this.tone.triggerAttackRelease(["C5"],.05)}}).toDestination(),this.w_notes=[],this.b_notes=[],this.octave=0,this.start_idx=i,this.num=r,this.num>10&&(this.num=10),this.num+this.start_idx>10&&(this.num=this.num-this.start_idx),this.o_w=e/this.num;let{s_w:s,s_h:o}={s_w:e/this.num/7,s_h:.2*n};for(let c=0;c<this.num;c++){for(let e=0;e<7;e++)this.w_notes.push(new ys(t,7*c*s+e*s+s/2,n-o/2,s,o,16777215,{b_width:2,b_color:0}));for(let e=0;e<6;e++)2!==e&&this.b_notes.push(t.add.rectangle(7*c*s+e*s+s,n-.75*o,s/2,o/2,0).setDepth(3))}this.boundKeydown=this.onKeydown.bind(this),this.boundKeyup=this.onKeyup.bind(this);for(let c=1;c<=this.num;c++)t.add.rectangle(7*s*c,0,1,n,16777215,.15).setDepth(1).setOrigin(0,0);this.texts=[];const a=18;this.texts.push(t.add.text(0*s+s/2-.3*a,n-o+5,"A",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(1*s+s/2-.3*a,n-o+5,"S",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(2*s+s/2-.3*a,n-o+5,"D",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(3*s+s/2-.3*a,n-o+5,"F",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(4*s+s/2-.3*a,n-o+5,"G",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(5*s+s/2-.3*a,n-o+5,"H",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(6*s+s/2-.3*a,n-o+5,"J",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(7*s+s/2-.3*a,n-o+5,"K",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(8*s+s/2-.3*a,n-o+5,"L",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(9*s+s/2-.3*a,n-o+5,";",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(10*s+s/2-.3*a,n-o+5,"'",{fill:"#000000"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(1*s-.3*a,n-o+5,"W",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(2*s-.3*a,n-o+5,"E",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(4*s-.3*a,n-o+5,"T",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(5*s-.3*a,n-o+5,"Y",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(6*s-.3*a,n-o+5,"U",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(8*s-.3*a,n-o+5,"O",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.texts.push(t.add.text(9*s-.3*a,n-o+5,"P",{fill:"#FFFFFF"}).setDepth(4).setFontSize(a)),this.users=[],this.colors=[16031390,16433824,15985323,11593395,11068138,10991855]}webMidiEnable(t){}setInput(t){t.removeEventListener("keydown",this.boundKeydown),t.removeEventListener("keyup",this.boundKeyup),t.addEventListener("keydown",this.boundKeydown),t.addEventListener("keyup",this.boundKeyup);const e=this;gs.enable((function(t){const n=window.location.protocol;if(t||"https:"!==n)return void console.log("WebMidi could not be enabled.",t);console.log("WebMidi enabled!"),console.log(gs.inputs),console.log(e);const i=gs.inputs[0],r=(t,n)=>{const i=(t-=48)%12,r=Math.floor(t/12);let s=0,o=0;switch(i){case 0:s=0;break;case 1:s=0,o=1;break;case 2:s=1;break;case 3:s=1,o=1;break;case 4:s=2;break;case 5:s=3;break;case 6:s=2,o=1;break;case 7:s=4;break;case 8:s=3,o=1;break;case 9:s=5;break;case 10:s=4,o=1;break;case 11:s=6;break;default:return}"down"===n?e.pushNote(s,o,r,0):"up"===n&&e.releaseNote(s,o,r,0)};i.addListener("noteon",(t=>{r(t.data[1],"down")}),{channels:[1]}),i.addListener("noteoff",(t=>{r(t.data[1],"up")}),{channels:[1]})}))}removeInput(t){t.removeEventListener("keydown",this.boundKeydown),t.removeEventListener("keyup",this.boundKeyup)}onKeydown(t){if(t.repeat)return;if(!0!==this.tone.loaded)return;const e=t.key.charCodeAt(0);this.handleKey(e,"down",this.octave,this.start_idx)}onKeyup(t){if(t.repeat)return;if(!0!==this.tone.loaded)return;const e=t.key.charCodeAt(0);if(120===e&this.octave<this.num-1){for(let t=0;t<7;t++)this.w_notes[t+7*this.octave].getRect().setFillStyle(16777215);for(let t=0;t<5;t++)this.b_notes[t+5*this.octave].setFillStyle(0);this.octave+=1;for(let t=0;t<18;t++)this.texts[t].setX(this.texts[t].x+this.o_w)}else if(122===e&&this.octave>0){for(let t=0;t<7;t++)this.w_notes[t+7*this.octave].getRect().setFillStyle(16777215);for(let t=0;t<5;t++)this.b_notes[t+5*this.octave].setFillStyle(0);this.octave-=1;for(let t=0;t<18;t++)this.texts[t].setX(this.texts[t].x-this.o_w)}else this.handleKey(e,"up",this.octave,this.start_idx)}handleKey(t,e){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4?arguments[4]:void 0,o=0;switch(t){case 97:n=0;break;case 115:n=1;break;case 100:n=2;break;case 102:n=3;break;case 103:n=4;break;case 104:n=5;break;case 106:n=6;break;case 107:n=7;break;case 108:n=8;break;case 59:n=9;break;case 39:n=10;break;case 119:n=0,o=1;break;case 101:n=1,o=1;break;case 116:n=2,o=1;break;case 121:n=3,o=1;break;case 117:n=4,o=1;break;case 111:n=5,o=1;break;case 112:n=6,o=1;break;default:return}"down"===e?this.pushNote(n,o,i,r,s):"up"===e&&this.releaseNote(n,o,i,r)}pushNote(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=-1;if(s=this.users.findIndex((t=>t==r)),-1==s&&(this.users.push(r),s=this.users.findIndex((t=>t==r))),console.log(this.users),0===e){if(console.log("%d %d %d",n,i,t),t+7*(n+i)>=7*(i+this.num))return;this.w_notes[t+7*n].getRect().setFillStyle(this.colors[s%6]),t+=7*(n+i>8?8:n+i),this.tone.triggerAttack([rs[t]])}else{if(t+7*(n+i)>=7*(i+this.num)-2)return;this.b_notes[t+5*n].setFillStyle(this.colors[s%6]),t+=5*(n+i>8?8:n+i),this.tone.triggerAttack([ns[t]])}}releaseNote(t){let e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(0===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)){if(t+7*(e+n)>=7*(n+this.num))return;this.w_notes[t+7*e].getRect().setFillStyle(16777215),t+=7*(e+n>8?8:e+n),this.tone.triggerRelease([rs[t]])}else{if(t+7*(e+n)>=7*(n+this.num)-2)return;this.b_notes[t+5*e].setFillStyle(0),t+=5*(e+n>8?8:e+n),this.tone.triggerRelease([ns[t]])}}destroy(){this.tone.dispose(),this.boundKeydown&&document.removeEventListener("keydown",this.boundKeydown),this.boundKeyup&&document.removeEventListener("keyup",this.boundKeyup);for(const t of this.w_notes)t.getRect().destroy();for(const t of this.b_notes)t.destroy();this.w_notes=[],this.b_notes=[],gs.disable()}}class ys{constructor(t,e,n,i,r,s,o){this.rect=t.add.rectangle(e,n,i,r,s).setDepth(2),this.board=t.add.graphics().setDepth(3);const{b_width:a,b_color:c}=o;this.board.lineStyle(a,c),this.board.strokeRect(e-i/2,n-r/2,i,r)}getRect(){return this.rect}}var xs=__webpack_require__(184);const bs=()=>{const t=(0,e.useRef)(null);let n;function i(){}function r(){let{width:t,height:e}=this.sys.game.canvas;n=new vs(this,t,e),n.setInput(document)}function s(){}return(0,e.useEffect)((()=>{const e={type:ts().AUTO,transparent:!1,scene:{preload:i,create:r,update:s},scale:{parent:"gamediv",mode:ts().Scale.RESIZE}};t.current=new(ts().Game)(e)}),[]),(0,xs.jsx)("div",{ref:t})},ws=()=>{let{midiId:t}=Lr();x((t=>t.midi.midi));return(0,xs.jsx)(bs,{})},Ss=()=>t=>{Pi.get("/midi/list").then((e=>{console.log("MIDI list fetched:",e.data),t(ke.setmidilist({midilist:e.data}))})).catch((t=>{console.error("Error fetching MIDI list:",t)}))},_s=t=>e=>{e(ke.setLoading({loading:t}))},Ts=t=>e=>{e(ke.setmidi({midi:t}))};var Es=__webpack_require__(8861),Cs=__webpack_require__.n(Es);const ks=t=>new Promise(((e,n)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=()=>{const t=Cs().Base64(i.result);e(t)},i.onerror=n}));const As=t=>{let e=0;return 1===t.length?0:(t.forEach(((t,n)=>{0===e&&t.event.forEach(((t,i)=>{8!==t.type&&9!==t.type||(e=n)}))})),e)},Is=t=>{const e=[...t];for(let r=0;r<e.length;r++)e[r]=Object.assign({},e[r]);let n=[];for(let r=0;r<e.length;r++)9===e[r].type&&n.push(e[r].data[0]);let i=0;n.forEach((t=>{i+=t})),i=Math.floor(i/n.length),console.log("The Median of this midi file : ",i);for(let r=0;r<e.length;r++)9!==e[r].type&&8!==e[r].type||(e[r].data[0]<i?e[r].lh=0:e[r].lh=1);return e},Os=t=>{const e=[...t];for(let s=0;s<e.length;s++)e[s]=Object.assign({},e[s]);const n=t=>{let n=null;for(let i=t+1;i<e.length;i++)if(8===e[i].type&&e[i].data[0]===e[t].data[0]){n=Object.assign({},e[i]),i+1<e.length&&(e[i+1].deltaTime=e[i].deltaTime+e[i+1].deltaTime),e.splice(i,1);break}return n},i=t=>{let n=[t];for(let i=t+1;i<e.length&&!(e[i].deltaTime>25||9!==e[i].type);i++)n.push(i);return n};for(let s=0<e.length-1;s++;){try{if(9!==e[s].type)continue}catch(r){break}const t=i(s),o=[];for(let e=0;e<t.length;e++){const i=n(t[e]);null!==i&&(i.deltaTime=0,o.push(i))}if(0!==o.length){for(let t=s+o.length;t<e.length;t++)if(9===e[t].type&&e[t].deltaTime>10){for(let n=0;n<o.length;n++)e.splice(t+n,0,o[n]);break}s+=t.length}}return e};var Rs=__webpack_require__(7948),Ns=__webpack_require__.n(Rs),Ms=__webpack_require__(6611);const Ds=t=>{let{isOpen:n,onClose:i,handleYoutubeUpload:r}=t;const[s,o]=(0,e.useState)("");return(0,xs.jsxs)(Ns(),{isOpen:n,onRequestClose:i,style:{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(15, 15, 15, 0.79)",display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30%",height:"50%",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px",display:"flex",flexDirection:"column"}},children:[(0,xs.jsx)("button",{className:"close-button",onClick:i,children:"X"}),(0,xs.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,xs.jsx)("h3",{className:"youtube-link-Upload",children:"Youtube link Upload"}),(0,xs.jsx)("input",{className:"youtube-link",type:"text",value:s,onChange:t=>{const e=t.target.value;o(e)},placeholder:"\uc720\ud29c\ube0c \ub9c1\ud06c\ub97c \uc785\ub825\ud558\uc138\uc694"}),(0,xs.jsx)("div",{className:"youtube-Upload-button-container",children:(0,xs.jsx)("button",{className:"youtube-Upload",onClick:()=>r(s),children:"Youtube Upload"})}),(0,xs.jsx)("button",{className:"goto-file-upload-button",onClick:i,children:"Go to upload a file \u2192"})]})]})};Ns().setAppElement("#root");const Ps=t=>{let{onClose:n}=t;const i=A(),r=x((t=>t.user.user_instance.nickname)),[s,o]=(0,e.useState)(null),[a,c]=(0,e.useState)(null),[l,u]=(0,e.useState)(""),[h,d]=(0,e.useState)(""),[p,f]=(0,e.useState)(""),[m,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(""),[b,w]=(0,e.useState)(!1),[S,_]=(0,e.useState)(!1),[T,E]=(0,e.useState)(""),C=t=>{t.preventDefault(),t.stopPropagation()},k=t=>{t.preventDefault(),t.stopPropagation(),w(!1),_(!1)},I=t=>{t.preventDefault(),t.stopPropagation(),w(!1),_(!1);const e=t.dataTransfer.files[0],n=e.name.toLowerCase();n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".png")?(E("image"),c(e)):(n.endsWith(".midi")||n.endsWith(".mp3"))&&(E("file"),o(e))},O=(t,e,n,r,s,o)=>{console.log("Uploading MIDI file...");const a=new FormData;a.append("file",t),a.append("title",n),a.append("subtitle",r),a.append("poster",s),a.append("password",o),Pi.post("/midi/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{console.log("Upload successful:",t.data),i(Ss())})).catch((t=>{console.error("Upload failed:",t)})),i(_s(!1))},R=()=>{n()};return(0,xs.jsxs)(Ns(),{isOpen:!0,onRequestClose:R,style:{overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:99,backgroundColor:"rgba(15, 15, 15, 0.79)",display:"flex",justifyContent:"center",alignItems:"center"},content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"450px",height:"550px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px",display:"flex",flexDirection:"column"}},children:[(0,xs.jsx)("button",{className:"close-button",onClick:R,children:"X"}),(0,xs.jsxs)("div",{className:"popup-zone",style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,xs.jsx)("h3",{className:"file-Upload",children:"\uc0c8\ub85c\uc6b4 \uace1 \uc5c5\ub85c\ub4dc \ud558\uae30"}),(0,xs.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,xs.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",marginRight:"10px"},children:[(0,xs.jsx)("input",{type:"file",id:"imageInput",style:{display:"none"},onChange:t=>{c(t.target.files[0]),E("image")},accept:"image/*"}),(0,xs.jsx)("text",{children:"\uc568\ubc94 \uc774\ubbf8\uc9c0"}),(0,xs.jsx)("div",{className:"drop-zone ".concat(b?"drag-over":""),onDragOver:C,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),w(!0),_(!1)},onDragLeave:k,onDrop:I,onClick:()=>{document.getElementById("imageInput").click()},children:a?(0,xs.jsx)("img",{className:"DragAndDrop-img",src:URL.createObjectURL(a)}):(0,xs.jsx)(xs.Fragment,{children:(0,xs.jsx)("div",{className:"DragAndDrop-container",children:"image"===T?(0,xs.jsx)("img",{className:"DragAndDrop-img",src:"img\\\ud30c\uc77c\uc5c5\ub85c\ub4dc\uc774\ubbf8\uc9c0.png"}):(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)("img",{className:"DragAndDrop-img",src:"img\\\ud30c\uc77c\uc5c5\ub85c\ub4dc\uc774\ubbf8\uc9c0.png"}),(0,xs.jsx)("p",{children:"file"===T?"MP3 \ub610\ub294 MIDI \ud30c\uc77c":"\uc774\ubbf8\uc9c0(\uc544\uc774\ucf58)"})]})})})})]}),(0,xs.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,xs.jsx)("text",{children:"\uc74c\uc6d0 \ud30c\uc77c"}),(0,xs.jsx)("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t=>{o(t.target.files[0])},accept:".mp3, .midi, .mid"}),(0,xs.jsx)("div",{className:"drop-zone ".concat(S?"drag-over":""),onDragOver:C,onDragEnter:t=>{t.preventDefault(),t.stopPropagation(),_(!0),w(!1)},onDragLeave:k,onDrop:I,onClick:()=>{document.getElementById("fileInput").click()},children:s?(0,xs.jsxs)("p",{children:["File: ",s.name]}):(0,xs.jsx)(xs.Fragment,{children:(0,xs.jsxs)("div",{className:"DragAndDrop-container",children:[(0,xs.jsx)("img",{className:"DragAndDrop-img",src:"img/\ud30c\uc77c\uc5c5\ub85c\ub4dc\uc774\ubbf8\uc9c0.png",alt:"Upload Icon"}),(0,xs.jsx)("p",{children:"MP3 \ub610\ub294 MIDI \ud30c\uc77c"})]})})})]})]}),(0,xs.jsxs)("div",{style:{borderBottom:"2px solid black"},className:"text-input-container",children:[(0,xs.jsx)("text",{children:"\uace1 \uc81c\ubaa9"}),(0,xs.jsx)("input",{class:"text-input",autoComplete:"off",onChange:t=>{const e=t.target.value;u(e)}})]}),(0,xs.jsxs)("div",{style:{borderBottom:"2px solid black"},className:"text-input-container",children:[(0,xs.jsx)("text",{children:"\uac00\uc218"}),(0,xs.jsx)("input",{class:"text-input",autoComplete:"off",onChange:t=>{const e=t.target.value;d(e)}})]}),(0,xs.jsxs)("div",{style:{borderBottom:"2px solid black"},className:"text-input-container",children:[(0,xs.jsx)("text",{children:"\ube44\ubc00\ubc88\ud638"}),(0,xs.jsx)("input",{class:"text-input",autoComplete:"off",type:"password",maxLength:"5",onChange:t=>{const e=t.target.value;f(e)}})]}),(0,xs.jsx)("div",{className:"upload-button-container",children:(0,xs.jsx)("button",{style:{cursor:"pointer"},className:"MIDI-Upload",onClick:()=>(()=>{if(i(_s(!0)),s&&l){const t=s.name.toLowerCase();if(t.endsWith(".midi")||t.endsWith(".mp3")||t.endsWith(".mid")){const e=t.endsWith(".midi")||t.endsWith(".mid")?"MIDI":"MP3";if("MIDI"===e)console.log("Uploading MIDI file:",s),O(s,0,l,h,r,p);else if("MP3"===e){const t=new Ms.OnsetsAndFrames("https://storage.googleapis.com/magentadata/js/checkpoints/transcription/onsets_frames_uni");t.initialize().then((()=>{t.transcribeFromAudioFile(s).then((t=>{const e=Ms.sequenceProtoToMidi(t),n=new Blob([e],{type:"audio/mid"});let i=l;i=i.replace(".","_"),i+=".mid",console.log(new File([n],i,{type:"audio/mid"})),O(new File([n],i,{type:"audio/mid"}),0,l,h,r,p)}))}))}}else console.log("Invalid file type selected. Not uploading.")}else console.log("Title or file not selected. Not uploading.");n()})(),children:"Upload"})}),(0,xs.jsx)("button",{className:"goto-youtube-Upload-button",onClick:t=>{console.log("Uploading YouTube link:",t),g(!0),R()},children:"Go to upload a YouTube link \u2192"}),(0,xs.jsx)(Ds,{isOpen:m,onClose:()=>g(!1),handleYoutubeUpload:t=>{console.log("Uploading YouTube link:",t),n()}})]})]})},Fs=()=>{const t=A(),n=Fr(),i=x((t=>t.user.user_instance)),[r,s]=(0,e.useState)(!1),o=e=>{const n=new Date;var i;n.setDate(n.getDate()+7),Ie.ZP.save("nickname",e,{path:"/",expires:n}),t((i=e,t=>{t(ze.setnickname({nickname:i}))})),document.getElementById("nickname_input").placeholder=e,alert('\ub2c9\ub124\uc784\uc774 "'+e+'"\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.')},[a,c]=(0,e.useState)(""),[l,u]=(0,e.useState)(!1);return(0,xs.jsx)(xs.Fragment,{children:(0,xs.jsxs)("header",{id:"header",class:"header",style:{width:"225px",left:"0",transform:"none",position:"fixed",top:"0",bottom:"0px",borderRight:"1px solid #f5f5f5",zIndex:"30",backgroundColor:"#fff",paddingLeft:"60px"},children:[(0,xs.jsx)("h1",{class:"logo_wrap",children:(0,xs.jsx)("button",{className:"logo-button",style:{backgroundPosition:"-255px -321px",display:"block",margin:"37px 10px 5px 20px",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"35px",fontWeight:"700",cursor:"pointer"},onClick:()=>{n("/")},children:"ARtist"})}),(0,xs.jsxs)("div",{class:"menu_wrap",style:{top:"73px",right:"0",bottom:"0",left:"0",padding:"30px 16px 0 24px",overflowY:"auto"},children:[(0,xs.jsx)("div",{class:"profile_area",style:{width:"177px",border:"1px solid hsla(0, 0%, 100%, 0.1)",borderWidth:"1px 0"},children:(0,xs.jsx)("input",{id:"nickname_input",type:"text",placeholder:i.nickname,maxlength:"15",style:{backgroundColor:"transparent",border:"none",fontSize:"18px",width:"172px",marginLeft:"0",fontWeight:"400"}})}),(0,xs.jsxs)("div",{class:"search_area",style:{width:"177px",position:"relative",marginTop:"20px",borderRadius:"4px"},children:[(0,xs.jsxs)("span",{class:"input_area",style:{position:"relative",display:"block"},children:[(0,xs.jsx)("input",{type:"search",role:"combobox",id:"search_keyword","aria-expanded":"false",title:"\uac80\uc0c9\ucc3d",placeholder:"\uc74c\uc545 \uac80\uc0c9\ud558\uae30",autoComplete:"off",class:"input_search",style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordBreak:"break-all",padding:"10px 36px 10px 44px",width:"100%",height:"35px",border:"0",backgroundColor:"#ededed",borderRadius:"10px",fontSize:"15px",fontWeight:"700",lineHeight:"20px",letterSpacing:"-0.3px",color:"#000"},onChange:t=>{const e=t.target.value;c(e),u(e.length>0)}}),(0,xs.jsx)("span",{class:"icon_search",style:{backgroundPosition:"-228px -606px",width:"15px",height:"15px",position:"absolute",top:"10px",left:"13px"},children:(0,xs.jsx)("img",{className:"search-img",src:"../img/\uac80\uc0c9\ud68c\uc0c9.png",alt:"\uac80\uc0c9",style:{width:"20px",height:"20px",position:"absolute",top:"50%",WebkitTransform:"translateY(-50%)",transform:"translateY(-50%)"}})})]}),l&&(0,xs.jsx)("div",{class:"auto_keyword_area",style:{zIndex:"20",left:"85px",position:"fixed",width:"400px",padding:"9px 0 8px",marginTop:"1px",borderRadius:"4px",backgroundColor:"#ededed"},children:(0,xs.jsx)("ui",{role:"listbox",class:"keyword_list",style:{display:"block",marginBlockStart:"1em",marginBlockEnd:"1em",paddingInlineStart:"40px"},children:(0,xs.jsx)("li",{role:"presentation",class:"keyword_list_item",style:{listStyle:"none"},children:(0,xs.jsxs)("a",{role:"option","aria-selected":"false",class:"auto_keyword",style:{},children:[" ","\uac80\uc0c9\uc5b4"," "]})})})})]}),(0,xs.jsxs)("div",{class:"menu_area",children:[(0,xs.jsx)("button",{className:"nickname-change-button",style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",fontWeight:"300",marginTop:"20px",cursor:"pointer"},onClick:()=>{const t=document.getElementById("nickname_input"),e=t.value.trim();""===e?t.focus():o(e)},children:"\ub2c9\ub124\uc784 \ubcc0\uacbd"}),(0,xs.jsx)("button",{className:"upload-button",style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",fontWeight:"300",marginTop:"20px",cursor:"pointer"},onClick:()=>{s(!0)},children:"\uc5c5\ub85c\ub4dc \ud558\uae30"}),r&&(0,xs.jsx)(Ps,{onClose:()=>{s(!1)}}),(0,xs.jsx)("button",{className:"change-equipment-button",style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",fontWeight:"300",marginTop:"20px",cursor:"pointer"},onClick:()=>{n("/equipment-change")},children:"\uc7a5\ube44 \uc5f0\uacb0\ud558\uae30"}),(0,xs.jsxs)("button",{className:"entire-song-button",style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",fontWeight:"300",marginTop:"20px",cursor:"pointer"},onClick:()=>{n("/whole-song")},children:["\uc804\uccb4 \uc5c5\ub85c\ub4dc \uace1 \ubcf4\uae30 ",">"]})]})]})]})})},Ls=()=>(0,xs.jsx)(xs.Fragment,{children:(0,xs.jsx)("footer",{id:"footer",role:"contentinfo",class:!0,style:{background:"#fff",paddingTop:"32px",paddingBottom:"50px"},children:(0,xs.jsxs)("div",{class:"footer_inner",style:{maxWidth:"1440px",padding:0,marginLeft:"400px"},children:[(0,xs.jsx)("div",{class:"policy_area",children:(0,xs.jsxs)("ul",{children:[(0,xs.jsx)("li",{children:(0,xs.jsx)("a",{href:"",class:!0,target:"_blank",style:{textDecoration:"none"},children:"\uc774\uc6a9\uc57d\uad00"})}),(0,xs.jsx)("li",{children:(0,xs.jsx)("a",{href:"",class:!0,target:"_blank",style:{textDecoration:"none"},children:"\uac1c\uc778\uc815\ubcf4 \ucc98\ub9ac\ubc29\uce68"})}),(0,xs.jsx)("li",{children:(0,xs.jsx)("a",{href:"",class:!0,target:"_blank",style:{textDecoration:"none"},children:"\uc0ac\uc5c5\uc790\uc815\ubcf4 \ud655\uc778"})})]})}),(0,xs.jsx)("address",{children:(0,xs.jsxs)("div",{class:"inner",style:{marginLeft:"-8px"},children:[(0,xs.jsx)("div",{class:"address_top",children:(0,xs.jsx)("span",{children:" \uae40\uc9c0\uc6d0 \ubcc0\uc0c1\uc5f0 \uc774\uc544\uc601 \uc774\uc900\uc5fd \uc815\ubbfc\uaddc "})}),(0,xs.jsx)("div",{class:"address_bottom",children:(0,xs.jsx)("span",{children:" \uacbd\uae30\ub3c4 \uc131\ub0a8\uc2dc \uc218\uc815\uad6c \ubcf5\uc815\ub3d9 495 "})})]})}),(0,xs.jsx)("p",{class:"copyright",style:{paddingTop:"16px",paddingBottom:"0",fontSize:"11px",color:"#8e8e93"},children:(0,xs.jsx)("span",{style:{paddingRight:"10px"},children:"\uac00\ucc9c\ub300\ud559\uad50 | \uc18c\ud504\ud2b8\uc6e8\uc5b4\uc804\uacf5"})})]})})}),Bs=t=>{let{isSidebarOpen:e}=t;return(0,xs.jsxs)("div",{className:"sidebar",style:{position:"fixed",justifyContent:"center",top:0,right:0,width:"400px",height:"100%",backgroundColor:"#f5f5f5",boxShadow:"-2px 0 2px rgba(0, 0, 0, 0.2)",display:e?"block":"none"},children:[(0,xs.jsxs)("div",{className:"profile-info",style:{marginTop:"120px",display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,xs.jsx)("div",{className:"profile-image",style:{marginLeft:"20px"},children:(0,xs.jsx)("img",{className:"Profile-img",src:"img\\\ud504\ub85c\ud544.png",alt:"\ud504\ub85c\ud544 \uc774\ubbf8\uc9c0",width:"34",height:"34"})}),(0,xs.jsx)("h4",{style:{marginLeft:"20px"},children:"\ub2c9\ub124\uc784"})]}),(0,xs.jsx)("hr",{style:{width:"90%",borderTop:"1px solid #ddd",margin:"20px auto"}}),(0,xs.jsxs)("div",{className:"menu-list",style:{margin:"300px 20px"},children:[(0,xs.jsxs)("div",{className:"list",children:[(0,xs.jsx)("img",{className:"room-img",src:"img\\\ubc29\ub9cc\ub4e4\uae30.png",alt:"\ubc29\ub9cc\ub4e4\uae30 \uc774\ubbf8\uc9c0",width:"24",height:"28",style:{marginLeft:"3px"}}),(0,xs.jsx)("button",{className:"sidebar-button",style:{backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"5px",cursor:"pointer",display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",marginLeft:"22px"},children:"\ubc29 \ub9cc\ub4e4\uae30"})]}),(0,xs.jsxs)("div",{className:"list",children:[(0,xs.jsx)("img",{className:"conversion-img",src:"img\\\ubcc0\ud658.png",alt:"\ubcc0\ud658 \uc774\ubbf8\uc9c0",width:"30",height:"30"}),(0,xs.jsx)("button",{className:"sidebar-button",style:{backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"5px",cursor:"pointer",display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",fontSize:"15px",marginLeft:"20px"},children:"\ud30c\uc77c \ubcc0\ud658\ud558\uae30"})]})]})]})},zs=t=>{let{children:e}=t;return(0,xs.jsx)("div",{style:{paddingTop:"30px",paddingLeft:"285px"},children:(0,xs.jsx)("div",{style:{margin:"0 43px"},children:e})})},Us=[__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_1.21429bff26fcdbe5778b.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_2.4d2b356a69d68ac6e31e.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_3.4cf2bd9d00bc9643043d.jpg",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_4.263c554d6073b30b21e0.jpg",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_5.db4f20fe2f76606479e4.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_6.eeb3e2e33bbdcc7c513e.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_7.d5b101aaf77a042e224b.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_8.87af363ec8f44a7f43f0.jpg",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_9.3bb29bdea32a5487a07b.png",__webpack_require__.p+"static/media/\uace1_\uae30\ubcf8_\uc774\ubbf8\uc9c0_10.54348b00543979485317.png"],js=t=>{const n=A(),i=Fr(),r=x((t=>t.user.user_instance)),[s]=(0,e.useState)(Math.floor(Math.random()*Us.length)),o=Us[s],a=async e=>{const r="".concat(Pi.getUri()).concat(t.download_url);console.log("fullDownloadUrl",r),n(_s(!0)),Di({method:"get",url:r,responseType:"blob"}).then((async t=>{n(_s(!1));const r=await ks(t.data);n(Ts(r)),i(e)}))},c=(t,e,i,r)=>{n({type:"socket/connect",payload:{filename:t,nickname:e,user_id:i,device:r}})},l={cursor:"pointer",backgroundColor:"transparent",color:"#333",width:"100%",height:"40px",padding:"10px 16px",fontSize:"14px",textAlign:"left",display:"block"};return(0,xs.jsxs)("tr",{children:[(0,xs.jsx)("td",{style:{fontSize:"15px",fontWeight:"700",color:"#333",position:"relative",height:"84px",textAlign:"center",borderBottom:"1px solid #f6f6f6"},children:t.rank+1}),(0,xs.jsx)("td",{style:{paddingLeft:"20px",textAlign:"left",position:"relative",height:"84px",borderBottom:"1px solid #f6f6f6"},children:(0,xs.jsxs)("div",{style:{position:"relative",minWidth:"210px",maxWidth:"520px",height:"60px",paddingRight:"28px",paddingLeft:"80px"},children:[(0,xs.jsx)("div",{style:{position:"absolute",top:"0",left:"0",width:"60px",height:"60px"},children:(0,xs.jsx)("img",{style:{width:"100%",height:"100%",verticalAlign:"top",borderRadius:"4px"},alt:"\uc774\ubbf8\uc9c0",src:o})}),(0,xs.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",minWidth:"130px",height:"100%"},children:[(0,xs.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,xs.jsx)("p",{style:{fontSize:"15px",color:"#333",fontWeight:"400"},children:t.title})}),(0,xs.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,xs.jsx)("p",{style:{flex:"0 1 auto",paddingTop:"6px",fontSize:"13px",color:"#969696"},children:t.subtitle?t.subtitle:"Songs"})})]})]})}),(0,xs.jsx)("td",{style:{position:"relative",fontSize:"15px",color:"#333",textAlign:"left",height:"84px",borderBottom:"1px solid #f6f6f6"},children:(0,xs.jsx)("span",{style:{display:"block",position:"relative",minWidth:"100px",width:"196px",fontSize:"15px",color:"#333"},children:t.poster?t.poster:"\ub098\uadf8\ub124"})}),(0,xs.jsx)("td",{style:{minWidth:"80px",fontSize:"15px",fontWeight:"400",color:"#333",position:"relative",height:"84px",textAlign:"center",borderBottom:"1px solid #f6f6f6"},children:t.views?t.views:"0"}),(0,xs.jsx)("td",{style:{minWidth:"80px",fontSize:"15px",fontWeight:"400",color:"#333",position:"relative",height:"84px",textAlign:"center",borderBottom:"1px solid #f6f6f6"},children:t.like?t.like:"0"}),(0,xs.jsx)("td",{style:{minWidth:"50px",position:"relative",height:"84px",textAlign:"center",borderBottom:"1px solid #f6f6f6"},children:(0,xs.jsx)("button",{style:{cursor:"pointer",backgroundColor:"transparent",color:"transparent",whiteSpace:"nowrap",verticalAlign:"middle"},onClick:()=>{a("/graphic")},children:(0,xs.jsx)("img",{src:"img\\\uc7ac\uc0dd\ubc84\ud2bc.png",alt:"\uc5c5\ub85c\ub4dc",style:{width:"20px",height:"20px"}})})}),(0,xs.jsxs)("td",{style:{minWidth:"50px",position:"relative",height:"84px",textAlign:"center",borderBottom:"1px solid #f6f6f6"},children:[(0,xs.jsx)("button",{style:{cursor:"pointer",backgroundColor:"transparent",color:"transparent",whiteSpace:"nowrap",verticalAlign:"middle"},onClick:e=>{e.stopPropagation(),t.index===t.moreIndex?t.setMoreIndex(-1):t.setMoreIndex(t.index)},children:(0,xs.jsx)("img",{src:"img\\\uae30\ub2a5\ub354\ubcf4\uae30.png",alt:"\ub354\ubcf4\uae30",style:{width:"20px",height:"20px"}})}),t.moreIndex===t.index&&(0,xs.jsxs)("div",{style:{position:"absolute",top:"66px",right:"0",zIndex:"11",width:"200px",padding:"10px 0",background:"#fff",borderRadius:"5px",boxShadow:"0 4px 20px 0 rgba(0,0,0,.1)"},children:[(0,xs.jsx)("button",{style:l,onClick:async()=>{a("/midi/".concat(1))},children:"MIDI \uc7ac\uc0dd"}),(0,xs.jsx)("button",{style:l,onClick:()=>{if(t.download_url){const e="".concat(Pi.getUri()).concat(t.download_url);window.open(e)}else alert("\ub2e4\uc6b4\ub85c\ub4dc \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},children:"\ub2e4\uc6b4\ub85c\ub4dc"}),(0,xs.jsx)("button",{style:l,onClick:()=>{console.log("".concat(Pi.getUri()).concat(t.delete_url)),Pi.delete("".concat(Pi.getUri()).concat(t.delete_url)).then((t=>{console.log(t),n(Ss())}))},children:"\uc0ad\uc81c"}),(0,xs.jsx)("button",{style:l,onClick:()=>{c(t.filename,r.nickname,"1234",0)},children:"\ubc29 \ub9cc\ub4e4\uae30"})]})]})]})},Vs=t=>{let{midiList:n}=t;const[i,r]=(0,e.useState)(-1),[s,o]=(0,e.useState)(10),a=x((t=>t.room.room)),c=Fr(),l=A();(0,e.useEffect)((()=>{1===a.ongoing_code&&(l(Ui()),c("/room/".concat(a.room_id)))}),[l,c,a]);const u={whiteSpace:"nowrap",height:"39px",fontSize:"13px",fontWeight:"400",color:"#a0a0a0",borderTop:"1px solid #ebebeb",borderBottom:"1px solid #ebebeb",padding:"0",margin:"0"};return(0,xs.jsx)("div",{style:{padding:"0",margin:"0",border:"0"},onClick:()=>{r(-1)},children:(0,xs.jsxs)("table",{style:{width:"auto",minWidth:"100%",maxWidth:"none",tableLayout:"fixed"},children:[(0,xs.jsxs)("colgroup",{children:[(0,xs.jsx)("col",{width:"42","data-cell":"\uc21c\uc704"}),(0,xs.jsx)("col",{width:"*","data-cell":"\uace1/\uc124\uba85"}),(0,xs.jsx)("col",{width:"250","data-cell":"\uc5c5\ub85c\ub354"}),(0,xs.jsx)("col",{width:"65","data-cell":"\ud50c\ub808\uc774\uc218"}),(0,xs.jsx)("col",{width:"65","data-cell":"\uc88b\uc544\uc694"}),(0,xs.jsx)("col",{width:"65","data-cell":"\uc7ac\uc0dd"}),(0,xs.jsx)("col",{width:"65","data-cell":"\ub354\ubcf4\uae30"})]}),(0,xs.jsx)("thead",{children:(0,xs.jsxs)("tr",{children:[(0,xs.jsx)("th",{scope:"col",style:u,children:"\uc21c\uc704"}),(0,xs.jsx)("th",{scope:"col",style:{...u,paddingLeft:"20px",textAlign:"left"},children:"\uace1/\uc124\uba85"}),(0,xs.jsx)("th",{scope:"col",style:{...u,paddingLeft:"5px",textAlign:"left"},children:"\uc5c5\ub85c\ub354"}),(0,xs.jsx)("th",{scope:"col",style:u,children:"\ud50c\ub808\uc774\uc218"}),(0,xs.jsx)("th",{scope:"col",style:u,children:"\uc88b\uc544\uc694"}),(0,xs.jsx)("th",{scope:"col",style:u,children:"\uc7ac\uc0dd"}),(0,xs.jsx)("th",{scope:"col",style:u,children:"\ub354\ubcf4\uae30"})]})}),(0,xs.jsx)("tbody",{children:n.slice(0,s).map(((t,e)=>(0,xs.jsx)(js,{index:e,filename:t.filename,rank:e,title:t.title,download_url:t.download_url,delete_url:t.delete_url,moreIndex:i,setMoreIndex:r,imgurl:void 0,subtitle:t.subtitle,poster:t.poster,like:t.like,views:t.views,music_lenght:t.music_lenght},e)))}),s<n.length&&(0,xs.jsx)("tfoot",{children:(0,xs.jsx)("tr",{children:(0,xs.jsx)("td",{colSpan:"7",style:{textAlign:"center"},children:(0,xs.jsx)("div",{onClick:()=>{o(s+10)},style:{cursor:"pointer"},children:(0,xs.jsx)("img",{src:"./img/\ud3bc\uce58\uae302.png",alt:"Load More",style:{width:"35px",height:"35px",marginTop:"5px"}})})})})})]})})};function Ws(t){let{imageUrl:e,title:n,onClick:i}=t;return(0,xs.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,xs.jsxs)("div",{style:{width:"175px",marginBottom:"10px",marginLeft:"20px"},children:[(0,xs.jsx)("button",{style:{backgroundColor:"transparent",border:"none",boxShadow:"none"},onClick:i,children:(0,xs.jsx)("img",{src:e,alt:n,style:{cursor:"pointer"}})}),(0,xs.jsx)("p",{style:{marginTop:"10px",fontSize:"14px",color:"#333"},children:n})]})})}const Gs=t=>{let{items:e,onEditorPickClick:n}=t;return(0,xs.jsxs)("div",{style:{marginLeft:"10px",marginBottom:"10px"},children:[(0,xs.jsx)("h2",{style:{marginBottom:"20px"},children:"Editor's Pick"}),(0,xs.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",marginLeft:"-20px"},children:e.map(((t,e)=>(0,xs.jsx)(Ws,{imageUrl:t.imageUrl,title:t.title,onClick:()=>n(e)},e)))})]})},qs=()=>{const t=A(),n=x((t=>t.midi.midiList)),i=x((t=>t.user.name)),[r,s]=(0,e.useState)(!1),[o,a]=(0,e.useState)(!1),c=Fr();(0,e.useEffect)((()=>{t(Ss())}),[]);return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:i}),(0,xs.jsxs)(zs,{children:[(0,xs.jsx)(Gs,{items:[{imageUrl:"https://cdn.music-flo.com/image/album/931/286/02/04/402286931_5c9d73de.jpg?1553822687261/dims/resize/175/quality/90",title:"\ub108\uc640 \ud568\uaed8\ub77c\uba74 \ucd94\uc6b4 \uaca8\uc6b8\ub3c4 \uacac\ub51c\ub9cc\ud574"},{imageUrl:"https://cdn.music-flo.com/image/v2/album/897/395/05/04/405395897_5fb69b00_o.jpg?1605802753351/dims/resize/175/quality/90",title:"\ucee4\ud53c\uc640 \ucc30\ub5a1\uad81\ud569 \uce90\ub7f4 \ud31d \ubc1c\ub77c\ub4dc"},{imageUrl:"https://cdn.music-flo.com/image/album/396/287/04/04/404287396_5df0adde.jpg?1576054238835/dims/resize/175/quality/90",title:"\uc62c \ud06c\ub9ac\uc2a4\ub9c8\uc2a4\uc5d0\ub294 \uc0c9\ub2e4\ub978 K-\uce90\ub7f4\uc744"},{imageUrl:"https://cdn.music-flo.com/poc/p/image/channel/rep/20231120/718a0fa972144a4094a9b6d64fdec56f.jpg/dims/resize/175/quality/90",title:"\ucd94\uc5b5\uc758 \uad6d\ub0b4 \uaca8\uc6b8 \ub178\ub798"},{imageUrl:"https://cdn.music-flo.com/poc/p/image/channel/rep/20231127/2c5761818641436ba780d96b0fff50c8.png/dims/resize/175/quality/90",title:"\ud06c\ub9ac\uc2a4\ub9c8\uc2a4 \ud558\uba74 \ub5a0\uc624\ub974\ub294 \uc601\ud654 OST"},{imageUrl:"https://cdn.music-flo.com/poc/p/image/channel/rep/20230303/0d557e48d822482db706abb525cf6569.png/dims/resize/175/quality/90",title:"\ub7f0\ub358\uc758 LP\ubc14\uc5d0 \ud750\ub974\ub294 \uc62c\ub4dc \ube0c\ub9bf\ud31d"},{imageUrl:"https://cdn.music-flo.com/poc/p/image/channel/rep/20221222/64c75b6c7c204806a43dba60588edca6.png/dims/resize/175/quality/90",title:"\uac00\uc744\uc5d0 \ub4e3\uae30 \uc88b\uc740 \ubc1c\ub77c\ub4dc Top 40"}],onEditorPickClick:t=>{c("/editor-pick-".concat(t+1))}}),(0,xs.jsx)(Vs,{midiList:n})]}),(0,xs.jsx)(Ls,{}),(0,xs.jsx)(Bs,{isSidebarOpen:o})]})},Hs=t=>{let{note:e}=t;const n={0:"\ub3c4",1:"\ub3c4#",2:"\ub808",3:"\ub808#",4:"\ubbf8",5:"\ud30c",6:"\ud30c#",7:"\uc194",8:"\uc194#",9:"\ub77c",10:"\ub77c#",11:"\uc2dc"};return(0,xs.jsx)("div",{style:{whiteSpace:"nowrap"},children:e.map(((t,e)=>{let i="";return i=n[Math.floor(e%12)],(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)("span",{style:{backgroundColor:t?"red":"white"},children:i}),"\xa0\xa0",e%24===23&&(0,xs.jsx)("br",{})]})}))})},Xs=()=>{const t=x((t=>t.midi.midi)),n=(0,e.useRef)(null);(0,e.useEffect)((()=>{n.current=new es.Sampler({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/",onload:()=>{n.current.triggerAttackRelease(["C5"],.05)}}).toDestination()}),[]);const[i,r]=(0,e.useState)(new Array(128).fill(!1)),s=(0,e.useRef)([]);return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)("button",{onClick:()=>{if(null===t)return;console.log(t),console.log(As(t.track));let e=Os(t.track[As(t.track)].event),i=[];e.forEach(((e,n)=>{8!==e.type&&9!==e.type||(0===i.length?i.push(e.deltaTime):i.push(i[i.length-1]+e.deltaTime*t.timeDivision/105.2))})),console.log(i);let o=0;e.forEach(((t,e)=>{8!==t.type&&9!==t.type||(((t,e)=>{let n=setTimeout(t,e);s.current.push(n)})((()=>{var e,i;e=t.data[0],i=9===t.type,r((t=>(i?n.current.triggerAttack(is[e]):n.current.triggerRelease(is[e]),t[e]=i,[...t])))}),i[o]),o++)}))},children:"play"}),(0,xs.jsx)("button",{onClick:()=>{s.current.forEach((t=>{clearTimeout(t)})),n.current.releaseAll(),r(i.map(((t,e)=>!1)))},children:"stop"}),(0,xs.jsx)(Hs,{note:i})]})};class Ys{constructor(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,o=arguments.length>6?arguments[6]:void 0;this.scene=t,this.noteArray=[],this.tempo=2,this.speed=.8*n/this.tempo/60,this.nowPressLine=t.add.rectangle(0,.88*n,e,1,16737095).setDepth(1).setOrigin(0,0),t.physics.add.existing(this.nowPressLine),this.destroyLine=t.add.rectangle(0,.88*n+1.8*o,e,1,16737095).setDepth(1).setOrigin(0,0),t.physics.add.existing(this.destroyLine),i.forEach((i=>{this.noteArray.push(new Ks(i.note,i.startAt,i.endAt,t,e,n,r,s,o,this.nowPressLine,this.destroyLine,this.tempo,i.lh))})),console.log(this.noteArray)}goDown(t){const e=(new Date).getTime()-t;e<0||this.noteArray.forEach((t=>{t.startAt<=e&&(t.graphic.y+=this.speed,t.basic.y+=this.speed)}))}}class Ks{constructor(t,e,n,i,r,s,o,a,c,l,u,h,d){this.startAt=e,this.endAt=n;const p=a;p+o>10&&(p-=o);let f=r/p/7,m=(n-e)*s*.8/h/1e3;const g=Math.floor(t/12)-o;let v=t%12;let y=0;const x=1.8*c;m>x&&(m=x),m<12&&(m=12),[1,3,6,8,10].includes(v)?(v=7*g*f+(Math.floor(v/2)+1)*f-f/4,f/=2,y=1):v=0===v?7*g*f:v<5?7*g*f+v/2*f:7*g*f+(Math.floor(v/2)+1)*f;this.graphic=i.add.graphics().setDepth(y),1===d?this.graphic.fillStyle(8679679,.8):this.graphic.fillStyle(4995543,.8),this.graphic.fillRect(v,-m-2,f,m),this.graphic.lineStyle(2,16777215,.4),this.graphic.strokeRect(v+1,-m-1,f-2,m-2);this.basic=i.add.graphics().setDepth(y),1===d?this.basic.fillGradientStyle(16777215,16777215,16777215,16777215,.1,.1,.8,.8):this.basic.fillGradientStyle(16777215,16777215,16777215,16777215,.1,.1,.6,.6),this.basic.fillRect(v,-14,f,12),i.physics.add.existing(this.graphic),i.physics.add.existing(this.basic),i.physics.add.overlap(this.graphic,u,this.checkOutOfScreen),i.physics.add.overlap(this.basic,u,this.checkOutOfScreen)}checkPressed(t,e){t.destroy()}checkOutOfScreen(t,e){t.destroy()}}const Qs=()=>{const t=(0,e.useRef)(null),n=x((t=>t.midi.midi)),i=x((t=>t.room.start)),r=A(),s=(0,e.useRef)(null),o=(0,e.useRef)((new Date).getTime()),a=(0,e.useRef)(!0),c=t=>{if(t.repeat)return;if(!0!==s.current.tone.loaded)return;const e=t.key.charCodeAt(0);r({type:"socket/keyDown",payload:{key:e,octave:s.current.octave,start_idx:s.start_idx}})},l=t=>{if(t.repeat)return;if(!0!==s.current.tone.loaded)return;const e=t.key.charCodeAt(0);r({type:"socket/keyUp",payload:{key:e,octave:s.current.octave,start_idx:s.start_idx}})};console.log(n);const u=x((t=>t.room.keydown)),h=x((t=>t.room.keyup));function d(){}function p(){r(ji(0));const{x:t,y:e,width:i,height:o}=this.cameras.main;this.cameras.main.setBackgroundColor("#27283B");let u=Os(n.track[As(n.track)].event);const h=Is(u);console.log(h);let d=0,p={};h.forEach(((t,e)=>{8!==t.type&&9!==t.type||(9===t.type?(void 0===p[t.data[0]]&&(p[t.data[0]]=[]),p[t.data[0]].push({note:t.data[0],startAt:d,lh:t.lh})):p[t.data[0]][p[t.data[0]].length-1].endAt=d,d+=t.deltaTime*n.timeDivision/105.2)}));let f=[];for(let n in p)p[n].forEach((t=>{f.push(t)}));console.log(f),this.noteGraphic=new Ys(this,i,o,f,2,7,n.timeDivision),s.current=new vs(this,i,o,2,7),s.current.setInput(document),document.addEventListener("keydown",c),document.addEventListener("keyup",l),r({type:"socket/imready"});const m=this.add.text(window.innerWidth*window.devicePixelRatio-100,50,"Pause",{fill:"#fff"});m.setInteractive(),this.temp=0,this.clickCount=0,m.on("pointerup",(function(){this.clickCount+=1,this.clickCount%2?(a.current=!0,this.rec=this.add.rectangle(i/2,o/2,i,o,0,.5).setDepth(4)):(a.current=!1,this.rec.destroy())}),this)}function f(t,e){a.current||this.noteGraphic.goDown(o.current)}return(0,e.useEffect)((()=>{0!==i&&(o.current=i+1e3,a.current=!1,console.log((new Date).getTime()),console.log(o.current))}),[i]),(0,e.useEffect)((()=>{null!==s.current&&s.current.handleKey(u.key,"down",u.octave,u.start_idx,u.user_id)}),[u]),(0,e.useEffect)((()=>{null!==s.current&&s.current.handleKey(h.key,"up",h.octave,h.start_idx)}),[h]),(0,e.useEffect)((()=>{const e=window.innerWidth*window.devicePixelRatio,n=window.innerHeight*window.devicePixelRatio,i={type:ts().AUTO,width:e,height:n,physics:{default:"arcade",arcade:{debug:!1}},scale:{mode:ts().Scale.ENVELOP,autoCenter:ts().Scale.CENTER_BOTH,width:e,height:n},scene:{preload:d,create:p,update:f},fps:{target:60,forceSetTimeOut:!0}},r=new(ts().Game)(i);return t.current=r,()=>{r.scene&&r.scene.keys&&r.scene.keys.default&&r.scene.keys.default.piano&&r.scene.keys.default.piano.destroy(),document.removeEventListener("keydown",c),document.removeEventListener("keyup",l),s.current.removeInput(document),s.current.destroy(),s.current=null,r.destroy(!0),t.current=void 0}}),[]),null},Zs=()=>(0,xs.jsx)(Qs,{style:{overflow:"hidden",boxSizing:"border-box",margin:"0"}}),Js=()=>{const t=Dr();return(0,e.useEffect)((()=>{(async()=>{const e=new URLSearchParams(t.search),n=decodeURIComponent(e.get("url"));console.log(n);let i=await fetch(n).then((t=>t.blob()));console.log(i);let r=new File([i],"file",{type:i.type});console.log(r);const s=new Ms.OnsetsAndFrames("https://storage.googleapis.com/magentadata/js/checkpoints/transcription/onsets_frames_uni");await s.initialize();const o=await s.transcribeFromAudioFile(r),a=Ms.sequenceProtoToMidi(o);console.log(a)})()}),[]),(0,xs.jsx)("div",{children:(0,xs.jsx)("h1",{children:"Convert Page"})})};var $s=!!n.useInsertionEffect&&n.useInsertionEffect;$s||e.useLayoutEffect;var to={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function eo(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}var no=/[A-Z]|^ms/g,io=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ro=function(t){return 45===t.charCodeAt(1)},so=function(t){return null!=t&&"boolean"!==typeof t},oo=eo((function(t){return ro(t)?t:t.replace(no,"-$&").toLowerCase()})),ao=function(t,e){switch(t){case"animation":case"animationName":if("string"===typeof e)return e.replace(io,(function(t,e,n){return lo={name:e,styles:n,next:lo},e}))}return 1===to[t]||ro(t)||"number"!==typeof e||0===e?e:e+"px"};function co(t,e,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return lo={name:n.name,styles:n.styles,next:lo},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)lo={name:i.name,styles:i.styles,next:lo},i=i.next;return n.styles+";"}return function(t,e,n){var i="";if(Array.isArray(n))for(var r=0;r<n.length;r++)i+=co(t,e,n[r])+";";else for(var s in n){var o=n[s];if("object"!==typeof o)null!=e&&void 0!==e[o]?i+=s+"{"+e[o]+"}":so(o)&&(i+=oo(s)+":"+ao(s,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=e&&void 0!==e[o[0]]){var a=co(t,e,o);switch(s){case"animation":case"animationName":i+=oo(s)+":"+a+";";break;default:i+=s+"{"+a+"}"}}else for(var c=0;c<o.length;c++)so(o[c])&&(i+=oo(s)+":"+ao(s,o[c])+";")}return i}(t,e,n);case"function":if(void 0!==t){var r=lo,s=n(t);return lo=r,co(t,e,s)}}if(null==e)return n;var o=e[n];return void 0!==o?o:n}var lo,uo=/label:\s*([^\s;\n{]+)\s*(;|$)/g;Math.abs,String.fromCharCode,Object.assign;function ho(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,e,n){if(1===t.length&&"object"===typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var i=!0,r="";lo=void 0;var s=t[0];null==s||void 0===s.raw?(i=!1,r+=co(n,e,s)):r+=s[0];for(var o=1;o<t.length;o++)r+=co(n,e,t[o]),i&&(r+=s[o]);uo.lastIndex=0;for(var a,c="";null!==(a=uo.exec(r));)c+="-"+a[1];var l=function(t){for(var e,n=0,i=0,r=t.length;r>=4;++i,r-=4)e=1540483477*(65535&(e=255&t.charCodeAt(i)|(255&t.charCodeAt(++i))<<8|(255&t.charCodeAt(++i))<<16|(255&t.charCodeAt(++i))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&t.charCodeAt(i+2))<<16;case 2:n^=(255&t.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(r)+c;return{name:l,styles:r,next:lo}}(e)}var po,fo=__webpack_require__(7169),mo=__webpack_require__.n(fo);const go=ho(po||(vo=["\n  display: block;\n  margin: 0 auto;\n  border-color: rgba(255,255,255,0.7);\n  border-width: 10px;\n"],yo||(yo=vo.slice(0)),po=Object.freeze(Object.defineProperties(vo,{raw:{value:Object.freeze(yo)}}))));var vo,yo;const xo=t=>null!=t.loading&&t.loading&&(0,xs.jsx)("div",{className:"axios-loading",style:{display:!0===t.loading?"block":"none"},children:(0,xs.jsx)("div",{className:"axios-loading-indicator",children:(0,xs.jsx)(mo(),{color:"white",loading:t.loading,css:go,size:40})})});const bo=function(){const[t,n]=(0,e.useState)(""),[i,r]=(0,e.useState)(null),[s,o]=(0,e.useState)(!1),[a,c]=(0,e.useState)([]);return(0,e.useEffect)((()=>{(()=>{const t=new WebSocket("ws://192.168.183.85:4439");t.onopen=()=>{console.log("Piano WebSocket connection established."),r(t),o(!0)},t.onmessage=t=>{const e=t.data;console.log("Received Piano message:",e),c((t=>[e,...t]))},t.onclose=()=>{console.log("Piano WebSocket connection closed."),o(!1)}})()}),[]),(0,xs.jsxs)("div",{children:[(0,xs.jsx)("div",{children:s?(0,xs.jsx)("p",{children:"Piano WebSocket connected"}):(0,xs.jsx)("p",{children:"Piano WebSocket not connected"})}),(0,xs.jsxs)("div",{children:[(0,xs.jsx)("input",{type:"text",value:t,onChange:t=>{n(t.target.value)},placeholder:"Enter your message"}),(0,xs.jsx)("button",{onClick:()=>{i&&i.readyState===WebSocket.OPEN&&(i.send(t),n(""))},children:"Send"})]}),(0,xs.jsxs)("div",{children:[(0,xs.jsx)("h2",{children:"Received Piano Messages:"}),(0,xs.jsx)("ul",{children:a.map(((t,e)=>(0,xs.jsx)("li",{children:t},e)))})]})]})},wo=t=>{let{profileImage:e,nickname:n,equipment:i,mode:r,statusColor:s}=t;return(0,xs.jsx)("div",{style:{marginTop:"50px",marginRight:"110px"},children:(0,xs.jsx)("div",{style:{width:"400px",backgroundColor:"#FAFAFA",borderRadius:"10px",position:"relative"},children:(0,xs.jsxs)("div",{style:{display:"flex"},children:[(0,xs.jsx)("img",{src:e,alt:"\uc568\ubc94 \ucee4\ubc84",style:{float:"left",marginRight:"20px",width:"80px",height:"80px",borderRadius:"15px",marginTop:"10px",marginLeft:"10px"}}),(0,xs.jsxs)("div",{children:[(0,xs.jsx)("h3",{style:{marginTop:"10px"},children:n}),(0,xs.jsx)("p",{style:{marginTop:"10px",color:"#BBBBBB"},children:i}),(0,xs.jsx)("p",{style:{marginTop:"5px",color:"#BBBBBB"},children:r})]}),(0,xs.jsx)("button",{style:{width:"10px",height:"10px",backgroundColor:s,border:"none",borderRadius:"50%",marginTop:"10px",marginLeft:"150px",position:"absolute",top:"1px",left:"225px"}})]})})})},So=()=>{let{room_id:t}=Lr();const n=A(),i=Fr(),r=x((t=>t.user.user_instance)),s=x((t=>t.room.room)),[o,a]=(0,e.useState)(!1),[c,l]=(0,e.useState)(!1),[u,h]=(0,e.useState)(""),d=t=>{h(t),l(!1)};return(0,e.useEffect)((()=>{if(0!==s.error_code)n(_s(!1)),1===s.error_code?alert("\ubc29\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."):2===s.error_code&&alert("\ubc29\uc7a5\uc774 \ubc29\uc744 \ub098\uac14\uc2b5\ub2c8\ub2e4."),i("/");else if(2===s.ongoing_code){const t="".concat(Pi.getUri()).concat(s.music_instance.download_url);console.log("fullDownloadUrl",t),n(_s(!0)),Di({method:"get",url:t,responseType:"blob"}).then((async t=>{const e=await ks(t.data);n(Ts(e)),n(Ui()),n(_s(!1)),i("/graphic")}))}else s.room_id!==t?(console.log("room_id",t),n(_s(!0)),n({type:"socket/connect",payload:{room_id:t,nickname:r.nickname,user_id:r.user_id,device:r.device}})):n(_s(!1))}),[s]),(0,e.useEffect)((()=>()=>{const t=window.location.href.split("/");"graphic"!==t[t.length-1]&&(n({type:"socket/disconnect"}),n(_s(!1)))}),[]),(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{}),(0,xs.jsxs)(zs,{children:[(0,xs.jsxs)("div",{id:"app",className:"container",style:{},children:[(0,xs.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:[(0,xs.jsxs)("h1",{style:{fontSize:"25px"},children:[s.host_nickname,"\uc758 \ubc29"]}),(0,xs.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,xs.jsx)("button",{style:{width:"70px",height:"25px",color:"white",backgroundColor:"#39d446",border:"none",borderRadius:"5px",cursor:"pointer",marginRight:"50px"},onClick:()=>{n({type:"socket/host_play"})},children:"PLAY"}),(0,xs.jsx)("button",{style:{backgroundColor:"transparent",border:"none",boxShadow:"none",cursor:"pointer"},onClick:()=>l(!0),children:(0,xs.jsx)("img",{src:"../img/\uc124\uc815\uc544\uc774\ucf58.png",alt:"\ud50c\ub808\uc774_\ubaa8\ub4dc_\uc124\uc815",style:{width:"30px",height:"30px",objectFit:"cover"}})}),(0,xs.jsxs)(Ns(),{isOpen:c,onRequestClose:()=>l(!1),style:{content:{width:"450px",height:"280px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)",margin:"auto",display:"flex",justifyContent:"space-around",alignItems:"center"}},children:[(0,xs.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,xs.jsx)("p",{style:{margin:"0",fontSize:"20px",textAlign:"center",color:"#000",marginBottom:"20px"},children:"\uc5f0\uc2b5 \ubaa8\ub4dc"}),(0,xs.jsxs)("div",{children:[(0,xs.jsx)("button",{style:{width:"100px",height:"100px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)",fontSize:"18px",textAlign:"center",color:"#000",cursor:"pointer"},onClick:()=>d("\uc5f0\uc2b5 \ubaa8\ub4dc - \uc67c\uc190"),children:"\uc67c\uc190"}),(0,xs.jsx)("button",{style:{width:"100px",height:"100px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)",fontSize:"18px",textAlign:"center",color:"#000",cursor:"pointer",marginLeft:"20px"},onClick:()=>d("\uc5f0\uc2b5 \ubaa8\ub4dc - \uc624\ub978\uc190"),children:"\uc624\ub978\uc190"})]})]}),(0,xs.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,xs.jsx)("p",{style:{margin:"0",fontSize:"20px",textAlign:"center",color:"#000",marginBottom:"20px"},children:"\uc5f0\uc8fc \ubaa8\ub4dc"}),(0,xs.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,xs.jsx)("button",{style:{width:"100px",height:"100px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",textAlign:"center",color:"#000",cursor:"pointer"},onClick:()=>d("\uc5f0\uc8fc \ubaa8\ub4dc - \uc591\uc190"),children:"\uc591\uc190"})})]})]})]})]}),(0,xs.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xs.jsxs)("div",{style:{},children:[(0,xs.jsx)("img",{src:"../img/\ud558\uc785\ubcf4\uc774\uc568\ubc94\ucee4\ubc84.jpg",alt:"\uc568\ubc94 \ucee4\ubc84",style:{float:"left",marginRight:"20px",width:"200px",height:"200px"}}),(0,xs.jsx)("div",{style:{display:"flex"},children:(0,xs.jsxs)("div",{style:{},children:[(0,xs.jsx)("h2",{style:{marginTop:"1px",marginBottom:"1px",fontSize:"28px"},children:s.music_instance.title}),(0,xs.jsx)("p",{style:{marginTop:"10px",fontSize:"15px",color:"#505050"},children:s.music_instance.poster}),(0,xs.jsx)("button",{className:"like-button",style:{backgroundColor:"transparent",border:"none",boxShadow:"none"},onClick:()=>{a(!o)},children:(0,xs.jsx)("img",{className:"like-img",src:o?"../img/\uc88b\uc544\uc694\ub204\ub978\ubc84\ud2bc.png":"../img/\uc88b\uc544\uc694\ubc84\ud2bc.png",alt:"\uc88b\uc544\uc694 \ubc84\ud2bc",style:{marginTop:"10px",width:"20px",height:"20px",cursor:"pointer"}})})]})}),(0,xs.jsxs)("div",{style:{marginTop:"80px"},children:[(0,xs.jsx)("p",{style:{fontSize:"15px",color:"#505050",display:"inline-block"},children:"\uace1 \uae38\uc774"}),(0,xs.jsx)("p",{style:{fontSize:"15px",color:"#505050",display:"inline-block",marginLeft:"5px"},children:s.music_instance.music_length})]})]}),(0,xs.jsxs)("div",{style:{},children:[(0,xs.jsx)("button",{style:{backgroundColor:"transparent",border:"none",color:"#AEAEAE",cursor:"pointer"},onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("\ucd08\ub300 \ub9c1\ud06c\uac00 \ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")},children:"\ucd08\ub300 \ub9c1\ud06c"}),(0,xs.jsx)("button",{style:{marginLeft:"20px",backgroundColor:"transparent",border:"none",color:"#AEAEAE",cursor:"pointer"},children:"\uace1 \ubcc0\uacbd\ud558\uae30"})]})]})]}),(0,xs.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:Object.entries(s.guests).map((t=>{let[e,n]=t;return(0,xs.jsx)(wo,{profileImage:"../img/\ud504\ub85c\ud5442.jpg",nickname:n.nickname,equipment:"AR Piano",statusColor:"#FE4949",mode:u})}))})]})]})},_o=()=>(0,xs.jsxs)("div",{children:[(0,xs.jsx)("h2",{style:{marginLeft:"360px",marginTop:"50px",fontSize:"24px"},children:"\ud604\uc7ac \uc5f0\uacb0\ub41c \uc7a5\ube44"}),(0,xs.jsx)("div",{style:{width:"892px",height:"280px",position:"absolute",left:"359.5px",top:"609.5px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)"}}),(0,xs.jsx)("p",{style:{position:"absolute",left:"668px",top:"736px",fontSize:"24px",fontWeight:"500",textAlign:"left",color:"#000"},children:"\ud604\uc7ac \uc5f0\uacb0\ub41c \uc7a5\ube44\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,xs.jsx)("img",{src:"./img/\uc5f0\uacb0\uc7a5\ube44\uc5c6\uc74c.png",style:{width:"153px",height:"155px",position:"absolute",left:"418.5px",top:"672.5px",objectFit:"cover"}})]}),To=()=>{const[t,n]=(0,e.useState)("Stopped");return(0,xs.jsxs)("div",{children:[(0,xs.jsx)("div",{style:{width:"892px",height:"280px",position:"absolute",left:"359.5px",top:"609.5px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)"}}),(0,xs.jsx)("input",{type:"text",id:"ip_address",placeholder:"IP \uc8fc\uc18c\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.",style:{width:"300px",height:"50px",position:"absolute",left:"668px",top:"650px",fontSize:"24px",fontWeight:"500",textAlign:"left",color:"#000"}}),(0,xs.jsx)("button",{onClick:()=>{(()=>{const t=document.getElementById("ip_address").value,e=new WebSocket("ws://"+t+":4439");console.log("ws",e),e.onopen=()=>{console.log("connected"),e.send("ready"),n("Running")}})()},style:{width:"300px",height:"50px",position:"absolute",left:"668px",top:"736px",fontSize:"24px",fontWeight:"500",textAlign:"left",color:"#000"},children:"\uc5f0\uacb0\ud558\uae30"}),(0,xs.jsx)("div",{children:(0,xs.jsxs)("p",{children:["Server Status: ",t]})})]})},Eo=()=>{const t=x((t=>t.user.name)),[n,i]=(0,e.useState)(1),r=t=>{i(t)};return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsxs)("div",{id:"app",className:"container",style:{},children:[(0,xs.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"30px",marginBottom:"70px",marginLeft:"360px"},children:(0,xs.jsx)("h1",{style:{fontSize:"26px"},children:"\uc7a5\ube44 \uc5f0\uacb0\ud558\uae30"})}),(0,xs.jsxs)("div",{className:"EquipmentList",style:{display:"flex",marginLeft:"350px"},children:[(0,xs.jsx)("div",{className:"Phone",style:{display:"flex",flexDirection:"column"},children:(0,xs.jsx)("button",{onClick:()=>r(1),style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",marginTop:"10px",cursor:"pointer"},children:(0,xs.jsx)("img",{src:"./img/\ud734\ub300\ud3f0\uc5f0\uacb0\ud558\uae30.png",alt:"\uc7a5\ube44_\ud734\ub300\ud3f0",style:{float:"left",width:"283px",height:"343px"}})})}),(0,xs.jsx)("div",{className:"keyboard",style:{display:"flex",flexDirection:"column",marginLeft:"30px"},children:(0,xs.jsx)("button",{onClick:()=>r(2),style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",marginTop:"10px",cursor:"pointer"},children:(0,xs.jsx)("img",{src:"./img/\ud0a4\ubcf4\ub4dc\uc5f0\uacb0\ud558\uae30.png",alt:"\uc7a5\ube44_\ud0a4\ubcf4\ub4dc",style:{float:"left",width:"283px",height:"343px"}})})}),(0,xs.jsx)("div",{className:"piano",style:{display:"flex",flexDirection:"column",marginLeft:"30px"},children:(0,xs.jsx)("button",{onClick:()=>r(3),style:{display:"block",backgroundColor:"transparent",border:"none",boxSahdow:"none",marginTop:"10px",cursor:"pointer"},children:(0,xs.jsx)("img",{src:"./img/\ud53c\uc544\ub178\uc5f0\uacb0\ud558\uae30.png",alt:"\uc7a5\ube44_\ud53c\uc544\ub178",style:{float:"left",width:"283px",height:"343px"}})})})]}),(0,xs.jsxs)("div",{children:[1===n&&(0,xs.jsx)(To,{}),2===n&&(0,xs.jsx)(_o,{}),3===n&&(0,xs.jsx)(_o,{})]})]}),(0,xs.jsxs)("div",{style:{width:"381px",height:"706px"},children:[(0,xs.jsx)("div",{style:{width:"381px",height:"706px",position:"absolute",left:"1388.5px",top:"183.5px",borderRadius:"10px",background:"#fff",boxShadow:"0px 2px 10px 0 rgba(0,0,0,0.25)"}}),(0,xs.jsx)("img",{src:"./img/\uc778\ud3ec\uc544\uc774\ucf58.png",style:{width:"58px",height:"56px",position:"absolute",left:"1549.5px",top:"508.5px",objectFit:"cover"}})]})]})},Co=()=>{const t=x((t=>t.user.name)),e=x((t=>t.midi.midiList));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)("h2",{style:{marginTop:"40px",marginLeft:"330px",fontSize:"28px"},children:"\uc804\uccb4 \uc5c5\ub85c\ub4dc \uace1"}),(0,xs.jsx)(zs,{children:(0,xs.jsx)(Vs,{midiList:e})}),(0,xs.jsx)(Ls,{})]})},ko=()=>{const t=A(),n=(0,e.useRef)(null),i=(0,e.useRef)(null);(0,e.useEffect)((()=>{const e="http://13.124.50.132:8000/midi/download/\uc0ac\uac74\uc758 \uc9c0\ud3c9\uc120-1701236189.27549.mid";console.log("fullDownloadUrl",e),t(_s(!0)),Di({method:"get",url:e,responseType:"blob"}).then((async e=>{t(_s(!1)),n.current=await ks(e.data),i.current=n.current.track[As(n.current.track)].event,console.log(i.current)}))}),[]);return(0,xs.jsxs)("div",{children:[(0,xs.jsx)("h1",{children:"DevPage"}),(0,xs.jsx)("button",{onClick:()=>{const t=Os(i.current),e=Is(t);console.log(e)},children:"button"})]})},Ao=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\ub108\uc640 \ud568\uaed8\ub77c\uba74 \ucd94\uc6b4 \uaca8\uc6b8\ub3c4 \uacac\ub51c\ub9cc\ud574"})]})},Io=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\ucee4\ud53c\uc640 \ucc30\ub5a1\uad81\ud569 \uce90\ub7f4 \ud31d \ubc1c\ub77c\ub4dc"})]})},Oo=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\uc62c \ud06c\ub9ac\uc2a4\ub9c8\uc2a4\uc5d0\ub294 \uc0c9\ub2e4\ub978 K-\uce90\ub7f4\uc744"})]})},Ro=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\ucd94\uc5b5\uc758 \uad6d\ub0b4 \uaca8\uc6b8 \ub178\ub798"})]})},No=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\ud06c\ub9ac\uc2a4\ub9c8\uc2a4 \ud558\uba74 \ub5a0\uc624\ub974\ub294 \uc601\ud654 OST"})]})},Mo=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\ub7f0\ub358\uc758 LP\ubc14\uc5d0 \ud750\ub974\ub294 \uc62c\ub4dc \ube0c\ub9bf\ud31d"})]})},Do=()=>{const t=x((t=>t.user.name));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsx)(Fs,{user:t}),(0,xs.jsx)(zs,{}),(0,xs.jsx)("h1",{style:{marginLeft:"350px"},children:"\uac00\uc744\uc5d0 \ub4e3\uae30 \uc88b\uc740 \ubc1c\ub77c\ub4dc Top 40"})]})},Po=()=>{const t=x((t=>t.midi.loading));return(0,xs.jsxs)(xs.Fragment,{children:[(0,xs.jsxs)(Zr,{children:[(0,xs.jsx)(Kr,{path:"/",element:(0,xs.jsx)(qs,{})}),(0,xs.jsx)(Kr,{path:"/play/:id",element:(0,xs.jsx)(ws,{})}),(0,xs.jsx)(Kr,{path:"/midi/:id",element:(0,xs.jsx)(Xs,{})}),(0,xs.jsx)(Kr,{path:"/graphic",element:(0,xs.jsx)(Zs,{})}),(0,xs.jsx)(Kr,{path:"/convert",element:(0,xs.jsx)(Js,{})}),(0,xs.jsx)(Kr,{path:"/piano-socket",element:(0,xs.jsx)(bo,{})}),(0,xs.jsx)(Kr,{path:"/room/:room_id",element:(0,xs.jsx)(So,{})}),(0,xs.jsx)(Kr,{path:"/equipment-change",element:(0,xs.jsx)(Eo,{})}),(0,xs.jsx)(Kr,{path:"/whole-song",element:(0,xs.jsx)(Co,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-1",element:(0,xs.jsx)(Ao,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-2",element:(0,xs.jsx)(Io,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-3",element:(0,xs.jsx)(Oo,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-4",element:(0,xs.jsx)(Ro,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-5",element:(0,xs.jsx)(No,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-6",element:(0,xs.jsx)(Mo,{})}),(0,xs.jsx)(Kr,{path:"/editor-pick-7",element:(0,xs.jsx)(Do,{})}),(0,xs.jsx)(Kr,{path:"*",element:(0,xs.jsx)("h1",{children:"\ucc3e\uc744 \uc218 \uc5c6\ub294 \ud398\uc774\uc9c0\uc785\ub2c8\ub2e4."})}),(0,xs.jsx)(Kr,{path:"/dev",element:(0,xs.jsx)(ko,{})})]}),(0,xs.jsx)(xo,{loading:t})]})};new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);new Map;const Fo=n.startTransition;a.flushSync;function Lo(t){let{basename:n,children:i,future:r,window:s}=t,o=e.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),$i((function(t,e){let{pathname:n,search:i,hash:r}=t.location;return Qi("",{pathname:n,search:i,hash:r},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:Zi(e)}),null,a)));let c=o.current,[l,u]=e.useState({action:c.action,location:c.location}),{v7_startTransition:h}=r||{},d=e.useCallback((t=>{h&&Fo?Fo((()=>u(t))):u(t)}),[u,h]);return e.useLayoutEffect((()=>c.listen(d)),[c,d]),e.createElement(Qr,{basename:n,children:i,location:l.location,navigationType:l.action,navigator:c})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Bo,zo;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bo||(Bo={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(zo||(zo={}));const Uo=document.getElementById("root");(0,i.s)(Uo).render((0,xs.jsx)(T,{store:Wi,children:(0,xs.jsx)(Lo,{children:(0,xs.jsx)(Po,{})})}))})()})();
//# sourceMappingURL=main.d33d0321.js.map